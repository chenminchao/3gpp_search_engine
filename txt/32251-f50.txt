
                                            3GPP TS 32.251 V15.5.0 (2019-06)
                                                     Technical Specification
                                         3rd Generation Partnership Project;
                  Technical Specification Group Services and System Aspects;
                                               Telecommunication management;
                                                        Charging management;
                                        Packet Switched (PS) domain charging
                                                                (Release 15)
[pic]  [pic]

The  present  document  has  been  developed  within  the   3rd   Generation
Partnership Project  (3GPP  TM)  and  may  be  further  elaborated  for  the
purposes of 3GPP.
The present document has not been subject to any  approval  process  by  the
3GPP Organizational Partners and shall not be implemented.
This Specification is provided  for  future  development  work  within  3GPP
only. The Organizational Partners accept no liability for any  use  of  this
Specification.
Specifications and reports for implementation of the 3GPP TM  system  should
be obtained via the 3GPP Organizational Partners' Publications Offices.





                                  Keywords
            GSM, UMTS, LTE, charging, management, packet switched




                                    3GPP

                               Postal address



                         3GPP support office address
                  650 Route des Lucioles - Sophia Antipolis
                              Valbonne - FRANCE
               Tel.: +33 4 92 94 42 00 Fax: +33 4 93 65 47 16

                                  Internet
                             http://www.3gpp.org


                           Copyright Notification

    No part may be reproduced except as authorized by written permission.
  The copyright and the foregoing restriction extend to reproduction in all
                                   media.

  © 2019, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA,
                                    TTC).
                            All rights reserved.

UMTS™ is a Trade Mark of ETSI registered for the benefit of its members
3GPP™ is a Trade Mark of ETSI registered for the benefit of its Members and
of the 3GPP Organizational Partners
LTE™ is a Trade Mark of ETSI registered for the benefit of its Members and
of the 3GPP Organizational Partners
GSM® and the GSM logo are registered and owned by the GSM Association




         Contents


Foreword 8

1  Scope 9

2  References 9

3  Definitions, symbols and abbreviations  12
3.1  Definitions  12
3.2  Symbols  14
3.3  Abbreviations  15

4  Architecture considerations  18
4.0  General  18
4.1  High-level EPS architecture  18
4.2  PS domain offline charging architecture 19
4.3  PS domain online charging architecture  21

5  PS domain charging principles and scenarios 22
5.1  PS charging principles  22
5.1.0  General  22
5.1.1  Requirements 23
5.1.2  Charging information  24
5.1.3  Identifiers and correlation  26
5.1.4  UE Presence in Presence Reporting Area (PRA) 27
5.1.4.1  Single Presence Reporting Area (PRA)  27
5.1.4.2  Multiple Presence Reporting Areas (PRAs)   27
5.1.5  3GPP PS Data Off  28
5.1.6  Flexible Mobile Service Steering 28
5.2  PS domain offline charging scenarios  29
5.2.1  Basic principles  29
5.2.1.0  General  29
5.2.1.1  IP-CAN bearer charging 30
5.2.1.2  MM context charging 31
5.2.1.3  Flow Based bearer Charging (FBC)  32
5.2.1.4  SMS charging  35
5.2.1.5  LCS charging  35
5.2.1.6  MBMS context charging for GPRS 36
5.2.1.6A MBMS context charging for EPS  36
5.2.1.7  IP Flow Mobility (IFOM) charging  37
5.2.1.7A Network-Based IP Flow Mobility (NBIFOM) charging 37
5.2.1.8  Sponsored data connectivity charging  38
5.2.1.9  Application Based Charging (ABC)  39
5.2.1.9.0   Introduction 39
5.2.1.9.1   Charging per application  39
5.2.1.9.2   Charging per TDF session  41
5.2.1.10 Charging per IP-CAN session  42
5.2.1.10.0  General 42
5.2.1.10.1  IP-CAN bearer charging  42
5.2.1.10.2  Flow Based Charging (FBC) 45
5.2.1.11 Data Volume Reporting for Secondary RAT usage  48
5.2.1.11.1  General 48
5.2.2  Rf message flows  50
5.2.2.0  General  50
5.2.2.1  Triggers for charging events from S-GW  50
5.2.2.2  Triggers for charging events from P-GW  50
5.2.2.3  Triggers for charging events from ePDG  50
5.2.2.4  Triggers for charging events from MME 51
5.2.2.5  Triggers for charging events from TDF 51
5.2.2.6  Triggers for charging events from P-GW when charging per IP-CAN
           session is active 51
5.2.2.7  Triggers for charging events from TWAG  51
5.2.3  CDR generation  53
5.2.3.0  Introduction  53
5.2.3.1  Triggers for S-CDR charging information collection 54
5.2.3.1.0   General 54
5.2.3.1.1   Triggers for S-CDR charging information addition   54
5.2.3.1.2   Triggers for S-CDR closure  55
5.2.3.2  Triggers for M-CDR charging information collection 56
5.2.3.2.0   General 56
5.2.3.2.1   Triggers for M-CDR charging information addition   56
5.2.3.2.2   Triggers for M-CDR closure  56
5.2.3.3  Triggers for SGW-CDR charging information collection  57
5.2.3.3.0   Introduction 57
5.2.3.3.1   Triggers for SGW-CDR charging information addition 57
5.2.3.3.2   Triggers for SGW-CDR closure   59
5.2.3.4  Triggers for PGW-CDR charging information collection  60
5.2.3.4.0   Introduction 60
5.2.3.4.1   Triggers for PGW-CDR charging information addition 61
5.2.3.4.2   Triggers for PGW-CDR closure   62
5.2.3.5  Triggers for SMS-CDR charging information collection  63
5.2.3.6  Triggers for LCS-CDR charging information collection  63
5.2.3.7  Triggers for S-MB-CDR and G-MB-CDR charging information collection
           for MBMS context charging for GPRS  64
5.2.3.7.1   Triggers for S-MB-CDR and G-MB-CDR charging information
             creation 64
5.2.3.7.2   Triggers for S-MB-CDR and G-MB-CDR charging information
             addition 64
5.2.3.7.3   Triggers for S-MB-CDR and G-MB-CDR closure  64
5.2.3.7A Triggers for MBMS-GW-CDR charging information collection for MBMS
           context charging for EPS 65
5.2.3.7A.1  Triggers for MBMS-GW-CDR charging information creation 65
5.2.3.7A.2  Triggers for MBMS-GW-CDR charging information addition 65
5.2.3.7A.3  Triggers for MBMS-GW-CDR closure 65
5.2.3.8  Triggers for ePDG-CDR charging information collection 66
5.2.3.8.0   Introduction 66
5.2.3.8.1   Triggers for ePDG-CDR charging information addition  66
5.2.3.8.2   Triggers for ePDG-CDR closure  67
5.2.3.9  Triggers for TDF-CDR charging information collection  68
5.2.3.9.1   Triggers for TDF-CDR charging information creation 68
5.2.3.9.2   Triggers for TDF-CDR charging information addition 68
5.2.3.9.3   Triggers for TDF-CDR closure   70
5.2.3.10 Triggers for PGW-CDR charging information collection when IP-CAN
           session charging is active 71
5.2.3.10.1  General 71
5.2.3.10.2  Triggers for PGW-CDR charging information addition when IP-CAN
             session charging is active 71
5.2.3.10.3  Triggers for PGW-CDR closure when charging per IP-CAN session
             charging is active  74
5.2.3.11 Triggers for TWAG-CDR charging information collection 75
5.2.3.11.0  Introduction 75
5.2.3.11.1  Triggers for TWAG-CDR charging information addition  75
5.2.3.11.2  Triggers for TWAG-CDR closure  75
5.2.4  Void 76
5.2.5  Ga record transfer flows 76
5.2.6  Bp CDR file transfer  76
5.3  PS domain online charging scenarios   77
5.3.1  Basic principles  77
5.3.1.0  General  77
5.3.1.1  IP-CAN bearer charging 77
5.3.1.2  Flow Based bearer Charging 78
5.3.1.3  PS Furnish Charging Information procedure  81
5.3.1.4  Support of Failure Situations  81
5.3.1.5  Application Based Charging (ABC)  82
5.3.1.5.0   Introduction 82
5.3.1.5.1   Charging per application  82
5.3.1.5.2   Charging per TDF session  83
5.3.1.6  Charging per IP-CAN session  84
5.3.1.6.0   General 84
5.3.1.6.1   IP-CAN bearer charging  84
5.3.1.6.2   Flow Based Charging (FBC) 84
5.3.1.7  Sponsored data connectivity charging  87
5.3.1.8  Network-Based IP Flow Mobility (NBIFOM) charging 87
5.3.2  Ro message flows  88
5.3.2.0  General  88
5.3.2.1  Triggers for IP-CAN bearer online charging 88
5.3.2.1.1   Void  88
5.3.2.1.2   Void  88
5.3.2.2  Triggers for FBC online charging  89
5.3.2.2.0   Introduction 89
5.3.2.2.1   Triggers for starting and stopping an FBC Credit-Control
             session  90
5.3.2.2.2   Triggers for providing interim information for an FBC Credit-
             Control session 90
5.3.2.2A Triggers for ABC online charging  91
5.3.2.2A.0  Introduction 91
5.3.2.2A.1  Triggers for starting and stopping an ABC Credit-Control
             session  91
5.3.2.2A.2  Triggers for providing interim information for an ABC Credit-
             Control session 92
5.3.2.2B Triggers for TDF session online charging   93
5.3.2.2C Triggers for P-GW when charging per IP-CAN session is active  93
5.3.2.2C.1  General 93
5.3.2.2C.2  Triggers for starting and stopping an FBC Credit-Control
             session when charging per IP-CAN session is active  93
5.3.2.2C.3  Triggers for providing interim information for an FBC Credit-
             Control session when charging per IP-CAN session is active  94
5.3.2.3  PS Furnish Charging Information procedure  95
5.3.2.4  Support of Failure Situations  95

6  Definition of charging information 97
6.1A Rf message content  97
6.1A.0 General  97
6.1A.1 Summary of offline charging message formats  97
6.1A.2 Structure for the charging data message formats  97
6.1A.2.0 General  97
6.1A.2.1 Charging Data Request message  98
6.1A.2.2 Charging Data Response message 98
6.1B CDR content description on Bp interface 99
6.1B.0 General  99
6.1.1  IP-CAN bearer charging data in SGSN (S-CDR)  100
6.1.2  IP-CAN bearer charging data in S-GW (SGW-CDR)  102
6.1.3  FBC IP-CAN bearer charging data in P-GW (PGW-CDR)  105
6.1.4  Mobile Station mobility management data in SGSN (M-CDR) 111
6.1.5  SMS-MO data in SGSN/MME (S-SMO-CDR) 112
6.1.6  SMS-MT data in SGSN/MME (S-SMT-CDR) 113
6.1.7  Mobile Terminated location request (LCS-MT-CDR)  114
6.1.8  Mobile originated Location request (LCS-MO-CDR)  115
6.1.9  Network induced Location request (LCS-NI-CDR)  116
6.1.10 MBMS bearer context charging data in SGSN (S-MB-CDR) 117
6.1.11 MBMS bearer context charging data in GGSN (G-MB-CDR) 118
6.1.12 MBMS bearer context charging data in MBMS GW (MBMS-GW-CDR)  119
6.1.13 IP-CAN bearer charging data in ePDG (ePDG-CDR) 120
6.1.14 ABC data in TDF (TDF-CDR)  122
6.1.15 IP-CAN bearer charging data in TWAG (TWAG-CDR) 124
6.2  Data description for PS online charging 126
6.2.1  Message contents  126
6.2.1.1  Summary of online charging message formats 126
6.2.1.2  Structure for the Debit / Reserve Units operation message formats
           126
6.2.1.2.0   General 126
6.2.1.2.1   Debit / Reserve Units Request message   126
6.2.1.2.2   Debit / Reserve Units Response message  127
6.2.2  Void 127
6.3  PS charging specific parameters  128
6.3.1  Definition of PS charging information 128
6.3.1.0  General  128
6.3.1.1  PS charging information assignment for Service Information  128
6.3.1.1a "SMS over MME Charging" information assignment for Service
           Information 129
6.3.1.2  Definition of the PS information  130
6.3.1.3  Multiple Unit Operation information when charging per IP-CAN
           session is active 135
6.3.1.4  Supported features  136
6.3.2  Detailed message format for offline charging 137
6.3.3  Detailed message format for online charging  141
6.4  Void   144
6.5  Bindings for EPC offline charging  144

Annex A (normative):   Charging characteristics  148

A.1  General  148

A.2  Charging Characteristics in Gn/Gp SGSN  152

A.3  Charging Characteristics in S4-SGSN   154

A.4  Charging Characteristics in MME  154

A.5  Charging Characteristics in S-GW 155

A.6  Charging Characteristics in P-GW 155

A.7  Charging Characteristics in TDF  156

Annex B (normative):   Tx expiration; Failure Handling procedure and
                     session failover mechanism description 157

Annex C (informative): Bibliography 159

Annex D (normative):   Fixed Broadband Access  159

D.1  General  159

D.2  Architecture considerations  159
D.2.1  High level architecture  159
D.2.2  PS domain offline charging architecture 159
D.2.3  PS domain online charging architecture  159

D.3  PS domain charging principles and scenarios 160
D.3.1  PS charging principles   160
D.3.1.0  General  160
D.3.1.1  Requirements  160
D.3.1.1.1   Requirements for IP-Edge [PCEF]  160
D.3.1.1.2   Requirements for TDF  160
D.3.1.2  Charging information   161
D.3.2  PS domain offline charging scenarios  163
D.3.2.1  Basic principles  163
D.3.2.1.0   General 163
D.3.2.1.1   IP-CAN session charging 163
D.3.2.1.2   Flow-based bearer charging  164
D.3.2.1.3   TDF/Application Based Charging 165
D.3.2.2  Rf message flows  166
D.3.2.2.0   General 166
D.3.2.2.1   Triggers for charging events from IP-Edge [PCEF]   166
D.3.2.2.1.0 General 166
D.3.2.2.1.1 Triggers for charging information addition  166
D.3.2.2.1.2 Triggers for charging information closure 166
D.3.2.2.2   Triggers for charging events from TDF   166
D.3.2.2.2.0 Introduction 166
D.3.2.2.2.1 Triggers for charging information addition  166
D.3.2.2.2.2 Triggers for charging information closure 167
D.3.2.3.2   TDF-CDR charging information collection 167
D.3.2.3.2.0 Introduction 167
D.3.2.3.2.1 TDF-CDR charging information addition   167
D.3.2.3.2.2 TDF-CDR closure  167
D.3.2.3  CDR generation  168
D.3.2.3.0   General 168
D.3.2.3.1   IPE-CDR charging information collection 168
D.3.2.3.1.0 General 168
D.3.2.3.1.1 IPE-CDR charging information addition   168
D.3.2.3.1.2 IPE-CDR closure  169
D.3.2.4  Ga record transfer flows 169
D.3.2.5  Bp CDR file transfer   169
D.3.3  PS domain online charging scenarios 170
D.3.3.1  Basic principles  170
D.3.3.1.0   Introduction 170
D.3.3.1.1   IP-CAN session charging 170
D.3.3.1.2   Flow Based bearer Charging  170
D.3.3.1.3   TDF/Application Based Charging 170
D.3.3.2  Ro message flows  171
D.3.3.2.0   Introduction 171
D.3.3.2.1   Triggers for online charging   171
D.3.3.2.1.1 Triggers for starting and stopping a Credit-Control session
             171
D.3.3.2.1.2 Triggers for providing interim information for a Credit-Control
             session  171
D.3.3.2.2   PS Furnish Charging Information procedure 171
D.3.3.2.3   Support of Failure Situations  171

D.4  Definition of charging information 172
D.4.1  Data description for PS offline charging  172
D.4.1.1  Rf message contents 172
D.4.1.2  CDR description on the Bp interface 172
D.4.1.2.1   FBC IP-CAN session charging data in IP-Edge [PCEF] (IPE-CDR)
           172
D.4.1.2.2   Application Based Charging data in TDF (TDF-CDR)   174
D.4.2  Data description for PS online charging 175
D.4.2.1  Ro message contents 175
D.4.3  PS Charging specific parameters  175
D.4.3.1  Definition of PS charging information 175
D.4.3.2  Detailed message format for offline charging 176
D.4.3.3  Detailed message format for online charging  176
D.4.4  Bindings for offline charging  176

D.5  Charging Characteristics   177

Annex E (Informative): Inter-PLMN dedicated profile 177

E.1  General  177

E.2  Principles 178

E.3  Message content   178
E.3.1  General  178
E.3.2  Debit / Reserve Units messages 178
E.3.3  Re-authorization triggers  180
E.3.4  Service information used for PS charging  181

E.4  Fixed broadband access  182

Annex F (informative): Change history 183




         Foreword

This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).

The contents of the present document are subject to continuing work within
the TSG and may change following formal TSG approval. Should the TSG modify
the contents of the present document, it will be re-released by the TSG
with an identifying change of release date and an increase in version
number as follows:

  Version x.y.z

  where:

    x  the first digit:

       1  presented to TSG for information;

       2  presented to TSG for approval;

       3  or greater indicates TSG approved document under change control.

    y  the second digit is incremented for all changes of substance, i.e.
       technical enhancements, corrections, updates, etc.

    z  the third digit is incremented when editorial only changes have been
       incorporated in the document.



         1  Scope

The present document is part of a series of Technical Specifications (TSs)
specifying charging functionality and charging management in Packet
Switched networks (GSM/UMTS, EPS). The 3GPP core network charging
architecture and principles are specified in TS 32.240 [1], which provides
an umbrella for other charging management documents that specify:

  -  the content of the CDRs per domain / subsystem / service (offline
    charging);

  -  the content of real-time charging messages per domain / subsystem
    /service (online charging);

  -  the functionality of online and offline charging for those domains /
    subsystems / services;

  -  the interfaces that are used in the charging framework to transfer the
    charging information (i.e. CDRs or charging events).

The complete document structure for the charging TSs is defined in TS
32.240 [1].

The present document specifies the offline and online charging description
for the Packet Switched (PS) domain based on the functional stage 2
description in TS 23.060 [201], TS 23.401 [208] and TS 23.402 [209].
The offline and online charging description for the PS domain encompasses
also fixed broadband access in the convergent scenario deployment (i.e.
both the fixed broadband access network and Evolved Packet Core (EPC) owned
by a single operator) based on the functional stage 2 description in the
corresponding Annex of TS 23.203 [215].

This charging description includes the offline and online charging
architecture and scenarios specific to the PS domain, as well as the
mapping of the common 3GPP charging architecture specified in TS 32.240 [1]
onto the PS domain.
It further specifies the structure and content of the CDRs for offline
charging, and the charging events for online charging. The present document
is related to other 3GPP charging TSs as follows:

  -  The common 3GPP charging architecture is specified in TS 32.240 [1];

  -  The parameters, abstract syntax and encoding rules for the CDRs are
    specified in TS 32.298 [51];

  -  A transaction based mechanism for the transfer of CDRs within the
    network is specified in TS 32.295 [54];

  -  The file based mechanism used to transfer the CDRs from the network to
    the operator's Billing Domain (e.g. the billing system or a mediation
    device) is specified in TS 32.297 [52];

  -  The 3GPP Diameter application that is used for PS domain offline and
    online charging is specified in TS 32.299 [50].

Note that a CAMEL based prepaid function and protocol is also specified for
the PS domain (TS 23.078 [206] and TS 29.078 [202]). CAMEL entities and
functions are outside the scope of the present document.

All terms, definitions and abbreviations used in the present document,
which are common across 3GPP TSs, are defined in TR 21.905 [100]. Those
that are common across charging management in PS domains, services or
subsystems are provided in the umbrella document TS 32.240 [1] and are
copied into clause 3 of the present document for ease of reading. Finally,
those items that are specific to the present document are defined
exclusively in the present document.

Furthermore, requirements that govern the charging work are specified in TS
22.115 [101].


2  References

The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.

  References are either specific (identified by date of publication,
    edition number, version number, etc.) or non-specific.

  For a specific reference, subsequent revisions do not apply.

  -  For a non-specific reference, the latest version applies. In the case
    of a reference to a 3GPP document (including a GSM document), a non-
    specific reference implicitly refers to the latest version of that
    document in the same Release as the present document.

  [1]  3GPP TS 32.240: "Telecommunication management; Charging management;
             Charging architecture and principles".

  [2] - [9]   Void.

  [10] 3GPP TS 32.250: "Telecommunication management; Charging management;
             Circuit Switched (CS) domain charging".

  [11] – [19] Void.

  [20] 3GPP TS 32.260: "Telecommunication management; Charging management;
             IP Multimedia Subsystem (IMS) charging".

  [21] - [29] Void.

  [30] 3GPP TS 32.270: "Telecommunication management; Charging management;
             Multimedia Messaging Service (MMS) charging".

  [31] 3GPP TS 32.271: "Telecommunication management; Charging management;
             Location Services (LCS) charging".

  [32] void.

  [33] 3GPP TS 32.273: "Telecommunication management; Charging management;
             Multimedia Broadcast and Multicast Service (MBMS) charging"

  [34]   3GPP TS 32.274: "Telecommunication management; Charging
             management; Short Message Service (SMS) charging".

  [35] - [49] Void.

  [50] 3GPP TS 32.299: "Telecommunication management; Charging management;
             Diameter charging application".

  [51] 3GPP TS 32.298: "Telecommunication management; Charging management;
             Charging Data Record (CDR) encoding rules description".

  [52] 3GPP TS 32.297: "Telecommunication management; Charging management;
             Charging Data Records (CDR) file format and transfer".

  [53] 3GPP TS 32.296: "Telecommunication management; Charging management;
             Online Charging System (OCS) applications and interfaces".

  [54] 3GPP TS 32.295: "Telecommunication management; Charging management;
             Charging Data Record (CDR) transfer".

  [55] - [99] Void.

  [100]  3GPP TR 21.905: "Vocabulary for 3GPP Specifications".

  [101]  3GPP TS 22.115: "Service aspects; Charging and billing".

  [102]  3GPP TS 22.011: "Service accessibility".

  [103]  3GPP TS 23.003: "Numbering, Addressing and Identification".

  [104] - [199] Void.

  [200]  3GPP TS 22.060: "General Packet Radio Service (GPRS); Service
             description; Stage 1".

  [201]  3GPP TS 23.060: "General Packet Radio Service (GPRS); Service
             description; Stage 2".

  [202]  3GPP TS 29.078: "Customized Applications for Mobile network
             Enhanced Logic (CAMEL)
             Phase X;CAMEL Application Part (CAP) specification".

  [203]  3GPP TS 29.060: "General Packet Radio Service (GPRS); GPRS
             Tunnelling Protocol (GTP) across the Gn and Gp interface".

  [204]  Void.

  [205]  3GPP TS 29.061: "Interworking between the Public Land Mobile
             Network (PLMN) supporting packet based services and Packet
             Data Networks (PDN)".

  [206]  3GPP TS 23.078: "Customized Applications for Mobile network
             Enhanced Logic (CAMEL);
             Phase 4; Stage 2".

  [207]  3GPP TS 23.246: "Multimedia Broadcast/Multicast Service (MBMS);
             Architecture and functional description".

  [208]  3GPP TS 23.401: "General Packet Radio Service (GPRS) enhancements
             for Evolved Universal Terrestrial Radio Access Network (E-
             UTRAN) acces".

  [209]  3GPP TS 23.402: "Architecture enhancements for non-3GPP accesses".

  [210]  3GPP TS 29.274: "3GPP Evolved Packet System (EPS); Evolved General
             Packet Radio Service (GPRS) Tunnelling Protocol for Control
             plane (GTPv2-C); Stage 3".

  [211]  3GPP TS 29.275: "Proxy Mobile IPv6 (PMIPv6) based Mobility and
             Tunnelling protocols; Stage 3".

  [212]  3GPP TS 23.261: "IP flow mobility and seamless Wireless Local Area
             Network (WLAN) offload; Stage 2".

  [213]  3GPP TS 23.272: "Circuit Switched (CS) fallback in Evolved Packet
             System (EPS); Stage 2".

  [214]  Void.

  [215]  3GPP TS 23.203: "Policy and charging control architecture".

  [216]  3GPP TS 29.212: "Policy and Charging Control (PCC); Reference
             points".

  [217]  3GPP TS 29.281: "General Packet Radio System (GPRS) Tunnelling
             Protocol User Plane (GTPv1-U)".

  [218] - [241] Void.

  [242]  3GPP TS 23.161: "Network-based IP flow mobility and Wireless Local
             Area Network (WLAN) offload; Stage 2".

  [243] - [399] Void.

  [400]  Void.

  [401]  Void.

  [402]  IETF RFC 4006 (2005): "Diameter Credit-Control Application".

  [403] - [599] Void.

  [600]  Broadband Forum TR-146: "Internet Protocol (IP) Sessions".

  [601]  Broadband Forum TR-134: "Broadband Policy Control Framework
             (BPCF)".



         3  Definitions, symbols and abbreviations


3.1  Definitions

For the purposes of the present document, the terms and definitions defined
in TR 21.905 [100], TS 32.240 [1] and TS 22.060 [200], and the following
apply:

2G-/3G-: prefixes 2G- and 3G- refer to functionality that supports only GSM
or UMTS, respectively, e.g. 2G-SGSN refers only to the GSM functionality of
an SGSN
When the term/prefix is omitted, reference is made independently from the
GSM or UMTS functionality.

accounting: process of apportioning charges between the Home Environment,
Serving Network and Subscriber.

billing: function whereby CDRs generated by the charging function(s) are
transformed into bills requiring payment.

Billing Domain (BD): Part of the operator network, which is outside the
core network that receives and processes CDR files from the core network
charging functions. It includes functions that can provide billing
mediation and billing or other (e.g. statistical) end applications. It is
only applicable to offline charging (see "Online Charging System" for
equivalent functionality in online charging).

CAMEL: network feature that provides the mechanisms to support operator
specific services even when roaming outside HPLMN.

CAMEL subscription information: identifies a subscriber as having CAMEL
services.

chargeable event: activity utilizing telecommunications network resources
and related services for:

  -  user to user communication (e.g. a single call, a data communication
    session or a short message); or

  -  user to network communication (e.g. service profile administration);
    or

  -  inter-network communication (e.g. transferring calls, signalling, or
    short messages); or

  -  mobility (e.g. roaming or inter-system handover); and

  -  that the network operator may want to charge for.

As a minimum, a chargeable event characterises the resource / service usage
and indicates the identity of the involved end user(s).

charged party: user involved in a chargeable event that has to pay parts or
the whole charges of the chargeable event, or a third party paying the
charges caused by one or all users involved in the chargeable event, or a
network operator.

charging: a function within the telecommunications network and the
associated OCS/BD components whereby information related to a chargeable
event is collected, formatted and transferred in order to make it possible
to determine usage for which the charged party may be billed.

Charging Data Record (CDR): A formatted collection of information about a
chargeable event (e.g. time of call set-up, duration of the call, amount of
data transferred, etc) for use in billing and accounting. For each party to
be charged for parts of or all charges of a chargeable event a separate CDR
is generated, i.e. more than one CDR may be generated for a single
chargeable event, e.g. because of its long duration, or because more than
one charged party is to be charged.

charging event: a set of charging information forwarded by the CTF towards
the CDF (offline charging) or towards the OCS (online charging). Each
charging event matches exactly one chargeable event.

charging function: entity inside the core network domain, subsystem or
service that is involved in charging for that domain, subsystem or service.

Credit-Control:  mechanism which directly interacts in real-time with an
account and controls or monitors the charges, related to the service usage.
Credit-Control is a process of: checking if credit is available, credit
reservation, deduction of credit from the end user account when service is
completed and refunding of reserved credit not used.

domain: part of a communication network that provides network resources
using a certain bearer technology.

Fully Qualified Partial CDR (FQPC): partial CDR that contains a complete
set of the fields specified in the present document. This includes all the
mandatory and conditional fields as well as those fields that the PLMN
operator has provisioned to be included in the CDR. The first Partial CDR
shall be a Fully Qualified Partial CDR.

GPRS: packet switched bearer and radio services for GSM and UMTS systems.

GSM only: qualifier indicating that this clause or paragraph applies only
to a GSM system. For multi-system cases this is determined by the current
serving radio access network.

in GSM,...: qualifier indicating that this paragraph applies only to GSM
System.

in UMTS,...: qualifier indicating that this paragraph applies only to
UMTS System.

inter-system change: change of radio access between different radio access
technologies such as GSM and UMTS.

IP-CAN bearer: An IP transmission path of defined capacity, delay and bit
error rate, etc. See TS 21.905 [100] for the definition of bearer.

IP-CAN session: The association between a UE represented by an IPv4 address
and/or an IPv6 prefix, and UE identity information, if available, and a PDN
represented by a PDN ID (e.g. an APN). An IP-CAN session incorporates one
or more IP-CAN bearers. Support for multiple IP-CAN bearers per IP-CAN
session is IP-CAN specific. An IP-CAN session exists as long as UE IP
addresses are established and announced to the IP network.

middle tier TS: used for the 3GPP charging TSs that specify the domain /
subsystem / service specific, online and offline, charging functionality.
These are all the TSs in the numbering range from TS 32.250 [10] to TS
32.271 [31], e.g. TS 32.250 [10] for the CS domain, or TS 32.270 [30] for
the MMS service.
Currently, there is only one "tier 1" TS in 3GPP, which is TS 32.240 [1]
that specifies the charging architecture and principles. Finally, there are
a number of top tier TSs in the 32.29x numbering range ([50] ff) that
specify common charging aspects such as parameter definitions, encoding
rules, the common Billing Domain (BD) interface or common charging
applications.

near real-time: near real-time charging and billing information is to be
generated, processed, and transported to a desired conclusion in less than
one (1) minute.

Non-Seamless WLAN Offload (NSWO) is a capability of routing specific IP
flows over the WLAN access without traversing the EPC as defined in
clause 4.1.5 of TS 23.402 [209].

offline charging: charging mechanism where charging information does not
affect, in real-time, the service rendered.

online charging: charging mechanism where charging information can affect,
in real-time, the service rendered and therefore a direct interaction of
the charging mechanism with bearer/session/service control is required.

Online Charging System (OCS): the entity that performs real-time Credit-
Control. Its functionality includes transaction handling, rating, online
correlation and management of subscriber account balances.

packet switched domain: domain in which data is transferred between core
network elements in packet switched mode.

partial CDR: CDR that provides information on part of a subscriber session.
A long session may be covered by several partial CDRs. Two formats are
considered for partial CDRs. One that contains all of the necessary fields
(FQPC); the second has a reduced format (RPC).

Presence Reporting Area: An area defined within 3GPP Packet Domain for the
purposes of reporting of UE presence within that area due to policy control
and/or charging reasons. There are two types of Presence Reporting Area:
"UE-dedicated Presence Reporting Area", and "Core Network pre-configuration
Presence Reporting Area".

Real-time: real-time charging and billing information is to be generated,
processed, and transported to a desired conclusion in less than one (1)
second.

Reduced Partial CDR (RPC): partial CDRs that only provide mandatory fields
and information regarding changes in the session parameters relative to the
previous partial CDR. For example, location information is not repeated in
these CDRs if the subscriber did not change its location.

settlement: payment of amounts resulting from the accounting process.

Selected IP Traffic Offload (SIPTO): Offload of selected types of IP
traffic (e.g. internet traffic) towards a defined IP network close to the
UE's point of attachment to the access network. SIPTO is applicable to
traffic offload for the macro-cellular access network and for the H(e)NB
subsystem.

subscriber: A subscriber is an entity (associated with one or more users)
that is engaged in a subscription with a service provider. The subscriber
is allowed to subscribe and unsubscribe services, to register a user or a
list of users authorized to enjoy these services, and also to set the
limits relative to the use that associated users make of these services.

tariff period: part of one (calendar) day during which a particular tariff
is applied. Defined by the time at which the period commences (the switch-
over time) and the tariff to be applied after switch-over.

tariff: set of parameters defining the network utilization charges for the
use of a particular bearer / session / service.

UMTS only: qualifier indicating that this clause or paragraph applies only
to a UMTS system. For multi-system cases this is determined by the current
serving radio access network.

Unused Quota timer: the time period without quota granted or any quota
being consumed for any rating group belonging to the Gy session.

  NOTE:  It is started when initial quota for the session is received from
         the OCS and it is restarted every time there is a quota
         consumption.

user: An entity, not part of the 3GPP System that uses network resources by
means of a subscription.
The user may or may not be identical to the subscriber holding that
subscription.

User Equipment (UE): A device allowing a user access to network services.
For the purpose of 3GPP specifications the interface between the UE and the
network is the radio interface. A UE can be subdivided into a number of
domains, the domains being separated by reference points. Currently defined
domains are the USIM and ME Domains. The ME Domain can further be
subdivided into several components showing the connectivity between
multiple functional groups. These groups can be implemented in one or more
hardware devices. An example of such connectivity is the TE – MT interface.
Further, an occurrence of a User Equipment is an MS for GSM as defined in
GSM TS 04.02 (GSM Public Land Mobile Network (PLMN) Access Reference
Configuration).


3.2  Symbols

For the purposes of the present document the following symbols apply:

  A  Interface between an MSC and a BSC
  Bp Reference point for the CDR file transfer from the Packet Switched CGF
             to the BD
  C  Interface between a HLR and a SMSC
  D  Interface between a MSC and a HLR
  E  Interface between a MSC and a SMSC
  Ga Reference point between a CDF and the CGF for CDR transfer
  Gb Interface between an SGSN and a BSC
  Gc Interface between an GGSN and an HLR
  Gd Interface between an SMS-GMSC and an SGSN, and between a SMS-IWMSC and
             an SGSN
  Ge Interface between a SGSN and a CAMEL GSM SCF
  Gf Interface between an SGSN and an EIR
  Gi Interface between the Packet-Switched domain and an external packet
             data network
  Gn Interface between two GSNs within the same PLMN
  Gp Interface between two GSNs in different PLMNs
  Gr Interface between an SGSN and an HLR
  Gs Interface between an SGSN and an MSC/VLR.
  Gx Interface between a PCEF and a PCRF
  Gxa  Interface between a HSGW and a PCRF
  Gy Online charging reference point between a PCEF and an OCS
  Gyn  Online charging reference point between a TDF and an OCS
  Gz Offline charging reference point between a PCEF and anO FCS
  Gzn  Offline charging reference point between a TDF and an OFCS
  Iu Interface between the 3G SGSN and the UTRAN
  kbit/s Kilobits per second. 1 kbit/s = 210 bits per second
  Mbit/s Megabits per second. 1 Mbit/s = 220 bits per second
  R  Reference point between a non-ISDN compatible TE and MT.
             Typically this reference point supports a standard serial
             interface.
  Rf Offline charging reference point between a PCN network element and CDF
  Ro Online charging reference point between a PCN network element and the
             OCS
  Um Interface between the Mobile Station (MS) and the GSM fixed network
             part
  Uu Interface between the User Equipment (UE) and the UMTS fixed network
             part

3.3  Abbreviations

For the purposes of the present document, the abbreviations defined in
TR 21.905 [100] and the following apply:

  3G 3rd Generation
  ABC  Application Based Charging
  ADC  Application Detection and Control
  AoC  Advice of Charge
  APN  Access Point Name
  ARP  Allocation and Retention Priority
  BD Billing Domain
  CAMEL  Customised Applications for Mobile network Enhanced Logic
  CCA  Credit-Control-Answer
  CCR  Credit-Control-Request
  CDF  Charging Data Function
  CDR  Charging Data Record
  CG Charging Gateway
  CGF  Charging Gateway Function
  CI Cell Identity
  CIoT Cellular Internet of Things
  CP Control PlaneCS  Circuit Switched
  CSE  CAMEL Service Environment
  CSG  Closed Subscriber Group
  CSG ID Closed Subscriber Group Identity
  CTF  Charging Trigger Function
  DCCA Diameter Credit-Control Application
  EPC  Evolved Packet Core
  ePDG Evolved Packet Data Gateway
  EPS  Evolved Packet System
  ECUR Event Charging with Unit Reservation
  E-UTRAN  Evolved Universal Terrestrial Radio Access Network
  FBC  Flow Based bearer Charging
  FQPC Fully Qualified Partial CDR
  GERAN  GSM EDGE Radio Access Network
  GGSN Gateway GPRS Support Node
  GPRS General Packet Radio Service
  GSM  Global System for Mobile communication
  GTP  GPRS Tunnelling Protocol
  GTP' The GPRS protocol used for CDR transport.
             It is derived from GTP with enhancements to improve transport
             reliability necessary for CDRs.
  HeNB Home eNode B
  HNB  Home Node B
  H(e)NB HNB and HeNB
  HLR  Home Location Register
  HPLMN  Home PLMN
  HRPD High Rate Packet Data
  HSGW HRPD Serving Gateway
  IE Information Element
  IEC  Immediate Event Charging
  IETF Internet Engineering Task Force
  IFOM IP Flow Mobility
  IMEI International Mobile Equipment Identity
  IMSI International Mobile Subscriber Identity
  IP Internet Protocol
  IP-CAN IP Connectivity Access Network
  IPv4 Internet Protocol version 4
  IPv6 Internet Protocol version 6
  ISDN Integrated Services Digital Network
  ITU-T  International Telecommunication Union - Telecommunications
             standardization sector
  LAC  Location Area Code
  LR Location Request
  M-CDR  Mobility management generated CDR
  MAPCON Multi Access PDN Connectivity
  MCC  Mobile Country Code (part of IMSI)
  ME Mobile Equipment
  MLC  Mobile Location Center
  MME  Mobility Management Entity
  MMS  Multimedia Messaging Service
  MNC  Mobile Network Code (part of IMSI)
  MO Mobile Originated
  MO-LR  Mobile Originated Location Request
  MS Mobile Station
  MSISDN Mobile Station ISDN number
  MT Mobile Terminated
  MT-LR  Mobile Terminated Location Request
  NBIFOM Network-based IP flow mobility
  NE Network Element
  NI Network Identifier (part of the APN)
  NI-LR  Network Induced - Location Request
  NSWO Non-Seamless WLAN Offload
  OAM&P  Operation, Administration, Maintenance and Provisioning
  OCF  Online Charging Function
  OCS  Online Charging System
  OI Operator Identifier (part of the APN)
  P-GW PDN Gateway
  PCC  Policy and Charging Control
  PCEF Policy and Charging Enforcement Function
  PCN  Packet switched Core network Node (SGSN, GGSN, S–GW, P–GW, TDF)
  PDN  Packet Data Network
  PDP  Packet Data Protocol (e.g. IP)
  PDU  Packet Data Unit
  PGW-CDR  P-GW (enhanced by FBC) generated CDR
  PLMN Public Land Mobile Network
  PMIP Proxy Mobile IP
  PPP  Point-to-Point Protocol
  PRA  Presence Reporting Area
  PS Packet Switched
  QCI  QoS Class Identifier
  QoS  Quality of Service
  RAB  Radio Access Bearer
  RAC  Routing Area Code
  RANAP  Radio Access Network Application Part
  RG Residential Gateway
  RNC  Radio Network Controller
  RPC  Reduced Partial CDR
  SAC  Service Area Code
  S-CDR  SGSN (IP-CAN bearer) generated CDR
  S-GW Serving Gateway
  SCUR Session Charging with Unit Reservation
  SDF  Service Data Flow
  SGSN Serving GPRS Support Node
  SGW-CDR  S-GW (IP-CAN bearer) generated CDR
  SIPTO  Selected IP Traffic Offload
  SMS  Short Message Service
  S-SMO-CDR   SGSN delivered Short message Mobile Originated CDR
  S-SMT-CDR   SGSN delivered Short message Mobile Terminated CDR
  T-PDU  Transport PDU
  TDF  Traffic Detection Function
  TDF-CDR  TDF generated CDR
  TR Technical Report
  TS Technical Specification
  TWAG Trusted WLAN Access Gateway
  TWAN Trusted WLAN Access Network
  UMTS Universal Mobile Telecommunications System
  UP User Plane
  USIM Universal Subscriber Identity Module
  UTRAN  UMTS Terrestrial Radio Access Network

  UWAN Untrusted Wireless Access Network







         4  Architecture considerations


4.0  General

This clause describes the functional entities involved in the PS domain
charging architecture. It also presents the mappings of the ubiquitous
offline and online charging architecture specified in TS 32.240 [1] onto
physical implementations that are standardized for the 3GPP PS domain.


4.1  High-level EPS architecture

The 3GPP PS domain provides procedures for packet core networks described
in TS 23.060 [201], TS 23.401 [208],
TS 23.402 [209] and TS 23.272 [213].

For offline charging the following Packet switched Core network Nodes (PCN)
may generate accounting metrics sets for PS domain CDRs:

  -  the SGSN, to record a user's access to PLMN resources, mobility
    management activities, SMS and LCS usage;

  -  the S-GW, to record a user's access to PLMN resources;

  -  the ePDG, to record a user's access to PLMN resources;

  -  the TWAG, to record a user's access to PLMN resources (optional) ;

  -  the P-GW, to record a user's access to external networks ;

  -  the GGSN, to record a user's access to external networks;

  -  the MME, to record a user's SMS;

  -  the TDF, to record a user's access to external networks and
    applications.

The PCNs send the CDRs to the CGF in near real-time. The responsibility of
the CGF is to provide non-volatile CDR storage and the Bp interface towards
the Billing Domain (BD). Further details on the CGF can be found in TS
32.240 [1] and TS 32.297 [52].

For more information about online charging in PS domains see clause 4.3.

When P-GW provides connectivity to GERAN/UTRAN (P-GW acts as a GGSN) it
employs P-GW charging defined in this specification. When the stand-alone
GGSN provides connectivity to GERAN/UTRAN, it employs P-GW charging as
defined in the present document:

  -  Stand-alone GGSN offline charging is based on FBC IP-CAN bearer
    charging data in P-GW;

  -  Stand-alone GGSN online charging is based on PS Information used for
    online charging.



         4.2  PS domain offline charging architecture

As described in TS 32.240 [1], the CTF (an integrated component in each
charging relevant NE) generates charging events and forwards them to the
CDF. The CDF, in turn, generates CDRs which are then transferred to the
CGF.
Finally, the CGF creates CDR files and forwards them to the BD.

If the PCN generating the charging information has an integrated CDF, then
the PCN can produce CDRs. The CGF may also be integrated in the PCN, or it
may exist as a physically separate entity.
If the CGF is external to the PCN, then the CDF forwards the CDRs to the
CGF across the Ga interface.
In this case, the relationship between PCN/CDF and CGF is m:1.
If the CGF is integrated in the PCN, then there is only an internal
interface between the CDF and the CGF.
In this case, the relationship between PCN/CDF and CGF is 1:1. An
integrated CGF may support the Ga interface from other PCN/CDFs.

If the CDF is external to the PCN, the charging events are transferred from
the PCN to the CDF via the Rf interface specified in TS 32.299 [50]. In
this case, the relationship between PCN and CDF is m:1.

When an external CGF is used, this CGF may also be used by other, i.e. non-
PS, network elements, according to network design and operator decision. It
should be noted that the CGF may also be an integrated component of the BD
– in this case, the Bp interface does not exist and is replaced by a
proprietary solution internal to the BD.

Figure 4.2.1 depicts the architectural options described above.



                                    [pic]

            Figure 4.2.1: PS domain offline charging architecture

The P-GW includes a Policy and Charging Enforcement Function (PCEF) to
support Flow Based bearer Charging (FBC) functionality; this is not
depicted in figure 4.2.1. The Traffic Detection Function (TDF) supports
Application Based Charging (ABC) functionality. The Rf, Ga and Bp
interfaces include the required functionality, e.g. defined for the Gz/Gzn
reference point in TS 23.203 [215]. Refer to clause 5.2.1.3, TS 32.240 [1]
and TS 23.203 [215] for further details on FBC.

The PCNs may provide inter-operator charging functionality for Multimedia
Broadcast/Multicast Services (MBMS) defined in TS 23.246 [207] and TS
32.273 [33], not for subscriber charging.

It is mandatory to support at least one of the options Rf, Ga or Bp
interfaces from the PCN as described in the specification.

  NOTE:  The Rf interface details are specified for S-GW, ePDG, TWAG, MME,
         TDF and P-GW in this release.



         4.3  PS domain online charging architecture

PS domain online charging based on SGSN functions is implemented by CAMEL
techniques as described in TS 23.078 [206] and TS 29.078 [202], i.e.
outside the scope of the 32-series of charging TSs. Note, however, that the
CDRs described in the present document contains CAMEL information. This is
because some of that information is relevant to offline charging in case of
CAMEL control of (part of) the session, and thus needs to be captured in
the offline charging information. However, this is not related to the
online charging functions for the PS domain.

Mechanisms to enable PS domain online charging from the P-GW with included
PCEF and theTDF are specified in the present document, utilising the Ro
interface and the associated Diameter application as specified in TS 32.299
[50].
The reason for this alternative solution to CAMEL is that operators may
enforce the use of HPLMN P-GWs and TDF in the case of roaming, hence P-GW
or TDF service control and charging can be executed in the HPLMN in all
circumstances. The P-GW and TDF based PS domain online charging
architecture is depicted in figure 4.3.1.

                                    [pic]

            Figure 4.3.1: PS domain online charging architecture

The Ro reference point includes the functionality defined for the Gy
reference point (required for the PCEF) and the Gyn reference point
(required for the TDF) in TS 23.203 [215]. Refer to clause 5.2.1.3, TS
32.240 [1] and TS 23.203 [215] for further details on FBC.

Details on the interfaces and functions can be found in TS 32.240 [1] for
the general architecture components,
TS 32.296 [53] for the OCS, and TS 32.299 [50] for the Ro application.



         5  PS domain charging principles and scenarios


5.1  PS charging principles


5.1.0  General

The charging functions specified for the PS domain relate to:

  -  mobility management, refer to TS 23.060 [201];

  -  SMS transmissions / receptions, refer to TS 23.060 [201] , and TS
    23.272 [213];

  -  IP-CAN bearers, refer to TS 23.060 [201], TS 23.401 [208] and TS
    23.402 [209];

  -  LCS events, refer to TS 32.271 [31];

  -  service data flows, refer to TS 23.203 [215] , within IP-CAN session
    and IP-CAN bearer;

  -  TDF session, refer to TS 23.203 [215];

  -  network usage for specific applications within a TDF session, refer to
    TS 23.203 [215] ;

  -  MBMS bearer contexts, refer to TS 23.246 [207] and TS 32.273 [33].

IP-CAN bearer, when described for PS Charging in S-GW and P-GW, refers to
bearer related to IP data and Non-IP data as well.



         5.1.1  Requirements

The following are high-level charging requirements specific to the packet
domain, derived from the requirements in TS 22.115 [101], TS 23.060 [201],
TS 23.401 [208], TS 23.402 [209] and TS 23.203 [215].

  1) Every IP-CAN bearer shall be assigned a unique identity number for
    billing purposes. (i.e. the Charging Id).

  NOTE:  An IP-CAN session is identified by the unique identity number
         assigned to the default bearer for the
         IP-CAN session.

  2) Data volumes on both the uplink and downlink directions shall be
    counted separately. The data volumes shall reflect the data as
    delivered to and from the user. When the P-GW includes PCEF, the data
    volumes shall also reflect the data as delivered to and from the
    serving node at the bearer level.

  3) The charging mechanisms shall provide the duration of the IP-CAN
    bearer with date and time information.

  4) The network operator may define a subset of the charging information
    specified by PS domain charging standards. This means that it shall be
    possible to configure the PCN for the CDR information generated.

  5) The PCNs shall be capable of handling the Charging Characteristics.
    Charging Characteristics can be specific for a subscription, subscribed
    IP-CAN bearer (i.e. per APN) or per TDF session, see annex A for
    details.

  6) The SGSN shall support charging of CAMEL services.

  7) The SGSN shall support charging for location requests.

  8) The SGSN may support online charging using CAMEL techniques.

  9) The P-GW may support online charging using IETF based techniques.

  10)  The P-GW may be capable of identifying data volumes, elapsed time or
    events for individual service data flows (Flow Based bearer Charging).
    One PCC rule identifies one service data flow.

  11)  When online charging is used in the P-GW/TDF, the Credit-Control
    shall be per rating group.

  12)  P-GW/TDF shall allow reporting of the service or detected
    application /detected application usage per rating group or per
    combination of the rating group and service id. This reporting level
    can be activated per PCC/ADC rule.

  13)  The P-GW shall collect charging information for IP -CAN session as
    it would for one IP-CAN bearer in case of PMIP based connectivity is
    used.

  14)  Charging support in the SGSN shall apply only for SGSN with Gn/Gp
    connectivity.

  15)  The data volume shall be counted regardless of whether the
    subscriber's traffic has been offloaded from the mobile operator's
    network.

  Editor's Notes: This requirement should be rerefined after finalization
         of the architecture for Selected IP Traffic Offload charging.

  16)  The TDF may support online charging using IETF techniques.

  17)  The TDF shall be capable of identifying data volumes, elapsed time
    or events for specific applications (ABC).

  18)  The charging mechanisms shall provide the duration of the TDF
    session with date and time information.

  19)  The P-GW/S-GW shall support charging for Non-IP PDN connection.

These requirements apply equally to PS domain online charging and offline
charging.



         5.1.2  Charging information

Charging information in the PS domain network is collected for each MS/UE
by the SGSNs, MMEs, S-GWs, ePDG,
TWAG, P-GWs and TDFs, which are serving that MS/UE. The SGSN, S-GW, ePDG
and TWAG collect charging information for each MS/UE related with the radio
network usage, while the P-GW and TDF collect charging information for each
MS related with the external data network usage. PCNs also collect charging
information on usage of the PS domain network resources. For MBMS, charging
information in the PS domain network is collected for each MBMS bearer
context.
The following paragraphs list the charging information to be collected by
the PCNs for both online and offline charging.

For IP-CAN bearers, the PCNs shall collect the following charging
information:

  1. usage of the radio interface: the charging information shall describe
    the amount of data transmitted in MO and MT directions categorized with
    QoS,  user protocols, and use of Control Plane CIoT EPS Optimisation as
    specified in TS 23.401[208];

  2. usage duration: duration of IP-CAN bearer is counted as the time
    interval from IP-CAN bearer activation to
    IP-CAN bearer deactivation;

  3. usage of the general PS domain resources: the charging information
    shall describe the usage of other PS domain-related resources and the
    MSs PS domain network activity (e.g. mobility management);

  4. destination and source: the charging information shall provide the
    actual source addresses used by the subscriber for the IP-CAN bearer.
    The charging information shall describe the destination addresses with
    a level of accuracy as determined by the Access Point Name (APN);

  5. usage of the external data networks: the charging information shall
    describe the amount of data sent and received to and from the external
    data network. External networks can be identified by the APN.

  NOTE:  When charging per IP-CAN session is deployed in the P-GW, the
         usage of the external data networks is provided only at the session
         level and not per bearer.

  6. location of MS/UE: HPLMN, VPLMN, plus optional higher-accuracy
    location information.

  7. User CSG information: a user consumes network services via a CSG cell
    or a hybrid cell according to the user CSG information. The charging
    information shall include CSG ID, access mode and CSG membership
    indication.

  8. User inside/outside of a Presence Reporting Area: the charging
    information shall include indication on whether the UE is inside or
    outside of a Presence Reporting Area, and identification of the
    Presence Reporting Area, and is collected by SGW and PGW

For service data flows defined for FBC, the P-GW shall collect the
following charging information:

  1. the information described above for IP-CAN bearer charging;

  2. the amount of data transmitted in MO and MT directions categorized by
    rating group or combination of the rating group and service id when
    volume based charging applies;

  3. the duration of service data flows is counted and categorized by
    rating group or combination of the rating group and service id when
    time based charging applies;

  4. the number of events and corresponding time stamps categorized by
    rating group or combination of the rating group and service id when
    event based charging applies.

For TDF sessions, the TDF shall collect the following charging information:

  1. usage duration: duration of TDF sesion is counted as the time interval
    from TDF session activation to TDF session deactivation;

  2. usage of the general PS domain resources: the charging information
    shall describe the usage of other PS domain-related resources and the
    MSs PS domain network activity (e.g. mobility management);

  3. destination and source: the charging information shall provide the
    actual source addresses used by the subscriber for the TDF session. The
    charging information shall describe the destination addresses with a
    level of accuracy as determined by the APN;

  4. usage of the external data networks: the charging information shall
    describe the amount of data sent and received to and from the external
    data network. External networks can be identified by the APN.

  5. location of MS/UE: HPLMN, VPLMN, plus optional higher-accuracy
    location information.

  6. User CSG information: a user consumes network services via a CSG cell
    or a hybrid cell according to the user CSG information. The charging
    information shall include CSG ID, access mode and CSG membership
    indication.

7. voidFor application traffic defined for ABC, the TDF shall collect the
following charging information:

  1. the information described above for TDF session charging;

  2. the amount of data transmitted as specific application in MO and MT
    directions categorized by rating group or combination of the rating
    group and service identifier when volume based charging applies;

  3. the duration of application traffic is counted and categorized by
    rating group or combination of the rating group and service identifier
    when time based charging applies;

  4. the number of events and corresponding timestamps categorized by
    rating group or combination of the rating group and service identifier
    when event based charging applies.

For non-IP-CAN bearer related activities, the SGSN shall collect the
following charging information:

  1. mobility management actions for GPRS attached UEs/MSs;

  2. short messages passing through the SGSN in MO and MT directions;

  3. location requests passing through the SGSN, triggered by the UE/MS, by
    an external source, or by the network.

For MBMS bearer contexts, the PCNs shall collect the following charging
information:

  1. usage of the radio interface: the charging information shall describe
    the amount of data transmitted categorized with QoS and MBMS specific
    information defined in TS 32.273 [33];

  2. usage duration: duration of MBMS bearer context is counted as the time
    interval from the local creation of the MBMS bearer context to the
    local deletion of the MBMS bearer context;

  3. source: the charging information shall provide the source address used
    by the MBMS bearer service for the MBMS bearer context. The charging
    information may describe the destination addresses with a level of
    accuracy as determined by the APN;

  4. location information: the charging information shall describe a list
    of the downstream nodes being sent the MBMS bearer service.

The MME shall collect short messages passing through the MME in MO and MT
directions.





         5.1.3  Identifiers and correlation

The EPC charging identifier assigned per IP-CAN bearer, is used for
correlation purpose within PS domain, as specified in TS 32.240 [1].

Within a single-access PDN connection, the EPS default bearer remains
established throughout the lifetime of this PDN connection and is assigned
with its "EPS default bearer charging identifier". Other additional IP-CAN
bearers (i.e. dedicated bearers) which may be activated and deactivated
during this PDN connection, are each assigned with their own "IP-CAN bearer
charging identifier". For correlation of charging information for the whole
PDN connection, this "EPS default bearer charging identifier" is shared by
all these IP-CAN bearers charging sessions activated during this PDN
connection, as the "PDN connection charging identifier".

For PMIP based connectivity, an "unique Charging Id" is assigned by the P-
GW for the PDN connection (i.e. as it would be one IP-CAN bearer).

For ABC by the TDF:

  -  in case of GTP based connectivity, an "EPS default bearer charging
    identifier",

  -  in case of PMIP based connectivity, an "unique Charging Id"

is assigned by the P-GW and transferred to the TDF via the PCRF for the TDF
session.

During handover of a PDN connection between a GTP based connectivity
access, and a PMIP based connectivity access for the P-GW (and reversely),
the "EPS default bearer charging identifier" and the "unique Charging Id"
respectively, are maintained in order to ensure charging continuity for the
whole PDN connection over the different accesses.
Upon handover from GTP based connectivity to PMIP based connectivity, the
previously assigned "EPS default bearer charging identifier" is used as the
"unique Charging Id". Upon handover from PMIP based connectivity to GTP
based connectivity, the previously assigned "unique Charging Id" is used as
the "EPS default bearer charging identifier".

During handover of a PDN connection between a GTP based connectivity 3GPP
access, and a S2a/S2b GTP based connectivity non-3GPP access for the P-GW
(and reversely), the "EPS default bearer charging identifier" is maintained
for the default bearer, and the "Charging Id" is maintained for the handed-
over dedicated bearers (i.e. bearer with the same QCI and ARP in source and
target systems). Depending on the active PCC rules, establishment of new
dedicated bearers may be required after the handover. In this case each new
dedicated bearer is assigned with a new "Charging Id" as per normal
procedures.

When multiple simultaneous PDN connections are established for a given APN,
each PDN connection is associated with its own "PDN connection charging
identifier" or "unique Charging Id" and processed independently from the
other PDN connections.

When a "MAPCON capable UE", as defined in TS 23.402 [209], has simultaneous
PDN connections through different access networks, each PDN connection is
associated with its own "PDN connection charging identifier" or "unique
charging Id" over the selected access for the PDN connection.When selective
transfer of PDN connections between the different accesses is performed,
each PDN connection is transferred, as for a single PDN connection.

When an "IFOM capable UE", as defined in TS 23.402 [209], is simultaneously
connected to 3GPP access and WLAN access for different IP flows within the
same PDN connection, each service data flow is uniquely identified by a PCC
Rule within the PDN connection.

For a PDN connection with NBIFOM support, a "PDN connection charging
identifier" is assigned for the PDN connection and is shared by all the IP-
CAN bearers for the present as well as for any future accesses used during
the PDN connection. Additional IP-CAN bearers (i.e. dedicated bearers as
well as any additional default bearer in a new access) which may be
activated during this PDN connection, are each assigned with their own "IP-
CAN bearer charging identifier."



The "PDN connection charging identifier" shall remain unchanged and be used
by all serving nodes for the entire IP-CAN session. When a serving node is
changed, e.g. when UE moves PDN connection between LTE and WLAN or when
serving gateway relocation is performed, the individual bearer charging
identifiers shall be maintained as for a single-access PDN connection.



When SIPTO function applies, as defined in TS 23.060 [201] and TS 23.401
[208] the standard charging behaviour for PDN connection
activation/deactivation applies on the respective GW.

For inter-level correlation when charging per IP-CAN session is not active,
the charging identifier assigned to the specific bearer serves as the PS
domain access network charging identifier used for a dynamic PCC rule. For
inter-level correlation when Charging per IP-CAN session is active, the
charging identifier assigned to the PDN connection serves as the PS domain
access network charging identifier used for a dynamic PCC rule. Transport
of PS domain access network charging identifier to an external application
function are specified in TS 29.212 [216].

With NBIFOM, specific service data flows can be moved from one access to
another. The transfer of the service data flow to the other access causes
it to be bound to another bearer (either existing or to be created). When
Charging per IP-CAN session is not active, the flow is then using a bearer
with a charging identifier which would be different than that originally
notified to the application function for inter-level correlation. To
maintain a single access network charging identifier for inter-level
correlation, when NBIFOM is accepted for a PDN connection, then the
charging identifier assigned to the PDN connection serves as the PS domain
access network charging identifier used for a dynamic PCC rule.

  NOTE:  When Charging per IP-CAN session is active the "PDN connection
         charging identifier" remains unchanged so the information provided
         to the application function remains unchanged throughout the IP-CAN
         session.



For non-IP data, the PDN connection established with an unique IP-CAN
bearer as specified in TS 23.401 [208], is assigned with an "unique
Charging Id" by the P-GW.


5.1.4  UE presence in Presence Reporting Area (PRA)


5.1.4.1  Single Presence Reporting Area (PRA)

The Single Presence Reporting Area is not supported.

Non-support of single Presence Reporting Area is determined by the release
included in Service-Context-Id AVP.


5.1.4.2  Multiple Presence Reporting Areas (PRAs)

UE presence in multiple presence reporting area (s) charging information,
as defined in TS 23.401 [208] and TS 23.203 [215], is collected for each UE
by S-GWs, P-GWs which are serving that UE.

During IP-CAN session establishment/modification, and independently from
the PCRF, the OCS may provide to the P-GW, a list of:

  -  Presence Reporting Area (PRA) Identifiers to be activated for Core
    Network pre-configured Presence Reporting Areas,

  -  Presence Reporting Area (PRA) Identifiers and their elements for UE-
    dedicated Presence Reporting Areas.

By providing the corresponding above lists in Presence-Reporting-Area-
Information AVP(s), the OCS subscribes to the notifications of change of UE
presence status in the PRA(s) through the Trigger-Type AVP. UE presence
status in the PRA(s) describes whether the UE is entering or leaving
Presence Reporting Area (s) and if the corresponding Presence Reporting
Area(s) is set to inactive by the serving node.

The OCS may change the notifications of whether the UE is entering or
leaving Presence Reporting Area (s) through Trigger-Type AVP in a CCA, with
the Presence-Reporting-Area-Information AVP(s) to replace previous provided
list.

The OCS may unsubscribe to the change of UE presence in Presence Reporting
Area through Trigger-Type AVP in a CCA without the value of
CHANGE_OF_UE_PRESENCE_IN_PRESENCE_REPORTING_AREA_REPORT (73), if it has
been provided in the previous CCA.

The UE presence initial status in the PRA(s) at the time of the
subscription shall be reported by the P-GW to the OCS for online charging
in Debit / Reserve Units Request[Update] when the subscription is
activated. The UE presence initial status in the PRA(s) at the time of the
subscription shall be reported by the S-GW and P-GW for offline charging in
Charging Data Request[Start] / [Interim] when the subscription is
activated. Subsequently, whether the UE enters or leaves the PRA(s), shall
be reported by the P-GW to the OCS for online charging, and by the S-GW and
P-GW for offline charging.

When a PRA set i.e. PRA Identifier was subscribed to, the SGW/PGW
additionally receives the PRA Identifier of the PRA set from the serving
node, along with the individual PRA Identifier(s) belonging to the PRA set
and indication(s) of whether the UE is inside or outside the individual
Presence Reporting Area(s) , as described in TS 23.401[208]. Only the
individual PRA Identifier(s) belonging to the PRA set and UE presence
status(es) are reported to the OCS according to the corresponding
subscription.

For offline charging, the initial status of UE presence in the PRA(s) shall
be captured in current counts and reported on first charging event. For
online charging, this initial status shall be reported when received by the
PCEF if quota have already been requested for the service usage, otherwise
this initial status shall be reported on the first quota request.

For PRA(s) subscribed-to by the OCS, the PRA(s) and their UE presence
status(es) which are reported to OCS are captured in offline charging from
P-GW, with an indication for each PRA, the PRA was subscribed-to by OCS.

For PRA(s) subscribed-to by the PCRF, the PRA(s) and their UE presence
status(es) which are reported to PCRF are captured in offline charging from
P-GW, with an indication for each PRA, the PRA was subscribed-to by PCRF.

In the S-GW the PRA(s) and their UE presence status(es) are captured in
offline charging without any differentiation between OCS and PCRF
subscription, since the S-GW is unaware about this difference.


5.1.5  3GPP PS Data Off

When 3GPP PS Data off is activated by the user, PGW prevents downlink
traffic except for 3GPP PS Data Off Exempt Services. The 3GPP PS Data Off
Exempt Services are a set of operator services, defined in TS 22.011 [102].
And if 3GPP PS Data Off is activated, the UE prevents the sending of uplink
IP packets except those related to 3GPP PS Data Off Exempt Services, based
on the pre-configured list of Data Off Exempt Services.

The UE reports its 3GPP PS Data Off status in PCO (Protocol Configuration
Option) to PGW during Initial Attach procedure and report a change of its
3GPP PS Data Off status in PCO by using Bearer Resource Modification
procedure, described in TS 23.401 [208]. The 3GPP PS Data Off status is
sent transparently through the MME and the Serving GW from UE to PGW. If
the PGW detects that the 3GPP PS Data Off Status has changed, the PGW shall
indicate this event to the charging system for offline and online charging.


5.1.6  Flexible Mobile Service Steering

The PGW/PCEF/TDF shall send the Traffic Steering Policy Identifier which
has been used by the PGW/PCEF/TDF for sending the service data flow to a
specific set of service functions(based on the PCC rule), to the offline
charging system for information.





         5.2  PS domain offline charging scenarios


5.2.1  Basic principles


5.2.1.0  General

In order to provide the data required for the management activities
outlined in TS 32.240 [1] (billing, accounting, statistics etc.), the SGSN
shall be able to produce CDRs, and the MME, S-GW, ePDG, TWAG, P-GW and TDF
shall be able to produce CDRs or report charging events for CDRs generation
by CDF, as specified for each node type in the following:

  -  Charging data related to IP-CAN bearers in the SGSN (S-CDR), S-GW (SGW-
    CDR), ePDG (ePDG-CDR) , TWAG (TWAG-CDR) and P-GW (PGW-CDR);

  -  Charging data related to service data flows in the P-GW (PGW-CDR);

  -  Charging data related to MM contexts (Mobile Station Mobility
    Management Data) in SGSN (M-CDR);

  -  SMS Mobile Originated data (S-SMO-CDR) and SMS Mobile Terminated Data
    (SMS-SMT-CDR) in the SGSN;

  -  Charging data related to mobile originated location requests (LCS-MO-
    CDR), mobile terminated location request (LCS-MT-CDR), and network
    induced location request (LCS-NI-CDR) passing through the SGSN;

  -  Charging data related to MBMS bearer contexts (S-MB-CDR, G-MB-CDR, and
    MBMS-GW-CDR).

  -  SMS Mobile Originated data (S-SMO-CDR) and SMS Mobile Terminated Data
    (S-SMT-CDR) in the MME;

  -  Charging data related to TDF session (TDF-CDR) in the TDF;

  -  Charging data related to application traffic in the TDF (TDF-CDR).

The contents and purpose of each of these CDRs, as well as the chargeable
events that trigger CDR creation, information addition, or closure are
described in the following clauses. A detailed formal description of the
CDR parameters defined in the present document is to be found in TS 32.298
[51].

When the CDF is implemented as a separate entity (for the MME, S-GW, ePDG,
TWAG, P-GW and TDF), the charging events triggering and contents for CDRs
handling by the  CDF, are described in clause 5.2.2.



           5.2.1.1  IP-CAN bearer charging

SGSN, ePDG, TWAG, P-GW, and S-GW collect charging information per user per
IP-CAN bearer. In case of P-GW is not aware of IP-CAN bearers, i.e. in case
of PMIP based connectivity, P-GW collects charging information per IP-CAN
session as it would be one IP-CAN bearer. IP-CAN bearer charging allows the
PCNs to collect charging information related to data volumes sent to and
received by the UE/MS, categorised by the QCI and ARP applied to the IP-CAN
bearer. The user can be identified by MSISDN and/or IMSI, while the IP-CAN
bearer can be determined by a unique identifier generated by the P-GW when
creating a IP-CAN bearer. This identifier is also forwarded to the S-GW/
ePDG/ TWAG/SGSN so as to allow correlation of S-GW/ ePDG/ TWAG/SGSN IP-CAN
bearer CDRs with the matching P-GW CDRs in the BD.

  NOTE1: The control plane IP address of SGSN or P-GW(acting as GGSN) is
         the IP address used at Gn/Gp interface.

         The control plane IP address of  S-GW or P-GW is the IP address
                used at S5/S8 interface.

         The control plane IP address of ePDG or P-GW is the IP address used
                at S2b interface.

         The control plane IP address of TWAG or P-GW is the IP address used
                at S2a interface.

IP-CAN bearer specific offline charging in P-GW, is achieved by FBC offline
charging, with specific rating group/service identifier, see clause
5.2.1.3.

The main collected information items are duration of the IP-CAN bearer and
data volume transferred during the lifetime of the IP-CAN bearer. The
following chargeable events are defined for SGSN, S-GW, ePDG and TWAG IP-
CAN bearer charging:

  -  Start of IP-CAN bearer. Upon encountering this event, a new CDR for
    this IP-CAN bearer is created and the data volume is captured for the
    IP-CAN bearer.

  -  Access of a multi-access PDN connection becomes unusable: when this
    event is encountered, the current volume count is captured for the IP-
    CAN bearer of the unusable access.

  -  Access of a multi-access PDN connection becomes usable: when this
    event is encountered, new volume counts are started for the IP-CAN
    bearer of the access that has become usable.

  -  End of IP-CAN bearer in the SGSN/S-GW/ePDG/TWAG. The CDR is closed
    upon encountering this trigger.

  -  Tracking Area Update of:

    -  Inter-SGSN/inter S-GW. The IP-CAN bearer CDR is closed in SGSN/S-GW
       upon encountering this trigger.

    -  Inter-MME. In S-GW a new MME address is added to CDR upon
       encountering this trigger.

    -  S4-SGSN to MME. In S-GW a new MME address is added to CDR upon
       encountering this trigger.

    -  MME to S4-SGSN. In S-GW a new S4-SGSN address is added to CDR upon
       encountering this trigger.

  -  Intersystem change (e.g. change of radio interface from GSM to UMTS or
    vice versa). This event closes the CDR. A new one is opened if the IP-
    CAN bearer is still active.

  -  PLMN change visible in the P-GW. This event closes the  CDR. A new one
    is opened if the IP-CAN bearer is still active.

  -  MS Timezone change visible in the P-GW. This event closes the CDR. A
    new one is opened if the IP-CAN bearer is still active.

  -  Expiry of an operator configured time limit per IP-CAN bearer. This
    event closes the CDR, and a new one is opened if the IP-CAN bearer is
    still active.

  -  Expiry of an operator configured data volume limit per IP-CAN bearer.
    This event closes the CDR, and a new one is opened if the IP-CAN bearer
    is still active.

  -  Change of charging condition in the SGSN: e.g. QoS change, tariff time
    change, user CSG information change or direct tunnel
    establishment/removal. When this event is encountered, the current
    volume count is captured and a new volume count is started.

  -  Change of charging condition in the S-GW: e.g. QoS change, tariff time
    change, user location change, user CSG information change, change of UE
    presence in Presence Reporting Area(s), change in User Plane to UE,
    Serving PLMN Rate Control change. When this event is encountered, the
    current volume counts are captured and a new volume counts are started.



  -  MO exception data counter receipt in the S-GW: This event closes the
    CDR. A new one is opened if the IP-CAN bearer is still active.

  -  Change of charging condition in the ePDG: e.g. QoS change, tariff time
    change. When this event is encountered, the current volume counts are
    captured and a new volume counts are started.

  -  Change of charging condition in the TWAG: e.g. QoS change, tariff time
    change. When this event is encountered, the current volume counts are
    captured and a new volume counts are started.

  -  Expiry of an operator configured change of charging condition limit
    per IP-CAN bearer. This event closes the CDR, and a new one is opened
    if the IP-CAN bearer is still active.

  -  Management intervention may also force trigger a chargeable event.

When the CDF is implemented as a separate entity, all these chargeable
events defined for IP-CAN bearer, trigger charging events reporting, for
CDRs (S-GW, ePDG, TWAG and P-GW CDRs) to be constructed, enriched or closed
by CDF, according to description in clause 5.2.2.

  NOTE 2:  For non-IP type PDN connection in the S-GW:

         -  Access of a multi-access PDN connection does not apply;

         -  Mobility occurs between MMEs.


5.2.1.2  MM context charging

The SGSN collects charging information for mobility management actions per
attached UE/MS, i.e. per user. The user can be identified by MSISDN and/or
IMSI. There can be only one MM context per UE/MS at a time, and only the
SGSN is involved. Therefore there is no need for special MM context
identifiers. The main information items collected are changes of location
pertaining to the UE/MS. The following chargeable events are defined for MM
context charging:

  -  Start of MM context (UE/MS attaches to a SGSN). A new M-CDR is created
    upon encountering this event.

  -  End of MM context: explicit or implicit GPRS detach, including SGSN
    change (inter-SGSN routing area update including intersystem change).
    This event triggers the closure of the M-CDR.

  -  Mobility Change, i.e. a change in the Routing Area. The new location
    information is captured for the M-CDR.

  -  Expiry of an operator configured time limit. This event triggers the
    closure of the M-CDR.

  -  Expiry of an operator configured mobility change limit. This event
    triggers the closure of the M-CDR.

  -  Intra-SGSN intersystem change (change of radio interface from GSM to
    UMTS or vice versa). This event triggers the closure of the M-CDR.

Management intervention may also force trigger a chargeable event.



           5.2.1.3  Flow Based bearer Charging (FBC)

IP-CAN bearer charging allows the P-GW to collect charging information
related to data volumes sent to and received by the UE/MS, categorised by
the QoS applied to the IP-CAN bearer. FBC is supported by the P-GW by the
integration of a PCEF. With PCEF, the normal IP-CAN bearer charging is
enhanced by the capability to categorise the service data flows within IP-
CAN bearer data traffic by rating group or combination of the rating group
and service id, i.e., while there is only one uplink an one downlink data
volume count per IP-CAN bearer in IP-CAN bearer charging, FBC provides one
count per each rating group or combination of the rating group and service
id. In case that sponsored connectivity level reporting is active, FBC
categorise within IP-CAN bearer data traffic by combination of rating
group, sponsor identity and application service provider identity. The
level of the reporting is defined per PCC rule. Details of this
functionality are specified in TS 23.203 [215] and TS 32.240 [1].

  NOTE:  The P-GW can only include one QoS Information occurrence per
         service data container. This implies if an operator wishes to be
         able to separate usage according to QCI and ARP within their
         billing system they will need to ensure that services having
         different QCI and ARP do not have the same:

         -  rating group in cases where rating reporting is used;

         -  rating group/service id where rating group/service id reporting
           is used;

         -  rating group/sponsor identity/application service provider
           identity where sponsored connectivity level reporting charging
           is used.

IP-CAN bearer specific offline charging is achieved with IP-CAN bearer
specific rating group/service identifier defined in clause 5.3.1.1.

According to TS 23.203 [215], FBC shall support different charging models
per PCC rule. These charging models may be based on volume and/or time and
on number of events matching a specific service data flow template in PCC
rule.
In general the charging of a service data flow shall be linked to the IP-
CAN bearer under which the service data flow has been activated.  The
following chargeable events are defined for FBC:

  -  Start of IP-CAN bearer. Upon encountering this event, a new PGW-CDR
    for this context is created.

  -  Start of service data flow. If service identifier level reporting is
    required by the PCC rule new counts and time stamps for this
    combination of the rating group and service id are started. If rating
    group level reporting is required by the PCC rule needed new counts and
    time stamps for this rating group are started. If sponsored
    connectivity level reporting is required by the PCC rule needed new
    counts and time stamps for this rating group, sponsor identity and
    application service provider identity are started. The type of counters
    shall depend on the measurement method configured for the PCC rule.
    When event based charging applies, the first occurrence of an event
    matching a service data flow template in PCC rule shall imply that a
    new count is started. When new events occur, the counter shall be
    increased. Each event shall be time stamped.

  -  Termination of service data flow. If service identifier level
    reporting is required by the PCC rule and this was the last active
    service data flow for this combination of the rating group and service
    id or if rating group level reporting is required by the PCC rule and
    this was the last active service data flow for this rating group, or if
    sponsored connectivity level reporting is required by the PCC rule and
    this was the last active service data flow for this combination of
    rating group, sponsor identity and application service provider
    identity, the counters and time stamps are closed and added to the PGW-
    CDR. For information on how the termination of service data flows is
    detected, refer to TS 23.203 [72].

  -  Access of a multi-access PDN connection becomes unusable: the
    Termination of service data flow chargeable event applies for all the
    service data flows carried under the IP-CAN bearer of the unusable
    access.

  -  Access of a multi-access PDN connection becomes usable: the Start of
    service data flow chargeable event applies for all the service data
    flows carried under the IP-CAN bearer of the access that has become
    usable.

  -  End of IP-CAN bearer in the P-GW. The PGW-CDR is closed upon
    encountering this trigger.

  -  Serving node (e.g. SGSN/S-GW/ePDG/TWAG) change in the P-GW. New SGSN/S-
    GW/ePDG/TWAG address is added to PGW-CDR.

  -  Expiry of an operator configured time limit per IP-CAN bearer. This
    event closes the PGW-CDR, and a new one is opened if the IP-CAN bearer
    is still active.

  -  Expiry of an operator configured time limit per rating group. The
    counters and time stamps are closed and added to the PGW-CDR. A new
    service data flow container is opened if any matching service data flow
    is still active.

  -  Expiry of an operator configured data volume limit per IP-CAN bearer.
    This event closes the PGW-CDR, and a new one is opened if the IP-CAN
    bearer is still active.

  -  Expiry of an operator configured data volume limit per rating group.
    The counters and time stamps are closed and added to the PGW-CDR. A new
    service data flow container is opened if any matching service data flow
    is still active.

  -  Expiry of an operator configured data event limit per rating group.
    The counters and time stamps are closed and added to the PGW-CDR. A new
    service data flow container is opened if any matching service data flow
    is still active.

  -  Change of charging condition: IP-CAN bearer modification (e.g. QoS
    change, SGSN change, S-GW change, user location change,user CSG
    information change, change of UE presence in Presence Reporting
    Area(s), change of 3GPP PS Data Off status, Serving PLMN Rate Control
    change, APN Rate Control change), tariff time change or failure
    handling procedure triggering. When this event is encountered, all
    current configured counts and time stamps are captured and new counts
    and time stamps for all active service data flows are started.

  -  Intersystem change (e.g. change of radio interface from GSM to UMTS,
    RAT change) visible in the P-GW. This event closes the PGW-CDR, and a
    new one is opened if the IP-CAN bearer is still active.

  -  PLMN change visible in the P-GW. This event closes the PGW-CDR. A new
    one is opened if the IP-CAN bearer is still active.

  -  MS Timezone change visible in the P-GW. This event closes the PGW-CDR.
    A new one is opened if the IP-CAN bearer is still active.

  -  MO exception data counter receipt in the P-GW: This event closes the
    CDR. A new one is opened if the IP-CAN bearer is still active.

  -  SGSN change in the P-GW. New SGSN address is added to PGW-CDR.

  -  Expiry of an operator configured report of service flow data limit per
    IP-CAN bearer. This event closes the PGW-CDR, and a new one is opened
    if the IP-CAN bearer is still active.

  -  Completion of a time envelope as defined in TS 32.299 [50]. This event
    closes a service data flow container. Further details are described in
    clause 5.2.3.4.1 "Triggers for PGW-CDR Charging Information Addition"'.
    The need for reporting time envelopes may be statically configured for
    each rating group or dynamically controlled by online charging.

Management intervention may also force trigger a chargeable event.

Relevant service data flows for a certain IP-CAN bearer are determined when
FBC is applied. PCC rules are used for this determination. One PCC rule
identifies service data flow to be measured but it can also include certain
characteristics related to that service data flow.

PCC rules can be activated, deactivated and modified any time during the IP-
CAN bearer lifetime. PCC rule activation, deactivation and modification are
not chargeable events. However these PCC rule changes may lead to "start of
service data flow" and "termination of service data flow" chargeable
events.

A PCC rule can contain e.g.:

  -  service data flow template (service data flow filters or application
    identifier) to identify packets belonging to certain service data flow,



  -  charging method to identify whether online/offline/both/neither
    charging interface is used,

  -  measurement method for offline charging to identify whether
    time/volume/events are measured for this service data flow,

  -  Charging key (i.e. rating group) for that service data flow,

  -  service identifier for that service data flow,

  -  Sponsor Identifier (offline charging only),

  -  Application Service Provider Identifier (offline charging only),

  -  application function record information to correlate the measurement
    with application level reports,

  -  reporting level for the service data flow (rating group, combination
    of the rating group and service id or combination of the rating group,
    sponsor identity and application service provider identity),

  -  precedence to the situations where two or more PCC rules are
    overlapping,

  -  allowed access type (for NBIFOM control) See clause 5.2.1.7A..

PCC rules can be:

  -  pre-defined in P-GW (can be activated either by the PCRF or PCEF
    itself) or,

  -  dynamically provisioned and activated by the PCRF over the Gx
    interface.

This is specified in TS 23.203 [215] and TS 29.212 [216].

According to TS 23.203 [215] , the PCRF can modify the following charging
information in a dynamic PCC rule which is active in the PCEF: Charging
key, Service identifier, Sponsor Identifier, Application Service Provider
Identifier, Measurement method, and reporting level The PCRF can also
modify the allowed access type in the case of NBIFOM.. A change of any of
this charging or allowed access type information will trigger a "start of
service data flow" chargeable event when a valid counter does not exist
corresponding to that changed PCC rule. A change of any of this charging or
allowed access type information will trigger a "termination of service data
flow" chargeable event when this was the last active service data flow for
the counter corresponding to the original PCC rule.

When the CDF is implemented as a separate entity,  all these FBC related
chargeable events,  trigger charging events  reporting, for P-GW CDRs to be
constructed, enriched or closed by CDF, according to description in clause
5.2.2.

Extended packet inspection can be done in the PCEF with pre-defined PCC
rules. The PCEF also have the possibility to output service specific
information related to the packet inspection in the CDR.

The capability of P-GW to support ABC is achieved with PCRF providing
appropriate PCC rules to the P-GW. Such PCC Rule shall be defined with
service data flow template including an Application Identifier for the
application which needs to be detected, enforced and charged.

For non-IP type PDN connection in the P-GW:

  -  non-3GPP access types are not supported, a multi-access PDN
    connections do not apply;

  -  A single PCC Rule is used with the service data flow descriptor
    matching the whole non-IP data traffic, and can contain e.g.:

    -  service data flow template matching all the packets;

    -  charging method to identify whether online/offline/both/neither
       charging interface is used;

    -  measurement method for offline charging to identify whether
       time/data volume/events are measured for this service data flow;

    -  Charging key (i.e. rating group) for that service data flow;

    -  service identifier for that service data flow;

    -  reporting level for that service data flow:

       -  rating group level in case a specific rating group is used for non-
         IP traffic charging;

       -  combination of the rating group and service id in case a specific
         rating group/service Id is used for non-IP traffic charging.




5.2.1.4  SMS charging

The SGSN and the MME collect charging information for each Short Message
sent to, or received by, a MS/UE.
There are two chargeable events for SMS charging in the SGSN and MME:

  -  the transfer of a SM through the SGSN and MME in MO direction;

  -  the transfer of a SM through the SGSN and MME in MT direction.

Management intervention may also force trigger a chargeable event.


5.2.1.5  LCS charging

The SGSN collects charging information for each Location Request for a
MS/UE.
The following chargeable events are specified for LCS:

  -  A location request for a MS/UE triggered by that MS/UE (LCS-MO);

  -  A location request for a MS/UE triggered by an external entity (LCS-
    MT);

  -  A location request for a MS/UE triggered by the network (LCS-NI).

Management intervention may also force trigger a chargeable event.



           5.2.1.6  MBMS context charging for GPRS

The SGSN and GGSN collects charging information for each MBMS bearer
service activated.
The following chargeable events are specified for MBMS:

  -  Start of MBMS bearer context. Upon encountering this event, a new CDR
    for this MBMS bearer context is created and the data volume is captured
    for the MBMS bearer context.

  -  End of MBMS bearer context in the SGSN/GGSN. For the SGSN only, this
    trigger includes inter-SGSN routing area update (e.g. the last UE using
    the MBMS bearer context leaves the routeing area).
    The MBMS bearer context CDR is closed upon encountering this trigger.

  -  Expiry of an operator configured time limit per MBMS bearer context.
    This event closes the MBMS bearer context CDR, and a new one is opened
    if the MBMS bearer context is still active.

  -  Expiry of an operator configured data volume limit per MBMS bearer
    context. This event closes the MBMS bearer context CDR, and a new one
    is opened if the MBMS bearer context is still active.

  -  Change of charging condition: tariff time change. When this event is
    encountered, the current volume count is captured and a new volume
    count is started.

  -  Expiry of an operator configured change of charging condition limit
    per MBMS bearer context. This event closes the MBMS bearer context CDR,
    and a new one is opened if the MBMS bearer context is still active.

Management intervention may also force trigger a chargeable event.


5.2.1.6A MBMS context charging for EPS

In EPS, MBMS GW is the function entity which may be stand alone or co-
located with other network elements such as BM-SC or combined S-GW/PDN-GW.
The MBMS GW collects charging information for each MBMS bearer service
activated. The following chargeable events are specified for MBMS:

  -  Start of MBMS bearer context. Upon encountering this event, a new CDR
    for this MBMS bearer context is created and the data volume is captured
    for the MBMS bearer context.

  -  End of MBMS bearer context in the MBMS GW.

  -  Expiry of an operator configured time limit per MBMS bearer context.
    This event closes the MBMS bearer context CDR, and a new one is opened
    if the MBMS bearer context is still active.

  -  Expiry of an operator configured data volume limit per MBMS bearer
    context. This event closes the MBMS bearer context CDR, and a new one
    is opened if the MBMS bearer context is still active.

  -  Change of charging condition: tariff time change. When this event is
    encountered, the current volume count is captured and a new volume
    count is started.

  -  Expiry of an operator configured change of charging condition limit
    per MBMS bearer context. This event closes the MBMS bearer context CDR,
    and a new one is opened if the MBMS bearer context is still active.

Management intervention may also force trigger a chargeable event.

The MBMS control plane function is supported by MME for E-UTRAN access and
by SGSN for UTRAN access.



           5.2.1.7  IP Flow Mobility (IFOM) charging

An "IFOM capable UE", as defined in TS 23.402 [209], may be simultaneously
connected to 3GPP access and WLAN access for different IP flows within the
same PDN connection, as described in TS 23.261 [212].
In the P-GW, FBC (as described in clause 5.2.1.3) applies to the
corresponding service data flows, carried by appropriate IP-CAN bearer(s)
activated for both accesses.

For a PDN connection, charging for each service data flow, is performed
within the IP-CAN bearer charging session of the IP-CAN bearer it belongs
to, according to its associated PCC Rule.

As described in TS 23.261 [212], the UE may also move one or more IP
flow(s) from 3GPP access to WLAN access (and reversely). The transfer of
the corresponding service data flow(s) from one access to the other access,
results in PCC Rule(s) removed from the IP-CAN bearer(s) of the source
access, leading to termination of service data flow", and PCC Rule(s)
installed into the IP-CAN bearer(s) of the target access.

For each service data flow, identified by its PCC Rule, this PCC Rule may
be provided with a different description depending on the access type where
it has to be enforced. In particular, the rating group may differ, as a way
to apply charging differentiation per-access type. The charging method,
measurement method, reporting level may also potentially be different, in
case charging behaviour is not expected to be unified between both domains.

In order to ensure the accurate level of granularity of service data flows
charging, the associated PCC Rule shall be defined with the service
identifier level reporting.

For the case where dynamic PCC is not deployed, per-access Charging
Characteristics and pre-defined  PCC Rule(s) in
P-GW may be used as a way to apply charging differentiation.


5.2.1.7A Network-Based IP Flow Mobility (NBIFOM) charging

To support Network-Based IP Flow Mobility (NBIFOM), multi-radio (i.e. 3GPP
and WLAN) capable UEs establish and maintain a PDN connection over both
3GPP access and WLAN access simultaneously for both S2b and S2a
connectivity, as specified in TS 23.161 [242]. When such a multi-access PDN
connection is established, there is one default bearer for each access. On
a multi-access PDN connection established over both 3GPP access and WLAN
access, it is possible to move individual IP flows from one access network
to another, when policies determine that flows should be moved and the
target access is available for the UE. As described in TS 23.203 [215], it
shall be possible to apply different rates depending on the access used to
carry a service data flow.

For a multi-access PDN connection, IP-CAN bearer charging as defined in
clause 5.2.1.1 and FBC as defined in clause 5.2.1.3 apply for each bearer
under each access for this PDN connection, and IP-CAN bearer charging as
defined in clauses 5.2.1.10.1 and FBC as defined in clauses 5.2.1.10.2
apply when charging per IP-CAN session is active for this PDN connection,
based on:

  -  Establishment of a multi-access PDN connection and addition of access
    to a multi-access PDN connection result in the default bearer and
    potential dedicated bearer(s) creation for this access, to carry the
    service data flows based on PCC Rule(s).

  -  Release of a multi-access PDN connection and removal of an access from
    a multi-access PDN connection result in release of all the IP-CAN
    bearer(s) for this access.

  -  Access change for service data flow(s), results in corresponding PCC
    Rule(s) removed from the IP-CAN bearer(s) of the source access, and PCC
    Rule(s) installed into the IP-CAN bearer(s) of the target access.

  -  Access of a multi-access PDN connection becomes unusable: for the
    service data flows maintained as result from PCC Rules decision, under
    the IP-CAN bearer that becomes unusable, no traffic will be detected.

  -  Access of a multi-access PDN connection becomes usable: for the
    service data flows which were maintained as result from PCC Rules
    decision under the IP-CAN bearer when detected as usable, the new
    traffic will be counted.



For each service data flow, identified by its PCC Rule, a different access
type is specified where it has to be enforced. A different rating group may
be used as a way to apply charging differentiation per-access type. The
charging method, measurement method, reporting level may also potentially
be different, in case charging behaviour is not expected to be unified
between both domains.

For the case where dynamic PCC is not deployed, per-access Charging
Characteristics and pre-defined  PCC Rule(s) in
P-GW may be used as a way to apply charging differentiation.


5.2.1.8  Sponsored data connectivity charging

According to TS 23.203 [215] two deployment scenarios exist for sponsored
data connectivity. The Sponsor Identifier and Application Service Provider
Identifier are provided for sponsored services to the PCRF from the AF over
the Rx interface.

In the first scenario the PCRF assigns a service specific Charging Key
(i.e. r atingg roup) for a sponsored IP flow. The Charging Key is used by
the PCEF to collect separate charging information for offline charging for
the sponsored flows. Correlation of charging information for offline
charging from multiple users per sponsor and/or application service
provider is then performed using the Charging Key.

In a second scenario the Sponsor Identifier and Application Service
Provider Identity is included in PCC-rules from the PCRF to the PCEF. For
this scenario, the same Charging Key may be used both for IP flows that are
sponsored and for flows that are not sponsored. Charging information
generated by the PCEF for offline charging include the Sponsor Identity and
the Application Service Provider Identity. Correlation of charging
information from multiple users per sponsor and/or application service
provider can then be based on Sponsor Identity and Application Service
Provider Identity instead of the Charging Key.



           5.2.1.9  Application Based Charging (ABC)


5.2.1.9.0   Introduction

For the sub-clauses that follow, a single CDR is defined to handle both TDF
session and ABC information when both are to be used. E ither TDF session
charging, ABC or both may be active as determined by Charging
Characteristics. For ABC the opening and closing of CDRs is bound to the
TDF session start and end respectively. Many application containers per TDF
session can be active simultaneously within the TDF CDR see clause
5.2.3.9.1.

When the CDF is implemented as a separate entity,  all of these TDF session
and ABC related chargeable events, trigger charging events  reporting, for
CDRs to be constructed, enriched or closed by CDF, according to clause
5.2.2.


5.2.1.9.1   Charging per application

ABC allows collection of charging information for network usage of
application traffic, categorized  within the TDF session by rating group or
combination of rating group and service identifier. ABC supported by TDF is
based on ADC rules. Details of this functionality are specified in
TS 23.203 [215].

  NOTE:  ABC is supported by the P-GW embedding PCEF enhanced with
         application detection and control functionality as defined in TS
         23.203 [215], by mean of appropriate PCC Rules, and therefore
         specified under FBC clause 5.2.1.3 and clause 5.2.1.10.2.

According to TS 23.203 [215], ABC shall support different charging models
per ADC rule.
These charging models may be based on volume and/or time and on number of
event matching specific detected application traffic in ADC rule. The
following chargeable events are defined for ABC when offline charging is
activated:

  -  Start of TDF session. Upon encountering this event, a new TDF-CDR for
    this context is created.

  -  Start of application traffic. If service identifier level reporting is
    required by the ADC rule, new counts and time stamps for this
    combination of the rating group and service identifier are started. If
    rating group level reporting is required by the ADC rule new counts and
    time stamps for this rating group are started. The type of counters
    shall depend on the measurement method configured for the ADC rule.
    When event based charging applies, the first occurrence of an event
    detected by the pre-defined ADC rules shall imply that a new count is
    started.
    When new events occur, the counter shall be increased. Each event shall
    be time stamped.

  -  Termination of application traffic. If service identifier level
    reporting is required by the ADC rule or if rating group level
    reporting is required by the ADC rule, the counters and time stamps are
    closed and added to the TDF-CDR.

  -  End of TDF session in the TDF. The TDF-CDR is closed upon encountering
    this trigger.

  -  Expiry of an operator configured time limit for keeping a CDR open.
    This event closes all counters. The resulting containers are data to
    the CDR and the CDR is closed. A new CDR is opened if the TDF session
    is still active.

  -  Expiry of an operator configured time limit per rating group. The
    counters and time stamps are closed and added to the TDF-CDR. A new
    application traffic container is opened if any application related to
    the rating group is still active.

  -  Expiry of an operator configured data volume limit per TDF session.
    This event closes the TDF-CDR, and a new one is opened if the TDF
    session is still active.

  -  Expiry of an operator configured data volume limit per rating group.
    The counters and time stamps are closed and added to the TDF-CDR. A new
    one is opened if any application related to the rating group is still
    active.

  -  Expiry of an operator configured data event limit per rating group.
    The counters and time stamps are closed and added to the TDF-CDR. A new
    one is opened if any application related to the rating group is still
    active.

  -  Expiry of an operator configured data event limit per TDF session.
    This event closes the TDF-CDRs, and new one is opened if the TDF
    session is still active.

  -  Change of charging condition: TDF session modification (e.g. SGSN
    change, S-GW change, user location change, user CSG information
    change), tariff time change or failure handling procedure triggering.
    When this event is encountered, all current configured counts and time
    stamps are captured and new counts and time stamps for all active
    applications are started.

  -  Intersystem change (e.g. change of radio interface from GSM to UMTS,
    RAT change) visible in the TDF. This event closes the TDF-CDR, and a
    new one is opened if the TDF session is still active.

  -  PLMN change visible in the TDF. This event closes the TDF-CDR. A new
    one is opened if the TDF session is still active.

  -  MS Timezone change visible in the TDF. This event closes the TDF-CDR.
    A new one is opened if the TDF session is still active.

  -  Completion of a time envelope as defined in TS 32.299 [50]. This event
    closes an application traffic container. Further details are described
    in clause 5.2.3.9.2 "Triggers for TDF-CDR Charging Information
    Addition". The need for reporting time envelopes may be statically
    configured for each rating group or dynamically controlled by online
    charging.

Management intervention may also force trigger a chargeable event.

ADC rules can be activated, deactivated and modified any time during the
TDF session lifetime. ADC rule activation, deactivation and modification
are not chargeable events of ABC. However these rule changes may lead to
"start of application traffic" and "termination of application traffic"
chargeable events.

Application Detection and Control rule can contain e.g.:

  -  Application Identifier to identify or service data flow filters to
    identify the packets belonging to an application detected application,

  -  charging method to identify whether online/offline/both/neither
    charging interface is used,

  -  measurement method for online/offline charging to identify whether
    time/volume/events are measured for this application,

  -  Charging key (i.e. rating group) for that application,

  -  service identifier for that application,

  -  reporting level for the application (rating group or combination of
    the rating group and Service identifier),

  -  precedence to the situations where two or more ADC rules are
    overlapping.

Application Detection and Control rule can be:

  -  pre-defined in TDF (can be activated by the PCRF) or,

  -  dynamically provisioned and activated by the PCRF over the Sd
    interface.

This is specified in TS 23.203 [215] and TS 29.212 [216].

According to TS 23.203 [215], the PCRF can modify the following charging
information in a dynamic ADC rule: Charging key, Service identifier,
Measurement method, and Service identifier level reporting. A change of any
of this charging information triggers a "start of application traffic"
chargeable event when a valid counter does not exist corresponding to that
changed ADC rule. A change of any of this charging information triggers a
"termination of application traffic" chargeable event when this was the
last active application for the counter corresponding to the original ADC
rules.



             5.2.1.9.2   Charging per TDF session

TDF collects charging information per user per TDF session. TDF session
charging allows the TDF to collect charging information related to data
volumes sent to and received by the UE/MS for the timeframe since the
establishment till the termination of TDF session. The user can be
identified by MSISDN and/or IMSI, while the TDF session can be determined
by a unique identifier generated by the P-GW (an "EPS default bearer
Charging Identifier" for GTP based connectivity or an "unique Charging Id"
for PMIP based connectivity  when establishing TDF session.

TDF session specific offline charging in TDF is achieved by ABC offline
charging, with a vendor specific rating group/service identifier associated
with the TDF session.The main collected information items are duration of
the TDF session and data volume transferred during the lifetime of the TDF
session. When Charging per TDF session is active, the following chargeable
events are defined:

  -  Start of TDF session. Upon encountering this event, a new TDF-CDR for
    this context is created.

  -  End of TDF session in the TDF. The TDF-CDR is closed upon encountering
    this trigger.

  -  Expiry of an operator configured time limit for keeping a CDR open.
    This event closes all counters. The resulting containers are data to
    the CDR and the CDR is closed. A new CDR is opened if the TDF session
    is still active.

  -  Expiry of an operator configured time limit per TDF session. This
    event closes the  CDR, and a new one is opened if the TDF session is
    still active.

  -  Expiry of an operator configured data volume limit per TDF session.
    This event closes the TDF-CDR, and a new one is opened if the TDF
    session is still active.

  -  Change of charging condition: TDF session modification (e.g. SGSN
    change, S-GW change, user location change, user CSG information
    change), tariff time change or failure handling procedure triggering.
    When this event is encountered, all current configured counts and time
    stamps are captured and new counts and time stamps for all active
    applications are started.

  -  Intersystem change (e.g. change of radio interface from GSM to UMTS,
    RAT change) visible in the TDF.
    This event closes the TDF-CDR, and a new one is opened if the TDF
    session is still active.

  -  PLMN change visible in the TDF. This event closes the TDF-CDR. A new
    one is opened if the TDF session is still active.

  -  MS Timezone change visible in the TDF. This event closes the TDF-CDR.
    A new one is opened if the TDF session is still active.

     Expiry of an operator configured change of charging condition limit
    per TDF session. This event closes the CDR, and a new one is opened if
    the TDF session is still active.

  NOTE:  All the events defined above are a shared events with ABC in
         clause 5.2.1.9.1 for the single shared CDR.

Management intervention may also force trigger a chargeable event.



           5.2.1.10 Charging per IP-CAN session


5.2.1.10.0  General

Charging per IP-CAN session is an optional capability in the P-GW that
provides for a consolidated view of the charging information across all
bearers in the IP-CAN session. When charging per IP-CAN session is active,
the basic principles in this clause apply to the P-GW instead of the
principles in clause 5.2.1.1 and clause 5.2.1.3 above.

For the sub-clauses that follow, a single PGW-CDR is defined to handle both
types of charging information when both are to be used. When Charging per
IP-CAN session is active, either IP-CAN bearer charging, FBC or both may be
active as determined by Charging Characteristics.

When the CDF is implemented as a separate entity, all of these IP-CAN
bearer and FBC related chargeable events,  trigger charging events
reporting, for CDRs to be constructed, enriched or closed by CDF, according
to description in clause 5.2.2.


5.2.1.10.1  IP-CAN bearer charging

For the purpose of interoperator charging, the P-GW collects charging
information per user per IP-CAN bearer.
In case the P-GW is not aware of IP-CAN bearers, i.e. in case of PMIP based
connectivity, P-GW collects charging information per IP-CAN session as it
would be one IP-CAN bearer. IP-CAN bearer charging allows the P-GW to
collect charging information related to data volumes sent to and received
by the UE/MS, categorised by the QCI and ARP applied to the IP-CAN bearer.
The user can be identified by MSISDN and/or IMSI, while the IP-CAN bearer
can be determined by a unique identifier generated by the P-GW when
creating an IP-CAN bearer. This identifier is forwarded to the S-GW/ePDG/
TWAG/SGSN so as to allow correlation of S-GW/ePDG/ TWAG/SGSN IP-CAN bearer
CDRs with the matching P-GW charging information in the BD.

The amount of data counted in P-GW shall be based on:

  -  in case of GTP based tunnelling and interworking with external IP
    networks; the inner IP packets in the GTP-U packet (T-PDU, see TS
    29.281 [217])

  -  in case of GTP based tunnelling and interworking with external
    networks handling other data services (e.g. non-IP, PPP); the T-PDU
    packets (see TS 29.281 [217])

  -  In case of PMIP based protocol; the payload of the GRE tunnel

  -  In case of DSMIPv6 based protocol; the payload of the tunnelling
    layer.

As minimum behaviour, the full payload shall be included. Time metering is
started when IP-CAN bearer is activated.

  NOTE 1:  The control plan address of the P-GW, together with the unique
         charging identifier assigned by the P-GW, enables the correlation
         of charging information. The control plane IP address of SGSN or P-
         GW (acting as GGSN) is the IP address used at Gn/Gp interface.
         The control plane IP address of S-GW or P-GW is the IP address used
         at S5/S8 interface.
         The control plane IP address of ePDG or P-GW is the IP address used
         at S2b interface.
         The control plane IP address of TWAG or P-GW is the IP address used
         at S2a interface.

When Charging per IP-CAN session is active and measurements for IP-CAN
bearers are captured in the same CDR as FBC measurements, the following
chargeable events are defined:

  -  Start of the default bearer for an IP-CAN session when single access
    is used or start of the first default bearer for a multi-access PDN
    connection (i.e., when NBIFOM is accepted by PCRF).
    Upon encountering this event, a new CDR for the IP-CAN session is
    created and the data volume counts
    (i.e., uplink and downlink) are started and captured for the IP-CAN
    bearer.

  NOTE 2:  Start of the default bearer or start of the first default bearer
         for an IP-CAN session is a shared event for FBC in clause
         5.2.1.10.2 for the single shared CDR.

  -  Addition of access to a PDN connection.
    Additional volume counts are started and captured for IP-CAN bearers of
    the access. New SGSN/S-GW/ePDG/TWAG address is added to data for the IP-
    CAN bearer in the CDR.

  -  Start of a dedicated bearer for an IP-CAN session.
    Additional volume counts are started and captured for the dedicated
    bearer.

  -  End of dedicated bearer in the P-GW.
    The counters and time stamps for the IP-CAN bearer are closed and
    resulting container added to the CDR.

  -  Removal of access from a multi-access PDN connection.
    The counters and time stamps for the IP-CAN bearers of the removed
    access are closed and resulting containers added to CDR.

  -  Access of a multi-access PDN connection becomes unusable.
    The counters and time stamps for the IP-CAN bearers of the unusable
    access are closed and resulting containers added to the CDR.

  -  Access of a multi-access PDN connection becomes usable.
    New volume counts are started and captured for all bearers of the
    access that has become usable. These may not be the same as those that
    were previously active when the access became unusable due to changes
    in PCC Rules.

  -  End of IP-CAN session (i.e. end of the default bearer for a single
    access PDN connection or end of the last default bearer for a multi-
    access PDN connection) in the P-GW.
    The counters and time stamps for all IP-CAN bearers and the resulting
    containers added to the CDR. The CDR is closed.

  NOTE 3:  The End of IP-CAN session event is a shared event for FBC in
         clause 5.2.1.10.2 for the single shared CDR.

  -  Serving node (e.g. SGSN/S-GW/ePDG/TWAG) change in the P-GW.
    New SGSN/S-GW/ePDG/TWAG address is added to data for the IP-CAN bearer
    in the CDR.

  -  Expiry of an operator configured time limit for keeping a CDR open.
    This event closes all counters. The resulting containers are added to
    the CDR and the CDR is closed.
    A new CDR is opened if the IP-CAN session is still active.

  NOTE 4:  The expiry of an operator configured time limit for keeping a
         CDR open event is a shared event for FBC in clause 5.2.1.10.2 for
         the single shared CDR.

  -  Expiry of an operator configured time limit per IP-CAN bearer.
    The counters and time stamps for the IP-CAN bearer are closed and added
    to the CDR. A new IP-CAN bearer traffic volume container is opened if
    the IP-CAN bearer is still active.

  -  Expiry of an operator configured data volume limit per IP-CAN session.

    This event closes the CDR and a new one is opened if the IP-CAN session
    is still active.

  NOTE 5:  The expiry of an operator configured data volume limit per IP-
         CAN session event is a shared event for FBC in clause 5.2.1.10.2
         for the single shared CDR.

  -  Expiry of an operator configured data volume limit per IP-CAN bearer.
    The counters and time stamps are closed and added to the CDR. A new IP-
    CAN bearer traffic volume container is opened if the IP-CAN bearer is
    still active.

  -  Change of charging condition specific to APN-AMBR change.
    This event closes the CDR, and a new one is opened if the IP-CAN
    session is still active.

  -  Change of charging condition specific to IP-CAN bearer modification
    QoS change.
    When this event is encountered, all counts and time stamps for the
    modified bearer are captured and new counts and time stamps for the
    specific bearer are started.

  -  Change of charging condition.
    IP-CAN bearer modification except QoS change (e.g. SGSN change, S-GW
    change, user location change, user CSG information change, change of UE
    presence in Presence Reporting Area(s) , change of 3GPP PS Data Off
    status, Serving PLMN Rate Control change, APN Rate Control change), or
    tariff time change. When this event is encountered, all current
    configured counts and time stamps are captured and new counts and time
    stamps for all active bearers are started.
    IP-CAN bearer modification except QoS change events are associated with
    one access of a multi-access PDN connection and all counts associated
    with affected access are identified with the specific event. All counts
    associated with the other access of a multi-access PDN connection are
    identified as an indirect change of charging condition.

  NOTE 7:  The change of charging condition event is a shared event for FBC
         in clause 5.2.1.10.2 for the single shared CDR.

  Editor’s Note: whether the special case of user location reporting on
         dedicated bearer release triggers a change of charging condition
         for the IP-CAN session is ffs.

  -  Intersystem change (e.g. change of radio interface from GSM to UMTS,
    RAT change) for any connected access visible in the P-GW.
    This event closes the CDR, and a new one is opened if the IP-CAN
    session is still active.

  NOTE 8:  The intersystem change event is a shared event for FBC in clause
         5.2.1.10.2 for the single shared CDR.

  -  PLMN change visible in the P-GW. This event closes the CDR.
    A new one is opened if the IP-CAN session is still active.

  NOTE 9:  The PLMN change event is a shared event for FBC in clause
         5.2.1.10.2 for the single shared CDR.

  -  MS Timezone change visible in the P-GW. This event closes the CDR.
    A new one is opened if the IP-CAN session is still active.

  NOTE 10: The MS Timezone change event is a shared event for FBC in clause
         5.2.1.10.2 for the single shared CDR.

  -  Expiry of an operator configured limit of number of charging condition
    changes per IP-CAN session.
    This event closes the CDR, and a new one is opened if the IP-CAN
    session is still active.

  NOTE 11: The expiry of an operator configured limit of number of charging
         condition changes event is a shared event for FBC in clause
         5.2.1.10.2 for the single shared CDR.

Management intervention may also force trigger a chargeable event.

  NOTE 12: For non-IP type PDN connection, the following do not apply:

         -  Addition of access to a PDN connection;

         -  Start of a dedicated bearer for an IP-CAN session;

         -  End of dedicated bearer in the P-GW;

         -  Removal of access from a multi-access PDN connection;

         -  Access of a multi-access PDN connection becomes unusable;

         -  Access of a multi-access PDN connection becomes usable.





             5.2.1.10.2  Flow Based Charging (FBC)

For the purpose of end-user charging, FBC is supported by the P-GW by the
integration of a PCEF. With PCEF, charging is enhanced by the capability to
categorise the service data flows within IP-CAN session data traffic by
rating group or combination of the rating group and service id. FBC
provides separate counts per each rating group, combination of the rating
group and service id or combination of rating group, sponsor identity and
application service provider identity. The level of the reporting is
defined per PCC rule. Details of this functionality are specified in
TS 23.203 [215] and TS 32.240 [1].

  NOTE 1:  Even though an individual service data flow template is bound to
         a specific IP-CAN bearer, the assigned rating group or combination
         of rating group and service id applies to the entire IP-CAN
         session.
         As a result, data traffic from multiple bearers can be included in
         the count maintained for the rating group or combination of the
         rating group and service id. This implies if an operator wishes to
         be able to separate usage according to IP-CAN bearer within their
         billing system they will need to ensure that services having
         different QCI and ARP do not have the same:

         -  rating group in cases where rating group reporting is used;

         -  rating group/service id where rating group/service id reporting
           is used;

         -  rating group/sponsor identity/application service provider
           identity where sponsored connectivity level reporting is used.

  NOTE 2:  The P-GW can only include one QoS Information occurrence per
         service data container.
         This implies if an operator wishes to be able to separate usage
         according to QCI and ARP within their billing system they will need
         to ensure that services having different QCI and ARP do not have
         the same:

         -  rating group in cases where rating group reporting is used;

         -  rating group/service id where rating group/service id reporting
           is used ;

         -  rating group/sponsor identity/application service provider
           identity where sponsored connectivity level reporting is used.

  NOTE 2a: The P-GW can only include one RAT type per service data
         container.
         This implies if an operator wishes to be able to separate usage
         according to RAT type within their billing system they will need to
         ensure that services having different RAT type do not have the
         same:

         -  rating group in cases where rating group reporting is used;

         -  rating group/service id where rating group/service id reporting
           is used;

         -  rating group/sponsor identity/application service provider
           identity where sponsored connectivity level reporting is used.

According to TS 23.203 [215], FBC shall support different charging models
per PCC rule. These charging models may be based on volume and/or time and
on number of events matching a specific service data flow template in PCC
rule.

When Charging per IP-CAN session is active and FBC measurements are
captured in the same CDR as measurements for IP-CAN bearers, the following
chargeable events are defined:

  -  Start of the default bearer for an IP-CAN session when single access
    is used ors tart of the first default bearer for a multi-access PDN
    connection(i.e., when NBIFOM is accepted by PCRF). Upon encountering
    this event, a new CDR for the IP-CAN session is created. No service
    data flow counters are started.

  NOTE 3:  The start of the default bearer or the start of the first
         default bearer for an IP-CAN session event is a shared trigger for
         IP-CAN bearer charging in clause 5.2.1.10.1 for the single shared
         CDR.

  -  Start of service data flow.
    If service identifier level reporting is required by the PCC rule, and
    no counts are present already for this combination of the rating group
    and service id, then new counts and time stamps for this combination of
    the rating group and service id are started. If rating group level
    reporting is required by the PCC rule, and no counts are present
    already for this rating group, then new counts and time stamps for this
    rating group are started. If sponsored connectivity level reporting is
    required by the PCC rule, and no counts are present already for this
    combination of rating group, sponsor identity and application service
    provider identity, then new counts and time stamps for this rating
    group are started. The type of counters shall be according to the
    measurement method configured for the PCC rule. When event based
    charging applies, the first occurrence of an event matching a service
    data flow template in PCC rule shall imply that a new count is started.
    When new events occur, the counter shall be increased. Each event shall
    be time stamped.

  -  Access change of service data flow.
    If service identifier level reporting is required by the PCC rule and
    all service data flows for this combination of the rating group and
    service id are changing from one access to another, or if rating group
    level reporting is required by the PCC rule and all service data flows
    for this rating group are changing from one access to another, or if
    sponsored connectivity level reporting is required by the PCC rules and
    all service data flows for this combination of rating group, sponsor
    identity and application service provider identity are changing from
    one access to another, the counters and time stamps are closed and the
    resulting containers added to the CDR.

  -  Termination of service data flow. If service identifier level
    reporting is required by the PCC rule and this was the last active
    service data flow for this combination of the rating group and service
    id or if rating group level reporting is required by the PCC rule and
    this was the last active service data flow for this rating group, or if
    sponsored connectivity level reporting is required by the PCC rule and
    this was the last active service data flow for this combination of
    rating group, sponsor identity and application service provider
    identity, the counters and time stamps are closed and the resulting
    containers added to the CDR. For information on how the termination of
    service data flows is detected, refer to TS 23.203 [215].

  -  End of IP-CAN session (i.e. end of the default bearer for a single
    access PDN connection or end of the last  bearer for a multi-access PDN
    connection) in the P-GW.
    The counters and time stamps for all rating groups and all combinations
    of rating group and service id are closed and the resulting containers
    added to the CDR. The CDR is closed.

  NOTE 4:  The end of IP-CAN session event is a shared event for IP-CAN
         Bearer Charging in clause 5.2.1.10.1 for the single shared CDR.

  -  Expiry of an operator configured time limit for keeping a CDR open.
    This event closes all counters. The resulting containers are added to
    the CDR and the CDR is closed.
    A new CDR is opened if the IP-CAN session is still active.

  NOTE 5:  The end of operator configured time limit for keeping a CDR open
         event is a shared event for IP-CAN Bearer Charging in clause
         5.2.1.10.1 for the single shared CDR.

  -  Expiry of an operator configured time limit per rating group.
    The counters and time stamps are closed and added to the CDR.
    A new service data flow container is opened if any matching service
    data flow is still active.

  -  Expiry of an operator configured data volume limit per IP-CAN session.

    This event closes the CDR and a new one is opened if the IP-CAN session
    is still active.

  NOTE 6:  The expiry of an operator configured data volume limt per IP-CAN
         session event is a shared event for
         IP-CAN bearer charging in clause 5.2.1.10.1 for the single shared
         CDR.

  -  Expiry of an operator configured data volume limit per rating group.
    The counters and time stamps are closed and added to the CDR.
    A new service data flow container is opened if any matching service
    data flow is still active.

  -  Expiry of an operator configured data event limit per IP-CAN session.
    This event closes the CDR and a new one is opened if the IP-CAN session
    is still active.

  NOTE 7:  The expiry of an operator configured data event limit per IP-CAN
         session event is a shared event for IP-CAN bearer charging in
         clause 5.2.1.10.1 for the single shared CDR.

  -  Expiry of an operator configured data event limit per rating group.
    The counters and time stamps are closed and added to the CDR.
    A new service data flow container is opened if any matching service
    data flow is still active.

  -  Change of charging condition.
    IP-CAN bearer modification except QoS change (e.g. SGSN change, S-GW
    change, user location change,
    user CSG information change, change of UE presence in Presence
    Reporting Area(s)), tariff time change or failure handling procedure
    triggering.
    When this event is encountered, all current configured counts and time
    stamps are captured and new counts and time stamps for all service data
    flows are started.
    IP-CAN bearer modification except QoS change events are associated with
    one access of a multi-access PDN connection and all counts associated
    with affected access are identified with the specific event.A ll counts
    associated with the other access of a multi-access PDN connection are
    identified as an indirect change of charging condition.

  Editor’s Note: The handling of  "Serving PLMN Rate Control change", "APN
         Rate Control change" events when charging per IP-CAN session
         applies is FFS.

  NOTE 8:  The change of charging condition event is a shared event for IP-
         CAN bearer charging in clause 5.2.1.10.1 for the single shared CDR.



  Editor’s Note: whether the special case of user location reporting on
         dedicated bearer release triggers a change of charging condition
         for the IP-CAN session is ffs.

  -  Intersystem change (e.g. change of radio interface from GSM to UMTS,
    RAT change) for any connected access visible in the P-GW.
    This event closes the CDR, and a new one is opened if the IP-CAN
    session is still active.

  NOTE 9:  The intersystem change event is a shared event for IP-CAN bearer
         charging in clause 5.2.1.10.1 for the single shared CDR.

  -  PLMN change visible in the P-GW.
    This event closes the CDR. A new one is opened if the IP-CAN session is
    still active.

  NOTE 10: The PLMN change event is a shared event for IP-CAN bearer
         charging in clause 5.2.1.10.1 for the single shared CDR.

  -  MS Timezone change visible in the P-GW.
    This event closes the CDR. A new one is opened if the IP-CAN session is
    still active.

  NOTE 11: The MS Timezone change event is a shared event for IP-CAN bearer
         charging in clause 5.2.1.10.1 for the single shared CDR.

  -  Expiry of an operator configured limit of charging condition changes
    per IP-CAN session.
    This event closes the CDR, and a new one is opened if the IP-CAN
    session is still active.

  NOTE 12: The expiry of an operator configured limit of charging condition
         changes per IP-CAN session event is a shared event for IP-CAN
         bearer charging in clause 5.2.1.10.1 for the single shared CDR.

  -  Completion of a time envelope as defined in TS 32.299 [50].
    This event closes a service data flow container. Further details are
    described in clause 5.2.3.10.1 "Triggers for PGW-CDR charging
    information addition'".
    The need for reporting time envelopes may be statically configured for
    each rating group or dynamically controlled by online charging.

Management intervention may also force trigger a chargeable event.

Relevant service data flows for an IP-CAN session are determined when FBC
is applied. PCC rules are used for this determination. One PCC rule
identifies service data flow to be measured but it can also include certain
characteristics related to that service data flow.

PCC rules can be activated, deactivated and modified any time during the IP-
CAN session lifetime.
IP-CAN bearer deactivation also leads to deactivation of all PCC rules
associated with that bearer.
PCC rule activation, deactivation and modification are not chargeable
events.
However these PCC rule changes may lead to "start of service data flow'"and
"termination of service data flow'" chargeable events.

According to TS 23.203 [215], the PCRF can modify the following charging
information in a dynamic PCC rule which is active in the PCEF: Charging
key, Service identifier, Sponsor Identifier, Application Service Provider
Identifier, IP-CAN types, Measurement method and reporting level. The PCRF
can also modify the allowed access type in the case of NBIFOM.
A change of allowed access type in the case of NBIFOM will trigger an
"access change for service data flow" chargeable event when all service
data flows for the associated counter are changed from one access to
another and takes priority over change of charging information.
A change of any of this charging information will trigger a "start of
service data flow'" chargeable event when a valid counter does not exist
corresponding to that changed PCC rule.
A change of any of this charging information will trigger a "termination of
service data flow'" chargeable event when this was the last active service
data flow for the counter corresponding to the original PCC rule.

Removal of an access from a PDN connection is not a trigger for FBC.
Subsequent PCC rule handling, may lead to the "access change for a service
data flow" or "termination of service data flow" events for the service
data flows that were active on the removed access.

Extended packet inspection can be done in the PCEF with pre-defined PCC
rules.
The PCEF also have the possibility to output service specific information
related to the packet inspection in the CDR.

The capability of P-GW to support ABC is achieved with PCRF providing
appropriate PCC rules to the P-GW. Such PCC Rule shall be defined with
service data flow template including an Application Identifier for the
application which needs to be detected, enforced and charged.

For non-IP type PDN connection:

  -  non-3GPP access types are not supported;

  -  multi-access PDN connections do not apply;

  -  A single PCC Rule is used with the service data flow descriptor
    matching the whole non-IP data traffic, and can contain e.g.:

    -  service data flow template matching all the packets;

    -  charging method to identify whether online/offline/both/neither
       charging interface is used;

    -  measurement method for offline charging to identify whether
       time/data volume/events are measured for this service data flow;

    -  Charging key (i.e. rating group) for that service data flow;

    -  service identifier for that service data flow;

    -  reporting level for that service data flow:

       -  rating group level in case a specific rating group is used for non-
         IP traffic charging;

       -  combination of the rating group and service id in case a specific
         rating group/service Id is used for non-IP traffic charging.


5.2.1.11 Data Volume Reporting for Secondary RAT usage


5.2.1.11.1  General

Volume reporting for Secondary RAT is an optional capability in the S-GW
and P-GW that provides accounting functionality when a Secondary RAT is
used in conjunction with E-UTRAN. This is valid for both HPLMN and VPLMN.

To align with existing per IP-CAN bearer accounting procedures, the
following principles are used:

   - The reporting of Secondary RAT Data Volume is controlled by the E-
    UTRAN.

   - The uplink and downlink data volumes for the Secondary RAT are
    reported (from E-UTRAN to EPC) on a per EPS bearer basis. The report
    contains Secondary RAT (e.g. NR) resources used for transport of user
    data and indicated separately for uplink and downlink per EPS bearer
    and per time interval. The time interval used for the measurements
    reported (from RAN) may be partitioned to indicate usage that occurred
    before respectively after an absolute time (that occurs while
    measurement for secondary RAT usage report is ongoing). For example,
    the RAN is configured to partition reports in usage, that occurred
    before respectively after midnight.

   - The reporting (performed by E-UTRAN) in association with UE-related
    control signaling and via standalone reporting is internally triggered
    by E-UTRAN.



         5.2.2  Rf message flows


5.2.2.0  General

When the CDF is implemented as a separate entity, the offline charging
functionality is based on the PCN nodes (MME, S-GW, ePDG, TWAG, P-GW and
TDF) reporting charging information for chargeable events. This reporting
is achieved by sending Charging Data Request [start, interim, stop and
event] from the PCN network elements to the CDF.

The PCNs shall use the Charging Characteristics profiles to determine
whether Charging events (Charging Data Request[start, interim, stop and
event]) reporting has to be activated or not.

The trigger conditions for the chargeable events described in 5.2.3.5 for
the MME, 5.2.3.3 for the S-GW, 5.2.3.8 for the ePDG, 5.2.3.11 for the TWAG,
5.2.3.9 for the TDF and in 5.2.3.4 for the P-GW are also applicable, and
charging events are reported to the external CDF when these trigger
conditions are met.

The following clauses provide the charging events reporting description for
MME, S-GW, ePDG, TWAG, P-GW and TDF.


5.2.2.1  Triggers for charging events from S-GW

When a Charging Event is reported to the CDF, it includes details such as
Subscription id (e.g. IMSI..), Charging-id, SGW address etc. and also a
container identifying, for the IP-CAN bearer, the volume count (separated
for uplink and downlink traffic), with charging condition change
information.

  As stated above, the same trigger conditions described in 5.2.3.3 are
    applicable for charging information addition and Charging Data Request
    closure.

  Charging Data Request[Start] is sent at IP-CAN bearer activation.

  For an Charging Data Request[Interim] to be sent with only one container
    reported, the Partial Record Reason "Maximum number of charging
    condition changes" should be set to value 1.


5.2.2.2  Triggers for charging events from P-GW

When a Charging Event is reported to the CDF, it includes details such as
Subscription id (e.g. IMSI), Charging-id, SGW address, ePDG address, TWAG
address, FBC specific charging data etc.,and also a container identifying
per rating group or combination of the rating group and service id within
the same IP-CAN bearer; the volume counts (separated for uplink and
downlink traffic), elapsed time and/or number of events, with associated
charging condition change information.

  As stated above, the same trigger conditions described in clause 5.2.3.4
    are applicable for charging information addition and Charging Data
    Request closure.

  Charging Data Request[Start] is sent at IP-CAN bearer activation.

  For an Charging Data Request[Interim] to be sent with only one container
    reported, the Partial Record Reason "Maximum number of charging
    condition changes" should be set to value 1.

  Editor's Note : tight interworking with online charging and DCCA failure
         handling is FFS.


5.2.2.3  Triggers for charging events from ePDG

When a Charging Event is reported to the CDF, it includes details such as
Subscription id (e.g. IMSI), Charging-id, ePDG address etc. and also a
container identifying for the IP-CAN bearer, the volume count (separated
for uplink and downlink traffic), with charging condition change
information.

  As stated above, the same trigger conditions described in clause 5.2.3.8
    are applicable for charging information addition and Charging Data
    Request closure.

  Charging Data Request[Start] is sent at IP-CAN bearer activation.

  For an Charging Data Request[Interim] to be sent with only one container
    reported, the Partial Record Reason "Maximum number of charging
    condition changes" should be set to value 1.


5.2.2.4  Triggers for charging events from MME

Each Short Message transferred through the MME to/from the SMSC, triggers a
Charging Event towards the CDF:

  -  Short Message received by a UE via the MME (MT direction) from the
    SMSC;

  -  Short Message sent by a UE via the MME (MO direction) to the SMSC.

This Charging event reporting is achieved by the MME in Event mode, by
sending Charging Data Request[event] to the CDF, on successful or
unsuccessful Short Message transfert transaction with UE.


5.2.2.5  Triggers for charging events from TDF

When a Charging Event is reported to the CDF, it includes details such as
Subscription id (e.g. IMSI.), Charging-id, SGW address, ePDG address, TWAG
address, ABC specific charging data etc., and also a container identifying
per rating group or combination of the rating group and service id within
the same TDF session; the volume counts (separated for uplink and downlink
traffic), elapsed time and/or number of events, with associated charging
condition change information TDF session charging is achieved by ABC
offline charging with vendor specific rating group or a combination of
vendor specific rating group and service id within the same TDF session,
see clause 5.2.1.9..

As stated above, the same trigger conditions described in 5.2.3.9 are
applicable for charging information addition and Charging Data Request
closure.

Charging Data Request Start] is sent at TDF session activation.

For an Charging Data Request[Interim] to be sent with only one container
reported, the Partial Record Reason "Maximum number of charging condition
changes" should be set to value 1.


5.2.2.6  Triggers for charging events from P-GW when charging per IP-CAN
           session is active

When a Charging Event is reported to the CDF and charging per IP-CAN
session is active, it includes details such as Subscription id (e.g. IMSI),
Charging-id, SGW address, ePDG address, TWAG address, FBC specific charging
data etc.,and contains either one or both of the following different types
of containers:

  -  traffic volumes, used for IP-CAN bearer charging, identifying per
    QCI/ARP combination, the volume counts (separated for uplink and
    downlink traffic) with associated charging condition change information

  -  service data, used for FBC, identifying per rating group or
    combination of the rating group and service id within the IP-CAN
    session, the volume counts (separated for uplink and downlink traffic),
    elapsed time and/or number of events, with associated charging
    condition change information.

The trigger conditions described in clause 5.2.3.10 are applicable for
charging information addition and Charging Data Request closure.

Charging Data Request[Start]  is sent at IP-CAN session activation.

For an Charging Data Request[Interim] to be sent with only one container
reported, the Partial Record Reason "Maximum number of charging condition
changes" should be set to value 1.


5.2.2.7  Triggers for charging events from TWAG

When a Charging Event is reported to the CDF, it includes details such as
Subscription id (e.g. IMSI), Charging-id, TWAG address etc. and also a
container identifying for the IP-CAN bearer, the volume count (separated
for uplink and downlink traffic), with charging condition change
information.

  As stated above, the same trigger conditions described in clause 5.2.3.11
    are applicable for charging information addition and Charging Data
    Request closure.

  Charging Data Request [Start] is sent at IP-CAN bearer activation.

  For an Charging Data Request [Interim] to be sent with only one container
    reported, the Partial Record Reason "Maximum number of charging
    condition changes" should be set to value 1.





         5.2.3  CDR generation


5.2.3.0  Introduction

The S-CDR, M-CDR, S-SMO-CDR, S-SMT-CDR, LCS-MO-CDR, LCS-MT-CDR, LCS-NI-CDR
and S-MB-CDR are generated by the SGSN, the S-SMO-CDR, S-SMT-CDR by the
MME,the SGW-CDR by the S-GW, the ePDG-CDR by the ePDG, the TWAG-CDR by the
TWAG, the PGW-CDR and G-MB-CDR by the P-GW, the TDF-CDR by the TDF to
collect charging information that they subsequently transfer to the
Charging Gateway Function (CGF).

The PCNs shall use the Charging Characteristics to determine whether to
activate or deactivate CDR generation.
The Charging Characteristics are also used to set the coherent chargeable
event conditions (e.g. time/volume limits that trigger CDR generation or
information addition). Multiple Charging Characteristics "profiles" may be
configured on the PCNs to allow different sets of trigger values. Further
details of this functionality, including the mechanism of conveying the
Charging Characteristics data item (HLR -> SGSN -> P-GW, HSS -> MME/ S4-
SGSN -> S-GW -> P-GW, AAA -> ePDG -> P-GW, or AAA -> TWAG -> PGW), are
specified and then in case of TDF, P-GW -> PCRF -> TDF in annex A.
Charging Characteristics are not applicable to MBMS CDR generation.

If CDR generation is activated, it shall be possible to define separate
trigger conditions values per Charging Characteristics profile for the
following triggers:

  -  data volume limit;

  -  time (duration limit);

  -  maximum number of charging conditions changes (QoS change, Tariff Time
    change).

The following clauses describe the trigger conditions for the chargeable
events described in clause 5.2.1.1 – 5.2.1.6A.
In EPC offline charging, these chargeable events correspond to the triggers
for collection of charging information and CDR generation by the SGSN/
MME/S-GW/ePDG/ TWAG/P-GW/TDF.



           5.2.3.1  Triggers for S-CDR charging information collection


5.2.3.1.0   General

An S-CDR is used to collect charging information related to the IP-CAN
bearer data information for a MS/UE in the SGSN.

If according to the Charging Characteristics, CDR generation is activated
an S-CDR shall be opened at IP-CAN bearer activation, and the volume for
the context is counted separately in uplink and downlink direction. When a
change of charging condition occurs, the volume count is added to the S-CDR
and a new count is started. The S-CDR includes details such as Record Type,
Served IMSI, Sequence Number etc. Not all of the charging information to be
collected is static, and other charging information is directly depending
on dynamic Packet-Switched service usage.

The subsequent clauses identify in detail the conditions for adding
information to, and closing the S-CDR for generation towards the CGF.


5.2.3.1.1   Triggers for S-CDR charging information addition

The "List of Traffic Volumes" attribute of the S-CDR consists of a set of
containers, which are added when specific trigger conditions are met, and
identify the volume count per IP-CAN bearer, separated for uplink and
downlink traffic, on encountering that trigger condition. Table 5.2.3.1.1.1
identifies which conditions are supported to trigger S-CDR charging
information addition.

     Table 5.2.3.1.1.1: Triggers for S-CDR charging information addition

|Trigger       |Description/Behaviour                                      |
|Conditions    |                                                           |
|QoS Change    |A change in the QoS shall result in a "List of Traffic Data|
|              |Volumes" container being added to the CDR.                 |
|Tariff Time   |On reaching the Tariff Time Change a "List of Traffic Data |
|Change        |Volumes" container shall be added to the CDR.              |
|User CSG      |A change in user CSG information shall result in a "List of|
|Information   |Traffic Data Volumes" container being added to the CDR, if |
|change        |CSG information reporting is required, and a report of User|
|              |CSG information change is received.                        |
|Direct Tunnel |When the SGSN establishes or removes a Direct Tunnel a     |
|establishment/|"List of Traffic Data Volumes " container shall be added to|
|removal       |the CDR. See NOTE.                                         |
|CDR Closure   |A list of "List of Traffic Data Volumes" container shall be|
|              |added to the S-CDR.                                        |
|NOTE: When a direct tunnel is established, the SGSN will no longer be able |
|to count data volumes associated with the IP-CAN bearer for which the      |
|direct tunnel is established                                               |


The first volume container of a IP-CAN bearer identifies the
uplink/downlink volume since the IP-CAN bearer was opened. Subsequent
volume containers store the volume count accrued since the closure of the
last container.



             5.2.3.1.2   Triggers for S-CDR closure

The S-CDR shall be closed on encountering some trigger conditions.
Table 5.2.3.1.2.1 identifies which conditions are supported to permit
closure of the S-CDR.

                Table 5.2.3.1.2.1: Triggers for S-CDR closure

|Closure        |Description/Behaviour                                      |
|Conditions     |                                                           |
|End of IP-CAN  |Deactivation of the IP-CAN bearer in the SGSN shall result |
|bearer within  |in the CDR being closed.                                   |
|the SGSN       |The trigger condition covers:                              |
|               |- termination of IP-CAN bearer;                            |
|               |- SGSN change (inter-SGSN routing area update including    |
|               |intersystem change);                                       |
|               |- any abnormal release.                                    |
|Partial Record |OAM&P reasons permit the closure of the CDR for internal   |
|Reason         |reasons.                                                   |
|               |The trigger condition covers:                              |
|               |- data volume limit;                                       |
|               |- time (duration) limit;                                   |
|               |- maximum number of charging condition changes (QoS/tariff |
|               |time change);                                              |
|               |- management intervention;                                 |
|               |- Intra-SGSN intersystem change (change of radio interface |
|               |from GSM to UMTS or vice versa).                           |


The Partial Record generation trigger thresholds are those associated with
the Charging Characteristics.
The Partial Record generation trigger thresholds are GSN configuration
parameters defined per Charging Characteristics profile by the operator
through OAM&P means, as specified in annex A.

In the event that the S-CDR is closed and the IP-CAN bearer remains active,
a further S-CDR shall be opened with an incremented Sequence Number in the
SGSN.



           5.2.3.2  Triggers for M-CDR charging information collection


5.2.3.2.0   General

An M-CDR is used to collect charging information related to the mobility
management of a mobile in the SGSN.

An M-CDR shall be opened for each mobile upon GPRS Attach, indicating the
current location information for that MS/UE. When a location change occurs
for the attached MS/UE, the new location information is added to the M-CDR.
The M-CDR records details such as Record Type, Served IMSI, Sequence Number
etc.
Not all of the charging information to be collected is static, and other
charging information is directly dependent on the mobility of the MS as
provided by the Radio Access Network (RAN). Subsequent partial records may
be opened if the M-CDR is closed and the MS is still attached to the
network.

The subsequent clauses identify in detail the conditions for adding
information to, and closing of the M-CDR for generation towards the CGF.


5.2.3.2.1   Triggers for M-CDR charging information addition

The "Change of Location" attribute of the M-CDR consists of a set of
containers, which are added when specific trigger conditions are met, and
identify the time stamped routing area on encountering that trigger
condition.
Table 5.2.3.2.1.1 identifies which conditions are supported to trigger M-
CDR charging information addition.

     Table 5.2.3.2.1.1: Triggers for M-CDR charging information addition

|Trigger     |Description/Behaviour                      |
|Conditions  |                                           |
|Mobility    |The first "Change of Location" container   |
|Change      |shall be captured                          |
|            |when the MM context is created.            |
|            |Subsequent changes in the Routing Area     |
|            |shall result in a                          |
|            |"Change of Location" container being added |
|            |to the M-CDR.                              |



5.2.3.2.2   Triggers for M-CDR closure

The M-CDR shall be closed on encountering some trigger conditions.
Table 5.2.3.2.2.1 identifies which conditions are supported to permit
closures of the M-CDR.

                Table 5.2.3.2.2.1: Triggers for M-CDR closure

|Closure Conditions  |Description/Behaviour                             |
|End of MM Context   |Deactivation of the MM context in the SGSN shall  |
|within SGSN         |result in the CDR being closed.                   |
|                    |The trigger condition covers:                     |
|                    |- SGSN change (inter-SGSN routing area update     |
|                    |including intersystem change);                    |
|                    |- GPRS detach;                                    |
|                    |- any abnormal release.                           |
|Partial Record      |OAM&P reasons permit the closure of the CDR for   |
|Reason              |internal reasons.                                 |
|                    |The trigger condition covers:                     |
|                    |- time (duration) limit;                          |
|                    |- maximum number of mobility changes; and         |
|                    |- Management intervention;                        |
|                    |- Intra-SGSN intersystem change (change of radio  |
|                    |interface                                         |
|                    |from GSM to UMTS or vice versa).                  |


The Partial Record generation trigger thresholds are those associated with
the Charging Characteristics.
The Partial Record generation trigger thresholds are SGSN configuration
parameters defined per Charging Characteristics profile by the operator
through OAM&P means, as specified in annex A.

In the event that the M-CDR is closed and the mobile is still known to the
SGSN, a further M-CDR shall be opened with an incremented Sequence Number
in the SGSN.



           5.2.3.3  Triggers for SGW-CDR charging information collection


5.2.3.3.0   Introduction

A SGW-CDR is used to collect charging information related to the IP-CAN
bearer data information for a UE/MS in
the S-GW.

SGW-CDR separates collected charging information per QCI/ARP pair. SGW-CDR
can include:

  - IP-CAN bearer specific container reporting the usage and authorized
    QCI/ARP for IP-CAN bearer.

Each SGW-CDR includes at least IP-CAN bearer specific container(s).

If, according to the Charging Characteristics, CDR generation is activated
a SGW-CDR shall be opened at IP-CAN bearer activation and IP-CAN bearer
specific container is opened..

When a change of charging condition occurs, the volume counts are added to
the SGW-CDR and new counts are started. The SGW-CDR includes details such
as Record Type, Served IMSI, Sequence Number etc.
Not all of the charging information to be collected is static, and other
charging information is directly dependent on dynamic Packet-Switched
service usage.

The subsequent clauses identify in detail the conditions for adding
information to, and closing the SGW-CDR for generation towards the CGF.


5.2.3.3.1   Triggers for SGW-CDR charging information addition

The "List of Traffic Data Volumes" attribute of the SGW-CDR consists of a
set of containers, which are added when specific trigger conditions are
met, and identify the volume count per QCI/ARP pair, separated for uplink
and downlink traffic, on encountering that trigger condition.
Table 5.2.3.3.1.1 identifies which conditions are supported to trigger SGW-
CDR charging information addition.

    Table 5.2.3.3.1.1: Triggers for SGW-CDR charging information addition

|Trigger        |Description/Behaviour                                      |
|Conditions     |                                                           |
|QoS Change     |A change in the QoS shall result that open "List of Traffic|
|               |Data Volumes" containers being closed and added to the CDR |
|               |and new IP-CAN bearer specific container is opened.        |
|Tariff Time    |On reaching the Tariff Time Change open "List of Traffic   |
|Change         |Data Volumes" containers shall be closed and added to the  |
|               |CDR.                                                       |
|User Location  |A change in the User Location Info (e.g. ECGI, TAI, RAI,   |
|Change         |SAI or CGI) shall result that open "List of Traffic Data   |
|               |Volumes" containers being closed and added to the CDR, if  |
|               |location reporting is required, and a report of User       |
|               |Location Change is received.                               |
|User CSG       |A change in the User CSG info (e.g. CSG ID, access mode or |
|Information    |CSG membership indication) shall result that open "List of |
|change         |Traffic Data Volumes" containers being closed and added to |
|               |the CDR, if CSG information reporting is required, and a   |
|               |report of User CSG information change is received.         |
|Change of UE   |A change of UE presence in Presence Reporting Area(s) shall|
|presence in    |result that open "List of Traffic Data Volumes" containers |
|Presence       |being closed and added to the CDR, if such reporting is    |
|Reporting Area |required, and a report that user enters/leaves the area or |
|               |the Presence Reporting Area(s) is set to inactive by the   |
|               |serving node , are received.                               |
|Change in UP to|A change in the User Plane to UE (i.e. switch between S11-U|
|UE             |and S1-U) shall result that open "List of Traffic Data     |
|               |Volumes" containers being closed and added to the CDR and  |
|               |new IP-CAN bearer specific container is opened.            |
|Serving PLMN   |A change in the Serving PLMN Rate Control shall result that|
|Rate Control   |open "List of Traffic Data Volumes" containers being closed|
|Change         |and added to the CDR and new IP-CAN bearer specific        |
|               |container is opened.                                       |
|CDR Closure    |Open "List of Traffic Data Volumes" containers shall be    |
|               |closed and added to the SGW-CDR.                           |


Volume container identifies the uplink/downlink volume since the closure of
the last container.
The "Serving Node Address" attribute of the SGW-CDR consists of a list of
serving node (e.g. S4-SGSN/MME) addresses. New serving node address is
added to the list when e.g. S4-SGSN/MME changes.

When Charging Event (ACR) is triggered by table 5.2.3.3.1.1 conditions, the
Change-Condition sub-field associated to the added volume container,
indicating the appropriate condition shall be present, excluding CDR
Closure case.
When Charging Event (ACR) is triggered by CDR Closure condition, this
Change-Condition sub-field associated to the added volume container shall
be omitted, except when CDR closure is due to "maximum number of charging
condition changes", where it shall be present with the original condition
change.

When Charging Event (ACR) is triggered by "User CSG Information change" as
a Change condition, the following shall apply for the added volume
container:

  -  When User enters in a CSG cell or a hybrid cell: the CSG ID, access
    mode and CSG membership indication (when hybrid), shall be provided
    together with this "User CSG Information change" Change-Condition.

  -  User leaves a CSG cell or a hybrid cell: this "User CSG Information
    change" Change-Condition shall be provided without any CSG ID, access
    mode and CSG membership indication, unless the user is entering a new
    CSG cell or hybrid cell.



             5.2.3.3.2   Triggers for SGW-CDR closure

The SGW-CDR shall be closed on encountering some trigger conditions.
Table 5.2.3.3.2.1 identifies which conditions are supported to permit
closure of the SGW-CDR.

               Table 5.2.3.3.2.1: Triggers for SGW-CDR closure

|Closure Conditions |Description/Behaviour                                  |
|End of IP-CAN      |Deactivation of the IP-CAN bearer in the S-GW shall    |
|bearer within the  |result in the CDR being closed.  The trigger condition |
|S-GW               |covers:                                                |
|                   |- termination of IP-CAN bearer;                        |
|                   |- inter serving node change;                           |
|                   |- any abnormal release.                                |
|Partial Record     |OAM&P reasons permit the closure of the CDR for        |
|Reason             |internal reasons.                                      |
|                   |The trigger condition covers:                          |
|                   |- data volume limit;                                   |
|                   |- time (duration) limit;                               |
|                   |- maximum number of charging condition changes         |
|                   |(QoS/tariff time change);                              |
|                   |- management intervention;                             |
|                   |- MS time zone change;                                 |
|                   |- PLMN change;                                         |
|                   |- radio access technology change (RAT Type).           |
|                   |- MO exception data counter receipt.                   |



The Partial Record generation trigger thresholds are those associated with
the Charging Characteristics.
The Partial Record generation trigger thresholds are S-GW configuration
parameters defined per Charging Characteristics profile by the operator
through OAM&P means, as specified in annex A.

In the event that the SGW-CDR is closed and the IP-CAN bearer remains
active, a further SGW-CDR is opened with an incremented Sequence Number in
the S-GW.

When Charging Event (ACR) is triggered by table 5.2.3.3.2.1conditions, the
Change-Condition (at PS information level) associated to the CDR Closure,
indicating the appropriate condition shall be present, and it shall be
omitted otherwise.



           5.2.3.4  Triggers for PGW-CDR charging information collection


5.2.3.4.0   Introduction

An PGW-CDR is used to collect charging information related to the IP-CAN
bearer data information for a UE/MS in the P-GW, where the data volumes,
elapsed time or number of events within each PGW-CDR are separately counted
per rating group or per combination of the rating group and service id. In
case of P-GW is not aware of IP-CAN bearers, i.e. in case of PMIP based
connectivity, P-GW collects charging information per IP-CAN session as it
would be one IP-CAN bearer.

Many service data flow containers per IP-CAN bearer can be active
simultaneously in PGW-CDR. A service data flow container is activated when
traffic is detected and no matching active service data flow container
exist; a service data flow container is closed when the termination of the
last service data flow matching to the service data flow container is
detected by the P-GW. When event based charging applies, the first
occurrence of an event matching a service data flow template shall imply
service data flow start. Details on FBC can be found in TS 23.203 [215] and
TS 32.240 [1].

If, according to the Charging Characteristics profile, CDR generation is
activated an PGW-CDR shall be opened at
IP-CAN bearer activation, and the volume (separately in uplink and downlink
direction), elapsed time and/or number of events are counted. When a change
of charging condition occurs, all containers are added to the PGW-CDR.
The PGW-CDR includes details such as Record Type, Served IMSI, Sequence
Number etc. and the FBC specific charging data. Not all of the charging
information to be collected is static, and other charging information is
directly dependent on dynamic Packet-Switched service usage.

It shall be possible to activate both online and offline charging
interfaces for the same IP-CAN bearer.
The default online and offline charging shall work independently of each
other. Optionally it may be possible to operate in a tight interworking
between online and offline charging mechanism i.e. only the specified quota
re-authorisation triggers armed by OCS (including e.g. tariff time change,
returned quotas, etc.) are used to close the service data flow containers
for the PGW-CDR charging information addition.

The subsequent clauses identify in detail the conditions for adding
information to, and closing the PGW-CDR for generation towards the CGF.

             5.2.3.4.1   Triggers for PGW-CDR charging information addition

IP-CAN bearer specific offline charging is achieved with IP-CAN bearer
specific rating group/service identifier defined in clause 5.3.1.1.

The "List of Service Data" attribute of the PGW-CDR consists of a set of
containers, which are added when specific trigger conditions are met. Each
container identifies the configured counts (volume separated for uplink and
downlink, elapsed time or number of events) per rating group or combination
of the rating group and service id within the same
IP-CAN bearer, on encountering that trigger condition. For envelope
reporting, the containers represent complete and closed time envelopes
determined by mechanisms defined in TS 32.299 [50].
 Table 5.2.3.4.1.1 identifies conditions that may be supported as recording
triggers under consideration of additional Debit / Reserve Units triggers.

Some of the triggers are non-exclusive (e.g. IP-CAN bearer modification
with a couple of reasons, IP-CAN bearer modification reasons that cause PGW-
CDR closure).

 Table 5.2.3.4.1.1: Triggers for PGW-CDR charging information addition "List
                              of Service Data"

|Trigger        |Description/Behaviour                                      |
|Conditions     |                                                           |
|IP-CAN bearer  |A change of IP-CAN bearer conditions (e.g. QoS change,     |
|modification   |SGSN/S-GW/ePDG/TWAG change, user location change, user CSG |
|               |information change, change of UE presence in a Presence    |
|               |Reporting Area(s), Serving PLMN Rate Control, APN Rate     |
|               |Control, change of 3GPP PS Data off Status) shall result in|
|               |a set of "List of Service Data" containers, i.e. all active|
|               |service data flow containers, being added to the CDR as    |
|               |described in clause 5.2.1.3.                               |
|               |In a tight interworking between online and offline charging|
|               |the specified quota re-authorisation triggers armed by OCS |
|               |are supported.                                             |
|Tariff Time    |On reaching the Tariff Time Change a set of "List of       |
|Change         |Service Data" containers, i.e. all active service data flow|
|               |containers, shall be added to the CDR.                     |
|               |In a tight interworking between online and offline charging|
|               |the Debit / Reserve Units tariff time change from OCS is   |
|               |supported.                                                 |
|Failure        |When the Credit Control Failure Handling mechanism is      |
|Handling       |triggered a "List of Service Data'”, i.e. all active       |
|procedure      |service data flow containers shall be added to the CDR.    |
|triggering     |The causes are only relevant in case of simultaneously     |
|               |usage of an active Debit / Reserve Units session.          |
|Service data   |In case of independent online and offline charging a "List |
|flow report    |of Service Data" container for the service data flow shall |
|               |be added when:                                             |
|               |- expiry of time limit;                                    |
|               |- expiry of volume limit;                                  |
|               |- expiry of unit limit;                                    |
|               |- termination of service data flow.                        |
|               |In case of tight interworking online and offline charging a|
|               |"List of Service Data" container for the service data flow |
|               |shall be added when:                                       |
|               |- time threshold reached;                                  |
|               |- volume threshold reached;                                |
|               |- unit threshold reached;                                  |
|               |- time quota exhausted;                                    |
|               |- volume quota exhausted;                                  |
|               |- unit quota exhausted;                                    |
|               |- expiry of quota validity time;                           |
|               |- termination of service data flow:                        |
|               |- re-authorization request by OCS.                         |
|               |- access of a multi-access PDN connection becomes unusable |
|CDR Closure    |All active "List of Service Data" containers shall be added|
|               |to the PGW-CDR.                                            |
|               |                                                           |
|               |Note:  The trigger condition is a common value that has to |
|               |be used for CDR closure together with detailed reason.     |


The first traffic container identifies the data traffic since the IP-CAN
bearer was opened. Subsequent data traffic containers store the configured
counts accrued since the closure of the last container.

For envelope reporting, each envelope contains information about the data
volume transferred in both uplink and downlink and / or the number of
events that occurred for the duration that envelope is open. Only completed
time envelopes shall be added to the PGW-CDR. The determination of
completed envelopes are defined in TS 32.299 [50]. The triggers listed in
the previous table 5.2.3.4.1.1 shall not apply to envelope reporting.
Envelopes that are not complete when a partial PGW-CDR is closed shall be
added to the next PGW-CDR.

The "Serving node Address" attribute of the PGW-CDR consists of a list of
SGSN/S-GW/ePDG/TWAG addresses.
New SGSN/S-GW/ePDG/TWAG address is added to the list when SGSN/S-
GW/ePDG/TWAG changes.

When Charging Event (ACR) is triggered by table 5.2.3.4.1.1conditions, the
Change-Condition sub-field associated to the added container, indicating
the appropriate condition, shall be present, excluding CDR Closure case.

When Charging Event (ACR) is triggered by CDR Closure condition, this
Change-Condition sub-field associated to the added container shall be
omitted, except when CDR closure is due to "maximum number of charging
condition changes", where it shall be present with the original condition
change.

When Charging Event (ACR) is triggered by "User CSG Information change" as
a Change condition, the following shall apply for the added volume
container:

  -  When User enters in a CSG cell or a hybrid cell: the CSG ID, access
    mode and CSG membership indication (when hybrid), shall be provided
    together with this "User CSG Information change" Change-Condition.

  -  User leaves a CSG cell or a hybrid cell: this "User CSG Information
    change" Change-Condition shall be provided without any CSG ID, access
    mode and CSG membership indication, unless the user is entering a new
    CSG cell or hybrid cell.




5.2.3.4.2   Triggers for PGW-CDR closure

The PGW-CDR shall be closed on encountering trigger conditions.

Table 5.2.3.4.2.1 identifies which conditions are supported to permit
closure of the PGW-CDR.

               Table 5.2.3.4.2.1: Triggers for PGW-CDR closure

|Closure Conditions   |Description/Behaviour                               |
|End of IP-CAN bearer |Deactivation of the IP-CAN bearer in the P-GW shall |
|within the P-GW      |result in the CDR being closed.                     |
|                     |The trigger condition covers:                       |
|                     |- termination of IP-CAN bearer;                     |
|                     |- any abnormal release.                             |
|Partial Record Reason|OAM&P reasons permit the closure of the CDR for     |
|                     |internal reasons.                                   |
|                     |The trigger condition covers:                       |
|                     |- data volume limit;                                |
|                     |- time (duration) limit;                            |
|                     |- maximum number of charging condition changes (i.e.|
|                     |number of service containers);                      |
|                     |- management intervention;                          |
|                     |- MS time zone change;                              |
|                     |- PLMN change;                                      |
|                     |- radio access technology change (RAT Type).        |
|                     |- MO exception data counter receipt.                |


The Partial Record generation trigger thresholds are those associated with
the Charging Characteristics.
The Partial Record generation trigger thresholds are P-GW configuration
parameters defined per Charging Characteristics profile by the operator
through OAM&P means, as specified in annex A.

In the event that the PGW-CDR is closed and the IP-CAN bearer remains
active, a further PGW-CDR is opened with an incremented Sequence Number in
the P-GW.

When Charging Event (ACR) is triggered by table 5.2.3.4.2.1 conditions, the
Change-Condition (at PS information level) associated to the CDR Closure,
indicating the appropriate condition shall be present, and it shall be
omitted otherwise.

           5.2.3.5  Triggers for SMS-CDR charging information collection

The generation of the SMS related CDRs is based on the observation and
capture of simple events, i.e. the transfer of Short Messages through the
SGSN and MME, in MO or MT direction.

A S-SMO-CDR is used to collect charging information related to the
transmission of a SM in MO direction via the SGSN or MME. If, according to
the Charging Characteristics, CDR generation is activated a S-SMO-CDR shall
be created when the SGSN or MME has successfully forwarded a SM to the SMSC
on behalf of the UE/MS. The S-SMO-CDR includes details such as Record Type,
Served IMSI, Sequence Number etc.

A S-SMT-CDR is used to collect charging information related to the
transmission of a SM in MT direction via the SGSN or MME. If, according to
the Charging Characteristics, CDR generation is activated a S-SMT-CDR shall
be created when the SGSN or MME has successfully forwarded a SM from the
SMSC to the UE/MS. The S-SMT-CDR includes details such as Record Type,
Served IMSI, Sequence Number etc.

Note that the above CDR types only capture the SMS events when transferred
through the SGSN and MME.
Equivalent charging functionality for the CS domain is specified in TS
32.250 [10].
3GPP specifications do not define service specific charging functionality
for SMS.


5.2.3.6  Triggers for LCS-CDR charging information collection

The generation of the LCS related CDRs is based on the observation and
capture of simple events, i.e. the invocation of location requests from the
UE/MS (LCS-MO-CDR), an external entity (LCS-MT-CDR) or the network (LCS-NI-
CDR).

A LCS-MO-CDR is used to collect charging information related to the
transmission of a location request, originating from the UE/MS to be
located, via the SGSN. If, according to the Charging Characteristics, CDR
generation is activated a LCS-MO-CDR shall be created when the SGSN has
received the RANAP "Location Report" message from the RNC.
The LCS-MO-CDR includes details such as Record Type, Served IMSI, Sequence
Number etc.

A LCS-MT-CDR is used to collect charging information related to the
transmission of a location request for a UE via the SGSN where the location
request originates from an external entity. If, according to the Charging
Characteristics, CDR generation is activated a LCS-MT-CDR shall be created
when the SGSN has received the RANAP "Location Report" message from the
RNC. The LCS-MT-CDR includes details such as Record Type, Served IMSI,
Sequence Number etc.

A LCS-NI-CDR is used to collect charging information related to the
transmission of a network induced location request via the SGSN. If,
according to the Charging Characteristics, CDR generation is activated a
LCS-NI-CDR shall be created when the SGSN has received the RANAP "Location
Report" message from the RNC. The LCS-MO-CDR includes details such as
Record Type, Served IMSI, Sequence Number etc.

Note that the above CDR types only capture the LCS events when transferred
through the SGSN.
Equivalent charging functionality for the CS domain is specified in TS
32.250 [10]. Service specific charging functionality for LCS is specified
in TS 32.271 [31].



           5.2.3.7  Triggers for S-MB-CDR and G-MB-CDR charging information
           collection for MBMS context charging for GPRS


5.2.3.7.1   Triggers for S-MB-CDR and G-MB-CDR charging information
             creation

S-MB-CDR and G-MB-CDR are used to collect charging information related to
the MBMS bearer context data information for a MBMS bearer service in the
GSN. The triggers for both S-MB-CDR and G-MB-CDR to start collecting
charging information are the same.

S-MB-CDR and G-MB-CDR shall be opened at MBMS bearer context creation. Not
all of the charging information to be collected is static, and other
charging information is directly dependent on dynamic Packet-Switched
service usage.

The subsequent clauses identify in detail the conditions for adding
information to, and closing the S-MB-CDR and
G-MB-CDR for generation towards the CGF.


5.2.3.7.2   Triggers for S-MB-CDR and G-MB-CDR charging information
             addition

The "List of Traffic Data Volumes" attribute consists of a set of
containers, which are added when specific trigger conditions are met, and
identify the volume count per MBMS bearer context, for downlink traffic, on
encountering that trigger condition.
Table 5.2.3.7.2.1 identifies which conditions are supported to trigger S-MB-
CDR and G-MB-CDR charging information addition.

 Table 5.2.3.7.2.1: Triggers for S-MB-CDR and G-MB-CDR charging information
                                  addition

|Trigger       |Description/Behaviour                                      |
|Conditions    |                                                           |
|Tariff Time   |On reaching the Tariff Time Change a "List of Traffic Data |
|Change        |Volumes" container shall be added to the CDR.              |
|CDR Closure   |A list of "List of Traffic Data Volumes" container shall be|
|              |added to the relevant CDR.                                 |


The first volume container of a MBMS bearer context identifies the volume
since the record was opened.
Subsequent volume containers store the volume count accrued since the
closure of the last container.


5.2.3.7.3   Triggers for S-MB-CDR and G-MB-CDR closure

The S-MB-CDR and G-MB-CDR shall be closed on encountering the trigger
conditions identified in table 5.2.3.7.3.1.

        Table 5.2.3.7.3.1: Triggers for S-MB-CDR and G-MB-CDR closure

|Closure Conditions   |Description/Behaviour                                |
|End of MBMS Bearer   |Deactivation of the MBMS bearer context in the GSN   |
|Context within the   |shall result in the CDR being closed. The trigger    |
|GSN                  |condition covers:                                    |
|                     |- termination of MBMS bearer context;                |
|                     |- any abnormal release.                              |
|Partial Record Reason|OAM&P reasons permit the closure of the CDR for      |
|                     |internal reasons.                                    |
|                     |The trigger condition covers:                        |
|                     |- data volume limit;                                 |
|                     |- time (duration) limit;                             |
|                     |- change in list of downstream nodes;                |
|                     |- management intervention.                           |


The Partial Record generation trigger thresholds are those associated with
GSN configured information.
In the event that the CDR is closed and the MBMS bearer context remains
active, a further CDR is opened with an incremented Sequence Number in the
GSN.



           5.2.3.7A Triggers for MBMS-GW-CDR charging information
           collection for MBMS context charging for EPS


5.2.3.7A.1  Triggers for MBMS-GW-CDR charging information creation

MBMS-GW-CDR is used to collect charging information related to the MBMS
bearer context data information for a MBMS bearer service in EPS.

MBMS-GW-CDR shall be opened at MBMS bearer context creation. Not all of the
charging information to be collected is static, and other charging
information is directly dependent on dynamic Evolved Packet System service
usage.

The subsequent clauses identify in detail the conditions for adding
information to, and closing the MBMS-GW-CDR for generation towards the CGF.


5.2.3.7A.2  Triggers for MBMS-GW-CDR charging information addition

The "List of Traffic Data Volumes" attribute consists of a set of
containers, which are added when specific trigger conditions are met, and
identify the volume count per MBMS bearer context, for downlink traffic, on
encountering that trigger condition.
Table 5.2.3.7A.2.1 identifies which conditions are supported to trigger
MBMS-GW-CDR charging information addition.

 Table 5.2.3.7A.2.1: Triggers for MBMS-GW-CDR charging information addition

|Trigger       |Description/Behaviour                                      |
|Conditions    |                                                           |
|Tariff Time   |On reaching the Tariff Time Change a "List of Traffic Data |
|Change        |Volumes" container shall be added to the CDR.              |
|CDR Closure   |A list of "List of Traffic Data Volumes" container shall be|
|              |added to the relevant CDR.                                 |


The first volume container of a MBMS bearer context identifies the volume
since the record was opened.
Subsequent volume containers store the volume count accrued since the
closure of the last container.


5.2.3.7A.3  Triggers for MBMS-GW-CDR closure

The MBMS-GW-CDR shall be closed on encountering the trigger conditions
identified in table 5.2.3.7A.3.1.

            Table 5.2.3.7A.3.1: Triggers for MBMS-GW-CDR closure

|Closure        |Description/Behaviour                                      |
|Conditions     |                                                           |
|End of MBMS    |Deactivation of the MBMS bearer context in the MBMS GW     |
|Bearer Context |shall result in the CDR being closed. The trigger condition|
|within the MBMS|covers:                                                    |
|GW             |- termination of MBMS bearer context;                      |
|               |- any abnormal release.                                    |
|Partial Record |OAM&P reasons permit the closure of the CDR for internal   |
|Reason         |reasons. The trigger condition covers:                     |
|               |- data volume limit;                                       |
|               |- time (duration) limit;                                   |
|               |- maximum number of charging condition changes;            |
|               |- change in list of downstream nodes;                      |
|               |- management intervention.                                 |


The Partial Record generation trigger thresholds are those associated with
MBMS GW configured information. In the event that the CDR is closed and the
MBMS bearer context remains active, a further CDR is opened with an
incremented Sequence Number in the MBMS GW.



           5.2.3.8  Triggers for ePDG-CDR charging information collection


5.2.3.8.0   Introduction

A ePDG-CDR is used to collect charging information related to the IP-CAN
bearer data information for a UE/MS in the ePDG.

If, according to the Charging Characteristics, CDR generation is activated
an ePDG-CDR shall be opened at IP-CAN bearer activation and IP-CAN bearer
specific container is opened.

When a change of charging condition occurs, the volume counts are added to
the ePDG-CDR and new counts are started. The ePDG-CDR includes details such
as Record Type, Served IMSI, Sequence Number etc. Not all of the charging
information to be collected is static, and other charging information is
directly dependent on dynamic Packet-Switched service usage.

The subsequent clauses identify in detail the conditions for adding
information to, and closing the ePDG-CDR for generation towards the CGF.


5.2.3.8.1   Triggers for ePDG-CDR charging information addition

The "List of Traffic Data Volumes" attribute of the ePDG-CDR consists of a
set of containers, which are added when specific trigger conditions are
met, and identify the volume count per Qos, separated for uplink and
downlink traffic, on encountering that trigger condition.
Table 5.2.3.8.1.1 identifies which conditions are supported to trigger ePDG-
CDR charging information addition.

   Table 5.2.3.8.1.1: Triggers for ePDG-CDR charging information addition

|Trigger        |Description/Behaviour                                      |
|Conditions     |                                                           |
|QoS Change     |A change in the QoS shall result that open "List of Traffic|
|               |Data Volumes" containers being closed and added to the CDR |
|               |and new IP-CAN bearer specific container is opened.        |
|Tariff Time    |On reaching the Tariff Time Change open "List of Traffic   |
|Change         |Data Volumes" containers shall be closed and added to the  |
|               |CDR.                                                       |
|User Location  |A change in UWAN User Location Information (e.g. change in |
|Change         |UE local IP address within the ePDG) shall result that open|
|               |"List of Traffic Data Volumes" containers being closed and |
|               |added to the CDR and new IP-CAN bearer specific container  |
|               |is opened.                                                 |
|CDR Closure    |Open "List of Traffic Data Volumes" containers shall be    |
|               |closed and added to the ePDG-CDR.                          |


Volume container identifies the uplink/downlink volume since the closure of
the last container.

When Charging Event (ACR) is triggered by table 5.2.3.8.1.1 conditions, the
Change-Condition sub-field associated to the added volume container,
indicating the appropriate condition, shall be present, excluding CDR
Closure case.

When Charging Event (ACR) is triggered by CDR Closure condition, this
Change-Condition sub-field associated to the added volume container shall
be omitted, except when CDR closure is due to "maximum number of charging
condition changes", where it shall be present with the original condition
change.


5.2.3.8.2   Triggers for ePDG-CDR closure

The ePDG-CDR shall be closed on encountering some trigger conditions.
Table 5.2.3.8.2.1 identifies which conditions are supported to permit
closure of the ePDG-CDR.

              Table 5.2.3.8.2.1: Triggers for ePDG-CDR closure

|Closure Conditions |Description/Behaviour                                  |
|End of IP-CAN      |Deactivation of the IP-CAN bearer in the ePDG shall    |
|bearer within the  |result in the CDR being closed. The trigger condition  |
|ePDG               |covers:                                                |
|                   |- termination of IP-CAN bearer;                        |
|                   |- any abnormal release;                                |
|                   |-    inter serving node change.                        |
|Partial Record     |OAM&P reasons permit the closure of the CDR for        |
|Reason             |internal reasons.                                      |
|                   |The trigger condition covers:                          |
|                   |- data volume limit;                                   |
|                   |- time (duration) limit;                               |
|                   |- maximum number of charging condition changes         |
|                   |(QoS/tariff time change);                              |
|                   |- management intervention;                             |


The Partial Record generation trigger thresholds are those associated with
the Charging Characteristics.
The Partial Record generation trigger thresholds are ePDG configuration
parameters defined per Charging Characteristics profile by the operator
through OAM&P means, as specified in annex A.

In the event that the ePDG-CDR is closed and the IP-CAN bearer remains
active, a further ePDG-CDR is opened with an incremented Sequence Number in
the ePDG.

When Charging Event (ACR) is triggered by table 5.2.3.8.2.1 conditions, the
Change-Condition (at PS information level) associated to the CDR Closure,
indicating the appropriate condition shall be present, and it shall be
omitted otherwise.



           5.2.3.9  Triggers for TDF-CDR charging information collection


5.2.3.9.1   Triggers for TDF-CDR charging information creation

A TDF-CDR is used to collect charging information related to the TDF
session information for a UE/MS in the TDF, where the data volumes, elapsed
time or number of events within each TDF-CDR are separately counted per
rating group or per combination of the rating group and service id.

Many application containers per TDF session can be active simultaneously in
TDF-CDR. An application container is activated when application traffic is
detected and no matching active application container exist; an application
container is closed when the application traffic of the matching
application container is terminated as detected by the TDF.
When event based charging applies, the first occurrence of an event
matching an application shall imply application traffic start. Details on
ABC can be found in TS 23.203 [215] and TS 32.240 [1].

If, according to the Charging Characteristics profile, CDR generation is
activated, a TDF-CDR shall be opened at TDF session establishment, and the
volume (separately in uplink and downlink direction), elapsed time and/or
number of events are counted. When a change of charging condition occurs,
all containers are added to the TDF-CDR.
The TDF-CDR includes details such as Record Type, Served IMSI, Sequence
Number etc. and the ABC specific charging data. Not all of the charging
information to be collected is static, and other charging information is
directly dependent on dynamic Packet-Switched service usage.

It shall be possible to activate both online and offline charging
interfaces for the same TDF session.
The default online and offline charging shall work independently of each
other. Optionally it may be possible to operate with tight interworking
between the online and offline charging mechanisms such that only the
specified quota re-authorisation triggers armed by the OCS (including e.g.
tariff time change, returned quotas, etc.) are used to close the
application containers for the TDF-CDR charging information addition, this
information would be provided by the OCS in the Offline-Charging AVP. In
this case, the information provided by the OCS shall take precedence over
the default configuration at the TDF.

The subsequent clauses identify in detail the conditions for adding
information to, and closing the TDF-CDR for generation towards the CGF.


5.2.3.9.2   Triggers for TDF-CDR charging information addition

TDF session specific offline charging is achieved with TDF session specific
rating group/service identifier defined in clause 5.2.1.9.2.

The "List of Service Data" attribute of the TDF-CDR consists of a set of
containers, which are added when specific trigger conditions are met. Each
container identifies the configured counts (volume separated for uplink and
downlink, elapsed time or number of events) per rating group or combination
of the rating group and service id within the same TDF session, on
encountering that trigger condition. For envelope reporting, the containers
represent complete and closed time envelopes determined by mechanisms
defined in TS 32.299 [50].
Table 5.2.3.9.2.1 identifies conditions that may be supported as recording
triggers under consideration of additional Debit / Reserve Units triggers.

Some of the triggers are non-exclusive (e.g. TDF session modification with
a couple of reasons, TDF session modification reasons that cause TDF-CDR
closure).

 Table 5.2.3.9.2.1: Triggers for TDF-CDR charging information addition "List
                              of Service Data"

|Trigger        |Description/Behaviour                                      |
|Conditions     |                                                           |
|TDF session    |A change of TDF session conditions (e.g.                   |
|modification   |SGSN/S-GW/ePDG/TWAG change, user location change, user CSG |
|               |information change) shall result in a set of "List of      |
|               |Service Data" containers, i.e. all active application      |
|               |containers, being added to the CDR as described in clause  |
|               |5.2.1.9.                                                   |
|               |In a tight interworking between online and offline charging|
|               |the specified quota re-authorisation triggers armed by OCS |
|               |are supported.                                             |
|Tariff Time    |On reaching the Tariff Time Change a set of "List of       |
|Change         |Service Data" containers, i.e. all active application      |
|               |containers, shall be added to the CDR.                     |
|               |In a tight interworking between online and offline charging|
|               |the Debit / Reserve Units tariff time change from OCS is   |
|               |supported.                                                 |
|Failure        |When the Failure Handling mechanism is triggered a "List of|
|Handling       |Service Data'”, i.e. all active application containers     |
|procedure      |shall be added to the CDR.                                 |
|triggering     |The causes are only relevant in case of simultaneously     |
|               |usage of an active Debit / Reserve Units session.          |
|Application    |In case of independent online and offline charging a "List |
|traffic report |of Service Data" container for the application shall be    |
|               |added when:                                                |
|               |- expiry of time limit;                                    |
|               |- expiry of volume limit;                                  |
|               |- expiry of unit limit;                                    |
|               |- termination of application traffic.                      |
|               |In case of tight interworking online and offline charging a|
|               |"List of Service Data" container for the application shall |
|               |be added when:                                             |
|               |- time threshold reached;                                  |
|               |- volume threshold reached;                                |
|               |- unit threshold reached;                                  |
|               |- time quota exhausted;                                    |
|               |- volume quota exhausted;                                  |
|               |- unit quota exhausted;                                    |
|               |- expiry of quota validity time;                           |
|               |- termination of application traffic:                      |
|               |- re-authorization request by OCS.                         |
|CDR Closure    |All active "List of Service Data" containers shall be added|
|               |to the TDF-CDR.                                            |
|               |                                                           |
|               |NOTE:  The trigger condition is a common value that has to |
|               |be used for CDR closure together with detailed reason.     |


The first traffic container identifies the data traffic since the TDF
session was opened.
Subsequent data traffic containers store the configured counts accrued
since the closure of the last container.

For envelope reporting, each envelope contains information about the data
volume transferred in both uplink and downlink and / or the number of
events that occurred for the duration that envelope is open. Only completed
time envelopes shall be added to the TDF-CDR. The determination of
completed envelopes are defined in TS 32.299 [50]. The triggers listed in
the previous table 5.2.3.9.2.1 shall not apply to envelope reporting.
Envelopes that are not complete when a partial TDF-CDR is closed shall be
added to the next TDF-CDR.

The "Serving node Address" attribute of the TDF-CDR consists of a list of
SGSN/S-GW/ePDG/TWAG addresses.
New SGSN/S-GW/ePDG/TWAG address is added to the list when SGSN/S-
GW/ePDG/TWAG changes.

When Charging Event (ACR) is triggered by table 5.2.3.9.2.1 conditions, the
Change-Condition sub-field associated to the added container, indicating
the appropriate condition shall be present, excluding CDR Closure case.

When Charging Event (ACR) is triggered by CDR Closure condition, this
Change-Condition sub-field associated to the added container shall be
omitted, except when CDR closure is due to "maximum number of charging
condition changes", where it shall be present with the original condition
change.

When Charging Event (ACR) is triggered by "User CSG Information change" as
a Change condition, the following shall apply for the added volume
container:

  -  When User enters in a CSG cell or a hybrid cell: the CSG ID, access
    mode and CSG membership indication (when hybrid), shall be provided
    together with this "User CSG Information change" Change-Condition.

  -  User leaves a CSG cell or a hybrid cell: this "User CSG Information
    change" Change-Condition shall be provided without any CSG ID, access
    mode and CSG membership indication, unless the user is entering a new
    CSG cell or hybrid cell.




5.2.3.9.3   Triggers for TDF-CDR closure

The TDF-CDR shall be closed on encountering specified trigger conditions.

Table 5.2.3.9.3.1 identifies which conditions are supported to permit
closure of the TDF-CDR.

               Table 5.2.3.9.3.1: Triggers for TDF-CDR closure

|Closure        |Description/Behaviour                                      |
|Conditions     |                                                           |
|End of TDF     |TDF session termination shall result in the CDR being      |
|session        |closed. The trigger condition covers:                      |
|               |- termination of TDF session by the PCRF;                  |
|               |- any abnormal release.                                    |
|Partial Record |OAM&P reasons permit the closure of the CDR for internal   |
|Reason         |reasons. The trigger condition covers:                     |
|               |- data volume limit;                                       |
|               |- time (duration) limit;                                   |
|               |- maximum number of charging condition changes (i.e. number|
|               |of service containers);                                    |
|               |- management intervention;                                 |
|               |- MS time zone change;                                     |
|               |- PLMN change;                                             |
|               |- radio access technology change (RAT Type).               |


The Partial Record generation trigger thresholds are those associated with
the Charging Characteristics.
The Partial Record generation trigger thresholds are TDF configuration
parameters defined per Charging Characteristics profile by the operator
through OAM&P means, as specified in Annex A.

In the event that the TDF-CDR is closed and the TDF session remains active,
a further TDF-CDR is opened with an incremented Sequence Number in the TDF.

When Charging Event (ACR) is triggered by table 5.2.3.9.3.1 conditions, the
Change-Condition (at PS information level) associated to the CDR Closure,
indicating the appropriate condition shall be present, and it shall be
omitted otherwise.



           5.2.3.10 Triggers for PGW-CDR charging information collection
           when IP-CAN session charging is active


5.2.3.10.1  General

A PGW-CDR is used to collect charging information related to the IP-CAN
bearer data information for a UE/MS in
the P-GW. When IP-CAN session charging is active, as described in clause
5.2.2.6, two types of data can be collected: traffic volumes used for IP-
CAN bearer charging and service data used for FBC.

Many traffic volume and service data flow containers per IP-CAN session can
be active simultaneously in PGW-CDR.

A new traffic volume container is activated when an IP-CAN bearer is
activated.

A service data flow container is activated when traffic is detected and no
matching active service data flow container exist; a service data flow
container is closed when the termination of the last service data flow
matching to the service data flow container is detected by the P-GW. When
event based charging applies, the first occurrence of an event matching a
service data flow template shall imply service data flow start. Details on
FBC can be found in TS 23.203 [215] and TS 32.240 [1].

If, according to the Charging Characteristics profile, CDR generation is
activated, a PGW-CDR shall be opened at
IP-CAN session activation, and the volume (separately in uplink and
downlink direction), elapsed time and/or number of events are counted.

When a change of charging condition occurs, all containers are added to the
PGW-CDR. The PGW-CDR includes details such as Record Type, Served IMSI,
Sequence Number etc. and both the traffic data and FBC specific charging
data.
Not all of the charging information to be collected is static, and other
charging information is directly dependent on dynamic Packet-Switched
service usage.

It shall be possible to activate both online and offline charging
interfaces for the same IP-CAN bearer.
The default online and offline charging shall work independently of each
other. Optionally it may be possible to operate in a tight interworking
between online and offline charging mechanism i.e. only the specified quota
re-authorisation triggers armed by OCS (including e.g. tariff time change,
returned quotas, etc.) are used to close the service data flow containers
for the PGW-CDR charging information addition.

The subsequent clauses identify in detail the conditions for adding
information to, and closing the PGW-CDR for generation towards the CGF.


5.2.3.10.2  Triggers for PGW-CDR charging information addition when IP-CAN
             session charging is active

The "List of Traffic Data Volumes" attribute of the PGW-CDR consists of a
set of containers, which are added when specific trigger conditions are
met, and identify the volume counter per QCI/ARP pair, separated for uplink
and downlink traffic, on encountering that trigger conditions. Table
5.2.3.10.2.1 identifies which conditions are supported to trigger PGW-CDR
charging information addition for the "List of Traffic Data Volumes"
attribute.

The "List of Service Data" attribute of the PGW-CDR consists of a set of
containers, which are added when specific trigger conditions are met. Each
container identifies the configured counts (volume separated for uplink and
downlink, elapsed time or number of events) per rating group or combination
of the rating group and service id within the same
IP-CAN bearer, on encountering that trigger condition. For envelope
reporting, the containers represent complete and closed time envelopes
determined by mechanisms defined in TS 32.299 [50]. Table 5.2.3.10.2.2
identifies conditions that may be supported as recording triggers under
consideration of additional Debit / Reserve Units triggers.

Some of the triggers are non-exclusive (e.g. IP-CAN bearer modification
with a couple of reasons, IP-CAN bearer modification reasons that cause PGW-
CDR closure).

 Table 5.2.3.10.2.1: Triggers for PGW-CDR charging information addition for
     List of Traffic Volumes when charging per IP-CAN session is active

|Trigger        |Description/Behaviour                                      |
|Conditions     |                                                           |
|End of         |The end of a dedicated bearer in P-GW shall result that    |
|dedicated      |open "List of Traffic Data Volumes" containers for the     |
|bearer in P-GW |dedicated bearer are closed and added to the CDR.          |
|Serving node   |A serving node (e.g., SGSN/S-GW/ePDG/TWAG) change in the   |
|change         |P-GW shall result that all open "List of Traffic Data      |
|               |Volumes" containers are closed and added to the CDR. New   |
|               |containers are opened for each bearer.                     |
|QoS Change     |A change in the QoS shall result that open "List of Traffic|
|               |Data Volumes" containers for the effected bearer being     |
|               |closed and added to the CDR and new IP-CAN bearer specific |
|               |container is opened if the IP-CAN bearer is still active.  |
|Tariff Time    |On reaching the Tariff Time Change open "List of Traffic   |
|Change         |Data Volumes" containers shall be closed and added to the  |
|               |CDR.                                                       |
|User Location  |A change in the User Location Info (e.g. ECGI, TAI, RAI,   |
|Change         |SAI or CGI) shall result that open "List of Traffic Data   |
|               |Volumes" containers being closed and added to the CDR, if  |
|               |location reporting is required, and a report of User       |
|               |Location Change is received.                               |
|User CSG       |A change in the User CSG info (e.g. CSG ID, access mode or |
|Information    |CSG membership indication) shall result that open "List of |
|change         |Traffic Data Volumes" containers being closed and added to |
|               |the CDR, if CSG information reporting is required, and a   |
|               |report of User CSG information change is received.         |
|Change of UE   |A change of UE presence in Presence Reporting Area(s) shall|
|presence in    |result that open "List of Traffic Data Volumes" containers |
|Presence       |being closed and added to the CDR, if such reporting is    |
|Reporting Area |required, and a report that user enters/leaves the area or |
|               |the Presence Reporting Area(s) is set to inactive by the   |
|               |serving node are  received.                                |
|Addition of    |New SGSN/S-GW/ePDG/TWAG address is added to data for the   |
|access to a PDN|IP-CAN bearer in the CDR.                                  |
|connection     |                                                           |
|Removal of     |The counters and time stamps for the IP-CAN bearers of the |
|access from a  |removed access are closed and resulting containers added to|
|multi-access   |CDR                                                        |
|PDN connection |                                                           |
|Access of a    |The counters and time stamps for the IP-CAN bearers of the |
|multi-access   |unusable access are closed and resulting containers added  |
|PDN connection |to the CDR.                                                |
|becomes        |                                                           |
|unusable       |                                                           |
|Traffic volume |A "List of Traffic Data Volumes" container for an IP-CAN   |
|report         |bearer shall be added when:                                |
|               |- expiry of time limit per IP-CAN bearer;                  |
|               |- expiry of data volume limit per IP-CAN bearer.           |
|Rate Control   |A "List of Traffic Data Volumes" container for an IP-CAN   |
|Change         |bearer shall be added when:                                |
|               |- Serving PLMN Rate Control Change                         |
|               |- APN Rate Control Change.                                 |
|CDR Closure    |Open "List of Traffic Data Volumes" containers shall be    |
|               |closed and added to the PGW-CDR.                           |


  Editor’s Note: The individual events associated with change of charging
         condition must be re-evaluated in the context of NBIFOM. Changes to
         this event are FFS.



 Table 5.2.3.10.2.2: Triggers for PGW-CDR charging information addition for
      "List of Service Data" when charging per IP-CAN session is active

|Trigger        |Description/Behaviour                                      |
|Conditions     |                                                           |
|IP-CAN bearer  |A change of IP-CAN bearer conditions (e.g.                 |
|modification   |SGSN/S-GW/ePDG/TWAG change, user location change, user CSG |
|except QoS     |information change, change in UE presence in Presence      |
|change         |Reporting Area, Serving PLMN Rate Control Change, APN Rate |
|               |Control Change) shall result in a set of "List of Service  |
|               |Data" containers, i.e. all active service data flow        |
|               |containers, being added to the CDR as described in clause  |
|               |5.2.1.10.2.                                                |
|               |In a tight interworking between online and offline charging|
|               |the specified quota re-authorisation triggers armed by OCS |
|               |are supported.                                             |
|Tariff Time    |On reaching the Tariff Time Change a set of "List of       |
|Change         |Service Data" containers, i.e. all active service data flow|
|               |containers, shall be added to the CDR.                     |
|               |In a tight interworking between online and offline charging|
|               |the Debit / Reserve Units tariff time change from OCS is   |
|               |supported.                                                 |
|ASR or Failure |When the Debit / Reserve Units session is terminated with  |
|Handling       |ASR or Failure Handling mechanism is triggered a "List of  |
|procedure      |Service Data'”, i.e. all active service data flow          |
|triggering     |containers shall be added to the CDR.                      |
|               |The causes are only relevant in case of simultaneously     |
|               |usage of an active Debit / Reserve Units session.          |
|Service data   |In case of independent online and offline charging a "List |
|flow report    |of Service Data" container for the service data flow shall |
|               |be added when:                                             |
|               |- expiry of time limit per rating group;                   |
|               |- expiry of volume limit per rating group;                 |
|               |- expiry of unit or data event limit per rating group;     |
|               |- access change of service data flow and all service data  |
|               |flows for the rating group,  combination of rating group   |
|               |and service identifier, or combination of rating group,    |
|               |sponsor identity and application service provider identity |
|               |are moved from one access to another;                      |
|               |- termination of service data flow and this is the last    |
|               |service data flow for the rating group or combination of   |
|               |rating group and service identifier, or combination of     |
|               |rating group, sponsor identity and application service     |
|               |provider identity.                                         |
|               |In case of tight interworking online and offline charging a|
|               |"List of Service Data" container for the service data flow |
|               |shall be added when:                                       |
|               |- time threshold reached;                                  |
|               |- volume threshold reached;                                |
|               |- unit threshold reached;                                  |
|               |- time quota exhausted;                                    |
|               |- volume quota exhausted;                                  |
|               |- unit quota exhausted;                                    |
|               |- expiry of quota validity time;                           |
|               |- access change of service data flow;                      |
|               |- termination of service data flow:                        |
|               |- re-authorization request by OCS.                         |
|CDR Closure    |All active "List of Service Data" containers shall be added|
|               |to the PGW-CDR.                                            |
|               |                                                           |
|               |Note:  The trigger condition is a common value that has to |
|               |be used for CDR closure together with detailed reason.     |


  Editor’s Note: The individual events associated with change of charging
         condition must be re-evaluated in the context of NBIFOM. Changes to
         this event are FFS.

The first traffic container identifies the data traffic since the IP-CAN
session was opened.
Subsequent data traffic containers store the configured counts accrued
since the closure of the last container.

For envelope reporting, each envelope contains information about the data
volume transferred in both uplink and downlink and / or the number of
events that occurred for the duration that envelope is open. Only completed
time envelopes shall be added to the PGW-CDR. The determination of
completed envelopes are defined in TS 32.299 [50]. The triggers listed in
the previous table shall not apply to envelope reporting. Envelopes that
are not complete when a partial PGW-CDR is closed shall be added to the
next PGW-CDR.

The "Serving node Address" attribute of the PGW-CDR consists of a list of
SGSN/S-GW/ePDG/TWAG addresses.
New SGSN/S-GW/ePDG/TWAG address is added to the list when SGSN/S-
GW/ePDG/TWAG changes.

When Charging Event (ACR) is triggered by table 5.2.3.10.2.1 or
5.2.3.10.2.2 conditions, the Change-Condition sub-field associated to the
added container, indicating the appropriate condition, shall be present,
excluding CDR Closure case.

When Charging Event (ACR) is triggered by CDR Closure condition, this
Change-Condition sub-field associated to the added container shall be
omitted, except when CDR closure is due to "maximum number of charging
condition changes", where it shall be present with the original condition
change.

When Charging Event (ACR) is triggered by "User CSG Information change" as
a Change condition, the following shall apply for the added volume
container:

  -  When User enters in a CSG cell or a hybrid cell: the CSG ID, access
    mode and CSG membership indication (when hybrid), shall be provided
    together with this "User CSG Information change" Change-Condition.

  -  User leaves a CSG cell or a hybrid cell: this "User CSG Information
    change" Change-Condition shall be provided without any CSG ID, access
    mode and CSG membership indication, unless the user is entering a new
    CSG cell or hybrid cell.




5.2.3.10.3  Triggers for PGW-CDR closure when charging per IP-CAN session
             charging is active

The PGW-CDR shall be closed on encountering trigger conditions.

Table 5.2.3.10.3.1 identifies which conditions are supported to permit
closure of the PGW-CDR.

              Table 5.2.3.10.3.1: Triggers for PGW-CDR closure

|Closure Conditions |Description/Behaviour                                 |
|End of IP-CAN      |Deactivation of the IP-CAN session in the P-GW shall  |
|session within the |result in the CDR being closed. The trigger condition |
|P-GW               |covers:                                               |
|                   |- termination of last IP-CAN bearer for the IP-CAN    |
|                   |session;                                              |
|                   |- any abnormal release.                               |
|Partial Record     |OAM&P reasons permit the closure of the CDR for       |
|Reason             |internal reasons.                                     |
|                   |The trigger condition covers:                         |
|                   |- data volume limit per IP-CAN session;               |
|                   |- time (duration) limit for keeping a CDR open;       |
|                   |- data event limit per IP-CAN session;                |
|                   |- maximum number of charging condition changes;       |
|                   |- management intervention;                            |
|                   |- APN-AMBR change;                                    |
|                   |- MS time zone change;                                |
|                   |- PLMN change;                                        |
|                   |- radio access technology change (RAT Type).          |


The Partial Record generation trigger thresholds are those associated with
the Charging Characteristics.
The Partial Record generation trigger thresholds are P-GW configuration
parameters defined per Charging Characteristics profile by the operator
through OAM&P means, as specified in annex A.

In the event that the PGW-CDR is closed and the IP-CAN session remains
active, a further PGW-CDR is opened with an incremented Sequence Number in
the P-GW.

When Charging Event (ACR) is triggered by table 5.2.3.10.3.1 conditions,
the Change-Condition (at PS information level) associated to the CDR
Closure, indicating the appropriate condition shall be present, and it
shall be omitted otherwise.


5.2.3.11 Triggers for TWAG-CDR charging information collection


5.2.3.11.0  Introduction

A TWAG-CDR is used to collect charging information related to the IP-CAN
bearer data information for a UE/MS in the TWAG.

If, according to the Charging Characteristics, CDR generation is activated
a TWAG-CDR shall be opened at IP-CAN bearer activation and IP-CAN bearer
specific container is opened.

When a change of charging condition occurs, the volume counts are added to
the TWAG-CDR and new counts are started. The TWAG-CDR includes details such
as Record Type, Served IMSI, Sequence Number etc. Not all of the charging
information to be collected is static, and other charging information is
directly dependent on dynamic Packet-Switched service usage.

The subsequent clauses identify in detail the conditions for adding
information to, and closing the TWAG-CDR for generation towards the CGF.


5.2.3.11.1  Triggers for TWAG-CDR charging information addition

The "List of Traffic Data Volumes" attribute of the TWAG-CDR consists of a
set of containers, which are added when specific trigger conditions are
met, and identify the volume count per Qos, separated for uplink and
downlink traffic, on encountering that trigger condition.
Table 5.2.3.11.1.1 identifies which conditions are supported to trigger
TWAG-CDR charging information addition.

   Table 5.2.3.11.1.1: Triggers for TWAG-CDR charging information addition

|Trigger        |Description/Behaviour                                      |
|Conditions     |                                                           |
|QoS Change     |A change in the QoS shall result that open "List of Traffic|
|               |Data Volumes" containers being closed and added to the CDR |
|               |and new IP-CAN bearer specific container is opened.        |
|Tariff Time    |On reaching the Tariff Time Change open "List of Traffic   |
|Change         |Data Volumes" containers shall be closed and added to the  |
|               |CDR.                                                       |
|CDR Closure    |Open "List of Traffic Data Volumes" containers shall be    |
|               |closed and added to the TWAG-CDR.                          |


Volume container identifies the uplink/downlink volume since the closure of
the last container.

When Charging Event (ACR) is triggered by table 5.2.3.11.1.1 conditions,
the Change-Condition sub-field associated to the added volume container,
indicating the appropriate condition, shall be present, excluding CDR
Closure case.
When Charging Event (ACR) is triggered by CDR Closure condition, this
Change-Condition sub-field associated to the added volume container shall
be omitted, except when CDR closure is due to "maximum number of charging
condition changes", where it shall be present with the original condition
change.


5.2.3.11.2  Triggers for TWAG-CDR closure

The TWAG-CDR shall be closed on encountering some trigger conditions.
Table 5.2.3.11.2.1 identifies which conditions are supported to permit
closure of the TWAG-CDR.

              Table 5.2.3.11.2.1: Triggers for TWAG-CDR closure

|Closure Conditions |Description/Behaviour                                  |
|End of IP-CAN      |Deactivation of the IP-CAN bearer in the TWAG shall    |
|bearer within the  |result in the CDR being closed. The trigger condition  |
|TWAG               |covers:                                                |
|                   |- termination of IP-CAN bearer;                        |
|                   |- any abnormal release;                                |
|                   |-    inter serving node change.                        |
|Partial Record     |OAM&P reasons permit the closure of the CDR for        |
|Reason             |internal reasons.                                      |
|                   |The trigger condition covers:                          |
|                   |- data volume limit;                                   |
|                   |- time (duration) limit;                               |
|                   |- maximum number of charging condition changes         |
|                   |(QoS/tariff time change);                              |
|                   |- management intervention;                             |


The Partial Record generation trigger thresholds are those associated with
the Charging Characteristics.
The Partial Record generation trigger thresholds are TWAG configuration
parameters defined per Charging Characteristics profile by the operator
through OAM&P means, as specified in annex A.

In the event that the TWAG-CDR is closed and the IP-CAN bearer remains
active, a further TWAG-CDR is opened with an incremented Sequence Number in
the TWAG.

When Charging Event (ACR) is triggered by table 5.2.3.11.2.1 conditions,
the Change-Condition (at PS information level) associated to the CDR
Closure, indicating the appropriate condition shall be present, and it
shall be omitted otherwise.




5.2.4  Void


5.2.5  Ga record transfer flows

In EPC, both fully qualified partial CDRs (FQPC) and reduced partial CDRs
(RPC), as specified in TS 32.240 [1] may be supported on the Ga interface.
In line with TS 32.240 [13], the support of FQPCs is mandatory, the support
of RPCs is optional. For further details on the Ga protocol application
refer to TS 32.295 [54].


5.2.6  Bp CDR file transfer

In EPC, both fully qualified partial CDRs (FQPC) and reduced partial CDRs
(RPC), as specified in TS 32.240 [1] may be supported on the Bp interface.
In line with TS 32.240 [13], the support of FQPCs is mandatory, the support
of RPCs is optional. For further details on the Bp protocol application
refer to TS 32.297 [52].





         5.3  PS domain online charging scenarios


5.3.1  Basic principles


5.3.1.0  General

PS domain online charging may be performed in the SGSN using CAMEL
techniques.
This functionality is specified in TS 23.078 [206] and TS 29.078 [202] and
is outside the scope of the present document.

PS domain online charging may be performed by the PCEF in the P-GW and by
the TDF using the common Ro based Credit-Control application specified in
TS 32.299 [50]. In order to provide the data required for the management
activities outlined in TS 32.240 [1] (Credit-Control, accounting,
statistics etc.), the PCEF shall be able to perform online charging for
each of the following:

  -  Charging data related to IP-CAN bearers;

  -  Charging data related to service data flows.

The above items both pertain to sessions (IP-CAN bearers), hence session
based online charging (SCUR) with centralized rating and centralized unit
determination is required in the PCEF.

The TDF shall be able to perform online charging each of the following:

  -  Charging data related to TDF session;

  -  Charging data related to detected application traffic.

The above items pertain to sessions (application traffic), hence SCUR is
required in the TDF with centralized or decentralized unit determination
and centralized rating.

The Debit / Reserve Units Request and Debit / Reserve Units Response
specified for SCUR in TS 32.299 [50] (initial/update/termination) are
issued towards the OCS / received from the OCS when certain conditions
(chargeable events) are met. The PS domain specific contents and purpose of
each of these messages, as well as the chargeable events that trigger them,
are described in the following sub-clauses. A detailed formal description
of the online charging parameters defined in the present document is to be
found in TS 32.299 [50]. Further information on the general principles of
the common 3GPP online charging application can also be found in TS 32.299
[50] and TS 32.240 [1].

The Credit-Control is always per rating group but the reporting level can
be either per rating group or per combination of the rating group and
service id. Reporting level is defined per PCC rule in case of PCEF
integrated in the P-GW or per ADC rule in case of TDF.In order to avoid
that charging sessions remain inactive for a long period of time, the PCEF
or OCS may terminate the online charging session under the condition that
no granted quota has been consumed for a certain period of time. The PCEF
starts a new online charging session when there is a need for new quota,
for the same IP-CAN bearer or IP-CAN session, and the same Charging id as
the initial session shall be used.


5.3.1.1  IP-CAN bearer charging

IP-CAN bearer online charging is achieved by FBC online charging, see
clause 5.3.1.2. When the IP-CAN bearer is online charged by means of FBC,
the quota handling shall also be based on the use of a Rating Group/Service
Identifier.
The value of this IP-CAN bearer specific Rating Group/Service Identifier
shall be vendor specific.

The amount of data counted with IP-CAN bearer specific Rating Group/Service
Identifier shall be based on:

  -  In case of GTP based tunnelling and nterworking with external IP
    networks: the inner IP packets in the GTP-U packet (T-PDU, see TS
    29.281 [217]).

  -  In case of GTP based tunnelling and interworking with external
    networks handling other data services (e.g. non-IP, PPP): the T-PDU
    packets (see TS 29.281 [217]).

  -  In case of PMIP based protocol: the payload of the GRE tunnel.

  -  In case of DSMIPv6 based protocol: the payload of the tunnelling
    layer.

As minimum behaviour, the full payload shall be included. Time metering is
started when IP-CAN bearer is activated.

  NOTE 1:  P-GW is aware of bearers in case of GTP based connectivity. In
         case of any other PMIP based connectivity, P-GW is aware of IP-CAN
         sessions only. If P-GW is not aware of IP-CAN bearers, P-GW
         collects charging information per IP-CAN session as it would be
         just one IP-CAN bearer.

  NOTE 2:  The control plane IP address of SGSN or P-GW (acting as GGSN) is
         the IP address used at Gn/Gp interface.

     The control plane IP address of  S-GW or P-GW is the IP address used
         at S5/S8 interface.
         The control plane IP address of ePDG or P-GW is the IP address used
         at S2b interface.

         The control plane IP address of TWAG or P-GW is the IP address used
                at S2a interface.




5.3.1.2  Flow Based bearer Charging

IP-CAN bearer charging allows the P-GW to collect charging information
related to data volumes sent to and received by the UE/MS, categorised by
the QoS applied to the IP-CAN bearer. FBC is supported by the P-GW by the
integrated PCEF. When the PCEF is present, the normal IP-CAN bearer
charging is enhanced by the capability to categorise the service data flows
within IP-CAN bearer data traffic by rating group or combination of the
rating group and service id. I.e., while there is only one uplink and one
downlink data volume count per IP-CAN bearer in IP-CAN bearer charging, FBC
may provide one count per each rating group or combination of the rating
group and service id. The level of the reporting is defined per PCC rule.
Details of this functionality are specified in TS 23.203 [215] and TS
32.240 [1].

  NOTE:  The P-GW can only include one QoS Information occurrence per
         Multiple Unit Operation.
         This implies if an operator wishes to be able to separate usage
         according to QCI and ARP within their charging system they will
         need to ensure that services having different QCI and ARP do not
         have the same:

         -  rating group in cases where rating reporting is used;

         -  rating group/service id where rating group/service id reporting
           is used.

Extended packet inspection can be done in the PCEF with pre-defined PCC
rules. The PCEF also have the possibility to output service specific
information related to the packet inspection in the online charging
information.

An Application Function (AF) may provide an external charging identifier to
be delivered to the PCEF by the PCRF with a dynamic PCC rule. The PCEF
includes this AF correlation information in the online charging information
for the rating group and service identifier associated with the dynamic PCC
rule when service identifier level reporting is requested.

The capability of P-GW to support ABC is achieved with PCRF providing
appropriate PCC Rules to the P-GW. Such PCC Rule shall be defined with
service data flow template including an Application Identifier for the
application which needs to be detected, enforced and charged.

According to TS 23.203 [215], FBC shall support different charging models
per PCC rule. These charging models may be based on volume and/or time and
on number of events matching a specific service data flow template in PCC
rule.
In general the charging of a service data flow shall be linked to the IP-
CAN bearer under which the service data flow has been activated.  In online
charging the PCEF shall request the reservation of units  prior to service
delivery.

The following chargeable events are defined for FBC when online charging is
activated:

  -  Network request for IP-CAN bearer activation before the Initiate IP-
    CAN bearer Activation message is sent. Associated with the network
    requested dedicated IP-CAN bearer activation procedure, as defined in
    TS 23.203 [215] and TS 23.060 [201], upon encountering this event, a
    Debit / Reserve Units Request[Initial], indicating the request for
    activation of dedicated IP-CAN bearer is sent toward the OCS. For
    network requested dedicated IP-CAN bearer activation, if known by the
    PCEF, the PCEF may provide status of UE presence in Presence Reporting
    Area(s).

  -  Start of IP-CAN bearer. Upon encountering this event, a Debit /
    Reserve Units Request[Initial], indicating the start of the IP-CAN
    bearer, is sent towards the OCS to authorize the IP-CAN bearer. For
    network requested dedicated IP-CAN bearer activation, this event
    triggers a Debit / Reserve Units Request[Update], when the PCEF
    receives an Update PDP Context Request message with the RAN Procedures
    Ready flag. If known by the PCEF, the PCEF may provide status of UE
    presence in Presence Reporting Area(s). PCEF may request quota later
    when service usage is started.

  -  Start of service data flow. In case valid quota does not exist a Debit
    / Reserve Units Request[Update] is generated to request quota. In case
    charging session does not exist, the request is a Debit/ Reserve Units
    Request[Initial] sent towards the OCS.
    The type of requested quota shall depend on measurement method
    configured for the PCC rule in case of decentralized unit
    determination. When event based charging applies, the first occurrence
    of an event matching a service data flow template in PCC rule shall be
    considered as the start of a service.

  -  Termination of service data flow. If reporting is per rating group and
    this is the last service data flow utilizing that specific rating group
    or if reporting is per combination of the rating group and service id
    and this is the last service data flow utilizing that specific rating
    group and service id, the required counters are updated.
    Termination of the service data flow itself does not trigger Debit /
    Reserve Units Request[Update].

  -- Access of a multi-access PDN connection becomes unusable: the
    Termination of service data flow chargeable event applies for all the
    service data flows carried under the IP-CAN bearer of the unusable
    access.

  -  Access of a multi-access PDN connection becomes usable: the Start of
    service data flow chargeable event applies for all the service data
    flows carried under the IP-CAN bearer of the access that has become
    usable.

  -  Expiry of Unused Quota timer for the charging session in PCEF, a Debit
    / Reserve Units Request[Terminate] is sent to OCS indicating that
    charging session is terminated, and the IP-CAN bearer is still active.
    In this case the OCS shall allow for a new session to be started with
    the same Charging Id.

  -  End of IP-CAN bearer. Upon encountering this event, a Debit / Reserve
    Units Request[Terminate], indicating the end of the IP-CAN bearer, is
    sent towards the OCS together with the final counts.

  -  Ro specific chargeable events (e.g. threshold reached, QHT expires,
    quota exhaustion, validity time reached, forced re-authorization).
    Corresponding counts for the rating group(s) are closed and Debit /
    Reserve Units Request[Update] is triggered according the rules defined
    in TS 32.299 [50].

  -  Change of charging condition: E.g. QoS change, user location change,
    user CSG information change, change of UE presence in Presence
    Reporting Area(s), change of 3GPP PS Data Off status, Serving PLMN Rate
    Control change, and APN Rate Control change.
    When this event is encountered and the corresponding re-authorization
    trigger is armed, all current counts are captured and sent towards the
    OCS with a Debit / Reserve Units Request[Update].

  -  Tariff time change. When this event is encountered, all current counts
    are captured and a new counts are started. The counts are sent to the
    OCS in next Debit / Reserve Units Request.

Management intervention may also force trigger a chargeable event.

If the PCEF supports the Unused Quota timer it may send its locally
configured value to the OCS. The OCS may in this case respond with a new
value of the Unused Quota timer to the PCEF, to be used instead of the PCEF
configured value.

PCC rules can be activated, deactivated and modified any time during the IP-
CAN bearer lifetime. PCC rule activation, deactivation and modification are
not chargeable events. However these PCC rule changes may lead to "start of
service data flow" and "termination of service data flow" chargeable
events.

According to TS 23.203 [215] , the PCRF can modify the following charging
information in a dynamic PCC rule which is active in the PCEF: Charging
key, Service identifier, Measurement method, Service identifier level
reporting. The PCRF can also modify the allowed access type in the case of
NBIFOM.
Change of Charging key, ServiceIdentifier, IP-CAN type,  measurement method
or allowed access type will trigger a "start of service data flow"
chargeable event when valid quota does not exist corresponding to that
changed PCC rule. Change of Charging key, Service Identifier, IP-CAN type,
measurement method,  Service identifier level reporting or allowed access
type will trigger a"termination of service data flow'" chargeable event
when this is the last service data flow utilizing the quota used for the
original PCC rule.

For non-IP type PDN connection in the P-GW:

  -  non-3GPP access types are not supported, multi-access PDN connections
    do not apply;

  -  A single PCC Rule is used with the service data flow descriptor
    matching the whole non-IP data traffic, and can contain e.g.:

    -  service data flow template matching all the packets;

    -  charging method to identify whether online/offline/both/neither
       charging interface is used;

    -  measurement method to identify whether time/volume/events are
       measured for this service data flow;

    -  Charging key (i.e. rating group) for that service data flow;

    -  service identifier for that service data flow,

    -  reporting level for that service data flow:

       -  rating group level in case a specific rating group is used for non-
         IP traffic charging.

       -  combination of the rating group and service id in case a specific
         rating group/service Id is used for non-IP traffic charging.





           5.3.1.3  PS Furnish Charging Information procedure

The OCS online charging function may use this procedure to add online
charging session specific information to the PGW-CDR and to the TDF-CDR.
The information can be sent per online session and in case FBC is enabled
for a specific APN, or ABC is enabled in case of the TDF, the OCS online
charging function may also send specific information per each online
charged service by means of this procedure.


5.3.1.4  Support of Failure Situations

In case the OCS fails, the P-GW and the TDF shall support the Failure
Handling procedure and Failover mechanism described in TS 32.299 [50].
These mechanisms give flexibility to have different failure handling
scenarios when the OCS fails.

Three different actions are described in RFC 4006 [402].

P-GW shall support the following actions when the failure handling
mechanism is executed:

  -  Terminate: The online session is finished. The associated IP-CAN
    bearer session is released (ongoing sessions) or not established (new
    sessions). Failover for ongoing sessions is not supported. Failover for
    new sessions is always supported.

  -  Retry&Terminate: The online session is finished. The associated IP-CAN
    bearer session is released (ongoing sessions) or not established (new
    sessions). Failover for ongoing sessions is supported. Failover for new
    sessions is always supported.

  -  Continue: The online session is finished. The associated IP-CAN bearer
    session is established (new sessions) or not released (ongoing
    sessions). Failover for ongoing sessions is supported. Failover for new
    sessions is always supported.

TDF shall support the following actions when the failure handling mechanism
is based on the directives received previously from the OCS:

  -  Terminate: This is the default behaviour. The TDF indicates to the
    PCRF that the charging session was terminated and the OCS does not
    allow the service to continue. The PCRF determines whether to continue
    or terminate the associated TDF session.

  -  Retry&Terminate: If the OCS and TDF support failover procedures and
    there is an alternate OCS available , the TDF shall attempt to failover
    to an alternative OCS. Otherwise, the TDF indicates to the PCRF that
    the charging session was terminated and the OCS does not allow the
    service to continue. The PCRF determines whether to continue or
    terminate the associated TDF session.

  -  Continue: If the OCS and TDF support failover procedures and there is
    an alternate OCS available , the TDF shall attempt to failover to an
    alternative OCS. Otherwise, the TDF indicates to the PCRF that the
    charging session was terminated and the OCS allows the service to
    continue. The PCRF determines whether to continue or terminate the
    associated TDF session.

If the user is simultaneously online and offline charged, the failure
situation shall be registered in the PGW-CDR/TDF-CDR. When the user is only
online charged, the execution of the Failure Handling mechanism with value
equal to Continue shall imply that a new PGW-CDR/TDF-CDR is opened.



           5.3.1.5  Application Based Charging (ABC)


5.3.1.5.0   Introduction

For the sub-clauses that follow, a single Debit / Reserve Units  session is
defined to handle both TDF session and application based charging
information when both are to be used. Either TDF session charging or ABC
but not both may be active as determined by Charging Characteristics.

For ABC the opening and closing of the Debit / Reserve Units session is
bound by the TDF session start and end respectively.


5.3.1.5.1   Charging per application

ABC allows collecting charging information related to data volumes sent to
and received by the UE/MS, based on the application detection. ABC
supported by the TDF, i.e. ADC rules based charging defined in TS 23.203
[215] and TS 29.212 [216], is based on ADC rules. The application traffic
within TDF session is categorised by rating group or combination of the
rating group and service identifier. The level of the reporting is defined
per ADC rule. Details of this functionality are specified in TS 23.203
[215] and TS 32.240 [1].

  NOTE:  ABC is supported by the P-GW embedding PCEF enhanced with
         application detection and control functionality as defined in TS
         23.203 [215], by mean of appropriate PCC Rules, and therefore
         specified under FBC clause 5.3.1.2 and clause 5.3.1.6.2.

According to TS 23.203 [215], ABC shall support different charging models
per ADC rule. These charging models may be based on volume and/or time or
on number of events as the application referred by either application
identifier or service data flow filters to identify the packets belonging
to an application in ADC rule. In online charging the TDF shall request the
reservation of units prior to service delivery.

The following chargeable events are defined for ABC when online charging is
activated:

  -  Start of TDF session. Upon encountering this event, a Debit / Reserve
    Units Request[Initial]  indicating the establishment of the TDF
    session, is sent towards the OCS to activate the online charging
    session with the TDF. The quota for each activated ADC rule may be
    requested in such Debit / Reserve Units Request[Initial]  or later when
    application traffic is detected .

  -  Start of application traffic. In case valid quota does not exist for
    the rating group, a Debit / Reserve Units Request[Update]  is generated
    to request quota. The type of requested quota shall depend on
    measurement method configured for the ADC rule in case of decentralized
    unit determination. When event based charging applies, the first
    occurrence of an event detected according to the pre-defined ADC rule
    shall be considered as the start of a application.

  -  Termination of application traffic. If reporting is per rating group
    and this is the last application traffic utilizing that specific rating
    group or if reporting is per combination of the rating group and
    service identifier and this is the last application traffic utilizing
    that specific rating group and service identifier, the required
    counters are updated.

  -  End of TDF session in the TDF. Upon encountering this event, a Debit /
    Reserve Units Request[Terminate], indicating the end of the TDF
    session, is sent towards the OCS together with the final counts.

  -  Ro specific chargeable events (e.g. threshold reached, QHT expires,
    quota exhaustion, validity time reached, forced re-authorization).
    Corresponding counts for the rating group(s) are closed and Debit /
    Reserve Units Request[Update]  is triggered according the rules defined
    in TS 32.299 [50].

  -  Change of charging condition: e.g. user location change, user CSG
    information change. When this event is encountered and the
    corresponding re-authorization trigger is armed, all current counts are
    captured and sent towards the OCS with a Debit / Reserve Units
    Request[Update].

  -  Tariff time change. When this event is encountered, all current counts
    are captured and a new counts are started. The counts are sent to the
    OCS in next Debit / Reserve Units Request.

Management intervention may also force trigger a chargeable event.

ADC rules can be activated, deactivated and modified any time during the
TDF session lifetime. ADC rules activation, deactivation and modification
are not chargeable events. However these ADC rules changes may lead to
"start of application traffic'" and "termination of application traffic'"
chargeable events.

Application Detection and Control rule can contain e.g.:

  -  Application Identifier to identify detected application or service
    data flow filters to identify the packets belonging to an application,

  -  charging method to identify whether online/offline/both/neither
    charging interface is used,

  -  measurement method for online/offline charging to identify whether
    time/volume/events are measured for this application,

  -  Charging key (i.e. rating group) for that application,

  -  service identifier for that application,

  -  reporting level for the application (rating group or combination of
    the rating group and service id),

  -  precedence to the situations where two or more ADC rules are
    overlapping.

Application Detection and Control rule can be:

  - pre-defined in TDF  (can be activated by the PCRF) or,

  - dynamically provisioned and activated by the PCRF over the Sd
    interface.

This is specified in TS 23.203 [215] and TS 29.212 [216].


According to TS 23.203 [215] , the PCRF can modify the following charging
information in a dynamic ADC rule which is active in the TDF: Charging key,
Service identifier, Measurement method, Service identifier level reporting.
Change of Charging key, Service Identifier, or measurement method will
trigger a "start of application traffic'" chargeable event when valid quota
does not exist. Change of Charging key, Service Identifier or measurement
method, or Service identifier level reporting will trigger a"termination of
application traffic'" chargeable event when this is the last application
traffic utilizing the quota used for the Charging key or combination of
Charging key and Service identifier of original ADC rule.


5.3.1.5.2   Charging per TDF session

TDF session online charging is achieved by ABC online charging such that
the quota handling for the TDF session shall be based on associating  a
specific Rating Group/Service Identifier with the TDF session . The value
of this TDF session specific Rating Group/Service Identifier shall be
vendor specific.

The amount of data counted with TDF session specific Rating Group/Service
Identifier shall be the user plane payload. Time metering is started when
TDF session is activated.



           5.3.1.6  Charging per IP-CAN session


5.3.1.6.0   General

Charging per IP-CAN session is an optional capability in the P-GW that
provides for a consolidated view of the service data flow charging
information across all bearers in the IP-CAN session. When charging per IP-
CAN session is active, the basic principles in this clause apply to the P-
GW instead of the principles in clause 5.3.1.1 and clause 5.3.1.2 above.

For the sub-clauses that follow, a single Debit / Reserve Units session is
defined to handle both types of charging information when both are to be
used. When Charging per IP-CAN session is active, either IP-CAN bearer
charging or FBC but not both may be active as determined by Charging
Characteristics.


5.3.1.6.1   IP-CAN bearer charging

IP-CAN bearer online charging is achieved by FBC online charging, see
clause 5.3.1.6.2. When the IP-CAN session is online charged by means of
FBC, the quota handling shall also be based on the use of a Rating Group.
The value of this IP-CAN bearer specific Rating Group or combination of the
Rating Group and Service Identifier shall be vendor specific.

The amount of data counted with IP-CAN bearer specific Rating Group/Service
Identifier shall be based on:

  -  In case of GTP based tunnelling and interworking with external IP
    networks: the inner IP packets in the GTP-U packet (T-PDU, see TS
    29.281 [217])

  -  In case of GTP based tunnelling and interworking with external
    networks handling other data services (e.g. non-IP, PPP): the T-PDU
    packets (see TS 29.281 [217])

  -  In case of PMIP based protocol: the payload of the GRE tunnel

  -  In case of DSMIPv6 based protocol: the payload of the tunnelling layer

As minimum behaviour, the full payload shall be included. Time metering is
started when IP-CAN session is activated.
All bearers in the IP-CAN session are included in the single vendor-
specific Rating Group/Service Identifier.

  NOTE 1:  P-GW is aware of bearers in case of GTP based connectivity. In
         case of any other PMIP based connectivity, P-GW is aware of IP-CAN
         sessions only. If P-GW is not aware of IP-CAN bearers, P-GW
         collects charging information per IP-CAN session as it would be
         just one IP-CAN bearer.

  NOTE 2:  The control plane IP address of SGSN or P-GW (acting as GGSN) is
         the IP address used at Gn/Gp interface.
         The control plane IP address of S-GW or P-GW is the IP address used
         at S5/S8 interface.
         The control plane IP address of ePDG or P-GW is the IP address used
         at S2b interface.
         The control plane IP address of TWAG or P-GW is the IP address used
         at S2a interface.

  NOTE 3:  The vendor-specific Rating Group/Service Identifier may be
         configurable through the use of a predefined PCC rule in the P-GW.


5.3.1.6.2   Flow Based Charging (FBC)

FBC is supported by the P-GW by the integration of a PCEF. With PCEF,
charging is enhanced by the capability to categorise the service data flows
within IP-CAN session data traffic by rating group or combination of the
rating group and service id. For online charging, FBC provides credit
management for each rating group and may provide reporting (i.e., counts)
per each rating group or combination of the rating group and service id.
The level of the reporting is defined per PCC rule. Details of this
functionality are specified in TS 23.203 [215] and TS 32.240 [1].

  NOTE 1:  Even though an individual service data flow template is bound to
         a specific IP-CAN bearer, the assigned rating group or combination
         of rating group and service id applies to the entire IP-CAN
         session.
         As a result, data traffic from multiple bearers can be included in
         the count maintained for the rating group or combination of the
         rating group and service id. This implies if an operator wishes to
         be able to separate usage according to IP-CAN bearer within their
         charging system they will need to ensure that services having
         different QCI and ARP do not have the same:

         -  rating group in cases where rating group reporting is used;

         -  rating group/service id where rating group/service id reporting
           is used.

  NOTE 2:  The P-GW can only include one QoS Information occurrence per
         Multiple Unit Operation.
         This implies if an operator wishes to be able to separate usage
         according to QCI and ARP within their charging system they will
         need to ensure that services having different QCI and ARP do not
         have the same:

         -  rating group in cases where rating group reporting is used;

         -  rating group/service id where rating group/service id reporting
           is used.

  NOTE 2a: The P-GW can only include one RAT type per service data
         container.
         This implies if an operator wishes to be able to separate usage
         according to RAT type within their billing system they will need to
         ensure that services having different RAT type do not have the
         same:

         -  rating group in cases where rating group reporting is used;

         -  rating group/service id where rating group/service id reporting
           is used.

Extended packet inspection can be done in the PCEF with pre-defined PCC
rules. The PCEF also have the possibility to output service specific
information related to the packet inspection in the online charging
information.

The capability of P-GW to support ABC is achieved with PCRF providing
appropriate PCC Rules to the P-GW. Such PCC Rule shall be defined with
service data flow template including an Application Identifier for the
application which needs to be detected, enforced and charged.

According to TS 23.203 [215], FBC shall support different charging models
per PCC rule. These charging models may be based on volume and/or time and
on number of events matching a specific service data flow template in PCC
rule.
In online charging the PCEF shall request the reservation of units  prior
to service delivery.

The following chargeable events are defined for FBC when online charging
and Charging per IP-CAN session is activated:

  -  Start of IP-CAN session. Upon encountering this event, a Debit /
    Reserve Units Request[Initial], indicating the start of the IP-CAN
    session, is sent towards the OCS to authorize the IP-CAN session. PCEF
    may request quota later when service usage is started.

  -  Start of service data flow. If no valid quota has been granted for the
    rating group, a Debit / Reserve UnitsRequest[Update]  is generated to
    request quota. In case charging session does not exist, the request is
    a Debit / Reserve Units Request[Initial] sent towards the OCS. The type
    of requested quota shall depend on measurement method configured for
    the PCC rule in case of decentralized unit determination. When event
    based charging applies, the first occurrence of an event matching a
    service data flow template in PCC rule shall be considered as the start
    of a service.

  -  Access change of service data flow.
    If service identifier level reporting is required by the PCC rule and
    all service data flows for this combination of the rating group and
    service id are changing from one access to another, or if rating group
    level reporting is required by the PCC rule and all service data flows
    for this rating group are changing from one access to another,
    corresponding counts are closed and Debit / Reserve Units
    Request[Update] is triggered.

  -  Termination of service data flow. If reporting is per rating group and
    this is the last service data flow utilizing that specific rating group
    or if reporting is per combination of the rating group and service id
    and this is the last service data flow utilizing that specific rating
    group and service id, the required counters are updated. Termination of
    the service data flow itself does not trigger Debit / Reserve Units
    Request[Update].

  -  Expiry of Unused Quota timer for the charging session in PCEF, a Debit
    / Reserve Units Request[Terminate] is sent to OCS indicating that
    charging session is terminated, and the IP-CAN bearer is still active.
    In this case the OCS shall allow for a new session to be started with
    the same Charging Id.

  -  End of IP-CAN session. Upon encountering this event, a Debit / Reserve
    Units Request[Terminate], indicating the end of the IP-CAN session, is
    sent towards the OCS together with the final counts.

  -  Ro specific chargeable events (e.g. threshold reached, QHT expires,
    quota exhaustion, validity time reached, forced re-authorization).
    Corresponding counts for the rating group(s) are closed and Debit /
    Reserve Units Request[Update] is triggered according the rules defined
    in TS 32.299 [50].

  -  Change of charging condition specific to APN-AMBR change: When this
    event is encountered and the corresponding re-authorization trigger is
    armed, all current counts are captured and sent towards the OCS with a
    Debit / Reserve Units Request[Update].

  -  Change of charging condition other than QoS change: E.g. user location
    change, user CSG information change, change of UE presence in Presence
    Reporting Area(s) , change of 3GPP PS DataOff status, Serving PLMN Rate
    Control change, APN Rate Control Change. When this event is encountered
    and the corresponding re-authorization trigger is armed, all current
    counts are captured and sent towards the OCS with a Debit / Reserve
    Units Request[Update].
    Change of charging condition other than QoS change events are
    associated with one access of a multi-access PDN connection and all
    counts associated with affected access are identified with the specific
    event. All counts associated with the other access of a multi-access
    PDN connection are identified as an indirect change of charging
    condition.

  -  Tariff time change. When this event is encountered, all current counts
    are captured and new counts are started.
    The counts are sent to the OCS in next Debit / Reserve Units Request.

Management intervention may also force trigger a chargeable event.

If the PCEF supports the Unused Quota timer it may send its locally
configured value to the OCS. The OCS may in this case respond with a new
value of the Unused Quota timer to the PCEF, to be used instead of the PCEF
configured value.

PCC rules can be activated, deactivated and modified any time during the IP-
CAN session lifetime. PCC rule activation, deactivation and modification
are not chargeable events. However these PCC rule changes may lead to
"start of service data flow'" and "termination of service data flow'"
chargeable events.

According to TS 23.203 [215], the PCRF can modify the following charging
information in a dynamic PCC rule which is active in the PCEF: Charging
key, Service identifier, Measurement method, Service identifier level
reporting. The PCRF can also modify the allowed access type in the case of
NBIFOM.
A change of allowed access type in the case of NBIFOM will trigger an
"access change for service data flow" chargeable event when all service
data flows for the associated counter are changed from one access to
another and takes priority over change of charging information.
Change of Charging key, ServiceIdentifier, IP-CAN type or measurement
method will trigger a "start of service data flow'" chargeable event when
valid quota does not exist corresponding to that changed PCC rule. Change
of Charging key, Service Identifier, IP-CAN type or measurement method, or
Service identifier level reporting will trigger a "termination of service
data flow" chargeable event when this is the last service data flow
utilizing the quota used for the original PCC rule.

Removal of an access from a PDN connection is not a trigger for FBC.
Subsequent PCC rule handling, may lead to the "access change for a service
data flow" or "termination of service data flow" events for the service
data flows that were active on the removed access.

For non-IP type PDN connection:

  -  non-3GPP access types are not supported;

  -  multi-access PDN connections do not apply;

  -  A single PCC Rule is used with the service data flow descriptor
    matching the whole non-IP data traffic, and can contain e.g.:

    -  service data flow template matching all the packets;

    -  charging method to identify whether online/offline/both/neither
       charging interface is used;

    -  measurement method for offline charging to identify whether
       time/data volume/events are measured for this service data flow;

    -  Charging key (i.e. rating group) for that service data flow;

    -  service identifier for that service data flow;

    -  reporting level for that service data flow:

       -  rating group level in case a specific rating group is used for non-
         IP traffic charging;

       -  combination of the rating group and service id in case a specific
         rating group/service Id is used for non-IP traffic charging.




5.3.1.7  Sponsored data connectivity charging

According to TS 23.203 [215] two deployment scenarios exist for sponsored
data connectivity. The Sponsor Identifier and Application Service Provider
Identifier are provided for sponsored services to the PCRF from the AF over
the Rx interface.

In the first scenario, the PCRF assigns a service specific Charging Key
(i.e. rating group) for a sponsored IP flow. The Charging Key is used by
the PCEF to collect charging information for online charging scenarios for
the sponsored flows on which the quota allocation in OCS shall be based.
Correlation of charging information for online charging from multiple users
per sponsor and/or application service provider is then performed using the
Charging Key.

The second scenario utilizing explicit reporting of the Sponsor Identity
and Application Service Provider Identity for online charging from PCEF has
not been specified in this release of the specification.


5.3.1.8  Network-Based IP Flow Mobility (NBIFOM) charging

To support Network-Based IP Flow Mobility (NBIFOM), multi-radio (i.e. 3GPP
and WLAN) capable UEs establish and maintain a PDN connection over both
3GPP access and WLAN access simultaneously for both S2b and S2a
connectivity, as specified in TS 23.161 [242]. When such a multi-access PDN
connection is established, there is one default bearer for each access. On
a multi-access PDN connection established over both 3GPP access and WLAN
access, it is possible to move individual IP flows from one access network
to another, when policies determine that flows should be moved and the
target access is available for the UE. As described in TS 23.203 [215], it
shall be possible to apply different rates depending on the access used to
carry a service data flow.

For a multi-access PDN connection, IP-CAN bearer charging as defined in
clause 5.3.1.1 and FBC as defined in clause 5.3.1.2 apply for each bearer
under each access for this PDN connection, and IP-CAN bearer charging as
defined in clause 5.3.1.6.1 and FBC as defined in clause 6.3.1.6.2 apply
when charging per IP-CAN session is active for this PDN connection, based
on:

  -  Establishment of a multi-access PDN connection and addition of access
    to a multi-access PDN connection result in the default bearer and
    potential dedicated bearer(s) creation for this access, to carry the
    service data flows based on PCC Rule(s).

  -  Release of a multi-access PDN connection and removal of an access from
    a multi-access PDN connection result in release of all the IP-CAN
    bearer(s) for this access.

  -  Access change for service data flow(s), results in corresponding PCC
    Rule(s) removed from the IP-CAN bearer(s) of the source access, and PCC
    Rule(s) installed into the IP-CAN bearer(s) of the target access.

  -  Access of a multi-access PDN connection becomes unusable: for the
    service data flows maintained as result from PCC Rules decision, under
    the IP-CAN bearer that becomes unusable, no traffic will be detected.

  -  Access of a multi-access PDN connection becomes usable: for the
    service data flows which were maintained as result from PCC Rules
    decision under the IP-CAN bearer when detected as usable, the new
    traffic will be counted.

For each service data flow, identified by its PCC Rule, a different access
type is specified where it has to be enforced. A different rating group may
be used as a way to apply charging differentiation per-access type. The
charging method, measurement method, reporting level may also potentially
be different, in case charging behaviour is not expected to be unified
between both domains.

For the case where dynamic PCC is not deployed, per-access Charging
Characteristics and pre-defined  PCC Rule(s) in
P-GW may be used as a way to apply charging differentiation.





         5.3.2  Ro message flows


5.3.2.0  General

 Debit / Reserve Units Request[Initial], update and termination, as defined
in TS 32.299 [50], are used by the P-GW/TDF to transfer the collected
charging information towards the OCS. Debit / Reserve Units Response is
used by the OCS to assign quotas for the rating groups, and to instruct the
P-GW whether to continue or terminate a service data flow(s) or IP-CAN
bearer. Debit / Reserve Units Response is used by the OCS to assign quotas
for the rating groups and to instruct the TDF whether to continue or
terminate an application's traffic.

Debit / Reserve Units Response is also used to communicate to the PCEF/TDF
for the Termination Action, i.e. the P-GW/TDF behaviour when the user has
consumed the final granted units. The Termination Action is specified in TS
32.299 [50].

The P-GW and TDF uses Charging Characteristics profile to determine whether
to activate or deactivate online charging. Further details of this
functionality, including the mechanism of conveying the Charging
Characteristics data item (HLR -> SGSN -> P-GW, or HSS->MME/S4-SGSN ->S-GW-
>P-GW, AAA -> ePDG -> P-GW, or AAA -> TWAG -> P-GW and then in case of TDF,
P-GW -> PCRF -> TDF), are specified in annex A.

The following clauses describe the trigger conditions for the chargeable
events described in clauses 5.3.1.1, 5.3.1.2, 5.3.1.5 and 5.3.1.6. In FBC
and ABC online charging, these chargeable events correspond to the triggers
for collection of charging information and Debit / Reserve Units Request
emission towards the OCS.
The responses from the OCS and the detailed behaviour of the PCEF/TDF upon
receiving those responses are also specified in the sub-clauses below.


5.3.2.1  Triggers for IP-CAN bearer online charging

IP-CAN bearer online charging is achieved by FBC online charging, see
clause 5.3.2.2 below.


5.3.2.1.1   Void


5.3.2.1.2   Void



           5.3.2.2  Triggers for FBC online charging


5.3.2.2.0   Introduction

Debit / Reserve Units Request[Initial] / [Update] / [Termination] is used
to convey charging information related to the IP-CAN bearer and service
data flows collected in the PCEF. Debit / Reserve Units Response is used by
the OCS to return quotas for rating groups or to instruct the PCEF on the
further handling of the IP-CAN bearer (terminate, continue, reroute, etc.).
The Debit / Reserve Units Request includes details such as Credit-Control
Type, Served IMSI, Sequence Number etc. The Debit / Reserve Units Response
includes details such as Credit-Control quotas and session management
instructions (continue, terminate, interim interval, etc). Not all of the
charging information to be collected is static, and other charging
information is directly dependent on dynamic Packet-Switched service usage.

FBC online charging is employed if it is activated for the IP-CAN bearer.
The charging method in the PCC rule defines whether service data flow
requires the online charging. The PCEF shall request the quota prior to
service delivery.
If only certain quotas are authorised by the OCS (e.g. due to insufficient
credit), the rating groups for which no quota was authorised are handled
according the received Result Code value. The quota supervision mechanism
is further described in TS 32.299 [50]. Details on FBC can be found in TS
23.203 [215] and TS 29.212 [216].

Debit / Reserve Units Request[Initial] is sent to the OCS during the IP-CAN
bearer activation. The OCS supplies a IP-CAN bearer authorisation and may
supply volume, time or events quotas for the rating groups, based on the
information provided by the PCEF, e.g. QoS, APN.

When start of the service data flow is detected and no valid quota exist, a
Debit / Reserve Units Request[Update] is sent to request quota for the
rating group, unless the rating group is e.g. blacklisted. In case charging
session does not exist, a Debit/Reserve Units Request[Initial] is sent. See
TS 32.299 [50] for further information.

When a change of charging condition occurs, and corresponding re-
authorization trigger is armed, all MSCC instances are reported to the OCS
with a Debit / Reserve Units Request[Update] with Reporting-Reason AVP
value set to RATING_CONDITION_CHANGE together with Trigger-Type AVP
indicating the accurate reason for the change.
When "User CSG Information change" occurs as a change of charging
condition, how the changes (i.e. User entering/leaving a CSG cell or a
hybrid cell he is member or not) are reported is further detailed in TS
32.299 [50].

At IP-CAN default bearer establishment, the OCS may provide the "Presence
Reporting Area identifier" to be activated for Core Network pre-configured
Presence Reporting Area(s) and additionally all of PRA Identifier(s) and
list(s) of its elements for UE-dedicated Presence Reporting Area(s) to be
reported when it subscribes to "Change of UE presence in Presence Reporting
Area". The Presence Reporting Area(s) to be reported are applicable at IP-
CAN session level.

The OCS may change (activate/modify/remove) the Presence Reporting Area(s)
to be reported by providing the updated PRA Identifier(s) to PCEF during
any IP-CAN dedicated bearer establishment or during any IP-CAN bearer
update.

The OCS may subscribe/unsubscribe to "Change of UE presence in Presence
Reporting Area" re-authorization event trigger, during IP-CAN bearer
establishment (i.e. CCA answer to CCR initial), or during the lifetime of
the IP-CAN bearer. When the initial UE presence status in PRA(s) resulting
from subscription by the OCS is received by the PCEF, and the PCEF has
previously requested quota, all MSCC instances are reported to the OCS with
a CCR update, indicating this initial status. If PCEF has not previously
requested quota, this initial status of UE presence in Presence Reporting
Area(s) will be sent towards the OCS on CCR update triggered for quota
request when service usage is started.

When Ro specific chargeable event (e.g. threshold reached, QHT expires,
quota exhaustion, validity time reached, forced re-authorization) occurs
required MSCC instances are reported to OCS with a Debit / Reserve Units
Request[Update] with corresponding Reporting Reason value. See TS 32.299
[50] for further information.

When tariff time change is encountered, the Tariff Change Usage is used
within the Used Service Units to distinguish usage before and after the
tariff time change. The MSCC instances are sent to the OCS in next Debit /
Reserve Units Request.

The OCS may specify the behaviour on consumption of the final granted units
known as termination action.
The required termination action is indicated with Final Unit Action and
possible values are TERMINATE and REDIRECT. See TS 32.299 [50] for further
information.

TS 23.203 [215] specifies that it shall be possible to request online
charging quotas for each charging key.
Each quota allocated to a Debit / Reserve Units session has a unique Rating
Group value. TS 23.203 [215] also specifies that PCEF shall report charging
information for each combination of the charging key and service identifier
when service identifier level reporting is present. As defined in TS 23.203
[215] the service identifier is a piece of information which provides the
most detailed identification, specified for FBC, of a service data flow.
The charging key is a piece of information used for rating purposes as
defined in TS 23.203 [215].
The charging key and Service Identifier are mapped into the Rating Group
and the Service Identifier respectively as defined in RFC 4006 [402].

The subsequent clauses identify in detail the conditions for reporting
online charging information, management of user and Credit-Control sessions
and PS domain quota supervision.


5.3.2.2.1   Triggers for starting and stopping an FBC Credit-Control
             session

 Debit / Reserve Units Request[Initial] is sent to OCS when:

  -  IP-CAN bearer is activated. For network requested dedicated IP-CAN
    bearer activation, the  Debit / Reserve Units Request[Initial]  is sent
    to the OCS when the PCEF determines a need for the IP-CAN bearer and
    before any signalling towards a mobile is initiated.

  -  Start of service data flow is detected and no charging session exists.

Debit / Reserve Units Request[Terminate] is sent to OCS when:

  -  IP-CAN bearer is deactivated.

  -  Unused Quota timer expiry.

  -  Session termination is indicated by the OCS (e.g. Credit Limit
    Reached, Credit Control Not Applicable)

  -  Abort-Session-Request is received from the OCS, this also results in
    network initiated IP-CAN bearer deactivation.

  -  A Debit / Reserve Units Request[Terminate] sent due to Unused Quota
    timer expiry shall include an indication to the OCS that the IP-CAN
    bearer continues and the OCS can expect a later Debit / Reserve Units
    Request[Initial] request for the same IP-CAN bearer.


5.3.2.2.2   Triggers for providing interim information for an FBC Credit-
             Control session

 Debit / Reserve Units Request[Update]  is sent to OCS when:

  -  User starts to use certain service or application

  -  Start of service data flow (refer to clause 5.3.1.2)

  -  Termination of service data flow and this is the last service data
    flow utilizing corresponding to report level(refer to clause 5.3.1.2)

  -  Active service or application is removed from the allowed services or
    applications

  -  Granted quota runs out

  -  Validity time for granted quota expires

  -  Update is requested by the OCS

  -  Change of charging conditions occur and according re-authorisation
    trigger re-authorisation is needed

  -  Management intervention

  -  Quota Holding Timer is expired

  -  For network requested dedicated IP-CAN bearer activation, reception of
    an Update PDP Context Request message with the RAN Procedures Ready
    flag.


5.3.2.2A Triggers for ABC online charging


5.3.2.2A.0  Introduction

For ABC supported within the TDF, i.e. ADC rules based charging defined in
TS 23.203 [215] and TS 29.212 [216],  Debit / Reserve Units
Request[Initial]  / update / termination is used to convey charging
information related to the application traffic detected in the TDF. Debit /
Reserve Units Response is used by the OCS to return quotas for rating
groups or to instruct the TDF on the further handling of the application
traffic (terminate, continue, reroute, etc.). The Debit / Reserve Units
Request includes details such as Credit-Control Type, Served IMSI and
Sequence Number etc. The Debit / Reserve Units Response includes details
such as Credit-Control quotas and session management instructions
(continue, terminate, interim interval, etc).

ABC online charging is employed if it is activated for the TDF session
defined in TS 23.203[215].
The charging method in the ADC rule defines whether application traffic
requires online charging. The TDF shall request the quota prior to service
delivery. If only certain quotas are authorised by the OCS (e.g. due to
insufficient credit), the rating groups for which no quota was authorised
are handled according the received Result Code value. The quota supervision
mechanism is further described in TS 32.299 [50].

 Debit / Reserve Units Request[Initial]  is sent to the OCS during the TDF
session activation. The OCS supplies application traffic authorisation and
may supply volume, time or event quotas for the rating groups, based on the
information provided by the TDF, e.g. APN.

When start of the application traffic is detected and no valid quota exist
in current Ro session, a  Debit / Reserve Units Request[Update]  is sent to
request quota for the rating group unless the rating group is e.g.
blacklisted. See TS 32.299 [50] for further information.

When a change of charging condition occurs and corresponding re-
authorization trigger is armed, all MSCC instances are reported to the OCS
with a Debit / Reserve Units Request[Update]  with Reporting Reason value
set to RATING_CONDITION_CHANGE together with Trigger-Type AVP indicating
the accurate reason for the change.
When "User CSG Information change" occurs as a change of charging
condition, how the changes (i.e. User entering/leaving a CSG cell or a
hybrid cell he is member or not) are reported is further detailed in TS
32.299 [50].

When Ro specific chargeable event (e.g. threshold reached, QHT expires,
quota exhaustion, validity time reached, forced re-authorization) occurs
required MSCC instances are reported to OCS with a  Debit / Reserve Units
Request[Update]  with corresponding Reporting-Reason AVP value. See TS
32.299 [50] for further information.

When tariff time change is encountered, the Tariff Change Usage is used
within the Used Service Units to distinguish usage before and after the
tariff time change. The MSCC instances are sent to the OCS in next CCR.

The OCS may specify the behaviour on consumption of the final granted units
known as termination action. The required termination action is indicated
with Final Unit Action and possible values are TERMINATE and REDIRECT.
See TS 32.299 [50] for further information.

TS 23.203 [215] specifies that it shall be possible to request online
charging quotas for each charging key. Each quota allocated to a Debit /
Reserve Units session has a unique Rating Group value. TS 23.203 [215] also
specifies that TDF shall report charging information for each combination
of the charging key and service identifier when service identifier level
reporting is present. As defined in TS 23.203 [215] the service identifier
is a piece of information which provides the most detailed identification,
specified for ABC. The charging key is a piece of information used for
rating purposes as defined in TS 23.203 [215]. The charging key and Service
Identifier are mapped into the Rating Group and the Service Identifier
respectively as defined in RFC 4006 [402].

The subsequent clauses identify in detail the conditions for reporting
online charging information, management of user and Credit-Control sessions
and PS domain quota supervision.


5.3.2.2A.1  Triggers for starting and stopping an ABC Credit-Control
             session

 Debit / Reserve Units Request[Initial]  is sent to OCS when TDF session is
activated.

 Debit / Reserve Units Request[Terminate]  is sent to OCS when:

  -  TDF session is deactivated

  -  Session termination is indicated by the OCS (e.g. Credit Limit
    Reached)

  -  Abort-Session-Request is received from the OCS.


5.3.2.2A.2  Triggers for providing interim information for an ABC Credit-
             Control session

 Debit / Reserve Units Request[Update]  is sent to OCS when:

  -  Start of application traffic, when no valid quota exists

  -  Granted quota runs out

  -  Validity time for granted quota expires

  -  Update is requested by the OCS

  -  Change of charging conditions occur and according re-authorisation
    trigger re-authorisation is needed

  -  Management intervention

  -  Quota Holding Timer is expired



           5.3.2.2B Triggers for TDF session online charging

TDF session online charging is achieved by ABC online charging, see clause
5.3.2.2A.


5.3.2.2C Triggers for P-GW when charging per IP-CAN session is active


5.3.2.2C.1  General

The triggers identified in clause 5.3.2.2 are utilized when charging per IP-
CAN session is active with the following changes:

  1. When IP-CAN bearer charging is active, the Debit / Reserve Units
    Response is used by the OCS to return quotas for rating groups or to
    instruct the PCEF on the further handling of the IP-CAN session or
    service data flow, not a specific IP-CAN bearer.

  2. Charging per IP-CAN session is employed if it is activated for the
    default IP-CAN bearer. Charging characteristics determine if the IP-CAN
    bearer charging is active or if the FBC is active. When IP-CAN bearer
    charging is active, a vendor-specific rating group and, optionally,
    service identifier, is used to signify that the IP-CAN session traffic
    is being monitored as per clause 5.3.1.6.1. This vendor-specific rating
    group is the only rating for which quota is requested from the OCS
    using the same mechanism as for FBC. When FBC is active, the charging
    method in the PCC rule defines whether a service data flow requires
    online charging.

  3. In either case in which FBC is utilized, the PCEF shall request the
    quota prior to service delivery as in clause 5.3.2.2.

  4.  Debit / Reserve Units Request[Initial] is sent to the OCS during the
    IP-CAN session activation. No indication is provided to the OCS when an
    individual IP-CAN bearer is activated.

  5. When IP-CAN bearer charging using the vendor-specific rating group,
    the OCS may only provide volume quotas.

  6. At IP-CAN session establishment, the OCS may provide the "Presence
    Reporting Area identifier(s)" to be activated for Core Network pre-
    configured Presence Reporting Area(s) and additionally all of PRA
    Identifier(s) and list(s) of its elements for UE-dedicated Presence
    Reporting Area(s) to be reported when it subscribes to "Change of UE
    presence in Presence Reporting Area". OCS subscription to and PCEF
    reporting of "Change of UE presence in Presence Reporting Area" re-
    authorization event trigger is the same as in clause 5.3.2.2.

  7. When start of the IP-CAN session traffic (if IP-CAN bearer charging is
    active) or the service data flow is detected and no valid quota exists,
    a Debit / Reserve Units Request[Update] is sent to request quota for
    the rating group as in clause 5.3.2.2C.3.


5.3.2.2C.2  Triggers for starting and stopping an FBC Credit-Control
             session when charging per IP-CAN session is active

Debit / Reserve Units Request[Initial] is sent to OCS when:

  -  IP-CAN session (i.e., default bearer) is activated.

  -  Start of service data flow is detected and no charging session exists.

 Debit / Reserve Units Request[Terminate] is sent to OCS when:

  -  IP-CAN session is deactivated.

  -  Unused Quota timer expiry.

  -  Session termination is indicated by the OCS (e.g. Credit Limit
    Reached, Credit Control Not Applicable)

  -  Abort-Session-Request is received from the OCS, this also results in
    network-initiated IP-CAN session deactivation.

A Debit / Reserve Units Request[Terminate] sent due to Unused Quota timer
expiry shall include an indication to the OCS that the IP-CAN session
continues and the OCS can expect a later Debit / Reserve Units
Request[Initial] request for the same IP-CAN session.





5.3.2.2C.3  Triggers for providing interim information for an FBC Credit-
             Control session when charging per IP-CAN session is active

 Debit / Reserve Units Request[Update]  is sent to OCS when:

  -  User starts to use certain service

  -  Start of service data flow (refer to 5.3.1.2)

  -  Access change of service data flow (refer to 5.3.1.6.2)

  -  Active service is removed from the allowed services

  -  Granted quota runs out

  -  Validity time for granted quota expires

  -  Update is requested by the OCS

  -  Change of charging conditions occur and re-authorisation trigger is
    set

  -  Management intervention

  -  Quota Holding Timer is expired





           5.3.2.3  PS Furnish Charging Information procedure

The OCS online charging function may use this procedure to add online
charging session specific information to the PGW-CDR/TDF-CDR by means of
the Debit / Reserve Units operation in the Ro interface. The data can be
sent either in one Debit / Reserve Units Response message or several Debit
/ Reserve Units Response messages with append indicator.

The OCS online charging function can send multiple concatenated PS Furnish
Charging Information elements per online charging session in the Ro
interface. The OCS online charging function can also send multiple
concatenated PS Furnish Information Element per each quota (i.e. per rating
group).

The total maximum of free format data is 160 octets per service so the
total maximum of free format data per online session is n*160 octets, where
n indicates the number of rating groups activated per online session.

In the OCS online charging function, a PS online charging session shall be
identified by the P-GW control plane address and the ChargingId. In the P-
GW, the PS online charging session and the PS offline charging session
shall be identified by the same ChargingId. Therefore the ChargingId shall
allow the P-GW to correlate an online charging session with an offline
charging session. In the TDF, the PS online charging session and the PS
offline charging session shall be identified by the combination of P-GW
control plane address and ChargingId. Therefore the P-GW address/Charging
Id shall allow the TDF to correlate an online charging session with an
offline charging session.

This procedure can only apply when online and offline charging is performed
simultaneously for the same session (IP-CAN bearer or TDF session) or
rating group. In any other case, the P-GW/TDF shall discard the additional
charging information sent by the OCS in the Debit / Reserve Units Response
messages.

When the OCS sends session specific charging information, it must send the
PS Furnish Charging Information at command level in the Debit / Reserve
Units Response. In this case, the information is added to the main body of
the PGW-CDR. When the OCS sends service specific charging information, it
must send the PS Furnish Charging Information at MSCC level in the Debit /
Reserve Units Response. In this case, the information is added to the
specific service container in the PGW-CDR/TDF-CDR.

The PS Furnish Charging Information is described in TS 32.299 [50].


5.3.2.4  Support of Failure Situations

In case the OCS fails the P-GW/TDF must support the Failure Handling
procedure and Failover mechanism described in TS 32.299 [50].

The Failure Handling Procedure affects the whole online session so in case
FBC/ABC is enabled, the procedure shall affect all services activated
during the IP-CAN bearer/TDF session triggering the online charging
session.

According to TS 32.299 [50], timer Tx determines the maximum interval the P-
GW/TDF shall wait for an answer to each Debit / Reserve Units Request sent
to the OCS. In case FBC/ABC is enabled, it is possible that several
concurrent Debit / Reserve Units Request messages are triggered for the
same online charging session. In this case, each Debit / Reserve Units
Request message shall reset the Tx timer. When Tx expires, P-GW/TDF shall
execute the Failover and Failure Handling mechanisms according to the
behaviour described in Annex B.

Three different actions are described in RFC 4006 [402].

P-GW shall support the following actions when the failure handling
mechanism is executed:

  -  Terminate: The online session is finished. The associated IP-CAN
    bearer session is released (ongoing sessions) or not established (new
    sessions). Failover for ongoing sessions is not supported. Failover for
    new sessions is always supported.

  -  Retry&Terminate: The online session is finished. The associated IP-CAN
    bearer session is released (ongoing sessions) or not established (new
    sessions). Failover for ongoing sessions is supported. Failover for new
    sessions is always supported.

  -  Continue: The online session is finished. The associated IP-CAN bearer
    session is established (new sessions) or not released (ongoing
    sessions). Failover for ongoing sessions is supported. Failover for new
    sessions is always supported. It shall be operator configurable to
    limit the maximum duration of the IP-CAN bearer in this situation.

When charging per IP-CAN session is active, the actions above apply to the
entire IP-CAN session instead of the individual IP-CAN bearer.

TDF shall support the following actions when the failure handling mechanism
is based on the directives received previously from the OCS:

  -  Terminate: This is the default behaviour. The TDF indicates to the
    PCRF that the charging session was terminated and the OCS does not
    allow the service to continue. The PCRF determines whether to continue
    or terminate the associated TDF session.

  -  Retry&Terminate: If the OCS and TDF support failover procedures and
    there is an alternate OCS available, the TDF shall attempt to failover
    to an alternative OCS. Otherwise, the TDF indicates to the PCRF that
    the charging session was terminated and the OCS does not allow the
    service to continue. The PCRF determines whether to continue or
    terminate the associated TDF session.

  -  Continue: If the OCS and TDF support failover procedures and there is
    an alternate OCS available, the TDF shall attempt to failover to an
    alternative OCS. Otherwise, the TDF indicates to the PCRF that the
    charging session was terminated and the OCS allows the service to
    continue. The PCRF determines whether to continue or terminate the
    associated TDF session.

In case the user is simultaneously online and offline charged, the failure
situation must be registered in the PGW-CDR/TDF-CDR. When the user is only
online charged, the execution of the Failure Handling mechanism with value
equal to Continue shall imply that a new PGW-CDR/TDF-CDR is opened.



         6  Definition of charging information


6.1A Rf message content


6.1A.0 General

This clause is applicable to the ePDG, TWAG, MME, S-GW, P-GW and TDF, when
the CDF is provided as an external entity.


6.1A.1 Summary of offline charging message formats

The PS Offline Charging and ""SMS over MME Charging" utilises the Charging
Data Transfer that is specified in the 3GPP accounting application
described in TS 32.299 [50].

The Charging Data Transfer operation employs the Charging Data Request and
Charging Data Response messages.

The Charging Data Request can be of type [Start, Interim, Stop and Event]
and includes all charging information. The Charging Data Response is an
acknowledgement of the Charging Data Request.

Table 6.1A.1.1 describes the use of these messages for offline charging.

          Table 6.1A.1.1: Offline charging messages reference table

|Message        |Source                 |Destination            |
|Charging Data  |ePDG, TWAG, MME,       |CDF                    |
|Request        |S-GW,P-GW,TDF          |                       |
|Charging Data  |CDF                    |ePDG, TWAG, MME, S-GW, |
|Response       |                       |P-GW, TDF              |



6.1A.2 Structure for the charging data message formats


6.1A.2.0 General

This clause describes the Information Elements (IE) used in the charging
data messages.

Category in table 6.1A.2.1.1 and table 6.1A.2.2.1 shall use the categories
according to the charging data configuration defined in clause 5.4 of TS
32.240 [1].



           6.1A.2.1 Charging Data Request message

Table 6.1A.2.1.1 illustrates the basic structure of a Charging Data Request
message from the MME, S-GW, ePDG, TWAG, P-GW and TDF as used for PS offline
charging and ""SMS over MME Charging".

          Table 6.1A.2.1.1: Charging Data Request message contents

|Information       |Categor|Description                                   |
|Element           |y      |                                              |
|Session Identifier|M      |Described in TS 32.299 [50]                   |
|Originator Host   |M      |Described in TS 32.299 [50]                   |
|Originator Domain |M      |Described in TS 32.299 [50]                   |
|Destination Domain|M      |Described in TS 32.299 [50]                   |
|Operation Type    |M      |Described in TS 32.299 [50]                   |
|Operation Number  |M      |Described in TS 32.299 [50]                   |
|Operation         |OC     |Described in TS 32.299 [50]                   |
|Identifier        |       |                                              |
|User Name         |OC     |The content of the field corresponds to the   |
|                  |       |Protocol Configuration Options (PCO) field of |
|                  |       |the Create IP-CAN bearer Request message.     |
|                  |       |(ffs)                                         |
|Destination Host  |OC     |Described in TS 32.299 [50]                   |
|Operation Interval|OC     |Described in TS 32.299 [50]                   |
|Origination State |OC     |Described in TS 32.299 [50]                   |
|Origination       |OC     |Described in TS 32.299 [50]                   |
|Timestamp         |       |                                              |
|Proxy Information |OC     |Described in TS 32.299 [50]                   |
|Route Information |OC     |Described in TS 32.299 [50]                   |
|Operation Token   |OM     |This field identifies the PS domain.          |
|Service           |OM     |This field holds the PS charging specific     |
|Information       |       |parameters described in clause 6.3.           |


  NOTE:  Detailed descriptions of the fields are provided in TS 32.299
         [50].


6.1A.2.2 Charging Data Response message

Table 6.1A.2.2.1 illustrates the basic structure of a Charging Data
Response message as used for the ePDG, TWAG, MME, S-GW, P-GW and TDF.

         Table 6.1A.2.2.1 : Charging Data Response message contents

|AVP                      |Category |Description         |
|Session Identifier       |M        |Described in TS     |
|                         |         |32.299 [50]         |
|Operation Result         |M        |Described in TS     |
|                         |         |32.299 [50]         |
|Originator Host          |M        |Described in TS     |
|                         |         |32.299 [50]         |
|Originator Domain        |M        |Described in TS     |
|                         |         |32.299 [50]         |
|Operation Type           |M        |Described in TS     |
|                         |         |32.299 [50]         |
|Operation Number         |OC       |Described in TS     |
|                         |         |32.299 [50]         |
|Operation Identifier     |OC       |Described in TS     |
|                         |         |32.299 [50]         |
|Operation Interval       |OC       |Described in TS     |
|                         |         |32.299 [50]         |
|Error Reporting Host     |OC       |Described in TS     |
|                         |         |32.299 [50]         |
|Origination State        |OC       |Described in TS     |
|                         |         |32.299 [50]         |
|Origination Timestamp    |OC       |Described in TS     |
|                         |         |32.299 [50]         |
|Proxy Information        |OC       |Described in TS     |
|                         |         |32.299 [50]         |


  NOTE:  Detailed descriptions of the fields are provided in TS 32.299
         [50].



         6.1B CDR content description on Bp interface


6.1B.0 General

This clause describes the CDR parameters used in the CDRs.

The tables in the subsequent parts of this clause specify the designations
for  the category of a CDR parameter ("field categories") according to the
charging data configuration defined in clause 5.4 of TS 32.240 [1].

The following tables 6.1.1.1 - 6.1.14.1 provide a brief description of each
CDR parameter. Full definitions of the CDR parameters, sorted by the name
in alphabetical order, are provided in TS 32.298 [51].



         6.1.1  IP-CAN bearer charging data in SGSN (S-CDR)

If the collection of CDR data is enabled then the SGSN data specified in
table 6.1.1.1 shall be available for each IP-CAN bearer.

               Table 6.1.1.1: SGSN IP-CAN bearer data (S-CDR)

|Field                     |Catego|Description                              |
|                          |ry    |                                         |
|Record Type               |M     |SGSN IP-CAN bearer record.               |
|Network Initiated PDP     |OC    |A flag that is present if this is a      |
|Context                   |      |network initiated IP-CAN bearer.         |
|Served IMSI               |C     |IMSI of the served party, if available.  |
|IMSI Unauthenticated Flag |OC    |This field indicates the provided served |
|                          |      |IMSI is not authenticated (emergency     |
|                          |      |bearer service situation).               |
|Served IMEI               |OC    |The IMEI or IMEISV of the ME, if         |
|                          |      |available. It is used for identifying the|
|                          |      |user in case Served IMSI is not present  |
|                          |      |during emergency bearer service.         |
|SGSN Address              |OM    |The IP address of the current SGSN.      |
|MS Network Capability     |OM    |The mobile station Network Capability.   |
|Routing Area Code (RAC)   |OM    |RAC at the time of "Record Opening Time".|
|Location Area Code (LAC)  |OM    |LAC at the time of "Record Opening Time".|
|User CSG information      |OC    |This field contains the User CSG         |
|                          |      |information of the UE, if available,     |
|                          |      |including CSG ID, access mode and CSG    |
|                          |      |membership indication.                   |
|Cell Identifier           |OM    |Cell identity for GSM or Service Area    |
|                          |      |Code (SAC) for UMTS at the time of       |
|                          |      |"Record Opening Time".                   |
|Charging ID               |M     |IP-CAN bearer identifier used to identify|
|                          |      |this IP-CAN bearer in different records  |
|                          |      |created by PCNs.                         |
|GGSN Address Used         |M     |The control plane IP address of the P-GW |
|                          |      |currently used. The P-GW address is      |
|                          |      |always the same for an activated IP-CAN  |
|                          |      |bearer.                                  |
|Access Point Name Network |OM    |The logical name of the connected access |
|Identifier                |      |point to the external packet data network|
|                          |      |(network identifier part of APN).        |
|PDP Type                  |OM    |PDP type, i.e. IPv4, IPv6, IPv4v6, PPP.  |
|Served PDP Address        |OC    |PDP address of the served IMSI, i.e. IPv4|
|                          |      |address when PDP Type is IPv4 or IPv6    |
|                          |      |prefix when PDP Type is IPv6 or IPv4v6.  |
|                          |      |This parameter shall be present except   |
|                          |      |when both the PDP type is PPP and dynamic|
|                          |      |PDP address assignment is used.          |
|Served PDP Address prefix |OC    |PDP/PDN Address prefix length of an IPv6 |
|length                    |      |typed Served PDP Address. The field needs|
|                          |      |not available for prefix length of 64    |
|                          |      |bits.                                    |
|Served PDP/PDN Address    |OC    |This field holds IPv4 address of the     |
|extension                 |      |served IMSI, if available, when PDP type |
|                          |      |is IPv4v6.                               |
|List of Traffic Data      |OM    |A list of changes in charging conditions |
|Volumes                   |      |for this IP-CAN bearer, each change is   |
|                          |      |time stamped. Charging conditions are    |
|                          |      |used to categorize traffic volumes, such |
|                          |      |as per tariff period. Initial and        |
|                          |      |subsequently changed QoS and             |
|                          |      |corresponding data volumes are also      |
|                          |      |listed.                                  |
|Record Opening Time       |M     |Time stamp when IP-CAN bearer is         |
|                          |      |activated in this SGSN or record opening |
|                          |      |time on subsequent partial records.      |
|Duration                  |M     |Duration of this record in the SGSN.     |
|SGSN Change               |C     |Present if this is first record after    |
|                          |      |SGSN change.                             |
|Cause for Record Closing  |M     |The reason for closure of the record from|
|                          |      |this SGSN.                               |
|Diagnostics               |OM    |A more detailed reason for the release of|
|                          |      |the connection.                          |
|Record Sequence Number    |C     |Partial record sequence number in this   |
|                          |      |SGSN. Only present in case of partial    |
|                          |      |records.                                 |
|Node ID                   |OM    |Name of the recording entity.            |
|Local Record Sequence     |OM    |Consecutive record number created by this|
|Number                    |      |node. The number is allocated            |
|                          |      |sequentially including all CDR types.    |
|APN Selection Mode        |OM    |An index indicating how the APN was      |
|                          |      |selected.                                |
|Access Point Name Operator|OM    |The Operator Identifier part of the APN. |
|Identifier                |      |                                         |
|Served MSISDN             |OC    |The primary MSISDN of the subscriber, if |
|                          |      |available.                               |
|Charging Characteristics  |M     |The Charging Characteristics applied to  |
|                          |      |the IP-CAN bearer.                       |
|Serving Node PLMN         |Oc    |This field holds the PLMN Identifier (MCC|
|Identifier                |      |and MNC) serving the UE during this      |
|                          |      |record. Only one value is included in    |
|                          |      |case multiple PLMN Ids are supported by  |
|                          |      |the SGSN.                                |
|CN Operator Selection     |OC    |This field indicates whether the Serving |
|Entity                    |      |Network identified by the "Serving Node  |
|                          |      |PLMN Identifier” has been selected by the|
|                          |      |UE or by the network, as defined in      |
|                          |      |TS 29.060 [203] for GPRS, and in TS      |
|                          |      |29.274 [210] for EPC, if available.      |
|RAT Type                  |OC    |This field indicates the Radio Access    |
|                          |      |Technology (RAT) type currently used by  |
|                          |      |the Mobile Station as defined in TS      |
|                          |      |29.061 [205], when available.            |
|CAMEL Information         |OC    |Set of CAMEL information related to      |
|                          |      |IP-CAN bearer. For more information see  |
|                          |      |Description of Record Fields. This field |
|                          |      |is present if CAMEL service is activated.|
|RNC Unsent Downlink Volume|OC    |The downlink data volume, which the RNC  |
|                          |      |has not sent to MS. This field is present|
|                          |      |when the RNC has provided unsent downlink|
|                          |      |volume count at RAB release.             |
|Charging Characteristics  |OM    |Holds information about how Charging     |
|Selection Mode            |      |Characteristics were selected.           |
|Dynamic Address Flag      |OC    |Indicates whether served PDP address is  |
|                          |      |dynamic, which is allocated during IP-CAN|
|                          |      |bearer activation. This field is missing |
|                          |      |if address is static.                    |
|Low Priority Indicator    |OC    |This field indicates if this IP-CAN      |
|                          |      |bearer has a low priority, i.e. for      |
|                          |      |Machine Type Communication.              |
|Record Extensions         |OC    |A set of network operator/manufacturer   |
|                          |      |specific extensions to the record.       |
|                          |      |Conditioned upon the existence of an     |
|                          |      |extension.                               |




         6.1.2  IP-CAN bearer charging data in S-GW (SGW-CDR)

If the collection of CDR data is enabled then the S-GW data specified in
table 6.1.2.1 shall be available for each IP-CAN bearer.

              Table 6.1.2.1: S-GW IP-CAN bearer data (SGW-CDR)

|Field                     |Catego|Description                              |
|                          |ry    |                                         |
|Record Type               |M     |S-GW IP-CAN bearer record.               |
|Retransmission            |OC    |This parameter, when present, indicates  |
|                          |      |that information from retransmitted      |
|                          |      |Charging Data Request has been used in   |
|                          |      |this CDR.                                |
|Served IMSI               |C     |IMSI of the served party, if available.  |
|IMSI Unauthenticated Flag |OC    |This field indicates the provided served |
|                          |      |IMSI is not authenticated (emergency     |
|                          |      |bearer service situation).               |
|Served IMEI               |OC    |The IMEI or IMEISV of the ME, if         |
|                          |      |available. It is used for identifying the|
|                          |      |user in case Served IMSI is not present  |
|                          |      |during emergency bearer service.         |
|S-GW Address used         |M     |The control plane IP address of the S-GW |
|                          |      |used.                                    |
|S-GW Address IPv6         |OC    |The control plane IPv6 address, in case  |
|                          |      |of IPv4v6 dual stack, of the S-GW.       |
|Charging ID               |M     |IP-CAN bearer Charging identifier used to|
|                          |      |identify this IP-CAN bearer in different |
|                          |      |records created by PCNs                  |
|PDN Connection Charging Id|OM    |This field holds the explicit Charging Id|
|                          |      |for the PDN connection if received from  |
|                          |      |the P-GW.                                |
|                          |      |Otherwise, the field holds the Charging  |
|                          |      |Id of the EPS default bearer in GTP case,|
|                          |      |or the unique Charging Id of the IP-CAN  |
|                          |      |session in PMIP case.                    |
|                          |      |This field is used to identify different |
|                          |      |records belonging to same PDN connection.|
|Serving Node Address      |M     |List of serving node control plane IP    |
|                          |      |addresses (e.g. S4-SGSN, MME, …) used    |
|                          |      |during this record.                      |
|Serving Node IPv6 Address |OC    |List of serving node control plane IPv6  |
|                          |      |addresses, in case of IPv4v6 dual stack, |
|                          |      |(e.g. S4-SGSN, MME, …) used during this  |
|                          |      |record.                                  |
|Serving node Type         |M     |List of serving node types in control    |
|                          |      |plane. The serving node types listed here|
|                          |      |map to the serving node addresses listed |
|                          |      |in the field "Serving node Address" in   |
|                          |      |sequence.                                |
|S-GW Change               |OC    |Present if this is first record after a  |
|                          |      |change from another serving node (i.e.   |
|                          |      |SGW, ePDG, HSGW).                        |
|PGW PLMN Identifier       |Oc    |PLMN identifier (MCC MNC) of the P-GW    |
|                          |      |used.                                    |
|Access Point Name Network |OM    |The logical name of the connected access |
|Identifier                |      |point to the external packet data network|
|                          |      |(network identifier part of APN).        |
|PDP/PDN Type              |OM    |This field indicates PDN type (i.e. IPv4,|
|                          |      |IPv6 or IPv4v6).                         |
|PDP/PDN Type extension    |OM    |This field indicates Non-IP PDN type.    |
|Served PDP/PDN Address    |OC    |IP address allocated for the PDP context |
|                          |      |/ PDN connection, if available, i.e. IPv4|
|                          |      |address when PDN Type is IPv4 or IPv6    |
|                          |      |prefix when PDN Type is IPv6 or IPv4v6.  |
|                          |      |For non-IP PDN connection, this field is |
|                          |      |not present                              |
|Served PDP/PDN Address    |OC    |PDP/PDN Address prefix length of an IPv6 |
|prefix length             |      |typed Served PDP Address. The field needs|
|                          |      |not available for prefix length of 64    |
|                          |      |bits.                                    |
|                          |      |For non-IP PDN connection, this field is |
|                          |      |not present.                             |
|Served PDP/PDN Address    |OC    |This field holds IPv4 address of the     |
|extension                 |      |served IMSI, if available, when PDN type |
|                          |      |is IPv4v6.                               |
|                          |      |For non-IP PDN connection, this field is |
|                          |      |not present.                             |
|Dynamic Address Flag      |OC    |Indicates whether served PDP/PDN address |
|                          |      |is dynamic, which is allocated during    |
|                          |      |IP-CAN bearer activation, initial attach |
|                          |      |(E-UTRAN or over S2x) and UE requested   |
|                          |      |PDN connectivity. This field is missing  |
|                          |      |if IPv4 address is static when PDN Type  |
|                          |      |is IPv4, or if IPv6 address is static    |
|                          |      |when PDN Type is IPv6 or IPv4v6.         |
|Dynamic Address Flag      |OC    |Indicates whether served IPv4 PDP/PDN    |
|extension                 |      |address is dynamic, which is allocated   |
|                          |      |during IP-CAN bearer activation, initial |
|                          |      |attach (E-UTRAN or over S2x) and UE      |
|                          |      |requested PDN connectivity with PDP/PDN  |
|                          |      |type IPv4v6. This field is missing if    |
|                          |      |IPv4 address is static.                  |
|List of Traffic Data      |OM    |A list of changes in charging conditions |
|Volumes                   |      |for this QCI/ARP pair, each change is    |
|                          |      |time stamped. Charging conditions are    |
|                          |      |used to categorize traffic volumes, such |
|                          |      |as per tariff period. Initial and        |
|                          |      |subsequently changed QoS and             |
|                          |      |corresponding data values are also       |
|                          |      |listed.                                  |
|Record Opening Time       |M     |Time stamp when IP-CAN bearer is         |
|                          |      |activated in this S-GW or record opening |
|                          |      |time on subsequent partial records.      |
|MS Time Zone              |OC    |This field contains the MS Time Zone the |
|                          |      |MS is currently located as defined in    |
|                          |      |TS 29.060 [203], if available.           |
|Last MS Time Zone         |OC    |This field contains the UE Time Zone the |
|                          |      |UE is located at IP-CAN bearer           |
|                          |      |deactivation, or at default bearer       |
|                          |      |deactivation when IP-CAN session charging|
|                          |      |is active, when available.               |
|Duration                  |M     |Duration of this record in the S-GW.     |
|Cause for Record Closing  |M     |The reason for the release of record from|
|                          |      |this S-GW.                               |
|Diagnostics               |OM    |A more detailed reason for the release of|
|                          |      |the IP-CAN bearer, when a single cause is|
|                          |      |applicable.                              |
|Enhanced Diagnostics      |OC    |This field holds a more detailed reason  |
|                          |      |for the release of the IP-CAN bearer,    |
|                          |      |when a set of causes is applicable.      |
|Record Sequence Number    |C     |Partial record sequence number, only     |
|                          |      |present in case of partial records.      |
|Node ID                   |OM    |Name of the recording entity.            |
|Local Record Sequence     |OM    |Consecutive record number created by this|
|Number                    |      |node. The number is allocated            |
|                          |      |sequentially including all CDR types.    |
|APN Selection Mode        |OM    |An index indicating how the APN was      |
|                          |      |selected.                                |
|Served MSISDN             |OC    |The primary MSISDN of the subscriber, if |
|                          |      |available.                               |
|User Location Information |OC    |This field contains the User Location    |
|                          |      |Information of the MS as defined in      |
|                          |      |TS 29.060 [203] for GPRS case, and in TS |
|                          |      |29.274 [210] for EPC case, if available. |
|User Location Information |OC    |This field contains the time at which the|
|Time                      |      |user location information was acquired.  |
|Last User Location        |OC    |This field contains the User Location    |
|Information               |      |Information of the UE at IP-CAN bearer   |
|                          |      |deactivation, or at default bearer       |
|                          |      |deactivation when IP-CAN session charging|
|                          |      |is active, when available.               |
|User CSG information      |OC    |This field contains the User CSG         |
|                          |      |information of the UE, if available,     |
|                          |      |including CSG ID, access mode and CSG    |
|                          |      |membership indication.                   |
|Presence Reporting Area   |OC    |This grouped field contains the Presence |
|Information               |      |Reporting Area Identifierfor the UE PDN  |
|                          |      |connection and the initial status of the |
|                          |      |UE presence in the Presence Reporting    |
|                          |      |Area, if available.                      |
|                          |      |This field is not applicable to multiple |
|                          |      |PRA(s)                                   |
|Charging Characteristics  |M     |The Charging Characteristics applied to  |
|                          |      |the IP-CAN bearer.                       |
|Charging Characteristics  |OM    |Holds information about how Charging     |
|Selection Mode            |      |Characteristics were selected.           |
|IMS Signalling Context    |OC    |Included if the IM-CN Subsystem          |
|                          |      |Signalling Flag is set, see TS 23.060    |
|                          |      |[201] IP-CAN bearer is used for IMS      |
|                          |      |signalling.                              |
|P-GW Address used.        |OC    |This field is the P-GW IP Address for the|
|                          |      |Control Plane                            |
|P-GW Address IPv6         |OC    |This field is the P-GW IPv6 Address, in  |
|                          |      |case of IPv4v6 dual stack, for the       |
|                          |      |Control Plane                            |
|Serving Node PLMN         |OC    |This field holds the PLMN Identifier (MCC|
|Identifier                |      |and MNC) serving the UE during this      |
|                          |      |record, as received in the "Serving      |
|                          |      |Network” IE over S4/S11, if available.   |
|CN Operator Selection     |OC    |This field indicates whether the Serving |
|Entity                    |      |Network identified by the "Serving Node  |
|                          |      |PLMN Identifier” has been selected by the|
|                          |      |UE or by the network, as defined in      |
|                          |      |TS 29.060 [203] for GPRS, and in TS      |
|                          |      |29.274 [210] for EPC, if available.      |
|RAT Type                  |OC    |This field indicates the Radio Access    |
|                          |      |Technology (RAT) type currently used by  |
|                          |      |the Mobile Station as defined in TS      |
|                          |      |29.061 [205], when available.            |
|Start Time                |OC    |This field holds the time when User      |
|                          |      |IP-CAN session starts, available in the  |
|                          |      |CDR for the first bearer in an IP-CAN    |
|                          |      |session.                                 |
|Stop Time                 |OC    |This field holds the time when User      |
|                          |      |IP-CAN session is terminated, available  |
|                          |      |in the CDR for the last bearer in an     |
|                          |      |IP-CAN session.                          |
|Low Priority Indicator    |OC    |This field indicates if this IP-CAN      |
|                          |      |session has a low priority, i.e. for     |
|                          |      |Machine Type Communication.              |
|CP CIoT EPS Optimisation  |OC    |This field indicates whether CP CIoT EPS |
|indicator                 |      |Optimisation is used during data transfer|
|                          |      |with the UE (i.e. Control Plane NAS PDU  |
|                          |      |via S11-U between SGW and MME) or not    |
|                          |      |(i.e.User Plane via S1-U between SGW and |
|                          |      |eNB), if enabled.                        |
|UNI PDU CP Only Flag      |OC    |This field indicates whether this PDN    |
|                          |      |connection is applied with "Control Plane|
|                          |      |Only Flag" for UNI PDU transfer, i.e.    |
|                          |      |transfer only using Control Plane NAS PDU|
|                          |      |(Control Plane CIoT EPS optimisation).   |
|Serving PLMN Rate Control |Oc    |This field holds the Serving PLMN Rate   |
|                          |      |Control used by the MME during this      |
|                          |      |record.                                  |
|MO exception data counter |Oc    |This field holds the MO exception data   |
|                          |      |counter value with the timestamp         |
|                          |      |indicating the time at which the counter |
|                          |      |value increased from 0 to 1, as defined  |
|                          |      |in TS 29.274 [210].                      |
|Record Extensions         |OC    |A set of network operator/manufacturer   |
|                          |      |specific extensions to the record.       |
|                          |      |Conditioned upon the existence of an     |
|                          |      |extension.                               |
|List of RAN Secondary RAT |OC    |A list of containers with volumes        |
|Usage Reports             |      |reported from RAN for secondary RAT      |
|                          |      |usage, each container is time stamped.   |




         6.1.3  FBC IP-CAN bearer charging data in P-GW (PGW-CDR)

If FBC is enabled and the collection of CDR data is enabled then the P-GW
data specified in table 6.1.3.1 shall be available for each IP-CAN bearer
when charging per IP-CAN session is not active, or for each IP-CAN session
when charging per IP-CAN session is active.

              Table 6.1.3.1: P-GW IP-CAN bearer data (PGW-CDR)

|Field                     |Catego|Description                                |
|                          |ry    |                                           |
|Record Type               |M     |P-GW IP-CAN bearer record.                 |
|Retransmission            |OC    |This parameter, when present, indicates    |
|                          |      |that information from retransmitted        |
|                          |      |Charging Data Request has been used in this|
|                          |      |CDR.                                       |
|Served IMSI               |C     |IMSI of the served party, if available.    |
|IMSI Unauthenticated Flag |OC    |This field indicates the provided served   |
|                          |      |IMSI is not authenticated (emergency bearer|
|                          |      |service situation).                        |
|Served IMEI               |OC    |The IMEI or IMEISV of the ME, if available.|
|                          |      |It is used for identifying the user in case|
|                          |      |Served IMSI is not present during emergency|
|                          |      |bearer service.                            |
|Served 3GPP2 MEID         |OC    |MEID of the served party's terminal        |
|                          |      |equipment for 3GPP2 access.                |
|Served MN NAI             |OC    |Mobile Node Identifier in NAI format (based|
|                          |      |on IMSI), if available.                    |
|P-GW Address used         |M     |The control plane IP address of the P-GW   |
|                          |      |used.                                      |
|P-GW Address IPv6         |OC    |The control plane IPv6 address, in case of |
|                          |      |IPv4v6 dual stack, of the P-GW used.       |
|Charging ID               |M     |IP-CAN bearer Charging identifier used to  |
|                          |      |identify this IP-CAN bearer in different   |
|                          |      |records created by PCNs.                   |
|                          |      |This field holds the unique Charging Id in |
|                          |      |the PMIP case.                             |
|                          |      |When charging per IP-CAN session is active,|
|                          |      |this field holds the Charging Id of the EPS|
|                          |      |default bearer. It is the same as the PDN  |
|                          |      |Connection Charging Id.                    |
|Charging per IP-CAN       |Oc    |This field indicates whether charging per  |
|Session Indicator         |      |IP-CAN session is active. If this field is |
|                          |      |not present, charging per IP-CAN session is|
|                          |      |not active.                                |
|PDN Connection Charging Id|OM    |This field holds the explicit Charging Id  |
|                          |      |for the PDN connection. When NBIFOM is     |
|                          |      |supported, the PGW will assign an explicit |
|                          |      |PDN Connection Charging ID for the PDN     |
|                          |      |connection.                                |
|                          |      |Otherwise the field holds the Charging Id  |
|                          |      |of the EPS default bearer.                 |
|                          |      |This field is used to identify different   |
|                          |      |records belonging to same PDN connection.  |
|Serving node Address      |M     |List of SGSN/S-GW/TWAG control plane IP    |
|                          |      |addresses, or the ePDG address used during |
|                          |      |this record.                               |
|Serving node IPv6 Address |OC    |List of SGSN/S-GW/TWAG control plane IPv6  |
|                          |      |addresses, in case of IPv4v6 dual stack,   |
|                          |      |used during this record.                   |
|Serving node Type         |M     |List of serving node types in control plane|
|                          |      |(SGSN, SGW, ePDG, AGW, TWAG). The serving  |
|                          |      |node types listed here map to the serving  |
|                          |      |node addresses listed in the field "Serving|
|                          |      |node Address" in sequence.                 |
|PGW PLMN Identifier       |Oc    |PLMN identifier (MCC MNC) of the P-GW.     |
|Access Point Name Network |OM    |The logical name of the connected access   |
|Identifier                |      |point to the external packet data network  |
|                          |      |(network identifier part of APN).          |
|PDP/PDN Type              |OM    |PDP/PDN type, i.e. IPv4, IPv6, IPv4v6 , or |
|                          |      |PDP type PPP.                              |
|PDP/PDN Type extension    |OM    |This field indicates Non-IP PDN type.      |
|SGi PtP Tunnelling Method |OC    |This field indicates whether SGi PtP       |
|                          |      |tunnelling method based on UDP/IP or other |
|                          |      |methods are used for this PDN connection   |
|                          |      |when non-IP PDN connection.                |
|SCS/AS Address            |OC    |This field holds the Address of SCS/AS for |
|                          |      |SGi PtP tunnelling.                        |
|Served PDP/PDN Address    |OC    |IP address allocated for the PDP context / |
|                          |      |PDN connection, i.e. IPv4 address when     |
|                          |      |PDP/PDN Type is IPv4 or IPv6 prefix when   |
|                          |      |PDP/PDN Type is IPv6 or IPv4v6, or assigned|
|                          |      |IP address if any when PDP/PDN Type        |
|                          |      |extension is Non-IP.                       |
|                          |      |This parameter shall be present except:    |
|                          |      |-  when both the PDP type is PPP and       |
|                          |      |dynamic IP-CAN bearer address assignment is|
|                          |      |used or                                    |
|                          |      |-  when PDP/PDN Type extension is Non-IP,  |
|                          |      |and no IP address has been assigned by the |
|                          |      |PGW for the PDN connection.                |
|Served PDP/PDN Address    |OC    |PDP/PDN Address prefix length of an IPv6   |
|prefix length             |      |typed Served PDP Address. The field needs  |
|                          |      |not available for prefix length of 64 bits.|
|Served PDP/PDN Address    |OC    |This field holds IPv4 address of the served|
|extension                 |      |IMSI, if available, when PDP/PDN type is   |
|                          |      |IPv4v6.                                    |
|Dynamic Address Flag      |OC    |Indicates whether served PDP/PDN address is|
|                          |      |dynamic, which is allocated during IP-CAN  |
|                          |      |bearer activation, initial attach (E-UTRAN |
|                          |      |or over S2x) and UE requested PDN          |
|                          |      |connectivity. This field is missing if IPv4|
|                          |      |address is static when PDN Type is IPv4, or|
|                          |      |if IPv6 address is static when PDN Type is |
|                          |      |IPv6 or IPv4v6.                            |
|Dynamic Address Flag      |OC    |Indicates whether served IPv4 PDP/PDN      |
|extension                 |      |address is dynamic, which is allocated     |
|                          |      |during IP-CAN bearer activation, initial   |
|                          |      |attach (E-UTRAN or over S2x) and UE        |
|                          |      |requested PDN connectivity with PDP/PDN    |
|                          |      |type IPv4v6. This field is missing if IPv4 |
|                          |      |address is static.                         |
|List of Traffic Data      |OC    |A list of changes in charging conditions   |
|Volumes                   |      |for all bearers within the IP-CAN session. |
|                          |      |Each change is time stamped. Charging      |
|                          |      |conditions are used to categorize traffic  |
|                          |      |volumes, such as per tariff period. Initial|
|                          |      |and subsequently changed QoS and           |
|                          |      |corresponding data values are also listed. |
|                          |      |Applicable only for IP-CAN bearer charging |
|                          |      |when IP-CAN session charging is active. See|
|                          |      |table 6.1.3.1 for a description of List of |
|                          |      |Traffic Data Volumes handling.             |
|List of Service Data      |OM    |A list of changes in charging conditions   |
|                          |      |for all service data flows within this     |
|                          |      |IP-CAN bearer categorized per rating group |
|                          |      |or per combination of the rating group and |
|                          |      |service id or per combination of rating    |
|                          |      |group, sponsor identity and application    |
|                          |      |service provider identity. Each change is  |
|                          |      |time stamped. Charging conditions are used |
|                          |      |to categorize traffic volumes, elapsed time|
|                          |      |and number of events, such as per tariff   |
|                          |      |period. Initial and subsequently changed   |
|                          |      |QoS and corresponding data values are also |
|                          |      |listed.                                    |
|                          |      |Online charging information (PS Furnish    |
|                          |      |Charging Information) may be added per each|
|                          |      |service data flow container in case it is  |
|                          |      |sent by the OCS.                           |
|                          |      |External charging identifiers may be added |
|                          |      |per each service data flow container in    |
|                          |      |case sent by the PCRF.                     |
|                          |      |Failure-Handling: This field shall be      |
|                          |      |present in case P-GW triggers the          |
|                          |      |Failure-Handling procedure. It shall       |
|                          |      |indicate the Failure Handling scenario and |
|                          |      |the instant the Failure Action is triggered|
|                          |      |(see annex B). Scenarios: Continue/New     |
|                          |      |Session; Continue/Ongoing Session;         |
|                          |      |Retry&Terminate/Ongoing Session;           |
|                          |      |Terminate/Ongoing Session.                 |
|                          |      |When charging per IP-CAN session is active,|
|                          |      |see table 6.1.3.2 for a description of List|
|                          |      |of Service Data handling.                  |
|Record Opening Time       |M     |Time stamp when IP-CAN bearer is activated |
|                          |      |in this P-GW or record opening time on     |
|                          |      |subsequent partial records.                |
|MS Time Zone              |OC    |This field contains the MS Time Zone the MS|
|                          |      |is currently located as defined in         |
|                          |      |TS 29.060 [203], if available.             |
|Last MS Time Zone         |OC    |This field contains the UE Time Zone the UE|
|                          |      |is located at IP-CAN bearer deactivation,  |
|                          |      |or at default bearer deactivation when     |
|                          |      |IP-CAN session charging is active, when    |
|                          |      |available.                                 |
|Duration                  |M     |Duration of this record in the P-GW.       |
|Cause for Record Closing  |M     |The reason for the release of record from  |
|                          |      |this P-GW.                                 |
|Diagnostics               |OM    |A more detailed reason for the release of  |
|                          |      |the IP-CAN bearer, when a single cause is  |
|                          |      |applicable                                 |
|                          |      |When charging per IP-CAN session is active,|
|                          |      |this field holds a more detailed reason for|
|                          |      |the release of the IP-CAN session, when a  |
|                          |      |single cause is applicable.  .             |
|Enhanced Diagnostics      |OC    |This field holds a more detailed reason for|
|                          |      |the release of the IP-CAN bearer, when a   |
|                          |      |set of causes is applicable.               |
|                          |      |When charging per IP-CAN session is active,|
|                          |      |this field holds a more detailed reason for|
|                          |      |the release of the IP-CAN session, when a  |
|                          |      |set of causes is applicable.               |
|Record Sequence Number    |C     |Partial record sequence number, only       |
|                          |      |present in case of partial records.        |
|Node ID                   |OM    |Name of the recording entity.              |
|Local Record Sequence     |OM    |Consecutive record number created by this  |
|Number                    |      |node. The number is allocated sequentially |
|                          |      |including all CDR types.                   |
|APN Selection Mode        |OM    |An index indicating how the APN was        |
|                          |      |selected.                                  |
|Served MSISDN             |OC    |The primary MSISDN of the subscriber, if   |
|                          |      |available.                                 |
|User Location Information |OC    |This field contains the User Location      |
|                          |      |Information of the MS when the CDR is      |
|                          |      |opened as defined in TS 29.060 [203] for   |
|                          |      |GPRS case, and in TS 29.274 [210] for EPC  |
|                          |      |case, if available.                        |
|Last User Location        |OC    |This field contains the User Location      |
|Information               |      |Information of the UE at IP-CAN bearer     |
|                          |      |deactivation, or at default bearer         |
|                          |      |deactivation when IP-CAN session charging  |
|                          |      |is active, when available.                 |
|User Location Information |OC    |This field contains the time at which the  |
|Time                      |      |user location information was acquired, if |
|                          |      |available.                                 |
|User CSG information      |OC    |This field contains the User CSG           |
|                          |      |Information of the UE, if available,       |
|                          |      |including CSG ID, access mode and CSG      |
|                          |      |membership indication.                     |
|3GPP2 User Location       |OC    |This field contains the User Location      |
|information               |      |Information of the MS when the CDR is      |
|                          |      |opened as defined in TS 29.212 [71] for    |
|                          |      |3GPP2 access, if available.                |
|TWAN User Location        |OC    |This field contains the UE location in a   |
|Information               |      |Trusted WLAN Access Network (TWAN) , if    |
|                          |      |available:                                 |
|                          |      |-  "TWAN identifier" as defined in TS      |
|                          |      |29.274 [210] for S2a GTP-based case, or,   |
|                          |      |-"Access Network Identifier Option IE" as  |
|                          |      |defined in 29.275 [211] for S2a PMIP-based |
|                          |      |case.                                      |
|UWAN User Location        |OC    |This field contains the UE location in an  |
|Information               |      |Untrusted Wireless Access Network (UWAN)   |
|                          |      |which includes the UE local IP address and |
|                          |      |optionally UDP source port number (if NAT  |
|                          |      |is detected) as defined in TS 29.274 [210].|
|                          |      |It may also include WLAN location          |
|                          |      |information (SSID and, when available,     |
|                          |      |BSSID of the access point) the ePDG may    |
|                          |      |have received from the 3GPP AAA server     |
|                          |      |about the UE as defined in TS 29.274 [210].|
|Presence Reporting Area   |OC    |This grouped field contains the Presence   |
|Information               |      |Reporting Area Identifier for the UE PDN   |
|                          |      |connection, additional the list(s) of      |
|                          |      |elements comprising the Presence Reporting |
|                          |      |Area for a UE-dedicated Presence Reporting |
|                          |      |Area, and the initial status of the UE     |
|                          |      |presence in the Presence Reporting Area, if|
|                          |      |available.                                 |
|                          |      |This field is not applicable to multiple   |
|                          |      |PRA(s).                                    |
|Charging Characteristics  |M     |The Charging Characteristics applied to the|
|                          |      |IP-CAN bearer.                             |
|Charging Characteristics  |OM    |Holds information about how Charging       |
|Selection Mode            |      |Characteristics were selected.             |
|IMS Signalling Context    |OC    |Included if the IP-CAN default bearer IM-CN|
|                          |      |Subsystem Signalling Flag is set, see TS   |
|                          |      |23.060 [201] is used for IMS signalling.   |
|Serving node PLMN         |OM    |This fields holds the PLMN Identifier (MCC |
|Identifier                |      |and MNC) serving the UE during this record,|
|                          |      |as received in the "Serving Network” IE    |
|                          |      |over S5/S8 or retrieved from the RAI       |
|                          |      |received over Gn/Gp.                       |
|                          |      |When the Serving node is TWAG, this field  |
|                          |      |includes the PLMN identifier used for UE   |
|                          |      |authentication, i.e. the VPLMN in roaming  |
|                          |      |case, and the HPLMN in non-roaming case.   |
|CN Operator Selection     |OC    |This field indicates whether the Serving   |
|Entity                    |      |Network identified by the "Serving Node    |
|                          |      |PLMN Identifier” has been selected by the  |
|                          |      |UE or by the network, as defined in        |
|                          |      |TS 29.060 [203] for GPRS, and in TS 29.274 |
|                          |      |[210] for EPC, if available.               |
|PS Furnish Charging       |OC    |Online charging session specific           |
|Information               |      |information                                |
|CAMEL Information         |OC    |Set of CAMEL information related to IP-CAN |
|                          |      |bearer, if available. This field applies   |
|                          |      |only for GPRS.                             |
|                          |      |When charging per IP-CAN session is active,|
|                          |      |this field is not applicable.              |
|RAT Type                  |OC    |This field indicates the Radio Access      |
|                          |      |Technology (RAT) type currently used by the|
|                          |      |Mobile Station as defined in TS 29.061     |
|                          |      |[205], when available.                     |
|                          |      |When NBIFOM is accepted by PCRF, this field|
|                          |      |holds the first default bearer’s RAT type  |
|                          |      |when charging per IP-CAN session is active.|
|Start Time                |OC    |This field holds the time when User IP-CAN |
|                          |      |session starts, available in the CDR for   |
|                          |      |the first bearer in an IP-CAN session.     |
|                          |      |When charging per IP-CAN session is active,|
|                          |      |this field holds the time when User IP-CAN |
|                          |      |session starts.                            |
|Stop Time                 |OC    |This field holds the time when User IP-CAN |
|                          |      |session is terminated, available in the CDR|
|                          |      |for the last bearer in an IP-CAN session.  |
|                          |      |When charging per IP-CAN session is active,|
|                          |      |this field holds the time when User IP-CAN |
|                          |      |session is terminated.                     |
|Low Priority Indicator    |OC    |This field indicates if this IP-CAN session|
|                          |      |has a low priority, i.e. for Machine Type  |
|                          |      |Communication.                             |
|QoS Information           |OC    |This field indicates the APN-AMBR uplink   |
|                          |      |and downlink information for the IP-CAN    |
|                          |      |session.                                   |
|                          |      |Applicable only when charging per IP-CAN   |
|                          |      |session is active.                         |
|NBIFOM Support            |OC    |This field indicates that NBIFOM was       |
|                          |      |requested by the UE, supported and accepted|
|                          |      |by the network for the IP-CAN session or if|
|                          |      |NBIFOM is not supported for the IP-CAN     |
|                          |      |session.                                   |
|NBIFOM Mode               |OC    |This field indicates the NBIFOM mode       |
|                          |      |selected for the PDN connection, when      |
|                          |      |NBIFOM is supported for the IP-CAN session.|
|                          |      |This field is only present when NBIFOM is  |
|                          |      |accepted.                                  |
|UNI PDU CP Only Flag      |OC    |This field indicates whether this PDN      |
|                          |      |connection is applied with "Control Plane  |
|                          |      |Only Flag" for UNI PDU transfer, i.e.      |
|                          |      |transfer only using Control Plane NAS PDU  |
|                          |      |(Control Plane CIoT EPS optimisation).     |
|Serving PLMN Rate Control |Oc    |This field holds the Serving PLMN Rate     |
|                          |      |Control used by the MME during this record |
|APN Rate Control          |Oc    |This field holds the APN Rate Controls     |
|                          |      |enforced in the PGW during this record.    |
|MO exception data counter |Oc    |This field holds the MO exception data     |
|                          |      |counter value with the timestamp indicating|
|                          |      |the time at which the counter value        |
|                          |      |increased from 0 to 1, as defined in TS    |
|                          |      |29.274 [210].                              |
|Record Extensions         |OC    |A set of network operator/manufacturer     |
|                          |      |specific extensions to the record.         |
|                          |      |Conditioned upon the existence of an       |
|                          |      |extension.                                 |
|3GPP PS Data Off Status   |Oc    |This field holds the 3GPP PS Data Off      |
|                          |      |Status.                                    |
|List of RAN Secondary RAT |OC    |A list of containers with volumes reported |
|Usage Reports             |      |from RAN for secondary RAT usage, each     |
|                          |      |container is time stamped.                 |


Table 6.1.3.2 contains special handling for the fields in the List of
Traffic Data Volumes in PGW-CDR when charging per IP-CAN session is active
and IP-CAN bearer charging is performed.

Table 6.1.3.2: List of Traffic Data Volumes in PGW-CDR when charging per IP-
                            CAN session is active

|Field                     |Catego|Description                                |
|                          |ry    |                                           |
|Data Volume Uplink        |OC    |This field includes the number of octets   |
|                          |      |transmitted during the use of the packet   |
|                          |      |data services in the uplink direction.     |
|Data Volume Downlink      |OC    |This field includes the number of octets   |
|                          |      |transmitted during the use of the packet   |
|                          |      |data services in the downlink direction.   |
|Change Condition          |M     |This field defines the reason for closing  |
|                          |      |the container as specified in clause       |
|                          |      |5.2.1.10.1.                                |
|Change Time               |M     |This field is a time stamp, which defines  |
|                          |      |the moment when the volume container is    |
|                          |      |closed.                                    |
|User Location Information |OC    |This field contains the location (e.g.     |
|                          |      |CGI/SAI, ECGI/TAI or RAI) where the UE is  |
|                          |      |located and used during the transfer of the|
|                          |      |data volume captured by the container. This|
|                          |      |is included in the Traffic data container  |
|                          |      |only if previous container's change        |
|                          |      |condition is "user location change".       |
|UWAN User Location        |OC    |This field contains the UE location in an  |
|Information               |      |Untrusted Wireless Access Network (UWAN)   |
|                          |      |which includes the UE local IP address and |
|                          |      |optionally UDP or TCP source port number   |
|                          |      |(if NAT is detected) as defined in TS      |
|                          |      |29.274 [210]. It may also include WLAN     |
|                          |      |location information  the ePDG may have    |
|                          |      |received from the 3GPP AAA server about the|
|                          |      |UE as "WLAN location information" defined  |
|                          |      |in TS 29.274 [210].                        |
|TWAN User Location        |OC    |This field contains the UE location in a   |
|Information               |      |Trusted WLAN Access Network (TWAN), if     |
|                          |      |available:                                 |
|                          |      |- as "TWAN identifier" defined in TS 29.274|
|                          |      |[210] for S2a GTP-based case, or,          |
|                          |      |-  as "Access Network Identifier Option IE"|
|                          |      |defined in 29.275 [211] for S2a PMIP-based |
|                          |      |case.                                      |
|Presence Reporting Area   |OC    |This field contains the status of the UE   |
|Status                    |      |presence in Presence Reporting Area.       |
|                          |      |This field is not applicable to multiple   |
|                          |      |PRA(s).                                    |
|List of Presence Reporting|OC    |This field contains a list of Presence     |
|Area Information          |      |Reporting Area Identifier(s) for the UE PDN|
|                          |      |connection, and the Presence Reporting     |
|                          |      |Area(s) status (UE presence or not,        |
|                          |      |inactive), differentiated between PCRF and |
|                          |      |OCS subscription.                          |
|EPC QoS Information       |OC    |This field contains the authorized QoS for |
|                          |      |the IP-CAN bearer. First container for each|
|                          |      |QCI/ARP pair includes this field. In       |
|                          |      |following containers this field is present |
|                          |      |if previous change condition is "QoS       |
|                          |      |change".                                   |
|                          |      |This field includes: QCI and ARP. For GBR  |
|                          |      |QCI values, this field also includes GBR   |
|                          |      |for the downlink and uplink direction. If  |
|                          |      |the MBR is different than the GBR, then    |
|                          |      |this field also includes the MBR for the   |
|                          |      |downlink and uplink direction.             |
|                          |      |This field does not include the APN-AMBR,  |
|                          |      |which is contained in a separate field in  |
|                          |      |the CDR for the IP-CAN session.            |
|Charging Id               |OC    |IP-CAN bearer Charging identifier used to  |
|                          |      |identify this IP-CAN bearer in different   |
|                          |      |records created by PCNs.                   |
|                          |      |Charging Id is generated by P-GW at IP-CAN |
|                          |      |bearer activation and is included in all   |
|                          |      |containers in order to identify the        |
|                          |      |containers which pertain to the IP-CAN     |
|                          |      |bearer.                                    |
|RAT Type                  |OC    |This field contains the RAT type for the   |
|                          |      |current IP-CAN bearer.                     |
|Access Availability Change|OC    |This field indicates the reason why the    |
|Reason                    |      |availability of an access is changed by the|
|                          |      |PCEF, i.e. RAN rule indication or Access   |
|                          |      |usable/unusable. This field is only present|
|                          |      |when one access of a multi-access PDN      |
|                          |      |connection becomes unusable.               |
|Related Change Condition  |OC    |This field indicates the change condition  |
|Information               |      |associated with an alternate access of a   |
|                          |      |multi-access PDN connection that indirectly|
|                          |      |caused closure of the container. This field|
|                          |      |includes optional supplemental information |
|                          |      |associated with the change event (e.g.,    |
|                          |      |user location information).                |
|Diagnostics               |OM    |A more detailed reason for the release of  |
|                          |      |the IP-CAN bearer, when a single cause is  |
|                          |      |applicable.                                |
|Enhanced Diagnostics      |OC    |This field holds a more detailed reason for|
|                          |      |the release of the IP-CAN bearer, when a   |
|                          |      |set of causes is applicable.               |
|3GPP PS Data Off Status   |OC    |This field contains the status of the UE’s |
|                          |      |3GPP PS Data off Status.                   |
|Serving PLMN Rate Control |OC    |This field holds the Serving PLMN Rate     |
|                          |      |Control used by the MME                    |
|APN Rate Control          |OC    |This field holds the APN Rate Controls     |
|                          |      |enforced in the PGW                        |


Table 6.1.3.3 contains special handling for fields in the List of Service
Data when charging per IP-CAN session is active. The complete set of fields
in the List of Service Data is defined in TS 32.298 [51].

   Table 6.1.3.3: List of Service Data in PGW-CDR when charging per IP-CAN
                              session is active

|Field                     |Catego|Description                                |
|                          |ry    |                                           |
|AF Record Information     |OC    |As specified in TS 32.298 [51].            |
|Charging Rule Base Name   |OC    |As specified in TS 32.298 [51].            |
|ADC Rule Base Name        |OC    |Not applicable to PGW-CDR.                 |
|Data Volume Downlink      |OC    |As specified in TS 32.298 [51].            |
|Data Volume Uplink        |OC    |As specified in TS 32.298 [51].            |
|Event Based Charging      |OC    |As specified in TS 32.298 [51].            |
|Information               |      |                                           |
|Local Sequence Number     |OC    |As specified in TS 32.298 [51].            |
|PS Furnish Charging       |OC    |As specified in TS 32.298 [51].            |
|Information               |      |                                           |
|EPC QoS Information       |OC    |This field contains the authorized QoS for |
|                          |      |the IP-CAN bearer that is first reported   |
|                          |      |for the Rating Group or Rating Group /     |
|                          |      |Service Identifier in the container. If    |
|                          |      |traffic from multiple bearers is included  |
|                          |      |in the report for the container, only one  |
|                          |      |field is included.                         |
|                          |      |                                           |
|                          |      |This field includes: QCI and ARP. For      |
|                          |      |non-GBR QCI values, this field also        |
|                          |      |includes the MBR for the downlink and      |
|                          |      |uplink direction. For GBR QCI values, this |
|                          |      |field also includes GBR for the downlink   |
|                          |      |and uplink direction. If the MBR is        |
|                          |      |different than the GBR, then this field    |
|                          |      |also includes the MBR for the downlink and |
|                          |      |uplink direction.                          |
|                          |      |                                           |
|                          |      |This field does not include the APN-AMBR,  |
|                          |      |which is contained in a separate field in  |
|                          |      |the CDR for the IP-CAN session.            |
|Rating Group              |M     |As specified in TS 32.298 [51].            |
|Report Time               |M     |As specified in TS 32.298 [51].            |
|Result Code               |OC    |As specified in TS 32.298 [51].            |
|Service Condition Change  |M     |As specified in TS 32.298 [51].            |
|                          |      |Only those values specified for the events |
|                          |      |in clause 5.3.2.X apply.                   |
|Service Identifier        |OC    |As specified in TS 32.298 [51].            |
|Service Specific Info     |OC    |As specified in TS 32.298 [51].            |
|Serving Node Address      |OC    |As specified in TS 32.298 [51].            |
|Time of First Usage       |OC    |As specified in TS 32.298 [51].            |
|Time of Last Usage        |OC    |As specified in TS 32.298 [51].            |
|Tme Usage                 |OC    |As specified in TS 32.298 [51].            |
|User Location Information |OC    |As specified in TS 32.298 [51].            |
|3GPP2 User Location       |OC    |As specified in TS 32.298 [51].            |
|Information               |      |                                           |
|UWAN User Location        |OC    |This field contains the UE location in an  |
|Information               |      |Untrusted Wireless Access Network (UWAN)   |
|                          |      |which includes the UE local IP address and |
|                          |      |optionally UDP or TCP source port number   |
|                          |      |(if NAT is detected) as defined in TS      |
|                          |      |29.274 [210]. It may also include WLAN     |
|                          |      |location information  the ePDG may have    |
|                          |      |received from the 3GPP AAA server about the|
|                          |      |UE as "WLAN location information" defined  |
|                          |      |in TS 29.274 [210].                        |
|Presence Reporting Area   |OC    |This field contains the status of the UE   |
|Status                    |      |presence in Presence Reporting Area as     |
|                          |      |defined in TS 29.274[210].                 |
|                          |      |This field is not applicable to multiple   |
|                          |      |PRA(s).                                    |
|List of Presence Reporting|OC    |This field contains a list of Presence     |
|Area Information          |      |Reporting Area Identifier(s) for the UE PDN|
|                          |      |connection, and the Presence Reporting     |
|                          |      |Area(s) status (UE presence or not,        |
|                          |      |inactive), differentiated between PCRF and |
|                          |      |OCS subscription.                          |
|RAT Type                  |OC    |This field contains the RAT type for the   |
|                          |      |IP-CAN bearer that is first reported for   |
|                          |      |the Rating Group or Rating Group / Service |
|                          |      |Identifier in the container. If traffic    |
|                          |      |from multiple bearers is included in the   |
|                          |      |report for the container, only one field is|
|                          |      |included.                                  |
|Sponsor Identity          |OC    |As specified in TS 32.298 [51].            |
|Application Service       |OC    |As specified in TS 32.298 [51].            |
|Provider Identity         |      |                                           |
|Time Quota Mechanism      |OC    |As specified in TS 32.298 [51].            |
|Related Change Condition  |OC    |This field indicates the change condition  |
|Information               |      |associated with an alternate access of a   |
|                          |      |multi-access PDN connection that indirectly|
|                          |      |caused closure of the container. This field|
|                          |      |includes optional supplemental information |
|                          |      |associated with the change event (e.g.,    |
|                          |      |user location information).                |
|3GPP PS Data Off Status   |OC    |This field contains the status of the UE’s |
|                          |      |3GPP PS Data Off Status.                   |
|Traffic Steering Policy   |OC    |This field contains the traffic steering   |
|Identifier Uplink         |      |policy identifier in the uplink direction. |
|Traffic Steering Policy   |OC    |This field contains the traffic steering   |
|Identifier Downlink       |      |policy identifier in the downlink          |
|                          |      |direction.                                 |
|Serving PLMN Rate Control |OC    |This field holds the Serving PLMN Rate     |
|                          |      |Control used by the MME                    |
|APN Rate Control          |OC    |This field holds the APN Rate Controls     |
|                          |      |enforced in the PGW                        |

         6.1.4  Mobile Station mobility management data in SGSN (M-CDR)

If the collection of MS mobility management data is enabled then the SGSN
shall start collecting the information specified in the following table
6.1.4.1 each time the mobile is attached to the SGSN.

     Table 6.1.4.1: SGSN Mobile Station mobility management data (M-CDR)

|Field                     |Catego|Description                              |
|                          |ry    |                                         |
|Record Type               |M     |SGSN mobility management record.         |
|Served IMSI               |M     |IMSI of the MS.                          |
|Served IMEI               |OC    |The IMEI or IMEISV of the ME, if         |
|                          |      |available.                               |
|SGSN Address              |OM    |The IP address of the current SGSN.      |
|MS Network Capability     |OM    |The mobile station network capability.   |
|Routing Area Code         |OM    |Routing Area at the time of the Record   |
|                          |      |Opening Time.                            |
|Local Area Code           |OM    |Location Area Code at the time of Record |
|                          |      |Opening Time.                            |
|Cell Identifier           |OM    |The Cell Identity for GSM or Service Area|
|                          |      |Code (SAC) for UMTS at the time of the   |
|                          |      |Record Opening Time.                     |
|Cell PLMN Id              |OM    |The MCC and MNC of the Cell at the time  |
|                          |      |of Record Opening Time.                  |
|Change of Location        |OC    |A list of changes in Routing Area Code   |
|                          |      |including MCC and MNC, each with a time  |
|                          |      |stamp. This field is not required if     |
|                          |      |partial records are generated when the   |
|                          |      |location changes.                        |
|Record Opening Time       |M     |Timestamp when MS is attached to this    |
|                          |      |SGSN or record opening time on following |
|                          |      |partial record.                          |
|Duration                  |OM    |Duration of this record.                 |
|SGSN Change               |C     |Present if this is first record after    |
|                          |      |SGSN change.                             |
|Cause for Record Closing  |M     |The reason for the closure of the record |
|                          |      |in this SGSN.                            |
|Diagnostics               |OM    |A more detailed reason for the release of|
|                          |      |the connection.                          |
|Record Sequence Number    |C     |Partial record sequence number in this   |
|                          |      |SGSN; only present in case of partial    |
|                          |      |records.                                 |
|Node ID                   |OM    |Name of the recording entity.            |
|Local Record Sequence     |OM    |Consecutive record number created by this|
|Number                    |      |node. The number is allocated            |
|                          |      |sequentially including all CDR types.    |
|Served MSISDN             |Oc    |The primary MSISDN of the subscriber, if |
|                          |      |available.                               |
|Charging Characteristics  |M     |The Charging Characteristics used by the |
|                          |      |SGSN.                                    |
|Serving Node PLMN         |Oc    |This field holds the PLMN Identifier (MCC|
|Identifier                |      |and MNC) serving the UE during this      |
|                          |      |record. Only one value is included in    |
|                          |      |case multiple PLMN Ids are supported by  |
|                          |      |the SGSN.                                |
|CN Operator Selection     |OC    |This field indicates whether the Serving |
|Entity                    |      |Network identified by the "Serving Node  |
|                          |      |PLMN Identifier” has been selected by the|
|                          |      |UE or by the network, as defined in      |
|                          |      |TS 29.060 [203] for GPRS, and in TS      |
|                          |      |29.274 [210] for EPC, if available.      |
|CAMEL Information         |OC    |Set of CAMEL information related to      |
|                          |      |Attach/Detach session. For more          |
|                          |      |information see Description of Record    |
|                          |      |Fields. This field is present if CAMEL   |
|                          |      |service is activated.                    |
|RAT Type                  |OC    |This field indicates the Radio Access    |
|                          |      |Technology (RAT) type currently used by  |
|                          |      |the Mobile Station as defined in TS      |
|                          |      |29.061 [205], when available.            |
|Charging Characteristics  |OM    |Holds information about how Charging     |
|Selection Mode            |      |Characteristics were selected.           |
|Record Extensions         |OC    |A set of network operator/manufacturer   |
|                          |      |specific extensions to the record.       |
|                          |      |Conditioned upon the existence of an     |
|                          |      |extension.                               |



6.1.5  SMS-MO data in SGSN/MME (S-SMO-CDR)

If enabled, an S-SMO-CDR SGSN/MME Mobile originated SMS record shall be
produced for each short message sent by a mobile subscriber via the
SGSN/via the MME to the SMSC.
The fields in the record are specified in table 6.1.5.1.

      Table 6.1.5.1: SGSN/MME Mobile originated SMS record (S-SMO-CDR)

|Field            |Category      |Description                               |
|                 |SGSN   |MME   |                                          |
|Record Type      |M      |M     |SGSN/MME Mobile Originated SMS.           |
|Retransmission   |-      |OC    |This parameter, when present, indicates   |
|                 |       |      |that information from retransmitted       |
|                 |       |      |Charging Data Requesthas been used in this|
|                 |       |      |CDR.                                      |
|Served IMSI      |M      |M     |The IMSI of the subscriber.               |
|Served IMEI      |OC     |OC    |The IMEI or IMEISV of the ME, if          |
|                 |       |      |available.                                |
|Served MSISDN    |OC     |OC    |The primary MSISDN of the subscriber, if  |
|                 |       |      |available. For MSISDN-less subscription,  |
|                 |       |      |this field holds the Dummy MSISDN as      |
|                 |       |      |defined in TS 23.003 [103].               |
|MS Network       |OM     |-     |The mobile station network capability.    |
|Capability       |       |      |                                          |
|Service Centre   |OM     |OM    |The address (E.164) of the SMS-service    |
|                 |       |      |centre.                                   |
|Serving Node Type|M      |M     |Type of node handling the SMS (SGSN or    |
|                 |       |      |MME).                                     |
|Recording Entity |OM     |OM    |The E.164 number of the SGSN/MME.         |
|Serving Node     |-      |OM    |The address of the MME used.              |
|Address          |       |      |                                          |
|Serving Node IPv6|-      |OC    |The IPv6 address, in case of IPv4v6 dual  |
|Address Address  |       |      |stack, of the MME.                        |
|MME Name         |-      |OM    |The operation Identity of the MME.        |
|MME Realm        |-      |OM    |The operation Realm Identity of the MME.  |
|Location Area    |OM     |-     |The Location Area Code from which the     |
|Code             |       |      |message originated.                       |
|Routing Area Code|OM     |-     |The Routing Area Code from which the      |
|                 |       |      |message originated.                       |
|Cell Identifier  |OM     |-     |The Cell Identity for GSM or Service Area |
|                 |       |      |Code (SAC) for UMTS from which the message|
|                 |       |      |originated.                               |
|User Location    |-      |OC    |This field contains the User Location     |
|Information      |       |      |(User location Information as defined in  |
|                 |       |      |TS 29.274 [210]) from which the message   |
|                 |       |      |originated.                               |
|User Location    |-      |OC    |This field contains the time at which the |
|Information Time |       |      |user location information was acquired.   |
|Message Reference|M      |M     |A reference provided by the MS uniquely   |
|                 |       |      |identifying this message.                 |
|Event Time Stamp |M      |M     |The time at which the message was received|
|                 |       |      |by the SGSN/MME from the subscriber.      |
|SMS Result       |C      |C     |The result of the attempted delivery if   |
|                 |       |      |unsuccessful.                             |
|Node ID          |OM     |OM    |Name of the recording entity.             |
|Local Record     |OM     |OM    |Consecutive record number created by this |
|Sequence Number  |       |      |node. The number is allocated sequentially|
|                 |       |      |including all CDR types.                  |
|Charging         |M      |M     |The Charging Characteristics flag set used|
|Characteristics  |       |      |by the SGSN/MME.                          |
|Serving Node PLMN|Oc     |Oc    |This field holds the PLMN Identifier (MCC |
|Identifier       |       |      |and MNC) serving the UE during this       |
|                 |       |      |record. Only one value is included in case|
|                 |       |      |multiple PLMN Ids are supported by the    |
|                 |       |      |SGSN/MME.                                 |
|CN Operator      |OC     |OC    |This field indicates whether the Serving  |
|Selection Entity |       |      |Network identified by the "Serving Node   |
|                 |       |      |PLMN Identifier” has been selected by the |
|                 |       |      |UE or by the network, as defined in       |
|                 |       |      |TS 29.060 [203] for GPRS, and in TS 29.274|
|                 |       |      |[210] for EPC, if available.              |
|RAT Type         |OC     |OC    |This field indicates the Radio Access     |
|                 |       |      |Technology (RAT) type currently used by   |
|                 |       |      |the Mobile Station as defined in TS 29.061|
|                 |       |      |[205], when available.                    |
|Destination      |OM     |OM    |The destination short message subscriber  |
|Number           |       |      |number.                                   |
|CAMEL Information|OC     |-     |Set of CAMEL information related to SMS   |
|                 |       |      |session. For more information see         |
|                 |       |      |Description of Record Fields. This field  |
|                 |       |      |is present if CAMEL service is activated. |
|Charging         |OM     |OM    |Holds information about how Charging      |
|Characteristics  |       |      |Characteristics were selected.            |
|Selection Mode   |       |      |                                          |
|Record Extensions|OC     |OC    |A set of network operator/ manufacturer   |
|                 |       |      |specific extensions to the record.        |
|                 |       |      |Conditioned upon the existence of an      |
|                 |       |      |extension.                                |



6.1.6  SMS-MT data in SGSN/MME (S-SMT-CDR)

If enabled, an SGSN/MME Mobile terminated SMS record shall be produced for
each short message received by a mobile subscriber via the SGSN/ from the
SMSC via the MME. The fields in the record are specified in table 6.1.6.1.

      Table 6.1.6.1: SGSN/MME Mobile terminated SMS record (S-SMT-CDR)

|Field            |Category       |Description                              |
|                 |SGSN   |MME    |                                         |
|Record Type      |M      |M      |SGSN/MME Mobile Terminated SMS.          |
|Retransmission   |-      |OC     |This parameter, when present, indicates  |
|                 |       |       |that information from retransmitted      |
|                 |       |       |Charging Data Request has been used in   |
|                 |       |       |this CDR.                                |
|Served IMSI      |M      |M      |The IMSI of the subscriber.              |
|Served IMEI      |OC     |OC     |The IMEI or IMEISV of the ME, if         |
|                 |       |       |available.                               |
|Served MSISDN    |OC     |OC     |The primary MSISDN of the subscriber.    |
|MS Network       |OM     |-      |The mobile station network capability.   |
|Capability       |       |       |                                         |
|Service Centre   |OM     |OM     |The address (E.164) of the SMS-service   |
|                 |       |       |centre.                                  |
|Serving Node Type|M      |M      |Type of node handling the SMS (SGSN or   |
|                 |       |       |MME)                                     |
|Recording Entity |OM     |OM     |The E.164 number of the SGSN/MME.        |
|Serving Node     |-      |OM     |The address of the MME used              |
|Address          |       |       |                                         |
|Serving Node IPv6|-      |OC     |The IPv6 address, in case of IPv4v6 dual |
|Address  Address |       |       |stack, of the MME.                       |
|MME Name         |-      |OM     |The Diameter Identity of the MME         |
|MME Realm        |-      |OM     |The Diameter Realm Identity of the MME   |
|Location Area    |OM     |-      |The Location Area Code to which the      |
|Code             |       |       |message was delivered.                   |
|Routing Area Code|OM     |-      |The Routing Area Code to which the       |
|                 |       |       |message was delivered.                   |
|Cell Identifier  |OM     |-      |The Cell Identity for GSM or Service Area|
|                 |       |       |Code (SAC) for UMTS to which the message |
|                 |       |       |was delivered.                           |
|User Location    |-      |OC     |This field contains the User Location    |
|Information      |       |       |(User location Information as defined in |
|                 |       |       |TS 29.274 [210]) to which the message was|
|                 |       |       |delivered, if available.                 |
|User Location    |-      |OC     |This field contains the time at which the|
|Information Time |       |       |user location information was acquired.  |
|Event Time Stamp |M      |M      |Delivery time stamp, time at which       |
|                 |       |       |message was sent to the MS by the        |
|                 |       |       |SGSN/MME.                                |
|SMS Result       |C      |C      |The result of the attempted delivery if  |
|                 |       |       |unsuccessful.                            |
|Node ID          |OM     |OM     |Name of the recording entity.            |
|Local Record     |OM     |OM     |Consecutive record number created by this|
|Sequence Number  |       |       |node. The number is allocated            |
|                 |       |       |sequentially including all CDR types.    |
|Charging         |M      |M      |The Charging Characteristics flag set    |
|Characteristics  |       |       |used by the SGSN/MME.                    |
|Serving Node PLMN|Oc     |Oc     |This field holds the PLMN Identifier (MCC|
|Identifier       |       |       |and MNC) serving the UE during this      |
|                 |       |       |record. Only one value is included in    |
|                 |       |       |case multiple PLMN Ids are supported by  |
|                 |       |       |the SGSN/MME                             |
|CN Operator      |OC     |OC     |This field indicates whether the Serving |
|Selection Entity |       |       |Network identified by the "Serving Node  |
|                 |       |       |PLMN Identifier” has been selected by the|
|                 |       |       |UE or by the network, as defined in      |
|                 |       |       |TS 29.060 [203] for GPRS, and in TS      |
|                 |       |       |29.274 [210] for EPC, if available.      |
|RAT Type         |OC     |OC     |This field indicates the Radio Access    |
|                 |       |       |Technology (RAT) type currently used by  |
|                 |       |       |the Mobile Station as defined in TS      |
|                 |       |       |29.061 [205], when available.            |
|Charging         |OM     |OM     |Holds information about how Charging     |
|Characteristics  |       |       |Characteristics were selected.           |
|Selection Mode   |       |       |                                         |
|CAMEL Information|OC     |-      |Set of CAMEL information related to SMS  |
|                 |       |       |session. For more information see        |
|                 |       |       |Description of Record Fields. This field |
|                 |       |       |is present if CAMEL service is activated.|
|Originating      |OC     |OC     |The address of the originating SME.      |
|Address          |       |       |                                         |
|Record Extensions|OC     |OC     |A set of network operator/manufacturer   |
|                 |       |       |specific extensions to the record.       |
|                 |       |       |Conditioned upon the existence of an     |
|                 |       |       |extension.                               |




         6.1.7  Mobile Terminated location request (LCS-MT-CDR)

If enabled, an SGSN Mobile terminated LCS record shall be produced for each
mobile terminated location request that is performed via the SGSN. The
fields in the record are specified in table 6.1.7.1.

       Table 6.1.7.1: SGSN Mobile terminated LCS record (SGSN-LCS-MT)

|Field                     |Catego|Description                              |
|                          |ry    |                                         |
|Record Type               |M     |SGSN Mobile Terminated LCS.              |
|Recording Entity          |M     |The E.164 number of the SGSN.            |
|LCS Client Type           |M     |The type of the LCS client that invoked  |
|                          |      |the LR.                                  |
|LCS Client Identity       |M     |Further identification of the LCS client.|
|Served IMSI               |M     |The IMSI of the subscriber.              |
|Served MSISDN             |OC    |The primary MSISDN of the subscriber, if |
|                          |      |available.                               |
|SGSN Address              |OM    |The IP address of the current SGSN.      |
|Location Type             |M     |The type of the estimated location.      |
|LCS QoS                   |C     |QoS of the LR, if available.             |
|LCS Priority              |C     |Priority of the LR, if available.        |
|MLC Number                |M     |The E.164 address of the requesting GMLC.|
|Event Time stamp          |M     |The time at which the                    |
|                          |      |Perform_Location_Request is sent by the  |
|                          |      |SGSN.                                    |
|Measurement Duration      |OM    |The duration of proceeding the location  |
|                          |      |request.                                 |
|Notification To MS User   |C     |The privacy notification to MS user that |
|                          |      |was applicable when the LR was invoked,  |
|                          |      |if available.                            |
|Privacy Override          |C     |This parameter indicates the override MS |
|                          |      |privacy by the LCS client, if available. |
|Location                  |OM    |The LAC and CI when the LR is received.  |
|Routing Area Code         |OM    |The Routing Area Code to which the LCS   |
|                          |      |terminated.                              |
|Location Estimate         |OC    |The location estimate for the subscriber |
|                          |      |if contained in geographic position and  |
|                          |      |the LR was successful.                   |
|Positioning Data          |C     |The positioning method used or attempted,|
|                          |      |if available.                            |
|LCS Cause                 |OC    |The result of the LR if any failure or   |
|                          |      |partial success happened as known at     |
|                          |      |radio interface.                         |
|Cause for Record Closing  |M     |The reason for closure of the record from|
|                          |      |this SGSN.                               |
|Diagnostics               |C     |A more detailed information about the    |
|                          |      |Cause for Record Closing if any failure  |
|                          |      |or partial success happened.             |
|Node ID                   |OM    |Name of the recording entity.            |
|Local Record Sequence     |OM    |Consecutive record number created by this|
|Number                    |      |node. The number is allocated            |
|                          |      |sequentially including all CDR types.    |
|Charging Characteristics  |M     |The Charging Characteristics used by the |
|                          |      |SGSN. (always use the subscribed CC).    |
|Charging Characteristics  |OM    |Holds information about how Charging     |
|Selection Mode            |      |Characteristics were selected.           |
|                          |      |(only subscribed/home default/visited    |
|                          |      |default).                                |
|Serving Node PLMN         |Oc    |This field holds the PLMN Identifier (MCC|
|Identifier                |      |and MNC) serving the UE during this      |
|                          |      |record. Only one value is included in    |
|                          |      |case multiple PLMN Ids are supported by  |
|                          |      |the SGSN.                                |
|CN Operator Selection     |OC    |This field indicates whether the Serving |
|Entity                    |      |Network identified by the "Serving Node  |
|                          |      |PLMN Identifier” has been selected by the|
|                          |      |UE or by the network, as defined in      |
|                          |      |TS 29.060 [203] for GPRS, and in TS      |
|                          |      |29.274 [210] for EPC, if available.      |
|RAT Type                  |OC    |This field indicates the Radio Access    |
|                          |      |Technology (RAT) type currently used by  |
|                          |      |the Mobile Station as defined in TS      |
|                          |      |29.061 [205], when available.            |
|Record Extensions         |OC    |A set of network operator/manufacturer   |
|                          |      |specific extensions to the record.       |
|                          |      |Conditioned upon the existence of an     |
|                          |      |extension.                               |




         6.1.8  Mobile originated Location request (LCS-MO-CDR)

If enabled, an SGSN Mobile originated LCS record shall be produced for each
mobile originated location request that is performed via the SGSN. The
fields in the record are specified in table 6.1.8.1.

       Table 6.1.8.1: SGSN Mobile originated LCS record (SGSN-LCS-MO)

|Field                     |Catego|Description                              |
|                          |ry    |                                         |
|Record Type               |M     |SGSN Mobile Originated LCS.              |
|Recording Entity          |M     |The E.164 number of the SGSN.            |
|LCS Client Type           |C     |The type of the LCS client that invoked  |
|                          |      |the LR, if available.                    |
|LCS Client Identity       |C     |Further identification of the LCS client,|
|                          |      |if available.                            |
|Served IMSI               |M     |The IMSI of the subscriber.              |
|Served MSISDN             |OC    |The primary MSISDN of the subscriber, if |
|                          |      |available.                               |
|SGSN Address              |OM    |The IP address of the current SGSN.      |
|Location Method           |M     |The type of the location request.        |
|LCS QoS                   |C     |QoS of the LR, if available.             |
|LCS Priority              |Oc    |Priority of the LR, if available.        |
|MLC Number                |C     |The E.164 address of the involved GMLC,  |
|                          |      |if applicable.                           |
|Event Time stamp          |M     |The time at which the                    |
|                          |      |Perform_Location_Request is sent by the  |
|                          |      |SGSN.                                    |
|Measurement Duration      |OM    |The duration of proceeding the location  |
|                          |      |request.                                 |
|Location                  |OM    |The LAC and CI when the LR is received.  |
|Routing Area Code         |OM    |The Routing Area Code from which the LCS |
|                          |      |originated.                              |
|Location Estimate         |OC    |The location estimate for the subscriber |
|                          |      |if contained in geographic position and  |
|                          |      |the LR was successful.                   |
|Positioning Data          |C     |The positioning method used or attempted,|
|                          |      |if available.                            |
|LCS Cause                 |OC    |The result of the LR if any failure or   |
|                          |      |partial success happened as known at     |
|                          |      |radio interface.                         |
|Cause for Record Closing  |M     |The reason for closure of the record from|
|                          |      |this SGSN.                               |
|Diagnostics               |C     |A more detailed information about the    |
|                          |      |Cause for Record Closing  if any failure |
|                          |      |or partial success happened.             |
|Node ID                   |OM    |Name of the recording entity.            |
|Local Record Sequence     |OM    |Consecutive record number created by this|
|Number                    |      |node. The number is allocated            |
|                          |      |sequentially including all CDR types.    |
|Charging Characteristics  |M     |The Charging Characteristics flag set    |
|                          |      |used by the SGSN.                        |
|Charging Characteristics  |OM    |Holds information about how Charging     |
|Selection Mode            |      |Characteristics were selected.           |
|Serving Node PLMN         |Oc    |This field holds the PLMN Identifier (MCC|
|Identifier                |      |and MNC) serving the UE during this      |
|                          |      |record. Only one value is included in    |
|                          |      |case multiple PLMN Ids are supported by  |
|                          |      |the SGSN.                                |
|CN Operator Selection     |OC    |This field indicates whether the Serving |
|Entity                    |      |Network identified by the "Serving Node  |
|                          |      |PLMN Identifier” has been selected by the|
|                          |      |UE or by the network, as defined in      |
|                          |      |TS 29.060 [203] for GPRS, and in TS      |
|                          |      |29.274 [210] for EPC, if available.      |
|RAT Type                  |OC    |This field indicates the Radio Access    |
|                          |      |Technology (RAT) type currently used by  |
|                          |      |the Mobile Station as defined in TS      |
|                          |      |29.061 [205], when available.            |
|Record Extensions         |OC    |A set of network operator/manufacturer   |
|                          |      |specific extensions to the record.       |
|                          |      |Conditioned upon the existence of an     |
|                          |      |extension.                               |




         6.1.9  Network induced Location request (LCS-NI-CDR)

If enabled, an SGSN Network induced LCS record shall be produced for each
network induced location request that is performed via the SGSN. The fields
in the record are specified in table 6.1.9.1.

        Table 6.1.9.1: SGSN Network induced LCS record (SGSN-LCS-NI)

|Field                     |Catego|Description                              |
|                          |ry    |                                         |
|Record Type               |M     |SGSN Network Induced LCS.                |
|Recording Entity          |M     |The E.164 number of the SGSN.            |
|LCS Client Type           |C     |The type of the LCS client that invoked  |
|                          |      |the LR, if available.                    |
|LCS Client Identity       |C     |Further identification of the LCS client,|
|                          |      |if available.                            |
|Served IMSI               |C     |The IMSI of the subscriber if supplied.  |
|Served MSISDN             |C     |The primary MSISDN of the subscriber if  |
|                          |      |supplied.                                |
|SGSN Address              |OM    |The IP address of the current SGSN.      |
|Served IMEI               |OC    |The IMEI or IMEISV of the ME, if         |
|                          |      |available.                               |
|LCS QoS                   |C     |QoS of the LR, if available.             |
|LCS Priority              |C     |Priority of the LR, if available.        |
|MLC Number                |C     |The E.164 address of the involved GMLC,  |
|                          |      |if applicable.                           |
|Event Time stamp          |M     |The time at which the                    |
|                          |      |Perform_Location_Request is sent by the  |
|                          |      |SGSN.                                    |
|Measurement Duration      |OM    |The duration of proceeding the location  |
|                          |      |request.                                 |
|Location                  |OM    |The LAC and CI when the LR is received.  |
|Routing Area Code         |OM    |The Routing Area Code from which the LCS |
|                          |      |originated.                              |
|Location Estimate         |OC    |The location estimate for the subscriber |
|                          |      |if contained in geographic position and  |
|                          |      |the LR was successful.                   |
|Positioning Data          |C     |The positioning method used or attempted,|
|                          |      |if available.                            |
|LCS Cause                 |OC    |The result of the LR if any failure or   |
|                          |      |partial success happened as known at     |
|                          |      |radio interface.                         |
|Cause for Record Closing  |M     |The reason for closure of the record from|
|                          |      |this SGSN.                               |
|Diagnostics               |C     |A more detailed information about the    |
|                          |      |Cause for Record Closing  if any failure |
|                          |      |or partial success happened.             |
|Node ID                   |OM    |Name of the recording entity.            |
|Local Record Sequence     |OM    |Consecutive record number created by this|
|Number                    |      |node. The number is allocated            |
|                          |      |sequentially including all CDR types.    |
|Charging Characteristics  |M     |The Charging Characteristics flag set    |
|                          |      |used by the SGSN.                        |
|Charging Characteristics  |OM    |Holds information about how Charging     |
|Selection Mode            |      |Characteristics were selected.           |
|Serving Node PLMN         |Oc    |This field holds the PLMN Identifier (MCC|
|Identifier                |      |and MNC) serving the UE during this      |
|                          |      |record. Only one value is included in    |
|                          |      |case multiple PLMN Ids are supported by  |
|                          |      |the SGSN.                                |
|CN Operator Selection     |OC    |This field indicates whether the Serving |
|Entity                    |      |Network identified by the "Serving Node  |
|                          |      |PLMN Identifier” has been selected by the|
|                          |      |UE or by the network, as defined in      |
|                          |      |TS 29.060 [203] for GPRS, and in TS      |
|                          |      |29.274 [210] for EPC, if available.      |
|RAT Type                  |OC    |This field indicates the Radio Access    |
|                          |      |Technology (RAT) type currently used by  |
|                          |      |the Mobile Station as defined in TS      |
|                          |      |29.061 [205], when available.            |
|Record Extensions         |OC    |A set of network operator/manufacturer   |
|                          |      |specific extensions to the record.       |
|                          |      |Conditioned upon the existence of an     |
|                          |      |extension.                               |




         6.1.10 MBMS bearer context charging data in SGSN (S-MB-CDR)

If the collection of CDR data is enabled then the SGSN data specified in
table 6.1.10.1 shall be available for each MBMS bearer context.

          Table 6.1.10.1: SGSN MBMS bearer context data (S-MB-CDR)

|Field                   |Catego|Description                                 |
|                        |ry    |                                            |
|Record Type             |M     |SGSN MBMS bearer context record.            |
|SGSN Address used       |M     |The control plane IP address of the SGSN    |
|                        |      |used.                                       |
|Charging ID             |M     |Bearer context identifier used to identify  |
|                        |      |this MBMS bearer context in different       |
|                        |      |records created by GSNs                     |
|List of RAs             |OC    |List of routeing areas receiving data used  |
|                        |      |during this record. equivalent to the list  |
|                        |      |of RAs defined in TS 23.246 [207].          |
|Access Point Name       |OM    |The logical name of the connected access    |
|Network Identifier      |      |point to the BM-SC (network identifier part |
|                        |      |of APN).                                    |
|PDP Type                |OM    |This field indicates PDP type (i.e. IPv4 or |
|                        |      |IPv6).                                      |
|Served PDP Address      |OC    |Indicates the IP Multicast address used for |
|                        |      |the MBMS bearer context, i.e. IPv4 or IPv6, |
|                        |      |if available.                               |
|List of Traffic Data    |OM    |A list of changes in charging conditions for|
|Volumes                 |      |this MBMS bearer context, each change is    |
|                        |      |time stamped. Charging conditions are used  |
|                        |      |to categorize traffic volumes, such as per  |
|                        |      |tariff period. It shall include the required|
|                        |      |bearer capabilities (QoS Negotiated)        |
|Record Opening Time     |M     |Time stamp when MBMS bearer context is      |
|                        |      |activated in this SGSN or record opening    |
|                        |      |time on subsequent partial records.         |
|Duration                |M     |Duration of this record in the SGSN.        |
|Cause for Record Closing|M     |The reason for the release of record from   |
|                        |      |this SGSN.                                  |
|Diagnostics             |OM    |A more detailed reason for the release of   |
|                        |      |the connection.                             |
|Record Sequence Number  |C     |Partial record sequence number, only present|
|                        |      |in case of partial records.                 |
|Node ID                 |OM    |Name of the recording entity.               |
|Local Record Sequence   |OM    |Consecutive record number created by this   |
|Number                  |      |node. The number is allocated sequentially  |
|                        |      |including all CDR types.                    |
|Number of receiving UEs |OC    |Indicates the number of UEs receiving the   |
|                        |      |MBMS bearer service                         |
|MBMS Information        |OM    |MBMS related information related to MBMS    |
|                        |      |bearer context being charged, defined in TS |
|                        |      |32.273 [33].                                |
|Record Extensions       |OC    |A set of network operator/manufacturer      |
|                        |      |specific extensions to the record.          |
|                        |      |Conditioned upon the existence of an        |
|                        |      |extension.                                  |




         6.1.11 MBMS bearer context charging data in GGSN (G-MB-CDR)

If the collection of CDR data is enabled then the GGSN data specified in
table 6.1.11.1 shall be available for each MBMS bearer context.

          Table 6.1.11.1: GGSN MBMS bearer context data (G-MB-CDR)

|Field                   |Catego|Description                                 |
|                        |ry    |                                            |
|Record Type             |M     |GGSN MBMS bearer context record.            |
|GGSN Address used       |M     |The control plane IP address of the GGSN    |
|                        |      |used.                                       |
|Charging ID             |M     |Bearer context identifier used to identify  |
|                        |      |this MBMS bearer context in different       |
|                        |      |records created by GSNs                     |
|List of Downstream Nodes|M     |List of SGSN addresses used during this     |
|                        |      |record. equivalent to the list of downstream|
|                        |      |nodes defined in TS 23.246 [207].           |
|Access Point Name       |OM    |The logical name of the connected access    |
|Network Identifier      |      |point to the BM-SC (network identifier part |
|                        |      |of APN).                                    |
|PDP Type                |OM    |This field indicates PDP type (i.e. IPv4 or |
|                        |      |IPv6).                                      |
|Served PDP Address      |OC    |Indicates the IP Multicast address used for |
|                        |      |the MBMS bearer context, i.e. IPv4 or IPv6, |
|                        |      |if available.                               |
|List of Traffic Data    |OM    |A list of changes in charging conditions for|
|Volumes                 |      |this MBMS bearer context, each change is    |
|                        |      |time stamped. Charging conditions are used  |
|                        |      |to categorize traffic volumes, such as per  |
|                        |      |tariff period. It shall include the required|
|                        |      |bearer capabilities (QoS Negotiated).       |
|Record Opening Time     |M     |Time stamp when MBMS bearer context is      |
|                        |      |activated in this GGSN or record opening    |
|                        |      |time on subsequent partial records.         |
|Duration                |M     |Duration of this record in the GGSN.        |
|Cause for Record Closing|M     |The reason for the release of record from   |
|                        |      |this GGSN.                                  |
|Diagnostics             |OM    |A more detailed reason for the release of   |
|                        |      |the connection.                             |
|Record Sequence Number  |C     |Partial record sequence number, only present|
|                        |      |in case of partial records.                 |
|Node ID                 |OM    |Name of the recording entity.               |
|Local Record Sequence   |OM    |Consecutive record number created by this   |
|Number                  |      |node. The number is allocated sequentially  |
|                        |      |including all CDR types.                    |
|MBMS Information        |OM    |MBMS related information related to MBMS    |
|                        |      |bearer context being charged, defined in TS |
|                        |      |32.273 [33].                                |
|Record Extensions       |OC    |A set of network operator/manufacturer      |
|                        |      |specific extensions to the record.          |
|                        |      |Conditioned upon the existence of an        |
|                        |      |extension.                                  |




         6.1.12 MBMS bearer context charging data in MBMS GW (MBMS-GW-CDR)

If the collection of CDR data is enabled then the MBMS GW data specified in
table 6.1.12.1 shall be available for each MBMS bearer context when MBMS GW
doesn't locate in MB-SC.

       Table 6.1.12.1: MBMS GW MBMS bearer context data (MBMS-GW-CDR)

|Field                   |Catego|Description                                 |
|                        |ry    |                                            |
|Record Type             |M     |MBMS GW MBMS bearer context record.         |
|MBMS GW Address used    |M     |The control plane IP address of the MBMS GW |
|                        |      |used.                                       |
|Charging ID             |M     |Bearer context identifier used to identify  |
|                        |      |this MBMS bearer context in different       |
|                        |      |records created by Evolved Packet System    |
|                        |      |core network elements                       |
|List of Downstream Nodes|M     |List of SGSN/MME addresses used during this |
|                        |      |record. equivalent to the list of downstream|
|                        |      |nodes defined in TS 23.246 [207].           |
|Access Point Name       |OM    |The logical name of the connected access    |
|Network Identifier      |      |point to the BM-SC (network identifier part |
|                        |      |of APN).                                    |
|PDP/PDN Type            |OM    |This field indicates PDN type (i.e. IPv4 or |
|                        |      |IPv6).                                      |
|Served PDP/PDN Address  |OC    |Indicates the IP Multicast address used for |
|                        |      |the MBMS bearer context. (i.e. IPv4 or      |
|                        |      |IPv6).                                      |
|List of Traffic Data    |OM    |A list of changes in charging conditions for|
|Volumes                 |      |this MBMS bearer context, each change is    |
|                        |      |time stamped. Charging conditions are used  |
|                        |      |to categorize traffic volumes, such as per  |
|                        |      |tariff period. It shall include the required|
|                        |      |bearer capabilities (QoS Negotiated).       |
|Record Opening Time     |M     |Time stamp when MBMS bearer context is      |
|                        |      |activated in this MBMS GW or record opening |
|                        |      |time on subsequent partial records.         |
|Duration                |M     |Duration of this record in the MBMS GW.     |
|Cause for Record Closing|M     |The reason for the release of record from   |
|                        |      |this MBMS GW.                               |
|Diagnostics             |OM    |A more detailed reason for the release of   |
|                        |      |the connection.                             |
|Record Sequence Number  |C     |Partial record sequence number, only present|
|                        |      |in case of partial records.                 |
|Node ID                 |OM    |Name of the recording entity.               |
|Record Extensions       |OC    |A set of network operator/manufacturer      |
|                        |      |specific extensions to the record.          |
|                        |      |Conditioned upon the existence of an        |
|                        |      |extension.                                  |
|Local Record Sequence   |OM    |Consecutive record number created by this   |
|Number                  |      |node. The number is allocated sequentially  |
|                        |      |including all CDR types.                    |
|MBMS Information        |OM    |MBMS related information related to MBMS    |
|                        |      |bearer context being charged, defined in TS |
|                        |      |32.273 [33].                                |
|C-TEID                  |OC    |Common Tunnel Endpoint Identifier of MBMS GW|
|                        |      |for user plane, defined in TS 23.246 [207]. |
|IP multicast and Source |OC    |IP addresses identifying the SSM channel    |
|address for distribution|      |used for user plane distribution on the     |
|                        |      |backbone network defined in TS 23.246 [207].|




         6.1.13 IP-CAN bearer charging data in ePDG (ePDG-CDR)

If the collection of CDR data is enabled then the ePDG data specified in
table 6.1.13.1 shall be available for each IP-CAN bearer.

             Table 6.1.13.1: ePDG IP-CAN bearer data (ePDG-CDR)

|Field                     |Catego|Description                              |
|                          |ry    |                                         |
|Record Type               |M     |ePDG IP-CAN bearer record.               |
|Retransmission            |OC    |This parameter, when present, indicates  |
|                          |      |that information from retransmitted      |
|                          |      |Charging Data Request has been used in   |
|                          |      |this CDR.                                |
|Served IMSI               |C     |IMSI of the served party, if available.  |
|IMSI Unauthenticated Flag |OC    |This field indicates the provided served |
|                          |      |IMSI is not authenticated (emergency     |
|                          |      |bearer service situation).               |
|Served IMEI               |OC    |The IMEI or IMEISV of the ME, if         |
|                          |      |available.                               |
|ePDG Address Used         |M     |The control plane IP address of the ePDG |
|                          |      |used.                                    |
|ePDG IPv6 Address         |OC    |The control plane IPv6 address, in case  |
|                          |      |of IPv4v6 dual stack, of the ePDG.       |
|Charging ID               |M     |IP-CAN bearer Charging identifier used to|
|                          |      |identify this IP-CAN bearer in different |
|                          |      |records created by PCNs                  |
|PDN Connection Charging Id|OM    |This field holds the explicit Charging Id|
|                          |      |for the PDN connection.                  |
|                          |      |When NBIFOM is supported, the PGW will   |
|                          |      |provide a unique PDN Connection Charging |
|                          |      |ID for the PDN connection.               |
|                          |      |Otherwise the field holds the Charging Id|
|                          |      |of the EPS default bearer in GTP case, or|
|                          |      |the unique Charging Id of the IP-CAN     |
|                          |      |session in PMIP case.                    |
|                          |      |This field is used to identify different |
|                          |      |records belonging to same PDN connection.|
|SGW Change                |OC    |Present if this is first record after a  |
|                          |      |change from another serving node (i.e.   |
|                          |      |SGW, ePDG).                              |
|PGW PLMN Identifier       |Oc    |PLMN identifier (MCC MNC) of the P-GW    |
|                          |      |used.                                    |
|Access Point Name Network |OM    |The logical name of the connected access |
|Identifier                |      |point to the external packet data network|
|                          |      |(network identifier part of APN).        |
|PDP/PDN Type              |OM    |This field indicates PDN type (i.e. IPv4,|
|                          |      |IPv6 or IPv4v6).                         |
|Served PDP/PDN Address    |OC    |IP address allocated for the PDP context |
|                          |      |/ PDN connection, if available, i.e. IPv4|
|                          |      |address when PDN Type is IPv4 or IPv6    |
|                          |      |prefix when PDN Type is IPv6 or IPv4v6.  |
|Served PDP/PDN Address    |OC    |PDP/PDN Address prefix length of an IPv6 |
|prefix length             |      |typed Served PDP Address. The field needs|
|                          |      |not available for prefix length of 64    |
|                          |      |bits.                                    |
|Served PDP/PDN Address    |OC    |This field holds IPv4 address of the     |
|extension                 |      |served IMSI, if available, when PDN type |
|                          |      |is IPv4v6.                               |
|Dynamic Address Flag      |OC    |Indicates whether served PDP/PDN address |
|                          |      |is dynamic, which is allocated during    |
|                          |      |IP-CAN bearer activation, initial attach |
|                          |      |and UE requested PDN connectivity. This  |
|                          |      |field is missing if IPv4 address is      |
|                          |      |static when PDN Type is IPv4, or if IPv6 |
|                          |      |address is static when PDN Type is IPv6  |
|                          |      |or IPv4v6.                               |
|Dynamic Address Flag      |OC    |Indicates whether served IPv4 PDP/PDN    |
|extension                 |      |address is dynamic, which is allocated   |
|                          |      |during IP-CAN bearer activation, initial |
|                          |      |attach and UE requested PDN connectivity |
|                          |      |with PDP/PDN type IPv4v6. This field is  |
|                          |      |missing if IPv4 address is static.       |
|List of Traffic Data      |OM    |A list of changes in charging conditions |
|Volumes                   |      |for this QCI/ARP pair, each change is    |
|                          |      |time stamped. Charging conditions are    |
|                          |      |used to categorize traffic volumes, such |
|                          |      |as per tariff period. Initial and        |
|                          |      |subsequently changed QoS and             |
|                          |      |corresponding data values are also       |
|                          |      |listed.                                  |
|Record Opening Time       |M     |Time stamp when IP-CAN bearer is         |
|                          |      |activated in this ePDG or record opening |
|                          |      |time on subsequent partial records.      |
|Duration                  |M     |Duration of this record in the ePDG.     |
|Cause for Record Closing  |M     |The reason for the release of record from|
|                          |      |this ePDG.                               |
|Diagnostics               |OM    |A more detailed reason for the release of|
|                          |      |the IP-CAN bearer, when a single cause is|
|                          |      |applicable.                              |
|Enhanced Diagnostics      |OC    |This field holds a more detailed reason  |
|                          |      |for the release of the IP-CAN bearer,    |
|                          |      |when a set of causes is applicable.      |
|Record Sequence Number    |C     |Partial record sequence number, only     |
|                          |      |present in case of partial records.      |
|Node ID                   |OM    |Name of the recording entity.            |
|Local Record Sequence     |OM    |Consecutive record number created by this|
|Number                    |      |node. The number is allocated            |
|                          |      |sequentially including all CDR types.    |
|APN Selection Mode        |OM    |An index indicating how the APN was      |
|                          |      |selected.                                |
|Served MSISDN             |OC    |The primary MSISDN of the subscriber, if |
|                          |      |available.                               |
|Charging Characteristics  |M     |The Charging Characteristics applied to  |
|                          |      |the IP-CAN bearer.                       |
|Charging Characteristics  |OM    |Holds information about how Charging     |
|Selection Mode            |      |Characteristics were selected.           |
|IMS Signalling Context    |OC    |Included if the IM-CN Subsystem          |
|                          |      |Signalling Flag is set, see TS 23.060    |
|                          |      |[201] IP-CAN bearer is used for IMS      |
|                          |      |signalling.                              |
|P-GW Address used.        |OC    |This field is the P-GW IP Address for the|
|                          |      |Control Plane                            |
|P-GW IPv6 Address         |OC    |This field is the P-GW IPv6 Address, in  |
|                          |      |case of IPv4v6 dual stack, for the       |
|                          |      |Control Plane.                           |
|RAT Type                  |OC    |This field indicates the Radio Access    |
|                          |      |Technology (RAT) type currently used by  |
|                          |      |the Mobile Station as defined in TS      |
|                          |      |29.061 [205], when available.            |
|Start Time                |OC    |This field holds the time when User      |
|                          |      |IP-CAN session starts, available in the  |
|                          |      |CDR for the first bearer in an IP-CAN    |
|                          |      |session.                                 |
|Stop Time                 |OC    |This field holds the time when User      |
|                          |      |IP-CAN session is terminated, available  |
|                          |      |in the CDR for the last bearer in an     |
|                          |      |IP-CAN session.                          |
|UWAN User Location        |OC    |This field contains the UE location in an|
|Information               |      |Untrusted Wireless Access Network (UWAN) |
|                          |      |which includes the UE local IP address   |
|                          |      |and optionally UDP or TCP source port    |
|                          |      |number (if NAT is detected) as defined in|
|                          |      |TS 29.274 [210]. It may also include WLAN|
|                          |      |location information  the ePDG may have  |
|                          |      |received from the 3GPP AAA server about  |
|                          |      |the UE as WLAN location information"     |
|                          |      |defined in TS 29.274[210].               |
|User Location Info Time   |OC    |This field contains the time at which the|
|                          |      |user location information was acquired,  |
|                          |      |if available.                            |
|Record Extensions         |OC    |A set of network operator/manufacturer   |
|                          |      |specific extensions to the record.       |
|                          |      |Conditioned upon the existence of an     |
|                          |      |extension.                               |




         6.1.14 ABC data in TDF (TDF-CDR)

If ABC is enabled and the collection of CDR data is enabled, then the TDF
data specified in table 6.1.14.1 shall be available for each TDF session.

  NOTE:  An indication that online charging is also active for the session
         may be provided by using PS Furnish Charging Information.

                 Table 6.1.14.1: TDF session data (TDF-CDR)

|Field                     |Catego|Description                                |
|                          |ry    |                                           |
|Record Type               |M     |TDF session record.                        |
|Retransmission            |OC    |This parameter, when present, indicates    |
|                          |      |that information from retransmitted        |
|                          |      |Charging Data Request has been used in this|
|                          |      |CDR.                                       |
|Served IMSI               |C     |IMSI of the served party, if available.    |
|Served IMEI               |OC    |The IMEI or IMEISV of the ME, if available.|
|                          |      |It is used for identifying the user in case|
|                          |      |Served IMSI is not present during emergency|
|                          |      |bearer service.                            |
|Served 3GPP2 MEID         |OC    |MEID of the served party's terminal        |
|                          |      |equipment for 3GPP2 access.                |
|Served MN NAI             |OC    |Mobile Node Identifier in NAI format (based|
|                          |      |on IMSI), if available.                    |
|P-GW Address used         |M     |The control plane IP address of the P-GW   |
|                          |      |used.                                      |
|P-GW Address IPv6         |OC    |The control plane IPv6 address, in case of |
|                          |      |IPv4v6 dual stack, of the P-GW used.       |
|TDF Address used          |M     |The control plane IP address of the TDF    |
|                          |      |used.                                      |
|TDF Address IPv6          |OC    |The control plane IPv6 address, in case of |
|                          |      |IPv4v6 dual stack, of the TDF used.        |
|PDN Connection Charging ID|M     |This field is received from PCRF and holds |
|                          |      |explicit Charging Id for the PDN connection|
|                          |      |assigned by P-GW to identify different     |
|                          |      |records belonging to same PDN connection.  |
|Serving node Address      |M     |List of SGSN/S-GW/TWAG control plane IP    |
|                          |      |addresses, or the ePDG address used during |
|                          |      |this record.                               |
|Serving node IPv6 Address |OC    |List of SGSN/S-GW/TWAG control plane IPv6  |
|                          |      |addresses, in case of IPv4v6 dual stack,   |
|                          |      |used during this record.                   |
|Serving node Type         |M     |List of serving node types in control plane|
|                          |      |(SGSN, SGW, ePDG, AGW, TWAG). The serving  |
|                          |      |node types listed here map to the serving  |
|                          |      |node addresses listed in the field "Serving|
|                          |      |node Address" in sequence.                 |
|PGW PLMN Identifier       |Oc    |PLMN identifier (MCC MNC) of the P-GW.     |
|TDF PLMN Identifier       |Oc    |PLMN identifier (MCC MNC) of the TDF.      |
|Access Point Name Network |OM    |The logical name of the connected access   |
|Identifier                |      |point to the external packet data network  |
|                          |      |(network identifier part of APN).          |
|PDP/PDN Type              |OM    |PDP/PDN type, i.e. IPv4, IPv6, IPv4v6 , or |
|                          |      |PDP type PPP.                              |
|Served PDP/PDN Address    |OC    |IP address allocated for the PDP context / |
|                          |      |PDN connection, i.e. IPv4 address when     |
|                          |      |PDP/PDN Type is IPv4 or IPv6 prefix when   |
|                          |      |PDP/PDN Type is IPv6 or IPv4v6. This       |
|                          |      |parameter shall be present except when both|
|                          |      |the PDP type is PPP and dynamic IP-CAN     |
|                          |      |bearer address assignment is used.         |
|Served PDP/PDN Address    |OC    |PDP/PDN Address prefix length of an IPv6   |
|prefix length             |      |typed Served PDP Address. The field needs  |
|                          |      |not available for prefix length of 64 bits.|
|Served PDP/PDN Address    |OC    |This field holds IPv4 address of the served|
|extension                 |      |IMSI, if available, when PDP/PDN type is   |
|                          |      |IPv4v6.                                    |
|Dynamic Address Flag      |OC    |Indicates whether served PDP/PDN address is|
|                          |      |dynamic, which is allocated during IP-CAN  |
|                          |      |bearer activation, initial attach (E-UTRAN |
|                          |      |or over S2x) and UE requested PDN          |
|                          |      |connectivity. This field is missing if IPv4|
|                          |      |address is static when PDN Type is IPv4, or|
|                          |      |if IPv6 address is static when PDN Type is |
|                          |      |IPv6 or IPv4v6.                            |
|Dynamic Address Flag      |OC    |Indicates whether served IPv4 PDP/PDN      |
|extension                 |      |address is dynamic, which is allocated     |
|                          |      |during IP-CAN bearer activation, initial   |
|                          |      |attach (E-UTRAN or over S2x) and UE        |
|                          |      |requested PDN connectivity with PDP/PDN    |
|                          |      |type IPv4v6. This field is missing if IPv4 |
|                          |      |address is static.                         |
|List of Service Data      |OM    |A list of changes in charging conditions   |
|                          |      |for application traffic within this TDF    |
|                          |      |session categorized per rating group or per|
|                          |      |combination of the rating group and service|
|                          |      |id. Each change is time stamped. Charging  |
|                          |      |conditions are used to categorize traffic  |
|                          |      |volumes, elapsed time and number of events,|
|                          |      |such as per tariff period and subsequently |
|                          |      |changed maximal bandwidth limitation and   |
|                          |      |corresponding data values are also listed. |
|                          |      |Online charging information (PS Furnish    |
|                          |      |Charging Information) may be added per each|
|                          |      |service data container in case it is sent  |
|                          |      |by the OCS.                                |
|                          |      |Failure-Handling: This field shall be      |
|                          |      |present in case TDF initiates an           |
|                          |      |interaction with the PCRF in relation to   |
|                          |      |the OCS's guidance for Failure Handling. It|
|                          |      |shall indicate the Failure Handling        |
|                          |      |scenario and the instant the Failure Action|
|                          |      |is triggered (see annex B). Scenarios:     |
|                          |      |Continue/New Session; Continue/Ongoing     |
|                          |      |Session; Retry&Terminate/Ongoing Session;  |
|                          |      |Terminate/Ongoing Session.                 |
|Record Opening Time       |M     |Time stamp when TDF session is established |
|                          |      |or record opening time on subsequent       |
|                          |      |partial records.                           |
|MS Time Zone              |OC    |This field contains the MS Time Zone the MS|
|                          |      |is currently located as defined in         |
|                          |      |TS 29.060 [203], if available.             |
|Duration                  |M     |Duration of this record in the TDF.        |
|Cause for Record Closing  |M     |The reason for closing the record from this|
|                          |      |TDF.                                       |
|Diagnostics               |OM    |A more detailed reason forclosing the      |
|                          |      |record.                                    |
|Record Sequence Number    |C     |Partial record sequence number, only       |
|                          |      |present in case of partial records.        |
|Node ID                   |OM    |Name of the recording entity.              |
|Record Extensions         |OC    |A set of network operator/manufacturer     |
|                          |      |specific extensions to the record.         |
|                          |      |Conditioned upon the existence of an       |
|                          |      |extension.                                 |
|Local Record Sequence     |OM    |Consecutive record number created by this  |
|Number                    |      |node. The number is allocated sequentially |
|                          |      |including all CDR types.                   |
|APN Selection Mode        |OM    |An index indicating how the APN was        |
|                          |      |selected.                                  |
|Served MSISDN             |OC    |The primary MSISDN of the subscriber, if   |
|                          |      |available.                                 |
|User Location Information |OC    |This field contains the User Location      |
|                          |      |Information of the MS as defined in        |
|                          |      |TS 29.060 [203] for GPRS case, and in TS   |
|                          |      |29.274 [210] for EPC case, if available.   |
|User CSG information      |OC    |This field contains the User CSG           |
|                          |      |Information of the UE, if available,       |
|                          |      |including CSG ID, access mode and CSG      |
|                          |      |membership indication.                     |
|3GPP2 User Location       |OC    |This field contains the User Location      |
|information               |      |Information of the MS as defined in        |
|                          |      |TS 29.212 [216] for 3GPP2 access, if       |
|                          |      |available.                                 |
|TWAN User Location        |OC    |This field contains the UE location in a   |
|Information               |      |Trusted WLAN Access Network (TWAN) , if    |
|                          |      |available:                                 |
|                          |      |- as "TWAN identifier" defined in TS 29.274|
|                          |      |[210] for S2a GTP-based case, or,          |
|                          |      |- as "Access Network Identifier Option IE" |
|                          |      |defined in 29.275 [211] for S2a PMIP-based |
|                          |      |case.                                      |
|Charging Characteristics  |M     |The Charging Characteristics applied to the|
|                          |      |TDF session.                               |
|Charging Characteristics  |OM    |Holds information about how Charging       |
|Selection Mode            |      |Characteristics were selected.             |
|Serving node PLMN         |OM    |This fields holds the PLMN Identifier (MCC |
|Identifier                |      |and MNC) serving the UE during this record.|
|                          |      |                                           |
|                          |      |When the Serving node is TWAG, this field  |
|                          |      |includes the PLMN identifier used for UE   |
|                          |      |authentication, i.e. the VPLMN in roaming  |
|                          |      |case, and the HPLMN in non-roaming case.   |
|PS Furnish Charging       |OC    |Online charging session specific           |
|Information               |      |information                                |
|RAT Type                  |OC    |This field indicates the Radio Access      |
|                          |      |Technology (RAT) type currently used by the|
|                          |      |Mobile Station as defined in TS 29.061     |
|                          |      |[205], when available.                     |
|Start Time                |OC    |This field holds the time when TDF session |
|                          |      |starts.                                    |
|Stop Time                 |OC    |This field holds the time when TDF session |
|                          |      |is terminated.                             |



6.1.15 IP-CAN bearer charging data in TWAG (TWAG-CDR)

If the collection of CDR data is enabled then theTWAG data specified in
table 6.1.15.1 shall be available for each IP-CAN bearer.

             Table 6.1.15.1: TWAG IP-CAN bearer data (TWAG-CDR)

|Field                     |Catego|Description                              |
|                          |ry    |                                         |
|Record Type               |M     |TWAG IP-CAN bearer record.               |
|Retransmission            |OC    |This parameter, when present, indicates  |
|                          |      |that information from retransmitted      |
|                          |      |Charging Data Request has been used in   |
|                          |      |this CDR.                                |
|Served IMSI               |C     |IMSI of the served party, if available.  |
|IMSI Unauthenticated Flag |OC    |This field indicates the provided served |
|                          |      |IMSI is not authenticated (emergency     |
|                          |      |bearer service situation).               |
|Served IMEI               |OC    |The IMEI or IMEISV of the ME, if         |
|                          |      |available.                               |
|TWAG Address Used         |M     |The control plane IP address of the TWAG |
|                          |      |used.                                    |
|TWAG IPv6 Address         |OC    |The control plane IPv6 address, in case  |
|                          |      |of IPv4v6 dual stack, of the TWAG.       |
|Charging ID               |M     |IP-CAN bearer Charging identifier used to|
|                          |      |identify this IP-CAN bearer in different |
|                          |      |records created by PCNs                  |
|PDN Connection Charging Id|OM    |This field holds the explicit Charging Id|
|                          |      |for the PDN connection.                  |
|                          |      |When NBIFOM is supported, the PGW will   |
|                          |      |provide a unique PDN Connection Charging |
|                          |      |ID for the PDN connection.               |
|                          |      |Otherwise the field holds the Charging Id|
|                          |      |of the EPS default bearer in GTP case, or|
|                          |      |the unique Charging Id of the IP-CAN     |
|                          |      |session in PMIP case.                    |
|                          |      |This field is used to identify different |
|                          |      |records belonging to same PDN connection.|
|SGW Change                |OC    |Present if this is first record after a  |
|                          |      |change from another serving node (i.e.   |
|                          |      |SGW, ePDG, TWAG).                        |
|PGW PLMN Identifier       |Oc    |PLMN identifier (MCC MNC) of the P-GW    |
|                          |      |used.                                    |
|Access Point Name Network |OM    |The logical name of the connected access |
|Identifier                |      |point to the external packet data network|
|                          |      |(network identifier part of APN).        |
|PDP/PDN Type              |OM    |This field indicates PDN type (i.e. IPv4,|
|                          |      |IPv6 or IPv4v6).                         |
|Served PDP/PDN Address    |OC    |IP address allocated for the PDP context |
|                          |      |/ PDN connection, if available, i.e. IPv4|
|                          |      |address when PDN Type is IPv4 or IPv6    |
|                          |      |prefix when PDN Type is IPv6 or IPv4v6.  |
|Served PDP/PDN Address    |OC    |PDP/PDN Address prefix length of an IPv6 |
|prefix length             |      |typed Served PDP Address. The field needs|
|                          |      |not available for prefix length of 64    |
|                          |      |bits.                                    |
|Served PDP/PDN Address    |OC    |This field holds IPv4 address of the     |
|extension                 |      |served IMSI, if available, when PDN type |
|                          |      |is IPv4v6.                               |
|Dynamic Address Flag      |OC    |Indicates whether served PDP/PDN address |
|                          |      |is dynamic, which is allocated during    |
|                          |      |IP-CAN bearer activation, initial attach |
|                          |      |and UE requested PDN connectivity. This  |
|                          |      |field is missing if IPv4 address is      |
|                          |      |static when PDN Type is IPv4, or if IPv6 |
|                          |      |address is static when PDN Type is IPv6  |
|                          |      |or IPv4v6.                               |
|Dynamic Address Flag      |OC    |Indicates whether served IPv4 PDP/PDN    |
|extension                 |      |address is dynamic, which is allocated   |
|                          |      |during IP-CAN bearer activation, initial |
|                          |      |attach and UE requested PDN connectivity |
|                          |      |with PDP/PDN type IPv4v6. This field is  |
|                          |      |missing if IPv4 address is static.       |
|List of Traffic Data      |OM    |A list of changes in charging conditions |
|Volumes                   |      |for this QCI/ARP pair, each change is    |
|                          |      |time stamped. Charging conditions are    |
|                          |      |used to categorize traffic volumes, such |
|                          |      |as per tariff period. Initial and        |
|                          |      |subsequently changed QoS and             |
|                          |      |corresponding data values are also       |
|                          |      |listed.                                  |
|Record Opening Time       |M     |Time stamp when IP-CAN bearer is         |
|                          |      |activated in this TWAG or record opening |
|                          |      |time on subsequent partial records.      |
|Duration                  |M     |Duration of this record in the TWAG.     |
|Cause for Record Closing  |M     |The reason for the release of record from|
|                          |      |this TWAG.                               |
|Diagnostics               |OM    |A more detailed reason for the release of|
|                          |      |the IP-CAN bearer, when a single cause is|
|                          |      |applicable.                              |
|Enhanced Diagnostics      |OC    |This field holds a more detailed reason  |
|                          |      |for the release of the IP-CAN bearer,    |
|                          |      |when a set of causes is applicable.      |
|Record Sequence Number    |C     |Partial record sequence number, only     |
|                          |      |present in case of partial records.      |
|Node ID                   |OM    |Name of the recording entity.            |
|Local Record Sequence     |OM    |Consecutive record number created by this|
|Number                    |      |node. The number is allocated            |
|                          |      |sequentially including all CDR types.    |
|APN Selection Mode        |OM    |An index indicating how the APN was      |
|                          |      |selected.                                |
|Served MSISDN             |OC    |The primary MSISDN of the subscriber, if |
|                          |      |available.                               |
|TWAN User Location        |OC    |This field contains the UE location in a |
|Information               |      |Trusted WLAN Access Network (TWAN) , if  |
|                          |      |available:                               |
|                          |      |- as "TWAN identifier" defined in TS     |
|                          |      |29.274 [210] for S2a GTP-based case, or, |
|                          |      |- as "Access Network Identifier Option   |
|                          |      |IE" defined in 29.275 [211] for S2a      |
|                          |      |PMIP-based case.                         |
|Charging Characteristics  |M     |The Charging Characteristics applied to  |
|                          |      |the IP-CAN bearer.                       |
|Charging Characteristics  |OM    |Holds information about how Charging     |
|Selection Mode            |      |Characteristics were selected.           |
|P-GW Address used.        |OC    |This field is the P-GW IP Address for the|
|                          |      |Control Plane                            |
|P-GW IPv6 Address         |OC    |This field is the P-GW IPv6 Address, in  |
|                          |      |case of IPv4v6 dual stack, for the       |
|                          |      |Control Plane.                           |
|RAT Type                  |OC    |This field indicates the Radio Access    |
|                          |      |Technology (RAT) type currently used by  |
|                          |      |the Mobile Station as defined in TS      |
|                          |      |29.061 [205], when available.            |
|Start Time                |OC    |This field holds the time when User      |
|                          |      |IP-CAN session starts, available in the  |
|                          |      |CDR for the first bearer in an IP-CAN    |
|                          |      |session.                                 |
|Stop Time                 |OC    |This field holds the time when User      |
|                          |      |IP-CAN session is terminated, available  |
|                          |      |in the CDR for the last bearer in an     |
|                          |      |IP-CAN session.                          |
|Record Extensions         |OC    |A set of network operator/manufacturer   |
|                          |      |specific extensions to the record.       |
|                          |      |Conditioned upon the existence of an     |
|                          |      |extension.                               |




         6.2  Data description for PS online charging


6.2.1  Message contents


6.2.1.1  Summary of online charging message formats

The PS Online Charging uses the Debit / Reserve Units Request and Debit /
Reserve Units Response messages defined in TS 32.299 [50].

Table 6.2.1.1.1 describes the use of these messages for online charging.

          Table 6.2.1.1.1: Online charging messages reference table

|Messages        |Source    |Destina|
|                |          |tion   |
|Debit / Reserve |PCEF, TDF |OCS    |
|Units Request   |          |       |
|Debit / Reserve |OCS       |PCEF,  |
|Units Response  |          |TDF    |



6.2.1.2  Structure for the Debit / Reserve Units operation message formats


6.2.1.2.0   General

This clause describes the AVPs used in the Debit / Reserve Units operation
messages.


6.2.1.2.1   Debit / Reserve Units Request message

Table 6.2.1.2.1.1 illustrates the basic structure of a Debit / Reserve
Units Request message from the PCEF and TDF as used for PS online charging.

      Table 6.2.1.2.1.1: Debit / Reserve Units Request message contents

|Information Element |Catego|Description                                 |
|                    |ry    |                                            |
|Session Identifier  |M     |Described in TS 32.299 [50]                 |
|Originator Host     |M     |Described in TS 32.299 [50]                 |
|Originator Domain   |M     |Described in TS 32.299 [50]                 |
|Destination Domain  |M     |Described in TS 32.299 [50]                 |
|Operation Identifier|M     |Described in TS 32.299 [50]                 |
|Operation Token     |M     |Described in TS 32.299 [50]                 |
|Operation Type      |M     |Described in TS 32.299 [50]                 |
|Operation Number    |M     |Described in TS 32.299 [50]                 |
|Destination Host    |OM    |Described in TS 32.299 [50]                 |
|User Name           |OM    |The content of the field corresponds to the |
|                    |      |Protocol Configuration Options (PCO) field  |
|                    |      |of the Create IP-CAN bearer Request message.|
|Origination State   |OC    |Described in TS 32.299 [50]                 |
|Origination         |OC    |Described in TS 32.299 [50]                 |
|Timestamp           |      |                                            |
|Subscriber          |OM    |Described in TS 32.299 [50].                |
|Identifier          |      |As a minimum the IMSI and the MSISDN have to|
|                    |      |be included.                                |
|Termination Cause   |OC    |Described in TS 32.299 [50]                 |
|Multiple Operation  |OM    |Described in TS 32.299 [50]                 |
|Multiple Unit       |OC    |Described in TS 32.299 [50]                 |
|Operation           |      |                                            |
|User-Equipment-Info |OC    |Described in TS 32.299 [50].                |
|                    |      |Contains the identification of the terminal |
|                    |      |(IMEI or IMEISV etc.)                       |
|Route Information   |OC    |Described in TS 32.299 [50]                 |
|Service Information |OM    |Described in clause 6.3.1.1                 |


  Editor's Note: Terminal capabilities should be taken into account

The full description of the AVPs is specified in TS 32.299 [50].


6.2.1.2.2   Debit / Reserve Units Response message

The following table 6.2.1.2.2.1 llustrates the basic structure of a Debit /
Reserve Units operation message as used for the PCEF and TDF. This message
is always used by the OCS as specified below, independent of the receiving
PCEF/TDF and the C redit-Control type that is being replied to.

     Table 6.2.1.2.2.1: Debit / Reserve Units Response message contents

|Information Element      |Category |Description        |
|Session Identifier       |M        |Described in 32.299|
|                         |         |[50]               |
|Operation Result         |M        |Described in 32.299|
|                         |         |[50]               |
|Originator Host          |M        |Described in 32.299|
|                         |         |[50]               |
|Originator Domain        |M        |Described in 32.299|
|                         |         |[50]               |
|Operation Identifier     |M        |Described in 32.299|
|                         |         |[50]               |
|Operation Type           |M        |Described in 32.299|
|                         |         |[50]               |
|Operation Number         |M        |Described in 32.299|
|                         |         |[50]               |
|Operation Failover       |OC       |Described in 32.299|
|                         |         |[50]               |
|Multiple Unit Operation  |OC       |Described in 32.299|
|                         |         |[50]               |
|Operation Failure Action |OC       |Described in 32.299|
|                         |         |[50]               |
|Operation Event Failure  |OC       |Described in 32.299|
|Action                   |         |[50]               |
|Redirection Host         |OC       |Described in 32.299|
|                         |         |[50]               |
|Redirection Host Usage   |OC       |Described in 32.299|
|                         |         |[50]               |
|Route Information        |OC       |Described in 32.299|
|                         |         |[50]               |
|Failed parameter         |OC       |Described in 32.299|
|                         |         |[50]               |
|Service Information      |OM       |Described in 32.299|
|                         |         |[50]               |



6.2.2  Void



         6.3  PS charging specific parameters


6.3.1  Definition of PS charging information


6.3.1.0  General

The PS Information parameter used for PS charging is provided in the
Service Information parameter, as defined in clause 6.3.1.1.

The PS Information parameter used for "SMS over MME Charging" is provided
in the Service Information parameter as defined in 6.3.1.1a


6.3.1.1  PS charging information assignment for Service Information

The components in the Service Information that are use for PS charging can
be found in table 6.3.1.1.1.

          Table 6.3.1.1.1: Service Information used for PS Charging

|Information Element |Catego|Description                                 |
|                    |ry    |                                            |
|Service Information |OM    |This is a structured field and holds the    |
|                    |      |3GPP specific parameter as defined in       |
|                    |      |TS 32.299 [50].                             |
|      Subscriber    |OC    |This field contains the identification of   |
|Identifier          |      |the user (e.g. IMSI, MSISDN, NAI) if offline|
|                    |      |charging applies.                           |
| PS Information     |OM    |This is a structured field and holds the PS |
|                    |      |specific parameters.                        |
|                    |      |The details are defined in clause 6.3.1.2.  |
| IMS Information    |OM    |This is a structured field and holds IMS    |
|                    |      |specific parameters.                        |
|                    |      |The complete structure is defined in TS     |
|                    |      |32.260 [20].                                |
|  Node Functionality|OM    |This field contains the function of the EPC |
|                    |      |node (SGW, ePDG, TWAG, PGW, TDF)            |
|                                                                       |
|NOTE:  When Node Functionality is set to "HSGW" the HSGW Access        |
|specific charging information are  provided as part of the PS          |
|Information                                                            |



6.3.1.1a "SMS over MME Charging" information assignment for Service
           Information

The components in the Service Information that are used for "SMS over MME
Charging"can be found in table 6.3.1.1a.1.

   Table 6.3.1.1a.1: Service Information used for "SMS over MME Charging"

|Information Element      |Catego|Description                           |
|                         |ry    |                                      |
|Service Information      |OM    |This is a structured field and holds  |
|                         |      |the 3GPP specific parameter as defined|
|                         |      |in TS 32.299 [50].                    |
|Subscriber Identifier    |OC    |This field contains the identification|
|                         |      |of the user (e.g. IMSI, MSISDN).      |
| IMS Information         |OM    |This is a structured field and holds  |
|                         |      |IMS specific parameters.              |
|                         |      |The complete structure is defined in  |
|                         |      |TS 32.260 [20].                       |
|  Node Functionality     |OM    |This field contains the function of   |
|                         |      |the EPC node (i.e. MME)               |
| PS Information          |OM    |This is a structured field and holds  |
|                         |      |the PS specific parameters.           |
|                         |      |The complete structure is defined in  |
|                         |      |clause 6.3.1.2.                       |
|Node Id                  |OC    |This fields holds the name of the Node|
|Serving Node Type        |OC    |This field holds the type of the node |
|                         |      |handling the SMS with the UE (i.e.    |
|                         |      |MME)                                  |
|Serving Node Adddress    |OC    |This field holds the IP-address of the|
|                         |      |MME used. It may occur twice in the   |
|                         |      |case when the MME has IPv4v6 dual     |
|                         |      |stack control plane.                  |
|MME Number for MT SMS    |OC    |This field holds the MME international|
|                         |      |PSTN/ISDN number                      |
|MME Name                 |OC    |This field holds the operation        |
|                         |      |Identity of the MME used.             |
|MME Realm                |OC    |This field holds the operation Realm  |
|                         |      |Identity of the MME used.             |
|Charging Characteristics |OM    |This field contains the Charging      |
|                         |      |Characteristics applicable to the MME |
|Charging Characteristics |OM    |This field holds information about how|
|Selection Mode           |      |the Charging Characteristics were     |
|                         |      |selected.                             |
|3GPP User Location Info  |OC    |This field holds the information about|
|                         |      |the location of the subscriber during |
|                         |      |the SMS transaction.                  |
|User Location Info Time  |OC    |This field contains the time at which |
|                         |      |the user location information was     |
|                         |      |acquired.                             |
|RAT Type                 |OC    |This field indicates which Radio      |
|                         |      |Access Technology (RAT) is currently  |
|                         |      |serving the UE as defined in TS 29.061|
|                         |      |[205].                                |
|Terminal Information     |OC    |This field holds the identification of|
|                         |      |the terminal (IMEI or IMEISV).        |
| SMS Information         |OM    |This is a structured field and holds  |
|                         |      |SMS specific parameters.              |
|                         |      |The complete structure is defined in  |
|                         |      |TS 32.274 [34].                       |
|Recipient Info           |OM    |This field a structured field and     |
|                         |      |holds recipient information for the   |
|                         |      |SM. The complete structure is defined |
|                         |      |in TS 32.274 [34].                    |
|Recipient Address        |OM    |This field holds the address of the   |
|                         |      |recipient of the SM.                  |
|                         |      |This will typically be an E.164 number|
|                         |      |or a shortcode.                       |
|  SMSC Address           |OM    |This field holds the address of the   |
|                         |      |SMSC to which the originating or      |
|                         |      |terminating SM is directed to.        |
|MMS Information          |OM    |This is a structure field and the     |
|                         |      |following parameters are specific to  |
|                         |      |SMS. The complete structure is defined|
|                         |      |in TS 32.270 [30]                     |
|Originator Address       |OC    |This field holds the address of the   |
|                         |      |originator of the SM.                 |
|                         |      |This will typically be an E.164 number|
|                         |      |or a shortcode                        |
|Submission Time          |OC    |This field holds the time the Short   |
|                         |      |Message is received by the MME from UE|
|                         |      |or sent by the MME to UE.             |
|Message Id               |OM    |This field holds a reference provided |
|                         |      |by the UE uniquely identifying this   |
|                         |      |message. It contains the              |
|                         |      |TP-Message-Reference (TP-MR) as       |
|                         |      |defined in TS 23.040 [7].             |



6.3.1.2  Definition of the PS information

PS specific charging information is provided within the PS Information. The
fields of the PS Information are indicated with the node (MME, S-GW, ePDG,
TWAG, P-GW, TDF) from which the information is sent.

The detailed structure of the PS Information can be found in table
6.3.1.2.1.

              Table 6.3.1.2.1: Structure of the PS Information

|Information Element       |Catego|Description                               |
|                          |ry    |                                          |
|Supported Features        |OC    |This field holds the list of features     |
|                          |      |supported by the PCN, CDF or OCF as       |
|                          |      |defined in clause 6.3.1.x.                |
|Charging Id               |OC    |This field holds the Charging Id for this |
|                          |      |IP-CAN bearer (this together with the P-GW|
|                          |      |Address constitutes a unique identifier   |
|                          |      |for the IP-CAN bearer). This field holds  |
|                          |      |the unique Charging Id in the PMIP case.  |
|                          |      |When charging per IP-CAN session is       |
|                          |      |active, PGW use this field to hold the    |
|                          |      |Charging Id of the EPS default bearer. It |
|                          |      |is the same as the PDN Connection Charging|
|                          |      |Id.                                       |
|Charging per IP-CAN       |Oc    |This field indicates whether charging per |
|Session Indicator         |      |IP-CAN session is active. If this field is|
|                          |      |not present, charging per IP-CAN session  |
|                          |      |is not active.                            |
|Node Id                   |OC    |This fields holds the name of the Node    |
|PDN Connection Charging Id|OC    |This field holds the explicit Charging Id |
|                          |      |for the PDN connection.                   |
|                          |      |When NBIFOM is supported, the PGW will    |
|                          |      |assign an explicit PDN Connection Charging|
|                          |      |ID for the PDN connection.                |
|                          |      |Otherwise the field holds the Charging Id |
|                          |      |of the EPS default bearer.                |
|                          |      |This field is used to identify different  |
|                          |      |records belonging to same PDN connection. |
|PDP/PDN Type              |OC    |This field holds the type of IP-CAN       |
|                          |      |bearer, e.g. IP or PPP, or PDN type (i.e. |
|                          |      |IPv4, IPv6 or IPv4v6, or Non-IP).         |
|SGi PtP Tunnelling Method |OC    |This field indicates whether SGi PtP      |
|                          |      |tunnelling method based on UDP/IP or other|
|                          |      |methods are used for this PDN connection  |
|                          |      |when a non-IP PDN type.                   |
|SCS/AS Address            |OC    |This field holds the Address of SCS/AS for|
|                          |      |SGi PtP tunnelling.                       |
|PDP/PDN Address           |OC    |This field holds the IP address of the    |
|                          |      |served IMSI allocated for the PDP context |
|                          |      |/ PDN connection, i.e. IPv4 address or    |
|                          |      |IPv6 prefix, or assigned IP address if any|
|                          |      |when PDP/PDN Type is Non-IP. This         |
|                          |      |parameter shall be present except:        |
|                          |      |-  when both the PDP type is PPP and      |
|                          |      |dynamic PDP address assignment is used or,|
|                          |      |                                          |
|                          |      |-  when PDP/PDN Type is Non-IP, and no IP |
|                          |      |address has been assigned by the PGW for  |
|                          |      |the PDN connection.                       |
|                          |      |It may occur twice within the PS          |
|                          |      |Information field when PDN type is IPv4v6:|
|                          |      |first occurrence with IPv6 prefix, second |
|                          |      |occurrence with IPv4 address.             |
|PDP/PDN Address prefix    |OC    |PDP/PDN Address prefix length of an IPv6  |
|length                    |      |typed Served PDP Address. The field needs |
|                          |      |not available for prefix length of 64     |
|                          |      |bits.                                     |
|Dynamic Address Flag      |OC    |This field indicates whether served       |
|                          |      |PDP/PDN address is dynamically allocated. |
|                          |      |This field is missing if address is       |
|                          |      |static.                                   |
|Dynamic Address Flag      |OC    |Indicates whether served IPv4 PDP/PDN     |
|Extension                 |      |address is dynamic, which is allocated    |
|                          |      |during IP-CAN bearer activation, initial  |
|                          |      |attach (E-UTRAN or over S2x) and UE       |
|                          |      |requested PDN connectivity with PDP/PDN   |
|                          |      |type IPv4v6. This field is missing if IPv4|
|                          |      |address is static.                        |
|Negotiated QoS Profile    |OC    |This field holds the authorized QoS       |
|                          |      |applied to IP-CAN bearer. See NOTE.       |
|                          |      |This field indicates the bandwith         |
|                          |      |limitation, applied to TDF session in TDF |
|                          |      |case. When charging per IP-CAN session is |
|                          |      |active in P-GW, this field indicates the  |
|                          |      |APN-AMBR applied to the IP-CAN session.   |
|Serving Node Address      |OC    |This field holds the SGSN/S-GW/TWAG IP    |
|                          |      |address that is used by the control plane |
|                          |      |for the handling of control messages, or  |
|                          |      |the AGW IP address, or the ePDG address,  |
|                          |      |or the MME address. It may be used to     |
|                          |      |identify the PLMN to which the user is    |
|                          |      |attached. It may occur twice in the case  |
|                          |      |when the serving node has IPv4v6 dual     |
|                          |      |stack control plane.                      |
|Serving Node Type         |OC    |This field holds the type of the serving  |
|                          |      |node (SGSN/S-GW/ePDG/AGW/TWAG from        |
|                          |      |PGW/TDF, or SGSN/MME from SGW).           |
|SGW Change                |OC    |This field is present if this is first    |
|                          |      |Charging Data Request after a change from |
|                          |      |another serving node (from SGW/ePDG/      |
|                          |      |TWAG/HSGW).                               |
|PGW Address               |OC    |This field holds the IP-address of the    |
|                          |      |P-GW that generated the Charging Id. It   |
|                          |      |may occur twice in the case when the P-GW |
|                          |      |has IPv4v6 dual stack control plane.      |
|TDF Address               |OC    |The control plane IP address of the TDF   |
|                          |      |used. It may occur twice in the case when |
|                          |      |the TDF has IPv4v6 dual stack control     |
|                          |      |plane.                                    |
|SGW Address               |OC    |This field holds the IP-address of the    |
|                          |      |S-GW used. It may occur twice in the case |
|                          |      |when the P-GW has IPv4v6 dual stack       |
|                          |      |control plane.                            |
|ePDG Address              |OC    |This field holds the IP-address of the    |
|                          |      |ePDG used. It may occur twice in the case |
|                          |      |when the ePDG has IPv4v6 dual stack       |
|                          |      |control plane.                            |
|TWAG Address              |OC    |This field holds the IP-address of the    |
|                          |      |TWAG used. It may occur twice in the case |
|                          |      |when the TWAG has IPv4v6 dual stack       |
|                          |      |control plane.                            |
|MME Number for MT SMS     |OC    |This field holds the MME international    |
|                          |      |PSTN/ISDN E.164 number used for "SMS over |
|                          |      |MME Charging".                            |
|MME Name                  |OC    |This field holds the operation Identity of|
|                          |      |the MME used for "SMS over MME Charging". |
|MME Realm                 |OC    |This field holds the operation Realm      |
|                          |      |Identity of the MME used for "SMS over MME|
|                          |      |Charging".                                |
|CG Address                |OC    |This field holds the Charging Gateway IP  |
|                          |      |address if available. Only used in EPC    |
|                          |      |Online Charging.                          |
|IMSI MCC MNC              |OC    |This field holds the MCC and MNC extracted|
|                          |      |from the user's IMSI (first 5 or 6 digits,|
|                          |      |as applicable from the presented IMSI).   |
|IMSI Unauthenticated Flag |OC    |This field is present when IMSI is        |
|                          |      |provided in Subscription Id and this IMSI |
|                          |      |is unauthenticated (due to emergency      |
|                          |      |bearer service situations).               |
|PGW MCC MNC               |OC    |This field holds the MCC-MNC of the       |
|                          |      |network the P-GW belongs to.              |
|TDF MCC MNC               |OC    |PLMN identifier (MCC MNC) of the TDF.     |
|NSAPI                     |OC    |This field Identifies a particular IP-CAN |
|                          |      |bearer for the associated PDN and         |
|                          |      |MSISDN/IMSI from creation to deletion. See|
|                          |      |NOTE.                                     |
|Called Station Id         |OC    |This field contains the identifier of the |
|                          |      |access point (APN) the user is connected  |
|                          |      |to.                                       |
|Session Stop Indicator    |OC    |This field indicates to the OCS that the  |
|                          |      |last IP-CAN bearer of a session is        |
|                          |      |released and that the IP-CAN session has  |
|                          |      |been terminated.                          |
|                          |      |This field only indicates to the OCS that |
|                          |      |the TDF session is terminated in TDF case.|
|Selection Mode            |OC    |This field contains the Selection mode for|
|                          |      |this APN received in the Create PDP       |
|                          |      |context request, on E-UTRAN initial attach|
|                          |      |and UE requested PDN connectivity, or     |
|                          |      |Attach in WLAN on GTP S2a.                |
|Charging Characteristics  |OC    |This field contains the Charging          |
|                          |      |Characteristics for this IP-CAN bearer    |
|                          |      |received in the Create IP-CAN bearer      |
|                          |      |Request Message (only available in R99 and|
|                          |      |later releases).                          |
|Charging Characteristics  |OC    |This field holds information about how the|
|Selection Mode            |      |"Charging Characteristics" was selected.  |
|Serving Node MCC MNC      |OC    |This field holds the MCC and MNC serving  |
|                          |      |the UE:  extracted from the RAI within the|
|                          |      |IP-CAN bearer activation or Update        |
|                          |      |messages received over Gn/Gp, or provided |
|                          |      |by the SGW in the "Serving Network" IE    |
|                          |      |over S5/S8 or by AGW/TWAG (For TWAN, PLMN |
|                          |      |identifier used for UE authentication,    |
|                          |      |i.e. the VPLMN in roaming case, and the   |
|                          |      |HPLMN in non-roaming case).               |
|CN Operator Selection     |OC    |This field indicates whether the Serving  |
|Entity                    |      |Network identified by the "Serving Node   |
|                          |      |MCC MNC" has been selected by the UE or by|
|                          |      |the network, as defined in TS 29.060 [203]|
|                          |      |for GPRS, and in TS 29.274 [210] for EPC, |
|                          |      |if available.                             |
|MS Time Zone              |OC    |This field indicates the offset between   |
|                          |      |universal time and local time in steps of |
|                          |      |15 minutes of where the MS currently      |
|                          |      |resides.                                  |
|Charging Rule Base Name   |OC    |This field indicates the name of a        |
|                          |      |pre-defined group of PCC rules residing at|
|                          |      |the PCEF. It may occur several times      |
|                          |      |within the PS Information field.          |
|ADC Rule Base Name        |OC    |This field indicates the name of a        |
|                          |      |pre-defined group of ADC rules in TDF     |
|                          |      |case.                                     |
|User Location Info        |OC    |This field indicates details of where the |
|                          |      |UE is currently located (e.g. SAI, TAI,   |
|                          |      |RAI, CGI, ECGI or access-specific user    |
|                          |      |location information).                    |
|User Location Info Time   |OC    |This field contains the time at which the |
|                          |      |user location information was acquired, if|
|                          |      |available.                                |
|User CSG Information      |OC    |This field indicates details of the User  |
|                          |      |CSG Information of the UE, if available,  |
|                          |      |including CSG ID, access mode and CSG     |
|                          |      |membership indication.                    |
|3GPP2 User Location Info  |OC    |This field holds the 3GPP2 User Location  |
|                          |      |Info of where the UE is currently located |
|                          |      |(i.e. 3GPP2 BSID: Cell-Id, SID, NID), as  |
|                          |      |defined in TS 29.212 [216]                |
|TWAN User Location        |OC    |This field contains the UE location in a  |
|Information               |      |Trusted WLAN Access Network (TWAN) , if   |
|                          |      |available:                                |
|                          |      |- as "TWAN identifier" defined in TS      |
|                          |      |29.274 [210] for S2a GTP-based case, or,  |
|                          |      |- as "Access Network Identifier Option IE"|
|                          |      |defined in 29.275 [211] for S2a PMIP-based|
|                          |      |case.                                     |
|UWAN User Location        |OC    |This field contains the UE location in an |
|Information               |      |Untrusted Wireless Access Network (UWAN)  |
|                          |      |which includes the UE local IP address and|
|                          |      |optionally UDP or TCP source port number  |
|                          |      |(if NAT is detected) as defined in TS     |
|                          |      |29.274 [210]. It may also include WLAN    |
|                          |      |location information the ePDG may have    |
|                          |      |received from the 3GPP AAA server about   |
|                          |      |the UE as "WLAN location information"     |
|                          |      |defined in TS 29.274 [210].               |
|Presence Reporting Area   |OC    |This field contains part of the Presence  |
|Information               |      |Reporting Area Information of UE as       |
|                          |      |defined in TS 29.212 [216], comprising the|
|                          |      |Presence Reporting Area identifier(s) the |
|                          |      |Presence Reporting Area(s) status (UE     |
|                          |      |presence or not, inactive), and which Node|
|                          |      |subscribed-to, or the Presence Reporting  |
|                          |      |Area is set to inactive, if available.    |
|                          |      |It may occur several times within the PS  |
|                          |      |Information field.                        |
|RAT Type                  |OC    |This field indicates which Radio Access   |
|                          |      |Technology (RAT) is currently serving the |
|                          |      |UE as defined in TS 29.061 [205].         |
|                          |      |When NBIFOM is accepted by PCRF, this     |
|                          |      |field holds the first default bearer’s RAT|
|                          |      |type when charging per IP-CAN session is  |
|                          |      |active.                                   |
|Furnish Charging          |OC    |This field contains the PS Furnish        |
|Information               |      |Information Elements.                     |
|Offline Charging          |OC    |This field contains the Offline Charging  |
|                          |      |parameters to control offline charging.   |
|PDP Context Type          |OC    |This field indicates the type of a PDP    |
|                          |      |context (i.e. Primary or Secondary). This |
|                          |      |field is present when using the Gn/Gp     |
|                          |      |reference point only.                     |
|Traffic data volumes      |OC    |This field holds the containers associated|
|                          |      |to a charging condition change on an      |
|                          |      |IP-CAN bearer. This is included when      |
|                          |      |triggers conditions are met (Qos change,  |
|                          |      |tariff time change ...).                  |
|                          |      |It may occur several times within the PS  |
|                          |      |Information field.                        |
|Service data container    |OC    |This field holds the container associated |
|                          |      |to a service condition change on a service|
|                          |      |data flow (categorized per rating group or|
|                          |      |per combination of the rating group and   |
|                          |      |service id) within this IP-CAN bearer.    |
|                          |      |For TDF case, this field holds the        |
|                          |      |container associated to a charging        |
|                          |      |condition change on an application traffic|
|                          |      |(categorized per rating group or per      |
|                          |      |combination of the rating group and       |
|                          |      |service id) within this TDF session.      |
|                          |      |It may occur several times within the PS  |
|                          |      |Information field.                        |
|User Equipment Info       |OC    |This field holds the identification of the|
|                          |      |terminal (IMEI or IMEISV…)                |
|                          |      |It is used for identifying the user in    |
|                          |      |case IMSI is not present during emergency |
|                          |      |bearer service.                           |
|                          |      |Editor's Note: Alignement with online     |
|                          |      |charging is needed.                       |
|Terminal Information      |OC    |This field holds the identification of the|
|                          |      |terminal (IMEI or IMEISV, 3GPP2-MEID..).It|
|                          |      |is used for identifying the user in case  |
|                          |      |IMSI is not present during emergency      |
|                          |      |bearer service.                           |
|                          |      |Editor's Note : this parameter is only for|
|                          |      |offline charging and usage for online     |
|                          |      |charging instead of User-Equipment-info is|
|                          |      |ffs                                       |
|Start Time                |OC    |Timestamp when User IP-CAN/TDF session    |
|                          |      |starts.                                   |
|Stop Time                 |OC    |Timestamp when User IP-CAN/TDF session    |
|                          |      |terminates.                               |
|Change Condition          |OC    |This field holds the reason for sending   |
|                          |      |Charging Data Request from the PCN Nodes. |
|Diagnostics               |OC    |This field holds a more detailed reason   |
|                          |      |for the release of theIP-CAN bearer, when |
|                          |      |a single cause is applicable, and         |
|                          |      |complements the "Change Condition"        |
|                          |      |information.                              |
|                          |      |When charging per IP-CAN session is       |
|                          |      |active, PGW uses this field to hold a more|
|                          |      |detailed reason for the release of the    |
|                          |      |IP-CAN session, when a single cause is    |
|                          |      |applicable.                               |
|Enhanced Diagnostics      |OC    |This field holds a more detailed reason   |
|                          |      |for the release of the connection, when a |
|                          |      |set of causes is applicable.              |
|                          |      |When charging per IP-CAN session is       |
|                          |      |active, PGW uses this field to hold a more|
|                          |      |detailed reason for the release of the    |
|                          |      |IP-CAN session, when a set of causes is   |
|                          |      |applicable.                               |
|Low Priority Indicator    |OC    |This field indicates if this IP-CAN       |
|                          |      |session has a low priority, i.e. for      |
|                          |      |Machine Type Communication.               |
|NBIFOM Support            |OC    |This field indicates that NBIFOM was      |
|                          |      |requested by the UE, supported and        |
|                          |      |accepted by the network for the IP-CAN    |
|                          |      |session or if NBIFOM is not supported for |
|                          |      |the IP-CAN session.                       |
|NBIFOM Mode               |OC    |This field indicates the NBIFOM mode      |
|                          |      |selected for the PDN connection, when     |
|                          |      |NBIFOM is supported for the IP-CAN        |
|                          |      |session. This field is only present when  |
|                          |      |NBIFOM is accepted.                       |
|CP CIoT EPS Optimisation  |OC    |This field indicates whether CP CIoT EPS  |
|indicator                 |      |Optimisation is used during data transfer |
|                          |      |with the UE (i.e. Control Plane NAS PDU   |
|                          |      |via S11-U between SGW and MME) or not     |
|                          |      |(i.e. User Plane via S1-U between SGW and |
|                          |      |eNB), if enabled.                         |
|UNI PDU CP Only Flag      |OC    |This field indicates whether this PDN     |
|                          |      |connection is applied with "Control Plane |
|                          |      |Only Flag" for UNI PDU transfer, i.e.     |
|                          |      |transfer only using Control Plane NAS PDU |
|                          |      |(Control Plane CIoT EPS optimisation).    |
|Serving PLMN Rate Control |Oc    |This field holds the Serving PLMN Rate    |
|                          |      |Control used by the MME.                  |
|MO exception data counter |Oc    |This field holds the MO exception data    |
|                          |      |counter value with the timestamp          |
|                          |      |indicating the time at which the counter  |
|                          |      |value increased from 0 to 1, as defined in|
|                          |      |TS 29.274 [210].                          |
|APN Rate Control          |Oc    |This field holds the list of APN Rate     |
|                          |      |Controls enforced in the PGW.             |
|3GPP PS Data Off Status   |Oc    |This field holds the 3GPP Data off Status |
|                          |      |when UE’s 3GPP Data Off status is         |
|                          |      |Activated or Deactivated.                 |
|Unused Quota Timer        |Oc    |This field holds the threshold for the    |
|                          |      |time period without any quota granted or  |
|                          |      |any quota being consumed for any rating   |
|                          |      |group belonging to the Gy session. It     |
|                          |      |holds either the value configured in PCEF,|
|                          |      |if it is supported, or the value to be    |
|                          |      |used as received from the OCS. A value of |
|                          |      |zero indicates that this mechanism shall  |
|                          |      |not be used.                              |


  NOTE:  For network requested secondary IP-CAN bearer activation, the
         CCR[Initial] does not contain a value of NSAPI, whilst the
         Negotiated QoS profile reflects the requested QoS profile used in
         the activation request.

  Editor’s Note: The handling of  "CP CIoT EPS Optimisation" when charging
         per IP-CAN session applies is FFS.







           6.3.1.3  Multiple Unit Operation information when charging per
           IP-CAN session is active

The components in the Multiple Unit Operation that are used when charging
per IP-CAN session is active can be found in table 6.3.1.3.1.

 Table 6.3.1.3.1: Structure of the Multiple Unit Operation when charging per
                          IP-CAN session is active

|Information Element |Categor|Description                            |
|                    |y      |                                       |
|Granted Service Unit|OC     |As specified in TS 32.299 [50].        |
| Tariff Time Change |OC     |As specified in TS 32.299 [50].        |
| CC Time            |OC     |As specified in TS 32.299 [50].        |
| CC Total Octets    |OC     |As specified in TS 32.299 [50].        |
| CC Input Octets    |OC     |As specified in TS 32.299 [50].        |
| CC Output Octets   |OC     |As specified in TS 32.299 [50].        |
| CC Service Specific|OC     |As specified in TS 32.299 [50].        |
|Units               |       |                                       |
|Requested Service   |OC     |As specified in TS 32.299 [50].        |
|Unit                |       |                                       |
| CC Time            |OC     |As specified in TS 32.299 [50].        |
| CC Total Octets    |OC     |As specified in TS 32.299 [50].        |
| CC Input Octets    |OC     |As specified in TS 32.299 [50].        |
| CC Output Octets   |OC     |As specified in TS 32.299 [50].        |
| CC Service Specific|OC     |As specified in TS 32.299 [50].        |
|Units               |       |                                       |
|Used Service Unit   |OC     |As specified in TS 32.299 [50].        |
| Reporting Reason   |OM     |As specified in TS 32.299 [50].        |
| Tariff Change Usage|OM     |As specified in TS 32.299 [50].        |
| CC Time            |OC     |As specified in TS 32.299 [50].        |
| CC Total Octets    |OC     |As specified in TS 32.299 [50].        |
| CC Input Octets    |OC     |As specified in TS 32.299 [50].        |
| CC Output Octets   |OC     |As specified in TS 32.299 [50].        |
| CC Service Specific|OC     |As specified in TS 32.299 [50].        |
|Units               |       |                                       |
| Event Charging Time|OC     |As specified in TS 32.299 [50].        |
|Stamp               |       |                                       |
|Service Identifier  |OC     |As specified in TS 32.299 [50].        |
|Rating Group        |OC     |As specified in TS 32.299 [50].        |
|Reporting Reason    |OC     |As specified in TS 32.299 [50].        |
|Trigger             |OC     |As specified in TS 32.299 [50].        |
|Related Trigger     |OC     |This field indicates the trigger       |
|                    |       |condition associated with an alternate |
|                    |       |access of a multi-access PDN connection|
|                    |       |that indirectly triggered this multiple|
|                    |       |unit operation.                        |
|Refund Information  |OC     |As specified in TS 32.299 [50].        |
|Envelope            |OC     |As specified in TS 32.299 [50].        |
|AF Correlation      |OC     |Supported for PS domain charging, as   |
|Information         |       |specified in TS 32.299 [50].           |
|Service Specific    |OC     |Supported for PS domain charging, as   |
|Info                |       |specified in TS 32.299 [50].           |
|QoS Information     |OC     |This field contains the authorized QoS |
|                    |       |for the first IP-CAN bearer for which  |
|                    |       |traffic is reported for the Rating     |
|                    |       |Group or Rating Group / Service        |
|                    |       |Identifier. If traffic from multiple   |
|                    |       |bearers is included in the report, only|
|                    |       |one field is included.                 |
|                    |       |                                       |
|                    |       |This field includes: QCI and ARP. For  |
|                    |       |non-GBR QCI values, this field also    |
|                    |       |includes the MBR for the downlink and  |
|                    |       |uplink direction. For GBR QCI values,  |
|                    |       |this field also includes GBR for the   |
|                    |       |downlink and uplink direction. If the  |
|                    |       |MBR is different than the GBR, then    |
|                    |       |this field also includes the MBR for   |
|                    |       |the downlink and uplink direction.     |
|                    |       |                                       |
|                    |       |This field also includes the authorized|
|                    |       |APN-AMBR for the IP-CAN session.       |
|RAT Type            |OC     |This field contains the RAT Type of the|
|                    |       |IP-CAN bearer that is first reported   |
|                    |       |for the Rating Group or Rating Group / |
|                    |       |Service Identifier. If traffic from    |
|                    |       |multiple access types is included in   |
|                    |       |this report, only one field is         |
|                    |       |included.                              |
|                    |       |                                       |
|                    |       |This field is only applicable when     |
|                    |       |NBIFOM is accepted for the IP-CAN      |
|                    |       |session.                               |


  Editor’s Note: The handling of  "Control Plane CIoT EPS Optimisation"
         when charging per IP-CAN session applies is FFS.


6.3.1.4  Supported features

The Supported features information that is used for PS domain charging is
based on the information defined for the supported features mechanism
specified in clause 6.5.10 TS 32.299 [50].

The following table defines the features applicable for the feature lists
with a Feature-List-ID of 1.

      Table 6.3.1.4: Features of Feature-List-ID 1 used in PS charging

|Featur|Feature          |Description                              |Online|
|e bit |                 |                                         |/Offli|
|      |                 |                                         |ne    |
|0     |EDCE5-CH         |This feature indicates the support of 5G |Offlin|
|      |                 |New Radio via Dual Connectivity based on |e     |
|      |                 |clause 5.2.1.11 Data Volume Reporting for|      |
|      |                 |Secondary RAT usage.                     |      |
|1     |eFMSS_CH         |This feature indicates the support of    |Both  |
|      |                 |Flexible Mobile Service Steering based on|      |
|      |                 |clause 5.1.6.                            |      |
|2     |WAEPC_CH_Untruste|This feature indicates the support of    |Both  |
|      |d                |extensions of UWAN location information  |      |
|3     |WAEPC_CH_trusted |This feature indicates the support of    |Both  |
|      |                 |extensions of TWAN location information  |      |
|4     |EDCE5-CH_Extended|This feature indicates the support of 5G |Both  |
|      |-BW-NR           |New Radio extended QoS.                  |      |
|Feature bit: The order number of the bit within the Feature-List AVP     |
|where the least significant bit is assigned number "0".                  |
|Feature: A short name that can be used to refer to the bit and to the    |
|feature, e.g. "EPS".                                                     |
|Feature in this table is always mandatory since it relates to the        |
|charging functionality of a network feature.                             |
|Description: A clear textual description of the feature.                 |




         6.3.2  Detailed message format for offline charging

The following clause specifies per Operation Type the charging data that
are sent by MME, S-GW, ePDG, TWAG, P-GW and TDF.

The Operation Types are listed in the following order: S (Start)/I
(Interim)/S (Stop)/E (Event). Therefore, when all Operation Types are
possible it is marked as SISE. If only some Operation Types are allowed for
a node, only the appropriate letters are used (i.e. SIS or E) as indicated
in the table heading. The omission of an Operation Type for a particular
field is marked with "-" (i.e. SI-E). Also, when an entire field is not
allowed in a node the entire cell is marked as "-".

Table 6.3.2.1 illustrates the basic structure of the supported fields in
the Charging Data Request message for PS offline charging.

      Table 6.3.2.1: Supported fields in Charging Data Request message

|Information Element                                          |Node  |S-GW|ePDG|
|                                                             |Type  |    |    |
|Supported Features                                |SIS-|SIS-|SIS-  |SIS-|SIS-|
|Charging Characteristics Selection Mode           |SIS-|SIS-|SIS-  |SIS-|SIS-|
|Serving Node MCC MNC              |SIS-               |-   |
|                                  |Supported Operation|S/I/|
|                                  |Types              |S/E |
|Session Identifier                                    |---E|
|Originator Host                                       |---E|
|Originator Realm                                      |---E|
|Destination Domain                                    |---E|
|Operation Type                                        |---E|
|Operation Number                                      |---E|
|Operation Identifier                                  |---E|
|User Name                                             |---E|
|Destination Host                                      |---E|
|Operation Interval                                    |---E|
|Origination State                                     |---E|
|Origination Timestamp                                 |---E|
|Proxy Information                                     |---E|
|Route Information                                     |---E|
|Operation Token                                       |---E|
|Service Information with PS, IMS, MMS and SMS Information  |
|Subscription Id                                       |---E|
|Node Functionality                                    |---E|
|Node Id                                               |---E|
|MME Number for MT SMS                                 |---E|
|MME Name                                              |---E|
|MME Realm                                             |---E|
|Serving Node Type                                     |---E|
|SGSN Address                                          |---E|
|Charging Characteristics                              |---E|
|Charging Characteristics Selection Mode               |---E|
|3GPP User Location Info                               |---E|
|User Location Info Time                               |---E|
|RAT Type                                              |---E|
|Terminal Information                                  |---E|
|Recipient Address                                     |---E|
|SMSC Address                                          |---E|
|Originator Address                                    |---E|
|Submission Time                                       |---E|
|Message Id                                            |---E|
|CN Operator Selection Entity                          |---E|



Table 6.3.2.2 illustrates the basic structure of the supported fields in
the Charging Data Response message for PS offline charging, and "SMS over
MME Charging".

      Table 6.3.2.2: Supported fields in Charging Data Response message



|Information Element                                                        |
|Supported Features             |SIS-               |SIS-       |SIS-        |
|                               |Supported Operation|I/U/T/E    |I/U/T/E     |
|                               |Types              |           |            |
|Session Identifier                                |IUT-       |IUT-        |
|Originator Host                                   |IUT-       |IUT-        |
|Originator Domain                                 |IUT-       |IUT-        |
|Destination Domain                                |IUT-       |IUT-        |
|Operation Identifier                              |IUT-       |IUT-        |
|Operation Token                                   |IUT-       |IUT-        |
|Operation Type                                    |IUT-       |IUT-        |
|Operation Number                                  |IUT-       |IUT-        |
|Destination Host                                  |IUT-       |IUT-        |
|User Name                                         |IUT-       |IUT-        |
|Origination State                                 |IUT-       |IUT-        |
|Origination Timestamp                             |IUT-       |IUT-        |
|Subscriber Identifier                             |IUT-       |IUT-        |
|Termination Cause                                 |--T-       |--T-        |
|Requested Action                                  |IUT-       |IUT-        |
|Multiple Operation                                |IU--       |IU--        |
|Multiple Unit Operation                           |IUT-       |IUT-        |
|Subscriber Equipment Number                       |IUT-       |IUT-        |
|Route Information                                 |IUT-       |IUT-        |
|Service Information                               |IUT-       |IUT-        |
|Service Information with IMS and PS Information                |            |
|Supported Features                                |IUT-       |IUT-        |
|Node Functionality                                |IUT-       |IUT-        |
|Charging Id                                       |IUT-       |-           |
|Node Id                                           |IUT-       |IUT-        |
|PDN Connection Charging Id                        |IUT-       |IUT-        |
|PDP/PDN Type                                      |IUT-       |-           |
|SGi PtP Tunnelling Method                         |IUT-       |-           |
|SCS/AS Address                                    |IUT-       |-           |
|PDP/PDN Address                                   |IUT-       |IUT-        |
|PDP/PDN Address prefix length                     |IUT-       |IUT-        |
|Dynamic Address Flag                              |IUT-       |IUT-        |
|Dynamic Address Flag Extension                    |IUT-       |IUT-        |
|QoS Information                                   |IUT-       |IUT-        |
|Serving Node Address                              |IUT-       |IUT-        |
|Serving Node Type                                 |IUT-       |IUT-        |
|SGW Change                                        |-          |-           |
|P-GW Address                                      |IUT-       |IUT-        |
|TDF Address                                       |-          |IUT-        |
|CG Address                                        |IUT-       |IUT-        |
|IMSI MCC MNC                                      |IUT-       |IUT-        |
|IMSI Unauthenticated Flag                         |IUT-       |-           |
|PGW MCC MNC                                       |IUT-       |IUT-        |
|TDF MCC MNC                                       |-          |IUT-        |
|NSAPI                                             |IUT-       |-           |
|Called Station Id                                 |IUT-       |IUT-        |
|Session Stop Indicator                            |--T-       |--T-        |
|Selection Mode                                    |IUT-       |IUT-        |
|Charging Characteristics                          |IUT-       |IUT-        |
|Charging Characteristics Selection Mode           |IUT-       |IUT-        |
|Serving Node MCC MNC                              |IUT-       |IUT-        |
|MS Time Zone                                      |IUT-       |IUT-        |
|Charging Rule Base Name                           |IUT-       |-           |
|ADC Rule Base Name                                |-          |IUT-        |
|User Location Info                                |IUT-       |IUT-        |
|User Location Info Time                           |IUT-       |-           |
|User CSG Information                              |IUT-       |IUT-        |
|3GPP2 User Location Info                          |IUT-       |IUT-        |
|TWAN User Location Information                    |IUT-       |IUT-        |
|UWAN User Location Information                    |IUT-       |-           |
|Presence Reporting Area Information               |UT-        |-           |
|RAT Type                                          |IUT-       |IUT-        |
|Furnish Charging Information                      |-          |-           |
|Offline Charging                                  |IUT-       |IUT-        |
|PDP Context Type                                  |IUT-       |-           |
|Traffic data volumes                              |-          |-           |
|Service data container                            |-          |-           |
|User Equipment Info                               |-          |-           |
|Terminal-Information                              |-          |-           |
|Start time                                        |-          |-           |
|Stop time                                         |-          |-           |
|Change Condition                                  |-          |-           |
|Diagnostics                                       |--T-       |--T-        |
|Enhanced Diagnostics                              |--T-       |-           |
|CN Operator Selection Entity                      |-          |-           |
|NBIFOM Support                                    |I---       |-           |
|NBIFOM Mode                                       |I---       |-           |
|CP CIoT EPS Optimisation Indicator                |--         |-           |
|UNI PDU CP Only Flag                              |IUT-       |-           |
|Serving PLMN Rate Control                         |IU--       |-           |
|APN Rate Control                                  |IU--       |-           |
|MO exception data counter                         |-          |-           |
|3GPP PS Data Off Status                           |IUT-       |-           |
|Unused Quota Timer                                |IU--       |-           |



Table 6.3.3.2 illustrates the basic structure of the supported fields in
the Debit / Reserve Units Response for PS online charging.

  Table 6.3.3.2: Supported fields in Debit / Reserve Units Response Message

|Information Element             |Node Type          |P-GW|TDF |
|                                |Supported Operation|I/U/|I/U/|
|                                |Types              |T/E |T/E |
|Session Identifier                                 |IUT-|IUT-|
|Operation Result                                   |IUT-|IUT-|
|Originator Host                                    |IUT-|IUT-|
|Originator Domain                                  |IUT-|IUT-|
|Operation Identifier                               |IUT-|IUT-|
|Operation Type                                     |IUT-|IUT-|
|Operation Number                                   |IUT-|IUT-|
|Operation Failover                                 |IUT-|IUT-|
|Multiple Unit Operation                            |IUT-|IUT-|
|Operation Failure Action                           |IUT-|IUT-|
|Redirection Host                                   |IUT-|IUT-|
|Redirection Host Usage                             |IUT-|IUT-|
|Redirection Cache Time                             |IUT-|IUT-|
|Route Information                                  |IUT-|IUT-|
|Failed parameter                                   |IUT-|IUT-|
|Service Information                                |IUT-|IUT-|
|Service Information with PS Information            |    |    |
|Supported Features                                 |I---|I---|
|Furnish Charging Information                       |IUT-|IUT-|
|Offline Charging                                   |I---|I---|
|                                                   |-   |-   |
|Presence Reporting Area Information                |IU--|-   |
|Unused Quota Timer                                 |IU--|-   |



6.4  Void


6.5  Bindings for EPC offline charging

This clause aims to describe the mapping between the Service Information
fields, AVPs and CDR parameter for EPC offline charging.

Table 6.5.1 describes the mapping of the Information Element, AVP and CDR
parameter of ePDG-CDR, TWAG-CDR, SGW-CDR, PGW-CDR and TDF-CDR in EPC
offline charging.

     Table 6.5.1: Bindings of CDR parameter, Information Element and AVP


|CDR Parameter    |Information Element   |AVP                 |
|Retransmission   |-                     |-                   |
|Record Opening   |-                     |-                   |
|Time             |                      |                    |
|Duration         |-                     |-                   |
|Cause for Record |-                     |-                   |
|Closing          |                      |                    |
|Record Sequence  |-                     |-                   |
|Number           |                      |                    |
|Local Record     |-                     |-                   |
|Sequence Number  |                      |                    |
|IMS Signalling   |-                     |-                   |
|Context          |                      |                    |
|CAMEL Information|-                     |-                   |
|Record Extensions|-                     |-                   |
|                 |Service Information   |Service-Information |
|Served IMSI      |Subscriber Identifier |Subscription-Id     |
|Served MN NAI    |Subscriber Identifier |Subscription-Id     |
|Served MSISDN    |Subscriber Identifier |Subscription-Id     |
|                 |IMS Information       |IMS-Information     |
|Record Type      |Node Functionality    |Node-Functionality  |
|                 |PS Information        |PS-Information      |
|-                |Supported Features    |Supported-Features  |
|Charging Id      |Charging Id           |3GPP-Charging-Id    |
|Charging per     |Charging per IP-CAN   |Charging-Per-IP-CAN-|
|IP-CAN Session   |Session Indicator     |Session-Indicator   |
|Indicator        |                      |                    |
|Node ID          |Node Id               |Node-ID             |
|PDN Connection   |PDN Connection        |PDN-Connection-Charg|
|Charging Id      |Charging Id           |ing-ID              |
|PDP/PDN Type     |PDP/PDN Type          |3GPP-PDP-Type       |
|PDP/PDN Type     |PDP/PDN Type          |3GPP-PDP-Type       |
|extension        |                      |                    |
|SGi PtP          |SGi PtP Tunnelling    |SGi-PtP-Tunnelling-M|
|Tunnelling Method|Method                |ethod               |
|SCS/AS Address   |SCS/AS Address        |SCS-AS-Address      |
|Served PDP/PDN   |PDP/PDN Address       |PDP-Address         |
|Address          |                      |                    |
|Served PDP/PDN   |PDP/PDN Address prefix|PDP-Address-Prefix-L|
|Address prefix   |length                |ength               |
|length           |                      |                    |
|Served PDP/PDN   |PDP/PDN Address       |PDP-Address         |
|Address extension|                      |                    |
|Dynamic Address  |Dynamic Address Flag  |Dynamic-Address-Flag|
|Flag             |                      |                    |
|Dynamic Address  |Dynamic Address Flag  |Dynamic-Address-Flag|
|Flag extension   |Extension             |-Extension          |
|EPC QoS          |Negotiated QoS Profile|Qos-Information     |
|Information/Qos  |                      |                    |
|Information      |                      |                    |
|Serving Node     |Serving Node Address  |SGSN-Address        |
|Address          |                      |                    |
|Serving node IPv6|Serving Node Address  |SGSN-Address        |
|Address          |                      |                    |
|Serving Node Type|Serving Node Type     |Serving-Node-Type   |
|S-GW Change      |SGW Change            |SGW-Change          |
|PGW Address Used |PGW Address           |GGSN-Address        |
|PGW IPv6 Address |PGW Address           |GGSN-Address        |
|TDF Address Used |TDF Address           |TDF-IP-Address      |
|TDF IPv6 Address |TDF Address           |TDF-IP-Address      |
|S-GW Address used|SGW Address           |SGW-Address         |
|S-GW Address IPv6|SGW Address           |SGW-Address         |
|ePDG Address Used|ePDG Address          |ePDG-Address        |
|ePDG IPv6 Address|ePDG Address          |ePDG-Address        |
|TWAG Address Used|TWAG Address          |TWAG-Address        |
|TWAG IPv6 Address|TWAG Address          |TWAG-Address        |
|-                |CG Address            |CG-Address          |
|-                |IMSI MCC MNC          |3GPP-IMSI-MCC-MNC   |
|IMSI             |IMSI Unauthenticated  |IMSI-Unauthenticated|
|Unauthenticated  |Flag                  |-Flag               |
|Flag             |                      |                    |
|PGW PLMN         |PGW MCC MNC           |3GPP-GGSN-MCC-MNC   |
|Identifier       |                      |                    |
|TDF PLMN         |TDF MCC MNC           |3GPP-GGSN-MCC-MNC   |
|Identifier       |                      |                    |
|-                |NSAPI                 |3GPP-NSAPI          |
|Access Point Name|Called Station Id     |Called-Station-Id   |
|Network          |                      |                    |
|Identifier       |                      |                    |
|-                |Session Stop Indicator|3GPP-Session-Stop-In|
|                 |                      |dicator             |
|APN Selection    |Selection Mode        |3GPP-Selection-Mode |
|Mode             |                      |                    |
|Charging         |Charging              |3GPP-Charging-Charac|
|Characteristics  |Characteristics       |teristics           |
|Charging         |Charging              |Charging-Characteris|
|Characteristics  |Characteristics       |tics-Selection-Mode |
|Selection Mode   |Selection Mode        |                    |
|Serving node PLMN|Serving Node MCC MNC  |3GPP-SGSN-MCC-MNC   |
|Identifier       |                      |                    |
|CN Operator      |CN Operator Selection |CN-Operator-Selectio|
|Selection Entity |Entity                |n-Entity            |
|MS Time Zone     |MS Time Zone          |3GPP-MS-Time-Zone   |
|Last MS Time Zone|MS Time Zone          |3GPP-MS-Time-Zone   |
|User Location    |User Location Info    |3GPP-User-Location-I|
|Information      |                      |nfo                 |
|User Location    |User Location Info    |User-Location-Info-T|
|Information Time |Time                  |ime                 |
|Last User        |User Location Info    |3GPP-User-Location-I|
|Location         |                      |nfo                 |
|Information      |                      |                    |
|User CSG         |User CSG Information  |User-CSG-Information|
|Information      |                      |                    |
|3GPP2 User       |3GPP2 User Location   |3GPP2-BSID          |
|Location         |Info                  |                    |
|information      |                      |                    |
|TWAN User        |TWAN User Location    |TWAN-User-Location-I|
|Location         |Information           |nfo                 |
|Information      |                      |                    |
|UWAN User        |UWAN User Location    |UWAN-User-Location-I|
|Location         |Information           |nfo                 |
|Information      |                      |                    |
|Presence         |Presence Reporting    |Presence-Reporting-A|
|Reporting Area   |Area Information      |rea-Information     |
|Information      |                      |                    |
|RAT Type         |RAT Type              |3GPP-RAT-Type       |
|PS Furnish       |Furnish Charging      |PS-Furnish-Charging-|
|Charging         |Information           |Information         |
|Information      |                      |                    |
|-                |Offline Charging      |Offline-Charging    |
|-                |PDP Context Type      |PDP-Context-Type    |
|List of Traffic  |Traffic data volumes  |Traffic-Data-Volumes|
|Data Volumes     |                      |                    |
|Data Volume      |-                     |Accounting-Input-Oct|
|Uplink           |                      |ets                 |
|Data Volume      |-                     |Accounting-Output-Oc|
|Downlink         |                      |tets                |
|Change Condition |Change Condition      |Change-Condition    |
|Change Time      |-                     |Change-Time         |
|Access           |-                     |Access-Availability-|
|Availability     |                      |Change-Reason       |
|Change Reason    |                      |                    |
|List of Service  |Service data container|Service-Data-Contain|
|Data             |                      |er                  |
|AF record        |AF Correlation        |AF-Correlation-Infor|
|information      |Information           |mation              |
|Charging Rule    |Charging Rule Base    |Charging-Rule-Base-N|
|Base Name        |Name                  |ame                 |
|ADC Rule Base    |ADC Rule Base Name    |ADC-Rule-Base-Name  |
|Name             |                      |                    |
|Rating Group     |Rating Group          |Rating-Group        |
|Service          |Service Identifier    |Service-Identifier  |
|Identifier       |                      |                    |
|Service Specific |Service Specific Info |Service-Specific-Inf|
|Info             |                      |o                   |
|Report Time      |-                     |Change-Time         |
|Service Condition|-                     |Change-Condition    |
|Change           |                      |                    |
|Result Code      |-                     |Result-Code         |
|Time of First    |-                     |Time-First-Usage    |
|Usage            |                      |                    |
|Time of Last     |-                     |Time–Last-Usage     |
|Usage            |                      |                    |
|Time Usage       |-                     |Time-Usage          |
|Traffic Steering |Traffic Steering      |Traffic-Steering-Pol|
|Policy Identifier|Policy Identifier DL  |icy-Identifier-DL   |
|DL               |                      |                    |
|Traffic Steering |Traffic Steering      |Traffic-Steering-Pol|
|Policy Identifier|Policy Identifier UL  |icy-Identifier-UL   |
|UL               |                      |                    |
|-                |User Equipment Info   |User-Equipment-Info |
|Served IMEI      |Terminal Information  |Terminal-Information|
|Served 3GPP2 MEID|Terminal Information  |Terminal-Information|
|Start Time       |Start Time            |Start-time          |
|Stop Time        |Stop Time             |Stop-time           |
|Cause for Record |Change Condition      |Change-Condition    |
|Closing          |                      |                    |
|Diagnostics      |Diagnostics           |Diagnostics         |
|Enhanced         |Enhanced Diagnostics  |Enhanced-Diagnostics|
|Diagnostics      |                      |                    |
|Low Priority     |Low Priority Indicator|Low-Priority-Indicat|
|Indicator        |                      |or                  |
|NBIFOM Support   |NBIFOM Support        |NBIFOM-Support      |
|NBIFOM Mode      |NBIFOM Mode           |NBIFOM-Mode         |
|CP CIoT EPS      |CP CIoT EPS           |CP-CIoT-EPS-Optimisa|
|Optimisation     |Optimisation indicator|tion-Indicator      |
|Indicator        |                      |                    |
|UNI PDU CP Only  |UNI PDU CP Only Flag  |UNI-PDU-CP-Only-Flag|
|Flag             |                      |                    |
|Serving PLMN Rate|Serving PLMN Rate     |Serving-PLMN-Rate-Co|
|Control          |Control               |ntrol               |
|MO exception data|MO exception data     |RRC-Cause-Counter   |
|counter          |counter               |                    |
|APN Rate Control |APN Rate Control      |APN-Rate-Control    |
|3GPP PS Data Off |3GPP PS Data Off      |3GPP-PS-Data-Off-Sta|
|Status           |Status                |tus                 |
|List of RAN      |RAN Secondary RAT     |RAN-Secondary-RAT-Us|
|Secondary RAT    |Usage Reports         |age Report          |
|Usage Reports    |                      |                    |








Table 6.5.2 describes the mapping of the Information Element, AVP and the
CDR parameter of S-SMO/S-SMT-CDR in EPC offline charging for SMS.

 Table 6.5.2: Bindings of S-SMO/S-SMT-CDR parameter, Information Element and
                                     AVP

|CDR Parameter            |Information Element      |AVP                      |
|Retransmission           |-                        |-                        |
|Local Record Sequence    |-                        |-                        |
|Number                   |                         |                         |
|CAMEL Information        |-                        |-                        |
|Record Extensions        |-                        |-                        |
|                         |Service Information      |Service-Information      |
|Served IMSI              |Subscriber Identifier    |Subscription-Id          |
|Served MSISDN            |Subscriber Identifier    |Subscription-Id          |
|                         |IMS Information          |IMS-Information          |
|Record Type              |Node Functionality       |Node-Functionality       |
|                         |PS Information           |PS-Information           |
|Recording Entity         |MME Number for MT SMS    |MME-Number-for-MT-SMS    |
|MME Name                 |MME Name                 |MME-Name                 |
|MME Realm                |MME Realm                |MME-Realm                |
|                         |SMS Information          |SMS-Information          |
|Destination Number       |Recipient-Address        |Recipient-Address        |
|Service Centre           |SMSC-Address             |SMSC-Address             |
|                         |MMS Information          |MMS-Information          |
|Originating Address      |Originator Address       |Originator-Address       |
|Event Time Stamp         |Submission-Time          |Submission-Time          |
|Message Reference        |Message Id               |MessageId                |

  NOTE:  The whole set of ePDG-/TWAG-/MME-/SGW-/PGW-/TDF-CDR parameters is
         described in the TS 32.298 [51].



Annex A (normative):
Charging characteristics


A.1  General

Charging Characteristics can be supplied by the HLR/HSS/AAA to the Gn/Gp
SGSN or the HSS to the MME as part of the subscription information. Upon IP-
CAN bearer activation, the Gn/Gp SGSN (resp. MME) forwards the Charging
Characteristics parameter to the P-GW (resp. S-GW then the P-GW). Upon TDF
session establishment, the P-GW forwards the Charging Characteristics
parameter to the TDF (resp. PCRF then the TDF). A subscriber may have
Charging Characteristics assigned to his subscription and/or his subscribed
APNs. Default charging characteristics may also be pre-provisioned on the
PCN.

The Charging Characteristics parameter consists of a string of 16 bits
designated as Behaviours (B), freely defined by Operators, as shown in
TS 32.298 [51]. Each bit corresponds to a specific charging behaviour which
is defined on a per operator basis, configured within the PCN and pointed
when bit is set to "1" value.

The Gn/Gp SGSN and the PCN may either apply the Charging Characteristics
provided by the HLR/HSS or ignore it to apply a default configuration. For
example for a foreign subscriber, the network may choose either the
Visiting or the Roaming default behaviour. Consequently, the network may
apply:

  -  The Charging Characteristics provided by the HLR/HSS

  -  The Home default behaviour (the SGSN and the S-GW belong to the Home
    PLMN)

  -  The Roaming default behaviour (the P-GW and/or TDF belongs to the Home
    PLMN of the subscriber, a.k.a. home-routed scenario).

  -  The Visiting default behaviour (the SGSN, the S-GW and the P-GW and/or
    the TDF belongs to the Visited PLMN a.k.a. local breakout scenario)

For example, one way to define a charging behaviour could be to associate
it to a specific usage designed according to following guidances:

One usage may consist of a set of trigger profiles associated to CDR types,
with following trigger sets, e.g.:

  -  S-CDR: activate/deactivate CDRs, time limit, volume limit, maximum
    number of charging conditions, tariff times;

  -  SGW-CDR: same as S-CDR, plus maximum number of S4-SGSN/MME changes;

  -  PGW-CDR: same as S-CDR, plus maximum number of S-GW changes;

  -  M-CDR: activate/deactivate CDRs, time limit, and maximum number of
    mobility changes;

  -  TDF-CDR: same as PGW-CDR

  -  SMS-MO-CDR: activate/deactivate CDRs;

  -  SMS-MT-CDR: active/deactivate CDRs.

  -  LCS-MO-CDR.

  -  LCS-MT-CDR.

  -  LCS-NI-CDR.

In addition to these trigger sets, an optional charging gateway address may
also be specified:

  -  If the CGF address is configured in the P-GW's selected Charging
    Characteristics behaviour, the P-GW shall apply it for the PGW-CDRs.
    The P-GW applied CGF address is sent to Gn/Gp SGSN/S-GW during IP-CAN
    bearer activation.

  -  If the CGF address is configured in the TDF's selected Charging
    Characteristics behaviour, the TDF shall apply it for the TDF-CDRs
    pertaining to the TDF session.

  -  In the home or visiting case, the S-GW shall apply the CGF address
    received from the P-GW to the SGW-CDRs pertaining to this IP-CAN
    bearer. In the roaming case, or if no CGF address is received from the
    P-GW, the S-GW shall use the CGF address from its own applied Charging
    Characteristics behaviour, or, if it does not exist, it uses the
    default CGF address. There is no need to send CGF address to S4-
    SGSN/MME as it does not generate charging data.

  -  In the home or visiting case, the Gn/Gp SGSN shall apply the CGF
    address received from the P-GW to the S-CDRs pertaining to this IP-CAN
    bearer. In the roaming case, or if no CGF address is received from the
    P-GW, then the Gn/Gp SGSN shall use the CGF address from its own
    selected Charging Characteristics behaviour, or, if it does not exist,
    use the default CGF address. For M-CDRs and SMS CDRs, the Gn/Gp SGSN
    shall use the CGF address configured in the Charging Characteristics
    behaviour that it applies to the respective CDRs, or if no such address
    is configured then the default CGF shall be used.



Tables A.1.1, A.1.2 and A.1.3 are informative examples intended for
clarification.

    Table A.1.1: Example of Charging Characteristics behaviours for SGSN

|          |              |S-CDR                                  |M-CDR      |
|Behaviour |CGF Address                                                      |
|Index bits|                                                                 |
|          |                                                                 |
|0 - 3     |                                                                 |
|Behaviour |Primary and  |Active|Time   |Vol     |Change |Tariff  |…          |
|Index     |Secondary CGF|      |Limit  |Limit   |Cond.  |times   |           |
|Bits      |Addresses    |      |       |        |       |        |           |
|0-15      |             |      |       |        |       |        |           |
|1         |100.128.35.21|No    |-      |-       |-      |-       |…          |
|          |100.128.35.20|      |       |        |       |        |           |
|2         |100.128.35.21|Yes   |10 min |50K     |1      |0-24    |...        |
|          |100.128.35.20|      |       |        |       |        |           |
|…         |…            |…     |…      |…       |…      |…       |…          |



Charging Characteristics behaviour in P-GW is used for PGW-CDR generation /
and for online charging.

FBC is always active in P-GW. PCRF, if triggered, may provide default
charging method to PCEF (P-GW) per IP-CAN bearer session. If received by
the PCEF, it supersedes the "Default charging method'" in Charging
Characteristics behaviour, see TS 23.203 [215] for more information about
default charging method. PCRF may also provide CGF/OCS addresses to P-GW
per IP-CAN bearer session. If received by the P-GW it supersedes the
"Primary CGF/OCS address"' and "Secondary CGF/OCS address"' in Charging
Characteristics behaviour, see TS 23.203 [215] for more information.

    Table A.1.3: Example of Charging Characteristics behaviours for P-GW

|               |Offline charging (PGW-CDR)              |Online charging    |
|Behaviour      |Default charging method                 |Primary and        |
|Index          |                                        |Secondary CGF      |
|Bits           |                                        |addresses          |
|0-15           |                                        |                   |
|Behaviour|Default      |Primary  |Active      |Time     |Vol      |Change   |
|Index    |charging     |and      |            |Limit    |Limit    |Cond.    |
|Bits     |method       |Secondary|            |         |         |         |
|0-15     |             |CGF      |            |         |         |         |
|         |             |addresses|            |         |         |         |
|Failure  |After Tx     |P-GW:    |After Tx    |P-GW:    |P-GW:    |P-GW:    |
|Action=  |expiration,  |IP-CAN   |expiration, |IP-CAN   |IP-CAN   |IP-CAN   |
|RETRY &  |the P-GW/TDF |bearer is|the P-GW/TDF|bearer is|bearer is|bearer is|
|TERMINATE|sends the    |not      |will move   |terminate|not      |terminate|
|         |Reserve Units|establish|all pending |d.       |establish|d.       |
|         |Request[Initi|ed.      |Reserve     |The      |ed.      |The      |
|         |al] to the   |TDF      |Units       |PGW-CDR  |TDF:     |PGW-CDR  |
|         |secondary    |indicates|Request     |is       |indicates|is       |
|         |OCS. The next|to the   |[Update] for|marked.  |to the   |marked.  |
|         |consideration|PCRF that|the online  |TDF:     |PCRF that|TDF:     |
|         |s also apply:|the      |session to  |indicates|the      |indicates|
|         |Tx is        |charging |the         |to the   |charging |to the   |
|         |restarted.   |session  |secondary   |PCRF that|session  |PCRF that|
|         |Service is   |was      |OCS. The    |the      |was      |the      |
|         |not granted  |terminate|next        |charging |terminate|charging |
|         |yet, i.e. PDP|d and the|consideratio|session  |d and the|session  |
|         |context/TDF  |OCS does |ns also     |was      |OCS does |was      |
|         |session is   |not allow|apply:      |terminate|not allow|terminate|
|         |not          |the      |Tx is       |d and the|the      |d and the|
|         |accepted/esta|service  |restarted   |OCS does |service  |OCS does |
|         |blished yet. |to       |Service is  |not allow|to       |not allow|
|         |If an answer |continue.|only granted|the      |continue.|the      |
|         |from the     |         |until the   |service  |         |service  |
|         |first OCS is |         |quota is    |to       |         |to       |
|         |received     |         |exhausted.  |continue.|         |continue.|
|         |after the    |         |If an answer|The      |         |The      |
|         |first Tx     |         |from the    |TDF-CDR  |         |TDF-CDR  |
|         |expiration,  |         |first OCS is|is       |         |is       |
|         |it is        |         |received    |marked.  |         |marked.  |
|         |ignored.     |         |after first |         |         |         |
|         |             |         |Tx          |         |         |         |
|         |In case the  |         |expiration, |         |         |         |
|         |secondary OCS|         |it is       |         |         |         |
|         |is not       |         |ignored.    |         |         |         |
|         |available,   |         |            |         |         |         |
|         |the behaviour|         |In case the |         |         |         |
|         |is described |         |secondary   |         |         |         |
|         |in the       |         |OCS is not  |         |         |         |
|         |column:      |         |available,  |         |         |         |
|         |"Initial CCR,|         |the         |         |         |         |
|         |Tx expiration|         |behaviour is|         |         |         |
|         |for second   |         |described in|         |         |         |
|         |OCS'”.       |         |the column: |         |         |         |
|         |             |         |" Reserve   |         |         |         |
|         |             |         |Units       |         |         |         |
|         |             |         |Request[Upda|         |         |         |
|         |             |         |te], Tx     |         |         |         |
|         |             |         |expiration  |         |         |         |
|         |             |         |for second  |         |         |         |
|         |             |         |OCS'”.      |         |         |         |
|Failure  |After Tx     |P-GW: The|After Tx    |After the|After the|After Tx |
|Action=  |expiration,  |IP-CAN   |expiration, |Tx       |Tx       |expiratio|
|CONTINUE |the P-GW/TDF |bearer is|the P-GW/TDF|expiratio|expiratio|n for the|
|         |sends the    |accepted |will move   |n, the   |n for the|secondary|
|         |Reserve Units|and the  |all pending |failure  |secondary|OCS, the |
|         |Request[Initi|Credit-Co|update CCRs |handling |OCS, the |failure  |
|         |al] to the   |ntrol    |for the     |mechanism|failure  |handling |
|         |secondary    |session  |online      |is       |handling |mechanism|
|         |OCS. The next|is       |session to  |immediate|mechanism|is       |
|         |consideration|considere|the         |ly       |is       |immediate|
|         |s also apply:|d closed |secondary   |triggered|immediate|ly       |
|         |Tx is        |for the  |OCS. The    |-        |ly       |triggered|
|         |restarted    |P-GW.    |next        |P-GW: The|triggered|-        |
|         |Service is   |The      |consideratio|Credit-Co|:        |P-GW: The|
|         |not granted  |operator |ns also     |ntrol    |P-GW: The|Credit-Co|
|         |yet, i.e. PDP|can limit|apply:      |session  |IP-CAN   |ntrol    |
|         |context/TDF  |the      |Tx is       |is       |bearer is|session  |
|         |session is   |duration |restarted   |considere|accepted |is       |
|         |not          |of the   |Service is  |d closed |and the  |considere|
|         |accepted/esta|IP-CAN   |only granted|for the  |Credit-Co|d closed |
|         |blished yet. |bearer.  |until the   |P-GW and |ntrol    |for the  |
|         |If an answer |The      |quota is    |access to|session  |P-GW and |
|         |from the     |PGW-CDR  |exhausted   |all      |is       |access to|
|         |first OCS is |is       |If an answer|services |considere|all      |
|         |received     |marked.  |from the    |is       |d closed |services |
|         |after the    |TDF:     |first OCS is|granted  |for the  |is       |
|         |first Tx     |indicates|received    |for an   |P-GW.    |granted  |
|         |expiration,  |to the   |after the   |operator |The      |for an   |
|         |it is        |PCRF that|first Tx    |configura|operator |operator |
|         |ignored.     |the      |expiration, |ble      |can limit|configura|
|         |             |charging |it is       |period of|the      |ble      |
|         |In case the  |session  |ignored.    |time.    |duration |period of|
|         |secondary OCS|was      |            |The      |of the   |time.    |
|         |is not       |terminate|In case the |PGW-CDR  |IP-CAN   |The      |
|         |available,   |d and the|secondary   |is       |bearer.  |PGW-CDR  |
|         |the behaviour|OCS      |OCS is not  |marked.  |The      |is       |
|         |is described |allows   |available,  |TDF:     |PGW-CDR  |marked.  |
|         |in the       |the      |the         |indicates|is       |TDF:     |
|         |column:      |service  |behaviour is|to the   |marked.  |indicates|
|         |"Initial CCR,|to       |described in|PCRF that|TDF:     |to the   |
|         |Tx expiration|continue.|the column: |the      |indicates|PCRF that|
|         |for second   |The      |"Update CCR,|charging |to the   |the      |
|         |OCS'”.       |TDF-CDR  |Tx          |session  |PCRF that|charging |
|         |             |is       |expiration  |was      |the      |session  |
|         |             |marked.  |for second  |terminate|charging |was      |
|         |             |         |OCS'”.      |d and the|session  |terminate|
|         |             |         |            |OCS      |was      |d and the|
|         |             |         |            |allows   |terminate|OCS      |
|         |             |         |            |the      |d and the|allows   |
|         |             |         |            |service  |OCS      |the      |
|         |             |         |            |to       |allows   |service  |
|         |             |         |            |continue.|the      |to       |
|         |             |         |            |The      |service  |continue.|
|         |             |         |            |TDF-CDR  |to       |The      |
|         |             |         |            |is       |continue.|TDF-CDR  |
|         |             |         |            |marked.  |The      |is       |
|         |             |         |            |All      |TDF-CDR  |marked.  |
|         |             |         |            |active   |is       |All      |
|         |             |         |            |service  |marked.  |active   |
|         |             |         |            |data flow|         |service  |
|         |             |         |            |container|         |data flow|
|         |             |         |            |s shall  |         |container|
|         |             |         |            |be added |         |s shall  |
|         |             |         |            |to the   |         |be added |
|         |             |         |            |PGW-CDR/T|         |to the   |
|         |             |         |            |DF-CDR.  |         |PGW-CDR/T|
|         |             |         |            |         |         |DF-CDR.  |


Annex C (informative):
Bibliography

This Annex is a placeholder for documents which are not explicitly cited in
this specification.


Annex D (normative):
Fixed Broadband Access


D.1  General

This annex specifies the enhancement to PS domain Charging for supporting
the convergent scenario, where a single operator owns both the fixed
broadband access network and the EPC, and the PCEF is located in the fixed
broadband access network, as described in the TS 23.203 [215].

This Annex describes only the exceptions and additions in respect the main
body requirements, therefore, if not explicitly mentioned the main body is
applicable.

In this Annex, the IP-Edge embedding PCEF will be denoted IP-Edge [PCEF].

As specified in the TS 23.203 [215],  Charging for following types of
traffic is supported:

  -  traffic from fixed devices, and

  -  non-seamless WLAN offload traffic from a 3GPP UE.

  Editor's note: this Annex might require some adjustments based on
         exchanges with BBF.


D.2  Architecture considerations


D.2.1  High level architecture

For offline charging the IP-Edge [PCEF] /TDF may generate accounting
metrics sets to record a user's access to external networks based on clause
D.2.2 architecture.

Online charging is supported from the IP-Edge [PCEF] /TDF based on clause
D.2.3.


D.2.2  PS domain offline charging architecture

The Rf interface is supported from the Policy and Charging Enforcement
Function (PCEF) located in IP-Edge, and includes the required FBC
functionality of the Gz reference point, adapted to IP-Edge [PCEF] as
defined in this Annex.

The Rf, Ga and Bp interfaces are supported from the TDF and includes the
required ABC functionality of the Gzn reference point as defined for the
PCN in clause 4.2


D.2.3  PS domain online charging architecture

The Ro interface is supported from the Policy and Charging Enforcement
Function (PCEF) located in IP-Edge as per clause 4.3 architecture, and
includes the required FBC functionality of the Gy reference point, adapted
to IP-Edge [PCEF] as defined in this Annex.

The Ro interface is supported from the TDF as per clause 4.3 architecture,
and includes the required ABC functionality of the Gyn reference point as
defined for the PCN in clause 4.3.


D.3  PS domain charging principles and scenarios


D.3.1  PS charging principles


D.3.1.0  General

IP-CAN session applicable for Fixed Broadband Access, is defined in the TS
23.203 [215], clause S.2.

The charging functions specified for the PCEF located in the IP-Edge relate
to:

  -  IP-CAN session.

  -  individual service data flows within an IP-CAN session.

The charging functions specified for the TDF relate to:

  -  TDF session.

  -  individual applications within a TDF session.


D.3.1.1  Requirements


D.3.1.1.1   Requirements for IP-Edge [PCEF]

The high-level charging requirements 1, 2, 3, 10, 11 and 12 specified in
clause 5.1.1 apply with the difference that
P-GW is replaced by IP-Edge [PCEF].

Since the IP-Edge [PCEF] does not support individual bearers, the high-
level charging requirements 1 and 2 apply to the IP-CAN session instead of
an IP-CAN bearer.

  Additional high level charging requirement:

  -  The IP-Edge [PCEF] shall be capable of identifying data volumes,
    elapsed time or events, categorized per QoS (QoS as defined in TS
    23.203 [215]).

  -  IP-Edge [PCEF] shall support charging for 3GPP UEs in roaming
    scenario, where the HPLMN has deployed the same charging capabilities
    as the VPLMN.

  -  The IP-Edge [PCEF] shall be capable of handling local Charging
    Characteristics for Fixed users and 3GPP UEs NSWO traffic: see clause
    D.5 for details.

These requirements apply equally to online charging and offline charging.


D.3.1.1.2   Requirements for TDF

The High level Requirements specified in Clause 5.1.1 for TDF shall apply
with the difference that Charging Characteristics shall be as described in
clause D.5.



         D.3.1.2  Charging information

Charging information is collected for each Fixed user served by the  IP-Edge
[PCEF] /TDF, and for each 3GPP UE served by the IP-Edge [PCEF] /TDF for  the
Offloaded (NSWO) traffic, both when served in the conditions specified in
TS  23.203  [215]  Annex  S.  The  IP-Edge  [PCEF]  /TDF  collects  charging
information related to the Fixed Broadband access resources and to  external
data network usage.

Charging information is collected for each existing IP-CAN/TDF  session  per
identified user: 3GPP UE, Fixed device or RG.

Charging information collection per device (i.e. fixed device or 3GPP UE)
is possible only when an IP-CAN session exists for the 3GPP UE or fixed
device connected behind a RG.

  NOTE 1:  In case of 3GPP UE or fixed device behind a NATed RG it is not
         possible to perform charging for that specific device.

  NOTE 2 : The cases where it is possible to support an IP-CAN session per
         device are described in TS 23.203 [215] Annex S.

3GPP UE user is identified by the IMSI, and Fixed user  (i.e.  fixed  device
or RG) is identified by a user name or Access line identifier, based on  the
Subscriber ID as defined in Broadband Forum TR 134 [601]..

The Access Line Identifier (physical and logical circuit ID) shall  also  be
collected by the IP-Edge [PCEF] when  available,  when  this  Subscriber  ID
identifies a 3GPP UE or a fixed device behind the RG.

The  IP-Edge  [PCEF]  may  provide  the  following  fixed  broadband  access
specific information:

  -  Location of the subscriber; that may include Access Line Identifier
    (physical and logical circuit ID), SSID of the Access Point, BSSID of
    the Access Point.

  NOTE:  How the location information becomes available to the IP-Edge
         [PCEF] is out of the scope of 3GPP.

  -  IP-Edge Operator Identifier (i.e., PLMN Id), if available.

For  IP-CAN  sessions,  the  IP-Edge  [PCEF]  shall  collect  the  following
charging information for both online and offline charging:

   1). Usage of the Fixed Broadband access resources: the charging
    information shall describe the amount of data transmitted in uplink and
    downlink directions categorized with QoS.

  NOTE 3: Qos information used for charging is based on standardized QoS
    characteristics as defined TS 23.203 [215]. The Fixed Broadband Access
    specific QoS attribute converted by the IP-Edge [PCEF] from these QoS
    parameters are out of scope.2). Usage duration: duration of IP-CAN
    session is counted as the time interval from IP-CAN session
    establishment to IP-CAN session termination.

  3).  Usage of the external data networks: the charging information shall
    describe the amount of data sent and received to and from the external
    data network. For an IP-CAN session corresponding to a 3GPP UE, the
    External network can be identified by the NSWO APN.

  4).  Source: the charging information shall provide the actual source
    addresses used by the subscriber for the IP-CAN session.

  5).  The amount of data transmitted in uplink and downlink directions
    categorized by rating group or combination of the rating group and
    service id when volume based charging applies;

  6).  The duration of service data flows categorized by rating group or
    combination of the rating group and service id when time based charging
    applies;

For TDF sessions and for application traffic defined for ABC, the TDF  shall
collect the charging information for both online and offline charging:

  1) Usage of the Fixed Broadband access resources: the charging
    information shall describe the amount of data transmitted in uplink and
    downlink directions categorized with maximal bandwidth;

  2) Usage duration: duration of TDF sesion is counted as the time interval
    from TDF session activation to TDF session deactivation;

  3) Source: the charging information shall provide the actual source
    addresses used by the subscriber for the TDF session;

  4) Usage of the external data networks: the charging information shall
    describe the amount of data sent and received to and from the external
    data network. For a TDF session corresponding to a 3GPP UE, the
    External network can be identified by the APN.

  5) The amount of data transmitted as specific application in uplink and
    downlink directions categorized by rating group or combination of the
    rating group and service identifier when volume based charging applies;

  6) The duration of application traffic is counted and categorized by
    rating group or combination of the rating group and service identifier
    when time based charging applies;

  7) The number of events and corresponding timestamps categorized by
    rating group or combination of the rating group and service identifier
    when event based charging applies.







         D.3.2  PS domain offline charging scenarios


D.3.2.1  Basic principles


D.3.2.1.0   General

In order to provide the data required for the management activities
outlined in TS 32.240 [1] (billing, accounting, statistics etc.), the IP-
Edge [PCEF] /TDF shall be able to report charging events to a CDF
implemented as a separate entity for the corresponding IPE-CDR/TDF-CDR
generation by CDF for:

  -  Charging Data related to the IP-CAN session;

  -  Charging Data related to service data flows (FBC) within an IP-CAN
    session;

  -  Charging data related to TDF session (TDF-CDR) in the TDF;

  -  Charging Data related to application traffic in the TDF (TDF-CDR).

Either Charging Data related to the IP-CAN session, Charging Data related
to services data flows (FBC) within an IP-CAN session, or both may be
reported for the IPE-CDR generation, as determined by Charging
Characteristics. A single IPE-CDR is defined for both types of charging
information.


D.3.2.1.1   IP-CAN session charging

IP-Edge [PCEF] collects charging information per user identified as
described in clause D.3.1.2, per IP-CAN session.

IP-CAN session charging allows the IP-Edge [PCEF] to collect charging
information related to data volumes sent to and received by the user,
categorised by the QoS applied, for the timeframe since the establishment
till the termination of IP-CAN session, for Fixed user traffic or 3GPP UE
NSWO traffic. The IP-CAN session can be determined by a unique identifier
generated by the Edge [PCEF] (a "Charging ID") when establishing IP-CAN
session.When IP-CAN session charging is active for this IP-Edge[PCEF], the
main collected information items are duration of the IP-CAN session and
data volume transferred per QoS during the lifetime of the IP-CAN session,
and the following chargeable events are defined:

  -  Start of IP-CAN session in the IP-Edge [PCEF]. Upon encountering this
    event, a new IPE-CDR for this context is created.

  NOTE 1:  The start of IP-CAN session event is a shared trigger for FBC in
         clause D.3.2.1.2 for the single shared CDR-  Start of traffic under
         a QoS within the IP-CAN session: new data volume counts (i.e.
         uplink and downlink) are   started for this QoS.

  -  Termination of traffic under a QoS within the IP-CAN session: The
    counters and time stamps for this QoS are closed and resulting
    containers added to the CDR.

  -  End of IP-CAN session in the IP-Edge [PCEF]. Upon encountering this
    trigger, all the counters are closed and added to the CDR, and the IPE-
    CDR is closed.

  NOTE 2:  The end of IP-CAN session event is a shared trigger for FBC in
         clause D.3.2.1.2 for the single shared CDR

  -  Expiry of an operator configured time limit for keeping a CDR open.
    This event closes all counters. The resulting containers are added to
    the CDR and the CDR is closed. A new CDR is opened if the IP-CAN
    session is still active.

  NOTE 3:  Expiry of an operator configured time limit for keeping a CDR
         open event is a shared trigger for FBC in clause D.3.2.1.2 for the
         single shared CDR

  -  Expiry of an operator configured time limit per QoS. The counters and
    time stamps for the QoS are closed and added to the CDR. New QoS
    traffic volume containers are opened if the QoS is still active.

  -  Expiry of an operator configured data volume limit per IP-CAN session.
    This event closes all counters.
    The resulting containers are added to the CDR and the CDR is closed. A
    new CDR is opened if the IP-CAN session is still active.

  NOTE 4:  Expiry of an operator configured data volume limit per IP-CAN
         session event is a shared trigger for FBC in clause D.3.2.1.2 for
         the single shared CDR

  -  Expiry of an operator configured data volume limit per QoS. The
    counters and time stamps for the QoS are closed and added to the CDR.
    New QoS traffic volume containers are opened if the QoS is still
    active.

  -  Change of charging condition: tariff time change or failure handling
    procedure triggering.When this event is encountered, all current
    configured counts and time stamps are captured and new counts and time
    stamps are started.

  NOTE 5:  Change of charging condition event is a shared trigger for FBC
         in clause D.3.2.1.2 for the single shared CDR

  -  Expiry of an operator configured change of charging condition limit
    per IP-CAN session. This event closes the CDR, and a new one is opened
    if the IP-CAN session is still active.

  NOTE 6:  Expiry of an operator configured change of charging condition
         limit per IP-CAN session event is a shared trigger for FBC in
         clause D.3.2.1.2 for the single shared CDR

Management intervention may also force trigger a chargeable event.


D.3.2.1.2   Flow-based bearer charging

FBC functionality defined in clause 5.2.1.3 shall apply when provided by
the PCEF located in the IP-Edge, with modifications described below:

  -  Relates to Fixed user traffic and 3GPP UE NSWO traffic.

  -  It is applicable within the context of an IP-CAN session.

The chargeable events defined in clause 5.2.1.3, when offline charging is
activated, apply with the difference that P-GW is replaced by IP-Edge
[PCEF], and IP-CAN bearer is replaced by IP-CAN session.

Change of charging condition is modified to remove conditions related to
SGSN change, S-GW change, user location change, user CSG information
change, change of UE presence in Presence Reporting Area(s). The following
are the resulting applicable events:

  -  Change of charging condition: QoS change. When this event is
  encountered, all current configured counts and time stamps applicable to
  the QoS level are captured and new counts and time stamps for all service
  data flows applicable to the new QoS level are started.

  -  Change of charging condition: tariff time change or failure handling
  procedure triggering. When this event is encountered, all current
  configured counts and time stamps are captured and new counts and time
  stamps for all active service data flows are started.

Following are not applicable:

  -  Intersystem change.

  -  PLMN change.

  -  MS Timezone change.

  -  SGSN change in the P-GW.

  NOTE:  A set of chargeable events are shared triggers for IP-CAN session
         charging in clause D.3.2.1.1 for the single shared IPE-CDR. They
         are indicated in clause D.3.1.1.

The detailed PCEF behaviour associated to these chargeable events above,
are detailed below.

When applicable to the IP-Edge [PCEF], charging information included in the
PCC Rule is specified in TS 23.203 [215] Annex S.


D.3.2.1.3   TDF/Application Based Charging

TDF session and ABC functionality defined in clause 5.2.1.9 shall apply
with modifications described below:

  -  Relates to Fixed user traffic and 3GPP UE NSWO traffic.

The chargeable events defined in clause 5.2.1.9, when offline charging is
activated, apply except the following:

  -  Serving node (e.g. SGSN/S-GW/ePDG) change;

  -  Change of charging condition: TDF session modification (e.g. SGSN
    change, S-GW change, user location change, user CSG information
    change);

  -  Intersystem change (e.g. change of radio interface from GSM to UMTS,
    RAT change);

  -  PLMN change;

  -  MS Timezone change.

The detailed TDF behaviour associated to these chargeable events above, is
detailed below.



         D.3.2.2  Rf message flows


D.3.2.2.0   General

Charging information reporting is supported from the PCEF located in IP-
Edge and by the TDF as defined for PCN in clause 5.2.2.

The trigger conditions for the chargeable events are described in the
following clauses.


D.3.2.2.1   Triggers for charging events from IP-Edge [PCEF]


D.3.2.2.1.0 General

Charging event reporting as defined in clause 5.2.2.2 shall apply to the
PCEF located in the IP-Edge, with the differences that P-GW is replaced by
IP-Edge [PCEF], IP-CAN bearer is replaced by IP-CAN session, and includes,
in addition:

  -  containers identifying per QoS, traffic volumes charging data
    (separated for uplink and downlink traffic) with associated charging
    condition change information when IP-CAN session charging is active for
    this IP-Edge [PCEF].

The trigger conditions applicable are described in following clauses.


D.3.2.2.1.1 Triggers for charging information addition

Charging event for charging information addition and triggers, as defined
in clause 5.2.3.4.1 shall apply to the PCEF located in the IP-Edge for FBC
(i.e. "List of Service Data" attribute of the IPE-CDR), with following
exceptions:

  -  IP-CAN bearer modification (e.g. QoS change, SGSN/S-GW/ePDG change,
    user location change, user CSG information change) as trigger
    conditions is replaced by IP-CAN session modification (e.g. QoS
    change,..)

  -  The "Serving node Address" attribute is not applicable.

When IP-CAN session charging is active, the trigger conditions for charging
information addition are described in clause D.3.2.3.1.1.


D.3.2.2.1.2 Triggers for charging information closure

Charging event for charging information closure, and triggers as defined in
clause 5.2.3.4.2 shall apply to the PCEF located in the IP-Edge, when
either FBC or IP-CAN session charging or both are active, with the
following differences:

  -  P-GW is replaced by IP-Edge [PCEF], IP-CAN bearer is replaced by IP-
    CAN session, and PGW-CDR is replaced by IPE-CDR.

  -  following Partial Record Reasons: PLMN change, RAT type, and MS time
    zone change are not applicable.


D.3.2.2.2   Triggers for charging events from TDF


D.3.2.2.2.0 Introduction

Charging event reporting as defined in clause 5.2.2.5 shall apply to the
TDF, with the differences that trigger conditions which are not applicable
are described in the following clauses.


D.3.2.2.2.1 Triggers for charging information addition

Charging event for charging information addition and triggers, as defined
in clause 5.2.3.9.2 shall apply to the TDF, with the following exceptions:

  -  TDF session modification (e.g. SGSN/S-GW/ePDG change, user location
    change, user CSG information change, change of UE presence in a
    Presence Reporting Area);

  -  The "Serving node Address" attribute is not applicable.


D.3.2.2.2.2 Triggers for charging information closure

Charging event for charging information closure, and triggers as defined in
clause 5.2.3.9.3 shall apply to the TDF, with the following exception:

  -  following Partial Record Reasons: PLMN change, RAT type, and MS time
    zone change are not applicable.


D.3.2.3.2   TDF-CDR charging information collection


D.3.2.3.2.0 Introduction

Charging information collection as defined in clause 5.2.3.9 shall apply.


D.3.2.3.2.1 TDF-CDR charging information addition

Charging information addition to TDF-CDR shall be based on charging events
received from TDF as specified in D.3.2.2.2.1.


D.3.2.3.2.2 TDF-CDR closure

CDR closure shall be based on charging event closure received from the TDF
as specified in D.3.2.2.2.2.



         D.3.2.3  CDR generation


D.3.2.3.0   General

The IPE-CDR and the TDF-CDR are generated by the Charging Data Function
(CDF) for subsequent transfer to the Charging Gateway Function (CGF).


D.3.2.3.1   IPE-CDR charging information collection


D.3.2.3.1.0 General

Charging information collection as defined in clause 5.2.3.4 shall apply,
based on charging events from IP-Edge [PCEF], with the differences that P-
GW is replaced by IP-Edge [PCEF], IP-CAN bearer is replaced by IP-CAN
session, and PGW-CDR is replaced by IPE-CDR, and in addition, when IP-CAN
session charging is active:

IPE-CDR is used to collect charging information related to traffic volumes
used within the IP-CAN session, identified per QoS.

Many traffic volume containers per QoS can be active simultaneously in IPE-
CDR.

A new traffic volume container is activated, when traffic applied with this
QoS is detected and no matching active Qos container exists.

When a change of charging condition occurs, all traffic volume containers
are added to the IPE-CDR.

When both, IP-CAN session charging and FBC are active, the same IPE-CDR is
used for collection of corresponding data.


D.3.2.3.1.1 IPE-CDR charging information addition

Charging information addition to IPE-CDR for FBC, shall be based on
charging events received from IP-Edge [PCEF] as specified in D.3.2.2.1.1.

When IP-CAN session charging is active the following behaviour shall apply:

The "List of Traffic Data Volumes" attribute of the IPE-CDR consists of a
set of containers, which are added when specific trigger conditions are
met, and identify the volume counter per QoS, separated for uplink and
downlink traffic, on encountering that trigger conditions. Table
D.3.2.3.1.1.1 identifies which conditions are supported to trigger IPE-CDR
charging information addition for the "List of Traffic Data Volumes"
attribute.

 Table D.3.2.3.1.1.1: Triggers for IPE-CDR charging information addition for
                           List of Traffic Volumes

|Trigger        |Description/Behaviour                                      |
|Conditions     |                                                           |
|End of QoS in  |The end of a Qos enforced in IP-Edge shall result in open  |
|IP-Edge        |"List of Traffic Data Volumes" containers for the QoS are  |
|               |closed and added to the CDR.                               |
|Tariff Time    |On reaching the Tariff Time Change open "List of Traffic   |
|Change         |Data Volumes" containers shall be closed and added to the  |
|               |CDR.                                                       |
|Traffic volume |A "List of Traffic Data Volumes" container for a QoS shall |
|report         |be added when:                                             |
|               |- expiry of time limit per QoS;                            |
|               |- expiry of data volume limit per QoS.                     |
|CDR Closure    |Open "List of Traffic Data Volumes" containers shall be    |
|               |closed and added to the IPE-CDR.                           |


When Charging Event (ACR) is triggered by table D.3.2.3.1.1.1 conditions,
the Change-Condition sub-field associated to the added container,
indicating the appropriate condition, shall be present, excluding CDR
Closure case.

When Charging Event (ACR) is triggered by CDR Closure condition, this
Change-Condition sub-field associated to the added container shall be
omitted, except when CDR closure is due to "maximum number of charging
condition changes", where it shall be present with the original condition
change.


D.3.2.3.1.2 IPE-CDR closure

CDR closure shall be based on charging event closure received from the IP-
Edge [PCEF] as specified in clause D.3.2.2.1.2.



D.3.2.4  Ga record transfer flows

Ga protocol applies between the Charging Data Function (CDF) and the
Charging Gateway Function (CGF).

For further details on the Ga protocol application refer to TS 32.295 [54].

Ga is not used from the IP-Edge [PCEF].


D.3.2.5  Bp CDR file transfer

The CGF transfers CDR files to the BD as specified for PCN Nodes in clause
5.2.6.

Bp is not used from the IP-Edge [PCEF].



         D.3.3  PS domain online charging scenarios


D.3.3.1  Basic principles


D.3.3.1.0   Introduction

The Chargeable events and messages contents applicable to the IP-Edge
[PCEF] and to the TDF are specified under the sub-clauses below.


D.3.3.1.1   IP-CAN session charging

IP-CAN session online charging is achieved by associating a vendor specific
rating group or combination of rating group and service id with the IP-CAN
session, such that the quota handling for the IP-CAN session shall be based
on.

The amount of data counted with IP-CAN session vendor specific rating group
or combination of rating group and service id shall be the user plane
payload. Time metering is started when IP-CAN session is activated.

Either IP-CAN session charging or FBC but not both may be active at the
same time, as determined by Charging Characteristics.


D.3.3.1.2   Flow Based bearer Charging

FBC functionality defined in clause 5.3.1.2 shall apply when provided by
the PCEF located in the IP-Edge, with specificities described below:

  -  Relates to Fixed user traffic and 3GPP UE NSWO traffic.

  -  It is applicable within the context of an IP-CAN session.

The chargeable events defined in clause 5.3.1.2, when online charging is
activated, apply with the difference that P-GW is replaced by IP-Edge
[PCEF], and IP-CAN bearer is replaced by IP-CAN session.

Change of charging condition is modified to remove conditions related to
user location change, user CSG information change, and change of UE
presence in Presence Reporting Area(s). The following are the resulting
applicable events:

  -  Change of charging condition: QoS change. When this event is
    encountered and the corresponding re-authorization trigger is armed,
    all current counts applicable to the QoS level are captured and sent
    towards the OCS with a Debit / Reserve Units Request[Update].

Following is not applicable:

  -  Network request for IP-CAN bearer activation.

The detailed PCEF behaviour associated to these chargeable events above,
are detailed below.

When applicable to the IP-Edge [PCEF], charging information included in the
PCC Rule is specified in TS 23.203 [215] Annex S.


D.3.3.1.3   TDF/Application Based Charging

TDF session and ABC functionality defined in clause 5.3.1.5 shall apply
when provided by the TDF, with specificities described below:

  -  Relates to Fixed user traffic and 3GPP UE NSWO traffic.

The chargeable events defined in clause 5.3.1.5, when online charging is
activated, apply with the difference that the following chargeable events
are not applicable:

  -  Change of charging condition: e.g. user location change,user CSG
    information change.

The detailed TDF behaviour associated to these chargeable events above, is
detailed below.


D.3.3.2  Ro message flows


D.3.3.2.0   Introduction

Charging information transfer towards the OCS as defined in clause 5.3.2
shall apply to the TDF and to the PCEF located in the IP-Edge, with the
differences that P-GW is replaced by IP-Edge [PCEF], IP-CAN bearer is
replaced by IP-CAN session, PGW-CDR is replaced by IPE-CDR and Network
requested IP-CAN bearer activation is not applicable.


D.3.3.2.1   Triggers for online charging

Triggers for FBC as defined in clause 5.3.2.2 shall apply to the PCEF
located in the IP-Edge, with the difference that P-GW is replaced by IP-
Edge [PCEF], IP-CAN bearer is replaced by IP-CAN session, and APN is not
applicable. The "Change of UE presence in Presence Reporting Area" change
of charging condition is not applicable.

Triggers for ABC online charging as defined in clause 5.3.2.2A shall apply
to the TDF.


D.3.3.2.1.1 Triggers for starting and stopping a Credit-Control session

The same triggers as defined in clause 5.3.2.2.1 shall apply to the PCEF
located in the IP-Edge, with the differences that P-GW is replaced by IP-
Edge [PCEF], IP-CAN bearer is replaced by IP-CAN session, and Network
requested IP-CAN bearer activation is not applicable.

The same triggers as defined in clause 5.3.2.2A.1 shall apply to the TDF.


D.3.3.2.1.2 Triggers for providing interim information for a Credit-Control
             session

The same triggers as defined in clause 5.3.2.2.2 shall apply to the PCEF
located in the IP-Edge, with the differences that P-GW is replaced by IP-
Edge [PCEF], IP-CAN bearer is replaced by IP-CAN session, and Network
requested IP-CAN bearer activation is not applicable.

The same triggers as defined in clause 5.3.2.2A.2 shall apply to the TDF.


D.3.3.2.2   PS Furnish Charging Information procedure

The same PS Furnish Charging Information procedure as defined in clause
5.3.1.3 shall apply to the PCEF located in the IP-Edge and to the TDF, with
the differences that P-GW is replaced by IP-Edge [PCEF], IP-CAN bearer is
replaced by IP-CAN session, and PGW-CDR is replaced by IPE-CDR.


D.3.3.2.3   Support of Failure Situations

Support of Failure Situations as defined in clause 5.3.1.4 shall apply to
the PCEF located in the IP-Edge and to the TDF, with the differences that P-
GW is replaced by IP-Edge [PCEF], IP-CAN bearer is replaced by IP-CAN
session, and PGW-CDR is replaced by IPE-CDR.



         D.4  Definition of charging information


D.4.1  Data description for PS offline charging


D.4.1.1  Rf message contents

The Offline Charging message as described in clause 6.1A shall apply to the
TDF and the PCEF located in the IP-Edge, with the differences that P-GW is
replaced by IP-Edge [PCEF], and table 6.1A.2.1.1 Service-Information is
described in D.4.3.


D.4.1.2  CDR description on the Bp interface


D.4.1.2.1   FBC IP-CAN session charging data in IP-Edge [PCEF] (IPE-CDR)

If the collection of CDR data is enabled then the IP-Edge [PCEF] data
specified in table D.4.1.2.1.1 shall be available for each IP-CAN session.

       Table D.4.1.2.1.1: IP-Edge [PCEF] IP-CAN session data (IPE-CDR)

|Field                     |Catego|Description                                |
|                          |ry    |                                           |
|Record Type               |M     |IP-Edge [PCEF] IP-CAN session record.      |
|Node ID                   |OM    |Name of the IP-Edge [PCEF].                |
|Retransmission            |OC    |This parameter, when present, indicates    |
|                          |      |that information from retransmitted        |
|                          |      |Charging Data Request has been used in this|
|                          |      |CDR.                                       |
|Served IMSI               |C     |This field holds the IMSI of the served    |
|                          |      |party, if available.                       |
|Served MN NAI             |OC    |Mobile Node Identifier in NAI format (based|
|                          |      |on IMSI), if available.                    |
|Served MSISDN             |Oc    |This field holds the MSISDN of the served  |
|                          |      |party, if available.                       |
|Served IMEI               |OC    |The IMEI or IMEISV of the UE, if available.|
|Served Fixed Subscriber Id|C     |This field holds the identity of the Fixed |
|                          |      |Device or the RG, as defined in Broadband  |
|                          |      |Forum TR 134 [601].                        |
|Access Line Identifier    |OM    |This field holds the Access line id        |
|                          |      |(physical and logical circuit ID)serving   |
|                          |      |the 3GPP UE or fixed device, behind the RG |
|                          |      |(when in bridge mode or in routed mode     |
|                          |      |without NAT), or Access line Id of the RG  |
|                          |      |when in routed mode with NAT.              |
|Fixed User Location       |OC    |This field contains the UE location in a   |
|Information               |      |fixed broadband access network. The        |
|                          |      |location of the subscriber may include     |
|                          |      |Access line id (physical and logical       |
|                          |      |circuit ID), SSID of the Access Point,     |
|                          |      |BSSID of the Access Point, defined in Annex|
|                          |      |S of TS 23.203 [215].                      |
|IP-Edge Address used      |M     |The control plane IP address of the IP-Edge|
|                          |      |used.                                      |
|IP-Edge Address IPv6      |OC    |The control plane IPv6 address, in case of |
|                          |      |IPv4v6 dual stack, of the IP-Edge used.    |
|Charging ID               |M     |IP-CAN session Charging identifier used to |
|                          |      |identify this IP-CAN session in different  |
|                          |      |records created for IP-Edge [PCEF].        |
|IP-Edge Operator          |Oc    |This field holds the PLMN identifier (MCC  |
|Identifier                |      |MNC) of the Convergent Fixed-Mobile        |
|                          |      |Operator.                                  |
|Access Point Name Network |OM    |This field holds the logical name of the   |
|Identifier                |      |connected access point to the external     |
|                          |      |packet data network (network identifier    |
|                          |      |part of APN) reflecting the "NSWO APN”,    |
|                          |      |when the served user is a 3GPP UE.         |
|IP-CAN session Type       |OM    |IPCAN session type, i.e. IPv4, IPv6, IPv4v6|
|                          |      |, or PDN type PPP.                         |
|Served IP-CAN session     |OC    |IP address allocated for the IPCAN session,|
|Address                   |      |i.e. IPv4 address when IPCAN session is    |
|                          |      |IPv4 or IPv6 prefix when IP-CAN session is |
|                          |      |IPv6 or IPv4v6.                            |
|Served IP-CAN session     |OC    |This field holds IPv4 address of the served|
|Address extension         |      |subscriber, if available, when IP-CAN      |
|                          |      |session type is IPv4v6.                    |
|Dynamic Address Flag      |OC    |Indicates whether served IP-CAN session    |
|                          |      |address is dynamic, which is allocated     |
|                          |      |during IP-CAN session activation. This     |
|                          |      |field is missing if IPv4 address is static |
|                          |      |when IP-CAN session Type is IPv4, or if    |
|                          |      |IPv6 address is static when IP-CAN session |
|                          |      |Type is IPv6 or IPv4v6.                    |
|Dynamic Address Flag      |OC    |Indicates whether served IPv4 IP-CAN       |
|extension                 |      |session address is dynamic, which is       |
|                          |      |allocated during IP-CAN session activation,|
|                          |      |with IP-CAN session type IPv4v6. This field|
|                          |      |is missing if IPv4 address is static.      |
|List of Traffic Data      |OC    |A list of changes in charging conditions   |
|Volumes                   |      |within the IP-CAN session. Each change is  |
|                          |      |time stamped. Charging conditions are used |
|                          |      |to categorize traffic volumes, such as per |
|                          |      |tariff period.                             |
|                          |      |This field includes the QoS parameters     |
|                          |      |identifying the QoS applied to traffic     |
|                          |      |volumes.                                   |
|List of Service Data      |OM    |A list of changes in charging conditions   |
|                          |      |for all service data flows within this     |
|                          |      |IP-CAN session categorized per rating group|
|                          |      |or per combination of the rating group and |
|                          |      |service id or per combination of rating    |
|                          |      |group, sponsor identity and application    |
|                          |      |service provider identity. Each change is  |
|                          |      |time stamped. Charging conditions are used |
|                          |      |to categorize traffic volumes, elapsed time|
|                          |      |and number of events, such as per tariff   |
|                          |      |period. Initial and subsequently changed   |
|                          |      |QoS and corresponding data values are also |
|                          |      |listed.                                    |
|                          |      |Online charging information (PS Furnish    |
|                          |      |Charging Information) may be added per each|
|                          |      |service data flow container in case it is  |
|                          |      |sent by the OCS.                           |
|                          |      |Failure-Handling: This field shall be      |
|                          |      |present in case IP-Edge [PCEF] triggers the|
|                          |      |Failure-Handling procedure. It shall       |
|                          |      |indicate the Failure Handling scenario and |
|                          |      |the instant the Failure Action is triggered|
|                          |      |(see annex B). Scenarios: Continue/New     |
|                          |      |Session; Continue/Ongoing Session;         |
|                          |      |Retry&Terminate/Ongoing Session;           |
|                          |      |Terminate/Ongoing Session.                 |
|Charging Characteristics  |M     |The Charging Characteristics applied to the|
|                          |      |IP-CAN session.                            |
|Charging Characteristics  |OM    |Holds information about how Charging       |
|Selection Mode            |      |Characteristics were selected.             |
|PS Furnish Charging       |OC    |Online charging session specific           |
|Information               |      |information                                |
|Record Opening Time       |M     |Time stamp when IP-CAN session is activated|
|                          |      |in this IP-Edge [PCEF] or record opening   |
|                          |      |time on subsequent partial records.        |
|Duration                  |M     |Duration of this record in the recording   |
|                          |      |entity.                                    |
|Start Time                |OC    |This field holds the time when User IP-CAN |
|                          |      |session starts,                            |
|Stop Time                 |OC    |This field holds the time when User IP-CAN |
|                          |      |session is terminated.                     |
|Cause for Record Closing  |M     |The reason for the release of record from  |
|                          |      |this IP-Edge [PCEF].                       |
|Diagnostics               |OM    |A more detailed reason for the release of  |
|                          |      |the connection.                            |
|Record Sequence Number    |C     |Partial record sequence number, only       |
|                          |      |present in case of partial records.        |
|Local Record Sequence     |OM    |Consecutive record number created by the   |
|Number                    |      |CDF, The number is unique within the CDF   |
|                          |      |and allocated sequentially for each partial|
|                          |      |CDR (or whole CDR) including all CDR types.|
|Record Extensions         |OC    |A set of network operator/manufacturer     |
|                          |      |specific extensions to the record.         |
|                          |      |Conditioned upon the existence of an       |
|                          |      |extension.                                 |








           D.4.1.2.2   Application Based Charging data in TDF (TDF-CDR)

Clause 6.1.14 shall apply, with the following two differences.

The following fields are not applicable:

             Table D.4.1.2.2.1: Fields of TDF-CDR not applicable

|Served 3GPP2 MEID        |
|Served MN NAI            |
|Serving node Address     |
|Serving node IPv6 Address|
|Serving node Type        |
|MS Time Zone             |
|APN Selection Mode       |
|Served MSISDN            |
|User Location Information|
|User CSG information     |
|3GPP2 User Location      |
|information              |
|TWAN User Location       |
|Information              |
|Serving node PLMN        |
|Identifier               |
|RAT Type                 |


The following field also exists, in addition:

                 Table D.4.1.2.2.2: TDF-CDR additional field

|Field                 |Catego|Description                                   |
|                      |ry    |                                              |
|Access Line Identifier|OC    |This field holds the Access line id (physical |
|                      |      |and logical circuit ID) serving the 3GPP UE or|
|                      |      |fixed device, behind the RG (when in bridge   |
|                      |      |mode or in routed mode without NAT), or Access|
|                      |      |line Id of the RG when in routed mode with    |
|                      |      |NAT.                                          |
|Served Fixed          |C     |This field holds the identity of the Fixed    |
|Subscriber Id         |      |Device or the RG, as defined in Broadband     |
|                      |      |Forum TR 134 [601].                           |
|Fixed User Location   |OC    |This field contains the UE location in a fixed|
|Information           |      |broadband access network. The location of the |
|                      |      |subscriber may include Access line id         |
|                      |      |(physical and logical circuit ID), SSID of the|
|                      |      |Access Point, BSSID of the Access Point,      |
|                      |      |defined in Annex S of TS 23.203 [215].        |

         D.4.2  Data description for PS online charging


D.4.2.1  Ro message contents

The Online Charging message as described in clause 6.2.1 shall apply to the
TDF and PCEF located in the IP-Edge, with the differences that P-GW is
replaced by IP-Edge [PCEF], and in table 6.2.1.2.1.1:

  -  Subscription-Id holds the subscribed Identification for 3GPP UE, or
    Subscriber ID as defined in Broadband Forum TR 134 [601] for Fixed
    Device.

  -  Service Information is described in D.4.3.


D.4.3  PS Charging specific parameters


D.4.3.1  Definition of PS charging information

The Information used for PS charging for the TDF and the IP-Edge [PCEF] is
provided in the Service Information parameter, as defined in clause
6.3.1.1, with the following difference:

  -  Subscription-Id holds the subscribed Identification for 3GPP UE, or
    Subscriber ID as defined in Broadband Forum TR 134 [601] for Fixed
    Device.

  -  PS information as defined in clause 6.3.1.2 shall be applicable to the
    TDF and the IP-Edge [PCEF], with differences that P-GW is replaced by
    IP-Edge [PCEF], IP-CAN bearer and PDN Connection are replaced by
    IP-CAN session, and also that the following fields are not applicable:



          Table D.4.3.1.1: Fields of PS Information not applicable

|Information Element    |
|PDN Connection Charging|
|Id                     |
|Serving Node Address   |
|Serving Node Type      |
|SGW Change             |
|SGW Address            |
|ePDG Address           |
|MME Number for MT SMS  |
|MME Name               |
|MME Realm              |
|NSAPI                  |
|Selection Mode         |
|Serving Node MCC MNC   |
|MS Time Zone           |
|User Location Info     |
|User CSG Information   |
|3GPP2 User Location    |
|Info                   |
|TWAN User Location     |
|Information            |
|Presence Reporting Area|
|Information            |
|RAT Type               |
|PDP Context Type       |
|Terminal Information   |
|Low Priority Indicator |


The following field exists in addition:

              Table D.4.3.1.2: PS Information additional field

|Information Element   |Catego|Description                                   |
|                      |ry    |                                              |
|Access Line Identifier|OC    |This IE holds the Access line id (physical and|
|                      |      |logical circuit ID) serving the 3GPP UE or    |
|                      |      |fixed device, behind the RG (when in bridge   |
|                      |      |mode or in routed mode without NAT), or Access|
|                      |      |line Id of the RG when in routed mode with    |
|                      |      |NAT.                                          |
|Fixed User Location   |OC    |This IE contains the UE location in a fixed   |
|Information           |      |broadband access network. The location of the |
|                      |      |subscriber may include Access line id         |
|                      |      |(physical and logical circuit ID), SSID of the|
|                      |      |Access Point, BSSID of the Access Point,      |
|                      |      |defined in Annex S of TS 23.203 [215].        |



D.4.3.2  Detailed message format for offline charging

The supported fields in table 6.3.2.1 for the PS offline charging message
shall apply to the TDF and the IP-Edge [PCEF] for the applicable fields,
with the difference that P-GW is replaced by IP-Edge [PCEF], and the table
is extended with additional table D.4.3.2.1 fields:

    Table D.4.3.2.1: Additional supported fields in Charging Data Request
                                   message

|Information Element                      |Node Type          |IP-Edge[PC|
|                                         |                   |EF]       |
|                                         |Supported Operation|S/I/S/E   |
|                                         |Types              |          |
|Service Information with PS Information                                 |
|Access Line Identifier                                       |SIS-      |
|Fixed User Location Information                              |SIS-      |





D.4.3.3  Detailed message format for online charging

The supported fields in table 6.3.3.1 for the PS online charging message
shall apply to the TDF and the IP-Edge [PCEF] for the applicable fields,
with the difference that P-GW is replaced by IP-Edge [PCEF] ,and the table
is extended with additional table D.4.3.3.1 fields:

    Table D.4.3.3.1: Additional supported fields in Debit / Reserve Units
                               Request message

|Information Element              |Node Type            |IP-Edge[PCEF|
|                                 |                     |]           |
|                                 |Supported Operation  |I/U/T/E     |
|                                 |Types                |            |
|Service Information with PS Information                            |
|Access Line Identifier                                |IUT-        |
|Fixed User Location Information                       |IUT-        |



D.4.4  Bindings for offline charging

The mapping of the Information Element,  AVP and the CDR parameter for
offline charging  as specified in clause 6.5 shall apply to IPE-CDR/TDF-CDR
parameters for applicable fields, and in addition:

  Table D.4.4.1: Additional bindings of CDR parameter, Information Element
                                   and AVP

|CDR Parameter            |Information Element      |AVP                      |
|                         |PS Information           |PS-Information           |
|Access Line Identifier   |Access Line Identifier   |Logical-Access-ID,       |
|                         |                         |Physical-Access-ID       |
|Fixed User Location      |Fixed User Location      |Fixed-User-Location-Info |
|Information              |Information              |                         |
|IP-CAN session Type      |IP-CAN session Type      |3GPP-PDP-Type            |
|IP-Edge Operator         |IP-Edge MCC MNC          |3GPP-GGSN-MCC-MNC        |
|Identifier               |                         |                         |
|IP-Edge Address used     |IP-Edge Address          |GGSN-Address             |
|IP-Edge Address IPv6     |IP-Edge Address          |GGSN-Address             |
|Served Fixed Subscriber  |Subscriber Identifier    |Subscription-Id          |
|Id                       |                         |                         |
|Served IP-CAN session    |IP-CAN session Address   |PDP-Address              |
|Address                  |                         |                         |
|Served IP-CAN session    |IP-CAN session Address   |PDP-Address              |
|Address extension        |                         |                         |



D.5  Charging Characteristics

The Charging Characteristics as specified in annex A.1 shall apply to the
IP-Edge [PCEF] and TDF with the following modification:

  -   Only configured Charging Characteristics are applicable to IP-Edge
    [PCEF] and TDF

  -  When a CGF address is included, the IP-Edge [PCEF] shall apply it for
    the IPE-CDRs

  -  A set of trigger associated to IPE-CDR may be: activate/deactivate
    CDRs, time limit, volume limit, maximum number of charging conditions,
    tariff times, and an example is provided by Table A.1.3 with P-GW
    replaced by IP-Edge [PCEF].

  -  Charging Characteristics behaviour in IP-Edge [PCEF] is used for IPE-
    CDR generation and for online charging

  -  Default charging method negotiation between the PGW and the PCRF shall
    apply with P-GW replaced by IP-Edge [PCEF] and IP-CAN bearer replaced
    by IP-CAN session.

    -  The following may be selected by the IP-Edge [PCEF] or TDF for
       charging behaviour, as appropriate:-  The Home behaviour, for 3GPP UE
       belonging to same PLMN as the IP-Edge [PCEF] or TDF respectively.

    -  The Visiting behaviour, for 3GPP UE belonging to a different PLMN
       than the IP-Edge [PCEF] or TDF respectively.

    -  The Fixed behaviour for Fixed users.





Annex E (Informative):
Inter-PLMN dedicated profile


E.1  General

This annex provides a profile description for PS domain  online charging in
a roaming context, targeting IOT simplification between Operators, while
allowing accurate charging models for data usage. GSMA defined RCS
services, Video over LTE, some Internet's application (e.g. Peer to Peer
etc.) requiring online charging control of data usage in roaming are
examples of the use cases for deployment of such dedicated profile.

This profile relies on a sub-set of capabilities amongst all those defined
within this specification for PS domain  online charging. Information to be
exchanged over Gy and over Gyn is provided as a sub-set of the full message
content.

A dedicate profile is designed for each of the following reference points:


  -  Gy between OCS residing in HPLMN and PCEF located in PGW VPLMN, as per
    Evolved 3GPP Packet Switched Domain Roaming Architecture for local
    breakout defined in TS 23.401 [208].

  -  Gy between OCS residing in HPLMN and PCEF located in IP-Edge fixed
    broadband access owned by a Convergent fixed-mobile VPLMN, for Non
    Seamless WLAN Offload (NSWO) 3GPP UEs traffic defined by annex S of TS
    23.203 [215].

  -  Gyn between OCS residing in HPLMN and TDF located in VPLMN for Local
    Breakout Roaming, as per "Overall PCC architecture for roaming with
    PCEF in visited network (local breakout)" defined in TS 23.203[72].

  -  Gyn between OCS residing in HPLMN and TDF owned by a Convergent fixed-
    mobile VPLMN, for Non Seamless WLAN Offload (NSWO) 3GPP UEs traffic
    defined by annex S of TS 23.203 [215].





E.2  Principles

The following principles apply:

  -  Session charging with Unit Reservation (SCUR) with Centralized Unit
    Determination and Centralized Rating.

  -  Categorization of service data flows and of detected applications
    traffic is achieved by rating groups only.


E.3  Message content


E.3.1  General

  This clause describes the messages content applicable for PS domain
    inter-PLMN online charging, based on the messages content specified in
    this document and in TS 32.299 [50].

  Information Elements are provided with explicit description when
    specific, and indicated as grey with "Not part of inter-PLMN" to
    reflect the Information Element is not part of the dedicated profile.

Information Elements indicated as grey with "Not used in 3GPP", or "Not
used Debit / Reserve Units Request message" or "Not used Debit / Reserve
Units Answer message" are not part of the message content from the original
definition.


E.3.2  Debit / Reserve Units messages

The Debit / Reserve Units Request message basic structure in table
6.2.1.2.1.1 with the detailed description for Multiple Unit Operation
provided by the table E.3.1 is applicable to inter-PLMN.

  Table E.3.1: Structure of the Multiple Unit Operation in message request
                               for inter-PLMN

|Information Element       |Catego|Description                              |
|                          |ry    |                                         |
|Multiple Unit Operation   |OC    |As specified in TS 32.299 [50].          |
| Granted Service Unit     |-     |Not used in Debit / Reserve Units Request|
|                          |      |message.                                 |
| Requested Service Unit   |OC    |Sent as empty.                           |
|  CC Time                 |-     |Not part of inter-PLMN profile.          |
|  CC Money                |-     |Not used in 3GPP.                        |
|  CC Total Octets         |-     |Not part of inter-PLMN profile.          |
|  CC Input Octets         |-     |Not part of inter-PLMN profile.          |
|  CC Output Octets        |-     |Not part of inter-PLMN profile.          |
|  CC Service Specific     |-     |Not part of inter-PLMN profile.          |
|Units                     |      |                                         |
|  AVP                     |-     |Not used in 3GPP.                        |
| Used Service Unit        |OC    |As specified in TS 32.299 [50].          |
|  Reporting Reason        |OC    |As specified in TS 32.299 [50].          |
|  Tariff Change Usage     |-     |Not part of inter-PLMN profile.          |
|  CC Time                 |OC    |As specified in TS 32.299 [50].          |
|  CC Money                |-     |Not used in 3GPP.                        |
|  CC Total Octets         |OC    |As specified in TS 32.299 [50].          |
|  CC Input Octets         |OC    |As specified in TS 32.299 [50].          |
|  CC Output Octets        |OC    |As specified in TS 32.299 [50].          |
|  CC Service Specific     |-     |Not part of inter-PLMN profile.          |
|Units                     |      |                                         |
|  Event Charging TimeStamp|-     |Not part of inter-PLMN profile.          |
|  AVP                     |-     |Not used in 3GPP.                        |
| Tariff Change Usage      |-     |Not used in 3GPP.                        |
| Service Identifier       |-     |Not part of inter-PLMN profile.          |
| Rating Group             |OC    |As specified in TS 32.299 [50].          |
| G-S-U Pool Reference     |-     |Not used in Debit / Reserve Units Request|
|                          |      |message.                                 |
| Validity Time            |-     |Not used in Debit / Reserve Units Request|
|                          |      |message.                                 |
| Operation Result         |-     |Not used in Debit / Reserve Units Request|
|                          |      |message.                                 |
| Final Unit Indication    |-     |Not used in Debit / Reserve Units Request|
|                          |      |message.                                 |
| Time Quota Threshold     |-     |Not used in Debit / Reserve Units Request|
|                          |      |message.                                 |
| Volume Quota Threshold   |-     |Not used in Debit / Reserve Units Request|
|                          |      |message.                                 |
| Unit Quota Threshold     |-     |Not used in Debit / Reserve Units Request|
|                          |      |message.                                 |
| Quota Holding Time       |-     |Not used in Debit / Reserve Units Request|
|                          |      |message.                                 |
| Quota Consumption Time   |-     |Not used in Debit / Reserve Units Request|
|                          |      |message.                                 |
| Reporting Reason         |OC    |As specified in TS 32.299 [50].          |
| Trigger                  |OC    |As specified in TS 32.299 [50].          |
|PS-Furnish-Charging-Inform|      |Not used in Debit / Reserve Units Request|
|ation                     |      |message.                                 |
| Refund Information       |-     |Not part of inter-PLMN profile.          |
| AF Correlation           |OC    |As specified in TS 32.299 [50].          |
|Information               |      |                                         |
| Envelope                 |-     |Not part of inter-PLMN profile.          |
| Envelope Reporting       |-     |Not part of inter-PLMN profile.          |
| Time Quota Mechanism     |-     |Not part of inter-PLMN profile.          |
| Service Specific Info    |-     |Not part of inter-PLMN profile.          |
| QoS-Information          |OC    |As specified in TS 32.299 [50].          |


The Debit / Reserve Units Response message basic structure in table E.3.2
(as replacement of table 6.2.1.2.2.1) with the detailed description for
Multiple Unit Operation provided by the table E.3.3 is applicable to inter-
PLMN.

 Table E.3.2: Debit / Reserve Units Response message content for inter-PLMN

|Information Element      |Category |Description        |
|Session Identifier       |M        |Described in 32.299|
|                         |         |[50]               |
|Operation Result         |M        |Described in 32.299|
|                         |         |[50]               |
|Originator Host          |M        |Described in 32.299|
|                         |         |[50]               |
|Originator Domain        |M        |Described in 32.299|
|                         |         |[50]               |
|Operation Identifier     |M        |Described in 32.299|
|                         |         |[50]               |
|Operation Type           |M        |Described in 32.299|
|                         |         |[50]               |
|Operation Number         |M        |Described in 32.299|
|                         |         |[50]               |
|Operation Failover       |OC       |Described in 32.299|
|                         |         |[50]               |
|Multiple Unit Operation  |OC       |Described in 32.299|
|                         |         |[50]               |
|Operation Failure Action |OC       |Described in 32.299|
|                         |         |[50]               |
|Operation Event Failure  |-        |Not part of        |
|Action                   |         |inter-PLMN profile.|
|Redirection Host         |OC       |Described in 32.299|
|                         |         |[50]               |
|Redirection Host Usage   |OC       |Described in 32.299|
|                         |         |[50]               |
|Route Information        |OC       |Described in 32.299|
|                         |         |[50]               |
|Failed parameter         |OC       |Described in 32.299|
|                         |         |[50]               |
|Service Information      |OM       |Described in 32.299|
|                         |         |[50]               |


  Table E.3.3: Structure of the Multiple Unit Operation in message response
                               for inter-PLMN

|Information Element     |Catego|Description                                |
|                        |ry    |                                           |
|Multiple Unit Operation |OC    |As specified in TS 32.299 [50].            |
| Granted Service Unit   |OC    |As specified in TS 32.299 [50].            |
|  Tariff Time Change    |-     |Not part of inter-PLMN profile.            |
|  CC Time               |OC    |As specified in TS 32.299 [50].            |
|  CC Money              |-     |Not used in 3GPP.                          |
|  CC Total Octets       |OC    |As specified in TS 32.299 [50].            |
|  CC Input Octets       |OC    |As specified in TS 32.299 [50].            |
|  CC Output Octets      |OC    |As specified in TS 32.299 [50].            |
|  CC Service Specific   |-     |Not part of inter-PLMN profile.            |
|Units                   |      |                                           |
|  AVP                   |-     |Not used in 3GPP.                          |
| Requested Service Unit |-     |Not used in Debit / Reserve Units Answer   |
|                        |      |message.                                   |
| Used Service Unit      |-     |Not used in Debit / Reserve Units Answer   |
|                        |      |message.                                   |
| Tariff Change Usage    |-     |Not used in 3GPP.                          |
| Service Identifier     |-     |Not part of inter-PLMN profile.            |
| Rating Group           |OC    |As specified in TS 32.299 [50].            |
| G-S-U Pool Reference   |-     | Not part of inter-PLMN profile.           |
| Validity Time          |OC    |As specified in TS 32.299 [50].            |
| Operation Result       |OC    |As specified in TS 32.299 [50].            |
| Final Unit Indication  |OC    |As specified in TS 32.299 [50].            |
|  Final Unit Action     |M     |As specified in TS 32.299 [50].            |
|  Restriction Filter    |-     |Not part of inter-PLMN profile.            |
|Rule                    |      |                                           |
|  Filter Id             |-     |Not part of inter-PLMN profile.            |
|  Redirect Server       |OC    |As specified in TS 32.299 [50].            |
|   Redirect Address Type|M     |As specified in TS 32.299 [50].            |
|   Redirect Server      |M     |As specified in TS 32.299 [50].            |
|Address                 |      |                                           |
| Time Quota Threshold   |OC    |As specified in TS 32.299 [50].            |
| Volume Quota Threshold |OC    |As specified in TS 32.299 [50].            |
| Unit Quota Threshold   |-     |Not part of inter-PLMN profile.            |
| Quota Holding Time     |OC    |As specified in TS 32.299 [50].            |
| Quota Consumption Time |OC    |As specified in TS 32.299 [50].            |
| Reporting Reason       |-     |Not used in Debit / Reserve Units Answer   |
|                        |      |message.                                   |
| Trigger                |Oc    |As specified in TS 32.299 [50].            |
|  Trigger Type          |OC    |As specified in TS 32.299 [50].            |
| PS Furnish Charging    |-     |Not part of inter-PLMN profile.            |
|Information             |      |                                           |
| Refund Information     |-     |Not part of inter-PLMN profile.            |
| AF Correlation         |-     |Not used in Debit / Reserve Units Answer   |
|Information             |      |message.                                   |
| Envelope Reporting     |-     |Not part of inter-PLMN profile.            |
| Time Quota Mechanism   |-     |Not part of inter-PLMN profile.            |
| Service Specific Info  |-     |Not used in Debit / Reserve Units Answer   |
|                        |      |message.                                   |
| Qos Information        |-     |Not used in Debit / Reserve Units Answer   |
|                        |      |message.                                   |
| AVP                    |-     |Not used in 3GPP.                          |



E.3.3  Re-authorization triggers

The applicable triggers for quota re-authorization to be requested from the
PGW /TDF are:

  -  "Ro specific chargeable event" triggers occurring with reporting-
    reason:  THRESHOLD, QHT, FINAL, QUOTA_EXHAUSTED, VALIDITY_TIME,
    FORCED_REAUTHORISATION.

  -   Specific trigger types occuring with reporting-reason
    RATING_CONDITION_CHANGE: CHANGE_IN_QOS, CHANGE_IN_RAT,
    CHANGE_IN_SERVICE_CONDITION.





E.3.4  Service information used for PS charging

The components in the Service Information in table 6.3.1.1.1 with PS
information provided in table E.3.4.1 are applicable to inter-PLMN.


        Table E.3.4.1: Structure of the PS Information for inter-PLMN

|Information Element       |Catego|Description                               |
|                          |ry    |                                          |
|Charging Id               |OC    |As specified in table 6.3.1.2.1           |
|Node Id                   |-     |Not part of inter-PLMN profile.           |
|PDN Connection Charging Id|OC    |As specified in table 6.3.1.2.1           |
|PDP/PDN Type              |OC    |As specified in table 6.3.1.2.1           |
|PDP/PDN Address           |OC    |As specified in table 6.3.1.2.1           |
|PDP/PDN Address prefix    |OC    |As specified in table 6.3.1.2.1           |
|length                    |      |                                          |
|Dynamic Address Flag      |-     |Not part of inter-PLMN profile.           |
|Dynamic Address Flag      |-     |Not part of inter-PLMN profile.           |
|Extension                 |      |                                          |
|Negotiated QoS Profile    |OC    |As specified in table 6.3.1.2.1           |
|Serving Node Address      |-     |Not part of inter-PLMN profile.           |
|Serving Node Type         |-     |Not part of inter-PLMN profile.           |
|SGW Change                |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|PGW Address               |OC    |As specified in table 6.3.1.2.1           |
|TDF Address               |-     |As specified in table 6.3.1.2.1.          |
|                          |      |Applicable only in case of TDF Iinter-PLMN|
|                          |      |application based charging.               |
|SGW Address               |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|ePDG Address              |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|MME Number for MT SMS     |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|MME Name                  |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|MME Realm                 |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|CG Address                |-     |Not part of inter-PLMN profile.           |
|IMSI MCC MNC              |OC    |As specified in table 6.3.1.2.1           |
|IMSI Unauthenticated Flag |-     |Not part of inter-PLMN profile.           |
|PGW MCC MNC               |OC    |As specified in table 6.3.1.2.1           |
|TDF MCC MNC               |-     |As specified in table 6.3.1.2.1.          |
|                          |      |Applicable only in case of TDF Inter-PLMN |
|                          |      |application based charging.               |
|NSAPI                     |-     |Not part of inter-PLMN profile.           |
|Called Station Id         |OC    |As specified in table 6.3.1.2.1           |
|Session Stop Indicator    |OC    |As specified in table 6.3.1.2.1           |
|Selection Mode            |OC    |As specified in table 6.3.1.2.1           |
|Charging Characteristics  |-     |Not part of inter-PLMN profile.           |
|Charging Characteristics  |-     |Not part of inter-PLMN profile.           |
|Selection Mode            |      |                                          |
|Serving Node MCC MNC      |-     |Not part of inter-PLMN profile.           |
|CN Operator Selection     |-     |Not part of inter-PLMN profile.           |
|Entity                    |      |                                          |
|MS Time Zone              |OC    |As specified in table 6.3.1.2.1           |
|Charging Rule Base Name   |-     |Not part of inter-PLMN profile.           |
|ADC Rule Base Name        |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|User Location Info        |OC    |As specified in table 6.3.1.2.1           |
|User Location Info Time   |-     |Not part of inter-PLMN profile.           |
|User CSG Information      |-     |Not part of inter-PLMN profile.           |
|3GPP2 User Location Info  |-     |Not part of inter-PLMN profile.           |
|TWAN User Location        |-     |Not part of inter-PLMN profile.           |
|Information               |      |                                          |
|Presence Reporting Area   |-     |Not part of inter-PLMN profile.           |
|Information               |      |                                          |
|RAT Type                  |OC    |As specified in table 6.3.1.2.1           |
|Furnish Charging          |-     |Not part of Debit / Reserve Units         |
|Information               |      |Messages.                                 |
|Offline Charging          |-     |Not part of inter-PLMN profile.           |
|PDP Context Type          |-     |Not part of inter-PLMN profile.           |
|Traffic data volumes      |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|Service data container    |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|User Equipment Info       |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|Terminal Information      |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|Start Time                |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|Stop Time                 |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|Change Condition          |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |
|Diagnostics               |-     |Not part of inter-PLMN profile.           |
|Low Priority Indicator    |-     |Not part of Debit / Reserve Units         |
|                          |      |Messages.                                 |





E.4  Fixed broadband access

PS domain  online charging performed from a HPLMN OCS for 3GPP UE non-
seamless WLAN offload traffic, when served by an IP-Edge [PCEF] or by a TDF
owned by a Convergent fixed-mobile VPLMN, can also use a dedicated profile
for interoperability simplification.

The dedicated profile to be used in this scenario is the same as the
dedicated profile defined by clauses E.2, and E.3 with following
differences:

  -  P-GW is replaced by IP-Edge [PCEF]

  -  Clause E.3.3 re-authorization specific trigger type CHANGE_IN_RAT is
    not applicable.

  -  Table E.3.4.1:  MS Time Zone, User Location Info and RAT Type are not
    applicable.

  -  Below table E.4.1 applies in addition:

         Table E.4.1: PS Information additional field for inter-PLMN

|Information Element   |Catego|Description                     |
|                      |ry    |                                |
|Access Line Identifier|OC    |As specified in table D.4.3.1.2 |
|Fixed User Location   |OC    |As specified in table D.4.3.1.2 |
|Information           |      |                                |




Annex F (informative):
Change history

|Change history                                                                      |
|Date                                                                      |


 Date |Meeting |TDoc |CR |Rev |Cat |Subject/Comment |New version | |2016-06
|SA#72 |SP-160416 |0459 |- |F |Inclusion of service data flows as an
identifier of application related information for TDF - align with TS
23.203 |13.5.0 | |2016-06 |SA#72 |SP-160420 |0460 |- |F |Remove Editor’s
   note regarding “PDN connection charging identifier” |13.5.0 | |2016-06
    |SA#72 |SP-160415 |0462 |1 |A |Correction for QoS information in FBC
|13.5.0 | |2016-06 |SA#72 |SP-160420 |0465 |2 |B |Enhancement of charging
 ID description in TDF CDR |13.5.0 | |2016-06 |SA#72 |SP-160420 |0467 |- |B
   |Completion of access change of service data flow for NBIFOM |13.5.0 |
|2016-06 |SA#72 |SP-160420 |0468 |1 |B |Completion of change of charging
condition for NBIFOM |13.5.0 | |2016-06 |SA#72 |SP-160420 |0469 |- |B
|Remove Editor’s note regarding access network charging identifier for
NBIFOM |13.5.0 | |2016-06 |SA#72 |SP-160411 |0471 |1 |B |Introduce Control
 Plane CIoT EPS Optimisation and CIoT RAT in PS charging |13.5.0 | |2016-06
|SA#72 |SP-160411 |0472 |1 |B |Introduce PS charging for Non-IP data PDN
connection |13.5.0 | |2016-09 |SA#73 |SP-160621 |0475 |1 |F |Correction on
 Non-IP PDP type - alignement with TS 29.061 |13.6.0 | |2016-09 |SA#73 |SP-
 160622 |0476 |1 |F |Correction on RAT Type for charging SMS in MME |13.6.0
| |2016-09 |SA#73 |SP-160621 |0477 |1 |F |Correction on Control Plane CIoT
 EPS Optimisation Indicator in PGW - alignement with 23.401 |13.6.0 | |2016-
09 |SA#73 |SP-160621 |0479 |1 |F |Correction on "MO exception data" RRC
 establishment cause in offline charging – alignement with TS 23.401 |13.6.0
| |2016-09 |SA#73 |SP-160623 |0473 |1 |B |Complement of Charging per IP-CAN
Session |14.0.0 | |2016-09 |SA#73 |SP-160623 |0478 |1 |F |Correction on the
general description for service data flows charging |14.0.0 | |2016-10 | |
| | | |Fix of cover page in Draft mode (MCC) |14.0.1 | |2016-12 |SA#74 |SP-
 160844 |0480 |1 |B |Addition of charging support for Mulitiple PRAs |14.1.0
| |2016-12 |SA#74 |SP-160849 |0482 |- |B |Introduction of Gy session
optimization based on unused quota timer |14.1.0 | |2017-03 |SA#75 |SP-
   170144 |0483 |1 |B |Charging enhancement for 3GPP PS Data off |14.2.0 |
  |2017-03 |SA#75 |SP-170129 |0484 |1 |B |Addition of the triggers for AULC
|14.2.0 | |2017-03 |SA#75 |SP-170129 |0485 |1 |B |Addition on the
  description of UE Presence in Presence Reporting Areas |14.2.0 | |2017-03
  |SA#75 |SP-170134 |0487 |1 |B |Definition of Unused Quota timer |14.2.0 |
    |2017-03 |SA#75 |SP-170138 |0488 |1 |C |Remove reference to RFC 3588
|14.2.0 | |2017-03 |SA#75 |SP-170132 |0489 |1 |B |Improve binding table for
EPC charging |14.2.0 | |2017-06 |SA#76 |SP-170499 |0490 |1 |B |Addition of
the subscription operation for AULC |14.3.0 | |2017-06 |SA#76 |SP-170501
   |0491 |1 |B |Additional charging trigger for 3GPP PS Data off |14.3.0 |
|2017-06 |SA#76 |SP-170495 |0492 |- |B |Adding possiblity for OCS to
 influence Unused Quota Timer |14.3.0 | |2017-06 |SA#76 |SP-170500 |0494 |1
 |B |Introduce MSISDN-less SMS MO via T4 charging |14.3.0 | |2017-06 |SA#76
   |SP-170499 |0495 |1 |B |Deletion of the AULC support from TDF |14.3.0 |
   |2017-09 |SA#77 |SP-170650 |0498 |1 |B |Charging enhancement for eFMSS
|15.0.0 | |2018-01 |SA#78 |SP-170966 |0499 |1 |B |Data Volume Reporting for
Secondary RAT usage |15.1.0 | |2018-01 |SA#78 |SP-170970 |0500 |1 |B
|Bindings of eFMSS for EPC offline charging |15.1.0 | |2018-01 |SA#78 |SP-
 170970 |0501 |1 |B |Charging enhancement on TDF for eFMSS |15.1.0 | |2018-
03 |SA#79 |SP-180062 |0502 |1 |B |Support for secondary RAT in offline
charging |15.2.0 | |2018-06 |SA#80 |SP-180427 |0503 |1 |B |Enhance location
information in trusted and untrusted WLAN |15.3.0 | |2018-06 |SA#80 |SP-
 180427 |0504 |- |B |Introduce Emergency services over WLAN |15.3.0 | |2018-
  06 |SA#80 |SP-180428 |0505 |1 |B |Introduce Supported Features mechanism
|15.3.0 | |2018-12 |SA#82 |SP-181041 |0506 |1 |F |Correction in OCS
subscription to multiple PRA(s) |15.4.0 | |2018-12 |SA#82 |SP-181041 |0507
 |1 |F |Correction on multiple PRA(s) in offline charging  |15.4.0 | |2018-
12 |SA#82 |SP-181053 |0508 |1 |F |Correction of Supported Feature for EDCE5-
CH |15.4.0 | |2018-12 |SA#82 |SP-181054 |0510 |2 |A |Correction of Data
Volume Uplink and Downlink definition |15.4.0 | |2018-12 |SA#82 |SP-181041
|0511 |1 |F |PRA Charging Clarification |15.4.0 | |2018-12 |SA#82 |SP-
  181041 |0512 |1 |F |Multi-PRAs charging clarification |15.4.0 | |2019-06
|SA#84 |SP-190379 |0513 |1 |F |Adding Rate-Control information and triggers
|15.5.0 | |

-----------------------












Bp















PS Domain







PCN







BS







Bp















PCN







CGF







Ga







Bp















PCN







CGF







Ga







CDF/CGF







CDF







CDF







Billing

Domain











PCN







CDF







CGF







Ga







Bp



























CTF







CDF/CGF



Rf



PCN





