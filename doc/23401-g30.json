[{"key": "Scope", "numbering": "1", "title_level": 0, "desc": "         1  Scope\n\nThe present document defines the Stage\u00c2\u00a02 service description for the\nEvolved 3GPP Packet Switched Domain - also known as the Evolved Packet\nSystem (EPS) in this document. The Evolved 3GPP Packet Switched Domain\nprovides IP connectivity using the Evolved Universal Terrestrial Radio\nAccess Network (E-UTRAN).\n\nThe specification covers both roaming and non-roaming scenarios and covers\nall aspects, including mobility between E-UTRAN and pre-E-UTRAN 3GPP radio\naccess technologies, policy control and charging, and authentication.\n\nThe Radio Access Network functionality is documented only to the extent\nnecessary to describe the overall system. TS\u00c2\u00a036.300\u00c2\u00a0[5] contains the\noverall description of the Evolved Universal Terrestrial Radio Access (E-\nUTRA) and Evolved Universal Terrestrial Radio Access Network (E-UTRAN).\n\nITU-T Recommendation I.130\u00c2\u00a0[3] describes a three-stage method for\ncharacterisation of telecommunication services, and ITU-T Recommendation\nQ.65\u00c2\u00a0[4] defines Stage\u00c2\u00a02 of the method.\n\nTS\u00c2\u00a023.402\u00c2\u00a0[2] is a companion specification to this specification.\n\nAn Evolved Packet System architecture optimised for the support of Cellular\nIoT (Internet of Things) applications is also defined in this document.\n\nThe Evolved Packet System also provides support for the E-UTRAN to control\na Dual Connectivity radio connection that uses a combination of E-UTRA and\nanother radio access technology (e.g. NR). TS\u00c2\u00a036.300\u00c2\u00a0[5] contains the\noverall description for Dual Connectivity.\n\nEnhancements to support interworking of EPS with 5GS are captured in\nTS\u00c2\u00a023.501\u00c2\u00a0[83] and TS\u00c2\u00a023.502\u00c2\u00a0[84].\n\n\n"}, {"key": "References", "numbering": "2", "title_level": 0, "desc": "2  References\n\nThe following documents contain provisions which, through reference in this\ntext, constitute provisions of the present document.\n\n  -  References are either specific (identified by date of publication,\n    edition number, version number, etc.) or non-specific.\n\n  -  For a specific reference, subsequent revisions do not apply.\n\n  -  For a non-specific reference, the latest version applies. In the case\n    of a reference to a 3GPP document (including a GSM document), a non-\n    specific reference implicitly refers to the latest version of that\n    document in the same Release as the present document.\n\n  [1]  3GPP\u00c2\u00a0TR\u00c2\u00a021.905: \"Vocabulary for 3GPP Specifications\".\n\n  [2]  3GPP\u00c2\u00a0TS\u00c2\u00a023.402: \"Architecture enhancements for non-3GPP accesses\".\n\n  [3]  ITU-T Recommendation\u00c2\u00a0I.130: \"Method for the characterization of\n             telecommunication services supported by an ISDN and network\n             capabilities of an ISDN\".\n\n  [4]  ITU-T Recommendation\u00c2\u00a0Q.65: \"The unified functional methodology for\n             the characterization of services and network capabilities\".\n\n  [5]  3GPP\u00c2\u00a0TS\u00c2\u00a036.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA)\n             and Evolved Universal Terrestrial Radio Access Network (E-\n             UTRAN); Overall description; Stage 2\".\n\n  [6]  3GPP\u00c2\u00a0TS\u00c2\u00a023.203: \"Policy and charging control architecture\".\n\n  [7]  3GPP\u00c2\u00a0TS\u00c2\u00a023.060: \"General Packet Radio Service (GPRS); Service\n             description; Stage\u00c2\u00a02\".\n\n  [8]  3GPP\u00c2\u00a0TS\u00c2\u00a043.129: \"Packet-switched handover for GERAN A/Gb mode;\n             Stage\u00c2\u00a02\".\n\n  [9]  3GPP\u00c2\u00a0TS\u00c2\u00a023.003: \"Numbering, addressing and identification\".\n\n  [10] 3GPP\u00c2\u00a0TS\u00c2\u00a023.122: \"Non-Access-Stratum (NAS) functions related to\n             Mobile Station in idle mode\".\n\n  [11] 3GPP\u00c2\u00a0TS\u00c2\u00a043.022: \"Functions related to MS in idle mode and group\n             receive mode\".\n\n  [12] 3GPP\u00c2\u00a0TS\u00c2\u00a025.304: \"UE procedures in idle mode and procedures for cell\n             re-selection in connected mode\".\n\n  [13] 3GPP\u00c2\u00a0TS\u00c2\u00a023.246: \"Multimedia Broadcast/Multicast Service (MBMS);\n             Architecture and functional description\".\n\n  [14] 3GPP\u00c2\u00a0TS\u00c2\u00a029.060: \"GPRS Tunnelling Protocol (GTP) across the Gn and Gp\n             interface\".\n\n  [15] 3GPP\u00c2\u00a0TS\u00c2\u00a043.051: \"GERAN Overall description - Stage\u00c2\u00a02\".\n\n  [16] 3GPP\u00c2\u00a0TS\u00c2\u00a025.401: \"UTRAN overall description\".\n\n  [17] IETF\u00c2\u00a0RFC\u00c2\u00a01034 (1987): \"Domain names \u00e2\u20ac\u201c concepts and facilities\" (STD\n             13).\n\n  [18] IETF\u00c2\u00a0RFC\u00c2\u00a04862: \"IPv6 Stateless Address Autoconfiguration\".\n\n  [19] IETF\u00c2\u00a0RFC\u00c2\u00a02131: \"Dynamic Host Configuration Protocol\".\n\n  [20] IETF\u00c2\u00a0RFC\u00c2\u00a03736: \"Stateless Dynamic Host Configuration Protocol (DHCP)\n             Service for IPv6\".\n\n  [21] IETF\u00c2\u00a0RFC\u00c2\u00a03633: \"IPv6 Prefix Options for Dynamic Host Configuration\n             Protocol (DHCP) version 6\".\n\n  [22] 3GPP\u00c2\u00a0TS\u00c2\u00a025.413: \"UTRAN Iu interface Radio Access Network Application\n             Part (RANAP) signalling\".\n\n  [23] 3GPP\u00c2\u00a0TS\u00c2\u00a044.064: \"Mobile Station - Serving GPRS Support Node (MS-\n             SGSN); Logical Link Control (LLC) Layer Specification\".\n\n  [24] 3GPP\u00c2\u00a0TS\u00c2\u00a023.251: \"Network Sharing; Architecture and functional\n             description\".\n\n  [25] IETF\u00c2\u00a0RFC\u00c2\u00a04039: \"Rapid Commit Option for the Dynamic Host\n             Configuration Protocol version 4 (DHCPv4)\".\n\n  [26] IETF\u00c2\u00a0RFC\u00c2\u00a0768: \"User Datagram Protocol\".\n\n  [27] 3GPP\u00c2\u00a0TS\u00c2\u00a023.221: \"Architectural requirements\".\n\n  [28] 3GPP\u00c2\u00a0TS\u00c2\u00a023.008: \"Organization of subscriber data\".\n\n  [29] 3GPP\u00c2\u00a0TS\u00c2\u00a023.078: \"Customized Applications for Mobile network Enhanced\n             Logic (CAMEL) Phase X; Stage\u00c2\u00a02\".\n\n  [30] 3GPP\u00c2\u00a0TS\u00c2\u00a023.236: \"Intra-domain connection of Radio Access Network\n             (RAN) nodes to multiple Core Network (CN) nodes\".\n\n  [31] IETF\u00c2\u00a0RFC\u00c2\u00a03588: \"Diameter Base Protocol\".\n\n  [32] IETF\u00c2\u00a0RFC\u00c2\u00a04861: \"Neighbor Discovery for IP Version 6 (IPv6)\".\n\n  [33] 3GPP\u00c2\u00a0TS\u00c2\u00a025.331: \"Radio Resource Control (RRC); Protocol\n             Specification\".\n\n  [34] 3GPP\u00c2\u00a0TS\u00c2\u00a036.304: \"Evolved Universal Terrestrial Radio Access (E-\n             UTRA); User Equipment (UE) procedures in idle mode\".\n\n  [35] IETF\u00c2\u00a0RFC\u00c2\u00a04960: \"Stream Control Transmission Protocol\".\n\n  [36] 3GPP\u00c2\u00a0TS\u00c2\u00a036.413: \"Evolved Universal Terrestrial Access Network (E-\n             UTRAN); S1 Application Protocol (S1AP)\".\n\n  [37] 3GPP\u00c2\u00a0TS\u00c2\u00a036.331: \"Evolved Universal Terrestrial Radio Access (E-\n             UTRA); Radio Resource Control (RRC); Protocol specification\".\n\n  [38] 3GPP\u00c2\u00a0TS\u00c2\u00a029.061: \"Interworking between the Public Land Mobile Network\n             (PLMN) supporting packet based services and Packet Data\n             Networks (PDN)\".\n\n  [39] Void.\n\n  [40] 3GPP\u00c2\u00a0TS\u00c2\u00a033.102: \"3G Security; Security architecture\".\n\n  [41] 3GPP\u00c2\u00a0TS\u00c2\u00a033.401: \"3GPP System Architecture Evolution: Security\n             Architecture\".\n\n  [42] 3GPP\u00c2\u00a0TS\u00c2\u00a048.018: \"General Packet Radio Service (GPRS); Base Station\n             System (BSS) - Serving GPRS Support Node (SGSN); BSS GPRS\n             Protocol (BSSGP)\".\n\n  [43] 3GPP\u00c2\u00a0TS\u00c2\u00a029.274: \"3GPP Evolved Packet System (EPS); Evolved General\n             Packet Radio Service (GPRS) Tunnelling Protocol for Control\n             plane (GTPv2-C); Stage 3\".\n\n  [44] 3GPP\u00c2\u00a0TS\u00c2\u00a032.251: \"Telecommunication management; Charging management;\n             Packet Switched (PS) domain charging\".\n\n  [45] 3GPP\u00c2\u00a0TS\u00c2\u00a024.007: \"Mobile radio interface signalling layer 3; General\n             aspects\".\n\n  [46] 3GPP\u00c2\u00a0TS\u00c2\u00a024.301: \"Non-Access-Stratum (NAS) protocol for Evolved\n             Packet System (EPS); Stage\u00c2\u00a03\".\n\n  [47] 3GPP\u00c2\u00a0TS\u00c2\u00a024.008: \"Mobile Radio Interface Layer 3 specification; Core\n             Network Protocols; Stage\u00c2\u00a03\".\n\n  [48] 3GPP\u00c2\u00a0TS\u00c2\u00a023.041: \"Technical realization of Cell Broadcast Service\n             (CBS)\".\n\n  [49] 3GPP\u00c2\u00a0TS\u00c2\u00a022.042: \"Network Identity and Time Zone (NITZ) service\n             description; Stage\u00c2\u00a01\".\n\n  [50] Void.\n\n  [51] 3GPP\u00c2\u00a0TS\u00c2\u00a032.240: \"Charging architecture and principles\".\n\n  [52] 3GPP\u00c2\u00a0TS\u00c2\u00a023.228: \"IP Multimedia Subsystem (IMS); Stage 2\".\n\n  [53] 3GPP\u00c2\u00a0TS\u00c2\u00a024.285: \"Allowed Closed Subscriber Group (CSG) List;\n             Management Object (MO)\".\n\n  [54] 3GPP\u00c2\u00a0TS\u00c2\u00a023.261: \"IP flow mobility and seamless Wireless Local Area\n             Network (WLAN) offload; Stage 2\".\n\n  [55] IETF\u00c2\u00a0RFC\u00c2\u00a03168: \"The Addition of Explicit Congestion Notification\n             (ECN) to IP\".\n\n  [56] 3GPP\u00c2\u00a0TS\u00c2\u00a026.114: \"IP Multimedia Subsystem (IMS); Multimedia\n             Telephony; Media handling and interaction\".\n\n  [57] 3GPP\u00c2\u00a0TS\u00c2\u00a023.271: \"Functional stage\u00c2\u00a02 description of LCS\".\n\n  [58] 3GPP\u00c2\u00a0TS\u00c2\u00a023.272: \"Circuit Switched (CS) fallback in Evolved Packet\n             System (EPS); Stage 2\".\n\n  [59] 3GPP\u00c2\u00a0TS\u00c2\u00a023.107: \"Quality of Service (QoS) concept and architecture\".\n\n  [60] 3GPP\u00c2\u00a0TS\u00c2\u00a023.292: \"IP Multimedia Subsystem (IMS) centralized services;\n             Stage 2\".\n\n  [61] 3GPP\u00c2\u00a0TS\u00c2\u00a029.303: \"Domain Name System Procedures; Stage 3\".\n\n  [62] IETF\u00c2\u00a0RFC\u00c2\u00a03376: \"Internet Group Management Protocol, Version 3\".\n\n  [63] IETF\u00c2\u00a0RFC\u00c2\u00a03810: \"Multicast Listener Discovery Version 2 (MLDv2) for\n             IPv6\".\n\n  [64] IETF\u00c2\u00a0RFC\u00c2\u00a03927: \"Dynamic Configuration of IPv4 Link-Local Addresses\".\n\n  [65] IETF\u00c2\u00a0RFC\u00c2\u00a04291: \"IP Version 6 Addressing Architecture\".\n\n  [66] 3GPP\u00c2\u00a0TS\u00c2\u00a022.368: \"Service Requirements for Machine-Type\n             Communications (MTC); Stage 1\".\n\n  [67] 3GPP\u00c2\u00a0TS\u00c2\u00a022.011: \"Service Accessibility\".\n\n  [68] 3GPP\u00c2\u00a0TS\u00c2\u00a022.153: \"Multimedia priority service\".\n\n  [69] 3GPP\u00c2\u00a0TS\u00c2\u00a024.368: \"Non-Access Stratum (NAS) configuration Management\n             Object (MO)\".\n\n  [70] IETF\u00c2\u00a0RFC\u00c2\u00a06603: \"Prefix Exclude Option for DHCPv6-based Prefix\n             Delegation\".\n\n  [71] 3GPP\u00c2\u00a0TS\u00c2\u00a023.002: \"Network Architecture\".\n\n  [72] 3GPP\u00c2\u00a0TS\u00c2\u00a023.007: \"Restoration procedures\".\n\n  [73] 3GPP\u00c2\u00a0TS\u00c2\u00a022.173: \"IP Multimedia Core Network Subsystem (IMS)\n             Multimedia Telephony Service and supplementary services; Stage\n             1\".\n\n  [74] 3GPP\u00c2\u00a0TS\u00c2\u00a023.682: \"Architecture enhancements to facilitate\n             communications with packet data networks and applications\".\n\n  [75] 3GPP\u00c2\u00a0TS\u00c2\u00a023.380: \"IMS Restoration Procedures\".\n\n  [76] 3GPP\u00c2\u00a0TS\u00c2\u00a036.423: \"Evolved Universal Terrestrial Radio Access Network\n             (E-UTRAN); X2 Application Protocol (X2AP)\".\n\n  [77] IETF\u00c2\u00a0RFC\u00c2\u00a05795: \"The RObust Header Compression (ROHC) Framework\".\n\n  [78] 3GPP\u00c2\u00a0TS\u00c2\u00a036.323: \"Evolved Universal Terrestrial Radio Access (E-\n             UTRA); Packet Data Convergence Protocol (PDCP) specification\".\n\n  [79] 3GPP\u00c2\u00a0TS\u00c2\u00a029.128: \" Mobility Management Entity (MME) and Serving GPRS\n             Support Node (SGSN) interfaces for interworking with packet\n             data networks and applications\".\n\n  [80] 3GPP\u00c2\u00a0TS\u00c2\u00a022.101: \"3rd Generation Partnership Project; Technical\n             Specification Group Services and Systems Aspects; Service\n             aspects; Service principles\".\n\n  [81] 3GPP\u00c2\u00a0TS\u00c2\u00a023.167: \"3rd Generation Partnership Project; Technical\n             Specification Group Services and Systems Aspects; IP\n             Multimedia Subsystem (IMS) emergency sessions\".\n\n  [82] 3GPP\u00c2\u00a0TS\u00c2\u00a036.306: \"Evolved Universal Terrestrial Radio Access (E-\n             UTRA); User Equipment (UE) radio access capabilities\".\n\n  [83] 3GPP\u00c2\u00a0TS\u00c2\u00a023.501: \"System Architecture for the 5G System; Stage 2\".\n\n  [84] 3GPP\u00c2\u00a0TS\u00c2\u00a023.502: \"Procedures for the 5G System; Stage 2\".\n\n  [85] 3GPP\u00c2\u00a0TS\u00c2\u00a037.340: \"Evolved Universal Terrestrial Radio Access (E-UTRA)\n             and NR; Multi-connectivity; Stage 2\".\n\n  [86] 3GPP\u00c2\u00a0TS\u00c2\u00a029.002: \"Mobile Application Part (MAP) specification\".\n\n  [87] 3GPP\u00c2\u00a0TS\u00c2\u00a036.321: \"Evolved Universal Terrestrial Radio Access -E-\n             UTRA); Medium Access Control -MAC) protocol specification\".\n\n  [88] 3GPP\u00c2\u00a0TS\u00c2\u00a023.503: \"Policy and Charging Control Framework for the 5G\n             System; Stage 2\".\n\n  [89] 3GPP\u00c2\u00a0TS\u00c2\u00a038.331: \"NR; Radio Resource Control (RRC); Protocol\n             specification\".\n\n\n"}, {"key": "Definitions and abbreviations", "numbering": "3", "title_level": 0, "desc": "3  Definitions and abbreviations\n\n\n"}, {"key": "Architecture model and concepts", "numbering": "4", "title_level": 0, "desc": "4  Architecture model and concepts\n\n\n"}, {"key": "General concepts", "numbering": "4.1", "title_level": 1, "desc": "4.1  General concepts\n\nLocal breakout of traffic via the visited PLMN is supported, when network\npolicies and user subscription allow it. Local breakout may be combined\nwith support for multiple simultaneous PDN connections, described in\nclause\u00c2\u00a05.10.\n\nCIoT EPS Optimisations provide improved support of small data transfer,\ndescribed in clause\u00c2\u00a04.11.\n\n\n"}, {"key": "Architecture reference model", "numbering": "4.2", "title_level": 1, "desc": "4.2  Architecture reference model\n\n\n"}, {"key": "Non-roaming architecture", "numbering": "4.2.1", "title_level": 2, "desc": "4.2.1  Non-roaming architecture\n\n                                    [pic]\n\n         Figure 4.2.1-1: Non-roaming architecture for 3GPP accesses\n\n                                    [pic]\n\n Figure 4.2.1-2: Non-roaming architecture for 3GPP accesses. Single gateway\n                            configuration option\n\n  NOTE\u00c2\u00a01:  Also in this configuration option, S5 can be used between non\n         collocated Serving Gateway and PDN Gateway.\n\n  NOTE\u00c2\u00a02:  Additional interfaces for 2G/3G access are shown in\n         TS\u00c2\u00a023.060\u00c2\u00a0[7].\n\n\n"}, {"key": "Roaming architecture", "numbering": "4.2.2", "title_level": 2, "desc": "4.2.2  Roaming architecture\n\n                                    [pic]\n\n Figure 4.2.2-1: Roaming architecture for 3GPP accesses. Home routed traffic\n\n  NOTE\u00c2\u00a01:  Additional interfaces/reference points for 2G/3G accesses are\n         documented in TS\u00c2\u00a023.060\u00c2\u00a0[7].\n\nThe figures 4.2.2-2 and 4.2.2-3 represent the Roaming with local breakout\ncase with Application Function (AF) in the Home Network and in the Visited\nNetwork respectively. The concurrent use of AF's in the home network and\nAF's in the visited network is not excluded.\n\n                                    [pic]\n\n     Figure 4.2.2-2: Roaming architecture for local breakout, with home\n                    operator's application functions only\n\n  NOTE\u00c2\u00a02:  See TS\u00c2\u00a023.203\u00c2\u00a0[6] for the role of and functions related to Home\n         and Visited PCRF and S9/Rx reference points.\n\n  NOTE\u00c2\u00a03:  In figure\u00c2\u00a04.2.2-2, the control plane signalling and the user\n         plane for accessing to Home Operator's services traverse over the\n         SGi reference point via the Visited Operator's PDN.\n\n                                    [pic]\n\n    Figure 4.2.2-3: Roaming architecture for local breakout, with visited\n                    operator's application functions only\n\n\n"}, {"key": "Reference points", "numbering": "4.2.3", "title_level": 2, "desc": "4.2.3  Reference points\n\n  S1-MME:  Reference point for the control plane protocol between E-UTRAN\n         and MME.\n\n  S1-U:  Reference point between E-UTRAN and Serving GW for the per bearer\n         user plane tunnelling and inter eNodeB path switching during\n         handover. S1-U does not apply to the Control Plane CIoT EPS\n         Optimisation.\n\n  S3:  It enables user and bearer information exchange for inter 3GPP\n         access network mobility in idle and/or active state. This reference\n         point can be used intra-PLMN or inter-PLMN (e.g. in the case of\n         Inter-PLMN HO).\n\n  S4:  It provides related control and mobility support between GPRS Core\n         and the 3GPP Anchor function of Serving GW. In addition, if Direct\n         Tunnel is not established, it provides the user plane tunnelling.\n\n  S5:  It provides user plane tunnelling and tunnel management between\n         Serving GW and PDN GW. It is used for Serving GW relocation due to\n         UE mobility and if the Serving GW needs to connect to a non-\n         collocated PDN GW for the required PDN connectivity.\n\n  S6a: It enables transfer of subscription and authentication data for\n         authenticating/authorizing user access to the evolved system (AAA\n         interface) between MME and HSS.\n\n  Gx:  It provides transfer of (QoS) policy and charging rules from PCRF to\n         Policy and Charging Enforcement Function (PCEF) in the PDN GW.\n\n  S8:  Inter-PLMN reference point providing user and control plane between\n         the Serving GW in the VPLMN and the PDN GW in the HPLMN. S8 is the\n         inter PLMN variant of S5.\n\n  S9:  It provides transfer of (QoS) policy and charging control\n         information between the Home PCRF and the Visited PCRF in order to\n         support local breakout function.\n\n  S10: Reference point between MMEs for MME relocation and MME to MME\n         information transfer. This reference point can be used intra-PLMN\n         or inter-PLMN (e.g. in the case of Inter-PLMN HO).\n\n  S11: Reference point providing control plane between MME and Serving GW.\n         In addition, in order to support Control Plane CIoT EPS\n         Optimisation, the S11-U reference point provides user plane between\n         MME and Serving GW.\n\n  S12: Reference point between UTRAN and Serving GW for user plane\n         tunnelling when Direct Tunnel is established. It is based on the Iu-\n         u/Gn-u reference point using the GTP-U protocol as defined between\n         SGSN and UTRAN or respectively between SGSN and GGSN. Usage of S12\n         is an operator configuration option.\n\n  S13: It enables UE identity check procedure between MME and EIR.\n\n  S17: It enables procedures for RACS between MME and UCMF.\n\n  SGi: It is the reference point between the PDN GW and the packet data\n         network. Packet data network may be an operator external public or\n         private packet data network or an intra operator packet data\n         network, e.g. for provision of IMS services. This reference point\n         corresponds to Gi for 3GPP accesses.\n\n  Rx:  The Rx reference point resides between the AF and the PCRF in the\n         TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  NOTE\u00c2\u00a01:  Except where stated otherwise, this specification does not make\n         an explicit assumption as to whether an interface is intra-PLMN or\n         inter-PLMN.\n\nWhen data forwarding is used as part of mobility procedures different user\nplane routes may be used based on the network configuration (e.g. direct or\nindirect data forwarding). These routes can be between eNodeB and RNC,\neNodeB and SGSN, RNC and S-GW or between S-GW and SGSN. Explicit reference\npoints are not defined for these routes. These user plane forwarding routes\ncan cross inter-PLMN boundaries (e.g. in the case of Inter-PLMN HO).\n\nProtocol assumption:\n\n  -  The S1-U is based on GTP-U protocol;\n\n  -  The S3 is based on GTP protocol;\n\n  -  The S4 and S11 are based on GTP protocol;\n\n  -  The S5 is based on GTP protocol. PMIP variant of S5 is described in\n    TS\u00c2\u00a023.402\u00c2\u00a0[2];\n\n  -  The S8 is based on GTP protocol. PMIP variant of S8 is described in\n    TS\u00c2\u00a023.402\u00c2\u00a0[2].\n\n  -  S3, S4, S5, S8, S10 and S11 interfaces are designed to manage EPS\n    bearers as defined in clause\u00c2\u00a04.7.2.\n\n  NOTE\u00c2\u00a02:  Redundancy support on reference points S5 and S8 should be taken\n         into account.\n\n\n"}, {"key": "Warning System architecture", "numbering": "4.2.4", "title_level": 2, "desc": "4.2.4  Warning System architecture\n\nRefer to TS\u00c2\u00a023.041\u00c2\u00a0[48] and TS\u00c2\u00a023.002\u00c2\u00a0[71] for the Warning System\narchitecture.\n\n\n"}, {"key": "Radio Capability signalling optimization architecture", "numbering": "4.2.5", "title_level": 2, "desc": "4.2.5  Radio Capability signalling optimization architecture\n\n                                    [pic]\n\n                      Figure 4.2.5-1: RACS architecture\n\nFigure 4.2.5-1 depicts the EPS architecture supporting RACS. RACS is\nfurther described in clause\u00c2\u00a05.11.3a. EPS architecture supporting\nprovisioning of UCMF is described in TS\u00c2\u00a023.682\u00c2\u00a0[74].\n\n\n"}, {"key": "High level functions", "numbering": "4.3", "title_level": 1, "desc": "4.3  High level functions\n\n\n"}, {"key": "General", "numbering": "4.3.1", "title_level": 2, "desc": "4.3.1  General\n\nThe following list gives the logical functions performed within this\nsystem. Several functional groupings (meta functions) are defined and each\nencompasses a number of individual functions:\n\n  -  Network Access Control Functions.\n\n  -  Packet Routing and Transfer Functions.\n\n  -  Mobility Management Functions.\n\n  -  Security Functions.\n\n  -  Radio Resource Management Functions.\n\n  -  Network Management Functions.\n\n\n"}, {"key": "Network access control functions", "numbering": "4.3.2", "title_level": 2, "desc": "4.3.2  Network access control functions\n\n\n"}, {"key": "General", "numbering": "4.3.2.1", "title_level": 3, "desc": "4.3.2.1  General\n\nNetwork access is the means by which a user is connected to the evolved\npacket core system.\n\n\n"}, {"key": "Network/Access network selection", "numbering": "4.3.2.2", "title_level": 3, "desc": "4.3.2.2  Network/Access network selection\n\nIt is the means by which a UE selects a PLMN/Access network from which to\ngain connectivity. The network/access network selection procedure varies\nfor different access technologies. For 3GPP access networks, the network\nselection principles are described in TS\u00c2\u00a023.122\u00c2\u00a0[10]. For 3GPP access\nnetworks, the access network selection procedures are described in\nTS\u00c2\u00a036.300\u00c2\u00a0[5], TS\u00c2\u00a043.022\u00c2\u00a0[11] and TS\u00c2\u00a025.304\u00c2\u00a0[12].\n\nArchitectural impacts stemming from support for network/access network\nselection procedures for non-3GPP access and between 3GPP access and non-\n3GPP accesses are described in TS\u00c2\u00a023.402\u00c2\u00a0[2].\n\n\n"}, {"key": "Authentication and authorisation function", "numbering": "4.3.2.3", "title_level": 3, "desc": "4.3.2.3  Authentication and authorisation function\n\nThis function performs the identification and authentication of the service\nrequester, and the validation of the service request type to ensure that\nthe user is authorised to use the particular network services. The\nauthentication function is performed in association with the Mobility\nManagement functions.\n\n\n"}, {"key": "Admission control function", "numbering": "4.3.2.4", "title_level": 3, "desc": "4.3.2.4  Admission control function\n\nThe purpose of admission control is to determine if the requested resources\nare available, and then reserve those resources.\n\n\n"}, {"key": "Policy and Charging Enforcement Function", "numbering": "4.3.2.5", "title_level": 3, "desc": "4.3.2.5  Policy and Charging Enforcement Function\n\nThis includes all the functionality of PCEF as defined by TS\u00c2\u00a023.203\u00c2\u00a0[6].\nThe PCEF encompasses service data flow detection, policy enforcement and\nflow based charging functionalities as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n\n"}, {"key": "Lawful Interception", "numbering": "4.3.2.6", "title_level": 3, "desc": "4.3.2.6  Lawful Interception\n\nLawful interception is the action, performed by a network operator / access\nprovider / service provider, of making available certain information and\nproviding that information to a law enforcement monitoring facility.\n\n\n"}, {"key": "Support for Dual Connectivity", "numbering": "4.3.2a", "title_level": 2, "desc": "4.3.2a Support for Dual Connectivity\n\nDual Connectivity involves two RAN nodes, i.e. Master and Secondary RAN\nnodes (see TS\u00c2\u00a036.300\u00c2\u00a0[5] for the definitions), in providing radio resources\nto a given UE (with active radio bearers), while a single S1-MME\ntermination point exists for an UE between a MME and the E-UTRAN. The E-\nUTRAN architecture and related functions to support Dual Connectivity with\nE-UTRAN is further described in TS\u00c2\u00a036.300\u00c2\u00a0[5]. Dual Connectivity with E-\nUTRAN as Master RAN node and NR as Secondary RAN node is further described\nin TS\u00c2\u00a037.340\u00c2\u00a0[85].\n\nDual connectivity defines \"Master Cell Group (MCG) bearer\" and \"Secondary\nCell Group (SCG) bearer\" alternatives (see TS\u00c2\u00a036.300\u00c2\u00a0[5]). For E-RABs\nconfigured as \"MCG bearers\" the U-plane termination points are maintained,\nwhereas for E-RABs configured as \"SCG bearers\" it enables changing the U-\nplane termination point in the E-UTRAN by means of S1-MME signalling\nwithout changing the S1-MME termination point.\n\nDual Connectivity also defines a \"split bearer\" alternative TS\u00c2\u00a036.300\u00c2\u00a0[5].\nThe \"split bearer\" in the E-UTRAN is transparent to the core network\nentities (e.g. MME, S-GW etc.) with the exception of the CSG membership\nverification by the MME when the Secondary eNB is a hybrid access eNB.\n\nThe E-UTRAN uses the per-UE information supplied by the MME and local E-\nUTRAN configuration data to determine whether or not to use Dual\nConnectivity for that UE, and, on a per EPS bearer basis the E-UTRAN\ndecides whether to use an MCG bearer or SCG bearer, and, whether or not\nthat bearer is a \"split bearer\".\n\n  NOTE\u00c2\u00a01:  Typically, the MME and SGW cannot determine whether the RAN\n         termination point(s) for the S1-U interface are located on a Master\n         RAN node that has multiple IP addresses, or, on a Secondary RAN\n         node.\n\nIf the UE has indicated support for Dual Connectivity with NR and MME has\nan Access Restriction for NR for a UE (either signalled from the HSS, or,\nlocally generated by VPLMN policy in the MME) then the MME shall signal\nthis to the E-UTRAN as part of Handover Restriction List and to the UE in\nAttach and TAU Accept as defined in clauses 5.5.2.2.3, 5.5.2.4.3, 5.3.2.1,\n5.3.3.1, 5.3.3.2 and D.3.6 respectively.\n\nAn eNB supporting Dual Connectivity with NR checks whether the UE is\nallowed to use NR. If the UE is not allowed to use NR, the eNB shall not\nestablish Dual Connectivity with NR as a secondary RAT.\n\nThe MME uses \"UE support for dual connectivity with NR\" for SGW and PGW\nselection when the UE indicates support for NR and there is no Access\nRestriction for NR for the UE.\n\nAn E-UTRAN cell, based on operator configuration, broadcasts whether it is\ncapable of supporting dual connectivity with locally available NR secondary\ncell(s).\n\nAt inter-RAT handover from GERAN/UTRAN, the Access Restriction for NR is\neither already in the MME's UE context, or, is obtained from the HSS during\nthe subsequent Tracking Area Update procedure (i.e. not from the source\nSGSN or source RAN). In both inter-RAT handover cases, any NR Access\nRestriction is then signalled to the E-UTRAN.\n\n  NOTE\u00c2\u00a02:  This signalling of the Access Restriction during the TAU after\n         the inter-RAT handover procedure means that there is a small risk\n         that NR resources are transiently allocated.\n\nThe eNB, at which the S1-MME terminates, performs all necessary S1-MME\nrelated functions (as specified for any serving eNB) such as mobility\nmanagement, relaying of NAS signalling, E-RAB handling, etc. and manages\nthe handling of user plane connection of S1-U.\n\nAdditional functional characteristics are:\n\n  -  User location information reporting is based on the identity of the\n    cell that is serving the UE and supported by the eNB terminating S1-\n    MME.\n\n  -  Path update signalling for E-RABs configured as \"SCG bearers\" and\n    Serving GW relocation cannot occur at the same time.\n\n  -  During handover with dual connectivity, the requirement of forwarding\n    \"end marker\" packets to target node is also applicable to secondary RAN\n    node if it is the source node for S1-U bearer.\n\n  -  After handover with data forwarding, the E-UTRAN initiated E-RAB\n    modification procedure of clause\u00c2\u00a05.4.7 should not be initiated by the\n    target eNB before \"end marker\" packet is received at the target RAN\n    node or a timer in target eNB expires.\n\n  -  Relaying function is not supported.\n\n  -  CSG function may be supported in case the Secondary eNB is a hybrid\n    access eNB (see more details in clause\u00c2\u00a05.4.7 and in TS\u00c2\u00a036.300\u00c2\u00a0[5]).\n\n  NOTE\u00c2\u00a03:  A HeNB cannot be the Master eNB, i.e. a HeNB cannot initiate the\n         Secondary eNB Addition procedure.\n\n  NOTE\u00c2\u00a04:  A HeNB is not allowed to be the Secondary eNB if the HeNB is a\n         closed access eNB.\n\n  -  When the Secondary eNB is a hybrid access eNB, the Master eNodeB may\n    ask CSG membership verification to the MME using E-RAB Modification\n    Indication message (for SCG bearers) or UE Context Modification\n    Indication (for split bearers) message. The MME shall determine the CSG\n    membership based on the CSG Membership Information as specified in\n    TS\u00c2\u00a036.300\u00c2\u00a0[5] and shall respond to the Master eNodeB using respectively\n    a E-RAB Modification Confirm or a UE Context Modification Confirm, but\n    shall not update the User CSG Information in the Core Network.\n\n  -  The LIPA function may be supported for the SCG bearer alternative, in\n    the case that the Secondary eNB is a HeNB with a collocated L-GW (see\n    more details in TS\u00c2\u00a036.300\u00c2\u00a0[5]).\n\n  -  \"SIPTO at the Local Network with L-GW function collocated with the\n    (H)eNB\" function may be supported (see more details in TS\u00c2\u00a036.300\u00c2\u00a0[5]):\n\n    -  For the MCG and split bearer alternatives, in case the Master eNB is\n       collocated with a L-GW; and/or\n\n    -  For the SCG bearer alternative, in case the Secondary eNB is a\n       (H)eNB with a collocated L-GW.\n\n  NOTE\u00c2\u00a05:  LIPA or SIPTO at the Local Network PDN connection can be\n         established if the SeNB has already been added before the UE\n         requests establishment of the LIPA or SIPTO at the Local Network\n         PDN connection.\n\n  NOTE\u00c2\u00a06:  LIPA or SIPTO at the Local Network PDN connection can be\n         established if the UE is in the coverage of the candidate SeNB when\n         the UE requests establishment of the LIPA or SIPTO at the Local\n         Network PDN connection, but the SeNB has not yet been added. In\n         this case, there is a time gap between the moment when the PDN\n         connection establishment is completed and the moment when the SeNB\n         Addition procedure is completed.\n\n  -  \"SIPTO at the Local Network with stand-alone GW\" function may be\n    supported for the MCG, SCG, and split bearer alternatives if the Master\n    and Secondary eNBs belong to the same LHN (see more detail in\n    TS\u00c2\u00a036.300\u00c2\u00a0[5]).\n\n\n"}, {"key": "Packet routing and transfer functions", "numbering": "4.3.3", "title_level": 2, "desc": "4.3.3  Packet routing and transfer functions\n\n\n"}, {"key": "General", "numbering": "4.3.3.1", "title_level": 3, "desc": "4.3.3.1  General\n\nA route is an ordered list of nodes used for the transfer of packets within\nand between the PLMN(s). Each route consists of the originating node, zero\nor more relay nodes and the destination node. Routing is the process of\ndetermining and using, in accordance with a set of rules, the route for\ntransmission of a message within and between the PLMN(s).\n\nThe EPS is an IP network and uses the standard routing and transport\nmechanisms of the underlying IP network.\n\nThe Maximum Transfer Unit (MTU) size considerations in clause\u00c2\u00a09.3 of\nTS\u00c2\u00a023.060\u00c2\u00a0[7] are also applicable to EPS.\n\n\n"}, {"key": "IP header compression function", "numbering": "4.3.3.2", "title_level": 3, "desc": "4.3.3.2  IP header compression function\n\nThe IP header compression function optimises use of radio capacity by IP\nheader compression mechanisms.\n\nWhen Control Plane CIoT EPS Optimisation is supported for PDN connections\nof IP PDN Type, if the IP header compression based on ROHC framework\nIETF\u00c2\u00a0RFC\u00c2\u00a05795\u00c2\u00a0[77] is implemented in the MME and the UE, the ROHC profiles\ndefined in TS\u00c2\u00a036.323\u00c2\u00a0[78] may be supported.\n\n\n"}, {"key": "Packet screening function", "numbering": "4.3.3.3", "title_level": 3, "desc": "4.3.3.3  Packet screening function\n\nThe packet screening function provides the network with the capability to\ncheck that the UE is using the exact IPv4-Address and/or IPv6-Prefix that\nwas assigned to the UE.\n\n\n"}, {"key": "IP Multicast Forwarding between a network accessed by LIPA and a", "numbering": "4.3.3.4", "title_level": 3, "desc": "4.3.3.4  IP Multicast Forwarding between a network accessed by LIPA and a\n           UE\n\nThe Home eNodeB L-GW should support IP forwarding of packets to multicast\ngroups between the UE and the network accessed by LIPA.\n\n\n"}, {"key": "Security functions", "numbering": "4.3.4", "title_level": 2, "desc": "4.3.4  Security functions\n\nThe security functions are described in clause\u00c2\u00a05.3.10.\n\n\n"}, {"key": "Mobility management functions", "numbering": "4.3.5", "title_level": 2, "desc": "4.3.5  Mobility management functions\n\n\n"}, {"key": "General", "numbering": "4.3.5.1", "title_level": 3, "desc": "4.3.5.1  General\n\nThe mobility management functions are used to keep track of the current\nlocation of a UE.\n\nIntra-RAT mobility for NB-IoT UEs is supported.\n\nInter-RAT idle mode mobility between NB-IoT and WB-EUTRAN/UTRAN/GERAN is\nsupported. Tracking area list management as defined in clause\u00c2\u00a04.3.5.3 is\nrequired to ensure that at inter-RAT mobility, the UE performs a TAU or RAU\nprocedure.\n\n\n"}, {"key": "Reachability Management for UE in ECM-IDLE state", "numbering": "4.3.5.2", "title_level": 3, "desc": "4.3.5.2  Reachability Management for UE in ECM-IDLE state\n\nThe location of a UE in ECM-IDLE state is known by the network on a\nTracking Area List granularity. All cells of the Tracking Areas in which a\nUE in ECM-IDLE is currently registered needs to be taken into account for\npaging. The UE may be registered in multiple Tracking Areas. All the\ntracking areas in a Tracking Area List to which a UE is registered are\nserved by the same serving MME.\n\nAn EMM-REGISTERED UE performs periodic Tracking Area Updates with the\nnetwork after the expiry of the periodic TAU timer.\n\nThe MME may allocate long periodic TAU timer value to the UE according to\nclause\u00c2\u00a04.3.17.3.\n\nIf the UE is out of E-UTRAN coverage (including the cases when the UE is\ncamped on GERAN/UTRAN cells) when its periodic TAU timer expires, the UE\nshall:\n\n  -  if ISR is activated, start the E-UTRAN Deactivate ISR timer. After the\n    E-UTRAN Deactivate ISR timer expires the UE shall deactivate ISR by\n    setting its TIN to \"P-TMSI\".\n\n  -  if ISR is activated and the UE is camping on a GERAN/UTRAN cell (or\n    returns to coverage in GERAN/UTRAN) and the UE is EPS/IMSI attached,\n    perform a LAU procedure in NMO II or a combined RA/LA update procedure\n    in NMO I.\n\n  -  when EMM-REGISTERED, perform a Tracking Area Update when it next\n    returns to E-UTRAN coverage.\n\nIf the UE is camped on an E-UTRAN cell or is in ECM-CONNECTED state when\nthe UE's periodic RAU timer expires, the UE shall:\n\n  -  if ISR is activated, start the GERAN/UTRAN Deactivate ISR timer. After\n    the GERAN/UTRAN Deactivate ISR timer expires the UE shall deactivate\n    ISR by setting its TIN to \"GUTI\".\n\n  -  perform a Routing Area Update when it next returns to GERAN/UTRAN\n    coverage.\n\nIf the UE is EPS attached only and either camps on an E UTRAN cell or is in\nECM CONNECTED state when the UE's periodic LAU timer expires, the UE shall\nperform a Location Area Update procedure in NMO II or combined RA/LA update\nin NMO I when it next returns to GERAN/UTRAN coverage.\n\nThe E-UTRAN Deactivate ISR timer is stopped when the UE performs a\nsuccessful Tracking Area Update or combined TA/LA Update; and the\nGERAN/UTRAN Deactivate ISR timer is stopped when the UE performs a\nsuccessful Routing Area Update or combined RA/LA Update.\n\nExpiry of the periodic TAU timer, or, the periodic RAU timer, or, the\nperiodic LAU timer shall not cause the UE to change RAT.\n\nThe UE's periodic TAU timer is restarted from its initial value whenever\nthe UE enters ECM-IDLE mode and when the UE leaves the E-UTRAN connection\ndue to handover to GERAN/UTRAN. UTRAN RRC state transitions and GERAN GPRS\nSTANDBY/READY state transitions shall have no other impact on the periodic\nTAU timer.\n\nE-UTRAN RRC state transitions shall have no impact on the periodic RAU\ntimer or periodic LAU timer except that handover from GERAN/UTRAN to E-\nUTRAN shall cause the periodic RAU timer to be started from its initial\nvalue.\n\nHandover from E-UTRAN to UTRAN/GERAN shall cause the periodic TAU timer to\nbe started from its initial value.\n\nTypically, the MME runs a mobile reachable timer. Whenever the UE enters\nECM IDLE mode the timer is started with a value similar to the UE's\nperiodic TAU timer. If this timer expires in the MME, the MME can deduce\nthat the UE is not reachable. However, the MME does not know for how long\nthe UE is not reachable, so, the MME shall not immediately delete the UE's\nbearers. Instead the MME should clear the PPF flag in the MME and start an\nImplicit Detach timer, with a relatively large value and if ISR is\nactivated, at least slightly larger than the UE's E-UTRAN Deactivate ISR\ntimer.\n\nIf MME has allocated an Active Time to the UE, then the MME starts the\nActive timer with the value of Active Time whenever the UE enters ECM IDLE\nmode. If this timer expires in the MME, the MME can deduce that the UE is\nnot reachable and should clear the PPF flag in the MME.\n\nWith the PPF clear, the MME does not page the UE in E-UTRAN coverage and\nshall send a Downlink Data Notification Reject message to the Serving GW\nwhen receiving a Downlink Data Notification message from the Serving GW. If\nthe Implicit Detach timer expires before the UE contacts the network, then\nthe MME can deduce that the UE has been 'out of coverage' for a long period\nof time and implicitly detach the UE as described in clause\u00c2\u00a05.3.8.3 \"MME-\ninitiated Detach procedure\".\n\nIf the MME is requested to monitor Reachability for Data and the UE enters\nECM-CONNECTED, the MME sends a Monitoring Report message to the address\nthat was indicated in the related Monitoring Request as described in\nTS\u00c2\u00a023.682\u00c2\u00a0[74].\n\nWhen the MME applies General NAS level Mobility Management Congestion\nControl to a UE, the MME may need to adjust the mobile reachable timer\nand/or Implicit Detach timer (as clause\u00c2\u00a04.3.7.4.2.4).\n\n  NOTE\u00c2\u00a01:  The SGSN has similar functionality as the MME.\n\n  NOTE\u00c2\u00a02:  Alternative MME implementations are permitted, however, the\n         externally visible MME behaviour should conform to the above\n         description.\n\n\n"}, {"key": "Tracking Area list management", "numbering": "4.3.5.3", "title_level": 3, "desc": "4.3.5.3  Tracking Area list management\n\nTracking Area list management comprises the functions to allocate and\nreallocate a Tracking Area Identity list to the UE. All the tracking areas\nin a Tracking Area List to which a UE is registered are served by the same\nserving MME.\n\nThe \"tracking area list concept\" is used with E-UTRAN. With this concept,\nwhen the UE registers with the network, the MME allocates a set (a \"list\")\nof tracking areas to the UE. By making the centre of this set of tracking\nareas close to the UE's current location, the chance of a UE rapidly making\nanother tracking area update can be reduced.\n\nIf SIPTO at local network with stand-alone GW, Serving GW relocation\nwithout mobility and ISR are supported in the core network the Tracking\nArea list should only contain either Tracking Areas inside one local\nnetwork or inside the macro network. If the tracking area list covers both\nlocal network and macro network, the ISR shall not be activated if the UE\nis allowed to use SIPTO at local network.\n\nThe MME determines the RAT type the UE is camping on, i.e. NB-IoT or WB-E-\nUTRAN, based on the Tracking Area indicated in the INITIAL UE MESSAGE by\nthe eNB.\n\nTo ensure a UE initiates tracking area updating procedure when perfoming\ninter-RAT mobility between NB-IoT and WB-E-UTRAN, the E-UTRAN shall be\nconfigured such that a Tracking Area does not contain both WB-E-UTRAN and\nNB-IoT cells, and, the MME shall not allocate a Tracking Area Identity list\nthat contains both NB-IoT and WB-E-UTRAN Tracking Areas.\n\nTo ensure the UE initiates tracking area update procedure when it moves to\nand from an MME that supports 15 EPS bearers per UE as defined in\nclause\u00c2\u00a04.12 to an MME that does not support 15 EPS bearers per MME and vice\nversa, the MME shall allocate a Tracking Area Identity list that provides\nhomogenous support for 15 EPS bearers per UE.\n\nOther features (e.g. User Plane CIoT EPS Optimisation, Supporting up to 15\nEPS bearers per UE) may require the MME to adapt how it creates the \"list\"\nof TAIs.\n\n  NOTE:  This TAI list functionality is different to the SGSN behaviour in\n         GERAN and UTRAN systems. In GERAN/UTRAN the UE is only registered\n         in one Routeing Area at a time.\n\n\n"}, {"key": "Inter-eNodeB mobility anchor function", "numbering": "4.3.5.4", "title_level": 3, "desc": ""}, {"key": "Inter-GPP mobility anchor function", "numbering": "4.3.5.5", "title_level": 3, "desc": "4.3.5.4  Inter-eNodeB mobility anchor function\n\nThe Inter-eNodeB Mobility Anchor is the functional entity that anchors the\nuser plane for E-UTRAN mobility.\n\n\n4.3.5.5  Inter-3GPP mobility anchor function\n\nThe Inter-3GPP Mobility Anchor is the functional entity that anchors the\nuser plane for mobility between 3GPP 2G/3G access systems and the E-UTRA\naccess system.\n\n\n"}, {"key": "Idle mode signalling reduction function", "numbering": "4.3.5.6", "title_level": 3, "desc": "4.3.5.6  Idle mode signalling reduction function\n\nThe Idle mode Signalling Reduction (ISR) function provides a mechanism to\nlimit signalling during inter-RAT cell-reselection in idle mode (ECM-IDLE,\nPMM-IDLE, GPRS STANDBY states).\n\n  NOTE\u00c2\u00a01:  The Idle mode Signalling Reduction function is mandatory for E-\n         UTRAN UEs that support GERAN and/or UTRAN and optional for core\n         network. The UE's ISR capability in the UE Core Network Capability\n         element is for test purpose.\n\nThe MME/SGSN activates ISR only if the Serving GW supports the ISR. How\nMME/SGSN determines a Serving GW supports ISR is implementation dependent.\n\nISR shall be activated by decision of the CN nodes and shall be explicitly\nsignalled to the UE as \"ISR activated\" in the RAU and TAU Accept messages.\nThe UE may have valid MM parameters both from MME and from SGSN. The\n\"Temporary Identity used in Next update\" (TIN) is a parameter of the UE's\nMM context, which identifies the UE identity that the UE shall indicate in\nthe next RAU Request, TAU Request or Attach Request message. The TIN also\nidentifies the status of ISR activation in the UE.\n\nThe TIN can take one of the three values, \"P-TMSI\", \"GUTI\" or \"RAT-related\nTMSI\". The UE shall set the TIN when receiving an Attach Accept, a TAU\nAccept or RAU Accept message according to the rules in table\u00c2\u00a04.3.5.6-1.\n\n                     Table 4.3.5.6-1: Setting of the TIN\n\n|Message received by  |Current TIN value    |TIN value to be set|\n|UE                   |stored by UE         |by the UE when     |\n|                     |                     |receiving message  |\n|Attach Accept via    |Any value            |GUTI               |\n|E-UTRAN              |                     |                   |\n|(never indicates \"ISR|                     |                   |\n|Activated\")          |                     |                   |\n|Attach Accept via    |Any value            |P-TMSI             |\n|GERAN/UTRAN          |                     |                   |\n|(never indicates \"ISR|                     |                   |\n|Activated\")          |                     |                   |\n|TAU Accept           |Any value            |GUTI               |\n|not indicating \"ISR  |                     |                   |\n|Activated\"           |                     |                   |\n|TAU Accept           |GUTI                 |GUTI               |\n|indicating \"ISR      |P-TMSI or RAT-related|RAT-related TMSI   |\n|Activated\"           |TMSI                 |                   |\n|RAU Accept           |Any value            |P-TMSI             |\n|not indicating \"ISR  |                     |                   |\n|Activated\"           |                     |                   |\n|RAU Accept           |P-TMSI               |P-TMSI             |\n|indicating \"ISR      |GUTI or RAT-related  |RAT-related TMSI   |\n|Activated\"           |TMSI                 |                   |\n\nWhen \"ISR Activated\" is indicated by the RAU/TAU Accept message but the UE\nshall not set the TIN to \"RAT-related TMSI\" is a special situation. Here\nthe UE has deactivated ISR due to special situation handling. By\nmaintaining the old TIN value the UE remembers to use the RAT specific TMSI\nindicated by the TIN when updating with the CN node of the other RAT.\n\nOnly if the TIN is set to \"RAT-related TMSI\" ISR behaviour is enabled for\nthe UE, i.e. the UE can change between all registered areas and RATs\nwithout any update signalling and it listens for paging on the RAT it is\ncamped on. If the TIN is set to \"RAT-related TMSI\", the UE's P-TMSI and RAI\nas well as its GUTI and TAI(s) shall remain registered with the network and\nshall remain valid in the UE.\n\n Table\u00c2\u00a04.3.5.6-2: Temporary UE Identity that the UE shall indicate in Attach\n      Request and TAU/RAU Request (as \"old GUTI\" or as \"old P-TMSI/RAI\"\n                            information element)\n\n|Message to be sent|TIN value: P-TMSI  |TIN value: GUTI    |TIN value:       |\n|by UE             |                   |                   |RAT-related TMSI |\n|TAU Request       |GUTI mapped from   |GUTI               |GUTI             |\n|                  |P-TMSI/RAI         |                   |                 |\n|RAU Request       |P-TMSI/RAI         |P-TMSI/RAI mapped  |P-TMSI/RAI       |\n|                  |                   |from GUTI          |                 |\n|Attach Request via|GUTI mapped from   |GUTI               |GUTI             |\n|E-UTRAN           |P-TMSI/RAI         |                   |                 |\n|Attach Request via|P-TMSI/RAI         |P-TMSI/RAI mapped  |P-TMSI/RAI       |\n|GERAN/UTRAN       |                   |from GUTI          |                 |\n\nTable\u00c2\u00a04.3.5.6-2 shows which temporary identity the UE shall indicate in a\nTracking or Routing Area Update Request or in an Attach Request message,\nwhen the UE stores these as valid parameters.\n\nSituations may occur that cause unsynchronized state information in the UE,\nMME and SGSN. Such special situations trigger a deactivation of ISR locally\nin the UE.\n\nThe UE shall deactivate ISR locally by setting its TIN to the temporary\nidentity of the currently used RAT in following special situations:\n\n  -  Modification of any EPS bearer context or PDP context which was\n    activated before the ISR is activated in the UE;\n\n  -  At the time when the UE moves from E-UTRAN to GERAN/UTRAN or moves\n    from GERAN/UTRAN to E-UTRAN by means other than PSHO, if any EPS bearer\n    context or PDP context activated after the ISR was activated in the UE\n    exists;\n\n  -  At the time when the UE moves from GERAN/UTRAN to E-UTRAN by means\n    other than PSHO and CS to PS SRVCC, if the PDP contexts were suspended\n    in GERAN and not successfully resumed before returning to E-UTRAN;\n\n  -  After updating either MME or SGSN about the change of the UE specific\n    DRX parameters to guarantee that the other CN node is also updated;\n\n  -  After updating either MME or SGSN about the change of the UE Core\n    Network Capabilities to guarantee that the other CN node is also\n    updated;\n\n  -  E-UTRAN selection by a UTRAN-connected UE (e.g. when in URA_PCH to\n    release Iu on UTRAN side);\n\n  -  E-UTRAN selection from GERAN READY state;\n\n  -  GERAN selection by an E-UTRAN-connected UE via Cell Change Order that\n    is not for CS fallback;\n\n  -  After a LAU procedure if the UE has CS fallback and/or SMS over SGs\n    activated.\n\n  -  For a UE that is IMS registered for voice, then after that UE moves\n    from a Registration Area that supports IMS voice over PS sessions (see\n    4.3.5.8 for more information) to one that does not, and vice versa. It\n    shall be possible, e.g. using Device Management or initial provisoning,\n    to configure the UE to apply/not apply this particular exception.\n\n  NOTE\u00c2\u00a02:  A UE moving between Registration Areas that both support IMS\n         voice over PS sessions, or, both that do not support IMS voice over\n         PS sessions, is unaffected by the above.\n\nThe UE shall deactivate ISR locally by setting its TIN to the temporary\nidentity of the RAT that is still available to the UE in following special\nsituations:\n\n  -  After the RAT-specific Deactivate ISR timer expires, e.g. because the\n    coverage of that RAT is lost or the RAT is no more selected by the UE\n    (this may result also in implicit detach by SGSN or MME).\n\nISR shall be deactivated in the UE by the CN node using normal update\nsignalling, i.e. by omitting the signalling of \"ISR Activated\", in\nfollowing special situations:\n\n  -  CN node change resulting in context transfer between the same type of\n    CN nodes (SGSN to SGSN or MME to MME);\n\n  -  Serving GW change;\n\n  -  When the UE only has bearers related to emergency bearer service;\n\n  -  TAU or RAU when UE moves over the border between local and macro\n    network where SIPTO at local network with stand-alone GW and Serving GW\n    relocation without mobility are supported in the core network.\n\n  -  TAU or RAU when the network confirms to use PSM for the UE.\n\nIf tracking area list or routing area covers both local network and macro\nnetwork, the ISR shall not be activated if the UE is allowed to use SIPTO\nat local network and Serving GW relocation without mobility are supported\nin the core network.\n\n\n"}, {"key": "Mobility Restrictions", "numbering": "4.3.5.7", "title_level": 3, "desc": "4.3.5.7  Mobility Restrictions\n\nMobility Restrictions comprises the functions for restrictions to mobility\nhandling of a UE in E-UTRAN access. The Mobility Restriction functionality\nis provided by the UE, the radio access network and the core network.\n\nMobility Restriction functionality in state ECM-IDLE is executed in UE\nbased on information received from the core network. Mobility Restriction\nfunctionality in state ECM-CONNECTED is executed in the radio network and\nthe core network.\n\nIn state ECM-CONNECTED, the core network provides the radio network with a\nHandover Restriction List. The Handover Restriction List specifies roaming,\narea and access restrictions. If roaming restriction to GERAN or UTRAN\naccess needs to be enforced, a MME that is connected to eNBs that may\nhandover or invoke release with redirection to UTRAN or GERAN is configured\nwith a list of HPLMN IDs that are permitted to access GERAN or UTRAN unless\nrestricted by the UE individual access restriction information received\nfrom HSS.\n\n\n"}, {"key": "IMS voice over PS Session Supported Indication", "numbering": "4.3.5.8", "title_level": 3, "desc": "4.3.5.8  IMS voice over PS Session Supported Indication\n\nThe serving PLMN shall send an indication toward the UE during the Attach\nprocedure and Tracking Area Update procedures if an IMS voice over PS\nsession is supported. The serving PLMN uses this indicator to indicate to\nthe UE whether it can expect a successful IMS voice over PS session\naccording to TS\u00c2\u00a022.173\u00c2\u00a0[73] with a bearer that supports Conversational\nVoice as specified in TS\u00c2\u00a023.203\u00c2\u00a0[6]. A UE with \"IMS voice over PS\" voice\ncapability should take this indication into account when establishing voice\nover PS sessions (as specified in TS\u00c2\u00a023.221\u00c2\u00a0[27]) as well as when\ndetermining whether to deactivate the special handling of ISR locally (as\ndetailed in clause\u00c2\u00a04.3.5.6).\n\nThe serving PLMN provides this indication based e.g. on local policy,\nHPLMN, Voice Support Match Indicator, the SRVCC capability of the network\nand UE and/or extends of E-UTRAN/UTRAN coverage. The serving PLMN shall\nindicate to the UE that the UE can expect a successful IMS voice over PS\nsession only if the MME is configured to know that the serving PLMN has a\nroaming agreement for IMS voice with the HPLMN of the UE. This indication\nis per TAI list.\n\nOn request by the HSS, the MME shall indicate the following:\n\n  -  whether or not an IMS voice over PS Session is supported in the TA(s)\n    that are registered for the UE (\"IMS voice over PS Session Supported\n    Indication\"), together with the time of the last radio contact with the\n    UE; and\n\n  -  the current RAT type.\n\n  NOTE:  In order to support routing of incoming IMS voice calls to the\n         correct domain (PS or CS), the network-based T-ADS (see\n         TS\u00c2\u00a023.292\u00c2\u00a0[60] and TS\u00c2\u00a023.221\u00c2\u00a0[27]) requires that there is\n         homogeneous support/non-support of IMS voice over PS session for\n         all registered TAs of the UE.\n\n\n"}, {"key": "Homogenous Support of IMS Voice over PS Sessions Indication", "numbering": "4.3.5.8A", "title_level": 3, "desc": "4.3.5.8A Homogenous Support of IMS Voice over PS Sessions Indication\n\nThe \"Homogenous Support of IMS Voice over PS Sessions\" indication is\nprovided by the MME to the HSS, and can be used by the HSS to avoid\nrequesting the serving nodes whether or not an IMS Voice over PS session\naccording to TS\u00c2\u00a022.173\u00c2\u00a0[73] with a bearer that supports Conversational\nVoice as specified in TS\u00c2\u00a023.203\u00c2\u00a0[6] is supported. This indication is stored\nin the MME MM context.\n\nThe MME shall behave as follows whenever it sends a Update Location Request\nor a Notify Request message to the HSS:\n\n  -  if \"IMS Voice over PS Sessions\" is supported homogeneously in all TAs\n    in the serving MME for the UE, the MME shall include the \"Homogenous\n    Support of IMS Voice over PS Sessions\" indication set to \"Supported\".\n\n  -  if none of the TAs of the serving MME supports \"IMS Voice over PS\n    Sessions\" for the UE, the MME shall include the \"Homogenous Support of\n    IMS Voice over PS Sessions\" indication set to \"Not supported\".\n\n  -  if \"IMS Voice over PS Sessions\" support is either non-homogeneous or\n    unknown, the MME shall not include the \"Homogenous Support of IMS Voice\n    over PS Sessions\" indication.\n\nRegarding homogenous support/non-support of IMS Voice over PS session for\nall registered TAs of the UE, see clause\u00c2\u00a04.3.5.8.\n\n\n"}, {"key": "Voice domain preference and UE's usage setting", "numbering": "4.3.5.9", "title_level": 3, "desc": "4.3.5.9  Voice domain preference and UE's usage setting\n\nIf the UE supports CS fallback, or the UE is configured to support IMS\nvoice, or both, the UE shall include the information element \"Voice domain\npreference and UE's usage setting\" in Attach Request, Tracking Area Update\nRequest and Routing Area Update Request messages. The purpose of this\ninformation element is to signal to the network the UE's usage setting and\nvoice domain preference for E-UTRAN. The UE's usage setting indicates\nwhether the UE behaves in a voice centric or data centric way (as defined\nin TS\u00c2\u00a023.221\u00c2\u00a0[27]). The voice domain preference for E-UTRAN indicates\nwhether the UE is configured as CS Voice only, CS Voice preferred and IMS\nPS Voice as secondary, IMS PS Voice preferred and CS Voice as secondary, or\nIMS PS Voice only (as defined in TS\u00c2\u00a023.221\u00c2\u00a0[27]).\n\nIn this Release of the specifications, inter-RAT mobility to/from the NB-\nIoT RAT is not supported, and GBR bearers are not supported in the NB-IoT\nRAT. Hence the UE should not include the \"Voice domain preference and UE's\nusage setting\" IE when sending an Attach Request or Tracking Area Update\nRequest on the NB-IoT RAT.\n\n  NOTE:  Depending on operator's configuration, the UE's usage setting and\n         voice domain preference for E-UTRAN can be used by the network to\n         choose the RFSP Index in use (see clause\u00c2\u00a04.3.6). As an example,\n         this enables the enforcement of selective idle mode camping over\n         GERAN/UTRAN for voice centric UEs relying on CS Fallback for voice\n         support in E-UTRAN.\n\n\n"}, {"key": "Preferred and Supported Network Behaviour", "numbering": "4.3.5.10", "title_level": 3, "desc": "4.3.5.10 Preferred and Supported Network Behaviour\n\nA UE includes in a Preferred Network Behaviour indication the Network\nBehaviour the UE can support and what it would prefer to use.\n\nThe Preferred Network Behaviour includes this information:\n\n  -  Whether Control Plane CIoT EPS Optimisation is supported.\n\n  -  Whether User Plane CIoT EPS Optimisation is supported.\n\n  -  Whether Control Plane CIoT EPS Optimisation is preferred or whether\n    User Plane Plane CIoT EPS Optimisation is preferred.\n\n  -  Whether S1-U data transfer is supported.\n\n  -  Whether SMS transfer without Combined Attach is requested.\n\n  -  Whether Attach without PDN Connectivity is supported.\n\n  -  Whether header compression for Control Plane CIoT EPS Optimisation is\n    supported.\n\nIf SMS transfer without Combined EPS Attach is requested by the UE, a\nsupporting MME provides SMS transfer without the UE performing the combined\nEPS attach specified in TS\u00c2\u00a023.272\u00c2\u00a0[58]. An MME connected to NB-IoT should\nsupport SMS transfer without the UE being required to perform a Combined\nAttach.This feature is only available to UEs that only support NB-IoT.\n\nIf S1-U data transfer is supported is indicated by the UE, the UE supports\ndata transfer that is not subject to CIoT EPS Optimisations. If the UE\nindicates support of User Plane CIoT EPS Optimisation then it shall also\nindicate support of S1-U data transfer.\n\nIf Attach without PDN connection is supported, the UE need not establish a\nPDN connection as part of the Attach procedure and the UE and MME may at\nany time release all the PDN connections and remain EPS attached.\n\nThe MME indicates the network behaviour the network accepts in the\nSupported Network Behaviour information. This indication is per TAI List.\nThe MME may indicate one or more of the following:\n\n  -  Whether Control Plane CIoT EPS Optimisation is supported.\n\n  -  Whether User Plane CIoT EPS Optimisation is supported.\n\n  -  Whether S1-U data transfer is supported.\n\n  -  Whether SMS transfer without Combined Attach is accepted.\n\n  -  Whether Attach without PDN Connectivity is supported.\n\n  -  Whether header compression for Control Plane CIoT EPS Optimisation is\n    supported.\n\nIf the MME indicates support of User Plane CIoT EPS Optimisation then it\nshall also indicate support of S1-U data transfer. If the UE and MME\nindicate support for User Plane CIoT EPS Optimisation, MME sets the UE User\nPlane CIoT Support Indicator to \"supported\" in S1-AP messages as defined in\nTS\u00c2\u00a036.413\u00c2\u00a0[36].\n\nFor NB-IoT UEs that only support Control Plane CIoT EPS Optimisation, the\nMME shall include support for Control Plane CIoT EPS Optimisation in NAS\naccept messages.\n\nA UE that supports the NB-IoT shall always indicate support for Control\nPlane CIoT EPS Optimisation.\n\nIn a network that supports Dedicated Core Networks (see clause\u00c2\u00a05.19), the\nPreferred Network Behaviour indication from the UE may be used to influence\npolicy decisions that can cause rerouting of the Attach or TAU from an MME\nto another MME.\n\nOther CIoT EPS Optimisations include \"Attach without PDN connection\nestablishment\"; \"PDN type = non-IP\"; and \"UE connection to SCEF\". These\nfeatures are requested by implicit and explicit signalling described within\nthe relevant clauses of this TS.\n\n\n"}, {"key": "Radio Resource Management functions", "numbering": "4.3.6", "title_level": 2, "desc": "4.3.6  Radio Resource Management functions\n\nRadio resource management functions are concerned with the allocation and\nmaintenance of radio communication paths, and are performed by the radio\naccess network. RRM includes both idle mode and connected mode. The RRM\nstrategy in E-UTRAN may be based on user specific information.\n\nTo support radio resource management in E-UTRAN the MME provides the\nparameter 'Index to RAT/Frequency Selection Priority' (RFSP Index) to an\neNodeB across S1. The RFSP Index is mapped by the eNodeB to locally defined\nconfiguration in order to apply specific RRM strategies. The RFSP Index is\nUE specific and applies to all the Radio Bearers. Examples of how this\nparameter may be used by the E-UTRAN:\n\n  -  to derive UE specific cell reselection priorities to control idle mode\n    camping.\n\n  -  to decide on redirecting active mode UEs to different frequency layers\n    or RATs.\n\nTo provide additional support to radio resource management in E-UTRAN, the\nMME may provide the parameter 'Additional RRM Policy Index' (ARPI) to an\neNodeB across S1. The ARPI is mapped by the eNodeB to locally defined\nconfiguration in order to apply specific RRM strategies.\n\nAn example of how this parameter may be used by the E-UTRAN is:\n\n  -  to prioritise the allocation of RAN resources to the set of UEs with\n    the same ARPI.\n\nThe Serving PLMN can use the ARPI to carry information that is independent\nto the Reference SPID values documented in Informative Annex\u00c2\u00a0I of\nTS\u00c2\u00a036.300\u00c2\u00a0[5].\n\nThe MME receives the subscribed RFSP Index and subscribed ARPI from the HSS\n(e.g., during the Attach procedure). For non-roaming subscribers the MME\nchooses the RFSP Index and ARPI in use according to one of the following\nprocedures, depending on operator's configuration:\n\n  -  the RFSP Index in use is identical to the subscribed RFSP Index, or\n\n  -  the MME chooses the RFSP Index in use based on the subscribed RFSP\n    Index, the locally configured operator's policies and the UE related\n    context information available at the MME, including UE's usage setting\n    and voice domain preference for E-UTRAN, if received during Attach and\n    Tracking Area Update procedures (see clause\u00c2\u00a04.3.5.9).\n\n  NOTE:  One example of how the MME can use the \"UE voice capabilities and\n         settings\" is to select an RFSP value that enforces idle mode\n         camping on 2G/3G for a UE acting in a \"Voice centric\" way and\n         provisioned with \"CS Voice preferred, IMS Voice as secondary\", in\n         order to minimize the occurrancy of RAT changes. Another example is\n         the selection of an RFSP value that prevents idle mode camping on\n         2G for a UE provisioned with \"IMS PS voice preferred, CS Voice as\n         secondary\" if other RATs supporting IMS Voice are available, as the\n         UE would in such case always select the CS domain for its voice\n         calls.\n\n  -  the ARPI In Use is identical to the subscribed ARPI, or\n\n  -  the MME chooses the ARPI in use based on the subscribed ARPI, the\n    locally configured operator's policies and the UE related context\n    information available at the MME.\n\nFor roaming subscribers the MME may alternatively choose the RFSP Index and\nARPI in use based on the visited network policy, but can take input from\nthe HPLMN into account (e.g., an RFSP Index value/ARPI value pre-configured\nper HPLMN, or a single RFSP Index value/single ARPI value to be used for\nall roamers independent of the HPLMN).\n\nThe MME forwards the RFSP Index and ARPI in use to the eNodeB across S1.\nThe RFSP Index and ARPI in use is also forwarded from source eNodeB to\ntarget eNodeB when X2 is used for intra-E-UTRAN handover, UE context\nretrieval, or, Dual Connectivity with a secondary RAN node.\n\nThe MME stores the subscribed RFSP Index and ARPI values received from the\nHSS and the RFSP Index and ARPI values in use. During the Tracking Area\nUpdate procedure, the MME may update the RFSP Index/ARPI value in use (e.g.\nthe MME may need to update the RFSP Index/ARPI value in use if the UE\nrelated context information in the MME has changed). When the RFSP\nIndex/ARPI value in use is changed, the MME immediately provides the\nupdated RFSP Index/ARPI value in use to eNodeB by modifying an existing UE\ncontext or by establishing an new UE context in the eNodeB or by being\nconfigured to include the updated RFSP Index/ARPI value in use in the\nDOWNLINK NAS TRANSPORT message if the user plane establishment is not\nneeded. During inter-MME mobility procedures, the source MME forwards both\nRFSP Index values and both ARPI values to the target MME. The target MME\nmay replace the received RFSP Index and ARPI values in use with a new RFSP\nIndex value in use or new ARPI value in use that is based on the operator's\npolicies and the UE related context information available at the target\nMME.\n\nThe S1 messages that transfer the RFSP Index and ARPI to the eNodeB are\nspecified in TS\u00c2\u00a036.413\u00c2\u00a0[36]. Refer to TS\u00c2\u00a036.300\u00c2\u00a0[5] for further information\non E-UTRAN.\n\nTo support a RAN with a mixture of RAN nodes that support and do not\nsupport the ARPI, the MME sends the ARPI In Use in the S1 interface PATCH\nSWITCH ACKNOWLEDGEMENT and HANDOVER REQUEST messages.\n\n\n"}, {"key": "Network management functions", "numbering": "4.3.7", "title_level": 2, "desc": "4.3.7  Network management functions\n\n\n"}, {"key": "General", "numbering": "4.3.7.1", "title_level": 3, "desc": "4.3.7.1  General\n\nNetwork management functions provide mechanisms to support O&M functions\nrelated to the Evolved Packet System.\n\n\n"}, {"key": "GTP-C signalling based Load and Overload Control", "numbering": "4.3.7.1a", "title_level": 3, "desc": "4.3.7.1a GTP-C signalling based Load and Overload Control\n\n\n"}, {"key": "GTP-C Load Control", "numbering": "4.3.7.1a.1", "title_level": 4, "desc": "4.3.7.1a.1  GTP-C Load Control\n\nGTP-C Load Control feature is an optional feature which allows a GTP\ncontrol plane node to send its Load Control Information to a peer GTP\ncontrol plane node which the receiving GTP control plane peer node uses to\naugment existing GW selection procedure (i.e. as described in \"PDN GW\nSelection\" and \"Serving GW Selection\" according to clauses\u00c2\u00a04.3.8.1, and\n4.3.8.2 respectively). Load Control Information reflects the operating\nstatus of the resources of the originating GTP control plane node.\n\n  NOTE\u00c2\u00a01:  How a node computes its Load Control Information is\n         implementation dependent.\n\nWhere certain pre-condition as described in clause\u00c2\u00a012.2.4.1 of\nTS\u00c2\u00a029.274\u00c2\u00a0[43], is applicable, an optional feature APN level load control\nmay be supported and activated in the network. If this feature is\nactivated, the PDN GW may convey the Load Control Information at APN level\n(reflecting the operating status of the resources at the APN level),\nbesides at node level.\n\nGTP-C Load Control feature allows the Serving GW to send its Load Control\nInformation to the MME/SGSN.\n\nGTP-C Load Control feature also allows the PDN GW to send its Load Control\nInformation to the MME/SGSN via a Serving GW.\n\nUpon receiving Load Control Information the MME/SGSN supporting GTP-C Load\nControl feature uses it according to clauses\u00c2\u00a04.3.8.1, and 4.3.8.2 for \"PDN\nGW Selection\" and \"Serving GW Selection\" respectively.\n\nA node supporting GTP-C Load Control feature sends Load Control Information\nin any GTP control plane request or response message such that exchange of\nLoad Control Information does not trigger extra signalling.\n\nA node supporting GTP-C Load Control feature sends Load Control Information\nto a peer GTP control node based on whether local configuration allows for\nit.\n\nA node supporting GTP-C Load Control feature may decide to send different\nvalues of Load Control Information on inter-network (roaming) and on intra-\nnetwork (non-roaming) interfaces based on local configuration.\n\nLocal configuration may allow the VPLMN to decide whether or not to act\nupon Load Control Information sent from a peer GTP control plane node in\nthe HPLMN.\n\n  NOTE\u00c2\u00a02:  Refer to clause\u00c2\u00a012 of TS\u00c2\u00a029.274\u00c2\u00a0[43] for the details, such as\n         exact format of the Load Control Information, mechanisms to\n         discover the support of the feature by the peer node, interfaces\n         for which this feature is applicable, APN level load control, etc.\n\n\n"}, {"key": "GTP-C Overload Control", "numbering": "4.3.7.1a.2", "title_level": 4, "desc": "4.3.7.1a.2  GTP-C Overload Control\n\nGTP-C Overload Control feature is an optional feature. Nodes using GTP\ncontrol plane signalling may support communication of Overload Control\nInformation in order to mitigate overload situation for the overloaded node\nthrough actions taken by the peer node(s). This feature is supported over\nS4, S11, S5 and S8 interfaces via GTPv2 control plane protocol.\n\nA GTP-C node is considered to be in overload when it is operating over its\nnominal capacity resulting in diminished performance (including impacts to\nhandling of incoming and outgoing traffic). Overload Control Information\nreflects an indication of when the originating node has reached such\nsituation. This information, when transmitted between GTP-C nodes may be\nused to reduce and/or throttle the amount of GTP-C signalling traffic\nbetween these nodes. As such, the Overload Control Information provides\nguidance to the receiving node to decide actions which leads to mitigation\ntowards the sender of the information.\n\n  NOTE\u00c2\u00a01:  How a node determines its Overload Control Information is\n         implementation dependent.\n\nThe Overload Control Information may convey information regarding the node\nitself and/or regarding specific APN(s) status. In order to mitigate\noverload,\n\n  -  it shall be possible to signal control information about the overload\n    of a GTP-C node (e.g. S-GW, P-GW);\n\n  -  the PDN GW may detect overload for certain APNs, e.g. based on\n    Diameter overload indication received from a PCRF or from an external\n    AAA server, or e.g. based on shortage of resources for an APN (IP\n    address pool). It shall be possible to signal appropriate control\n    information about the APN status in addition to the mechanism described\n    in clause\u00c2\u00a04.3.7.5.\n\nFor a given APN, the PDN GW shall either activate the congestion control by\nconveying the Overload Control Information at APN level or by conveying the\n\"PDN GW back-off time\" (as specified in clause\u00c2\u00a04.3.7.5), but not both at\nthe same time, as specified in more detail in clause\u00c2\u00a012.3.8 of\nTS\u00c2\u00a029.274\u00c2\u00a0[43].\n\nGTP-C Overload Control feature allows the MME/SGSN to send its Overload\nControl Information to the PDN GW via Serving GW.\n\nGTP-C Overload Control feature allows the Serving GW to send its Overload\nControl Information to the MME/SGSN and P-GW.\n\nGTP-C Overload Control feature also allows the PDN GW to send its Overload\nControl Information to the MME/SGSN via a Serving GW.\n\nGTP-C overload Control feature should continue to allow for preferential\ntreatment of priority users (eMPS) and emergency services as per existing\nspecifications.\n\nAn MME/SGSN may during ESM and EMM procedures apply certain restrictions\ntowards GWs (Serving GW and/or PDN GW as applicable) that have indicated\noverload, e.g.:\n\n  -  reject EPS Session Management requests from the UE (e.g. PDN\n    Connectivity, Bearer Resource Allocation or Bearer Resource\n    Modification Requests) with a Session Management back-off timer as\n    described in clause\u00c2\u00a04.3.7.4.2;\n\n  -  reject Mobility Management signalling requests from UEs (such as\n    Attach, Detach, Service Request, Tracking Area Update) with a Mobility\n    Management back-off timer (e.g. reject Service Request requiring to\n    activate user plane bearers in an overloaded SGW) as described in\n    clause\u00c2\u00a04.3.7.4.2;\n\n  -  reject or accept requests for data transmission via Control Plane CIoT\n    EPS Optimisation from UEs (e.g. Control Plane Service Request and ESM\n    Data Transport) with a Control Plane data back-off timer as described\n    in clause\u00c2\u00a04.3.7.4.2.7;\n\n  -  may reduce/throttle messages towards the GWs indicating overload\n    status;\n\n  -  other implementation specific mechanisms, which are outside the scope\n    of 3GPP specifications.\n\nA PDN GW may take the following actions for MME/SGSN which have indicated\noverload:\n\n  -  Limit or completely block non-GBR dedicated bearer establishment;\n\n  -  Limit or completely block all Dedicated Bearer establishments or\n    modification, except QCI=1 bearers;\n\n  -  Limit or completely block all Dedicated Bearer establishments,\n    including the QCI=1 bearers;\n\n  -  other implementation specific mechanisms, which are outside the scope\n    of 3GPP specifications.\n\nA node supporting GTP-C Overload Control feature sends Overload Control\nInformation in any GTP control plane request or response message such that\nexchange of Overload Control Information does not trigger extra signalling.\n\nThe computation and transfer of the Overload Control Information shall not\nadd significant additional load to the node itself and to its corresponding\npeer nodes. The calculation of Overload Control Information should not\nseverely impact the resource utilization of the node.\n\nBased on local policies/configuration, a GTP-C node may support Overload\nControl feature and act upon or ignore Overload Control Information in the\nVPLMN when received from HPLMN and in the HPLMN when received from VPLMN.\nWhen this feature is supported, a GTP-C node may decide to send different\nvalues of Overload Control Information on inter-network (roaming) and on\nintra-network (non-roaming) interfaces based on local\npolicies/configuration.\n\n  NOTE\u00c2\u00a02:  Refer to clause\u00c2\u00a012 of TS\u00c2\u00a029.274\u00c2\u00a0[43] for the details, such as\n         exact format of the Overload Control Information, mechanisms to\n         discover the support of the feature by the peer node, interfaces\n         for which this feature is applicable, APN level overload control,\n         etc.\n\n\n"}, {"key": "Load balancing between MMEs", "numbering": "4.3.7.2", "title_level": 3, "desc": "4.3.7.2  Load balancing between MMEs\n\nThe MME Load Balancing functionality permits UEs that are entering into an\nMME Pool Area to be directed to an appropriate MME in a manner that\nachieves load balancing between MMEs. This is achieved by setting a Weight\nFactor for each MME, such that the probability of the eNodeB selecting an\nMME is proportional to its Weight Factor. The Weight Factor is typically\nset according to the capacity of an MME node relative to other MME nodes.\nThe Weight Factor is sent from the MME to the eNodeB via S1-AP messages\n(see TS\u00c2\u00a036.413\u00c2\u00a0[36]). If a HeNB GW is deployed, the Weight Factor is sent\nfrom the MME to the HeNB GW.\n\n  NOTE\u00c2\u00a01:  An operator may decide to change the Weight Factor after the\n         establishment of S1-MME connectivity as a result of changes in the\n         MME capacities. E.g., a newly installed MME may be given a very\n         much higher Weight Factor for an initial period of time making it\n         faster to increase its load.\n\n  NOTE\u00c2\u00a02:  It is intended that the Weight Factor is NOT changed frequently.\n         e.g. in a mature network, changes on a monthly basis could be\n         anticipated, e.g. due to the addition of RAN or CN nodes.\n\nIn some networks, the eNodeB may be configured to select specific MME for\nUEs configured for low access priority with a different load balance to\nthat used for MME selection for other UEs.\n\n  NOTE\u00c2\u00a03:  The eNodeB can determine whether or not the \"UE is configured\n         for low access priority\" from information received in the RRC\n         establishment or RRC resume signalling.\n\nWhen DCNs are used, load balancing by eNodeB is only performed between MMEs\nthat belong to the same DCN within the same MME pool area, i.e. MMEs with\nthe same PLMN and MMEGI value. When an MME serves multiple DCNs and one DCN\nis supported by multiple MMEs, in order to achieve load balancing across\nthe MMEs of the same MME pool area supporting the same DCN, each DCN\nsupported by this MME may have its own Weight Factor (Weight Factor per\nDCN). The Weight Factor per DCN is set according to the capacity of an MME\nnode for a specific DCN relative to other MME nodes' capacity for that DCN\nwithin the same MME pool area. The eNB is provided with per DCN Weight\nFactors, if any, by the connected MMEs at the set-up of the S1 connection.\nThe DCN Load Balancing functionality permits UEs that are entering into a\npool area or being re-directed to an appropriate DCN to be distributed in a\nmanner that achieves load balancing between the CN nodes of the same DCN.\nThe eNodeB may be configured to select MME(s) from a specific CN for UEs\nconfigured for low access priority only for the case that no other\ninformation and configuration is available for selecting an MME from a\nspecific DCN.\n\n\n"}, {"key": "Load re-balancing between MMEs", "numbering": "4.3.7.3", "title_level": 3, "desc": "4.3.7.3  Load re-balancing between MMEs\n\nThe MME Load Re-balancing functionality permits UEs that are registered on\nan MME (within an MME Pool Area) to be moved to another MME.\n\n  NOTE\u00c2\u00a01:  An example use for the MME Load Re-balancing function is for the\n         O+M related removal of one MME from an MME Pool Area.\n\n  NOTE\u00c2\u00a02:  Typically, this procedure should not be used when the MME\n         becomes overloaded because the Load Balancing function should have\n         ensured that the other MMEs in the pool area are similarly\n         overloaded.\n\nThe eNodeBs may have their Load Balancing parameters adjusted beforehand\n(e.g. the Weight Factor is set to zero if all subscribers are to be removed\nfrom the MME, which will route new entrants to the pool area into other\nMMEs).\n\nIn addition the MME may off-load a cross-section of its subscribers with\nminimal impacts on the network and users (e.g. the MME should avoid\noffloading only the low activity users while retaining the high activity\nsubscribers. Gradual rather than sudden off-loading should be performed as\na sudden re-balance of large number of subscribers could overload other\nMMEs in the pool. With minimal impact on network and the user's experience,\nthe subscribers should be off-loaded as soon as possible). The load re-\nbalancing can off-load part of or all the subscribers.\n\nTo off-load ECM-CONNECTED mode UEs, the MME initiates the S1 Release\nprocedure with release cause \"load balancing TAU required\" (clause 5.3.5).\nThe S1 and RRC connections are released and the UE initiates a TAU but\nprovides neither the S-TMSI nor the GUMMEI to eNodeB in the RRC\nestablishment.\n\n  NOTE\u00c2\u00a03:  Special care needs to be taken when offloading Relay Nodes. This\n         is because there may be UEs connected to the RN and some of these\n         UEs may be registered on other MMEs.\n\nThe MME should not release all S1 connections which are selected to be\nreleased immediately when offloading is initiated. The MME may wait until\nthe S1 Release is performed due to inactivity. When the MME is to be\noffloaded completely the MME can enforce an S1 Release for all remaining\nUEs that were not offloaded by normal TAU procedures or by S1 releases\ncaused by inactivity.\n\nTo off-load UEs which perform TA Updates or Attaches initiated in ECM-IDLE\nmode, the MME completes that procedure and the procedure ends with the MME\nreleasing S1 with release cause \"load balancing TAU required\". The S1 and\nRRC connections are released and the UE initiates a TAU but provides\nneither the S-TMSI nor the GUMMEI to eNodeB in the RRC establishment.\n\nWhen the UE provides neither the S-TMSI nor the GUMMEI in the RRC\nestablishment, the eNodeB should select an MME based on the Weight Factors\nof the MMEs in the pool.\n\nTo off-load UEs in ECM-IDLE state without waiting for the UE to perform a\nTAU or perform Service request and become ECM-CONNECTED, the MME first\npages UE to bring it to ECM-CONNECTED state. If paging the UE fails and ISR\nis activated, the MME should adjust its paging retransmission strategy\n(e.g. limit the number of short spaced retransmissions) to take into\naccount the fact that the UE might be in GERAN/UTRAN coverage.\n\nHardware and/or software failures within an MME may reduce the MME's load\nhandling capability. Typically such failures should result in alarms which\nalert the operator/O+M system. Only if the operator/O+M system is sure that\nthere is spare capacity in the rest of the pool, the operator/O+M system\nmight use the load re-balancing procedure to move some load off this MME.\nHowever, extreme care is needed to ensure that this load re-balancing does\nnot overload other MMEs within the pool area (or neighbouring SGSNs) as\nthis might lead to a much wider system failure.\n\nWhen the Dedicated Core Network (DCN) feature is used, the DCN load re-\nbalancing functionality permits UEs that are registered on an MME in the\nDCN (within a pool area) to be moved to another MME in the same DCN in a\nmanner that achieves load balancing between the CN nodes of the DCN and\npool area. The DCN load re-balancing is triggered by the source MME (within\na DCN). The details are as follows:\n\n  -  If the UE is in ECM-IDLE state, the NAS Message Redirection procedure\n    (see clause\u00c2\u00a05.19.1) is triggered at the next intra-MME Tracking Area\n    Update Request enabling eNodeB to load balance between MMEs of the same\n    DCN. To off-load UEs in ECM-IDLE state without waiting for the UE to\n    perform a TAU or perform Service request, the MME first pages the UE to\n    bring it to ECM-CONNECTED state and proceeds as decribed for the ECM-\n    CONNECTED case below.\n\n  -  If the UE is in ECM-CONNECTED state, the MME performs the GUTI\n    reallocation procedure, includes the unchanged GUTI of the UE and a non-\n    broadcast TAI to induce the UE to peform a TAU procedure, and forces\n    the UE to go to ECM-IDLE state. During the subsequent TAU procedure the\n    MME uses the NAS Message Redirection procedure (see clause\u00c2\u00a05.19.1) to\n    redirect the UE to another MME within the same DCN.\n\n\n"}, {"key": "MME control of overload", "numbering": "4.3.7.4", "title_level": 3, "desc": "4.3.7.4  MME control of overload\n\n\n"}, {"key": "General", "numbering": "4.3.7.4.1", "title_level": 4, "desc": "4.3.7.4.1   General\n\nThe MME shall contain mechanisms for avoiding and handling overload\nsituations. These can include the use of NAS signalling to reject NAS\nrequests from UEs.\n\nIn addition, under unusual circumstances, the MME shall restrict the load\nthat its eNodeBs are generating on it if it is configured to enable the\noverload restriction. This can be achieved by the MME invoking the S1\ninterface overload procedure (see TS\u00c2\u00a036.300\u00c2\u00a0[5] and TS\u00c2\u00a036.413\u00c2\u00a0[36]) to all\nor to a proportion of the eNodeB's with which the MME has S1 interface\nconnections. To reflect the amount of load that the MME wishes to reduce,\nthe MME can adjust the proportion of eNodeBs which are sent S1 interface\nOVERLOAD START message, and the content of the OVERLOAD START message.\n\nThe MME should select the eNodeBs at random (so that if two MMEs within a\npool area are overloaded, they do not both send OVERLOAD START messages to\nexactly the same set of eNodeBs).\n\nThe MME may optionally include a Traffic Load Reduction Indication in the\nOVERLOAD START message. In this case the eNodeB shall, if supported, reduce\nthe type of traffic indicated according the requested percentage (see\nTS\u00c2\u00a036.413\u00c2\u00a0[36]).\n\n  NOTE\u00c2\u00a01:  The MME implementation may need to take into account the fact\n         that eNodeBs compliant to Release 9 and earlier version of the\n         specifications do not support the percentage overload indication.\n\nAn MME supporting Control Plane CIoT EPS Optimisation may include an\nindication in the OVERLOAD START message indicating overload from data\ntransfers via Control Plane CIoT EPS Optimisation.\n\nUsing the OVERLOAD START message, the MME can request the eNodeB to:\n\n  -  reject RRC connection requests that are for non-emergency, non-\n    exception reporting and non-high priority mobile originated services;\n    or\n\n  NOTE\u00c2\u00a02:  This blocks PS service and service provided by MSC following an\n         EPS/IMSI attach procedure.\n\n  -  reject new RRC connection requests for EPS Mobility Management\n    signalling (e.g. for TA Updates) for that MME;\n\n  -  only permit RRC connection requests for emergency sessions and mobile\n    terminated services for that MME. This blocks emergency session\n    requests from UEs with USIMs provisioned with Access Classes 11 and 15\n    when they are in their HPLMN/EHPLMN and from UEs with USIMs provisioned\n    with Access Classes 12, 13 and 14 when they are in their home country\n    (defined as the MCC part of the IMSI, see TS\u00c2\u00a022.011\u00c2\u00a0[67]); or.\n\n  NOTE\u00c2\u00a03:  The MME can restrict the number of responses to paging by not\n         sending paging messages for a proportion of the events that\n         initiate paging. As part of this process, the MME can provide\n         preference for paging UEs with Emergency Bearer Services and\n         terminations associated with MPS ARP.\n\n  -  only permit RRC connection requests for high priority sessions,\n    exception reporting and mobile terminated services for that MME;\n\n  -  reject new RRC connection requests from UEs that access the network\n    with low access priority;\n\n  -  not accept RRC connection requests with RRC establishment cause \"mo-\n    data\" or \"delayTolerantAccess\" from UEs that only support Control Plane\n    CIoT EPS Optimisation.\n\n  NOTE\u00c2\u00a04:  The RRC connection requests listed in this clause\u00c2\u00a0also include\n         the request for RRC Connection Resume.\n\nWhen rejecting an RRC connection request for overload reasons the eNodeB\nindicates to the UE an appropriate timer value that limits further RRC\nconnection requests for a while.\n\nAn eNodeB supports rejecting of RRC connection establishments for certain\nUEs as specified in TS\u00c2\u00a036.331\u00c2\u00a0[37]. Additionally, an eNodeB provides\nsupport for the barring of UEs configured for Extended Access Barring, as\ndescribed in TS\u00c2\u00a022.011\u00c2\u00a0[67]. These mechanisms are further specified in\nTS\u00c2\u00a036.331\u00c2\u00a0[37]. If the UE is camping on NB-IoT, Extended Access Barring\ndoes not apply.\n\nAn eNodeB may initiate Extended Access Barring when:\n\n  -  all the MMEs connected to this eNB request to restrict the load for\n    UEs that access the network with low access priority; or\n\n  -  requested by O&M.\n\nIf an MME invokes the S1 interface overload procedure to restrict the load\nfor UEs that access the network with low access priority, the MME should\nselect all eNodeBs with which the MME has S1 interface connections.\nAlternatively, the selected eNodeBs may be limited to a subset of the\neNodeBs with which the MME has S1 interface connection (e.g. particular\nlocation area or where devices of the targeted type are registered).\n\nDuring an overload situation the MME should attempt to maintain support for\nemergency bearer services (see clause\u00c2\u00a04.3.12) and for MPS (see\nclause\u00c2\u00a04.3.18).\n\nWhen the MME is recovering, the MME can either:\n\n  -  send OVERLOAD START messages with new percentage value that permit\n    more traffic to be carried, or\n\n  -  the MME sends OVERLOAD STOP messages.\n\nto some, or all, of the eNodeB(s).\n\nIn addition, to protect the network from overload the MME has the option of\nrejecting NAS request messages which include the low access priority\nindicator before rejecting NAS request messages without the low access\npriority indicator (see clause\u00c2\u00a04.3.7.4.2 for more information).\n\n  NOTE\u00c2\u00a05:  It cannot be guaranteed that voice services will be available\n         for mobile terminated calls while the Mobility Management back-off\n         timer is running. It is recommended, that UEs requiring voice\n         services are not configured for low access priority.\n\nIn addition, for UEs that don't support the Service Gap Control feature\n(see clause\u00c2\u00a04.3.17.9), the MME may use \"General NAS level Mobility\nManagement control\" as defined in clause\u00c2\u00a04.3.7.4.2.1.\n\n\n"}, {"key": "Throttling of Downlink Data Notification Requests", "numbering": "4.3.7.4.1a", "title_level": 4, "desc": "4.3.7.4.1a  Throttling of Downlink Data Notification Requests\n\nUnder unusual circumstances (e.g. when the MME load exceeds an operator\nconfigured threshold), the MME may restrict the signalling load that its\nSGWs are generating on it, if configured to do so.\n\nThe MME can reject Downlink Data Notification requests for non-priority\ntraffic for UEs in idle mode or to further offload the MME, the MME can\nrequest the SGWs to selectively reduce the number of Downlink Data\nNotification requests it sends for downlink non-priority traffic received\nfor UEs in idle mode according to a throttling factor and for a throttling\ndelay specified in the Downlink Data Notification Ack message.\n\nThe SGW determines whether a bearer is to be subjected to the throttling of\nDownlink Data Notification Requests on the basis of the bearer's ARP\npriority level and operator policy (i.e. operator's configuration in the\nSGW of the ARP priority levels to be considered as priority or non-\npriority traffic). While throttling, the SGW shall throttle the Downlink\nData Notification Requests for low and normal priority bearers by their\npriority. The MME determines whether a Downlink Data Notification request\nis priority or non-priority traffic on the basis of the ARP priority level\nthat was received from the SGW and operator policy.\n\nIf ISR is not active for the UE, during the throttling delay, the SGW drops\ndownlink packets received on all its non-priority bearers for UEs known as\nnot user plane connected (i.e. the SGW context data indicates no downlink\nuser plane TEID) served by that MME in proportion to the throttling factor,\nand sends a Downlink Data Notification message to the MME only for the non\nthrottled bearers.\n\nIf ISR is active for the UE, during the throttling delay, the SGW does not\nsend DDN to the MME and only sends the DDN to the SGSN. If both MME and\nSGSN are requesting load reduction, the SGW drops downlink packets received\non all its non-priority bearers for UEs known as not user plane connected\n(i.e. the SGW context data indicates no downlink user plane TEID) in\nproportion to the throttling factors.\n\nThe SGW resumes normal operations at the expiry of the throttling delay.\nThe last received value of the throttling factor and throttling delay\nsupersedes any previous values received from that MME. The reception of a\nthrottling delay restarts the SGW timer associated with that MME.\n\n\n"}, {"key": "Throttling of NIDD Submit Requests", "numbering": "4.3.7.4.1b", "title_level": 4, "desc": "4.3.7.4.1b  Throttling of NIDD Submit Requests\n\nUnder unusual circumstances (e.g. when the MME load exceeds an operator\nconfigured threshold), the MME may restrict NIDD Submit Request messages\nthat its SCEFs are generating on it, if configured to do so.\n\n\n"}, {"key": "NAS level congestion control", "numbering": "4.3.7.4.2", "title_level": 4, "desc": "4.3.7.4.2   NAS level congestion control\n\n\n4.3.7.4.2.1 General\n\nNAS level congestion control contains the functions: \"APN based congestion\ncontrol\" and \"General NAS level Mobility Management control\".\n\nThe use of the APN based congestion control is for avoiding and handling of\nEMM and ESM signalling congestion associated with UEs with a particular\nAPN. Both UEs and network shall support the functions to provide APN based\nEMM and ESM congestion control.\n\nThe MME may detect the NAS signalling congestion associated with the APN\nand start and stop performing the APN based congestion control based on\ncriteria such as:\n\n  -  Maximum number of active EPS bearers per APN;\n\n  -  Maximum rate of EPS Bearer activations per APN;\n\n  -  One or multiple PDN GWs of an APN are not reachable or indicated\n    congestion to the MME;\n\n  -  Maximum rate of MM signalling requests associated with the devices\n    with a particular subscribed APN; and/or\n\n  -  Setting in network management.\n\nThe MME may detect the NAS signalling congestion associated with the UEs\nbelonging to a particular group. The MME may start and stop performing the\ngroup specific NAS level congestion control based on criteria such as:\n\n  -  Maximum rate of MM and SM signalling requests associated with the\n    devices of a particular group; and/or\n\n  -  Setting in network management.\n\nThe MME may detect the NAS signalling congestion associated with the UEs\nthat belong to a particular group and are subscribed to a particular APN.\nThe MME may start and stop performing the APN and group specific NAS level\ncongestion control based on criteria such as:\n\n  -  Maximum number of active EPS bearers per group and APN;\n\n  -  Maximum rate of MM and SM signalling requests associated with the\n    devices of a particular group and a particular subscribed APN; and/or\n\n  -  Setting in network management.\n\nThe MME should not apply NAS level congestion control for high priority\naccess and emergency services.\n\nWith General NAS level Mobility Management control, the MME may also use\nthe reject of NAS level Mobility Management signalling requests under\ngeneral congestion conditions such as detecting congestion of one or\nseveral DCNs in an MME serving multiple DCNs.\n\nIn addition, for UEs that don't support the Service Gap Control feature\n(see clause\u00c2\u00a04.3.17.9), the MME may return a Mobility Management back-off\ntimer to the UE in responses to requests where the intention is to send MO\ndata or re-attach with PDN connectivity when the Service gap timer for the\nUE is running at the MME.\n\n\n4.3.7.4.2.2 APN based Session Management congestion control\n\nThe APN based Session Management congestion control may be activated by MME\ndue to e.g. congestion situation at MME, or by OAM at MME, or by a restart\nor recovery condition of a PDN\u00c2\u00a0GW, or by a partial failure or recovery of a\nPDN\u00c2\u00a0GW for a particular APN(s).\n\nThe MME may reject the EPS Session Management (ESM) requests from the UE\n(e.g. PDN Connectivity, or Bearer Resource Allocation Requests) with a\nSession Management back-off timer when ESM congestion associated with the\nAPN is detected. If the UE provides no APN, then the MME uses the APN which\nis used in PDN\u00c2\u00a0GW selection procedure.\n\nThe MME may deactivate PDN connections belonging to a congested APN by\nsending the NAS Deactivate EPS Bearer Context Request message to the UE\nwith a Session Management back-off timer. If Session Management back-off\ntimer is set in the NAS Deactivate EPS Bearer Context Request message then\nthe cause \"reactivation requested\" should not be set.\n\n  NOTE\u00c2\u00a01:  UEs that don't support the Session Management back-off timer\n         (including earlier release of UE) might contribute to increasing\n         the signalling load in the MME by reattempting Session Management\n         procedure.\n\nThe MME may store a Session Management back-off time per UE and APN when\ncongestion control is active for an APN if a request without the low access\npriority indicator is rejected by the MME. The MME may immediately reject\nany subsequent request from the UE targeting to the APN before the stored\nSession Management back-off time is expired. If the MME stores the Session\nManagement back-off time per UE and APN and the MME decides to send a\nSession Management Request message to a UE connected to the congested APN\n(e.g. due to decreased congestion situation), the MME shall clear the\nSession Management back-off time prior to sending any Session Management\nRequest message to the UE.\n\n  NOTE\u00c2\u00a02:  The above functionality is to diminish the performance advantage\n         for UEs that do not support the NAS level back-off timer (e.g. pre-\n         Rel-10 UEs) compared to UEs that do support it.\n\nUpon reception of the Session Management back-off timer in the EPS Session\nManagement reject message or in the NAS Deactivate EPS Bearer Context\nRequest message, the UE shall take the following actions until the timer\nexpires:\n\n  -  If APN is provided in the rejected EPS Session Management Request\n    message or if the Session Management back-off timer is received in the\n    NAS Deactivate EPS Bearer Context Request message, the UE shall not\n    initiate any Session Management procedures for the congested APN. The\n    UE may inititate Session Management procedures for other APNs.\n\n  -  If APN is not provided in the rejected EPS Session Management Request\n    message, the UE shall not initiate any Session Management requests of\n    any PDN type without APN. The UE may initiate Session Management\n    procedures for specific APN.\n\n  -  Cell/TA/PLMN/RAT change do not stop the Session Magement back-off\n    timer.\n\n  -  The UE is allowed to initiate the Session Management procedures for\n    high priority access and emergency services even when the Session\n    Management back-off timer is running.\n\n  -  The UE is allowed to initiate Bearer Resource Modification procedure\n    to report 3GPP PS Data Off status change when the EPS Session\n    Management back off timer is running.\n\n  -  If the UE receives a network initiated EPS Session Management Request\n    message for the congested APN while the Session Management back-off\n    timer is running, the UE shall stop the Session Management back-off\n    timer associated with this APN and respond to the MME.\n\n  -  If the UE is configured with a permission for overriding low access\n    priority and the Session Management back-off timer is running due to a\n    reject message received in response to a request with low access\n    priority, the upper layers in the UE may request the initiation of\n    Session Management procedures without low access priority.\n\nThe UE is allowed to initiate PDN disconnection procedure (e.g. sending PDN\nDisconnection Request) when the EPS Session Management back off timer is\nrunning.\n\n  NOTE\u00c2\u00a03:  The UE does not delete the related Session Management back-off\n         timer when disconnecting a PDN connection.\n\nThe UE shall support a separate Session Management back-off timer for every\nAPN that the UE may activate.\n\nTo avoid that large amounts of UEs initiate deferred requests (almost)\nsimultaneously, the MME should select the Session Management back-off timer\nvalue so that deferred requests are not synchronized.\n\nThe APN based Session Management congestion control is applicable to the\nNAS ESM signalling initiated from the UE in the control plane. The Session\nManagement congestion control does not prevent the UE to send and receive\ndata or initiate Service Request procedures for activating user plane\nbearers towards the APN(s) that are under ESM congestion control.\n\n\n4.3.7.4.2.3 APN based Mobility Management congestion control\n\nThe MME may perform the APN based congestion control for UEs with a\nparticular subscribed APN by rejecting Attach procedures with a Mobility\nManagement back-off timer.\n\nWhen congestion control is active for UEs with a particular subscribed APN,\na Mobility Management back-off timer may be sent by the MME to UE.\n\nIf MME maintains the UE context, the MME may store the back-off time per UE\nif a request without the low access priority indicator is rejected by the\nMME. The MME may immediately reject any subsequent request from the UE\nbefore the stored back-off time is expired.\n\n  NOTE\u00c2\u00a01:  The above functionality is to diminish the performance advantage\n         for UEs that do not support the NAS level back-off timer (e.g. pre-\n         Rel-10 UEs) compared to UEs that do support it.\n\nAfter rejecting Attach Requests, the MME should keep the Subscriber Data\nfor some time. This allows for rejection of subsequent requests without HSS\nsignalling when the congestion situation resulting from UEs with a\nparticular subscribed APN persists.\n\n  NOTE\u00c2\u00a02:  Prior to the reject of attach messages of a UE by the MME,\n         Subscriber Data for a UE may be present at the MME because it was\n         not deleted after the UE's detach. In this case when APN based\n         congestion control is active for a particular APN in the MME, the\n         first reject of an attach message by the MME for this UE, may be\n         done without HSS signaling as well.\n\nWhile the Mobility Management back-off timer is running, the UE shall not\ninitiate any NAS request for Mobility Management procedures. However, the\nUE is allowed to initiate the Mobility Management procedures for high\npriority access and emergency services even when the Mobility Management\nback-off timer is running. While the Mobility Management back-off timer is\nrunning, the UE is allowed to perform Tracking Area Update if it is already\nin connected mode.\n\nWhile the Mobility Management back-off timer is running, the UE configured\nwith a permission for overriding low access priority is allowed to initiate\nthe Mobility Management procedures without low access priority if the\nMobility Management back-off timer was started due to a reject message\nreceived in response to a request with low access priority and the upper\nlayers in the UE request to activate a PDN connection without low access\npriority or the UE has an activated PDN connection that is not with low\naccess priority.\n\nTo avoid that large amounts of UEs initiate deferred requests (almost)\nsimultaneously, the MME should select the Mobility Management back-off\ntimer value so that deferred requests are not synchronized.\n\n  NOTE\u00c2\u00a03:  When receiving the Mobility Management back-off timer the UE\n         behaviour is not APN specific.\n\n\n4.3.7.4.2.4 General NAS level Mobility Management congestion control\n\nUnder general overload conditions the MME may reject Mobility Management\nsignalling requests from UEs. When a NAS request is rejected, a Mobility\nManagement back-off timer may be sent by the MME and MME may store the back-\noff time per UE if a request without the low access priority indicator is\nrejected by the MME and if MME maintains the UE context. The MME may\nimmediately reject any subsequent request from the UE before the stored\nback-off time is expired. While the Mobility Management back-off timer is\nrunning, the UE shall not initiate any NAS request for Mobility Management\nprocedures except for Detach procedure and except for high priority access,\nemergency services and mobile terminated services. After any such Detach\nprocedure, the back-off timer continues to run. While the Mobility\nManagement back-off timer is running, the UE is allowed to perform Tracking\nArea Update if it is already in connected mode. If the UE receives a paging\nrequest from the MME while the Mobility Management back off timer is\nrunning, the UE shall stop the Mobility Management back-off timer and\ninitiate the Service Request procedure or the Tracking Area Update\nprocedure as described in clause\u00c2\u00a05.3.3.0.\n\nWhile the Mobility Management back-off timer is running, the UE configured\nwith a permission for overriding low access priority is allowed to initiate\nthe Mobility Management procedures without low access priority if the\nMobility Management back-off timer was started due to a reject message\nreceived in response to a request with low access priority and the upper\nlayers in UE request to establish a PDN connection without low access\npriority or the UE has an established PDN connection that is without low\naccess priority.\n\nWhile the Mobility Management back-off timer is running, the UE configured\nwith permission for sending exception reporting is allowed to initiate the\nControl Plane Service Request procedure for exception reporting. If the\nMobility Management back-off timer was started due to a reject message\nreceived in response to a request for exception reporting, the UE shall not\ninitiate the Control Plane Service Request procedure for exception\nreporting while the Mobility Management back-off timer is running.\n\nThe Mobility Management back-off timer shall not impact Cell/RAT and PLMN\nchange. Cell/RAT and TA change do not stop the Mobility Management back-off\ntimer. The Mobility Management back-off timer shall not be a trigger for\nPLMN reselection. The back-off timer is stopped as defined in\nTS\u00c2\u00a024.301\u00c2\u00a0[46] when a new PLMN that is not an equivalent PLMN is accessed.\n\nTo avoid that large amounts of UEs initiate deferred requests (almost)\nsimultaneously, the MME should select the Mobility Management back-off\ntimer value so that the deferred requests are not synchronized.\n\nWhen the UE receives a handover command, the UE shall proceed with the\nhandover procedure regardless of whether Mobility Management back-off timer\nis running.\n\nThe MME should not reject Tracking Area Update procedures that are\nperformed when the UE is already in connected mode.\n\nFor idle mode inter CN node mobility, the MME may reject Tracking Area\nUpdate procedures and include a Mobility Management back off timer value in\nthe Tracking Area Reject message.\n\nIf the MME rejects Tracking Area Update request or Service request with a\nMobility Management back-off timer which is larger than the sum of the UE's\nperiodic TAU timer plus the Implicit Detach timer, the MME should adjust\nthe mobile reachable timer and/or Implicit Detach timer such that the MME\ndoes not implicitly detach the UE while the Mobility Management back-off\ntimer is running.\n\n  NOTE:  This is to minimize unneeded signalling after the Mobility\n         Management back-off timer expires.\n\n\n4.3.7.4.2.5 Group specific NAS level congestion control\n\nThe group specific NAS level congestion control applies to a specific group\nof UEs. Each group has a group identifier assigned.\n\nA UE belongs to a group, if the corresponding group identifier is stored in\nthe UE's subscription data in the HSS. A UE may belong to multiple groups\nand the MME may perform the Group specific NAS level congestion control to\nan UE as described below independent of whether Group specific NAS level\ncongestion control is activated for one, multiple, or all groups the UE\nbelongs to. The group identifier shall be stored per UE in the HSS and\nobtained by the MME as part of normal HSS signalling. A UE is not aware of\na group subscription.\n\nThe group specific NAS level congestion control may be activated for\nSession Management signalling, or for Mobility Management signalling, or\nboth. The group specific NAS level congestion control is activated based on\noperator policies.\n\nWhen the group specific NAS level congestion control for Session Management\nsignalling is active for a particular group, the MME's behaviour is similar\nto that in clause\u00c2\u00a04.3.7.4.2.2, with the following modifications:\n\n  -  MME may apply ESM congestion control to all subscribed APNs for UEs\n    that belong to this particular group.\n\n  NOTE:  How the MME applies ESM congestion control to all subscribed APNs\n         is left to Stage 3.\n\n  -  The MME rejects the EPS Session Management (ESM) request(s) from the\n    UE belonging to this particular group (e.g. PDN Connectivity, or Bearer\n    Resource Allocation Requests) with a Session Management back-off timer.\n\nWhen group specific NAS level congestion control for Mobility Management\nsignalling is active for a particular group, the MME's behaviour is similar\nto that in clause\u00c2\u00a04.3.7.4.2.3, but applied to UEs subscribed to this\nparticular group rather that subscribed to a particular APN.\n\nGroup specific NAS level congestion control is performed at the MME based\non the UE's subscription information provided by the HSS. There is no\nimpact on the UE, and hence, UE's behaviour as described in clauses\n4.3.7.4.2.2 and 4.3.7.4.2.3 does not change.\n\n\n4.3.7.4.2.6 APN and group specific NAS level congestion control\n\nThe APN and group specific NAS level congestion control is the\ninterclause\u00c2\u00a0of APN specific NAS level congestion control and Group specific\nNAS level congestion control, i.e. it applies to a specific group of UEs\nwith a particular subscribed APN. Each group of UEs has a group identifier\nassigned and stored in the HSS.\n\nA UE may belong to multiple groups and the MME may perform the APN and\ngroup specific NAS level congestion control to an UE as described below\nindependent of whether the APN and group specific NAS level congestion\ncontrol is activated for one, multiple or all groups the UE belongs to. The\ngroup identifier(s) shall be stored per UE in the HSS and obtained by the\nMME as part of normal HSS signalling. A UE is not aware of the group\nidentifier(s) that the UE belongs to.\n\nThe APN and group specific NAS level congestion control may be activated\nfor Session Management signalling, or for Mobility Management signalling,\nor both. The APN and group specific NAS level congestion control is\nactivated based on operator policies.\n\nWhen the APN and group specific NAS level congestion control for Session\nManagement signalling is activated for a UE belonging to a particular group\nand initiating signalling to a particular APN, the MME's behaviour is\nsimilar to that in clause\u00c2\u00a04.3.7.4.2.2, with the following modifications:\n\n  -  The EPS Session Management (ESM) congestion control is applied to this\n    particular APN, and for UEs belonging to this particular group,\n\n  -  The MME may reject ESM requests from the UEs belonging to this\n    particular group and attaching to this particular APN (e.g. PDN\n    Connectivity, or Bearer Resource Allocation Requests) with a Session\n    Management back-off timer. If the UE provides no APN, then the MME uses\n    the APN which is used in PDN GW selection procedure.\n\n  -  The MME may deactivate PDN connections of the UEs, belonging to this\n    particular group and attaching to this particular APN, by sending the\n    NAS Deactivate EPS Bearer Context Request message to the UE with a\n    Session Management back-off timer.\n\nWhen the APN and group specific NAS level congestion control for Mobility\nManagement signalling is activated for a UE belonging to a particular group\nand with a particular subscribed APN, the MME's behaviour is similar to\nthat in clause\u00c2\u00a04.3.7.4.2.3, but applied to UEs with this particular\nsubscribed APN and belonging to this particular group.\n\nAPN and group specific NAS level congestion control is performed at the MME\nbased on the UE's subscription information provided by the HSS. There is no\nimpact on the UE, and hence, UE's behaviour described in\nclauses\u00c2\u00a04.3.7.4.2.2 and 4.3.7.4.2.3 does not change.\n\n\n4.3.7.4.2.7 Control Plane data specific NAS level congestion control\n\nUnder overload conditions the MME may restrict requests from UEs for data\ntransmission via Control Plane CIoT EPS Optimisation. A Control Plane data\nback-off timer may be returned by the MME (e.g.in Attach/TAU/RAU Accept\nmessages, Service Reject message or Service Accept message). While the\nControl Plane data back-off timer is running, the UE shall not initiate any\ndata transfer via Control Plane CIoT EPS Optimisation, i.e. the UE shall\nnot send any Control Plane Service Request with ESM Data Transport message\nas defined in TS\u00c2\u00a024.301\u00c2\u00a0[46]. The MME shall store the Control Plane data\nback-off timer per UE and shall reject any further request (other than\nexception reporting and a response to paging) for data transmission via\nControl Plane Service Request from that UE while the Control Plane data\nback-off timer is still running.\n\n  NOTE\u00c2\u00a01:  The Control Plane data back-off timer does not affect any other\n         mobility management or session management procedure.\n\n  NOTE\u00c2\u00a02:  The Control Plane data back-off timer does not apply to user\n         plane data communication.\n\nIf the UE is allowed to send exception reporting, the UE may initiate\nControl Plane Service Request for exception reporting even if Control Plane\ndata back-off timer is running.\n\nThe UE may respond with Control Plane Service Request without ESM Data\nTransport to a paging even if the Control Plane data back-off timer is\nrunning.\n\nIf the MME receives a Control Plane Service Request in reponse to paging,\nand the MME has a Control Plane data back-off timer running for the UE, and\nthe MME is not overloaded, and MME decides to accept the Control Plane\nService Request, then the MME shall respond with Service Accept message\nwithout the Control Plane data back-off timer and stop the Control Plane\ndata back-off timer. If the UE receives a Service Accept message without\nthe Control Plane data back-off timer from the MME while the Control Plane\ndata back-off timer is running, the UE shall stop the Control Plane data\nback-off timer. The Control Plane data back-off timer in the UE and the MME\nis stopped at PLMN change.\n\nIf the MME receives a Control Plane Service Request with ESM Data Transport\nmessage, and decides to send the UE a Control Plane data back-off timer,\nthe MME may decide to process the Control Plane Service Request with ESM\nData Transport message, i.e. decrypt and forward the data payload, or not\nbased on the following:\n\n  -  If the UE has additionally indicated in a NAS Release Assistance\n    Information in the NAS PDU that no further Uplink or Downlink Data\n    transmissions are expected, then the MME may process (integrity\n    check/decipher/forward) the received Control Plane data packet, and\n    send SERVICE ACCEPT to the UE with Control Plane data back-off timer.\n    The UE interprets this as successful transmission of the Control Plane\n    data packet and  starts the Control Plane data back-off timer.\n\n  -  For all other cases, the MME may decide to not process the received\n    control plane data packet and sends SERVICE REJECT to the UE with\n    Control Plane data back-off timer. The UE interprets this indication as\n    unsuccessful delivery of the control plane data packet and  starts the\n    Control Plane data back-off timer. Then MME may take into consideration\n    whether the PDN Connection is set to Control Plane only to make the\n    decision whether to reject the packet and send SERVICE REJECT or move\n    the PDN connection to user plane and process the data packet.\n\n  -  Alternatively, if UE has not provided in the in Control Plane service\n    request the NAS Release Assistance Information, and the EPS bearer\n    belongs to a PDN connection not set to Control Plane only, and UE\n    supports User Plane CIoT Optimisation (or legacy S1-U), then the MME\n    may initiate establishment of S1-U bearer during Data Transport in\n    Control Plane CIoT EPS Optimisation (according to the procedure defined\n    in clause\u00c2\u00a05.3.4B.4). In this case MME may also return a Control Plane\n    data back-off timer within the NAS message.\n\nThe MME only includes the Control Plane data back-off timer if the UE has\nindicated support for Control Plane data back-off timer in the\nAttach/TAU/RAU request.\n\n  NOTE\u00c2\u00a03:  If the MME is overloaded or close to overload, but the UE has\n         not indicated support for Control Plane data back-off timer, the\n         MME can use other overload control mechanisms, e.g. mobility\n         management back-off timer or use user plane data communication.\n\n\n"}, {"key": "PDN GW control of overload", "numbering": "4.3.7.5", "title_level": 3, "desc": "4.3.7.5  PDN GW control of overload\n\nThe PDN GW may provide mechanisms for avoiding and handling overload\nsituations. These include the rejection of PDN connection requests from\nUEs.\n\nThe PDN GW may detect APN congestion and start and stop performing overload\ncontrol based on criteria such as:\n\n  -  Maximum number of active bearers per APN; and/or\n\n  -  Maximum rate of bearer activations per APN.\n\nWhen performing overload control the PDN GW rejects PDN connection\nrequests. When receiving the rejection from the PDN GW, the MME rejects the\nUE's PDN connection request as specified in clause\u00c2\u00a04.3.7.4.2. In addition\nthe PDN GW may indicate a \"PDN\u00c2\u00a0GW back-off time\" for a specific APN to the\nMME. The MME should reject PDN connection requests, for the specific APN\nrelated to that PDN GW during the \"PDN GW back-off time\", by the means\nspecified in clause\u00c2\u00a04.3.7.4.2. If a PDN GW indicates APN congestion by the\n\"PDN GW back-off time\" the MME may select another PDN GW of that APN\ninstead of rejecting PDN connection requests unless there is already an\nexisting PDN connection to the same APN for the UE, in which case, the MME\nshall reject PDN connection request.\n\n\n"}, {"key": "Selection functions", "numbering": "4.3.8", "title_level": 2, "desc": ""}, {"key": "PDN GW selection function (GPP accesses)", "numbering": "4.3.8.1", "title_level": 3, "desc": "4.3.8  Selection functions\n\n\n4.3.8.1  PDN GW selection function (3GPP accesses)\n\nThe PDN GW selection function allocates a PDN GW that shall provide the PDN\nconnectivity for the 3GPP access. The function uses subscriber information\nprovided by the HSS and possibly additional criteria such as SIPTO/LIPA\nsupport per APN configured in the SGSN/MME, UE support for dual\nconnectivity with NR, 15 EPS bearers support by the UE, CIoT EPS\nOptimisation(s) impacting PDN GW e.g. Non-IP support, Ethernet support, NB-\nIoT RAT support (for generation of accounting information), etc.\n\n  NOTE\u00c2\u00a01:  Selection of PDN GWs optimised for different RATs (e.g. NB-IoT)\n         can be achieved by the allocation of different APNs to subscribers\n         allowed to use specific RATs and/or using the UE Usage Type.\n\nThe criteria for PDN GW selection may include load balancing between PDN\nGWs. When the PDN GW IP addresses returned from the DNS server include\nWeight Factors, the MME should use it if load balancing is required. The\nWeight Factor is typically set according to the capacity of a PDN GW node\nrelative to other PDN GW nodes serving the same APN. For further details on\nthe DNS procedure see TS\u00c2\u00a029.303\u00c2\u00a0[61].\n\nWhen the MME supports the GTP-C Load Control feature, it takes into account\nthe Load Information received from the PDN GW in addition to the Weight\nFactors received from the DNS server to perform selection of an appropriate\nPDN GW.\n\n  NOTE\u00c2\u00a02:  How Weight Factors can be used in conjunction with Load\n         Information received via GTP control plane signalling is left up to\n         Stage 3.\n\nThe PDN subscription contexts provided by the HSS contain:\n\n  -  the identity of a PDN GW and an APN (PDN subscription contexts with\n    subscribed PDN GW address are not used when there is interoperation\n    with pre Rel-8 2G/3G SGSN), or\n\n  -  an APN and an indication for this APN whether the allocation of a PDN\n    GW from the visited PLMN is allowed or whether a PDN GW from the home\n    PLMN shall be allocated. Optionally an identity of a PDN GW may be\n    contained for handover with non-3GPP accesses.\n\n  -  optionally for an APN, an indication of whether SIPTO above RAN, or\n    SIPTO at the Local Network, or both, is allowed or prohibited for this\n    APN.\n\n  -  optionally for an APN, an indication of whether LIPA is conditional,\n    prohibited, or only LIPA is supported for this APN.\n\nIn the case of static address allocation, a static PDN GW is selected by\neither having the APN configured to map to a given PDN GW, or the PDN GW\nidentity provided by the HSS indicates the static PDN GW.\n\nThe HSS also indicates which of the PDN subscription contexts is the\nDefault one for the UE.\n\nTo establish connectivity with a PDN when the UE is already connected to\none or more PDNs, the UE provides the requested APN for the PDN GW\nselection function.\n\nIf one of the PDN subscription contexts provided by the HSS contains a wild\ncard APN (see TS\u00c2\u00a023.003\u00c2\u00a0[9]), a PDN connection with dynamic address\nallocation may be established towards any APN requested by the UE. An\nindication that SIPTO (above RAN, at the local network, or both) is allowed\nor prohibited for the wild card APN allows or prohibits SIPTO for any APN\nthat is not present in the subscription data.\n\nIf the HSS provides the identity of a statically allocated PDN GW, or the\nHSS provides the identity of a dynamically allocated PDN GW and the Request\nType indicates \"Handover\", no further PDN GW selection functionality is\nperformed. If the HSS provides the identity of a dynamically allocated PDN\nGW, the HSS also provides information that identifies the PLMN in which the\nPDN GW is located.\n\n  NOTE\u00c2\u00a03:  The MME uses this information to determine an appropriate APN-OI\n         and S8 protocol type (PMIP or GTP) when the MME and PDN GW are\n         located in different PLMNs.\n\nIf the HSS provides the identity of a dynamically allocated PDN GW and the\nRequest Type indicates \"initial Request\", either the provided PDN GW is\nused or a new PDN GW is selected. When a PDN connection for an APN with\nSIPTO-allowed is requested, the PDN GW selection function shall ensure the\nselection of a PDN GW that is appropriate for the UE's location. The PDN GW\nidentity refers to a specific PDN GW. If the PDN GW identity includes the\nIP address of the PDN GW, that IP address shall be used as the PDN GW IP\naddress; otherwise the PDN GW identity includes an FQDN which is used to\nderive the PDN GW IP address by using Domain Name Service function, taking\ninto account the protocol type on S5/S8 (PMIP or GTP).\n\n  NOTE\u00c2\u00a04:  Provision of a PDN GW identity of a PDN GW as part of the\n         subscriber information allows also for a PDN GW allocation by HSS.\n\nIf the HSS provides a PDN subscription context that allows for allocation\nof a PDN GW from the visited PLMN for this APN and, optionally, the MME is\nconfigured to know that the visited VPLMN has a suitable roaming agreement\nwith the HPLMN of the UE, the PDN GW selection function derives a PDN GW\nidentity from the visited PLMN. If a visited PDN GW identity cannot be\nderived, or if the subscription does not allow for allocation of a PDN GW\nfrom the visited PLMN, then the APN is used to derive a PDN GW identity\nfrom the HPLMN. The PDN GW identity is derived from the APN, subscription\ndata and additional information by using the Domain Name Service function.\nIf the PDN GW identity is a logical name instead of an IP address, the PDN\nGW address is derived from the PDN GW identity, protocol type on S5/S8\n(PMIP or GTP) by using the Domain Name Service function. The S8 protocol\ntype (PMIP or GTP) is configured per HPLMN in MME/SGSN.\n\nIn order to select the appropriate PDN GW for SIPTO above RAN service, the\nPDN GW selection function uses the TAI (Tracking Area Identity), the\nserving eNodeB identifier, or TAI together with serving eNodeB identifier\ndepending on the operator's deployment during the DNS interrogation as\nspecified in TS\u00c2\u00a029.303\u00c2\u00a0[61] to find the PDN GW identity. In roaming\nscenario PDN GW selection for SIPTO is only possible when a PDN GW in the\nvisited PLMN is selected. Therefore in a roaming scenario with home routed\ntraffic, PDN GW selection for SIPTO is not performed.\n\nIn order to select the appropriate GW for SIPTO at the local network\nservice with a stand-alone GW (with S-GW and L-GW collocated), the PDN GW\nselection function uses the APN and the Local Home Network ID during the\nDNS interrogation as specified in TS\u00c2\u00a029.303\u00c2\u00a0[61] to find the PDN GW\nidentity. The Local Home Network ID is provided to the MME by the (H)eNB in\nevery INITIAL UE MESSAGE and every UPLINK NAS TRANSPORT control message as\nspecified in TS\u00c2\u00a036.413\u00c2\u00a0[36]. The MME uses the Local Home Network ID to\ndetermine if the UE has left its current local network and if S-GW\nrelocation is needed.\n\nFor SIPTO at the Local Network with L-GW function collocated with the\n(H)eNB the PDN GW selection function uses the L-GW address proposed by the\n(H)eNB in the S1-AP message, instead of DNS interrogation.\n\nIn order to select the appropriate L-GW for LIPA service, if permitted by\nthe CSG subscription data and if the UE is roaming, the VPLMN LIPA is\nallowed, the PDN GW selection function uses the L-GW address proposed by\nHeNB in the S1-AP message, instead of DNS interrogation. If no L-GW address\nis proposed by the HeNB and the UE requested an APN with LIPA permissions\nset to \"LIPA-only\", the request shall be rejected. If no L-GW address is\nproposed by the HeNB and the UE requested an APN with LIPA permissions set\nto \"LIPA-conditional\", the MME uses DNS interrogation for PDN GW selection\nto establish a non-LIPA PDN connection. The PDN subscription context for an\nAPN with LIPA permissions set to \"LIPA-only\" shall not contain a statically\nconfigured PDN address or a statically allocated PDN GW. A static PDN\naddress or a static PDN GW address, if configured by HSS for an APN with\nLIPA permissions set to \"LIPA-conditional\", is ignored by MME when the APN\nis established as a LIPA PDN connection. When establishing a PDN connection\nfor a LIPA APN, the VPLMN Address Allowed flag is not considered.\n\nThe PDN GW domain name shall be constructed and resolved by the method\ndescribed in TS\u00c2\u00a029.303\u00c2\u00a0[61], which takes into account any value received in\nthe APN-OI Replacement field for home routed traffic. Otherwise, or when\nthe resolution of the above PDN GW domain name fails, the PDN GW domain\nname shall be constructed by the serving node using the method specified in\nAnnex\u00c2\u00a0A of TS\u00c2\u00a023.060\u00c2\u00a0[7] and clause\u00c2\u00a09 of TS\u00c2\u00a023.003\u00c2\u00a0[9]. If the Domain Name\nService function provides a list of PDN GW addresses, one PDN GW address is\nselected from this list. If the selected PDN GW cannot be used, e.g. due to\nan error, then another PDN GW is selected from the list. The specific\ninteraction between the MME/SGSN and the Domain Name Service function may\ninclude functionality to allow for the retrieval or provision of additional\ninformation regarding the PDN GW capabilities (e.g. whether the PDN GW\nsupports PMIP-based or GTP-based S5/S8, or both).\n\n  NOTE\u00c2\u00a05:  The APN as constructed by the MME/SGSN for PDN GW resolution\n         takes into account the APN-OI Replacement field. This differs from\n         the APN that is provided in charging data to another SGSN and MME\n         over the S3, S10 and S16 interfaces as well as to Serving GW and\n         PDN GW over the S11, S4 and S5/S8 interfaces, in that the APN-OI\n         Replacement field is not applied. See clause\u00c2\u00a05.7.2 of the present\n         document for more details.\n\nIf the UE provides an APN for a PDN, this APN is then used to derive the\nPDN GW identity as specified for the case of HSS provided APN if one of the\nsubscription contexts allows for this APN.\n\nIf there is an existing PDN connection to the same APN used to derive the\nPDN GW address, the same PDN GW shall be selected.\n\nAs part of PDN GW selection, an IP address of the assigned PDN GW may be\nprovided to the UE for use with host based mobility as defined in\nTS\u00c2\u00a023.402\u00c2\u00a0[2], if the PDN GW supports host-based mobility for inter-access\nmobility towards accesses where host-based mobility can be used. If a UE\nexplicitly requests the address of the PDN GW and the PDN GW supports host\nbased mobility then the PDN GW address shall be returned to the UE.\n\nWhen DCNs with dedicated PDN GWs are used, the DNS procedure\n(TS\u00c2\u00a029.303\u00c2\u00a0[61]) for PDN GW selection may be used such that a PDN GW\nbelonging to a DCN serving a particular category of UEs, e.g. identified by\nUE Usage Type, is selected. When UEs with the same UE Usage type are served\nby multiple DCNs, it shall also be possible to select the PDN GW belonging\nto the DCN serving the particular UE.\n\n\n"}, {"key": "Serving GW selection function", "numbering": "4.3.8.2", "title_level": 3, "desc": "4.3.8.2  Serving GW selection function\n\nThe Serving GW selection function selects an available Serving GW to serve\na UE. The selection bases on network topology, i.e. the selected Serving GW\nserves the UE's location and for overlapping Serving GW service areas, the\nselection may prefer Serving GWs with service areas that reduce the\nprobability of changing the Serving GW. When SIPTO is allowed then it is\nalso considered as a criterion for Serving GW selection, e.g. when the\nfirst PDN connection is requested. Other criteria for Serving GW selection\nshould include load balancing between Serving GWs, UE support for dual\nconnectivity with NR, CIoT EPS Optimisation(s) impacting Serving GW e.g.\nNon-IP support, Ethernet support, NB-IoT RAT support (for generation of\naccounting information), etc. When the Serving GW IP addresses returned\nfrom the DNS server include Weight Factors, the MME should use it if load\nbalancing is required. The Weight Factor is typically set according to the\ncapacity of a Serving GW node relative to other Serving GW nodes serving\nthe same Tracking area. For further details on DNS procedure see\nTS\u00c2\u00a029.303\u00c2\u00a0[61].\n\nWhen the MME supports the GTP-C Load Control feature, it takes into account\nthe Load Information received from the Serving GW in addition to the Weight\nFactors received from the DNS server to perform selection of an appropriate\nServing GW.\n\n  NOTE\u00c2\u00a01:  How Weight Factors can be used in conjuction with Load\n         Information received via GTP control plane signalling is left up to\n         Stage 3.\n\nIf a subscriber of a GTP only network roams into a PMIP network, the PDN\nGWs selected for local breakout support the PMIP protocol, while PDN GWs\nfor home routed traffic use GTP. This means the Serving GW selected for\nsuch subscribers may need to support both GTP and PMIP, so that it is\npossible to set up both local breakout and home routed sessions for these\nsubscribers. For a Serving GW supporting both GTP and PMIP, the MME/SGSN\nshould indicate the Serving GW which protocol should be used over S5/S8\ninterface. The MME/SGSN is configured with the S8 variant(s) on a per HPLMN\ngranularity.\n\nIf a subscriber of a GTP only network roams into a PMIP network, the PDN\nGWs selected for local breakout may support GTP or the subscriber may not\nbe allowed to use PDN GWs of the visited network. In both cases a GTP only\nbased Serving GW may be selected. These cases are considered as roaming\nbetween GTP based operators.\n\nIf combined Serving and PDN GWs are configured in the network the Serving\nGW Selection Function may preferably derive a Serving GW that is also a PDN\nGW for the UE.\n\nIn order to provide SIPTO at the local network service with stand-alone GW,\nthe L-GW and Serving GW shall be co-located. The Serving GW selection\nfunction in the MME is used to ensure that the Serving GW is provided\naccording to operator policy as described in clause\u00c2\u00a04.3.15a. When the L-GW\nis collocated with the (H)eNB, the Serving GW remains located in the mobile\noperator's core network.\n\nThe Domain Name Service function may be used to resolve a DNS string into a\nlist of possible Serving GW addresses which serve the UE's location. The\nspecific interaction between the MME/SGSN and the Domain Name Service\nfunction may include functionality to allow for the retrieval or provision\nof additional information regarding the Serving GW capabilities (e.g.\nwhether the Serving GW supports PMIP-based or GTP-based S5/S8, or both).\nThe details of the selection are implementation specific.\n\nFor handover from non-3GPP accesses in roaming scenario, the Serving GW\nselection function for local anchoring is described in TS\u00c2\u00a023.402\u00c2\u00a0[2].\n\nThe Serving GW selection function in the MME is used to ensure that all\nTracking Areas in the Tracking Area List belong to the same Serving GW\nservice area.\n\nWhen DCNs with dedicated Serving GWs are used, the DNS procedure\n(TS\u00c2\u00a029.303\u00c2\u00a0[61]) for Serving GW selection may be used such that a Serving\nGW belonging to a DCN serving a particular category of UEs, e.g. identified\nby UE Usage Type, is selected. When UEs with the same UE Usage type are\nserved by multiple DCNs, it shall also be possible to select the Serving GW\nbelonging to the DCN serving the particular UE.\n\n  NOTE\u00c2\u00a02:  Selection of Serving GWs optimised for different RATs (e.g. NB-\n         IoT) can be achieved by using UE Usage Type and/or by using\n         different TAIs for different RATs.\n\n\n"}, {"key": "MME selection function", "numbering": "4.3.8.3", "title_level": 3, "desc": "4.3.8.3  MME selection function\n\nThe MME selection function selects an available MME for serving a UE. The\nselection is based on network topology, i.e. the selected MME serves the\nUE's location and for overlapping MME service areas, the selection may\nprefer MMEs with service areas that reduce the probability of changing the\nMME. When a MME/SGSN selects a target MME, the selection function performs\na simple load balancing between the possible target MMEs. In networks that\ndeploy dedicated MMEs/SGSNs for UEs configured for low access priority, the\npossible target MME selected by source MME/SGSN is typically restricted to\nMMEs with the same dedication.\n\nWhen a MME/SGSN supporting DCNs selects a target MME, the selected target\nMME should be restricted to MMEs that belong to the same DCN. The DNS\nprocedure may be used by the source CN node to select the target MME from a\ngiven DCN. If both low access priority and UE Usage Type parameter are used\nfor MME selection, selection based on UE Usage type parameter overrides\nselection based on the low access priority indication.\n\nWhen a MME supporting CIoT EPS Optimisation(s) selects a target MME, the\nselected MME should all support the CIoT EPS Optimisations applicable to\nthe given UE's attachment. In case the source MME is unable to find a\ntarget MME matching all CIoT EPS Optimisation(s) applicable to a given UE's\nattachment, then the source MME, based on implementation, selects a target\nMME which provides the CIoT EPS Optimisation(s) best applicable to that\nUE's attachment.\n\nWhen an eNodeB selects an MME, the eNodeB may use a selection function\nwhich distinguishes if the GUMMEI is mapped from P-TMSI/RAI or is a native\nGUMMEI. The indication of mapped or native GUMMEI shall be signalled by the\nUE to the eNodeB as an explicit indication. The eNodeB may differentiate\nbetween a GUMMEI mapped from P-TMSI/RAI and a native GUMMEI based on the\nindication signalled by the UE. Alternatively, the differentiation between\na GUMMEI mapped from P-TMSI/RAI and a native GUMMEI may be performed based\non the value of most significant bit of the MME Group ID, for PLMNs that\ndeploy such mechanism. In this case, if the MSB is set to \"0\" then the\nGUMMEI is mapped from P-TMSI/RAI and if MSB is set to \"1\", the GUMMEI is a\nnative one. Alternatively the eNodeB makes the selection of MME only based\non the GUMMEI without distinguishing on mapped or native.\n\nWhen an eNodeB selects an MME, the selection shall achieve load balancing\nas specified in clause\u00c2\u00a04.3.7.2.\n\nWhen DCNs are deployed, to maintain a UE in the same DCN when the UE enters\na new MME pool area, the eNodeB's NNSF should have configuration that\nselects, based on the MMEGIs or NRIs of neighbouring pool areas, a\nconnected MME from the same DCN. Alternately, for PLMN wide inter-pool\nintra-RAT mobility, the operator may divide up the entire MMEGI and NRI\nvalue space into non-overlapping sets with each set allocated to a\nparticular DCN. In this case all eNodeBs may be configured with the same\nMME selection configuration. If UE assisted DCN selection feature is\nsupported and a DCN-ID is provided by the UE, the DCN-ID shall be used in\nthe eNodeB for MME selection to maintain the same DCN when the serving MME\nis not available.\n\nWhen selecting an MME for a UE that is using the NB-IoT RAT, and/or for a\nUE that signals support for CIoT EPS Optimisations in RRC signalling (as\nspecified in TS\u00c2\u00a036.331\u00c2\u00a0[37], for NB-IoT, UE indicates whether it supports\n\"User Plane CIoT EPS Optimisation\" and \"EPS Attach without PDN\nConnectivity\". And for WB-E-UTRAN, UE indicates whether it supports\n\"Control Plane CIoT EPS Optimisation\", \"User Plane CIoT EPS Optimisation\"\nand \"EPS Attach without PDN Connectivity\"), the eNodeB's MME selection\nalgorithm shall select an MME taking into account the MME's support (or non-\nsupport) for the Release 13 NAS signalling protocol.\n\nWhen DCN are deployed for the purpose of CIoT EPS Optimisation, UE included\nCIoT EPS Optimisation information in the RRC signalling, may depending on\neNB configuration, be used to perform initial DCN selection.\n\nWhen Restricted Local Operator Services feature is supported, a UE\ninitiates access to Restricted Local Operator Services via RRC signalling\nas defined in TS\u00c2\u00a036.331\u00c2\u00a0[37]. The UE included RLOS indication in RRC\nsignalling may be used by the eNB to select an approriate MME.\n\n\n"}, {"key": "SGSN selection function", "numbering": "4.3.8.4", "title_level": 3, "desc": "4.3.8.4  SGSN selection function\n\nThe SGSN selection function selects an available SGSN to serve a UE. The\nselection is based on network topology, i.e. the selected SGSN serves the\nUE's location and for overlapping SGSN service areas, the selection may\nprefer SGSNs with service areas that reduce the probability of changing the\nSGSN. When a MME/SGSN selects a target SGSN, the selection function\nperforms a simple load balancing between the possible target SGSNs. In\nnetworks that deploy dedicated MMEs/SGSNs for UEs configured for low access\npriority, the possible target SGSN selected by source MME/SGSN is typically\nrestricted to SGSNs with the same dedication.\n\nWhen a MME/SGSN supporting DCNs selects a target SGSN, the selected target\nSGSN should be restricted to SGSNs that belong to the same CN. The DNS\nprocedure may be used by the source CN node to select the target SGSN from\na given DCN. If both low access priority and UE Usage Type parameter are\nused for SGSN selection, selection based on UE Usage type parameter\noverrides selection based on the low access priority indication.\n\n\n"}, {"key": "Selection of PCRF", "numbering": "4.3.8.5", "title_level": 3, "desc": "4.3.8.5  Selection of PCRF\n\nThe PDN\u00c2\u00a0GW and AF may be served by one or more PCRF nodes in the HPLMN and,\nin roaming with local breakout scenarios, one or more PCRF nodes in the\nVPLMN.\n\nThe selection of PCRF and linking of the different UE's PCC sessions over\nthe multiple PCRF interfaces (e.g. Rx session, Gx session, S9 session etc.)\nfor a UE IP CAN session is described in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n\n"}, {"key": "IP network related functions", "numbering": "4.3.9", "title_level": 2, "desc": "4.3.9  IP network related functions\n\n\n"}, {"key": "Domain Name Service function", "numbering": "4.3.9.1", "title_level": 3, "desc": "4.3.9.1  Domain Name Service function\n\nThe Domain Name Service function resolves logical PDN GW names to PDN GW\naddresses. This function is standard Internet functionality according to\nRFC\u00c2\u00a01034\u00c2\u00a0[17], which allows resolution of any name to an IP address (or\naddresses) for PDN GWs and other nodes within the EPS.\n\n\n"}, {"key": "DHCP function", "numbering": "4.3.9.2", "title_level": 3, "desc": "4.3.9.2  DHCP function\n\nThe Dynamic Host Configuration Function allows to deliver IP configuration\ninformation for UEs. This function is standard Internet functionality\naccording to RFC\u00c2\u00a02131\u00c2\u00a0[19], RFC\u00c2\u00a03736\u00c2\u00a0[20], RFC\u00c2\u00a03633\u00c2\u00a0[21] and RFC\u00c2\u00a04039\u00c2\u00a0[25].\n\n\n"}, {"key": "Explicit Congestion Notification", "numbering": "4.3.9.3", "title_level": 3, "desc": "4.3.9.3  Explicit Congestion Notification\n\nThe E-UTRAN/UTRAN and the UE support the RFC\u00c2\u00a03168\u00c2\u00a0[55] Explicit Congestion\nNotification (ECN), as described in TS\u00c2\u00a036.300\u00c2\u00a0[5], TS\u00c2\u00a025.401\u00c2\u00a0[16] and\nTS\u00c2\u00a026.114\u00c2\u00a0[56].\n\n\n"}, {"key": "Functionality for Connection of eNodeBs to Multiple MMEs", "numbering": "4.3.10", "title_level": 2, "desc": "4.3.10 Functionality for Connection of eNodeBs to Multiple MMEs\n\nAn eNodeB may connect to several MMEs. This implies that an eNodeB must be\nable to determine which of the MMEs, covering the area where an UE is\nlocated, should receive the signalling sent from a UE. To avoid unnecessary\nsignalling in the core network, a UE that has attached to one MME should\ngenerally continue to be served by this MME as long as the UE is in the\nradio coverage of the pool area to which the MME is associated. The concept\nof pool area is a RAN based definition that comprises one or more TA(s)\nthat, from a RAN perspective, are served by a certain group of MMEs. This\ndoes not exclude that one or more of the MMEs in this group serve TAs\noutside the pool area. This group of MMEs is also referred to as an MME\npool.\n\nTo enable the eNodeB to determine which MME to select when forwarding\nmessages from an UE, this functionality defines a routing mechanism (and\nother related mechanism). A routing mechanism (and other related mechanism)\nis defined for the MMEs. The routing mechanism is required to find the\ncorrect old MME (from the multiple MMEs that are associated with a pool\narea). When a UE roams out of the pool area and into the area of one or\nmore MMEs that do not know about the internal structure of the pool area\nwhere the UE roamed from, the new MME will send the Identification Request\nmessage or the Context Request message to the old MME using the GUTI. The\nrouting mechanism in both the MMEs and the eNodeB utilises the fact that\nevery MME that serves a pool area must have its own unique value range of\nthe GUTI parameter within the pool area.\n\n\n"}, {"key": "E-UTRAN Sharing Function", "numbering": "4.3.11", "title_level": 2, "desc": "4.3.11 E-UTRAN Sharing Function\n\nE-UTRAN Sharing is an agreement between operators and shall be transparent\nto the user. This implies that an E-UTRAN UE needs to be able to\ndiscriminate between core network operators available in a shared radio\naccess network and that these operators can be handled in the same way as\noperators in non-shared networks. E-UTRAN terminals support E-UTRAN\nSharing.\n\nAn E-UTRAN Sharing architecture allows different core network operators to\nconnect to a shared radio access network. The operators do not only share\nthe radio network elements, but may also share the radio resources\nthemselves. In addition to this shared radio access network the operators\nmay or may not have additional dedicated radio access networks, like for\nexample, 3G or 2G radio access networks. For E-UTRAN both Multi-Operator\nCore Network (MOCN) configuration and Gateway Core Network (GWCN)\nconfiguration as defined in TS\u00c2\u00a023.251\u00c2\u00a0[24] are supported over the S1\nreference point. E-UTRAN terminals shall support shared networks and hence,\nonly functions for \"Supporting UEs\" in TS\u00c2\u00a023.251\u00c2\u00a0[24] applies for E-UTRAN\nSharing.\n\nE-UTRAN Radio Access Network Sharing functions is further described in\nTS\u00c2\u00a036.300\u00c2\u00a0[5].\n\nIn networks that support network sharing as defined in TS\u00c2\u00a023.251\u00c2\u00a0[24], for\na UE in state ECM-CONNECTED, the Handover Restriction List provided by the\ncore-network to the radio access network is also used to inform the radio\naccess network about the Selected PLMN and equivalent PLMNs as defined in\nTS\u00c2\u00a036.413\u00c2\u00a0[36].\n\n\n"}, {"key": "IMS Emergency Session Support", "numbering": "4.3.12", "title_level": 2, "desc": "4.3.12 IMS Emergency Session Support\n\n\n"}, {"key": "Introduction", "numbering": "4.3.12.1", "title_level": 3, "desc": "4.3.12.1 Introduction\n\nClause\u00c2\u00a04.3.12 IMS Emergency Session provides an overview about\nfunctionality for emergency bearer services in a single clause. This\noverview applies to eCall Over IMS unless stated otherwise. The specific\nfunctionality is described in the affected procedures and functions of this\nspecification. For discrepancies between this overview clause and the\ndetailed procedure and function descriptions the latter take precedence.\n\nEmergency bearer services are provided to support IMS emergency sessions.\nEmergency bearer services are functionalities provided by the serving\nnetwork when the network is configured to support emergency services.\nEmergency bearer services are provided to normal attached or emergency\nattached UEs and depending on local regulation, to UEs that are in limited\nservice state. Receiving emergency services in limited service state does\nnot require a subscription. Depending on local regulation and an operator's\npolicy, the MME may allow or reject an emergency attach request for UEs in\nlimited service state. Four different behaviours of emergency bearer\nsupport have been identified as follows:\n\n  a. Valid UEs only. No limited service state UEs are supported in the\n    network. Only UEs that have a valid subscription, are authenticated and\n    authorized for PS service in the attached location are allowed. UEs\n    should be attached to the network and then perform a PDN Connection\n    Request when an IMS emergency session is detected by the UE.\n\n  b. Only UEs that are authenticated are allowed. These UEs must have a\n    valid IMSI. These UEs are authenticated and may be in limited service\n    state due to being in a location that they are restricted from service.\n    A UE that can not be authenticated will be rejected.\n\n  c. IMSI required, authentication optional. These UEs must have an IMSI.\n    If authentication fails, the UE is granted access and the\n    unauthenticated IMSI retained in the network for recording purposes.\n    The IMEI is used in the network as the UE identifier. IMEI only UEs\n    will be rejected (e.g., UICCless UEs).\n\n  d. All UEs are allowed. Along with authenticated UEs, this includes UEs\n    with an IMSI that can not be authenticated and UEs with only an IMEI.\n    If an unauthenticated IMSI is provided by the UE, the unauthenticated\n    IMSI is retained in the network for recording purposes. The IMEI is\n    used in the network to identify the UE.\n\nTo provide emergency bearer services, the MME is configured with MME\nEmergency Configuration Data that are applied to all emergency bearer\nservices that are established by an MME on UE request. The MME Emergency\nConfiguration Data contain the Emergency APN which is used to derive a PDN\nGW, or the MME Emergency Configuration Data may also contain the statically\nconfigured PDN GW for the Emergency APN.\n\nUEs that are in limited service state, as specified in TS\u00c2\u00a023.122\u00c2\u00a0[10],\ninitiate the Attach procedure with indicating that the attach is to receive\nemergency services. Also UEs that had attached for normal services and do\nnot have emergency bearers established and are camped on a cell in limited\nservice state (e.g. because of restricted Tracking Area or not allowed CSG)\nshall initiate this Attach procedure, indicating that the attach is to\nreceive emergency services. The network supporting emergency services for\nUEs in limited service state provides emergency bearer services to these\nUE, regardless whether the UE can be authenticated, has roaming or mobility\nrestrictions or a valid subscription, depending on local regulation. For\nemergency services other than eCall, the UEs in limited service state\ndetermine that the cell supports emergency services over E-UTRAN from a\nbroadcast indicator in AS. Emergency calls for eCall Over IMS are only\nperformed if the UE has a UICC.\n\nA serving network shall provide an Access Stratum broadcast indication to\nUEs as to whether eCall Over IMS is supported.\n\n  NOTE\u00c2\u00a01:  The Access Stratum broadcast indicator is determined according\n         to operators' preference and minimally indicates that the PLMN, or\n         all of the PLMNs in the case of network sharing, and at least one\n         emergency centre or PSAP to which an eCall Over IMS session can be\n         routed, support eCall Over IMS.\n\nA UE in limited service state determines that the cell supports eCall Over\nIMS using both the broadcast indicator for support of emergency services\nover E-UTRAN and the broadcast indicator for eCall over IMS.\n\n  NOTE\u00c2\u00a02:  The broadcast indicator for eCall Over IMS does not indicate\n         whether UEs in limited service state are supported, as such the\n         broadcast indicator for support of emergency services over E-UTRAN\n         that indicates limited service state support needs to also be\n         applied.\n\nFor a UE that is Emergency Attached, if it is unauthenticated the EPS\nsecurity context is not set up on UE.\n\nUEs that camp normally on a cell, i.e. without any conditions that result\nin limited service state, initiate the normal initial attach procedure if\nnot already attached. Normal attached UEs initiate the UE Requested PDN\nConnectivity procedure to receive emergency bearer services. The UEs that\ncamp normally on a cell are informed that the PLMN supports emergency\nbearer services over E-UTRAN from the Emergency Service Support indicator\nin the Attach and TAU procedures. UEs that camp normally on a cell may also\nuse the emergency attach procedure under conditions specified in\nTS\u00c2\u00a024.301\u00c2\u00a0[46], e.g. when the MM back-off timer is running.\n\n  NOTE\u00c2\u00a03:  Failure of the normal initial attach may occur e.g. when the\n         network rejects the request with a back-off time.\n\n  NOTE\u00c2\u00a04:  The establishment of the emergency bearer services may fail when\n         the UE needs to perform a TAU prior to the UE Requested PDN\n         Connectivity procedure, i.e. the UE moved into a non-registered\n         Tracking Area with the MM back-off timer running in the UE.\n\n  NOTE\u00c2\u00a05:  The Emergency Service Support indicator in the Attach and TAU\n         procedures does not enable support for eCall Over IMS.\n\nFor a UE that is Emergency Attached, normal PLMN selection principles apply\nafter the end of the IMS emergency session.\n\nFor emergency bearer services any EPC functions, procedures and\ncapabilities are provided according to clause\u00c2\u00a04 except when specified\ndifferently in the following clauses.\n\nFor emergency bearer services, there is a risk of service disruption due to\nfailed inter PLMN mobility attempts.\n\nFor emergency bearer services, handover from non-3GPP access to E-UTRAN\naccess is supported as specified in TS\u00c2\u00a023.402\u00c2\u00a0[2] clause\u00c2\u00a04.5.7.2.10.\n\nThe UE shall set the RRC establishment cause or RRC resume cause to\nemergency as defined in TS\u00c2\u00a036.331\u00c2\u00a0[37] when it requests an RRC connection\nin relation to an emergency session. Specific situations that require\nsetting the RRC establishment cause or RRC resume cause to emergency are\ndescribed in TS\u00c2\u00a024.301\u00c2\u00a0[46].\n\nSupport for emergency bearer services is not available when the UE is using\nNB-IoT, i.e. the MME shall not indicate support for emergency bearer\nservices using the Emergency Service Support indicator in the Attach and\nTAU procedures to a UE that accesses the network using a RAT Type equal to\nNB-IoT, and an NB-IoT cell shall not indicate support for emergency\nservices in any broadcast information in AS.\n\nWhen a PLMN supports IMS and emergency bearer services, all MMEs in that\nPLMN shall have the same capability to support emergency bearer services.\n\n  NOTE\u00c2\u00a06:  Idle mode Signalling Reduction (ISR) is not supported by the\n         network for UEs that only have bearers related to emergency bearer\n         service.\n\nFor emergency services other than eCall, a UE that is not in in limited\nservice state, as specified in TS\u00c2\u00a023.122\u00c2\u00a0[10] determines from a NAS\nindicator whether additional emergency numbers/types received via WLAN from\ntrusted sources may be used for detecting emergency calls.\n\n\n"}, {"key": "Architecture Reference Model for Emergency Services", "numbering": "4.3.12.2", "title_level": 3, "desc": "4.3.12.2 Architecture Reference Model for Emergency Services\n\nAccording to clause\u00c2\u00a04.2, the non-roaming architectures (Figure\u00c2\u00a04.2.1-1 and\nFigure\u00c2\u00a04.2.1-2) and roaming architecture with the visited operator's\napplication function (Figure\u00c2\u00a04.2.2-3) apply for emergency services. The\nother roaming architectures with services provided by the home network do\nnot apply for emergency services.\n\n\n"}, {"key": "Mobility and Access Restrictions for Emergency Services", "numbering": "4.3.12.3", "title_level": 3, "desc": "4.3.12.3 Mobility and Access Restrictions for Emergency Services\n\nWhen Emergency Services are supported and local regulation requires\nEmergency Sessions to be provided regardless of mobility or access\nrestrictions, the Mobility Restrictions in clause\u00c2\u00a04.3.5.7, should not be\napplied to UEs receiving emergency services. When the E-RABs for emergency\nbearers are established, the ARP value for emergency bearer services\nindicates the usage for emergency services to the E-UTRAN.\n\nDuring handovers, the source E-UTRAN and source MME ignore any UE related\nrestrictions during handover evaluation when there are active emergency\nbearers. E-UTRAN shall not initiate handover to GERAN PS domain. During\nhandover to a CSG cell, if the UE is not a CSG member of target CSG cell\nand has emergency bearer services, the target eNodeB only accepts the\nemergency bearers and the target MME releases the non-emergency PDN\nconnections that were not accepted by the target eNodeB as specified in\nclause\u00c2\u00a05.10.3. Such UEs behave as emergency attached.\n\nDuring Tracking Area Update procedures, including a TAU as part of a\nhandover, the target MME ignores any mobility or access restrictions for UE\nwith emergency bearer services where required by local regulation. Any non\nemergency bearer services are deactivated, according to clause\u00c2\u00a05.10.3, by\nthe target MME when not allowed by the subscription for the target\nlocation. Such UEs behave as emergency attached. To allow the emergency\nattached UE to get access to normal services after the emergency session\nhas ended and when it has moved to a new area that is not stored by the UE\nas a forbidden area, the UE may explicitly detach and reattach to normal\nservices without waiting for the emergency PDN connection deactivation by\nthe PDN GW.\n\nThis functionality applies to all mobility procedures.\n\n\n"}, {"key": "Reachability Management for UE in ECM-IDLE state", "numbering": "4.3.12.3a", "title_level": 3, "desc": ""}, {"key": "PDN GW selection function (GPP accesses) for Emergency Services", "numbering": "4.3.12.4", "title_level": 3, "desc": "4.3.12.3a   Reachability Management for UE in ECM-IDLE state\n\nAn emergency attached UE when its periodic TAU update timer expires shall\nnot initiate a periodic TAU procedure but enter EMM-DEREGISTERED state. For\nemergency attached UEs the MME runs a mobile reachable timer with a similar\nvalue to the UE's periodic TAU timer. Any time after expiry of this timer\nthe MME may change the EMM state of an emergency attached UE to EMM-\nDEREGISTERED. The MME assigns the periodic TAU timer value to emergency\nattached UE. This timer keeps the UE emergency attached after change to EMM-\nIDLE state to allow for a subsequent emergency service without a need to\nemergency attach again.\n\n\n4.3.12.4 PDN GW selection function (3GPP accesses) for Emergency Services\n\nWhen a PDN GW is selected for IMS emergency services support, the PDN GW\nselection function described in clause\u00c2\u00a04.3.8.1 for normal bearer services\nis applied to the Emergency APN or the MME selects the PDN GW directly from\nthe MME Emergency Configuration Data. If the PDN GW selection function\ndescribed in clause\u00c2\u00a04.3.8.1 is used it shall always derive a PDN GW in the\nvisited PLMN, which guarantees that also the IP address is allocated by the\nvisited PLMN. In networks that support handover between E-UTRAN and HRPD\naccesses, the MME selects a PDN GW that is statically configured in the MME\nEmergency Configuration Data. In networks that support handover between E-\nUTRAN and WLAN accesses, when the UE has been authorized but has not been\nauthenticated, the MME selects the PDN GW that is statically configured in\nthe MME Emergency Configuration Data. The PDN GW selection does not depend\non subscriber information in the HSS since emergency service support is a\nlocal, not subscribed service. The MME Emergency Configuration Data\ncontains the Emergency APN which is used to derive a PDN GW, or the MME\nEmergency Configuration Data may also contain the statically configured PDN\nGW for the Emergency APN.\n\nThis functionality is used by the Attach procedure and by the UE Requested\nPDN Connectivity procedure, in both cases when establishing emergency\nbearer services.\n\n  NOTE:  It is assumed that the PDN GW that is statically configured in the\n         MME Emergency Configuration Data is the same as the PDN GW\n         configured in WLAN and HRPD accesses.\n\n\n"}, {"key": "QoS for Emergency Services", "numbering": "4.3.12.5", "title_level": 3, "desc": "4.3.12.5 QoS for Emergency Services\n\nWhere local regulation require supporting calls from an unauthorised\ncaller, the MME may not have subscription data. Additionally, the local\nnetwork may want to provide IMS emergency services support differently than\nwhat is allowed by a UE subscription. Therefore, the initial QoS values\nused for establishing emergency bearer services are configured in the MME\nin the MME Emergency Configuration Data.\n\n  NOTE:  For IMS emergency services prior to this Release of this\n         specification, dynamic PCC support was not required in the\n         specifications. In such cases, the PDN\u00c2\u00a0GW sets the ARP value that\n         is reserved for emergency services, which the PDN\u00c2\u00a0GW bases on the\n         usage of the Emergency APN.\n\nThis functionality is used by the Attach procedure and by the UE Requested\nPDN Connectivity procedure, in both cases when establishing emergency\nbearer services.\n\n\n"}, {"key": "PCC for Emergency Services", "numbering": "4.3.12.6", "title_level": 3, "desc": "4.3.12.6 PCC for Emergency Services\n\nDynamic PCC is used for UEs establishing emergency service, the procedures\nare as described in TS\u00c2\u00a023.203\u00c2\u00a0[6]. When establishing emergency bearer\nservices with a PDN GW, according to clause\u00c2\u00a04.7.5, the PCRF provides the\nPDN GW with the QoS parameters, including an ARP value reserved for the\nemergency bearers to prioritize the bearers when performing admission\ncontrol. Dynamic PCC shall be used to manage IMS emergency sessions when an\noperator allows IMS emergency sessions.\n\n  NOTE:  For IMS emergency services prior to this Release of this\n         specification, dynamic PCC support was not required in the\n         specifications. According to clause\u00c2\u00a04.7.5, when solely using\n         voice/GTT, local configuration of static policy functions is also\n         allowed prior to this Release of this specification and is not\n         subject to standardization.\n\nThe PCRF ensures that the emergency PDN connection is used only for IMS\nemergency sessions. The PCRF rejects an IMS session established via the\nemergency PDN connection if the AF (i.e. P-CSCF) does not provide an\nemergency indication to the PCRF.\n\n\n"}, {"key": "Load re-balancing between MMEs for Emergency Services", "numbering": "4.3.12.7", "title_level": 3, "desc": "4.3.12.7 Load re-balancing between MMEs for Emergency Services\n\nAs per load re-balancing procedures in clause\u00c2\u00a04.3.7.3, the MME is allowed\nto off-load ECM-CONNECTED mode UEs by initiating S1 Release procedures.\nWhen a UE is in ECM-CONNECTED mode with an active emergency bearer service,\nthe MME should not release the UE for load re-balancing. The MME should\nwait until the UE initiates a TAU or becomes inactive. The MME may release\nthe UE under critical conditions such as the need to perform an MME node\nrestart.\n\n\n"}, {"key": "IP Address Allocation", "numbering": "4.3.12.8", "title_level": 3, "desc": "4.3.12.8 IP Address Allocation\n\nEmergency bearer service is provided by the serving PLMN. The UE and PLMN\nmust have compatible IP address versions in order for the UE to obtain a\nlocal emergency PDN connection. IP address allocation in the serving PLMN\nis provided per clause\u00c2\u00a05.3.1 with the exception that the PDN GW associated\nwith the emergency APN shall support PDN type IPv4 and PDN type IPv6.\n\n\n"}, {"key": "Handling of PDN Connections for Emergency Bearer Services", "numbering": "4.3.12.9", "title_level": 3, "desc": "4.3.12.9 Handling of PDN Connections for Emergency Bearer Services\n\nThe default and dedicated EPS bearers of a PDN Connection associated with\nthe emergency APN shall be dedicated for IMS emergency sessions and shall\nnot allow any other type of traffic. The emergency bearer contexts shall\nnot be changed to non-emergency bearer contexts and vice versa. The PDN GW\nshall block any traffic that is not from or to addresses of network\nentities (e.g. P-CSCF) providing IMS emergency service. Dynamic PCC shall\nbe deployed in order to support IMS emergency sessions, the procedures are\nas described in TS\u00c2\u00a023.203\u00c2\u00a0[6]. If there is already an emergency PDN GW\nconnection, the UE shall not request another emergency PDN Connection. The\nMME shall reject any additional emergency PDN Connection requests. The UE\nshall not request any bearer resource modification for the emergency PDN\nconnection. The PDN GW shall reject any UE requested bearer resource\nmodification that is for the emergency PDN Connection. The ARP reserved for\nemergency bearer service shall only be assigned to EPS bearers associated\nwith an emergency PDN Connection.\n\n\n"}, {"key": "ISR function for Emergency Bearer Services", "numbering": "4.3.12.10", "title_level": 3, "desc": "4.3.12.10   ISR function for Emergency Bearer Services\n\nWhen UE has only emergency bearer service, ISR does not apply.\n\n\n"}, {"key": "Support of eCall Only Mode", "numbering": "4.3.12.11", "title_level": 3, "desc": "4.3.12.11   Support of eCall Only Mode\n\nFor service requirements for eCall only mode, refer to TS\u00c2\u00a022.101\u00c2\u00a0[80].\n\nA UE configured for eCall Only Mode shall remain in EMM-DEREGISTERED state,\nshall camp on a network cell when available but shall refrain from any\nMobility Management or other signalling with the network. The UE may\ninstigate Mobility Management and Connection Management procedures in order\nto establish, maintain and release an eCall Over IMS session or a session\nto any non-emergency MSISDN(s) or URI(s) configured in the UICC for test\nand/or terminal reconfiguration services. Following the release of either\nsession, the UE starts a timer whose value depends on the type of session\n(i.e. whether eCall or a session to a non-emergency MSISDN or URI for\ntest/reconfiguration). While the timer is running, the UE shall perform\nnormal Mobility Management procedures and is permitted to respond to paging\nto accept and establish an incoming session (e.g. from an emergency centre,\nPSAP or HPLMN operator). When the timer expires, the UE shall perform a UE-\ninitiated detach procedure if still attached and enter EMM-DEREGISTERED\nstate.\n\n  NOTE\u00c2\u00a01:  An HPLMN operator can change the eCall Only Mode configuration\n         state of a UE in the UICC. An HPLMN operator can also instead add,\n         modify or remove a non-emergency MSISDN or URI in the UICC for test\n         and/or terminal reconfiguration services. This can occur following\n         a UE call to a non-emergency MSISDN or URI configured for\n         reconfiguration. When the eCall Only Mode configuration is removed,\n         the UE operates as a normal UE that can support eCall over IMS.\n\n  NOTE\u00c2\u00a02:  A test call and a reconfiguration call can be seen as normal\n         (non-emergency) call by a serving PLMN and normal charging rules\n         can apply depending on operator policy.\n\n  NOTE\u00c2\u00a03:  An MSISDN configured in the UICC for test and/or terminal\n         reconfiguration services for eCall Over IMS can differ from an\n         MSISDN configured in the UICC for test services for eCall over the\n         CS domain.\n\nWhen attaching to EPS for E-UTRAN access, a UE configured for eCall Only\nMode may indicate support for radio capabilities for IRAT Handover (for\nUTRAN) or SRVCC Handover (for GERAN), but shall not indicate support for\nIMS Voice over RATs other than E-UTRAN.\n\n  NOTE\u00c2\u00a04:  Access to the PS domain for a UE configured for eCall Only Mode\n         is only supported by E-UTRAN in this version of the specification.\n\n\n"}, {"key": "Support of Restricted Local Operator Service", "numbering": "4.3.12a", "title_level": 2, "desc": "4.3.12a  Support of Restricted Local Operator Service\n\n\n"}, {"key": "Introduction", "numbering": "4.3.12a.1", "title_level": 3, "desc": "4.3.12a.1   Introduction\n\nRestricted Local Operator Services is an optional feature supported in\ncertain countries. Service requirements of Restricted Local Operator\nServices is defined in TS\u00c2\u00a022.101\u00c2\u00a0[80] and the architectural requirements\nare defined in TS\u00c2\u00a023.221\u00c2\u00a0[27].\n\nAccess to Restricted Local Operator Services may be allowed for UEs in\nlimited service state by the serving network depending on local regulation\nand operator policys. UEs may enter limited service state as specified in\nclause\u00c2\u00a04.3.12.1.\n\nRLOS is requested by the UE, based on explicit request from the user. When\nattaching to the network to access RLOS, the UE shall send a NAS RLOS\nindication to the MME, which proceeds with the RLOS attach procedure\ndescribed in clause\u00c2\u00a05.3.2.1 A specific RLOS-APN, unique for the PLMN, is\nconfigured in the MME.\n\nAllowing access to RLOS is completely under the local operator's control,\ne.g. EPC access for RLOS does not depend on whether the UE is authenticated\nor not, nor on whether authentication suceeds or fails.\n\nTo provide access to Restricted Local Operator Services, the MME is\nconfigured with MME RLOS Configuration Data that are applied to RLOS PDN\nconnection that is established by an MME upon UE request. The MME RLOS\nConfiguration Data contain the RLOS APN which is used to derive a PDN GW,\nor the MME RLOS Configuration Data may contain the statically configured\nPDN GW for the RLOS APN.\n\nUEs in limited service state intending to access Restricted Local Operator\nServices determines that the cell supports RLOS services over E-UTRAN via a\nbroadcast indicator in AS and subsequently initiates the Attach procedure\nwith an indication that the attach is to access RLOS. The Networks\nsupporting Restricted Local Operator Services provides access to these UEs,\nregardless whether authentication for the UEs is performed or not, and\nregardless of the authentication result if authentication is performed. If\nthe PLMN does not advertise its support of RLOS, the UE shall block the\norigination attempt for RLOS.\n\nRestricted Local Operator Services is applicable to WB-E-UTRAN only.\nRestricted Local Operator Services does not support UE requested PDN\nconnectivity, inter-RAT mobility and Network triggered Service Request.\nHandover between 3GPP and non-3GPP accesses are not supported for UEs\nattached for RLOS. Location service does not apply to Restricted Local\nOperator Services.\n\n  NOTE:  During situations when, for example, there is lack of resource in\n         E-UTRAN, the E-UTRAN node can set the broadcast indicator\n         accordingly in order to indicate that the RLOS UEs in the cell are\n         not allowed.\n\nOn-line charging is not activated for RLOS APN. For off-line charging, an\nRLOS APN indication as well as IMEI, if available, is added to charging\nrecords.\n\n\n"}, {"key": "Architecture Reference Model for Restricted Local Operator", "numbering": "4.3.12a.2", "title_level": 3, "desc": "4.3.12a.2   Architecture Reference Model for Restricted Local Operator\n           Services\n\nThe same architecture as for emergency service specified in clause\u00c2\u00a04.3.12.2\napplies.\n\n\n"}, {"key": "Mobility and Access Restrictions", "numbering": "4.3.12a.3", "title_level": 3, "desc": "4.3.12a.3   Mobility and Access Restrictions\n\nWhen access to Restricted Local Operator Services is supported, the\nMobility Restrictions in clause\u00c2\u00a04.3.5.7 should not be applied to UEs\nreceiving Restricted Local Operator Services. However, for a RLOS attached\nUE, the MME shall restrict mobility to GERAN and UTRAN, and include GERAN\nand UTRAN in the Handover Restriction List.\n\n\n"}, {"key": "PDN GW selection function for Restricted Local Operator", "numbering": "4.3.12a.4", "title_level": 3, "desc": "4.3.12a.4   PDN GW selection function for Restricted Local Operator\n           Services\n\nSame mechanism as for emergency service specified in clause\u00c2\u00a04.3.12.4\napplies with the following difference:\n\nFor Restricted Local Operator Services, RLOS Configuration Data containing\nRLOS APN is needed in MME. However, HRPD or WLAN handovers don't apply.\n\n\n"}, {"key": "QoS for Restricted Local Operator Services", "numbering": "4.3.12a.5", "title_level": 3, "desc": "4.3.12a.5   QoS for Restricted Local Operator Services\n\nThe initial QoS values used for establishing RLOS PDN connection during\nRLOS attach are obtained from the MME RLOS Configuration Data.\n\n\n"}, {"key": "PCC for Restricted Local Operator Services", "numbering": "4.3.12a.6", "title_level": 3, "desc": "4.3.12a.6   PCC for Restricted Local Operator Services\n\nDynamic PCC based on the procedures described in TS\u00c2\u00a023.203\u00c2\u00a0[6] may be used\nfor UEs accessing Restricted Local Operator Services which involve voice\nservices. When establishing PDN connection towards the RLOS APN with a PDN\nGW, according to clause\u00c2\u00a04.7.5, the PCRF provides the PDN GW with the QoS\nparameters, based on operator policy, including an ARP value reserved for\nthe Restricted Local Operator Services where RLOS has a lower priority in\nterms of admission control than regular PDN connections\n\nThe PCRF ensures that the RLOS PDN connection is used only for Restricted\nLocal Operator Services RLOS IMS sessions. The PCRF rejects an IMS session\nestablished via the RLOS PDN connection if the AF (i.e. P-CSCF) does not\nprovide an RLOS indication to the PCRF.\n\n\n"}, {"key": "IP Address Allocation", "numbering": "4.3.12a.7", "title_level": 3, "desc": "4.3.12a.7   IP Address Allocation\n\nRLOS is provided by the serving PLMN. The UE and PLMN must have compatible\nIP address versions in order for the UE to obtain a RLOS PDN connection. IP\naddress allocation in the serving PLMN is provided according to\nclause\u00c2\u00a05.3.1 with the exception that the PDN GW associated with the RLOS\nAPN shall support PDN type IPv4 and PDN type IPv6.\n\n\n"}, {"key": "Emergency service for RLOS attached UE", "numbering": "4.3.12a.8.", "title_level": 4, "desc": "4.3.12a.8.  Emergency service for RLOS attached UE\n\nFor an RLOS attached UE initiating emergency service, the UE shall first\nrequest detach from the network and then perform emergency Attach as\ndefined in clause\u00c2\u00a04.3.12.\n\n\n"}, {"key": "Closed Subscriber Group functions", "numbering": "4.3.13", "title_level": 2, "desc": "4.3.13 Closed Subscriber Group functions\n\nClosed Subscriber Group identifies a group of subscribers who are permitted\nto access one or more CSG cells of the PLMN as a member of the CSG for a\nHeNB. The following CSG related functions are defined:\n\n  -  CSG subscription handling function stores and updates the user's CSG\n    subscription data at the UE and the network.\n\n  -  For closed mode, CSG access control function ensures a UE has valid\n    subscription at a CSG where it performs an access.\n\n  -  Admission and rate control function is used to provide different\n    admission and rate control for CSG and non-CSG members for a hybrid CSG\n    cell.\n\n  -  CSG charging function enables per CSG charging for a subscriber\n    consuming network services via a CSG cell or a hybrid cell.\n\n  -  CSG Paging Optimisation function is optionally used to filter paging\n    messages as described in clause\u00c2\u00a05.3.4.3.\n\n  -  VPLMN Autonomous CSG roaming function is optionally supported whereby\n    a VPLMN, if allowed by the HPLMN, stores and manages VPLMN specific CSG\n    subscription information for roaming UEs without interaction with the\n    HSS.\n\n  -  CSG membership verification without updating the User CSG Information\n    in the Core Network in case of Dual Connectivity when the Secondary eNB\n    is a hybrid access eNB.\n\n\n"}, {"key": "Location Service functions", "numbering": "4.3.14", "title_level": 2, "desc": "4.3.14 Location Service functions\n\nLCS procedures are described in the LCS stage 2 specification, see\nTS\u00c2\u00a023.271\u00c2\u00a0[57].\n\nIn addition, in the Detach and Bearer Deactivation procedures, the MME\nshall inform the S-GW of the last known location of the UE, and shall\nprovide information to enable the determination of the time at which the UE\nwas in that location. The S-GW shall (if necessary taking into account\ninformation from the SGSN) inform the PDN GW of the last known location of\nthe UE, and shall provide information to enable the determination of the\ntime at which the UE was in that location. If requested by the PCRF the PDN\nGW shall indicate this information to the PCRF as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\nThe information can also be made available on the SGi interface as\nspecified in TS\u00c2\u00a029.061\u00c2\u00a0[38] and on the CDRs at network elements such as the\nS-GW and PDN GW as specified in TS\u00c2\u00a032.251\u00c2\u00a0[44].\n\n\n"}, {"key": "Selected IP Traffic Offload (SIPTO) function", "numbering": "4.3.15", "title_level": 2, "desc": "4.3.15 Selected IP Traffic Offload (SIPTO) function\n\nThe SIPTO function enables an operator to offload certain types of traffic\nat a network node close to that UE's point of attachment to the access\nnetwork. The SIPTO function specified in this TS\u00c2\u00a0applies to IP PDN Types\nand Ethernet and Non-IP PDN Types.\n\nSIPTO above RAN can be achieved by selecting a set of GWs (S-GW and P-GW)\nthat is geographically/topologically close to a UE's point of attachment.\n\nSIPTO above RAN corresponds to a traffic offload through a P-GW located in\nthe mobile operator's core network.\n\nSIPTO applies to both the non-roaming case and, provided appropriate\nroaming agreements are in place between the operators, to the roaming case.\n\nOffload of traffic for a UE is available for UTRAN and E-UTRAN accesses\nonly. When the UE enters to UTRAN/E-UTRAN from another type of access\nnetwork (e.g., from GERAN), it is the responsibility of the new SGSN/MME to\ndecide whether to perform deactivation with reactivation request for a\ngiven PDN connection, depending on SIPTO permissions for the relevant APN.\n\nRealization for SIPTO above RAN relies on the same architecture models and\nprinciples as for local breakout described in clause\u00c2\u00a04.2.\n\nIn order to select a set of appropriate GW (S-GW and P-GW) based on\ngeographical/topological proximity to UE, the GW selection function\nspecified in TS\u00c2\u00a029.303\u00c2\u00a0[61] uses the UE's current location information.\n\nIn order for the operator to allow/prohibit SIPTO on per user and per APN\nbasis, subscription data in the HSS is configured to indicate to the MME if\noffload is allowed or prohibited. If the SIPTO permissions information from\nthe HSS conflicts with MME's configuration for that UE, then SIPTO is not\nused.\n\nIf HSS indicates VPLMN address not allowed, then VPLMN (i.e. MME) shall not\nprovide SIPTO.\n\nIn the absence of any SIPTO permissions indication from the HSS the VPLMN\n(i.e MME) shall not provide SIPTO.\n\nThe MME may be configured on a per APN basis as to whether or not to use\nSIPTO (e.g. to handle the case where the HSS is not configured with SIPTO\ninformation for the UE).\n\nFor SIPTO above RAN, as a result of UE mobility (e.g. detected by the MME\nat TAU or SGSN at RAU or movement from GERAN), the target MME may wish to\nredirect a PDN connection towards a different GW that is more appropriate\nfor the UE's current location, e.g. MME may know whether the UE's new\nlocation is served by the same GW as the old one. When the MME decides upon\nthe need for GW relocation, the MME deactivates the impacted PDN\nconnections indicating \"reactivation requested\" as specified in\nclause\u00c2\u00a05.10.3. If all of the PDN connections for the UE need to be\nrelocated, the MME may initiate the \"explicit detach with reattach\nrequired\" procedure as specified in clause\u00c2\u00a05.3.8.3.\n\n  NOTE:  If either of the above procedures for GW relocation are initiated\n         while the UE has active applications, it may cause disruption of\n         services that are affected if the IP address changes.\n\n\n"}, {"key": "Selected IP Traffic Offload (SIPTO) at the Local Network", "numbering": "4.3.15a", "title_level": 2, "desc": "4.3.15a  Selected IP Traffic Offload (SIPTO) at the Local Network\n\n\n"}, {"key": "General", "numbering": "4.3.15a.1", "title_level": 3, "desc": "4.3.15a.1   General\n\nThe SIPTO at the Local Network function enables an IP capable UE connected\nvia a (H)eNB to access a defined IP network (e.g. the Internet) without the\nuser plane traversing the mobile operator's network.\n\nThe subscription data in the HSS are configured per user and per APN to\nindicate to the MME if offload at the local network is allowed or not.\n\nSIPTO at the Local Network can be achieved by selecting a L-GW function\ncollocated with the (H)eNB or selecting stand-alone GWs (with S-GW and L-GW\ncollocated) residing in the Local Network. In both cases the selected IP\ntraffic is offloaded via the Local Network.\n\nSpecific to the HeNB subsystem, the applicability of SIPTO at the Local\nNetwork does not depend on CSG membership and the feature can be applied to\nany UE, as long as the UE is allowed to access the cell.\n\nFor this release of the specification, no interface between the L-GW and\nthe PCRF is specified and there is no support for dedicated bearers on the\nPDN connection used for SIPTO at the Local Network. The Local GW (L-GW)\nshall reject any UE requested bearer resource modification.\n\nFor this release of the specification, SIPTO at the Local Network is\nintended for offloading Internet traffic only, thus the L-GW does not\nprovide APN specific connectivity. Therefore if the subscription data in\nthe HSS indicate that offload at the Local Network is allowed, this implies\nthat the related APN is typically used for providing Internet connectivity.\n\nIf the MME detects a change in SIPTO permissions in the subscription data\nfor a given subscriber for a given APN and the subscriber has already\nestablished a SIPTO at the local network PDN connection to that APN, the\nMME shall release the SIPTO at the Local Network PDN connection for that\nAPN with \"reactivation requested\" cause as specified in clause\u00c2\u00a05.10.3.\n\n  NOTE:  In this release of the specification it is assumed that the target\n         S-GW selected during the Handover also has connectivity to the L-\n         GW.\n\n\n"}, {"key": "SIPTO at the Local Network with stand-alone GW (with S-GW and L-", "numbering": "4.3.15a.2", "title_level": 3, "desc": "4.3.15a.2   SIPTO at the Local Network with stand-alone GW (with S-GW and L-\n           GW collocated) function\n\nSIPTO at the Local Network is achieved using a stand-alone GW (with S-GW\nand L-GW collocated) residing in the Local Network.\n\nA (H)eNB supporting SIPTO at the Local Network with the stand-alone GW\nincludes the Local Home Network ID to the MME in every INITIAL UE MESSAGE,\nevery UPLINK NAS TRANSPORT control message, HANDOVER NOTIFY and PATH SWITCH\nREQUEST messages.\n\nIf a SIPTO PDN connection is initiated as an additional subsequent PDN\nconnection, the MME should check if the S-GW is optimal for the user's\ncurrent location. If it is not, and if the network supports S-GW relocation\nwithout being triggered by a mobility event, the MME may decide to perform\nan MME triggered Serving GW relocation according to clause\u00c2\u00a05.10.4, when\npossible (e.g. no other restrictions apply).\n\nFor SIPTO at the Local Network with a stand-alone GW, the location of the\nServing GW may be determined based on the operator policy and user's\nprofile regarding support of SIPTO at Local Network so that:\n\n  -  At attachment to the (H)eNB, a local S-GW can always be selected\n    independent of whether a SIPTO at the Local Network PDN connection is\n    established or not. If mobility is performed to the macro network\n    without having a SIPTO connection, a S-GW relocation can be performed\n    as specified via existing mobility procedures with S-GW relocation.\n\n  -  At attachment to a (H)eNB, a macro S-GW may be allocated for PDN\n    connection in the operator's network. If a new PDN connection is\n    requested by the UE that requires that a local S-GW is selected to\n    provide for SIPTO at the Local Network, S-GW relocation from the macro\n    S-GW to the local S-GW shall be performed as specified in\n    clause\u00c2\u00a05.10.4.\n\nAs IP data session continuity for SIPTO at the Local Network PDN connection\nis not supported in this release of the specification, subsequent to\nhandover completion the (target) MME should disconnect the SIPTO at the\nLocal Network PDN connection with \"reactivation requested\" cause as\nspecified in clause\u00c2\u00a05.10.3, unless the Local Home Network ID is not\nchanged. The IP data session should be maintained if the Local Home Network\nID is not changed. If the UE has no other PDN connection and the Local Home\nNetwork ID is changed, the (target) MME initiates \"explicit detach with\nreattach required\" procedure according to clause\u00c2\u00a05.3.8.3.\n\nUpon completion of Tracking Area Update procedure, the (new) MME shall\ntrigger the re-establishment of the SIPTO at the Local Network PDN\nconnection when it detects that the UE has moved away from the (H)eNB and\nto a (H)eNB with different Local Home Network ID, as specified in\nclause\u00c2\u00a05.3.3 and clause\u00c2\u00a05.3.4.\n\n  NOTE:  It is expected that all MMEs/SGSNs in a PLMN have support for\n         SIPTO at the Local Network where the operator deploys this feature,\n         in order to support mobility procedures. For a mobility event where\n         target MME/SGSN does not support SIPTO at the Local Network, the\n         handling of PDN deactivation for SIPTO at Local Network PDN\n         connection is not specified.\n\n\n"}, {"key": "SIPTO at the Local Network with L-GW function collocated with", "numbering": "4.3.15a.3", "title_level": 3, "desc": "4.3.15a.3   SIPTO at the Local Network with L-GW function collocated with\n           the (H)eNB\n\nSIPTO at the Local Network is achieved using a Local GW (L-GW) function\ncollocated with the (H)eNB and using the same procedures as described in\nclause\u00c2\u00a04.3.15, with the following additions:\n\n  -  The (H)eNB supporting the SIPTO at the Local Network function includes\n    the Local GW address to the MME in every INITIAL UE MESSAGE and every\n    UPLINK NAS TRANSPORT control message specified in TS\u00c2\u00a036.413\u00c2\u00a0[36].\n\n  -  The PDN GW selection function uses the L-GW address proposed by (H)eNB\n    in the S1-AP message, instead of DNS interrogation.\n\n  -  Specific to the HeNB subsystem, the Local GW information for SIPTO at\n    the Local Network is signalled on S1 separately from the Local GW\n    information for LIPA. The L-GW shall be able to discriminate between\n    PDN connection for SIPTO at the Local Network and for LIPA.\n\n  NOTE\u00c2\u00a01:  The protocol option (i.e. GTP or PMIP) supported on the S5\n         interface between Local GW and S-GW is configured on the MME.\n\nThe direct user plane path between the (H)eNB and the collocated L-GW is\nenabled with a SIPTO Correlation ID parameter that is associated with the\ndefault EPS bearer on the PDN connection used for SIPTO at the Local\nNetwork. Upon establishment of the default EPS bearer the MME sets the\nSIPTO Correlation ID equal to the PDN GW TEID (GTP-based S5) or the PDN GW\nGRE key (PMIP-based S5). The SIPTO Correlation ID is then signalled by the\nMME to the (H)eNB as part of E-RAB establishment and is stored in the E-RAB\ncontext in the (H)eNB. The SIPTO Correlation ID is used in the (H)eNB for\nmatching the radio bearers with the direct user plane path connections from\nthe collocated L-GW for SIPTO at local network PDN connection.\n\nAs IP data session continuity for the SIPTO at the Local Network PDN\nconnection is not supported in this release of the specification, the SIPTO\nat the Local Network PDN connection shall be re-established when the UE\nmoves away from (H)eNB. During the handover procedure, when the source\n(H)eNB releases its resources related to the UE, the (H)eNB shall request\nusing intra-node signalling the collocated L-GW to re-establish the SIPTO\nat the Local Network PDN connection. The L-GW starts a timer. When the\ntimer expires, the L-GW shall initiate the release of the SIPTO at the\nLocal Network PDN connection using the PDN GW initiated bearer deactivation\nprocedure according to clause\u00c2\u00a05.4.4.1 with the \"reactivation requested\"\ncause value.\n\n\n"}, {"key": "Local IP Access (LIPA) function", "numbering": "4.3.16", "title_level": 2, "desc": "4.3.16 Local IP Access (LIPA) function\n\nThe LIPA function enables a UE connected via a HeNB to access other\nentities in the same residential/enterprise network without the user plane\ntraversing the mobile operator's network except HeNB subsystem.\n\nThe Local IP Access is achieved using a Local GW (L-GW) colocated with the\nHeNB.\n\nLIPA is established by the UE requesting a new PDN connection to an APN for\nwhich LIPA is permitted, and the network selecting the Local GW associated\nwith the HeNB and enabling a direct user plane path between the Local GW\nand the HeNB. The HeNB supporting the LIPA function includes the Local GW\naddress to the MME in every INITIAL UE MESSAGE and every UPLINK NAS\nTRANSPORT control message as specified in TS\u00c2\u00a036.413\u00c2\u00a0[36].\n\n  NOTE\u00c2\u00a01:  The protocol option (i.e. GTP or PMIP) supported on the S5\n         interface between Local GW and S-GW is configured on the MME.\n\nFor this release of the specification no interface between the L-GW and the\nPCRF is specified and there is no support for Dedicated bearers on the PDN\nconnection used for Local IP Access. The Local GW (L-GW) shall reject any\nUE requested bearer resource modification.\n\nThe direct user plane path between the HeNB and the collocated L-GW is\nenabled with a Correlation ID parameter that is associated with the default\nEPS bearer on a PDN connection used for Local IP Access. Upon establishment\nof the default EPS bearer the MME sets the Correlation ID equal to the PDN\nGW TEID (GTP-based S5) or the PDN GW GRE key (PMIP-based S5). The\nCorrelation ID is then signalled by the MME to the HeNB as part of E-RAB\nestablishment and is stored in the E-RAB context in the HeNB. The\nCorrelation ID is used in the HeNB for matching the radio bearers with the\ndirect user plane path connections from the collocated L-GW.\n\nIf the UE is roaming and if the HSS indicates LIPA roaming allowed for this\nUE in this VPLMN, then the VPLMN (i.e. MME) may provide LIPA for this UE.\nFurthermore, in the absence of any LIPA information for the requested APN\nfrom the HSS, the VPLMN (i.e MME) shall not provide LIPA. The VPLMN address\nallowed flag is not considered when establishing a LIPA PDN connection.\n\nLIPA is supported for APNs that are valid only when the UE is connected to\na specific CSG. LIPA is also supported for \"conditional\" APNs that can be\nauthorized to LIPA service when the UE is using specific CSG. APNs marked\nas \"LIPA prohibited\" or without a LIPA permission indication cannot be used\nfor LIPA.\n\nMME shall release a LIPA PDN connection to an APN if it detects that the\nUE's LIPA CSG authorization data for this APN has changed and the LIPA PDN\nconnection is no longer allowed in the current cell.\n\nAs mobility of the LIPA PDN connection is not supported in this release of\nthe specification, the LIPA PDN connection shall be released when the UE\nmoves away from H(e)NB. Before starting the handover procedure towards the\ntarget RAN, the H(e)NB shall request using an intra-node signalling the\ncollocated L-GW to release the LIPA PDN connection. The H(e)NB determines\nthat the UE has a LIPA PDN connection from the presence of the Correlation\nID in the UE (E-)RAB context. The L-GW shall then initiate and complete the\nrelease of the LIPA PDN connection using the PDN GW initiated bearer\ndeactivation procedure as per clause\u00c2\u00a05.4.4.1 or GGSN initiated PDP context\ndeactivation procedure as specified in TS\u00c2\u00a023.060\u00c2\u00a0[7]. The H(e)NB shall not\nproceed with the handover preparation procedure towards the target RAN\nuntil the UE's (E-)RAB context is clear for the Correlation ID.\n\nAt the handover, the source MME checks whether the LIPA PDN connection has\nbeen released. If it has not been released:\n\n  -  and the handover is the  S1-based handover or the Inter-RAT handover,\n    the source MME shall reject the handover.\n\n  -  and the handover is X2-based handover, the MME shall send a Path\n    Switch Request Failure message (see more detail in TS\u00c2\u00a036.413\u00c2\u00a0[36]) to\n    the target HeNB. The MME performs explicit detach of the UE as\n    described in the MME initiated detach procedure of clause\u00c2\u00a05.3.8.3.\n\n  NOTE\u00c2\u00a02:  The direct signalling (implementation dependent) from the H(e)NB\n         to the L-GW is only possible since mobility of the LIPA PDN\n         connection is not supported in this release.\n\nDuring idle state mobility events, the MME/SGSN shall deactivate the LIPA\nPDN connection when it detects that the UE has moved away from the HeNB.\n\n\n"}, {"key": "Support for Machine Type Communications (MTC)", "numbering": "4.3.17", "title_level": 2, "desc": "4.3.17 Support for Machine Type Communications (MTC)\n\n\n"}, {"key": "General", "numbering": "4.3.17.1", "title_level": 3, "desc": "4.3.17.1 General\n\nThis clause provides an overview about functionality for Machine Type\nCommunications according to service requirements described in\nTS\u00c2\u00a022.368\u00c2\u00a0[66]. The specific functionality is described in the affected\nprocedures and features of this and other specifications. For discrepancies\nbetween this overview clause\u00c2\u00a0and the detailed procedure and function\ndescriptions, the latter take precedence.\n\nMTC functionality is provided by the visited and home networks when the\nnetworks are configured to support machine type communication. It applies\nto both the non-roaming case and the roaming case and some functionality\nmay be dependent upon the existence of appropriate roaming agreements\nbetween the operators.\n\nSome of the MTC functions are controlled by subscriber data. Other MTC\nfunctions are based on indicators sent by the UE to the network. MTC\nfunctionality is performed by UEs that are configured to support different\noptions as described in clause\u00c2\u00a04.3.17.4.\n\nThough motivated by scenarios and use cases defined in TS\u00c2\u00a022.368\u00c2\u00a0[66], the\nfunctions added to support MTC have general applicability and are in no way\nconstrained to any specific scenario or use case except where explicitly\nstated.\n\n\n"}, {"key": "Overview of protection from Potential MTC Related Overload", "numbering": "4.3.17.2", "title_level": 3, "desc": "4.3.17.2 Overview of protection from Potential MTC Related Overload\n\nThe number of MTC devices may be several orders of magnitude greater than\n\"traditional\" devices. Many (but not all) MTC devices will be relatively\nstationary and/or generate low volumes of traffic. However, these UEs have\nthe capability to generate normal quantities of signalling. As normal\nsignalling from large numbers of UEs may cause overload independently\nwhether the UE is used for MTC or not, generic functionality for overload\nand congestion control is required.\n\nThe total signalling from large numbers of UEs is a concern in at least two\nsituations:\n\n  -  when an application (running in many UEs) requests many UEs to do\n    \"something\" at the same time; and/or\n\n  -  when many UEs are roamers and their serving network fails, then they\n    can all move onto the local competing networks, and potentially\n    overload the not (yet) failed network(s).\n\nTo counter these potential problems, the following standardised indications\nand mechanisms are provided in a generic manner. These permit node specific\nfeatures to be developed to protect the networks.\n\n  a) Where applicable, UEs can be configured for enhancements as described\n    in subsequent bullets Post-manufacturing configuration can be performed\n    remotely as described in clause\u00c2\u00a04.3.17.4.\n\n  b) For mobile originated services, UEs configured for low access priority\n    provide the E-UTRAN with information indicating that the RRC connection\n    establishment request has low access priority (see clause\u00c2\u00a04.3.17.4).\n    Clause\u00c2\u00a04.3.17.4 describes when low access priority is not applicable.\n\n  c) RRC signalling has the capability of providing 'extended wait timers'\n    when rejecting messages from UEs. These 'extended wait timers' are only\n    used by UEs that access the network with low access priority.\n\n  d) The MME can initiate rejection of RRC connection establishments in the\n    E-UTRAN for UEs that access the network with low access priority as\n    described in clause\u00c2\u00a04.3.7.4.1. In addition, MME signalling or O&M can\n    trigger E-UTRAN to initiate Extended Access Barring. These mechanisms\n    are further described in clause\u00c2\u00a04.3.7.4.1.\n\n  e) Overload messages from the MME to E-UTRAN are extended to aid the RAN\n    in performing the functionality in bullets b, c and d above.\n\n  f) UEs configured with a long minimum periodic PLMN search time limit\n    (see TS\u00c2\u00a024.368\u00c2\u00a0[69]) have an increased minimum time in between their\n    searches for more preferred PLMNs.\n\n  NOTE\u00c2\u00a01:  Following the failure of a more preferred PLMN, UEs configured\n         as above might change to other local competing networks. Expiry of\n         this search timer will lead to the UE re-attempting to access the\n         failed network, and then, if that network has not yet recovered,\n         reaccessing one of the local competing networks. Use of a too short\n         timer for the more preferred PLMN search can both prevent the\n         failed network from recovering, and, impose more load on the local\n         competing networks.\n\n  g) At PLMN change, UEs configured to perform Attach with IMSI at PLMN\n    change (see TS\u00c2\u00a024.368\u00c2\u00a0[69]) do this rather than a TA update with GUTI\n    (thus avoiding the need to reject the TA update, and to request the\n    IMSI following the subsequent Attach with GUTI).\n\n  NOTE\u00c2\u00a02:  In the case of a network failure, this reduces the message\n         processing load on a local competing network and hence makes that\n         network more likely to survive the failure of the other network.\n\n  h) For mobile originated services, UEs configured for low access priority\n    (see TS\u00c2\u00a024.368\u00c2\u00a0[69]) provide a low access priority indication to the\n    MME in NAS signalling that permit the MME to undertake protective\n    measures (e.g. to permit the MME to immediately command the UE to move\n    to a state where it does not need to generate further signalling\n    messages and/or does not reselect PLMNs), as described in\n    clause\u00c2\u00a04.3.7.4.1. Clause\u00c2\u00a04.3.17.4 describes when low access priority is\n    not applicable.\n\n  i) Using Periodic TAU timer value sent by the HSS and/or UE provided low\n    access priority indication (bullet h above), the MME can allocate a\n    long periodic TAU timer value to the UE. A long periodic TAU timer is\n    likely to slow down the rate at which a UE detects a network failure\n    and thus it slows down the rate of movement of UEs from a failed\n    network to other local competing networks (see clause\u00c2\u00a04.3.17.3).\n\n  j) Mechanisms for the MME and P-GW to detect congestion associated with a\n    particular APN (see clauses 4.3.7.4.2 and 4.3.7.5).\n\n  k) The addition of 'back off timers' to EMM and ESM signalling messages\n    (e.g. to rejection messages). These include some time randomisation to\n    guard against a repeat of a load peak. The MME should be able to apply\n    this behaviour on a per-APN basis. as described in clause\u00c2\u00a04.3.7.4.2\n\n  l) Signalling that permits the P-GW to request the MME to generate the\n    above ESM signalling with 'back off timers' (see clause\u00c2\u00a04.3.7.5).\n\n  m) An MME overload control mechanism to selectively limit the number of\n    Downlink Data Notification requests the S-GW sends to the MME for\n    downlink low priority traffic received for UEs in idle mode (see\n    clause\u00c2\u00a04.3.7.4.1a).\n\n  n) UE configured for specific handling of the invalid USIM state, the\n    \"forbidden PLMN list\", the \"forbidden PLMNs for attach in S1mode list\"\n    and the \"forbidden PLMNs for GPRS service list\" remembers that the USIM\n    is invalid and keeps the PLMN forbidden lists even if the UE is\n    switched off and then switched on.\n\n  o) When the UE has an activated PDN connection without low access\n    priority or the UE is requested to establish such a PDN connection and\n    the UE is configured with a permission for overriding low access\n    priority the UE doesn't provide a low access priority indication to the\n    MME in NAS MM signalling and also not to the RAN in the RRC requests.\n    In the NAS request for activating a PDN connection this UE always\n    indicates what the upper layers requested, i.e. the UE indicates low\n    access priority in that NAS request unless the upper layers request\n    activation of a PDN connection without low access priority.\n\n  p) When the UE has an activated PDN connection that is without low access\n    priority or the UE is requested to activate such a PDN connection and\n    the UE is configured with a permission for overriding Extended Access\n    Barring, then the UE ignores any Extended Access Barring (if it is\n    activated in the network) as defined in TS\u00c2\u00a022.011\u00c2\u00a0[67].\n\n  NOTE\u00c2\u00a03:  It is assumed that the mechanisms described in this entire\n         clause are designed by Stage\u00c2\u00a03 in a manner that allows\n         extensibility and forward compatibility.\n\n  q) The eNodeB may use the low access priority indication provided by the\n    UE to steer UEs configured for low access priority to specific MMEs.\n\n\n"}, {"key": "Optimising periodic TAU Signalling", "numbering": "4.3.17.3", "title_level": 3, "desc": "4.3.17.3 Optimising periodic TAU Signalling\n\nTo reduce network load from periodic TAU signalling and to increase the\ntime until the UE detects a potential need for changing the RAT or PLMN\n(e.g. due to network problems) the longer values of the periodic TAU timer\nand Mobile Reachable timer shall be supported.\n\nA long periodic RAU/TAU timer value may be locally configured at MME or may\nbe stored as part of the subscription data in HSS. During Attach and TAU\nprocedures the MME allocates the periodic RAU/TAU timer value as periodic\nTAU timer to the UE based on VPLMN operator policy, low access priority\nindication from the UE, periodic RAU/TAU timer value requested by UE and\nsubscription information received from the HSS.\n\nIf MME receives a subscribed periodic RAU/TAU timer value from the HSS it\nallocates the subscribed value to the UE as periodic TAU timer. A visited\nPLMN MME may use subscribed periodic RAU/TAU timer value, if available, as\nan indication to decide for allocating a locally configured periodic\nRAU/TAU timer value to the UE.\n\nIf no subscribed periodic RAU/TAU timer value is received from the HSS, the\nMME should:\n\n  -  if the periodic RAU/TAU timer value requested by UE is within the\n    boundaries of the VPLMN operator policy, allocate the value requested\n    by the UE;\n\n  -  if the periodic RAU/TAU timer value requested by UE is higher than\n    allowed per the VPLMN operator policy, allocate the highest allowed\n    value per the VPLMN operator policy;\n\n  -  if the periodic RAU/TAU timer value requested by UE is lower than\n    allowed per the VPLMN operator policy, allocate the lowest allowed\n    value per the VPLMN operator policy.\n\n\n"}, {"key": "UE configuration and usage of indicators", "numbering": "4.3.17.4", "title_level": 3, "desc": "4.3.17.4 UE configuration and usage of indicators\n\nA subscriber can by agreement with its operator be required to use UEs that\nare configured (see TS\u00c2\u00a024.368\u00c2\u00a0[69]) to support one or more of the following\noptions:\n\n  -  UE configured for low access priority; and/or\n\n  -  UE configured with a permission for overriding low access priority,\n    which is only applicable for a UE that is also configured for low\n    access priority; and/or\n\n  -  UE configured to perform Attach with IMSI at PLMN change; and/or\n\n  -  UE configured with a long minimum periodic PLMN search time limit;\n    and/or\n\n  -  UE configured for specific handling of the invalid USIM state, the\n    \"forbidden PLMN list\", the \"forbidden PLMNs for attach in S1mode list\"\n    and the \"forbidden PLMNs for GPRS service list\"; and/or\n\n  -  UE configured for Extended Access Barring; and/or\n\n  -  UE configured with a permission for overriding Extended Access\n    Barring, which is only applicable for a UE that is also configured for\n    Extended Access Barring.\n\n  NOTE\u00c2\u00a01:  When a UE is accessing the network with low access priority,\n         then the UE may be subject for longer backoff timers at overload\n         and consequently need to be designed to be tolerant to delays when\n         accessing the network.\n\nUEs can be configured for one or more of the above options with the\nfollowing restrictions:\n\n  -  in this Release of the specification, a UE that is configured for low\n    access priority shall also be configured for Extended Access Barring;\n    and\n\n  -  in this Release of the specification, a UE that is configured for\n    Extended Access Barring shall be configured for low access priority.\n\n  -  in this Release of the specification, a UE that is configured for\n    overriding low access priority shall also be configured for overriding\n    Extended Access Barring; and\n\n  -  in this Release of the specification, a UE that is configured for\n    overriding Extended Access Barring shall also be configured for\n    overriding low access priority.\n\nUEs can be configured for one or more of the above options. Post-\nmanufacturing configuration of these options in the UE can be performed\nonly by OMA DM or (U)SIM OTA procedures. UEs capable of the above options\nshould support configuration of these options by both OMA DM and (U)SIM OTA\nprocedures.\n\nA UE configured for low access priority shall transmit the low access\npriority indicator to the MME during the appropriate NAS signalling\nprocedures and transmit the corresponding low access priority to the E-\nUTRAN during RRC connection establishment procedures.\n\n  NOTE\u00c2\u00a02:  The low access priority indicator in NAS signalling and the\n         corresponding low access priority for RRC connection establishment\n         are used by the network to decide whether to accept the NAS request\n         or the setup of the RRC connection respectively.\n\nLow access priority shall not be applicable in the following situations:\n\n  -  for all procedures related to an emergency PDN connection; used for\n    IMS Emergency sessions that are to be prioritized as per the\n    requirements for IMS Emergency session procedures (see clause\u00c2\u00a04.3.12).\n    When an emergency PDN connection gets established, the MME may, based\n    on MME configuration, initiate the deactivation of any non-emergency\n    PDN connection using the MME requested PDN disconnection procedure\n    described in clause\u00c2\u00a05.10.3;\n\n  -  for all procedures when preferential access to the network is provided\n    to the UE by the Access Class 11-15 mechanism according to\n    TS\u00c2\u00a036.331\u00c2\u00a0[37] and TS\u00c2\u00a022.011\u00c2\u00a0[67] e.g. for Multimedia Priority Services\n    as described in clause\u00c2\u00a04.3.18;\n\n  NOTE\u00c2\u00a03:  The configuration of a UE for low access priority and Access\n         Class 11-15 are configured independently of each other. However,\n         the home operator can take care to prevent a subscription for\n         Access Class 11-15 from being used in a UE configured for low\n         access priority.\n\n  -  for RRC connection establishment procedures when responding to paging;\n\n  -  for a UE configured with a permission for overriding low access\n    priority under conditions described by bullet o in clause\u00c2\u00a04.3.17.2; or\n\n  -  other specific situations described in TS\u00c2\u00a024.301\u00c2\u00a0[46].\n\nIf the NAS session management request message used to establish a new PDN\nconnection contains a low access priority indication, the MME shall forward\nthe low access priority indication in the Create Session Request message to\nthe S-GW/P-GW. The low priority indication gets associated with a PDN\nconnection when it is established and it shall not change until the PDN\nconnection is deactivated.\n\nThe low access priority indication may be included in charging records by\nthe visited and home networks. In order to permit the S-GW to include the\nlow access priority indicator in the charging records, the low access\npriority indicator should be stored in the MME EPS Bearer contexts and\nshould be passed as part of these contexts to other SGSN/MME or S-GW nodes\nin mobility management procedures.\n\n  NOTE\u00c2\u00a04:  In this release there is no other usage of storing the low\n         access priority indicator in EPS Bearer contexts other than for the\n         purpose to include it in charging records. Particularly, the low\n         access priority indicator in EPS Bearer contexts is not used by the\n         network to make overload control decisions.\n\nA network node may invoke one or more of the following mechanisms based on\nthe indicators received in signalling from UEs or forwarded by other\nnetwork nodes:\n\n  -  based on the low access priority indicator in NAS request messages,\n    bullets e, h, i, k and l as defined in clause\u00c2\u00a04.3.17.2; and/or\n\n  -  based on the low access priority for RRC connection establishment,\n    bullets b, c and q as defined in clause\u00c2\u00a04.3.17.2.\n\nA UE shall invoke one or more of the following mechanisms based on the\nconfiguration and capabilities of the UE:\n\n  -  when UE is configured with a long minimum periodic PLMN search time\n    limit, the UE invokes actions as described in bullet f in\n    clause\u00c2\u00a04.3.17.2; and/or\n\n  -  when UE is configured to perform Attach with IMSI at PLMN change, the\n    UE invokes actions as described in bullet g in clause\u00c2\u00a04.3.17.2; and/or\n\n  -  when a UE is configured for low access priority, the UE invokes\n    actions as described in bullets b and h in clause\u00c2\u00a04.3.17.2; and/or\n\n  -  when UE is configured for specific handling of the invalid USIM state,\n    the \"forbidden PLMN list\", the \"forbidden PLMNs for attach in S1mode\n    list\" and the \"forbidden PLMNs for GPRS service list\", the UE invokes\n    actions as defined in bullet n in clause\u00c2\u00a04.3.17.2; and/or\n\n  -  when UE is configured for Extended Access Barring, the UE invokes\n    actions as defined in bullet d in clause\u00c2\u00a04.3.17.2; and/or\n\n  -  when a UE is configured with a permission for overriding low access\n    priority and configured with a permission for overriding Extended\n    Access Barring, the UE invokes actions as described in bullets o) and\n    p) in clause\u00c2\u00a04.3.17.2.\n\n\n"}, {"key": "Void", "numbering": "4.3.17.5", "title_level": 3, "desc": "4.3.17.5 Void\n\n\n\n\n"}, {"key": "Support of UEs configured for low access priority, Extended Access", "numbering": "4.3.17.6", "title_level": 3, "desc": "4.3.17.6 Support of UEs configured for low access priority, Extended Access\n           Barring and permission for override\n\nThe feature is specified in TS\u00c2\u00a023.060\u00c2\u00a0[7] clause\u00c2\u00a05.3.13.6.\n\n\n"}, {"key": "High latency communication", "numbering": "4.3.17.7", "title_level": 3, "desc": "4.3.17.7 High latency communication\n\nFunctions for High latency communication may be used to handle mobile\nterminated (MT) communication with UEs being unreachable while using power\nsaving functions e.g. UE Power Saving Mode (see clause\u00c2\u00a04.3.22) or extended\nidle mode DRX (see clause\u00c2\u00a05.13a) depending on operator configuration. \"High\nlatency\" refers to the initial response time before normal exchange of\npackets is established. That is, the time it takes before a UE has woken up\nfrom its power saving state and responded to the initial downlink\npacket(s). The feature is described in TS\u00c2\u00a023.682\u00c2\u00a0[74].\n\nThe High latency communication includes invoking extended buffering of MT\ndata at the Serving GW when the UE is in a power saving state and not\nreachable. The handling is specified in the Network Triggered Service\nRequest procedure, clause\u00c2\u00a05.3.4.3. Establishing the user plane for\ndelivering the buffered data when the UE contacts the MME or SGSN by\nsignalling shall be done in the Tracking Area Update and Routing Area\nUpdate procedures. The MME/SGSN uses its parameter DL Data Buffer\nExpiration Time in the MM context information to remember if there is\nbuffered DL data to be delivered when the UE becomes reachable. When set,\nthe DL Data Buffer Expiration Time shall be cleared at any user plane setup\nto the RAN, i.e. buffered DL data can been delivered. At TAU/RAU procedures\nwith MME/SGSN change, the old MME/SGSN shall indicate in the context\nresponse to the new MME/SGSN that buffered DL data is waiting and hence the\nnew MME/SGSN shall establish the user plane for delivery of the buffered DL\ndata. When the DL Data Buffer Expiration Time has expired, the MME/SGSN\nconsiders no DL data to be buffered and no indications of Buffered DL Data\nWaiting are sent during context transfers at TAU procedures. At TAU/RAU\nprocedures with Serving GW change, the buffered DL data is forwarded to the\nnew Serving GW or Gn/Gp-SGSN.\n\nFor Control Plane CIoT EPS Optimisation, the High latency communication\nincludes invoking the buffering of MT data at the Serving GW or the MME as\nspecified in Mobile Terminated Data Transport in Control Plane CIoT EPS\nOptimisation with P-GW connectivity, clause\u00c2\u00a05.3.4B.3. When the UE contacts\nMME, MME delivers the buffered data using NAS PDUs. If MT data is buffered\nin MME, at TAU procedures with MME change the buffered data in the old MME\nis discarded.\n\nThe High latency communication also includes sending event notifications to\napplication servers that have requested \"UE Reachability\" or \"Availability\nafter DDN failure\" monitoring events. Event notifications are sent when a\nUE becomes reachable, for example as part of the Attach Procedure, TAU/RAU\nprocedures and the UE triggered Service Request procedure.\n\nWhen \"UE Reachability\" moniorting is requested for UE's that are using\nextended idle mode DRX, an event notification is sent to the application\nserver when the UE is about to become reachable for paging.\n\nIf the MME is aware that some signalling or data is pending in the network\nfor an UE that is known as being unreachable for a long duration, e.g. for\nUE's having extended idle mode DRX or PSM enabled, the MME may include a\nPending Data indication in the next S1-AP message towards an eNB. If the\neNB receives this indication, the eNB may take this information into\naccount when determining user inactivity. At inter-RAN node handovers, if\nsome signalling or data are still pending, the target MME may send a\nPending Data indication to the target RAN node.\n\n\n"}, {"key": "Support for Non-IP Data Delivery (NIDD)", "numbering": "4.3.17.8", "title_level": 3, "desc": "4.3.17.8 Support for Non-IP Data Delivery (NIDD)\n\n\n"}, {"key": "General", "numbering": "4.3.17.8.1", "title_level": 4, "desc": "4.3.17.8.1  General\n\nThe support of Non-IP data is part of the CIoT EPS Optimisations. A PDN\nType \"Non-IP\" is used for Non-IP data. The Non-IP data delivery to SCS/AS\nis accomplished by one of two mechanisms:\n\n  -  Delivery using SCEF as defined in clause\u00c2\u00a04.3.17.8.3.2.\n\n  -  Delivery using a Point-to-Point (PtP) SGi tunnel as defined in\n    clause\u00c2\u00a04.3.17.8.3.3.\n\nWhen the Reliable Data Service is not used, Non-IP data in-sequence\ndelivery cannot be guaranteed and data PDUs may be lost requiring higher\nprotocol layers to ensure guaranteed delivery when needed. The Reliable\nData Service is defined in TS\u00c2\u00a023.682\u00c2\u00a0[74].\n\n  NOTE:  If UEs use protocols that require broadcast/multicast mechanisms\n         (e.g. use \"IP stacks\" on top of PDN connections of type \"Non-IP\"),\n         this may cause increased traffic and power consumption to the UE\n         and the network.\n\nThe SMS service may also be used to deliver data without use of the IP\nprotocol. The SMS service is always supported for CIoT EPS Optimisations,\ni.e. can be used simultaneously with Non-IP and IP data. When only the SMS\nservice is needed, an attach without PDN connection establishment can be\nused, see clause\u00c2\u00a05.3.2.\n\nDedicated bearers are not supported for the Non-IP data.\n\n\n"}, {"key": "ESM Procedures", "numbering": "4.3.17.8.2", "title_level": 4, "desc": "4.3.17.8.2  ESM Procedures\n\nThe UE indicates in the ESM connection request, e.g. in Attach or PDN\nConnectivity Request, that a Non-IP PDN type shall be used. The\nsubscription information has a default APN for PDN Type Non-IP, which the\nMME uses for the first received Non-IP connectivity request unless the UE\nhas included an APN in the request.\n\n\n"}, {"key": "Delivery mechanism", "numbering": "4.3.17.8.3", "title_level": 4, "desc": "4.3.17.8.3  Delivery mechanism\n\n\n4.3.17.8.3.1  General\n\nAt each PDN connectivity request, the MME decides which delivery mechanism\n(SCEF based delivery or SGi based delivery) is used for delivering the Non-\nIP data between RAN and AS. An indication associated with the used APN\ndetermines if SCEF based delivery or SGi based delivery shall be used.\n\n\n4.3.17.8.3.2  SCEF based delivery\n\nWhen the MME decides to use SCEF based delivery mechanism for Non-IP data,\na PDN connection is established towards the selected SCEF. Such a PDN\nConnection is also known as an \"SCEF Connection\". The APN used for SCEF\nbased delivery is an FQDN, which either resolves to an SCEF hostname or to\nan SCEF IP addresss.\n\nThe SCEF based delivery is applicable only to the Control Plane CIoT EPS\nOptimisation (see clause\u00c2\u00a04.10).\n\nThe support of Non-IP data via the SCEF is further defined in\nTS\u00c2\u00a023.682\u00c2\u00a0[74].\n\n\n4.3.17.8.3.3  SGi based delivery\n\n\n4.3.17.8.3.3.1  General\n\nWhen support of Non-IP data is provided at the SGi interface, different\npoint-to-point tunneling techniques may be used. Point-to-point tunneling\nby UDP/IP encapsulation can be used as described in clause\u00c2\u00a04.3.17.8.3.3.2\nbelow. Other techniques as described in clause\u00c2\u00a04.3.17.8.3.3 below may be\nused.\n\nSupport for the SGi based delivery of Non-IP data can be used by any UE.\nThat is, it is independent of support for the User Plane CIoT EPS\nOptimisation and the Control Plane CIoT EPS Optimisation (see clause\u00c2\u00a04.10).\n\nThe P-GW decides at PDN connection establishment based on pre-configuration\nwhich point-to-point tunneling technique is used for the SGi based delivery\nbetween the P-GW and the AS.\n\n  NOTE:  The pre-configuration can be done in the P-GW per APN or based on\n         other criterion such as SLA between operator and 3rd party\n         application service provider, etc.\n\n\n4.3.17.8.3.3.2  SGi PtP tunnelling based on UDP/IP\n\nSGi PtP tunnelling based on UDP/IP may be used to deliver Non-IP data to AS\nvia SGi.\n\nA point-to-point tunnel is used by the P-GW towards the AS. The tunnel\nparameters (i.e. destination IP address and UDP port) for SGi PtP tunneling\nbased on UDP/IP are pre-configured on the P-GW. IP address allocation\nprocedures for PDN connections are performed locally (e.g. without\ninvolving the UE) by the P-GW based on APN configuration and according to\nclause\u00c2\u00a05.3.1. Only single IP address is used (i.e. both IPv4 and IPv6\naddresses are not allocated).\n\nThe P-GW acts as a transparent forwarding node for the payload between the\nUE and the AS.\n\nFor uplink Non-IP data, the P-GW forwards the received data to the AS over\nthe SGi PtP tunnel using UDP/IP encapsulation. When the Reliable Data\nService is enabled, the P-GW processes the Reliable Data Service Header.\nThe Reliable Data Service Configuration is pre-configured on the P-GW. The\nReliable Data Service Configuration is defined in TS\u00c2\u00a023.682\u00c2\u00a0[74].\n\nFor downlink Non-IP data, the AS sends the data using UDP/IP encapsulation\nwith the IP address of the UE and the 3GPP defined UDP port for \"Non-IP\"\ndata. The P-GW decapsulates the received data (i.e. removes the UDP/IP\nheaders) and forwards the data to S-GW on the GTP-U tunnel identified by\nthe IP address of the UE (i.e. PDN connection) for delivery to the UE. When\nthe Reliable Data Service is enabled, the P-GW adds the Reliable Data\nService Header.\n\nThe P-GW performs the IP related operations (e.g. allocates IP address for\nthe PDN connection), but the IP address or IP prefix is not provided to the\nUE (i.e. SLAAC / Router Advertisements are not performed. DHCP or DHCPv6\nare not used). In case of IPv6 the P-GW assigns an Interface Identifier for\nthe PDN connection. The allocated IP address or IPv6 prefix identifies the\nPDN connection of the UE. The P-GW shall inform the MME of the assigned\nIPv4 address or IPv6 prefix and Interface Identifier for a PDN Connection\nof a given UE. However, the UE is not informed about the assigned IPv6\nprefix and Interface Identifier.\n\n  NOTE:  It is recommended to use IPv6 for CIoT. IPv4 based addressing is\n         deprecated for machine type communication used over 3GPP accesses,\n         see TS\u00c2\u00a023.221\u00c2\u00a0[27].\n\n\n4.3.17.8.3.3.3  Other SGi PtP tunnelling mechanisms\n\nSGi PtP tunnelling mechanisms such as PMIPv6/GRE, L2TP, GTP-C/U, etc, may\nbe used to deliver Non-IP data to AS via SGi. The general handling of such\ndelivery mechanisms is as described below.\n\nA point-to-point tunnel is established by the P-GW towards the AS.\nDepending on the type of protocol employed on the SGi PtP tunnel, the SGi\nPtP tunnel setup may be done at the time of Attach or at the time of first\nMO datagram being sent by the CIoT UE. The P-GW selects the AS based on the\nP-GW configuration (e.g. per APN, or per PtP tunnel type etc.). However, IP\naddress allocation procedures for the UE (according to clause\u00c2\u00a05.3.1) are\nnot performed by the P-GW.\n\n  NOTE:  An AS can be dedicated for handling a specific Non-IP data\n         protocol.\n\nThe P-GW acts as a transparent forwarding node between the UE and the AS.\n\nFor uplink Non-IP data, the P-GW forwards the received data to the AS over\nthe established SGi PtP tunnel.\n\nFor downlink Non-IP data, the AS locates the right SGi PtP tunnel for the\nUE (using information such as UE identifiers in the Non-IP protocol itself,\netc) to forward the data. The AS sends the data to P-GW over the\nestablished SGi PtP tunnel. The P-GW in turn sends the data to S-GW on the\nGTP-U tunnel identified by the associated SGi PtP tunnel for delivery to\nthe UE.\n\n\n"}, {"key": "Support of PDN type Ethernet", "numbering": "4.3.17.8a", "title_level": 3, "desc": "4.3.17.8a   Support of PDN type Ethernet\n\nThe support of Ethernet PDN type relies upon the selection of a P-GW that\nsupports combined PGW+SMF functionality specified in TS\u00c2\u00a023.501\u00c2\u00a0[83],\nTS\u00c2\u00a023.502\u00c2\u00a0[84] and TS\u00c2\u00a023.503\u00c2\u00a0[88]. This functionality may be supported by a\nPLMN even if it has no NG-RAN coverage, however, it does require that the\nsubscriber has a subscription record in the 5GS UDM.\n\nThis feature is described in clause\u00c2\u00a05.6.10.2 of TS\u00c2\u00a023.501\u00c2\u00a0[83].\n\nFor PDN connection with Ethernet PDN type, IP address allocation is not\nneeded.\n\nIn contrast to the Non-IP PDN type, EPS Dedicated Bearers are supported for\nthe Ethernet PDN type (including the TFT as described in clause\u00c2\u00a04.7.2.1).\nThe details about the TFT packet filter(s) are described in clause\u00c2\u00a05.7.6.3\nof TS\u00c2\u00a023.501\u00c2\u00a0[83].\n\nFor PDN connection of Ethernet type, dynamic PCC is applied as described in\nclause\u00c2\u00a04.7.5 with the following differences:\n\n  -  Dynamic PCC specified in TS\u00c2\u00a023.503\u00c2\u00a0[88] is applied, i.e. the PCEF\n    interacts with the PCF using N7 interface as described in\n    TS\u00c2\u00a023.501\u00c2\u00a0[83], and the PCEF does not interact with the PCRF using Gx\n    interface as specified in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  -  The SDF template included in the PCC rule(s) uses Ethernet packet\n    filter as specified in TS\u00c2\u00a023.501\u00c2\u00a0[83].\n\n  -  The description related to IP address configuration is not applicable.\n\nDedicated Core Network functionality (see clause\u00c2\u00a04.3.25) can be used to\navoid the need for all MMEs in the PLMN to be upgraded to support Ethernet\nPDN Type.\n\nIf the UE's attempt to use the Ethernet PDN Type is rejected by the\nnetwork, the UE may attempt to gain service by requesting the Non-IP PDN\ntype.\n\nEthernet PDN Type is not supported in GERAN/UTRAN. If the UE only has an\nEthernet PDN connection established, mobility to GERAN/UTRAN should be\nprevented. To do this, the MME shall indicate to the eNB in Handover\nRestriction List that GERAN/UTRAN is restricted.\n\nFor PDN connection with Ethernet PDN type, mobility to Non 3GPP access to\nEPC is not supported.\n\n\n"}, {"key": "Service Gap Control", "numbering": "4.3.17.9", "title_level": 3, "desc": "4.3.17.9 Service Gap Control\n\nService Gap Control is an optional feature intended for MTC/CIoT UEs to\ncontrol the frequency at which these UEs can access the network. That is,\nto ensure a minimum time gap between consecutive Mobile Originated data\ncommunications initiated by the UE. This helps reducing peak load\nsituations when there are a large number of these UEs in an operator\nnetwork. Service Gap Control is intended to be used for \"small data\nallowance plans\" for MTC/CIoT UEs where the applications are tolerant to\nservice latency.\n\n  NOTE\u00c2\u00a01:  Time critical applications, such as emergency services and\n         regulatory prioritised services can suffer from the latency caused\n         by the Service Gap Control feature. Therefore Service Gap Control\n         feature is not recommended for subscriptions with such applications\n         and services.\n\nService Gap Time is a subscription parameter used to set the Service Gap\ntimer and is enforced in the UE and in the MME on a per UE level (i.e. the\nsame Service Gap Timer applies for all PDN connections that the UE has).\nThe UE indicates its capability of support for Service Gap Control in the\nAttach Request message and TAU Request message to the MME. The MME passes\nthe Service Gap Time to the UE in the Attach Accept message and/or Tracking\nArea Update Accept message for UE that has indicated its supports of the\nService Gap Control. The Service Gap Control shall be applied in a UE when\na Service Gap Time is stored in the UE context and applied in the MME when\nthe Service Gap Time is stored in the MM context.\n\nService Gap Control requires the UE to stay in ECM-IDLE mode for at least\nthe whole duration of the Service Gap timer before triggering Mobile\nOriginated user data transmission, except for procedures that are exempted\n(see TS\u00c2\u00a024.301\u00c2\u00a0[46]). The Service Gap timer shall be started each time a UE\nmoves from ECM-CONNECTED to ECM-IDLE, unless the connection request was\ninitiated by the paging of a Mobile Terminated event, or after a TAU\nprocedure without active flag or signalling active flag, which shall not\ntrigger a new or extended Service Gap interval. When a Service Gap timer\nexpires, the UE is allowed to send a connection request again. If the UE\ndoes so, the Service Gap timer will be restarted at the next ECM-CONNECTED\nto ECM-IDLE transition.\n\nThe Service Gap control is applied in ECM-IDLE state only and does not\nimpact UE Mobile Originated user data transmission or Mobile Originated\nsignaling in ECM-CONNECTED state. The Service Gap timer is not stopped upon\nECM-IDLE state to ECM-CONNECTED state transition. The UE shall not initiate\nconnection requests for MO user plane data, MO control plane data, or MO\nSMS when a Service Gap timer is running. The UE shall also not initiate\nAttach Requests when a Service Gap timer is running, unless it is Attach\nRequest without PDN connectivity or Emergency Attach which are allowed.\n\n  NOTE\u00c2\u00a02:  As a consequence of allowing Attach without PDN connectivity\n         procedure, the UE with a running Service Gap timer does not\n         initiate further MO signalling, except for tracking area updating\n         procedure, until the UE receives MT signalling or after the UE has\n         moved to ECM-IDLE state and the Service Gap Timer is not running.\n\n  NOTE\u00c2\u00a03:  Implementations need to make sure that latest and up-to-date\n         data are always sent when a Service Gap timer expires.\n\nThe MME may enforce the Service Gap timer by rejecting connection request\nfor MO user plane data, MO control plane data, or MO SMS when a Service Gap\ntimer is running. The MME may enforce the Service Gap timer by not allowing\nAttach Requests when a Service Gap timer is running, unless it is Attach\nRequest without PDN connectivity or Emergency Attach which are allowed.\nWhen rejecting the connection requests and the Attach Requests while the\nService Gap timer is running, the MME may include a Mobility Management\nback-off timer corresponding to the time left of the current Service Gap\ntimer. For the UEs that does not support Service Gap Control (e.g. pre-\nrelease-15 UEs), Service Gap Control may be enforced using \"General NAS\nlevel Mobility Management control\" as defined in clause\u00c2\u00a04.3.7.4.2.1.\n\nWhen the MME starts the Service Gap timer, the MME should invoke the\nService Gap timer with a value that is slightly shorter than the Service\nGap Time value provided to the UE in the subscription information received\nfrom the HSS.\n\n  NOTE\u00c2\u00a04:  This ensures that the MME doesn't reject any UE requests just\n         before the Service Gap timer expires e.g. because of slightly\n         unsynchronized timers between UE and MME.\n\nA UE which transitions from a PSM or eDRX power saving state shall apply\nService Gap Control when it wakes up if the Service Gap timer is still\nrunning.\n\nAdditional aspects of Service Gap Control:\n\n  -  Service Gap Control applies in all PLMNs.\n\n  -  When the Service Gap timer is running and the UE receives paging, the\n    UE shall respond as normal.\n\n  -  Service Gap Control applies to low priority (delayTolerant) and normal\n    traffic.\n\n  -  Service Gap Control does not apply to exception reporting for NB-IoT.\n\n  -  Emergency Attach and Attach without PDN Connectivity are allowed when\n    a Service Gap timer is running.\n\n  -  Service Gap Control shall be effective also for UEs performing detach\n    and reattach unless it is Attach Request without PDN connectivity or\n    Emergency Attach.\n\n  -  Tracking Area Update with active flag or signalling active flag is not\n    allowed when a Service Gap timer is running.\n\n  -  If the Service Gap timer is running, the Service Gap is applied at\n    PLMN selection as follows:\n\n    a) Re-attach to the registered PLMN: The remaining Service Gap timer\n       value survives and controls the re-attach.\n\n    b) Attach or Tracking Area Update to a different PLMN: The remaining\n       Service Gap timer value survives and controls the Attach/Tracking\n       Area Update to the new PLMN.\n\n    c) USIM swap: The Service Gap timer is no longer running and the\n       Service Gap feature does not apply, unless re-instatiated by the\n       serving PLMN.\n\n  -  Multiple uplink packets and downlink packets are allowed during one\n    RRC connection for UE operating within its APN Rate Control limits.\n\nThe following procedures are impacted by Service Gap Control:\n\n  -  E-UTRAN Initial Attach, see clause\u00c2\u00a05.3.2.1;\n\n  -  Tracking Area Update procedures, see clause\u00c2\u00a05.3.3;\n\n  -  UE Triggered Service Request, see clause\u00c2\u00a05.3.4.1;\n\n  -  Connection Resume Request, see clause\u00c2\u00a05.3.5A.\n\n  NOTE\u00c2\u00a05:  Since UE triggered Service Request and Connection Resume Request\n         are prevented by Service Gap timer, this implictly prevents the UE\n         from initiating MO data in Control Plane EPS Optimisations (see\n         clause\u00c2\u00a05.3.4B.2), MO NIDD procedure (see TS\u00c2\u00a023.682\u00c2\u00a0[74]) and MO SMS\n         (see TS\u00c2\u00a023.272\u00c2\u00a0[58]).\n\n\n"}, {"key": "Multimedia Priority Service", "numbering": "4.3.18", "title_level": 2, "desc": "4.3.18 Multimedia Priority Service\n\n\n"}, {"key": "General", "numbering": "4.3.18.1", "title_level": 3, "desc": "4.3.18.1 General\n\nMultimedia Priority Service (MPS) allows certain subscribers (i.e. Service\nUsers as per TS\u00c2\u00a022.153\u00c2\u00a0[68]) priority access to system resources in\nsituations such as during congestion, creating the ability to deliver or\ncomplete sessions of a high priority nature. Service Users are government-\nauthorized personnel, emergency management officials and/or other\nauthorized users. MPS supports priority sessions on an \"end-to-end\"\npriority basis.\n\nMPS is based on the ability to invoke, modify, maintain and release\nsessions with priority, and deliver the priority media packets under\nnetwork congestion conditions. MPS is supported in a roaming environment\nwhen roaming agreements are in place and where regulatory requirements\napply.\n\n  NOTE\u00c2\u00a01:  If a session terminates on a server in the Internet (e.g. web-\n         based service), then the remote end and the Internet transport are\n         out of scope for this specification.\n\nA Service User obtains priority access to the Radio Access Network by using\nthe Access Class Barring mechanism according to TS\u00c2\u00a036.331\u00c2\u00a0[37] and\nTS\u00c2\u00a022.011\u00c2\u00a0[67]. This mechanism provides preferential access to UEs based on\nits assigned Access Class. If a Service User belongs to one of the special\naccess-classes as defined in TS\u00c2\u00a022.011\u00c2\u00a0[67], the UE has preferential access\nto the network compared to ordinary users in periods of congestion.\n\nMPS subscription allows users to receive priority services, if the network\nsupports MPS. MPS subscription entitles a USIM with special Access\nClass(es). MPS subscription includes indication for support of EPS bearer\npriority service, IMS priority service and CS Fallback priority service\nsupport for the end user. Priority level regarding EPS bearer and IMS are\nalso part of the MPS subscription information. The usage of priority level\nis defined in TS\u00c2\u00a023.203\u00c2\u00a0[6] and TS\u00c2\u00a023.228\u00c2\u00a0[52].\n\nService Users is treated as On Demand MPS subscribers or not, based on\nregional/national regulatory requirements. On Demand service is based on\nService User invocation/revocation explicitly and applied to the PDN\nconnections for an APN. When not On Demand, MPS service does not require\ninvocation, and provides priority treatment for all EPS bearers for a given\nService User after attachment to the EPS network.\n\n  NOTE\u00c2\u00a02:  According to regional/national regulatory requirements and\n         operator policy, On-Demand MPS Service Users can be assigned the\n         highest priority.\n\nFor this release of the specification, MPS is supported for E-UTRAN access\nonly in case of 3GPP accesses.\n\nSince the Service User has an access class within the range for priority\nservices, the Establishment Cause in RRC connection request is set to\nhighPriorityAccess. When the eNodeB receives mobile initiated signalling\nwith establishment cause set to highPriorityAccess, the eNodeB handles the\nRRC connection request with priority. When the MME receives and verifies\nmobile initiated signalling with establishment cause set to\nhighPriorityAccess, the MME establishes the S1 bearer with priority.\n\nThe terminating network identifies the priority of the MPS session and\napplies priority treatment, including paging with priority, to ensure that\nthe MPS session can be established with priority to the terminating user\n(either a Service User or normal user).\n\nPriority treatment for MPS includes priority message handling, including\npriority treatment during authentication, security, and location management\nprocedures.\n\nPriority treatment for MPS session requires appropriate ARP and QCI (where\nnecessary for non-GBR bearers) setting for bearers according to the\noperator's policy.\n\nWhen an MPS session is requested by a Service User, the following bearer\nmanagement principles apply in the network:\n\n  -  EPS bearers (including default bearer) employed in an MPS session\n    shall be assigned ARP value settings appropriate for the priority level\n    of the Service User.\n\n  -  Setting ARP pre-emption capability and vulnerability for MPS bearers,\n    subject to operator policies and depending on national/regional\n    regulatory requirements.\n\n  -  Pre-emption of non-Service Users over Service Users during network\n    congestion situation, subject to operator policy and national/regional\n    regulations.\n\nPriority treatment is applicable to IMS based multimedia services, priority\nEPS bearer services (PS data without IMS interaction) and CS Fallback.\n\nFor Multimedia Priority services any EPC functions, procedures and\ncapabilities are provided according to this clause's specification except\nwhen specified differently in the following clauses.\n\n\n"}, {"key": "IMS-based Multimedia Priority Services", "numbering": "4.3.18.2", "title_level": 3, "desc": "4.3.18.2 IMS-based Multimedia Priority Services\n\n\n"}, {"key": "Originating IMS-based MPS Session", "numbering": "4.3.18.2.1", "title_level": 4, "desc": "4.3.18.2.1  Originating IMS-based MPS Session\n\nIMS based MPS sessions are permitted to be originated from any UE, in\naddition to MPS-subscribed UEs.\n\nThe MPS-subscribed UE, based on the MPS IMS subscription information,\noperator's policy and national/regional regulations, may be given priority\ntreatment for the default bearer and the EPS bearer carrying IMS signalling\nin the EPS prior to and during IMS-based MPS invocation. Further, priority\ntreatment in the EPS for signalling and media bearers may be\nmodified/established via dynamic PCC based on the session authorization\ninformation received from the AF.\n\nAs the IMS media bearer is established after the IMS session of the MPS\nservice has been established, it can be assigned with correct ARP value\nwhen it is established. However IMS signalling related EPS bearer needs to\nbe upgraded if it has not been assigned with an appropriate ARP setting for\nthe MPS service when the IMS session of the MPS service has been initiated.\n\nAlso to avoid cases where the default bearer may not be allocated resources\nin the handover case, due to low ARP priority for the PDN connection, it is\nnecessary to assure that the default bearer has an ARP setting appropriate\nfor the MPS service.\n\n\n"}, {"key": "Terminating IMS-based MPS Session", "numbering": "4.3.18.2.2", "title_level": 4, "desc": "4.3.18.2.2  Terminating IMS-based MPS Session\n\nThe terminating network identifies the priority of the IMS-based MPS\nsession and applies priority treatment to ensure that the call is delivered\nwith priority to the terminating user (either a Service User or normal\nuser).\n\nIf the existing ARP of the default or dedicated EPS bearer that is used to\ntransport IMS signalling are not appropriate for the MPS service, then PCRF\nupdates to the appropriate settings.\n\nS-GW triggers a new priority paging towards MME in case the ongoing paging\nis lower priority than the incoming data received in the S-GW for IMS\nterminating session.\n\n\n"}, {"key": "Priority EPS Bearer Services", "numbering": "4.3.18.3", "title_level": 3, "desc": "4.3.18.3 Priority EPS Bearer Services\n\nThe Service User receives on demand priority treatment according to its MPS\nprofile, i.e. On-Demand. If the Service User is not authorized to use on-\ndemand priority request, the Service User receives priority treatment (i.e.\nappropriate ARP and QCI ) at initial attach for all bearers, based on user\nprofile data stored in the HSS/SPR and authorized by the PCRF (see\nTS\u00c2\u00a023.203\u00c2\u00a0[6], clause\u00c2\u00a07.2).\n\nAn On-Demand Service User requires explicit invocation/revocation via SPR\nMPS user profile update (see TS\u00c2\u00a023.203\u00c2\u00a0[6], clause\u00c2\u00a07.5). Since MPS user\nprofile are part of inputs for PCC rules, the update will trigger PCC rules\nmodification to achieve appropriate ARP and QCI settings for bearers (see\nTS\u00c2\u00a023.203\u00c2\u00a0[6], clause\u00c2\u00a07.4.2).\n\nWhen the eNodeB receives mobile initiated signalling with establishment\ncause set to highPriorityAccess, the eNodeB handles the RRC connection\nrequest with priority. When the MME receives and verifies mobile initiated\nsignalling with establishment cause set to highPriorityAccess, the MME\nestablishes the S1 bearer with priority. Based on MPS EPS priority\nsubscription, MME can verify whether the UE is permitted to handle the\nrequest preferentially comparing to other UEs not prioritized.\n\nAn AF for MPS Priority Service is used to provide Priority EPS Bearer\nServices using network-initiated resource allocation procedures (via\ninteraction with PCC) for originating accesses.\n\n  NOTE:  Use of 3rd party AF for MPS services for Service Users is outside\n         the scope of 3GPP specification.\n\n\n"}, {"key": "CS fallback", "numbering": "4.3.18.4", "title_level": 3, "desc": "4.3.18.4 CS fallback\n\nCS Fallback allows users to fallback to GERAN/UTRAN/1x RTT while in E-UTRAN\naccess thus allowing the network to transfer the call towards GERAN/UTRAN\nCS domain. In order to ensure that a priority CSFB call to/from a service\nuser is given proper priority treatment in the EPS, MPS subscription\nindicates the user's CS priority status, i.e. MPS CS Priority, which is\nprovided to MME with user's subscription information. When the eNodeB\nreceives mobile initiated signalling with establishment cause set to\nhighPriorityAccess, the eNodeB handles the RRC connection request with\npriority. When the MME receives and verifies mobile initiated signalling\nwith establishment cause set to highPriorityAccess, the MME establishes the\nS1 bearer with priority.\n\nDetails on the priority treatment of CSFB, see TS\u00c2\u00a023.272\u00c2\u00a0[58].\n\n\n"}, {"key": "Network Congestion Controls for MPS", "numbering": "4.3.18.5", "title_level": 3, "desc": "4.3.18.5 Network Congestion Controls for MPS\n\nBased on regional/national requirements and network operator policy, MPS\nshall be exempted from network congestion controls up to the point where\nfurther exemptions cause network instability. The MME should not apply NAS\nlevel congestion control for mobile initiated signalling with establishment\ncause set to highPriorityAccess. The MME should not apply congestion\ncontrol for termination requests related with an ARP associated with MPS.\n\n\n"}, {"key": "Load Re-balancing between MMEs for MPS", "numbering": "4.3.18.6", "title_level": 3, "desc": "4.3.18.6 Load Re-balancing between MMEs for MPS\n\nWhen a UE is in ECM-CONNECTED mode with a bearer having an ARP associated\nwith MPS, the MME should not release the UE for load re-balancing, except\nunder critical conditions such as the need to perform an MME node restart.\nThe MME should wait until the UE initiates a TAU or becomes ECM-IDLE before\ninitiating load re-balancing.\n\n\n"}, {"key": "Core Network node resolution", "numbering": "4.3.19", "title_level": 2, "desc": "4.3.19 Core Network node resolution\n\n\n"}, {"key": "General", "numbering": "4.3.19.1", "title_level": 3, "desc": "4.3.19.1 General\n\nThe indication of mapped or native GUTI shall be signalled by the UE to the\nMME as an explicit indication in Attach Request and TAU Request messages.\nThe indication of mapped or native P-TMSI/RAI shall be signalled by the UE\nto the SGSN as an explicit indication in Attach Request and RAU Request\nmessages. The MME/SGSN resolves the old MME/SGSN using old GUTI respective\nold P-TMSI/RAI sent in the Attach request and TAU/RAU request messages ,\nand determines if the old GUTI or the old P-TMSI/RAI is mapped or native by\none of the following two methods:\n\n  -  Indication using most significant bit (MSB) in LAC and MME Group ID.\n\n  -  Explicit indication sent from UE to MME and SGSN.\n\n\n"}, {"key": "MSB in LAC and MME Group ID", "numbering": "4.3.19.2", "title_level": 3, "desc": "4.3.19.2 MSB in LAC and MME Group ID\n\nFor PLMNs deployed with such mechanism the MME differentiates between a\nGUMMEI mapped from P-TMSI/RAI and a native GUMMEI based on the value of\nmost significant bit of the MME Group ID; i.e. the MSB is set to \"0\" then\nthe GUMMEI is mapped from P-TMSI/RAI and if MSB is set to \"1\", the GUMMEI\nis a native one, as specified in TS\u00c2\u00a023.003\u00c2\u00a0[9].\n\nFor PLMNs deployed with such mechanism the S4-SGSN differentiates between a\nP-TMSI/RAI mapped from GUTI and a native P-TMSI/RAI based on the value of\nmost significant bit of the LAC; i.e. the MSB is set to \"1\" then the P-\nTMSI/RAI is mapped from GUTI and if MSB is set to \"0\", the P-TMSI/RAI is a\nnative one, as specified in TS\u00c2\u00a023.003\u00c2\u00a0[9].\n\n\n"}, {"key": "Explicit Indication", "numbering": "4.3.19.3", "title_level": 3, "desc": "4.3.19.3 Explicit Indication\n\nFor PLMNs deployed with such mechanism the MME differentiates between a\nGUTI mapped from P-TMSI/RAI or a native GUTI based on the explicit\nindication sent by the UE.\n\nFor PLMNs deployed with such mechanism the S4-SGSN differentiates between a\nP-TMSI/RAI mapped from GUTI or a native P-TMSI/RAI based on the explicit\nindication sent by the UE.\n\n\n"}, {"key": "Relaying function", "numbering": "4.3.20", "title_level": 2, "desc": "4.3.20 Relaying function\n\n\n"}, {"key": "General", "numbering": "4.3.20.1", "title_level": 3, "desc": "4.3.20.1 General\n\nThe relaying function enables an operator to improve and extend the\ncoverage area by having a Relay Node (RN) wirelessly connected to an eNB\nserving the RN, called Donor eNB (DeNB), via a modified version of the E-\nUTRA radio interface called the Un interface as specified in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\nThe relaying function and use of RN/DeNB entities in a network is\ntransparent to the operations of the UEs connected to it and associated\ncore network entities (e.g. MME, S/P-GW, PCRF etc.) for the UEs.\n\nThe relaying architecture is shown in figure 4.3.20.1-1.\n\n                                    [pic]\n\n                  Figure 4.3.20.1-1: Relaying Architecture\n\n  NOTE\u00c2\u00a01:  Impact to core network elements from the introduction of RNs and\n         DeNB is minimized by reusing the existing nodes and protocols when\n         interacting with the core network.\n\n  NOTE\u00c2\u00a02:  Functions of the MME for the RN and MME for the UE may be\n         collocated in a single MME.\n\nThe RN supports the eNB functionality like termination of the radio\nprotocols of the E-UTRA radio interface and the S1 and X2 interfaces. The\nRN also supports a subset of the UE functionality and protocols to\nwirelessly connect to the DeNB.\n\nIn addition to supporting eNB functionality, the DeNB also embeds and\nprovides the S-GW/P-GW-like functions needed for the RN operation. This\nincludes creating a session for the RN and managing EPS bearers for the RN\nas shown in clause\u00c2\u00a04.3.20.3, as well as terminating the S1-AP and S11\ninterfaces towards the MME serving the RN. Due to the proxy functionality,\nthe DeNB appears as an MME (for S1), an eNB (for X2) and an S-GW to the RN.\n\nThe RN and DeNB also perform mapping of signalling and data packets onto\nEPS bearers that are setup for the RN. The mapping is based on existing QoS\nmechanisms defined for the UE and the P-GW and are described in\nTS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n\n"}, {"key": "RN startup and attach procedure", "numbering": "4.3.20.2", "title_level": 3, "desc": "4.3.20.2 RN startup and attach procedure\n\n\n"}, {"key": "General", "numbering": "4.3.20.2.1", "title_level": 4, "desc": "4.3.20.2.1  General\n\nThe startup procedure for the Relay Node is based on the normal UE attach\nprocedure and consists of the following two phases:\n\n  -  Phase I: Attach for RN preconfiguration.\n\n  -  Phase II: Attach for RN operation (MME of the RN).\n\n  NOTE:  When the certificate-based solution is used, the RN uses USIM-INI\n         in Phase I and USIM-RN in Phase II with necessarily different\n         IMSIs. When pre-shared key is used, there is only need for one USIM\n         and the RN uses the same IMSI during Phase I and Phase II. The MME\n         does not treat certificate-based and pre-shared key-based solution\n         differently. The use of the certificate-based and pre-shared key\n         solutions is specified in Annex\u00c2\u00a0D of TS\u00c2\u00a033.401\u00c2\u00a0[41].\n\n\n"}, {"key": "Attach for RN preconfiguration", "numbering": "4.3.20.2.2", "title_level": 4, "desc": "4.3.20.2.2  Attach for RN preconfiguration\n\nThe RN attaches to the E-UTRAN/EPC as a UE at power-up (i.e. the RN shall\nnot include the RN indication in the RRC Connection establishment\nsignalling). The eNB treats the RN as a normal UE when performing MME\nselection.\n\nBecause the eNB does not indicate that this is a RN in the S1 interface\nInitial UE message, the MME does not perform any further RN specific\nactions (e.g. it ignores any indication from the HSS that \"this\nsubscription includes a permission to operate as a RN\").\n\nThe authentication of the \"RN acting as an UE\" is performed by the MME\nduring this attach procedure, using the information obtained from the HSS.\n\nThe MME performs the S-GW and P-GW selection as for a normal UE.\n\n  NOTE:  It is the responsibility of the HSS operator to ensure that the RN\n         subscription includes an APN configuration that ensures that the RN\n         subscription cannot be used for other purposes, e.g. only a single\n         APN is configured for the use of RNs in phase I, and, that this APN\n         is reserved for RNs only.\n\nThe RN retrieves initial RN configuration parameters as user plane traffic,\nacross the SGi reference point, from RN OAM (e.g. list of DeNB cells and\nselected PLMN).\n\nAfter this operation is complete, the RN detaches from the network using\nthe normal UE initiated detach procedure, see clause\u00c2\u00a05.3.8.2.1 and the RN\ntriggers Phase II.\n\n\n"}, {"key": "Attach for RN operation", "numbering": "4.3.20.2.3", "title_level": 4, "desc": "4.3.20.2.3  Attach for RN operation\n\nTo start relay operations, the normal attach procedure, with the following\nexceptions, is applied:\n\n  -  The RN and the USIM-RN perform local security operations (e.g.\n    establishment of a secure channel between them) as specified in\n    TS\u00c2\u00a033.401\u00c2\u00a0[41];\n\n  -  The RN selects a cell from the list acquired during Phase I;\n\n  -  The RN establishes an RRC connection with the DeNB, indicating that\n    the connection is for a RN;\n\n  -  The DeNB is aware of the MMEs that support RN functionality. In all\n    cases when the RN indication is recieved, the DeNB shall ensure that\n    the current or (re)selected MME supports RN functionality;\n\n  NOTE\u00c2\u00a01:  The RN follows normal UE behaviour, e.g. the RN's NAS may use\n         either an IMSI or a GUTI. Also, the RN's NAS may or may not provide\n         an S-TMSI to the RN's AS, and hence, the RRCConnectionRequest may\n         either contain an S-TMSI or a random value.\n\n  -  In the S1 interface Initial UE Message, the DeNB sends the RN\n    indication to the MME. This message also carries the IP address of the\n    S-GW/P-GW function embedded in the DeNB;\n\n  -  The subscription data supplied to the MME by the HSS for USIM-RN\n    includes an indication that the subscription is permitted to be used by\n    a RN.\n\n  -  If the S1 interface Initial UE Message indicates that this is a RN,\n    but the subscription data does not indicate that the subscription\n    includes a permission to operate as a RN, then the MME shall reject the\n    NAS procedure (e.g. Attach Request, Tracking Area Update Request,\n    Service Request, etc) with an appropriate cause value (e.g. one that\n    avoids retries on this PLMN yet does not harm a RN that has\n    unexpectedly performed PLMN reselection).\n\n  NOTE\u00c2\u00a02:  It is anticipated that the MME checks that the HPLMN of the USIM-\n         RN is authorised to attach RNs to this MME.\n\n  -  The MME and RN perform the normal EPS Authentication procedures.\n\n  -  MME (RN) selects the S-GW/P-GW in DeNB for the RN based on the IP\n    address included in the Initial UE Message (i.e. all GW selection and\n    APN related procedures are bypassed during this phase). The MME\n    performs S11 interface signalling with the S-GW/P-GW located in the\n    DeNB;\n\n  -  The MME accepts the attach procedure and sets up an S1 context with\n    the DeNB.\n\nWhen relay function is enabled, MMEs in a pool should all have the same\nrelaying function capability in order to have consistent support for\nfunctions such as redundancy, load balancing.\n\n                                    [pic]\n\n                   Figure 4.3.20.2-1: RN attach procedure\n\nThe detach procedure for the RN is the same as the normal UE detach\nprocedure, though the RN should ensure that no UE is connected to the RN\ncells before detaching. It is up to RN implementation how it ensures no UE\nis connected.\n\n\n"}, {"key": "DeNB E-RAB activation/modification", "numbering": "4.3.20.3", "title_level": 3, "desc": "4.3.20.3 DeNB E-RAB activation/modification\n\nThis procedure is used by the DeNB to change the EPS bearer allocation for\nthe RN. The procedure is the same as the normal network-initiated bearer\nactivation/modification procedure with the exception that the S-GW/P-GW\nfunctionality (steps 1 and 6) is performed by the DeNB.\n\n                                    [pic]\n\n Figure 4.3.20.3-1: DeNB-initiated bearer activation/modification procedure\n\n  NOTE:  It is up to implementation if and when the DeNB sets up and\n         modifies EPS bearers for the RN, in addition to the initial bearer\n         set up procedures at Attach.\n\n\n"}, {"key": "Core Network assisted eNodeB parameters tuning", "numbering": "4.3.21", "title_level": 2, "desc": "4.3.21 Core Network assisted eNodeB parameters tuning\n\n\n"}, {"key": "CN Assistance Information", "numbering": "4.3.21.1", "title_level": 3, "desc": "4.3.21.1 CN Assistance Information\n\nCore Network assisted eNodeB parameters tuning aids the eNodeB to minimize\nthe UE state transitions and achieve optimum network behaviour. How the eNB\nuses the Core Network assistance information is not in scope of this\nspecification and is implementation specific.\n\nCore Network assistance information may be derived by the MME per UE in the\nMME based on collection of UE behaviour statistics or other available\ninformation about the expected UE behaviour (such as subscribed APN, IMSI\nranges or other subscription information). If the HSS provides the\nCommunication Pattern (CP) parameters (see TS\u00c2\u00a023.682\u00c2\u00a0[74]) within the\nsubscription profile information, then the MME may use the CP parameters\nfor selecting the CN assisted eNB parameters. The CP parameters received\nfrom the HSS are used by the MME as input to derive the CN assisted eNB\nparameter values. For the case of statistics-based Core Network assistance\ninformation collection, this may be enabled based on local configuration\n(e.g. subscribed APN, IMSI ranges or other subscription information). This\ninformation provides the eNB with a way to understand the UE behaviour for\nthese aspects:\n\n  -  \"Expected UE activity behaviour\", i.e. the expected pattern of the\n    UE's changes between ECM-CONNECTED and ECM-IDLE states. This may be\n    derived e.g. from statistical information or from subscription\n    information.\n\n  -  \"Expected HO interval\", i.e. the expected time interval between inter-\n    eNB handovers. This may be derived e.g. from statistical information or\n    from subscription information. The \"Expected HO interval\" parameter is\n    not based on subscription information. Highly mobile UEs may have the\n    ECM-CONNECTED state reduced to reduce handover signalling, unless the\n    activity data do not justify that, as reduced handover signalling would\n    be outweighed by more Service Request signalling).\n\n  -  \"UE Differentiation Information\" including the Communication Pattern\n    parameters (see TS\u00c2\u00a023.682\u00c2\u00a0[74]) to support Uu operation optimisation\n    for NB-IoT UE differentiation.\n\nThe respective signalling to support this feature is specified in\nTS\u00c2\u00a036.413\u00c2\u00a0[36]. The cases where the Traffic Profile (see see\nTS\u00c2\u00a023.682\u00c2\u00a0[74]) is not used are described in clauses 5.3.4B.2 and 5.3.4B.3.\n\nThe MME decides when to send this information to the eNB as \"Expected UE\nbehaviour\" carried in S1-AP signalling over the S1-MME interface as per\nprocedure documented in clause\u00c2\u00a04.3.21.3.\n\n  NOTE\u00c2\u00a01:  The calculation of the Core Network assistance information, i.e.\n         the algorithms used and related criteria, and the decision when it\n         is considered suitable and stable to send to the eNB are vendor\n         specific. Unreliable information should not be provided to the eNB\n         as it may drive undesirable system effects.\n\n  NOTE\u00c2\u00a02:  It is recommended the MME or, depending on where this assessment\n         is performed, the eNB, can consider the average times in the ECM-\n         CONNECTED and ECM-IDLE states an accurate representation of the\n         traffic patterns if the average time in ECM-CONNECTED mode is short\n         enough to assume the UE is generally actively transmitting and/or\n         receiving data while in ECM-CONNECTED state.\n\n  NOTE\u00c2\u00a03:  When there are multiple overlapping CP parameter sets received\n         from the HSS for one UE, then the MME considers a merge per CP\n         parameter when deriving the CN assisted eNB parameters, e.g. based\n         on the Scheduled communication time and/or Communication duration\n         time parameters. A conflict on the Stationary Indication parameter\n         can be resolved by considering the UE as \"mobile\".\n\n\n"}, {"key": "Void", "numbering": "4.3.21.2", "title_level": 3, "desc": "4.3.21.2 Void\n\n\n\n\n"}, {"key": "Core Network Assistance Procedures", "numbering": "4.3.21.3", "title_level": 3, "desc": "4.3.21.3 Core Network Assistance Procedures\n\nThe MME provides CN assistance information to the eNodeB if available,\nduring the setup of the S1 signalling connection (e.g., Attach, Service\nRequest).\n\nThe following figure is a high level description of the transfer of\ninformation from an MME to eNodeB during a service request procedure.\n\n                                    [pic]\n\n      Figure 4.3.21.3-1: Core Network assisted eNodeB parameters tuning\n\n\n"}, {"key": "UE Power Saving Mode", "numbering": "4.3.22", "title_level": 2, "desc": "4.3.22 UE Power Saving Mode\n\nA UE may adopt a PSM that is described in TS\u00c2\u00a023.682\u00c2\u00a0[74]. If a UE is\ncapable of adopting a PSM and it wants to use the PSM it shall request an\nActive Time value and may request a Periodic TAU/RAU Timer value during\nevery Attach and TAU procedures, which are handled as described in\nTS\u00c2\u00a023.682\u00c2\u00a0[74]. The UE shall not request a Periodic TAU/RAU Timer value if\nit is not requesting an Active Time value. The network shall not allocate\nan Active Time value if the UE has not requested it.\n\nPSM has no support in the CS domain on the network side.\n\n  NOTE\u00c2\u00a01:  When the PSM is activated the UE might not be available for\n         paging of Mobile Terminated CS services even though the UE is\n         registered in the CS domain.\n\n  NOTE\u00c2\u00a02:  The Attach and TAU procedures of this specification are not\n         showing the details of the Periodic TAU Time and Active Time\n         negotiation, i.e. are not showing the related IEs.\n\nIf the network allocates an Active Time value, the UE and the MME starts\nthe Active timer (see clause\u00c2\u00a04.3.5.2) with the Active Time value allocated\nby the network when transitioning from ECM_CONNECTED to ECM_IDLE. The UE\nshall stop the Active timer, if running, when a transition to ECM_CONNECTED\nmode is made. When the Active timer expires, the UE deactivates its Access\nStratrum functions and enters PSM. In PSM, due to deactivation of Access\nStratum functions, the UE stops all idle mode procedures, but continues to\nrun any NAS timers that may apply, e.g. the periodic TAU timer. The UE\nshall resume Access Stratum functions and idle mode procedures before the\nperiodic TAU timer expires for performing the periodic TAU procedure as\napplicable. The UE may resume idle mode procedures and Access Stratum\nfunctions any time while in PSM, e.g. for mobile originated communications.\nAny timers and conditions that remain valid during power-off, e.g. for NAS-\nlevel back-off, apply in the same way during PSM.\n\nWhen the Active timer expires for the UE, the MME knows that the UE entered\nPSM and is not available for paging. The MME handles availability for\npaging as detailed in clause\u00c2\u00a04.3.5.2.\n\nOn UE side the PSM complies with some substates of EMM_REGISTERED, as\nspecified in TS\u00c2\u00a024.301\u00c2\u00a0[46]. The MME considers the UE to be EMM_REGISTERED,\nbut not reachable. The UE's Access Stratum functions are considered as\ndeactivated during PSM.\n\nFor mobile terminated data while a UE is in PSM, the functions for High\nlatency communication may be used as described in clause\u00c2\u00a04.3.17.7.\n\nWhen the UE has bearers for emergency services, the UE shall not apply PSM.\n\n\n"}, {"key": "Access network selection and traffic steering based on RAN-assisted", "numbering": "4.3.23", "title_level": 2, "desc": "4.3.23 Access network selection and traffic steering based on RAN-assisted\n         WLAN interworking\n\nAs described in TS\u00c2\u00a036.300\u00c2\u00a0[5], TS\u00c2\u00a036.304\u00c2\u00a0[34], TS\u00c2\u00a036.331\u00c2\u00a0[37] and\nTS\u00c2\u00a025.331\u00c2\u00a0[33], UTRAN and E-UTRAN may provide RAN assistance parameters to\nthe UE via RRC signalling. The RAN assistance parameters may e.g. include E-\nUTRAN signal strength and quality thresholds, WLAN channel utilization\nthresholds, WLAN backhaul data rate thresholds, a list of WLAN identifiers\nand Offload Preference Indicator (OPI). The UE uses the RAN assistance\nparameters to perform access network selection and traffic steering\ndecisions between 3GPP access and WLAN using procedures defined in\nTS\u00c2\u00a036.304\u00c2\u00a0[34] or using ANDSF policies defined in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Co-\nexistence between the procedures defined in TS\u00c2\u00a036.304\u00c2\u00a0[34] and ANDSF\npolicies is described in TS\u00c2\u00a023.402\u00c2\u00a0[2].\n\nFor traffic steering decisions using procedures defined in TS\u00c2\u00a036.304\u00c2\u00a0[34]\nthe MME may provide information to the UE indicating which PDN Connection\ncan be offloaded to WLAN and which PDN Connection shall not be offloaded to\nWLAN. When provided by the MME, this indication is provided in NAS\nsignalling on a per PDN Connection basis when a PDN Connection is\nestablished. The MME may provide a per-RAT indication for the PDN\nconnection, e.g. if the indication is different for UTRAN and for E-UTRAN.\nIf the MME provides a single indication, the UE shall apply such indication\nboth to E-UTRAN and UTRAN.\n\nTraffic steering decisions using procedures defined in TS\u00c2\u00a036.304\u00c2\u00a0[34] are\nnot applicable to non-seamless WLAN offload (see TS\u00c2\u00a023.402\u00c2\u00a0[2] for the\ndefinition of non-seamless WLAN offload).\n\nIn order for the operator to allow/prohibit WLAN offloading on per user and\nper APN basis, subscription data in the HSS may be configured to indicate\nif WLAN offload is allowed or prohibited for an APN.\n\nThe MME determines the WLAN offloading permissions for the UE and PDN\nConnection as described below:\n\n  -  The MME determines the offloadability of a PDN Connection based on\n    subscription data and locally configured policy (e.g. for roaming users\n    or when the subscription data does not include any WLAN offloadability\n    indication).\n\n  -  When the UE establishes a new PDN Connection, the MME may indicate\n    whether this PDN Connection is offloadable or not offloadable to WLAN.\n\n  -  The MME may provide an updated WLAN offloadability indication of a PDN\n    Connection to the UE. This may be initiated by HSS as part of the\n    Insert Subscriber Data procedure as described in clause\u00c2\u00a05.3.9.2. It can\n    also be initiated by the MME by initiating steps\u00c2\u00a04 to 7 of the Bearer\n    Modification Procedure in clause\u00c2\u00a05.4.3, Figure 5.4.3-1 or by adding the\n    WLAN offloadability indication to a session management NAS message sent\n    to the UE as part of an existing procedure. The MME shall not trigger\n    signaling to an ECM-IDLE UE solely for the purpose of updating the WLAN\n    offloadability indication.\n\nWhen the UE applies the procedures defined in TS\u00c2\u00a036.304\u00c2\u00a0[34] and\nTS\u00c2\u00a025.304\u00c2\u00a0[12], if the UE has Local Operating Environment Information\n(LOEI), as defined in TS\u00c2\u00a023.261\u00c2\u00a0[54], the UE shall consider the RAN rules\nin combination with the non-radio related aspects of LOEI, and shall give\npriority to LOEI in case it indicates WLAN is not acceptable for non-radio\nrelated reasons. For example, if the active RAN rule indicates that traffic\nshall be moved to WLAN access, but the LOEI in the UE indicates that WLAN\naccess is unacceptable due to non-radio related causes (e.g. due to\nauthentication issues, low battery power, etc.), the UE shall not move the\ntraffic to WLAN.\n\nWhen the UE applies the procedures defined in TS\u00c2\u00a036.304\u00c2\u00a0[34], the UE takes\ninto account the WLAN offloadability indication from MME to perform\nhandover between 3GPP access and WLAN access using the handover procedures\ndescribed in TS\u00c2\u00a023.402\u00c2\u00a0[2].\n\nWhen the UE receives a WLAN offloadability indication from the network for\na PDN connection the UE stores it for the lifetime of that PDN Connection\nand updates it if a new value is received from the network. The UE shall\napply the latest indication previously received for the PDN Connection.\n\nThe indication of whether a PDN connection is offloadable or not\noffloadable should be passed from the source to the target serving node in\nmobility management procedures from a MME to a MME/SGSN. This allows the\ntarget SGSN/MME to learn the indication previously provided to the UE and\nto decide the need for providing an updated indication to the UE.\n\n\n"}, {"key": "Access network selection and traffic steering based on RAN-", "numbering": "4.3.23a", "title_level": 2, "desc": "4.3.23a  Access network selection and traffic steering based on RAN-\n         Controlled WLAN interworking\n\nAs described in TS\u00c2\u00a036.300\u00c2\u00a0[5] E-UTRAN may support RAN-Controlled WLAN\ninterworking (RCLWI) for controlling traffic steering between E-UTRAN and\nWLAN for UEs in RRC_CONNECTED. When E-UTRAN sends an \"offload\" command to\nthe UE, the UE passes an indication to the upper layers indicating that\ntraffic steering to/from WLAN is needed. The upper layers determine to\ninitiate traffic steering to/from WLAN based on the UE capability and the\nconfiguration information that has received from NAS layer indicating which\nPDN connections are offloadable. When the UE receives the \"offload\" command\nfrom the EUTRAN, the UE shall perform handover to WLAN only the PDN\nconnections that have been authorized for offloading.\n\nThe NAS level indication about \"offloadability\" of PDN connections is\ndefined in clause\u00c2\u00a04.3.23.\n\nThe UE uses the RCLWI procedures to perform access network selection and\ntraffic steering decisions between 3GPP access and WLAN or using ANDSF\npolicies defined in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Co-existence between the procedures\ndefined for RCLWI, ANDSF policies and user preference is described in\nTS\u00c2\u00a023.402\u00c2\u00a0[2].\n\n\n"}, {"key": "RAN user plane congestion management function", "numbering": "4.3.24", "title_level": 2, "desc": "4.3.24 RAN user plane congestion management function\n\n\n"}, {"key": "General", "numbering": "4.3.24.1", "title_level": 3, "desc": "4.3.24.1 General\n\nThe user plane congestion management function addresses how the system can\neffectively mitigate RAN user plane congestion in order to reduce the\nnegative impact on the perceived service quality. The congestion mitigation\nmeasures include traffic prioritization, traffic reduction and limitation\nof traffic, and shall be able to manage user plane traffic across a range\nof variables including the user's subscription, the type of application,\nand the type of content. Congestion mitigation can be performed in the RAN\nor in the CN, or in a combined way both in the RAN and in the CN.\n\n\n"}, {"key": "RAN user plane congestion mitigation in the RAN", "numbering": "4.3.24.2", "title_level": 3, "desc": "4.3.24.2 RAN user plane congestion mitigation in the RAN\n\n  Editor's note:  Text to be added depending on the outcome of the UPCON\n         study.\n\n\n"}, {"key": "RAN user plane congestion mitigation in the CN", "numbering": "4.3.24.3", "title_level": 3, "desc": "4.3.24.3 RAN user plane congestion mitigation in the CN\n\nRAN user plane congestion mitigation in the CN uses RAN OAM information,\ncollected by the RAN Congestion Awareness Function (RCAF), to detect\ncongestion. The RAN Congestion Awareness Function is further described in\nclause\u00c2\u00a04.4.12. This functionality is applicable only in case of UTRAN/E-\nUTRAN accesses.\n\n  NOTE\u00c2\u00a01:  The criteria used for detection of RAN user plane congestion\n         (including detection of congestion abatement) are outside the scope\n         of 3GPP specifications.\n\n  NOTE\u00c2\u00a02:  The interface to the RAN's OAM system is not standardized.\n\nThe RCAF can transfer RAN user plane congestion information (RUCI) to the\nPCRF over the Np reference point in order to mitigate the congestion by\nmeasures selected by the PCRF, as specified in TS\u00c2\u00a023.203\u00c2\u00a0[6]. Decisions to\napply congestion mitigation measures may take into account operator\npolicies and subscriber information and all additional available IP-CAN\nsession information.\n\nDifferent mechanisms and mitigation actions applicable as described in\nTS\u00c2\u00a023.203\u00c2\u00a0[6] in order to mitigate RAN User Plane Congestion. Those\nmechanisms include e.g. service/application gating, service/application\nbandwidth limitation, deferring of services.\n\n  NOTE\u00c2\u00a03:  Co-existence between congestion mitigation in RAN and CN can be\n         assured by appropriate network configuration of applicable policies\n         for congestion mitigation, as well as related RAN parameter\n         alignment/tuning, such as tuning of parameters for e.g., load\n         balancing, carrier aggregation, co-ordinated multipoint, dual\n         connectivity. This parameter alignment/tuning is not further\n         specified.\n\n  NOTE\u00c2\u00a04:  A condition leading to interoperability issues which may lead to\n         suboptimal situation is that the time scales for actions of\n         congestion mitigation in RAN and in CN are of comparable duration.\n         Therefore, congestion mitigation in RAN and CN cannot have\n         comparable time scales, otherwise interoperability is affected.\n\n\n"}, {"key": "Dedicated Core Networks (DCNs)", "numbering": "4.3.25", "title_level": 2, "desc": "4.3.25 Dedicated Core Networks (DCNs)\n\n\n"}, {"key": "General", "numbering": "4.3.25.1", "title_level": 3, "desc": "4.3.25.1 General\n\nThis feature enables an operator to deploy multiple DCNs within a PLMN with\neach DCN consisting of one or multiple CN nodes. Each DCN may be dedicated\nto serve specific type(s) of subscriber. This is an optional feature and\nenables DCNs to be deployed for one or multiple RATs (e.g. GERAN, UTRAN, E-\nUTRAN, WB-E-UTRAN and NB-IoT). There can be several motivations for\ndeploying DCNs, e.g. to provide DCNs with specific\ncharacteristics/functions or scaling, to isolate specific UEs or\nsubscribers (e.g. M2M subscribers, subscribers belonging to a specific\nenterprise or separate administrative domain, etc.).\n\nA DCN comprises of one or more MME/SGSN and it may comprise of one or more\nSGW/PDN GW/PCRF. This feature enables subscribers to be allocated to and\nserved by a DCN based on subscription information (\"UE Usage Type\"). The\nfeature in this clause\u00c2\u00a0handles both DCN selections without any specific UE\nfunctionality, i.e. it works also with UEs of earlier releases and UE\nassisted DCN selection.\n\nThe main specific functions are for routing and maintaining UEs in their\nrespective DCN. The following deployment scenarios are supported for DCN:\n\n  -  DCNs may be deployed to support one RAT only, (e.g. only dedicated\n    MMEs are deployed to support E-UTRAN and dedicated SGSNs are not\n    deployed), to support multiple RATs, or to support all RATs.\n\n  -  Networks deploying DCNs may have a default DCN, which is managing UEs\n    for which a DCN is not available or if sufficient information is not\n    available to assign a UE to a DCN. One or multiple DCNs may be deployed\n    together with a default DCN that all share the same RAN.\n\n  -  The architecture supports scenarios where the DCN is only deployed in\n    a part of the PLMN e.g. only for one RAT or only in a part of the PLMN\n    area. Such heterogeneous or partial deployment of DCNs may, depending\n    on operator deployment and configuration, result in service with\n    different characteristics or functionality, depending on whether the UE\n    is inside or outside the service area or RAT that supports the DCN.\n\n  NOTE\u00c2\u00a01:  Heterogeneous or partial deployment of DCNs may result in\n         increased occurrence of UEs first being served by a CN node in the\n         default DCN and then being redirected to a CN node in the DCN that\n         serves the UE when the UE moves from areas outside of DCN coverage\n         to an area of DCN coverage. It may also result in an increased re-\n         attach rate in the network. As this has impacts on the required\n         capacity of the default CN nodes deployed at edge of DCN coverage,\n         it is not recommended to deploy DCNs heterogeneously or partially.\n\n  -  Even if the DCN is not deployed to serve a particular RAT or service\n    area of PLMN, the UE in that RAT or service area may still be served by\n    a PDN GW from the DCN.\n\nHigh level overview for supporting DCNs is provided below. Details are\ncaptured in appropriate clauses of this specification, TS\u00c2\u00a023.060\u00c2\u00a0[7] and\nTS\u00c2\u00a023.236\u00c2\u00a0[30].\n\n  -  An optional subscription information parameter (\"UE Usage Type\") is\n    used in the selection of a DCN. An operator configures which of his\n    DCN(s) serves which UE Usage Type(s). The HSS provides the \"UE Usage\n    Type\" value in the subscription information of the UE to the MME/SGSN.\n    Both standardized and operator specific values for UE Usage Type are\n    possible.\n\n  -  The serving network selects the DCN based on the operator configured\n    (UE Usage Type to DCN) mapping, other locally configured operator's\n    policies and the UE related context information available at the\n    serving network, e.g. information about roaming. UEs with different UE\n    Usage Type values may be served by the same DCN. Moreover, UEs that\n    share the same UE Usage Type value may be served by different DCNs.\n\n  -  If the configuration shows no DCN for the specific \"UE Usage Type\"\n    value in the subscription information, then the serving MME/SGSN serves\n    the UE by the default DCN or selects a DCN using serving operator\n    specific policies.\n\n  -  Some subscribers may be configured without \"UE Usage Type\" value. In\n    this case, the MME/SGSN may select the DCN that serves the UE using\n    locally configured operator's policies and the UE related context\n    information available at the serving network (other than UE provided\n    DCN-ID). The MME/SGSN performs procedures described in clauses 5.19.1\n    and 5.19.2.\n\n  -  The \"UE Usage Type\" is associated with the UE (describing its usage\n    characteristic), i.e. there is only one UE Usage Type\" per UE\n    subscription.\n\n  -  For each DCN, one or more CN nodes may be configured as part of a\n    pool.\n\n  -  For MME, the MMEGI(s) identifies a DCN within the PLMN. For SGSNs, a\n    group identifier(s) identifies a DCN within the PLMN. That is, the\n    group of SGSNs that belong to a DCN within a PLMN. This identifier may\n    have the same format as NRI (e.g. an NRI value that does not identify a\n    specific SGSN node in the serving area) in which case it is called\n    \"Null-NRI\" or it may have a format independent of NRI, in which case it\n    is called \"SGSN Group ID\". The \"Null-NRI\" or \"SGSN Group ID\" is\n    provided by an SGSN to RAN which triggers the NNSF procedure to select\n    an SGSN from the group of SGSNs corresponding to the Null-NRI/SGSN\n    Group ID (see clause\u00c2\u00a05.19.1).\n\n  NOTE\u00c2\u00a02:  SGSN Group IDs enable to handle deployment scenarios where in a\n         service area all NRI values are allocated to SGSNs and hence no NRI\n         value remains that can be used as Null-NRI.\n\n  -  The dedicated MME/SGSN that serves the UE selects a dedicated S-GW and\n    P-GW based on UE Usage Type.\n\n  -  At initial access to the network if sufficient information is not\n    available for RAN to select a specific DCN, the RAN may selects a CN\n    node from the default DCN. A redirection to another DCN may then be\n    required.\n\n  -  To redirect a UE from one DCN to a different DCN, the redirection\n    procedure via RAN, described in clause\u00c2\u00a05.19.1, is used to forward the\n    NAS message of the UE to the target DCN.\n\n  -  All selection functions are aware of DCN(s), including the network\n    node selection function (NNSF) of RAN nodes, for selecting and\n    maintaining the appropriate DCN for the UEs.\n\n\n"}, {"key": "UE assisted Dedicated Core Network selection", "numbering": "4.3.25.1a", "title_level": 3, "desc": "4.3.25.1a   UE assisted Dedicated Core Network selection\n\nThis feature is to reduce the need for DECOR reroute by using an indication\n(DCN-ID) sent from the UE and used by RAN to select the correct DCN. The\nDCN-ID shall be assigned to the UE by the serving PLMN and is stored in the\nUE per PLMN ID. Both standardized and operator specific values for DCN-ID\nare possible. The UE shall use the PLMN specific DCN-ID whenever a PLMN\nspecific DCN-ID is stored for the target PLMN.\n\nThe HPLMN may provision the UE with a single default standardized DCN-ID\nwhich shall be used by the UE only if the UE has no PLMN specific DCN-ID of\nthe target PLMN. When a UE configuration is changed with a new default\nstandardized DCN-ID, the UE shall delete all stored PLMN specific DCN-IDs.\n\nThe UE provides the DCN-ID to RAN at registration to a new location in the\nnetwork, i.e. in Attach, TAU and RAU. RAN selects serving node (MME or\nSGSN) based on the DCN-ID provided by the UE and configuration in RAN. For\nE-UTRAN the eNB is configured with DCNs supported by the connected MMEs at\nthe setup of the S1 connection. For UTRAN and GERAN the BSS/RNC is\nconfigured with the DCNs supported in the connected SGSN via O&M. Both\nstandardized DCN-IDs and PLMN specific DCN-IDs can in the RAN configuration\nbe assigned to the same network. If information provided by the UE (e.g.\nGUTI, NRI, etc.) indicates a node (MME or SGSN) for attach/TAU/RAU and a\nserving node (MME or SGSN) corresponding to the UE information can be found\nby the RAN node, the normal node selection shall take precedence over the\nselection based on DCN-ID. At registration the MME/SGSN may check if the\ncorrect DCN is selected. The check is performed as specified in\nclause\u00c2\u00a04.3.25.1. If the MME/SGSN concludes that the selected DCN is not the\ncorrect DCN, a DECOR reroute is performed and the SGSN/MME in the new DCN\nassigns a new DCN-ID to the UE. The serving MME/SGSN can also assign a new\nDCN-ID to the UE if e.g. the DCN-ID in the UE has become obsolete or when\nthe UE Usage Type has been updated in the subscription information leading\nto a change of DCN. This is performed as part of the GUTI Reallocation\nprocedure.\n\n\n"}, {"key": "Considerations for Roaming", "numbering": "4.3.25.2", "title_level": 3, "desc": "4.3.25.2 Considerations for Roaming\n\nIn the case of roaming, if the HPLMN of the visiting UE does not support\nDCNs, i.e. doesn't provide the UE Usage Type, the serving MME/SGSN may\nselect the DCN that serves the UE using operator specific policies based on\nother subscription or UE provided information.\n\nIn the case of roaming, if the HPLMN provides the UE Usage Type parameter\nto the VPLMN, this parameter is provided irrespective of its value\n(standardized or operator specific). The handling of the UE Usage Type\nparameter in the VPLMN is based on operator policies, e.g. roaming\nagreements.\n\nIf the UE assisted DCN selection feature is supported:\n\n  -  If the UE has a DCN-ID for the VPLMN the UE shall send that PLMN\n    specific DCN-ID to the RAN, and\n\n  -  If the UE has no PLMN specific DCN-ID for this VPLMN and if the UE has\n    a pre-provisioned default standardized DCN-ID it shall send the pre-\n    provisioned default standardized DCN-ID to the RAN.\n\n\n"}, {"key": "Considerations for Network Sharing", "numbering": "4.3.25.3", "title_level": 3, "desc": "4.3.25.3 Considerations for Network Sharing\n\nIf the network supports the MOCN configuration for network sharing (see\nTS\u00c2\u00a023.251\u00c2\u00a0[24]), each network sharing operator has separate CN(s).\nMechanisms for selection of serving operator for supporting and non-\nsupporting UEs are defined in TS\u00c2\u00a023.251\u00c2\u00a0[24]. Each of the sharing operators\nmay deploy one or more DCNs.\n\nIf Selected PLMN information is provided by the UE, the RAN selects the CN\noperator based on this provided information and then DECOR rerouting may,\nif needed, be initiated within the CN of the selected operator. If the UE\nassisted DCN selection feature is supported and both the Selected PLMN\ninformation and DCN-ID is provided by the UE, the RAN first selects the CN\noperator followed by selection of a DCN supported by the selected CN\noperator.\n\nIf Selected PLMN information is not provided by the UE (may only happen in\nGERAN and UTRAN), the network initiates MOCN redirection, including CS/PS\ncoordination, to select a CN operator that can serve the UE. After this,\nDECOR rerouting is initiated if needed. The serving node in the selected\nDCN ends the MOCN redirection. If the UE assisted DCN selection feature is\nsupported and Selected PLMN information is not provided by the UE, the\nnetwork initiates CN operator selection and after the CN operator selection\nis concluded the DCN is selected based on the UE provided DCN-ID. As the\nPLMN information included in the RAI is the Common PLMN (refer to\nTS\u00c2\u00a023.251\u00c2\u00a0[24]), which does not reflect the selected CN operator, the\nnetwork may also return the PLMN ID of the selected CN operator. When the\nUE receives the NAS Accept message, the UE associates the DCN-ID with both\nthe PLMN ID of the selected CN operator and the Common PLMN IDs.\n\nThe functions for redirecting or maintaining UEs in specific DCNs are\nconfigured to work within the CNs of the same operator.\n\n\n"}, {"key": "Support for Monitoring Events", "numbering": "4.3.26", "title_level": 2, "desc": "4.3.26 Support for Monitoring Events\n\nThe Monitoring Events feature is intended for monitoring of specific events\nin 3GPP system and making such monitoring event information available via\nthe Service Capability Exposure Function (SCEF). The architecture and\nrelated functions to support Monitoring Events are defined in\nTS\u00c2\u00a023.682\u00c2\u00a0[74].\n\n\n"}, {"key": "Paging Enhancements", "numbering": "4.3.27", "title_level": 2, "desc": "4.3.27 Paging Enhancements\n\n\n"}, {"key": "Paging for Enhanced Coverage", "numbering": "4.3.27.1", "title_level": 3, "desc": "4.3.27.1 Paging for Enhanced Coverage\n\nSupport of UEs in Enhanced Coverage is specified in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\nWhenever S1 is released and Information for Enhanced Coverage is available\nfor the UE, the eNB sends it to the MME as described in clause\u00c2\u00a05.3.5.\n\nThe MME stores the received Information for Enhanced Coverage and, if\nEnhanced Coverage Restricted parameter is not set then MME, includes it in\nevery subsequent Paging message for all eNBs selected by the MME for\npaging.\n\n\n"}, {"key": "Restriction of use of Enhanced Coverage for voice centric UE", "numbering": "4.3.27a", "title_level": 2, "desc": "4.3.27a  Restriction of use of Enhanced Coverage for voice centric UE\n\nSupport of UEs in Enhanced Coverage is specified in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\nIf the UE's usage setting is \"voice centric\" as defined in TS\u00c2\u00a023.221\u00c2\u00a0[27],\nit shall not operate in CE mode B.\n\nIf the UE supports CE mode B and UE's usage setting is set to \"voice\ncentric\" in the Attach or TAU request message then the MME shall indicate\nto eNB that CE mode B is restricted. If the UE supports CE mode B and UE's\nusage setting is set to \"data centric\" in the Attach or TAU request message\nthen, based on operator's policy and the Enhanced Coverage Restricted\nparameter (see clause\u00c2\u00a04.3.28), the MME shall indicate to eNB that CE mode B\nis not restricted.\n\nThe MME keeps the CE mode B Restricted parameter in the MM Context. The MME\nshall send the CE mode B Restricted parameter to the eNB via S1 signalling\nindicating whether the UE is \"restricted\" or \"not restricted\" for the use\nof CE mode B, e.g. in PAGING, INITIAL CONTEXT SETUP REQUEST, HANDOVER\nREQUEST, PATH SWITCH REQUEST ACKNOWLEDGE, CONNECTION ESTABLISHMENT\nINDICATION, and DOWNLINK NAS TRANSPORT message carrying the TAU ACCEPT\nmessage.\n\nIf the UE supports CE mode B and the CE mode B Restricted parameter stored\nin the MME's MM context is set to \"not restricted\", the MME shall use the\nextended NAS timer settings for the UE as specified in TS\u00c2\u00a024.301\u00c2\u00a0[46].\n\n\n"}, {"key": "Enhanced Coverage for data centric UEs", "numbering": "4.3.27b", "title_level": 2, "desc": "4.3.27b  Enhanced Coverage for data centric UEs\n\nThe support for UEs in Enhanced Coverage is specified in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\nThe IMS impacts for data centric UEs in Enhanced Coverage is specified in\nAnnex E of TS\u00c2\u00a023.228\u00c2\u00a0[52].\n\n\n"}, {"key": "Restriction of use of Enhanced Coverage", "numbering": "4.3.28", "title_level": 2, "desc": ""}, {"key": "GPP PS Data Off", "numbering": "4.3.29", "title_level": 2, "desc": "4.3.28 Restriction of use of Enhanced Coverage\n\nSupport of UEs in Enhanced Coverage is specified in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\nThe usage of Enhanced Coverage may require use of extensive resources (e.g.\nradio and signalling resources) from the network. This feature enables the\noperator to prevent specific subscribers from using Enhanced Coverage.\n\nThe UE indicates its capability of support for restriction of use of\nEnhanced Coverage in Attach and TAU procedure for the RAT it is camping on\nto the MME. MME receives Enhanced Coverage Restricted parameter from the\nHSS. This parameter is kept as part of subscription data in the HSS and\nspecifies per PLMN whether the enhanced coverage functionality is\nrestricted or not for the UE. For roaming UEs, if HSS doesn't provide any\nEnhanced Coverage Restricted parameter or the provided Enhanced Coverage\nRestricted parameter is in conflict with the roaming agreement, the MME\nuses default Enhanced Coverage Restricted parameter locally configured in\nthe VPLMN based on the roaming agreement with the subscriber's HPLMN. The\nUE shall assume that restriction for use of Enhanced Coverage is same in\nthe equivalent PLMNs. If the UE includes the support for restriction of use\nof Enhanced Coverage, MME sends Enhanced Coverage Restricted parameter to\nthe UE in the Attach/TAU Accept message. The UE shall use the value of\nEnhanced Coverage Restricted parameter to determine if enhanced coverage\nfeature is restricted or not.\n\n  NOTE:  How this parameter is used by UE at AS layer is defined in the RAN\n         specification.\n\nThe UE assumes Enhanced Coverage is allowed unless explicitly restricted by\nthe network for a PLMN.\n\nIf the MME has sent the Enhanced Coverage Restricted parameter to the UE,\nthe MME provides an Enhanced Coverage Restricted parameter to the eNB via\nS1 signalling during paging, and whenever the UE context is established in\nRAN, e.g. during service request procedure, attach procedure, and TAU\nprocedure.\n\n\n4.3.29 3GPP PS Data Off\n\n\n"}, {"key": "General", "numbering": "4.3.29.1", "title_level": 3, "desc": "4.3.29.1 General\n\nThis feature, when activated by the user, prevents transport via 3GPP\naccess of all IP packets, Ethernet data and non-IP data except for those\nrelated to 3GPP PS Data Off Exempt Services. The 3GPP PS Data Off Exempt\nServices are a set of operator services, defined in TS\u00c2\u00a023.221\u00c2\u00a0[27], that\nare the only allowed services when the 3GPP PS Data Off feature has been\nactivated by the user.\n\nUEs may be configured with up to two lists of 3GPP PS Data Off Exempt\nServices and the list(s) are provided to the UEs by HPLMN via Device\nManagement or UICC provisioning. When the UE is configured with two lists,\none list is valid for the UEs camping in the home PLMN and the other list\nis valid for any VPLMN the UE is roaming in. When the UE is configured with\na single list, without an indication to which PLMNs the list is applicable,\nthen this list is valid for the home PLMN and any PLMN the UE is roaming\nin.\n\n  NOTE\u00c2\u00a01:  The operator needs to ensure coordinated lists of 3GPP Data Off\n         Exempt Services provisioned in the UE and configured in the\n         network.\n\nThe UE discovers whether a PDN GW supports 3GPP PS Data Off feature at\ninitial attach and during the establishment of a PDN connection via the\npresence of the 3GPP PS Data Off Support Indication in the Create Session\nresponse message.\n\n  NOTE\u00c2\u00a02:  When the UE detects that the PDN GW does not support 3GPP PS\n         Data Off feature, how the UE reacts to non exempt services MT\n         requests from the network is implementation dependent.\n\nThe UE shall report its 3GPP PS Data Off status in PCO (Protocol\nConfiguration Option) to PDN GW during Initial Attach procedure as\ndescribed in clause\u00c2\u00a05.3.2.1 and UE requested PDN connectivity procedure as\ndescribed in clause\u00c2\u00a05.10.2.\n\n  NOTE\u00c2\u00a03:  This also covers scenarios when the user activates/deactivates\n         3GPP PS Data Off while connected via WLAN access only, and then a\n         handover to 3GPP access occurs.\n\nIf 3GPP PS Data Off is activated, the UE prevents the sending of uplink IP\npackets, Ethernet data and non-IP data except for those related to 3GPP PS\nData Off Exempt Services, based on the pre-configured list of Data Off\nExempt Services.\n\nFor those PDN GWs that indicated support for the 3GPP PS Data Off feature\nduring PDN connection setup and at Initial Attach, the UE shall report\nimmediately a change of its 3GPP PS Data Off status in PCO by using Bearer\nResource Modification procedure as described in clause\u00c2\u00a05.4.5, this also\napplies to the scenario of inter-RAT mobility procedure to E-UTRAN and also\nto scenarios where the 3GPP PS Data Off status is changed when the session\nmanagement back-off timer is running as specified in clause\u00c2\u00a04.3.7.4.2. If\nthe UE has not received any 3GPP PS Data Off Support Indication during the\nestablishment of the PDN connection, it shall not report any change of its\n3GPP PS Data Off Status for this PDN connection.\n\nThe additional behaviour of the PDN GW for 3GPP PS Data Off is controlled\nby local configuration or policy from the PCRF as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  NOTE\u00c2\u00a04:  For the PDN connection used for IMS services, the 3GPP Data Off\n         Exempt Services are enforced in the IMS domain as specified\n         TS\u00c2\u00a023.228\u00c2\u00a0[52]. Policies configured in the PDN GW/PCRF need to\n         ensure those services are always allowed when the 3GPP Data Off\n         status of the UE is set to \"activated\".\n\n\n"}, {"key": "Unlicensed spectrum aggregation (LAA/LWA/LWIP)", "numbering": "4.3.30", "title_level": 2, "desc": "4.3.30 Unlicensed spectrum aggregation (LAA/LWA/LWIP)\n\nUnlicensed spectrum aggregation in EPS can either use LTE-Assisted Access\n(LAA) that is using the Carrier Aggregation (CA) RAN configuration defined\nin TS\u00c2\u00a036.300\u00c2\u00a0[5] or LWA/LWIP aggregation using WLAN as secondary RAT that\nis using the Dual Connectivity architecture defined in clause\u00c2\u00a04.3.2a and\nTS\u00c2\u00a036.300\u00c2\u00a0[5].\n\nFor either case if the UE has Access Restriction for Unlicensed Spectrum in\nthe form of LAA, or LWA/LWIP (either signalled from the HSS, or, locally\ngenerated by VPLMN policy in the MME) the MME signals this to the E-UTRAN\nas part of Handover Restriction List.\n\nAn eNB supporting aggregation with unlicensed spectrum in the form of LAA,\nLWA/LWIP checks whether the UE is allowed to use unlicensed spectrum. If\nthe UE is not allowed to use Unlicensed Spectrum, the eNB shall not\nestablish dual connectivity or carrier aggregation (CA) with LTE in\nunlicensed spectrum in the form of LAA or WLAN as a secondary RAT in the\nform of LWA/LWIP.\n\nAt inter-RAT handover from GERAN/UTRAN, the Access Restriction for\nUnlicensed Spectrum is either already in the MME's UE context, or is\nobtained from the HSS during the subsequent Tracking Area Update procedure\n(i.e. not from the source SGSN or source RAN). In both inter-RAT handover\ncases, any Access Restriction for use of Unlicensed Spectrum is then\nsignalled to the E-UTRAN.\n\n  NOTE:  This signalling of the Access Restriction during the TAU after the\n         inter-RAT handover procedure means that there is a small risk that\n         unlicensed spectrum resources are transiently allocated.\n\n\n"}, {"key": "Subscription handling for Aerial UEs", "numbering": "4.3.31", "title_level": 2, "desc": "4.3.31 Subscription handling for Aerial UEs\n\nThis clause\u00c2\u00a0describes subscription information handling in order to support\noperating Aerial UE function over E-UTRAN as defined in TS\u00c2\u00a036.300\u00c2\u00a0[5] and\nTS\u00c2\u00a036.331\u00c2\u00a0[37].\n\nThe eNB supporting Aerial UE function handling uses the per user\ninformation supplied by the MME to determine whether or not to allow the UE\nto use Aerial UE function.\n\nSupport of Aerial UE function is stored in the user's subscription\ninformation in HSS. HSS transfers this information to the MME via Update\nLocation message during Attach and Tracking Area Update procedures. Home\nOperator may revoke user's subscription authorisation for operating Aerial\nUEs at any time.\n\nMME that supports Aerial UE function provides the user's subscription\ninformation on Aerial UE authorisation to the eNB via the S1 AP Initial\nContext Setup Request during Attach, Tracking Area Update and Service\nRequest procedures.\n\nFor the intra and inter MME S1 based handover (intra RAT) or Inter-RAT\nhandover to E-UTRAN, the Aerial UE subscription information for the user is\nincluded in the S1-AP UE Context Modification Request message sent to the\ntarget eNodeB after the handover procedure.\n\nFor X2-based handover, the Aerial UE subscription information for the user\nis sent to target eNodeB as follows:\n\n  -  If the source eNodeB supports Aerial UE function and the user's Aerial\n    UE subscription information is included in the UE context, the source\n    eNodeB shall include the information in the X2-AP Handover Request\n    message to the target eNodeB.\n\n  -  The MME shall send the Aerial UE subscription information to the\n    target eNodeB in the Path Switch Request Acknowledge message.\n\nIf the Aerial UE subscription information has changed, the updated Aerial\nUE subscription information is included in the S1-AP UE Context\nModification Request message sent to the eNodeB.\n\n\n\n\n"}, {"key": "Network elements", "numbering": "4.4", "title_level": 1, "desc": "4.4  Network elements\n\n\n"}, {"key": "E-UTRAN", "numbering": "4.4.1", "title_level": 2, "desc": "4.4.1  E-UTRAN\n\nE-UTRAN is described in more detail in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\nIn addition to the E-UTRAN functions described in TS\u00c2\u00a036.300\u00c2\u00a0[5], E-UTRAN\nfunctions include:\n\n  -  Header compression and user plane ciphering (for user plane data sent\n    across S1-U);\n\n  -  MME selection when no routing to an MME can be determined from the\n    information provided by the UE;\n\n  -  UL bearer level rate enforcement based on UE-AMBR and MBR via means of\n    uplink scheduling\n    (e.g. by limiting the amount of UL resources granted per UE over time);\n\n  -  DL bearer level rate enforcement based on UE-AMBR;\n\n  -  UL and DL bearer level admission control;\n\n  -  Transport level packet marking in the uplink, e.g. setting the\n    DiffServ Code Point, based on the QCI, and optionally the ARP priority\n    level, of the associated EPS bearer;\n\n  -  ECN-based congestion control.\n\n\n"}, {"key": "MME", "numbering": "4.4.2", "title_level": 2, "desc": "4.4.2  MME\n\nMME functions include:\n\n  -  NAS signalling;\n\n  -  NAS signalling security;\n\n  -  Inter CN node signalling for mobility between 3GPP access networks\n    (terminating S3);\n\n  -  UE Reachability in ECM-IDLE state (including control, execution of\n    paging retransmission and optionally Paging Policy Differentiation);\n\n  -  Tracking Area list management;\n\n  -  Mapping from UE location (e.g. TAI) to time zone, and signalling a UE\n    time zone change associated with mobility,\n\n  -  PDN GW and Serving GW selection;\n\n  -  MME selection for handovers with MME change;\n\n  -  SGSN selection for handovers to 2G or 3G 3GPP access networks;\n\n  -  Roaming (S6a towards home HSS);\n\n  -  Authentication;\n\n  -  Authorization;\n\n  -  Bearer management functions including dedicated bearer establishment;\n\n  -  Lawful Interception of signalling traffic;\n\n  -  Warning message transfer function (including selection of appropriate\n    eNodeB);\n\n  -  UE Reachability procedures;\n\n  -  Support Relaying function (RN Attach/Detach);\n\n  -  Change of UE presence in Presence Reporting Area reporting upon PCC\n    request,\n\n    -  in the case of Change of UE presence in Presence Reporting Area\n       reporting, management of Core Network pre-configured Presence\n       Reporting Areas.\n\n  -  For the Control Plane CIoT EPS Optimisation:\n\n    a) transport of user data (IP, Non-IP and Ethernet));\n\n    b) local Mobility Anchor point;\n\n    c) header compression (for IP user data);\n\n    d) ciphering and integrity protection of user data;\n\n    e) Lawful Interception of user traffic not transported via the Serving\n       GW (e.g. traffic using T6a).\n\n  NOTE:  The Serving GW and the MME may be implemented in one physical node\n         or separated physical nodes. For CIoT EPS Optimisation, the Serving\n         GW and the MME can be implemented in one physical node (e.g. C-SGN)\n         or separated physical nodes. The C-SGN can also encompass the PDN\n         GW function.\n\nThe MME shall signal a change in UE Time Zone only in case of mobility and\nin case of UE triggered Service Request, PDN Disconnection and UE Detach.\nIf the MME cannot determine whether the UE Time Zone has changed (e.g. the\nUE Time Zone is not sent by the old MME during MME relocation), the MME\nshould not signal a change in UE Time Zone. A change in UE Time Zone caused\nby a regulatory mandated time change (e.g. daylight saving time or summer\ntime change) shall not trigger the MME to initiate signalling procedures\ndue to the actual change. Instead the MME shall wait for the UE's next\nmobility event or Service Request procedure and then use these procedures\nto update the UE Time Zone information in the PDN GW.\n\n\n"}, {"key": "Gateway", "numbering": "4.4.3", "title_level": 2, "desc": "4.4.3  Gateway\n\n\n"}, {"key": "General", "numbering": "4.4.3.1", "title_level": 3, "desc": "4.4.3.1  General\n\nTwo logical Gateways exist:\n\n  -  Serving GW (S-GW);\n\n  -  PDN GW (P-GW).\n\n  NOTE:  The PDN GW and the Serving GW may be implemented in one physical\n         node or separated physical nodes.\n\n\n"}, {"key": "Serving GW", "numbering": "4.4.3.2", "title_level": 3, "desc": "4.4.3.2  Serving GW\n\nThe Serving GW is the gateway which terminates the user plane interface\ntowards E-UTRAN (except when user data is transported using the Control\nPlane CIoT EPS Optimisation).\n\nFor each UE associated with the EPS, at a given point of time, there is a\nsingle Serving GW.\n\nThe functions of the Serving GW, for both the GTP-based and the PMIP-based\nS5/S8, include:\n\n  -  the local Mobility Anchor point for inter-eNodeB handover (except when\n    user data is transported using the Control Plane CIoT EPS\n    Optimisation);\n\n  -  sending of one or more \"end marker\" to the source eNodeB, source SGSN\n    or source RNC immediately after the Serving GW switches the path during\n    inter-eNodeB and inter-RAT handover, especially to assist the\n    reordering function in eNodeB.\n\n  -  Mobility anchoring for inter-3GPP mobility (terminating S4 and\n    relaying the traffic between 2G/3G system and PDN GW);\n\n  -  ECM-IDLE mode downlink packet buffering and initiation of network\n    triggered service request procedure and optionally Paging Policy\n    Differentiation;\n\n  -  Lawful Interception;\n\n  -  Packet routing and forwarding;\n\n  -  Transport level packet marking in the uplink and the downlink, e.g.\n    setting the DiffServ Code Point, based on the QCI, and optionally the\n    ARP priority level, of the associated EPS bearer;\n\n  -  Accounting for inter-operator charging. For GTP-based S5/S8, the\n    Serving GW generates accounting data per UE and bearer;\n\n  -  Interfacing OFCS according to charging principles and through\n    reference points specified in TS\u00c2\u00a032.240\u00c2\u00a0[51];\n\n  -  Forwarding of \"end marker\" to the source eNodeB, source SGSN or source\n    RNC when the \"end marker\" is received from PDN GW and the Serving GW\n    has downlink user plane established. Upon reception of \"end marker\",\n    the Serving GW shall not send Downlink Data Notification.\n\nAdditional Serving GW functions for the PMIP-based S5/S8 are captured in\nTS\u00c2\u00a023.402\u00c2\u00a0[2].\n\nConnectivity to a GGSN is not supported.\n\n\n"}, {"key": "PDN GW", "numbering": "4.4.3.3", "title_level": 3, "desc": "4.4.3.3  PDN GW\n\nThe PDN GW is the gateway which terminates the SGi interface towards the\nPDN.\n\nIf a UE is accessing multiple PDNs, there may be more than one PDN GW for\nthat UE, however a mix of S5/S8 connectivity and Gn/Gp connectivity is not\nsupported for that UE simultaneously.\n\nPDN GW functions include for both the GTP-based and the PMIP-based S5/S8:\n\n  -  Per-user based packet filtering (by e.g. deep packet inspection);\n\n  -  Lawful Interception;\n\n  -  UE IP address allocation;\n\n  -  Transport level packet marking in the uplink and downlink, e.g.\n    setting the DiffServ Code Point, based on the QCI, and optionally the\n    ARP priority level, of the associated EPS bearer;\n\n  -  Accounting for inter-operator charging: for home routed roaming, the P-\n    GW shall collect and report the uplink and downlink data volume (per\n    EPS bearer) as received from and sent to the serving node;\n\n  -  UL and DL service level charging as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6]\n    (e.g. based on SDFs defined by the PCRF, or based on deep packet\n    inspection defined by local policy);\n\n  -  Interfacing OFCS through according to charging principles and through\n    reference points specified in TS\u00c2\u00a032.240\u00c2\u00a0[51].\n\n  -  UL and DL service level gating control as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6];\n\n  -  UL and DL service level rate enforcement as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6]\n    (e.g. by rate policing/shaping per SDF);\n\n  -  UL and DL rate enforcement based on APN-AMBR\n    (e.g. by rate policing/shaping per aggregate of traffic of all SDFs of\n    the same APN that are associated with Non-GBR QCIs);\n\n  -  DL rate enforcement based on the accumulated MBRs of the aggregate of\n    SDFs with the same GBR QCI\n    (e.g. by rate policing/shaping);\n\n  -  DHCPv4 (server and client) and DHCPv6 (client and server) functions;\n\n  -  The network does not support PPP bearer type in this version of the\n    specification. Pre-Release 8 PPP functionality of a GGSN may be\n    implemented in the PDN GW;\n\n  -  The PDN GW may support Non-IP data transfer (e.g. with CIoT EPS\n    Optimisations);\n\n  -  The PDN GW (when acting as a combined PDN GW+SMF as specified in\n    TS\u00c2\u00a023.501\u00c2\u00a0[83]) may support Ethernet data transfer;\n\n  -  packet screening;\n\n  -  sending of one or more \"end marker\" to the source SGW immediately\n    after switching the path during SGW change;\n\n  -  PCC related features (e.g. involving PCRF and OCS) as described in\n    TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\nAdditionally the PDN GW includes the following functions for the GTP-based\nS5/S8:\n\n  -  UL and DL bearer binding as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6];\n\n  -  UL bearer binding verification as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6];\n\n  -  Functionality as defined in RFC\u00c2\u00a04861\u00c2\u00a0[32];\n\n  -  Accounting per UE and bearer.\n\nThe P-GW provides PDN connectivity to both GERAN/UTRAN only UEs and E-UTRAN\ncapable UEs using any of E-UTRAN, GERAN or UTRAN. The P-GW provides PDN\nconnectivity to E-UTRAN capable UEs using E-UTRAN only over the S5/S8\ninterface.\n\n\n"}, {"key": "SGSN", "numbering": "4.4.4", "title_level": 2, "desc": "4.4.4  SGSN\n\nIn addition to the functions described in TS\u00c2\u00a023.060\u00c2\u00a0[7], SGSN functions\ninclude:\n\n  -  Inter EPC node signalling for mobility between 2G/3G and E-UTRAN 3GPP\n    access networks;\n\n  -  PDN and Serving GW selection: the selection of S-GW/P-GW by the SGSN\n    is as specified for the MME;\n\n  -  Handling UE Time Zone as specified for the MME;\n\n  -  MME selection for handovers to E-UTRAN 3GPP access network.\n\n\n"}, {"key": "GERAN", "numbering": "4.4.5", "title_level": 2, "desc": "4.4.5  GERAN\n\nGERAN is described in more detail in TS\u00c2\u00a043.051\u00c2\u00a0[15].\n\n\n"}, {"key": "UTRAN", "numbering": "4.4.6", "title_level": 2, "desc": "4.4.6  UTRAN\n\nUTRAN is described in more detail in TS\u00c2\u00a025.401\u00c2\u00a0[16].\n\n\n"}, {"key": "PCRF", "numbering": "4.4.7", "title_level": 2, "desc": "4.4.7  PCRF\n\n\n"}, {"key": "General", "numbering": "4.4.7.1", "title_level": 3, "desc": "4.4.7.1  General\n\nPCRF is the policy and charging control element. PCRF functions are\ndescribed in more detail in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\nIn non-roaming scenario, there is only a single PCRF in the HPLMN\nassociated with one UE's IP-CAN session. The PCRF terminates the Rx\ninterface and the Gx interface.\n\nIn a roaming scenario with local breakout of traffic there may be two PCRFs\nassociated with one UE's IP-CAN session:\n\n  -  H-PCRF that resides within the H-PLMN;\n\n  -  V-PCRF that resides within the V-PLMN.\n\n\n"}, {"key": "Home PCRF (H-PCRF)", "numbering": "4.4.7.2", "title_level": 3, "desc": "4.4.7.2  Home PCRF (H-PCRF)\n\nThe functions of the H-PCRF include:\n\n  -  terminates the Rx reference point for home network services;\n\n  -  terminates the S9 reference point for roaming with local breakout;\n\n  -  associates the sessions established over the multiple reference points\n    (S9, Rx), for the same UE's IP-CAN session (PCC session binding).\n\nThe functionality of H-PCRF is described in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n\n"}, {"key": "Visited PCRF (V-PCRF)", "numbering": "4.4.7.3", "title_level": 3, "desc": "4.4.7.3  Visited PCRF (V-PCRF)\n\nThe functions of the V-PCRF include:\n\n  -  terminates the Gx and S9 reference points for roaming with local\n    breakout;\n\n  -  terminates Rx for roaming with local breakout and visited operator's\n    Application Function.\n\nThe functionality of V-PCRF is described in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n\n"}, {"key": "PDN GW's associated AAA Server", "numbering": "4.4.8", "title_level": 2, "desc": "4.4.8  PDN GW's associated AAA Server\n\nThe PDN Gateway may interact with a AAA server over the SGi interface. This\nAAA Server may maintain information associated with UE access to the EPC\nand provide authorization and other network services. This AAA Server could\nbe a RADIUS or Diameter Server in an external PDN network, as defined in\nTS\u00c2\u00a029.061\u00c2\u00a0[38]. This AAA Server is logically separate from the HSS and the\n3GPP AAA Server.\n\n\n"}, {"key": "HeNB subsystem", "numbering": "4.4.9", "title_level": 2, "desc": "4.4.9  HeNB subsystem\n\nA HeNB subsystem consists of a HeNB, optionally a HeNB GW and optionally a\nLocal GW.\n\nThe Local IP Access and SIPTO at the Local Network with L-GW function\ncollocated with the HeNB functions are achieved using a Local GW (L-GW)\ncolocated with the HeNB.\n\nFigure 4.4.9-1 illustrates the architecture for LIPA and/or SIPTO at the\nLocal Network with L-GW function collocated with the HeNB.\n\n                                    [pic]\n\n Figure 4.4.9-1: Architecture for LIPA or SIPTO at the Local Network with L-\n                         GW collocated with the HeNB\n\n  NOTE\u00c2\u00a01:  The optional HeNB GW is not shown in the figure for simplicity.\n\nThe HeNB subsystem is connected by means of the standard S1 interface to\nthe EPC (Evolved Packet Core), more specifically to the MME (Mobility\nManagement Entity) by means of the S1-MME interface and to the Serving\nGateway (S-GW) by means of the S1-U interface. When LIPA or SIPTO at the\nLocal Network with L-GW function collocated with the HeNB is activated, the\nL-GW has a S5 interface with the S-GW.\n\n  NOTE\u00c2\u00a02:  In this specification and for simplification the term eNodeB\n         refers to the HeNB subsystem if the UE accesses the network via a\n         HeNB unless stated otherwise.\n\n  NOTE\u00c2\u00a03:  Detailed functions of HeNB and HeNB GW are described in\n         TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n  NOTE\u00c2\u00a04:  An L-GWcollocated with a HeNB may support LIPA, or SIPTO@LN, or\n         both.\n\nThe Local GW is the gateway towards the IP networks (e.g.\nresidential/enterprise networks, Internet) associated with the HeNB. The\nLocal GW has the following PDN GW functions:\n\n  -  UE IP address allocation;\n\n  -  DHCPv4 (server and client) and DHCPv6 (client and server) functions;\n\n  -  Packet screening;\n\n  -  Functionality as defined in RFC 4861\u00c2\u00a0[32].\n\nAdditionally, the Local GW has the following functions:\n\n  -  ECM-IDLE mode downlink packet buffering;\n\n  -  ECM-CONNECTED mode direct tunnelling towards the HeNB.\n\n  NOTE\u00c2\u00a05:  The architecture for SIPTO at the Local Network with L-GW\n         function collocated with a HeNB depicted in Figure 4.4.9-1 also\n         applies to SIPTO at the Local Network with L-GW function collocated\n         with an eNB.\n\n\n"}, {"key": "DeNB", "numbering": "4.4.10", "title_level": 2, "desc": "4.4.10 DeNB\n\nDeNB function is described in more detail in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\nDeNB provides the necessary S/P-GW functions for the operation of RNs\nconnected to the DeNB.\n\nIn order to provide the Relay Function the DeNB shall support  the\nfollowing P-GW functions:\n\n  -  IP address allocation for the UE functionality of the RN;\n\n  -  Downlink transport level packet mapping between the DSCP value used\n    over S1-U of the UE (which is the SGi interface of the PDN GW function\n    in the DeNB) and the EPS bearers with an appropriate QCI value and\n    optionally ARP priority level value, established between the PDN GW\n    function in the DeNB and the UE function of the RN;\n\n  -  Uplink transport level packet mapping between QCI value and optionally\n    ARP priority level value, of the EPS bearers (established between the\n    PDN GW function in the DeNB and the UE function of the RN) and the DSCP\n    value used over S1-U of the UE (which is the SGi interface of the PDN\n    GW function in the DeNB).\n\nIn order to provide the Relay Function  the DeNB shall support  the\nfollowing S-GW functions:\n\n  -  Termination the S11 session of the MME(RN).\n\nS-GW functions related to ECM-IDLE are not required.\n\nS-GW functions related to mobility management are not supported.\n\n\n"}, {"key": "CSG Subscriber Server", "numbering": "4.4.11", "title_level": 2, "desc": "4.4.11 CSG Subscriber Server\n\nCSG Subscriber Server (CSS) is an optional element that stores CSG\nsubscription data for roaming subscribers. The CSS stores and provides\nVPLMN specific CSG subscription information to the MME. The CSS is\naccessible from the MME via the S7a interface. The CSS is always in the\nsame PLMN as the current MME.\n\nIf the same CSG ID exists in both CSS subscription data and HSS\nsubscription data, the CSG subscription data from the HSS shall take\nprecedence over the data from CSS.\n\nFigure 4.4.11-1 illustrates CSS connected to MME.\n\n                                    [pic]\n\n                    Figure 4.4.11-1: CSS connected to MME\n\n\n"}, {"key": "RAN Congestion Awareness Function", "numbering": "4.4.12", "title_level": 2, "desc": "4.4.12 RAN Congestion Awareness Function\n\nThe RAN Congestion Awareness Function (RCAF) is an element that provides\nRAN User Plane Congestion Information (RUCI) to the PCRF to enable the PCRF\nto take the RAN user plane congestion status into account for policy\ndecisions.\n\nThe RCAF collects information related to user plane congestion from the\nRAN's OAM system based on which the RCAF determines the congestion level\n(and the identifier) of an eNB or E-UTRAN cell.\n\nVia the Nq interface the RCAF determines the UEs served by a congested eNB\nor congested E-UTRAN cell and retrieves the APNs of the active PDN\nconnections of those UEs. The decision whether the RCAF operates on eNB or\nE-UTRAN cell level is up to operator configuration.\n\nVia the Np reference point, the RCAF sends the RUCI to the PCRFs serving\nthe UEs' PDN connections.\n\n  NOTE\u00c2\u00a01:  The details of congestion reporting to the PCRF and the Np\n         reference point are specified in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  NOTE\u00c2\u00a02:  In the case of roaming or RAN sharing as specified in\n         TS\u00c2\u00a023.251\u00c2\u00a0[24], Np is an inter-operator reference point. Whether Np\n         applies in case of roaming and RAN sharing is subject to inter-\n         operator agreements.\n\nFigure 4.4.12-1 illustrates the RCAF connected to the MME. The RCAF is\nlocated in the same PLMN as the serving MME except in network sharing\nscenarios where the RCAF belongs to the RAN operator.\n\n                                    [pic]\n\n                   Figure 4.4.12-1: RCAF connected to MME\n\n\n"}, {"key": "UCMF", "numbering": "4.4.13", "title_level": 2, "desc": "4.4.13 UCMF\n\n4.4.13 UCMF\n\nThe UCMF is used for storage of dictionary entries corresponding to either\nPLMN-assigned or Manufacturer-assigned UE Radio Capability IDs.\n\nProvisioning of Manufacturer-assigned UE Radio Capability ID entries in the\nUCMF is performed from an AS that interacts with the UCMF either directly\nor via the SCEF (or via Network Management) (see TS\u00c2\u00a023.682\u00c2\u00a0[74] for further\ninformation).\n\nFor PLMN-assigned UE Radio Capability ID the UCMF also is the entity that\nassigns the UE Radio Capability ID values to the UE.\n\n                                    [pic]\n\n                   Figure 4.4.13-1: UCMF connected to MME\n\n\n"}, {"key": "Void", "numbering": "4.5", "title_level": 1, "desc": "4.5  Void\n\n\n\n\n"}, {"key": "EPS Mobility Management and Connection Management states", "numbering": "4.6", "title_level": 1, "desc": "4.6  EPS Mobility Management and Connection Management states\n\n\n"}, {"key": "General", "numbering": "4.6.1", "title_level": 2, "desc": "4.6.1  General\n\nThe EPS Mobility Management (EMM) states describe the Mobility Management\nstates that result from the mobility management procedures e.g. Attach and\nTracking Area Update procedures.\n\nTwo EMM states are described in this document:\n\n  -  EMM-DEREGISTERED.\n\n  -  EMM-REGISTERED.\n\n  NOTE\u00c2\u00a01:  Other specifications may define more detailed EMM states (see\n         e.g. TS\u00c2\u00a024.301\u00c2\u00a0[46]).\n\nThe EPS Connection Management (ECM) states describe the signalling\nconnectivity between the UE and the EPC.\n\nTwo ECM states are described in this document:\n\n  -  ECM-IDLE.\n\n  -  ECM-CONNECTED.\n\n  NOTE\u00c2\u00a02:  The ECM-CONNECTED and ECM-IDLE states used in this document\n         correspond respectively to the EMM-CONNECTED and EMM-IDLE modes\n         defined in TS\u00c2\u00a024.301\u00c2\u00a0[46].\n\nIn general, the ECM and EMM states are independent of each other.\nTransition from EMM-REGISTERED to EMM-DEREGISTERED can occur regardless of\nthe ECM state, e.g. by explicit detach signalling in ECM-CONNECTED or by\nimplicit detach locally in the MME during ECM-IDLE. However there are some\nrelations, e.g. to transition from EMM-DEREGISTERED to EMM-REGISTERED the\nUE has to be in the ECM-CONNECTED state.\n\n\n"}, {"key": "Definition of main EPS Mobility Management states", "numbering": "4.6.2", "title_level": 2, "desc": "4.6.2  Definition of main EPS Mobility Management states\n\n\n"}, {"key": "EMM-DEREGISTERED", "numbering": "4.6.2.1", "title_level": 3, "desc": "4.6.2.1  EMM-DEREGISTERED\n\nIn the EMM-DEREGISTERED state, the EMM context in MME holds no valid\nlocation or routing information for the UE. The UE is not reachable by a\nMME, as the UE location is not known.\n\nIn the EMM-DEREGISTERED state, some UE context can still be stored in the\nUE and MME, e.g. to avoid running an AKA procedure during every Attach\nprocedure.\n\nDuring the successful Inter-RAT TAU/RAU/handover procedure and ISR\nactivated is not indicated to the UE, the old S4 SGSN/old MME changes the\nEMM state of the UE to GPRS-IDLE/PMM-DETACHED/EMM-DEREGISTERED.\n\n\n"}, {"key": "EMM-REGISTERED", "numbering": "4.6.2.2", "title_level": 3, "desc": "4.6.2.2  EMM-REGISTERED\n\nThe UE enters the EMM-REGISTERED state by a successful registration with an\nAttach procedure to either E-UTRAN or GERAN/UTRAN. The MME enters the EMM-\nREGISTERED state by a successful Tracking Area Update procedure for a UE\nselecting an E-UTRAN cell from GERAN/UTRAN or by an Attach procedure via E-\nUTRAN. In the EMM-REGISTERED state, the UE can receive services that\nrequire registration in the EPS.\n\n  NOTE:  The UE employs a single combined state machine for EMM and GMM\n         states.\n\nThe UE location is known in the MME to at least an accuracy of the tracking\narea list allocated to that UE (excluding some abnormal cases).\n\nIn the EMM-REGISTERED state, the UE shall:\n\n  -  always have at least one active PDN connection (unless the UE supports\n    \"Attach without PDN connectivity\");\n\n  -  setup the EPS security context.\n\nAfter performing the Detach procedure, the state is changed to EMM-\nDEREGISTERED in the UE and in the MME. Upon receiving the TAU Reject and\nAttach Reject messages the actions of the UE and MME depend upon the 'cause\nvalue' in the reject message, but, in many cases the state is changed to\nEMM-DEREGISTERED in the UE and in the MME.\n\nIf all the bearers belonging to a UE that does not support \"Attach without\nPDN connectivity\" are released (e.g., after handover from E-UTRAN to non-\n3GPP access), the MME shall change the MM state of that UE to EMM-\nDEREGISTERED. If the UE that does not support \"Attach without PDN\nconnectivity\" camps on E-UTRAN and the UE detects that all of its bearers\nare released, the UE shall change the MM state to EMM-DEREGISTERED. If all\nthe bearers (PDP contexts) belonging to a UE are released, while the UE\ncamps on GERAN/UTRAN, the UE shall deactivate ISR by setting its TIN to \"P-\nTMSI\" as specified in TS\u00c2\u00a023.060\u00c2\u00a0[7]. This ensures that the UE performs\nTracking Area Update when it re-selects E-UTRAN. If the UE switches off its\nE-UTRAN interface when performing handover to non-3GPP access, the UE shall\nautomatically change its MM state to EMM-DEREGISTERED.\n\nThe MME may perform an implicit detach any time after the Implicit Detach\ntimer expires. The state is changed to EMM-DEREGISTERED in the MME after\nperforming the implicit detach.\n\n\n"}, {"key": "Definition of EPS Connection Management states", "numbering": "4.6.3", "title_level": 2, "desc": "4.6.3  Definition of EPS Connection Management states\n\n\n"}, {"key": "ECM-IDLE", "numbering": "4.6.3.1", "title_level": 3, "desc": "4.6.3.1  ECM-IDLE\n\nA UE is in ECM-IDLE state when no NAS signalling connection between UE and\nnetwork exists. In ECM-IDLE state, a UE performs cell selection/reselection\naccording to TS\u00c2\u00a036.304\u00c2\u00a0[34] and PLMN selection according to TS\u00c2\u00a023.122\u00c2\u00a0[10].\n\nExcept for UEs that have had their RRC connection suspended, as described\nin clause\u00c2\u00a05.3.4A, there exists no UE context in E-UTRAN for the UE in the\nECM-IDLE state. There is no S1_MME and no S1_U connection for the UE in the\nECM-IDLE state.\n\nIn the EMM-REGISTERED and ECM-IDLE state, the UE shall:\n\n  -  perform a tracking area update if the current TA is not in the list of\n    TAs that the UE has received from the network in order to maintain the\n    registration and enable the MME to page the UE;\n\n  -  perform the periodic tracking area updating procedure to notify the\n    EPC that the UE is available;\n\n  -  perform a tracking area update if the RRC connection was released with\n    release cause \"load balancing TAU required\";\n\n  -  perform a tracking area update when the UE reselects an E-UTRAN cell\n    and the UE's TIN indicates \"P-TMSI\";\n\n  -  perform a tracking area update for a change of the UE's Core Network\n    Capability information or the UE specific DRX parameter;\n\n  -  perform a tracking area update when a change in conditions in the UE\n    require a change in the extended idle mode DRX parameters previously\n    provided by the MME.\n\n  -  perform a tracking area update when the UE manually selects a CSG\n    cell, and the CSG ID and associated PLMN of that cell is absent from\n    both the UE's Allowed CSG list and the UE's Operator CSG list;\n\n  -  answer to paging from the MME by performing a service request\n    procedure or, if the UE has had its RRC connection suspended, the UE\n    initiates the Connection Resume procedure (clause\u00c2\u00a05.3.5A);\n\n  -  perform the service request procedure in order to establish the radio\n    bearers when uplink user data is to be sent, or uplink NAS signalling\n    is to be sent for UE requested bearer modification procedure\n    (clause\u00c2\u00a05.4.5), UE requested PDN connectivity (clause\u00c2\u00a05.10.2), UE\n    requested PDN disconnection (clause\u00c2\u00a05.10.3), or if the UE has had its\n    RRC connection suspended the UE initiates the Connection Resume\n    procedure (clause\u00c2\u00a05.3.5A).\n\nThe UE and the MME shall enter the ECM-CONNECTED state when the signalling\nconnection is established between the UE and the MME. Initial NAS messages\nthat initiate a transition from ECM-IDLE to ECM-CONNECTED state are Attach\nRequest, Tracking Area Update Request, Service Request or Detach Request. A\nsuccessful completion of the Connection Resume procedure, described in\nclause\u00c2\u00a05.3.5.A, initiates at UE and MME a state transition from ECM-IDLE to\nECM-CONNECTED.\n\nWhen the UE is in ECM-IDLE state, the UE and the network may be\nunsynchronized, i.e. the UE and the network may have different sets of\nestablished EPS bearers. When the UE and the MME enter the ECM-CONNECTED\nstate, the set of EPS Bearers is synchronized between the UE and network.\n\n\n"}, {"key": "ECM-CONNECTED", "numbering": "4.6.3.2", "title_level": 3, "desc": "4.6.3.2  ECM-CONNECTED\n\nThe UE location is known in the MME with an accuracy of a serving eNodeB\nID. The mobility of UE is handled by the handover procedure, except for\nwhen the NB-IoT is being used, in which case there are no handover\nprocedures.\n\nThe UE performs the tracking area update procedure when the TAI in the EMM\nsystem information is not in the list of TA's that the UE registered with\nthe network, or when the UE handovers to an E-UTRAN cell and the UE's TIN\nindicates \"P-TMSI\".\n\nFor a UE in the ECM-CONNECTED state, there exists a signalling connection\nbetween the UE and the MME. The signalling connection is made up of two\nparts: an RRC connection and an S1_MME connection.\n\nThe UE shall enter the ECM-IDLE state when its signalling connection to the\nMME has been released or broken. This release or failure is explicitly\nindicated by the eNodeB to the UE or detected by the UE.\n\nThe S1 release procedure or, if the UE is enabled to use User Plane CIoT\nEPS Optimisation the S1 Connection Suspend procedure (clause\u00c2\u00a05.3.4A)\nchanges the state at both UE and MME from ECM-CONNECTED to ECM-IDLE.\n\n  NOTE\u00c2\u00a01:  The UE may not receive the indication for the S1 release, e.g.\n         due to radio link error or out of coverage. In this case, there can\n         be temporal mismatch between the ECM-state in the UE and the ECM-\n         state in the MME.\n\nAfter a signalling procedure, the MME may decide to release the signalling\nconnection to the UE, after which the state at both the UE and the MME is\nchanged to ECM-IDLE.\n\n  NOTE\u00c2\u00a02:  There are some abnormal cases where the UE transitions to ECM-\n         IDLE.\n\nWhen a UE changes to ECM-CONNECTED state and the network initiates\nestablishment of data radio bearers, then if a data radio bearer cannot be\nestablished, or the UE cannot maintain a data radio bearer in the ECM-\nCONNECTED state during handovers, the corresponding EPS bearer is\ndeactivated. An exception to this is when the UE has been informed by the\nMME that a specific EPS bearer will never use a data radio bearer\n(e.g.because that EPS bearer is for a connection to the SCEF).\n\n\n"}, {"key": "State transition and functions", "numbering": "4.6.4", "title_level": 2, "desc": "4.6.4  State transition and functions\n\n                                    [pic]\n\n                    Figure 4.6.4-1: EMM state model in UE\n\n                                    [pic]\n\n                   Figure 4.6.4-2: EMM state model in MME\n\n                                    [pic]\n\n                    Figure 4.6.4-3: ECM state model in UE\n\n                                    [pic]\n\n                   Figure 4.6.4-4: ECM state model in MME\n\n\n"}, {"key": "Overall QoS concept", "numbering": "4.7", "title_level": 1, "desc": "4.7  Overall QoS concept\n\n\n"}, {"key": "PDN connectivity service", "numbering": "4.7.1", "title_level": 2, "desc": "4.7.1  PDN connectivity service\n\nThe Evolved Packet System provides connectivity between a UE and a PLMN\nexternal packet data network. This is referred to as PDN Connectivity\nService.\n\nThe IP PDN Connectivity Service supports the transport of traffic flow\naggregate(s), consisting of one or more Service Data Flows (SDFs).\n\n  NOTE:  The concept of SDF is defined in the context of PCC,\n         TS\u00c2\u00a023.203\u00c2\u00a0[6], and is not explicitly visible in the NAS signalling.\n\nA PDN connection to an SCEF has the following characteristics:\n\n  -  It is only supported for WB-EUTRA, LTE-M and NB-IoT RAT types;\n\n  -  It applies only when Control Plane CIoT EPS Optimisation are\n    applicable;\n\n  -  It does not support the transport of traffic flow aggregate(s);\n\n  -  It does not support Emergency Services.\n\n\n"}, {"key": "The EPS bearer", "numbering": "4.7.2", "title_level": 2, "desc": "4.7.2  The EPS bearer\n\n\n"}, {"key": "The EPS bearer in general", "numbering": "4.7.2.1", "title_level": 3, "desc": ""}, {"key": "The EPS bearer with GTP-based S/S", "numbering": "4.7.2.2", "title_level": 3, "desc": ""}, {"key": "The EPS bearer with PMIP-based S/S", "numbering": "4.7.2.3", "title_level": 3, "desc": "4.7.2.1  The EPS bearer in general\n\nFor E-UTRAN access to the EPC the PDN connectivity service is provided by\nan EPS bearer for GTP-based S5/S8, and if IP is in use, by an EPS bearer\nconcatenated with IP connectivity between Serving GW and PDN GW for PMIP-\nbased S5/S8.\n\nIn this release of the specifications, dedicated bearers are only supported\nfor the IP and Ethernet PDN Connectivity Service.\n\nWhen User Plane (S1-U) is used for data traffic, then an EPS bearer\nuniquely identifies traffic flows that receive a common QoS treatment\nbetween a UE and a PDN GW for GTP-based S5/S8, and between UE and Serving\nGW for PMIP-based S5/S8. The packet filters signalled in the NAS procedures\nare associated with a unique packet filter identifier on per-PDN connection\nbasis.\n\n  NOTE\u00c2\u00a01:  The EPS Bearer Identity together with the packet filter\n         identifier is used to reference which packet filter the UE intends\n         to modify or delete, i.e. it is used to implement the unique packet\n         filter identifier.\n\nAn EPS bearer is the level of granularity for bearer level QoS control in\nthe EPC/E-UTRAN. That is, all traffic mapped to the same EPS bearer receive\nthe same bearer level packet forwarding treatment (e.g. scheduling policy,\nqueue management policy, rate shaping policy, RLC configuration, etc.).\nProviding different bearer level packet forwarding treatment requires\nseparate EPS bearers.\n\n  NOTE\u00c2\u00a02:  In addition but independent to bearer level QoS control, the PCC\n         framework allows an optional enforcement of service level QoS\n         control on the granularity of SDFs independent of the mapping of\n         SDFs to EPS bearers.\n\nOne EPS bearer is established when the UE connects to a PDN, and that\nremains established throughout the lifetime of the PDN connection to\nprovide the UE with always-on connectivity to that PDN. That bearer is\nreferred to as the default bearer. Any additional EPS bearer that is\nestablished for the same PDN connection is referred to as a dedicated\nbearer.\n\nThe EPS bearer traffic flow template (TFT) is the set of all packet filters\nassociated with that EPS bearer. An UpLink Traffic Flow Template (UL TFT)\nis the set of uplink packet filters in a TFT. A DownLink Traffic Flow\nTemplate (DL TFT) is the set of downlink packet filters in a TFT. Every\ndedicated EPS bearer is associated with a TFT. A TFT may be also assigned\nto the default EPS bearer. The UE uses the UL TFT for mapping traffic to an\nEPS bearer in the uplink direction. The PCEF (for GTP-based S5/S8) or the\nBBERF (for PMIP-based S5/S8) uses the DL TFT for mapping traffic to an EPS\nbearer in the downlink direction. The UE may use the UL TFT and DL TFT to\nassociate EPS Bearer Activation or Modification procedures to an\napplication and to traffic flow aggregates of the application. Therefore\nthe PDN GW shall, in the Create Dedicated Bearer Request and the Update\nBearer Request messages, provide all available traffic flow description\ninformation (e.g. source and destination IP address and port numbers and\nthe protocol information).\n\nFor the UE, the evaluation precedence order of the packet filters making up\nthe UL TFTs is signalled from the P-GW to the UE as part of any appropriate\nTFT operations.\n\n  NOTE\u00c2\u00a03:  The evaluation precedence index of the packet filters associated\n         with the default bearer, in relation to those associated with the\n         dedicated bearers, is up to operator configuration. It is possible\n         to \"force\" certain traffic onto the default bearer by setting the\n         evaluation precedence index of the corresponding filters to a value\n         that is lower than the values used for filters associated with the\n         dedicated bearers.\n\nFurther details about the TFT and the TFT operations are described in\nclause\u00c2\u00a015.3 of TS\u00c2\u00a023.060\u00c2\u00a0[7]. The details about the TFT packet filter(s)\nare described in clause\u00c2\u00a015.3.2 of TS\u00c2\u00a023.060\u00c2\u00a0[7] for PDN connections of IP\ntype and in clause\u00c2\u00a05.7.6.3 of TS\u00c2\u00a023.501\u00c2\u00a0[83] for PDN connections of\nEthernet type.\n\nA TFT of an uplink unidirectional EPS bearer is only associated with UL\npacket filter(s) that matches the uplink unidirectional traffic flow(s) A\nTFT of a downlink unidirectional EPS bearer is associated with DL packet\nfilter(s) that matches the unidirectional traffic flow(s) and a UL packet\nfilter that effectively disallows any useful packet flows (see\nclause\u00c2\u00a015.3.3.4 in TS\u00c2\u00a023.060\u00c2\u00a0[7] for an example of such packet filter.\n\nThe UE routes uplink packets to the different EPS bearers based on uplink\npacket filters in the TFTs assigned to these EPS bearers. The UE evaluates\nfor a match, first the uplink packet filter amongst all TFTs that has the\nlowest evaluation precedence index and, if no match is found, proceeds with\nthe evaluation of uplink packet filters in increasing order of their\nevaluation precedence index. This procedure shall be executed until a match\nis found or all uplink packet filters have been evaluated. If a match is\nfound, the uplink data packet is transmitted on the EPS bearer that is\nassociated with the TFT of the matching uplink packet filter. If no match\nis found, the uplink data packet shall be sent via the EPS bearer that has\nnot been assigned any uplink packet filter. If all EPS bearers (including\nthe default EPS bearer for that PDN) have been assigned one or more uplink\npacket filters, the UE shall discard the uplink data packet.\n\n  NOTE\u00c2\u00a04:  The above algorithm implies that there is at most one EPS bearer\n         without any uplink packet filter. Therefore, some UEs may expect\n         that during the lifetime of a PDN connection (where only network\n         has provided TFT packet filters) at most one EPS bearer exists\n         without any uplink packet filter.\n\nTo ensure that at most one EPS bearer exists without any uplink packet\nfilter, the PCEF (for GTP-based S5/S8) or the BBERF (for PMIP-based S5/S8)\nmaintains a valid state for the TFT settings of the PDN connection as\ndefined in clause\u00c2\u00a015.3.0 of TS\u00c2\u00a023.060\u00c2\u00a0[7] and if necessary, adds a packet\nfilter which effectively disallows any useful packet flows in uplink\ndirection (see clause\u00c2\u00a015.3.3.4 in TS\u00c2\u00a023.060\u00c2\u00a0[7] for an example of such a\npacket filter) to the TFT of a dedicated bearer.\n\n  NOTE\u00c2\u00a05:  The default bearer is the only bearer that may be without any\n         uplink packet filter and thus, a packet filter which effectively\n         disallows any useful packet flows in uplink direction will not be\n         added by the PCEF/BBERF.\n\nThe initial bearer level QoS parameter values of the default bearer are\nassigned by the network, based on subscription data (in E-UTRAN the MME\nsets those initial values based on subscription data retrieved from HSS).\n\nIn a non-roaming scenario, the PCEF may change the QoS parameter value\nreceived from the MME based on interaction with the PCRF or based on local\nconfiguration. When the PCEF changes those values, the MME shall use the\nbearer level QoS parameter values received on the S11 reference point\nduring establishment or modification of the default bearer.\n\nIn a roaming scenario, based on local configuration, the MME may downgrade\nthe ARP or APN-AMBR and/or remap QCI parameter values received from HSS to\nthe value locally configured in MME (e.g. when the values received from HSS\ndo not comply with services provided by the visited PLMN). The PCEF may\nchange the QoS parameter values received from the MME based on interaction\nwith the PCRF or based on local configuration. Alternatively, the PCEF may\nreject the bearer establishment.\n\n  NOTE\u00c2\u00a06:  For certain APNs (e.g. the IMS APN defined by the GSMA) the QCI\n         value is strictly defined and therefore remapping of QCI is not\n         permitted.\n\n  NOTE\u00c2\u00a07:  In roaming scenarios, the ARP/APN-AMBR/QCI values provided by\n         the MME for a default bearer may deviate from the subscribed values\n         depending on the roaming agreement. If the PCC/PCEF rejects the\n         establishment of the default bearer, this implies that Attach via E-\n         UTRAN will fail. Similarly, if the PCEF (based on interaction with\n         the PCRF or based on local configuration) upgrades the ARP/APN-\n         AMBR/QCI parameter values received from the MME, the default bearer\n         establishment and attach may be rejected by the MME.\n\n  NOTE\u00c2\u00a08:  Subscription data related to bearer level QoS parameter values\n         retrieved from the HSS are not applicable for dedicated bearers.\n\nFor WB-E-UTRA, the decision to establish or modify a dedicated bearer can\nonly be taken by the EPC, and the bearer level QoS parameter values are\nalways assigned by the EPC.\n\nDedicated bearers are not supported over NB-IoT. The PDN GW uses the RAT\nType to ensure that no dedicated bearers are active when the UE is\naccessing over NB-IoT. In case of inter-RAT mobility from WB-EUTRA to NB-\nIoT, the UE and MME indicate local deactivation of non-default EPS bearers\nat TAU as specified in TS\u00c2\u00a024.301\u00c2\u00a0[46].\n\nThe MME shall not modify the bearer level QoS parameter values received on\nthe S11 reference point during establishment or modification of a default\nor dedicated bearer (except when the conditions described in NOTE\u00c2\u00a08 apply).\nConsequently, \"QoS negotiation\" between the E-UTRAN and the EPC during\ndefault or dedicated bearer establishment / modification is not supported.\nBased on local configuration, the MME may reject the establishment or\nmodification of a default or dedicated bearer  if the bearer level QoS\nparameter values sent by the PCEF over a GTP based S8 roaming interface do\nnot comply with a roaming agreement.\n\n  NOTE\u00c2\u00a09:  The MME, based on local policies, can downgrade the ARP pre-\n         emption capability, APN-AMBR or MBR (for GBR bearers) parameters\n         received over S8 and allow the bearer establishment or modification\n         of a default or dedicated bearer. The HPLMN is expected to set EPS\n         QoS parameters compliant with roaming agreements, therefore the\n         HPLMN is not informed about any downgrade of EPS bearer QoS\n         parameters. The consequences of such a downgrade are that APN-AMBR\n         and MBR enforcement at the HPLMN and at the UE will not be aligned.\n\nAt inter-RAT mobility, based on local configuration, the MME may perform a\nmapping of QCI values for which there is no mapping defined in Table E.3 or\nwhich are not supported in the target RAT.\n\n  NOTE\u00c2\u00a010: The PCRF ensures that the EPS bearer QCI values are aligned with\n         the QCI values mapped by the MME for the current RAT as described\n         in clause\u00c2\u00a0A.4.1.2 of TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\nThe distinction between default and dedicated bearers should be transparent\nto the access network (e.g. E-UTRAN).\n\nAn EPS bearer is referred to as a GBR bearer if dedicated network resources\nrelated to a Guaranteed Bit Rate (GBR) value that is associated with the\nEPS bearer are permanently allocated (e.g. by an admission control function\nin the eNodeB) at bearer establishment/modification. Otherwise, an EPS\nbearer is referred to as a Non-GBR bearer.\n\n  NOTE\u00c2\u00a011: Admission control can be performed at establishment /\n         modification of a Non-GBR bearer even though a Non-GBR bearer is\n         not associated with a GBR value.\n\nA dedicated bearer can either be a GBR or a Non-GBR bearer. A default\nbearer shall be a Non-GBR bearer.\n\n  NOTE\u00c2\u00a012: A default bearer provides the UE with connectivity throughout\n         the lifetime of the PDN connection. That motivates the restriction\n         of a default bearer to bearer type Non-GBR.\n\n\n4.7.2.2  The EPS bearer with GTP-based S5/S8\n\n                                    [pic]\n\n         Figure 4.7.2.2-1: Two Unicast EPS bearers (GTP-based S5/S8)\n\nAn EPS bearer is realized by the following elements:\n\n  -  In the UE, the UL TFT maps a traffic flow aggregate to an EPS bearer\n    in the uplink direction;\n\n  -  In the PDN\u00c2\u00a0GW, the DL TFT maps a traffic flow aggregate to an EPS\n    bearer in the downlink direction;\n\n  -  A radio bearer (defined in TS\u00c2\u00a036.300\u00c2\u00a0[5]) transports the packets of an\n    EPS bearer between a UE and an eNodeB. If a radio bearer exists, there\n    is a one-to-one mapping between an EPS bearer and this radio bearer;\n\n  -  An S1 bearer transports the packets of an EPS bearer between an eNodeB\n    and a Serving GW;\n\n  -  An E-RAB (E-UTRAN Radio Access Bearer) refers to the concatenation of\n    an S1 bearer and the corresponding radio bearer, as defined in\n    TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n  -  An S5/S8 bearer transports the packets of an EPS bearer between a\n    Serving GW and a PDN GW;\n\n  -  A UE stores a mapping between an uplink packet filter and a radio\n    bearer to create the mapping between a traffic flow aggregate and a\n    radio bearer in the uplink;\n\n  -  A PDN GW stores a mapping between a downlink packet filter and an\n    S5/S8 bearer to create the mapping between a traffic flow aggregate and\n    an S5/S8 bearer in the downlink;\n\n  -  An eNodeB stores a one-to-one mapping between a radio bearer and an S1\n    Bearer to create the mapping between a radio bearer and an S1 bearer in\n    both the uplink and downlink;\n\n  -  A Serving GW stores a one-to-one mapping between an S1 Bearer and an\n    S5/S8 bearer to create the mapping between an S1 bearer and an S5/S8\n    bearer in both the uplink and downlink.\n\nThe PDN GW routes downlink packets to the different EPS bearers based on\nthe downlink packet filters in the TFTs assigned to the EPS bearers in the\nPDN connection. Upon reception of a downlink data packet, the PDN GW\nevaluates for a match, first the downlink packet filter that has the lowest\nevaluation precedence index and, if no match is found, proceeds with the\nevaluation of downlink packet filters in increasing order of their\nevaluation precedence index. This procedure shall be executed until a match\nis found, in which case the downlink data packet is tunnelled to the\nServing GW on the EPS bearer that is associated with the TFT of the\nmatching downlink packet filter. If no match is found, the downlink data\npacket shall be sent via the EPS bearer that does not have any TFT\nassigned. If all EPS bearers (including the default EPS bearer for that\nPDN) have been assigned a TFT, the PDN GW shall discard the downlink data\npacket.\n\n\n4.7.2.3  The EPS bearer with PMIP-based S5/S8\n\nSee clause\u00c2\u00a04.10.3 in TS\u00c2\u00a023.402\u00c2\u00a0[2].\n\n\n"}, {"key": "Bearer level QoS parameters", "numbering": "4.7.3", "title_level": 2, "desc": "4.7.3  Bearer level QoS parameters\n\nThe EPS bearer QoS profile includes the parameters QCI, ARP, GBR and MBR,\ndescribed in this clause. This clause also describes QoS parameters which\nare applied to an aggregated set of EPS Bearers: APN-AMBR and UE-AMBR.\n\nEach EPS bearer (GBR and Non-GBR) is associated with the following bearer\nlevel QoS parameters:\n\n  -  QoS Class Identifier (QCI);\n\n  -  Allocation and Retention Priority (ARP).\n\nA QCI is a scalar that is used as a reference to access node-specific\nparameters that control bearer level packet forwarding treatment (e.g.\nscheduling weights, admission thresholds, queue management thresholds, link\nlayer protocol configuration, etc.), and that have been pre-configured by\nthe operator owning the access node (e.g. eNodeB). A one-to-one mapping of\nstandardized QCI values to standardized characteristics is captured in\nTS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  NOTE\u00c2\u00a01:  On the radio interface and on S1, each PDU (e.g. RLC PDU or GTP-\n         U PDU) is indirectly associated with one QCI via the bearer\n         identifier carried in the PDU header. The same applies to the S5\n         and S8 interfaces if they are based on GTP.\n\n  NOTE\u00c2\u00a02:  When required by operator policy, the eNodeB can be configured\n         to also use the ARP priority level in addition to the QCI to\n         control bearer level packet forwarding treatment in the eNodeB for\n         SDFs having high priority ARPs.\n\nThe ARP shall contain information about the priority level (scalar), the\npre-emption capability (flag) and the pre-emption vulnerability (flag). The\nprimary purpose of ARP is to decide whether a bearer establishment /\nmodification request can be accepted or needs to be rejected due to\nresource limitations (typically available radio capacity for GBR bearers).\nThe priority level information of the ARP is used for this decision to\nensure that the request of the bearer with the higher priority level is\npreferred. In addition, the ARP can be used (e.g. by the eNodeB) to decide\nwhich bearer(s) to drop during exceptional resource limitations (e.g. at\nhandover). The pre-emption capability information of the ARP defines\nwhether a bearer with a lower ARP priority level should be dropped to free\nup the required resources. The pre-emption vulnerability information of the\nARP defines whether a bearer is applicable for such dropping by a pre-\nemption capable bearer with a higher ARP priority level.\n\nOnce a bearer has been successfully established, the packet handling (e.g.\nscheduling and rate control) within the eNodeB, PDN GW, and Serving GW\nshould be solely determined by the following EPS bearer QoS parameters:\nQCI, GBR and MBR, and by the AMBR parameters. However, when required by\noperator policy, the eNodeB can be configured to also use a bearer's ARP\npriority level in addition to the QCI to determine the relative priority of\nthe SDFs for packet handling (e.g. scheduling and rate control) in the\neNodeB as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6] clause\u00c2\u00a06.1.7.2. This configuration\napplies only for bearers with high priority ARPs as defined in\nTS\u00c2\u00a023.203\u00c2\u00a0[6] clause\u00c2\u00a06.1.7.3.\n\nThe ARP priority level may be used in addition to the QCI to determine the\ntransport level packet marking, e.g. to set the DiffServ Code Point. The\nARP is not included within the EPS QoS Profile sent to the UE.\n\n  NOTE\u00c2\u00a03:  The ARP should be understood as \"Priority of Allocation and\n         Retention\"; not as \"Allocation, Retention, and Priority\".\n\n  NOTE\u00c2\u00a04:  Video telephony is one use case where it may be beneficial to\n         use EPS bearers with different ARP values for the same UE. In this\n         use case an operator could map voice to one bearer with a higher\n         ARP, and video to another bearer with a lower ARP. In a congestion\n         situation (e.g. cell edge) the eNodeB can then drop the \"video\n         bearer\" without affecting the \"voice bearer\". This would improve\n         service continuity.\n\n  NOTE\u00c2\u00a05:  The ARP may also be used to free up capacity in exceptional\n         situations, e.g. a disaster situation. In such a case the eNodeB\n         may drop bearers with a lower ARP priority level to free up\n         capacity if the pre-emption vulnerability information allows this.\n\nEach GBR bearer is additionally associated with the following bearer level\nQoS parameters:\n\n  -  Guaranteed Bit Rate (GBR);\n\n  -  Maximum Bit Rate (MBR).\n\nThe GBR denotes the bit rate that can be expected to be provided by a GBR\nbearer. The MBR limits the bit rate that can be expected to be provided by\na GBR bearer (e.g. excess traffic may get discarded by a rate shaping\nfunction). See clause\u00c2\u00a04.7.4 for further details on GBR and MBR.\n\nGBR bearers are not supported by NB-IoT. The PDN GW uses the RAT Type to\nensure that GBR bearers are not active when the UE is using NB-IoT.\n\nEach APN access, by a UE, is associated with the following QoS parameter:\n\n  -  per APN Aggregate Maximum Bit Rate (APN-AMBR).\n\nThe subscribed APN-AMBR is a subscription parameter stored per APN in the\nHSS, which applies as APN-AMBR unless the APN-AMBR is modified by the MME\n(e.g in roaming scenarios and/or for usage of NB-IoT) or the PDN GW, based\non local policy (e.g. for RAT Type = NB-IoT) or PCRF interactions. The APN-\nAMBR limits the aggregate bit rate that can be expected to be provided\nacross all Non-GBR bearers and across all PDN connections of the same APN\n(e.g. excess traffic may get discarded by a rate shaping function). Each of\nthose Non-GBR bearers could potentially utilize the entire APN-AMBR, e.g.\nwhen the other Non-GBR bearers do not carry any traffic. GBR bearers are\noutside the scope of APN-AMBR. The P-GW enforces the APN-AMBR in downlink.\nEnforcement of APN-AMBR in uplink is done in the UE and additionally in the\nP-GW.\n\n  NOTE\u00c2\u00a06:  All simultaneous active PDN connections of a UE that are\n         associated with the same APN shall be provided by the same PDN GW\n         (see clauses\u00c2\u00a04.3.8.1 and 5.10.1).\n\nAPN-AMBR applies to all PDN connections of an APN. For the case of multiple\nPDN connections of an APN, if a change of APN-AMBR occurs due to local\npolicy or the PDN GW is provided the updated APN-AMBR for each PDN\nconnection from the MME or PCRF, the PDN GW initiates explicit signaling\nfor each PDN connection to update the APN-AMBR value.\n\nEach UE in state EMM-REGISTERED is associated with the following bearer\naggregate level QoS parameter:\n\n  -  per UE Aggregate Maximum Bit Rate (UE-AMBR).\n\nThe UE-AMBR is limited by a subscription parameter stored in the HSS. The\nMME shall set the UE-AMBR to the sum of the APN-AMBR of all active APNs up\nto the value of the subscribed UE-AMBR. The UE-AMBR limits the aggregate\nbit rate that can be expected to be provided across all Non-GBR bearers of\na UE (e.g. excess traffic may get discarded by a rate shaping function).\nEach of those Non-GBR bearers could potentially utilize the entire UE-AMBR,\ne.g. when the other Non-GBR bearers do not carry any traffic. GBR bearers\nare outside the scope of UE AMBR. The E-UTRAN enforces the UE-AMBR in\nuplink and downlink except for PDN connections using the Control Plane CIoT\nEPS Optimisation.\n\nThe GBR and MBR denote bit rates of traffic per bearer while UE-AMBR/APN-\nAMBR denote bit rates of traffic per group of bearers. Each of those QoS\nparameters has an uplink and a downlink component. On S1_MME the values of\nthe GBR, MBR, and AMBR refer to the bit stream excluding the GTP-U/IP\nheader overhead of the tunnel on S1_U.\n\nThe HSS defines, for each PDN subscription context, the 'EPS subscribed QoS\nprofile' which contains the bearer level QoS parameter values for the\ndefault bearer (QCI and ARP) and the subscribed APN-AMBR value. The\nsubscribed ARP shall be used to set the priority level of the EPS bearer\nparameter ARP for the default bearer while the pre-emption capability and\nthe pre-emption vulnerability information for the default bearer are set\nbased on MME operator policy. In addition, the subscribed ARP shall be\napplied by the P-GW for setting the ARP priority level of all dedicated EPS\nbearers of the same PDN connection unless a different ARP priority level\nsetting is required (due to P-GW configuration or interaction with the\nPCRF).\n\n  NOTE\u00c2\u00a07:  The ARP parameter of the EPS bearer can be modified by the P-GW\n         (e.g. based on interaction with the PCRF due to e.g. MPS user\n         initiated session) to assign the appropriate pre-emption capability\n         and the pre-emption vulnerability setting.\n\nThe ARP pre-emption vulnerability of the default bearer should be set\nappropriately to minimize the risk of unnecessary release of the default\nbearer.\n\n\n"}, {"key": "Support for Application / Service Layer Rate Adaptation", "numbering": "4.7.4", "title_level": 2, "desc": "4.7.4  Support for Application / Service Layer Rate Adaptation\n\nThe E-UTRAN/UTRAN and the UE support the RFC\u00c2\u00a03168\u00c2\u00a0[55] Explicit Congestion\nNotification (ECN), as described in TS\u00c2\u00a036.300\u00c2\u00a0[5], TS\u00c2\u00a025.401\u00c2\u00a0[16] and\nTS\u00c2\u00a026.114\u00c2\u00a0[56]. The IP level ECN scheme enables the E-UTRAN/UTRAN to\ntrigger a rate adaptation scheme at the application / service / transport\nlayer. To make sufficient time available for end-to-end codec rate\nadaptation the E-UTRAN/UTRAN should attempt to not drop any packets on a\nbearer for a default grace period of at least 500 ms after it has indicated\ncongestion with ECN on the bearer for packets within the packet delay\nbudget. During this ECN grace period the E-UTRAN/UTRAN should also attempt\nto meet the QCI characteristics / QoS class associated with the bearer.\n\n  NOTE\u00c2\u00a01:  Note that the receiving end-point should interpret all ECN-CE\n         signals received within one end-to-end round-trip time as one\n         \"congestion event\" (see IETF\u00c2\u00a0RFC\u00c2\u00a03168\u00c2\u00a0[55] and TS\u00c2\u00a026.114\u00c2\u00a0[56]).\n\nThe MBR of a particular GBR bearer may be set larger than the GBR.\n\n  NOTE\u00c2\u00a02:  Enforcement of APN-AMBR / UE-AMBR is independent of whether the\n         MBR of a particular GBR bearer has been set larger than the GBR\n         (see clause\u00c2\u00a04.7.3).\n\nThe EPC does not support E-UTRAN/UTRAN-initiated \"QoS re-negotiation\". That\nis, the EPC does not support an eNodeB/RNC initiated bearer modification\nprocedure. If an eNodeB/RNC can no longer sustain the GBR of an active GBR\nbearer then the eNodeB/RNC should simply trigger a deactivation of that\nbearer.\n\n\n"}, {"key": "Application of PCC in the Evolved Packet System", "numbering": "4.7.5", "title_level": 2, "desc": "4.7.5  Application of PCC in the Evolved Packet System\n\nThe Evolved Packet System applies the PCC framework as defined in\nTS\u00c2\u00a023.203\u00c2\u00a0[6] for QoS policy and charging control. PCC functionality is\npresent in the AF, PCEF and PCRF.\n\nAn EPS needs to support both PCEF and PCRF functionality to enable dynamic\npolicy and charging control by means of installation of PCC rules based on\nuser and service dimensions. However, an EPS may only support PCEF\nfunctionality in which case it shall support static policy and charging\ncontrol.\n\n  NOTE:  The local configuration of PCEF static policy and charging control\n         functionality is not subject to standardization. The PCEF static\n         policy and control functionality is not based on subscription\n         information.\n\nThe following applies to the use of dynamic policy and charging control in\nEPS:\n\n  -  The service level (per SDF) QoS parameters are conveyed in PCC rules\n    (one PCC rule per SDF) over the Gx reference point. The service level\n    QoS parameters consist of a QoS Class Identifier (QCI) Allocation and\n    Retention Priority (ARP) and authorised Guaranteed and Maximum Bit Rate\n    values for uplink and downlink. The QCI is a scalar that represents the\n    QoS characteristics that the EPS is expected to provide for the SDF.\n    ARP is an indicator of the priority for the SDF that is used to decide\n    about the assignment of resources due to resource limitations. The\n    service level ARP assigned by PCRF in a PCC rule may be different from\n    the bearer level ARP stored in subscription data;\n\n  -  The set of standardized QCIs and their characteristics that the PCRF\n    in an EPS can select from is provided in TS\u00c2\u00a023.203\u00c2\u00a0[6]. It is expected\n    that the PCRF selects a QCI in such a way that the IP-CAN receiving it\n    can support it;\n\n  -  It is not required that an IP-CAN supports all standardized QCIs;\n\n  -  In the case of IP address configuration subsequent to initial\n    attachment, i.e. through DHCP mechanism to complete the IP address\n    configuration, the PDN GW/PCEF shall notify the PCRF of the UE's IP\n    address by means of an IP-CAN Session Modification procedure or IP-CAN\n    Session Establishment procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6] when it is\n    assigned. If the PCRF response leads to an EPS bearer modification the\n    PDN GW should initiate a bearer update procedure;\n\n  -  For local breakout, the visited network has the capability to reject\n    the QoS authorized by the home network based on operator policies.\n\nThe following applies regardless of whether dynamic or static policy and\ncharging control is used in EPS:\n\n  -  For E-UTRAN the value of the ARP of an EPS bearer is identical to the\n    value of the ARP of the SDF(s) mapped to that EPS bearer;\n\n  -  For the same UE/PDN connection: SDFs associated with different QCIs or\n    with the same service-level QCI but different ARP shall not be mapped\n    to the same EPS bearer;\n\n  -  The bearer level QCI of an EPS bearer is identical to the value of the\n    QCI of the SDF(s) mapped to that EPS bearer.\n\n\n"}, {"key": "Bearer Control Mode in EPC", "numbering": "4.7.6", "title_level": 2, "desc": "4.7.6  Bearer Control Mode in EPC\n\nThe Bearer Control Mode (BCM) for E-UTRAN access is always UE/NW. Hence,\nexplicit signalling between the UE and the network to determine BCM for E-\nUTRAN access does not occur.\n\nGERAN/UTRAN/E-UTRAN capable UEs negotiate the BCM of a PDN Connection\napplicable for GERAN/UTRAN access during E-UTRAN Initial Attach and during\nUE Requested PDN Connectivity procedure. Such UEs provide the Network\nRequest Support UE (NRSU) parameter to the PDN GW in PCO. The PDN GW\nderives the BCM applicable to GERAN/UTRAN access based on the NRSU and\noperator policy. The selected BCM, valid for GERAN/UTRAN, is provided back\nto the UE in PCO IE in the E-UTRAN Attach Accept or PDN Connectivity Accept\nmessage. The selected BCM is also stored in the PDN GW and the UE, and\napplied by UE upon moving to GERAN or UTRAN access unless explicitly\ninformed by PDN GW of a change in BCM (see TS\u00c2\u00a023.060\u00c2\u00a0[7]) via PCO IE.\n\n  NOTE\u00c2\u00a01:  In Rel-8 it was not mandatory for GERAN/UTRAN/E-UTRAN capable\n         UEs to provide NRSU to the PDN\u00c2\u00a0GW during E-UTRAN Initial Attach and\n         UE Requested PDN Connectivity procedure.\n\nWhen a GERAN/UTRAN/E-UTRAN capable UE moves from UTRAN or GERAN access to E-\nUTRAN access, it stores the BCM used in UTRAN or GERAN access to be used\nagain when the UE moves back to UTRAN or GERAN access unless explicitly\ninformed by PDN GW of a change in BCM (see TS\u00c2\u00a023.060\u00c2\u00a0[7]) via the PCO IE.\n\nIf PCC is deployed, the PDN GW requests PCRF to perform BCM selection for\nthe RAT the UE is accessing at IP-CAN session establishment and IP-CAN\nsession modification. The PCRF, determines the applicable BCM, based on a\nnumber of factors (see TS\u00c2\u00a023.203\u00c2\u00a0[6]), and informs the PDN\u00c2\u00a0GW. If the BCM\nhas changed, the PDN\u00c2\u00a0GW informs the UE of the new BCM via the PCO IE.\n\n\n"}, {"key": "Support of rate control of user data using CIoT EPS Optimisation", "numbering": "4.7.7", "title_level": 2, "desc": "4.7.7  Support of rate control of user data using CIoT EPS Optimisation\n\n\n"}, {"key": "General", "numbering": "4.7.7.1", "title_level": 3, "desc": "4.7.7.1  General\n\nThe rate of user data sent to and from a UE (e.g. a UE using CIoT EPS\nOptimisations) can be controlled in two different ways:\n\n  -  Serving PLMN Rate Control\n\n  -  APN Rate Control\n\nServing PLMN Rate Control is intended to allow the Serving PLMN to protect\nits MME and the Signalling Radio Bearers in the E-UTRAN from the load\ngenerated by NAS Data PDUs.\n\nAPN Rate Control is intended to allow HPLMN operators to offer customer\nservices such as \"maximum of Y messages per day\".\n\n  NOTE:  Existing AMBR mechanisms are not suitable for such a service\n         since, for radio efficiency and UE battery life reasons, an AMBR of\n         e.g. > 100kbit/s is desirable and such an AMBR translates to a\n         potentially large daily data volume.\n\nThe PDN GW in the visited PLMN may send the APN rate control parameter for\nan emergency PDN connection.\n\n\n"}, {"key": "Serving PLMN Rate Control", "numbering": "4.7.7.2", "title_level": 3, "desc": "4.7.7.2  Serving PLMN Rate Control\n\nThe Serving PLMN Rate Control value is configured in the MME.\n\n  NOTE\u00c2\u00a01:  Homogeneous support of Serving PLMN Rate Control in a network is\n         assumed.\n\nAt PDN connection establishment, the MME may inform the UE and PDN GW/SCEF\n(as specified in TS\u00c2\u00a024.301\u00c2\u00a0[46] and TS\u00c2\u00a029.274\u00c2\u00a0[43]) of any per PDN\nconnection local Serving PLMN Rate Control that the Serving PLMN intends to\nenforce for NAS Data PDUs. The MME shall only indicate Serving PLMN Rate\nControl command to the PDN GW if the PDN connection is using S11-U and set\nto Control Plane only. The MME shall only indicate Serving PLMN Rate\nControl command to the SCEF if that PDN connection is using SCEF.\n\nThis rate control is operator configurable and expressed as \"X NAS Data\nPDUs per deci hour\" where X is an integer that shall not be less than 10.\nThere are separate limits for uplink and downlink NAS Data PDUs:\n\n  -  The UE shall limit the rate at which it generates uplink NAS Data PDUs\n    to comply with the Serving PLMN policy. In the UE the indicated rate\n    control applies only on the PDN connection where it was received, and\n    therefore the UE shall limit the rate of its uplink NAS Data PDUs to\n    comply with the rate that is indicated for the PDN connection. The\n    indicated rate is valid until the PDN connection is released.\n\n  -  The PDN GW/SCEF shall limit the rate at which it generates downlink\n    Data PDUs. In the PDN GW/SCEF the indicated rate control applies only\n    on the PDN connection where it was received, and therefore the\n    PDN\u00c2\u00a0GW/SCEF shall limit the rate of its downlink Data PDUs to comply\n    with the rate that is indicated for the PDN connection.\n\n  -  The MME may enforce thisthese limits per PDN connection by discarding\n    or delaying packets that exceed this limitthese limits. The Serving\n    PLMN Rate does not include SMS sent via NAS Transport PDUs. The MME\n    starts the Serving PLMN Rate Control when the first NAS Data PDU is\n    received.\n\n  NOTE\u00c2\u00a02:  In case the UE/PDN GW/SCEF start the Serving PLMN rate control\n         at a different time than the MME, PDUs sent within the limit\n         enforced at the UE/PDN GW/SCEF can still exceed the limit enforced\n         by the MME.\n\n  NOTE\u00c2\u00a03 It is assumed that the Serving PLMN Rate is sufficiently high to\n         not interfere with the APN Rate Control as the APN Rate Control, if\n         used, is assumed to allow fewer messages. NAS PDUs related to\n         exception reports are not subject to the Serving PLMN Rate Control.\n\n\n"}, {"key": "APN Rate Control", "numbering": "4.7.7.3", "title_level": 3, "desc": "4.7.7.3  APN Rate Control\n\nThe APN Rate Control is configured in the PDN GW or in the SCEF. The PDN GW\nor SCEF can send an APN Uplink Rate Control command to the UE using the PCO\ninformation element.\n\nThe APN Uplink Rate Control applies to data PDUs sent on that APN by either\nData Radio Bearers (S1-U) or Signalling Radio Bearers (NAS Data PDUs).\n\nThe rate control information is separate for uplink and downlink and in the\nform of:\n\n  -  a positive integer 'number of packets per time unit', and\n\n  -  an indication as to whether or not exception reports can still be sent\n    if this rate control limit has been met, and\n\n  -  if the UE indicated support for it, an integer 'number of additional\n    allowed exception report packets per time unit' once the rate control\n    limit has been reached.\n\nUEs supporting APN Rate Control shall support the 'number of additional\nallowed exception report packets per time unit' and shall provide an\nindication to the CN at PDN connection establishment.\n\n  NOTE\u00c2\u00a01:  Pre-Rel-14 UEs do not support the 'number of additional allowed\n         exception report packets per time unit' and do not send an\n         indication to the CN at PDN connection establishment.\n\nThe UE shall comply with this uplink rate control instruction. If the UE\nexceeds the uplink 'number of packets per time unit', the UE may still send\nuplink exception reports if allowed and the 'number of additional allowed\nexception reports per time unit' has not been exceeded. The UE shall\nconsider this rate control instruction as valid until it receives a new one\nfrom either PDN GW or from SCEF.\n\nWhen the last PDN connection using a given APN is released, the APN Rate\nControl Status (including the number of packets still allowed in the given\ntime unit, the number of additional exception reports still allowed in the\ngiven time unit and the termination time of the current APN Rate Control\nvalidity period) may be stored in the MME so that it can be retrieved for a\nsubsequent re-establishment of a new first PDN connection for that given\nAPN.\n\nAt subsequent establishment of a new first PDN connection for that given\nAPN, the PDN GW/SCEF may receive the previously stored APN Rate Control\nStatus and, if the first APN Rate Control validity period has not expired,\nit applies the received APN Rate Control Status and provides the related\nparameters to the UE in the PCO (instead of the configured APN Rate Control\nparameters). If the initially applied parameters differ from the configured\nAPN Rate Control parameters, the PDN GW/SCEF uses the configured APN Rate\nControl parameters once the first APN Rate Control validity period expires,\nand sends an update to the UE with the configured APN Rate Control\nparameters.\n\n  NOTE\u00c2\u00a02:  The storage of the APN Rate Control Status information for very\n         long time intervals can be implementation specific.\n\nThe PDN GW or SCEF realises the APN rate control based on a 'maximum\nallowed rate' per direction. If PDN GW or SCEF provided the 'number of\nadditional allowed exception report packets per time unit' to the UE, then\nthe 'maximum allowed rate' is equal to the 'number of packets per time\nunit' plus the 'number of additional allowed exception report packets per\ntime unit'. Otherwise, the 'maximum allowed rate' is equal to the 'number\nof packets per time unit'.\n\n  NOTE\u00c2\u00a03:  Pre-Rel-14 UEs understand only the 'number of packets per time\n         unit', and, if an indication that exception reports are allowed has\n         been sent to such UEs, there is a risk that exception report\n         packets are discarded by the PDN GW or SCEF. To overcome this\n         problem, the PDN GW or SCEF can still apply a configured 'number of\n         additional allowed exception report packets per time unit' even\n         though not sent to pre-Rel-14 UEs.\n\nThe PDN GW or SCEF may enforce the uplink rate by discarding or delaying\npackets that exceed the 'maximum allowed rate'. The PDN GW or SCEF shall\nenforce the downlink rate by discarding or delaying packets that exceed the\ndownlink part of the 'maximum allowed rate'.\n\n  NOTE\u00c2\u00a04:  It is assumed that the Serving PLMN Rate is sufficiently high to\n         not interfere with the APN Rate Control as the APN Rate Control, if\n         used, is assumed to allow fewer messages. NAS PDUs related to\n         exception reports are not subject to the Serving PLMN Rate Control.\n\n\n"}, {"key": "Inter-UE QoS for NB-IoT UEs using Control Plane CIoT EPS", "numbering": "4.7.8", "title_level": 2, "desc": "4.7.8  Inter-UE QoS for NB-IoT UEs using Control Plane CIoT EPS\n         Optimisation\n\nTo allow the E-UTRAN to prioritise resource allocation between different NB-\nIoT UEs when some of the UEs are using the Control Plane CIoT EPS\nOptimisation, the eNB may request, based on configuration, the MME to\nsupply the eNB with the negotiated QoS profile for any UE that is using the\nControl Plane CIoT EPS Optimisation.\n\nThe QoS profile sent to the eNB by the MME consists of the E-RAB Level QoS\nParameter in the E-RAB to be Setup List IE (see TS\u00c2\u00a036.413\u00c2\u00a0[36]).\n\nIn order to reduce signalling load on the MME, the eNB may be configured to\nrequest the QoS profile from the MME by using the UE's S-TMSI as\nidentifier, e.g., when the eNB's NB-IoT load exceeds certain threshold(s)\nor when the eNB needs to cache the QoS profile.\n\nIf the UE has more than one EPS bearer active, the MME sends QoS profile\nfor only one EPS bearer to the eNB. In this case the MME uses local\nconfiguration (e.g. considering table 6.1.7 in TS\u00c2\u00a023.203\u00c2\u00a0[6], the MME\nchooses the non-GBR EPS bearer with the QCI corresponding to the highest\nPriority Level) to determine which EPS bearer's QoS to send to the eNB. If\nthe MME has no EPS bearers active for the UE, then this fact is indicated\nto the eNB.\n\nThe eNB can use the QoS profile to assist with resource prioritisation\ndecisions between different NB-IoT UEs (irrespective of whether the UE/eNB\nis using the Control Plane CIoT EPS Optimisation, or, the User Plane CIoT\nEPS Optimisation).\n\n\n"}, {"key": "Compatibility Issues", "numbering": "4.8", "title_level": 1, "desc": "4.8  Compatibility Issues\n\n\n"}, {"key": "Network Configuration for Interaction with UTRAN/GERAN", "numbering": "4.8.1", "title_level": 2, "desc": "4.8.1  Network Configuration for Interaction with UTRAN/GERAN\n\nGPRS idle mode mobility within GERAN or UTRAN and also between GERAN and\nUTRAN specifies a set of sequence number handling functions, e.g. the\nexchange of sequence numbers during Routing Area Update procedures. EPS\nidle mode mobility procedures don't specify any such sequence number\nmappings for IRAT mobility scenarios. To avoid interoperation issues a\nnetwork that deploys E-UTRAN together with GERAN and/or UTRAN shall not\nconfigure usage of the GPRS feature \"reordering required\" for PDP contexts\nof PDP type IPv4, IPv6 or IPv4v6. Also the network shall not configure\nusage of lossless PDCP of UTRAN and the GERAN SGSN shall not configure\nusage of acknowledged mode LLC/NSAPI/SNDCP.\n\n\n"}, {"key": "Paging Policy Differentiation", "numbering": "4.9", "title_level": 1, "desc": "4.9  Paging Policy Differentiation\n\nPaging policy differentiation is an optional feature that allows the MME,\nbased on operator configuration, to apply different paging strategies as\ndefined in clause\u00c2\u00a05.3.4.3 for different traffic or service types provided\nwithin the same PDN connection.\n\nWhen it supports Paging Policy Differentiation feature, the Serving GW\nprovides a Paging Policy Indication in the Downlink Data Notification. The\nPaging Policy Indication is based on information received with the downlink\npacket that triggers the Downlink Data Notification. For example, as\ndefined in TS\u00c2\u00a023.228\u00c2\u00a0[52], the P-CSCF may support Paging Policy\nDifferentiation by marking packet(s) to be sent towards the UE that relate\nto specific IMS services (e.g. conversational voice as defined in IMS\nmultimedia telephony service).\n\nThe PDN GW shall not modify the received downlink IP packet e.g. the DSCP\n(IPv4) / TC (IPv6). Unconditionally, for each bearer and for each packet of\nPDN type IPv4, IPv6 or IPv4v6 that triggers a Downlink Data Notification,\nthe SGW shall send the DSCP in TOS (IPv4) / TC (IPv6) information received\nin the IP payload of the GTP-U packet from the PDN GW in the Paging Policy\nIndication in the Downlink Data Notification.\n\nIt shall be possible for the operator to configure the MME in such a way\nthat the Paging Policy Indicator only applies to certain HPLMNs and/or APNs\nand/or QCIs.\n\n  NOTE\u00c2\u00a01:  Network configuration needs to ensure that the information used\n         as a trigger for Paging Policy Indication is not changed within the\n         EPS.\n\n  NOTE\u00c2\u00a02:  Network configuration needs to ensure that the specific DSCP in\n         TOS (IPv4) / TC (IPv6) value, used as a trigger for Paging Policy\n         Indication, is managed correctly in order to avoid the accidental\n         use of certain paging policies.\n\n\n"}, {"key": "Introduction of CIoT EPS Optimisations", "numbering": "4.10", "title_level": 1, "desc": "4.10 Introduction of CIoT EPS Optimisations\n\nCIoT EPS Optimisations provide improved support of small data transfer. One\noptimisation is based on User Plane transport of user data and is referred\nto as User Plane CIoT EPS Optimisation. Another optimisation, known as\nControl Plane CIoT EPS Optimisation, transports user data or SMS messages\nvia MME by encapsulating them in NAS, reducing the total number of control\nplane messages when handling a short data transaction. For EPC Mobile\nOriginated Location Request (EPC-MO-LR) and EPC Mobile Terminated Location\nRequest (EPC-MT-LR) when the UE and network support Control Plane CIoT EPS\nOptimisation, Control Plane Service Request is used. These optimisations\ncan be used separately e.g. if the UE or the network supports one of them,\nor in parallel if the UE and the network supports both. If both the Control\nPlane and User Plane CIoT EPS Optimisations are supported for a UE, the PDN\nconnections that only use the Control Plane CIoT EPS Optimisation, i.e. the\nMME has included Control Plane Only Indicator in the ESM request, will only\nbe handled via the Control Plane CIoT EPS Optimisation. All other PDN\nconnections are handled using Control Plane or User Plane CIoT EPS\nOptimisations. In addition, the Control Plane CIoT Optimisation can be used\nto support PDN connections to an SCEF, while regular S1-U data transfer is\nused independently to support PDN connections to P-GW. The MME shall\nconsistently include Control Plane Only Indicator either in all SGi PDN\nconnections of a UE or in none of them. All the SGi PDN connections of a UE\nshall either use S11-U or S1-U at any point in time.\n\nThe CIoT data could include e.g. status information, measurement data from\nMachine-to-Machine applications.\n\nSeveral types of MME are envisaged, e.g.\n\n  -  an MME that supports either User Plane or Control Plane CIoT EPS\n    Optimisation;\n\n  -  an MME that supports both User Plane and Control Plane CIoT EPS\n    Optimisations;\n\n  -  an MME that does not support any CIoT EPS Optimisations.\n\nThe E-UTRAN shall support the routeing of UEs to an MME that can process\nthe request from the UE.\n\nThe CIoT EPS Optimisations are negotiated as described in clause\u00c2\u00a04.3.5.10\n\"Preferred and Supported Network Behaviour\".\n\nCIoT EPS Optimisations may be supported also by UEs that are not limited to\nlow complexity and low throughput applications for Machine Type\nCommunications.\n\nIf Control Plane CIoT EPS Optimisation applies, separation of S11-U from S1-\nU may be required, and if required, the MME and the Serving GW shall handle\nthe IP address and TEID for the S1-U and the address and TEID for the S11-U\nseparately.\n\n  NOTE:  Homogeneous support of separation of S11-U from S1-U in the MMEs\n         and Serving GWs is assumed.\n\n\n"}, {"key": "User Plane CIoT EPS Optimisation", "numbering": "4.11", "title_level": 1, "desc": ""}, {"key": "Supporting up to  EPS bearers per UE", "numbering": "4.12", "title_level": 1, "desc": "4.11 User Plane CIoT EPS Optimisation\n\nThe User Plane CIoT EPS Optimisation functionality enables support for\ntransfer of user plane data without the need for using the Service Request\nprocedure to establish Access Stratum (AS) context in the serving eNodeB\nand UE.\n\nIf the following preconditions are met:\n\n  -  UE and MME support User Plane CIOT EPS Optimisation as defined in\n    clause\u00c2\u00a04.3.5.10,\n\n  -  MME indicates \"UE User Plane CIoT Support Indicator\" IE to \"supported\"\n    as defined in TS\u00c2\u00a036.413\u00c2\u00a0[36],\n\n  -  and the UE performs an initial connection establishment that\n    establishes the AS bearers and the AS security context in the network\n    and UE,\n\nthen the RRC connection can be suspended by means of a Connection Suspend\nProcedure (see clause\u00c2\u00a05.3.4A).\n\nBased on trigger from the NAS layer when UE is in ECM-IDLE including if it\nattempts to send data using Control Plane CIoT EPS Optimisation as defined\nin clause\u00c2\u00a05.3.4B, the UE shall attempt the Connection Resume procedure, see\nclause\u00c2\u00a05.3.5A and TS\u00c2\u00a024.301\u00c2\u00a0[46]. If the Connection Resume procedure fails,\nthe UE initiates the pending NAS procedure, see TS\u00c2\u00a024.301\u00c2\u00a0[46]. To maintain\nsupport for User Plane CIoT EPS Optimisation at UE mobility between cells\nconfigured on different eNodeBs, the AS Context should be transferred\nbetween the eNodeBs, see TS\u00c2\u00a036.300\u00c2\u00a0[5] and TS\u00c2\u00a036.423\u00c2\u00a0[76].\n\nBy using the Connection Suspend procedure, see clause\u00c2\u00a05.3.5A and\nTS\u00c2\u00a036.300\u00c2\u00a0[5]:\n\n  -  the UE at transition into ECM-IDLE stores the AS information;\n\n  -  the eNodeB stores the AS information, the S1AP association and the\n    bearer context for that UE;\n\n  -  MME stores the S1AP association and the bearer context for that UE and\n    enters ECM-IDLE.\n\nIn the context of this functionality, the UE and the eNodeB store the\nrelevant AS information at transition into ECM-IDLE.\n\nBy using the Connection Resume procedure, see clause\u00c2\u00a05.3.5A and\nTS\u00c2\u00a036.300\u00c2\u00a0[5]:\n\n  -  the UE resumes the connection with the network using the AS\n    information stored during the Connection Suspend procedure;\n\n  -  the, potentially new, eNodeB notifies the MME that the connection with\n    the UE has been securely resumed and the MME enters ECM-CONNECTED.\n\nIf a MME has a S1AP association stored for a UE and the MME receives for\nthat UE a EMM procedure over another UE-associated logical S1-connection or\nat Tracking Area Update procedure with MME change, or SGSN Context Request,\nwhen the UE has re-attached, or when the UE has been Detached, the MME and\nthe previously involved eNodeB shall delete that stored S1AP association\nusing the S1 Release procedure, see clause\u00c2\u00a05.3.5 and TS\u00c2\u00a036.413\u00c2\u00a0[36].\n\n\n4.12 Supporting up to 15 EPS bearers per UE\n\nA UE attached to WB-E-UTRAN access, including for dual connectivity using E-\nUTRAN access as described in clause\u00c2\u00a04.3.2a, may support 8 or 15 EPS\nbearers. To enable support of establishing 15 EPS bearers, it requires the\nEPC connected to the E-UTRAN access to support 15 EPS bearers for such UEs.\n\nIf the UE supports 15 EPS bearers, then the UE shall indicate this to the\nMME in NAS signalling as defined in TS\u00c2\u00a024.301\u00c2\u00a0[46].\n\nThe network shall support E-UTRAN idle mode mobility and handover\nprocedures in such PLMNs, where only part of the network nodes have been\nupgraded to support 15 EPS bearers. In case of mobility procedures\ninvolving target nodes not supporting 15 EPS bearers, additional bearers\nnot supported by the non-upgraded nodes should be thus released.\n\nThe network shall homogeneously support 15 EPS bearers per UE, at least per\nMME pool area/SGW serving area, in order to avoid EPS bearer deactivations\nand attempts from services to re-activate the deactivated EPS bearers\ncaused by UE mobility within that area, by defining the tracking areas\naccordingly (see clause\u00c2\u00a04.3.5.3).\n\nThe MME shall provide the UE with a TAI List such that it triggers the UE\nto perform the TAU procedure, as defined in clause\u00c2\u00a05.3.3.0, when the UE\nenters and exits the area with support for 15 EPS bearers per UE. The TAU\nprocedure execution enables the nodes in the supporting area to identify a\nsupporting UE when it enters the area. When exiting the area, also enables\nthe nodes to remove bearer resources for the UE towards nodes without\nsupport for 15 EPS bearers per UE.\n\n  NOTE\u00c2\u00a01:  In order for the above TAI List handling to be fully successful,\n         the network requires the PGWs the UE is connected to from these MME\n         pool area/SGW serving area to be upgaded to support 15 EPS bearers.\n\nFor a UE supporting 15 EPS bearers, mobility to UTRAN or GERAN may also\nlead to selective release of EPS bearers, due to the lack of support of 15\nPDP contexts in the GPRS core network and Radio Access networks.\n\n  NOTE\u00c2\u00a02:  EPS bearers need to be released either because the UE has more\n         than 8 active EPS bearers, or because they are identified by EPS\n         Bearer Identities not supported.\n\nIn order to minimize the impact from release of bearers not supported by\nthe target nodes during mobility, the MME should be able to allocate the\nEPS bearer IDs in such way that the bearers with higher operator preference\nwill be preserved in case of mobility involving legacy target nodes. This\nprioritised bearer allocation should be based on, at least, the Allocation\nRetention Priority of the EPS bearers and may take other bearer parameters\n(e.g. QCI, APN) into consideration.\n\nAll PDN GWs in a PLMN shall support 15 EPS bearers. MME may be configured\nto take into account additional PDN GW information such as whether the\nHPLMN supports 15 EPS bearers when selecting PDN GW (e.g. in case of\nroaming users Home Routed PDN GW selection) for UEs supporting 15 EPS\nbearers.\n\nFor inter-PLMN handover, support of 15 EPS bearers is based on MME\nconfiguration according to operator policy (e.g. bilateral agreements\nbetween operators).\n\n\n"}, {"key": "Functional description and information flows", "numbering": "5", "title_level": 0, "desc": "5  Functional description and information flows\n\n\n"}, {"key": "Control and user planes", "numbering": "5.1", "title_level": 1, "desc": "5.1  Control and user planes\n\n\n"}, {"key": "General", "numbering": "5.1.0", "title_level": 2, "desc": "5.1.0  General\n\n  NOTE:\n\n       -  Refer to TS\u00c2\u00a023.402\u00c2\u00a0[2] for the corresponding protocol stack for\n         PMIP based S5/S8.\n\n       -  Refer to TS\u00c2\u00a023.203\u00c2\u00a0[6] for the corresponding protocol stack for\n         Policy Control and Charging (PCC) function related reference\n         points.\n\n\n"}, {"key": "Control Plane", "numbering": "5.1.1", "title_level": 2, "desc": "5.1.1  Control Plane\n\n\n"}, {"key": "General", "numbering": "5.1.1.1", "title_level": 3, "desc": "5.1.1.1  General\n\nThe control plane consists of protocols for control and support of the user\nplane functions:\n\n  -  controlling the E-UTRA network access connections, such as attaching\n    to and detaching from E-UTRAN;\n\n  -  controlling the attributes of an established network access\n    connection, such as activation of an IP address;\n\n  -  controlling the routing path of an established network connection in\n    order to support user mobility; and\n\n  -  controlling the assignment of network resources to meet changing user\n    demands.\n\nThe following control planes are used in E-UTRAN mode.\n\n\n"}, {"key": "eNodeB - MME", "numbering": "5.1.1.2", "title_level": 3, "desc": "5.1.1.2  eNodeB - MME\n\n                                    [pic]\n\n  Legend:\n  -  S1 Application Protocol (S1-AP): Application Layer Protocol between\n         the eNodeB and the MME.\n  -  Stream Control Transmission Protocol (SCTP): This protocol guarantees\n         delivery of signalling messages between MME and eNodeB (S1). SCTP\n         is defined in RFC\u00c2\u00a04960\u00c2\u00a0[35].\n\n\n            Figure 5.1.1.2-1: Control Plane for S1-MME Interface\n\n  NOTE:  Refer to TS\u00c2\u00a036.300\u00c2\u00a0[5] for the corresponding control plane for the\n         HeNB Subsystem - MME.\n\n\n"}, {"key": "UE - MME", "numbering": "5.1.1.3", "title_level": 3, "desc": "5.1.1.3  UE - MME\n\n                                    [pic]\n\n  Legend:\n  -  NAS: The NAS protocol supports mobility management functionality and\n         user plane bearer activation, modification and deactivation. It is\n         also responsible of ciphering and integrity protection of NAS\n         signalling.\n  -  LTE-Uu: The radio protocol of E-UTRAN between the UE and the eNodeB is\n         specified in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n\n                  Figure 5.1.1.3-1: Control Plane UE - MME\n\n\n"}, {"key": "SGSN - MME", "numbering": "5.1.1.4", "title_level": 3, "desc": "5.1.1.4  SGSN - MME\n\n                                    [pic]\n\n  Legend:\n  -  GPRS Tunnelling Protocol for the control plane (GTP-C): This protocol\n         tunnels signalling messages between SGSN and MME (S3).\n  -  User Datagram Protocol (UDP): This protocol transfers signalling\n         messages. UDP is defined in RFC\u00c2\u00a0768\u00c2\u00a0[26].\n\n\n              Figure 5.1.1.4-1: Control Plane for S3 Interface\n\n\n"}, {"key": "SGSN - S-GW", "numbering": "5.1.1.5", "title_level": 3, "desc": "5.1.1.5  SGSN - S-GW\n\n                                    [pic]\n\n  Legend:\n  -  GPRS Tunnelling Protocol for the control plane (GTP-C): This protocol\n         tunnels signalling messages between SGSN and S-GW (S4).\n  -  User Datagram Protocol (UDP): This protocol transfers signalling\n         messages. UDP is defined in RFC\u00c2\u00a0768\u00c2\u00a0[26].\n\n\n              Figure 5.1.1.5-1: Control Plane for S4 interface\n\n\n"}, {"key": "S-GW - P-GW", "numbering": "5.1.1.6", "title_level": 3, "desc": "5.1.1.6  S-GW - P-GW\n\n                                    [pic]\n\n  Legend:\n  -  GPRS Tunnelling Protocol for the control plane (GTP-C): This protocol\n         tunnels signalling messages between S-GW and P-GW (S5 or S8).\n  -  User Datagram Protocol (UDP): This protocol transfers signalling\n         messages between S-GW and P-GW. UDP is defined in RFC\u00c2\u00a0768\u00c2\u00a0[26].\n\n\n          Figure 5.1.1.6-1: Control Plane for S5 and S8 interfaces\n\n\n"}, {"key": "MME - MME", "numbering": "5.1.1.7", "title_level": 3, "desc": "5.1.1.7  MME - MME\n\n                                    [pic]\n\n  Legend:\n  -  GPRS Tunnelling Protocol for the control plane (GTP-C): This protocol\n         tunnels signalling messages between MMEs (S10).\n  -  User Datagram Protocol (UDP): This protocol transfers signalling\n         messages between MMEs. UDP is defined in RFC\u00c2\u00a0768\u00c2\u00a0[26].\n\n\n              Figure 5.1.1.7-1: Control Plane for S10 interface\n\n\n"}, {"key": "MME - S-GW", "numbering": "5.1.1.8", "title_level": 3, "desc": "5.1.1.8  MME - S-GW\n\n                                    [pic]\n\n  Legend:\n  -  GPRS Tunnelling Protocol for the control plane (GTP-C): This protocol\n         tunnels signalling messages between MME and S-GW (S11).\n  -  User Datagram Protocol (UDP): This protocol transfers signalling\n         messages. UDP is defined in RFC\u00c2\u00a0768\u00c2\u00a0[26].\n\n\n              Figure 5.1.1.8-1: Control Plane for S11 interface\n\n\n"}, {"key": "MME - HSS", "numbering": "5.1.1.9", "title_level": 3, "desc": "5.1.1.9  MME - HSS\n\n                                    [pic]\n\n  Legend:\n  -  Diameter: This protocol supports transferring of subscription and\n         authentication data for authenticating/authorizing user access to\n         the evolved system between MME and HSS (S6a). Diameter is defined\n         in RFC\u00c2\u00a03588\u00c2\u00a0[31].\n  -  Stream Control Transmission Protocol (SCTP): This protocol transfers\n         signalling messages. SCTP is defined in RFC\u00c2\u00a04960\u00c2\u00a0[35].\n\n\n              Figure 5.1.1.9-1: Control Plane for S6a interface\n\n\n"}, {"key": "MME - EIR", "numbering": "5.1.1.10", "title_level": 3, "desc": "5.1.1.10 MME - EIR\n\n                                    [pic]\n\n  Legend:\n  -  Diameter: This protocol supports UE identity check procedure between\n         MME and EIR (S13). Diameter is defined in RFC\u00c2\u00a03588\u00c2\u00a0[31].\n  -  Stream Control Transmission Protocol (SCTP): This protocol transfers\n         signalling messages. SCTP is defined in RFC\u00c2\u00a04960\u00c2\u00a0[35].\n\n\n             Figure 5.1.1.10-1: Control Plane for S13 interface\n\n\n"}, {"key": "Void", "numbering": "5.1.1.11", "title_level": 3, "desc": "5.1.1.11 Void\n\n\n\n\n"}, {"key": "MME - CSS", "numbering": "5.1.1.12", "title_level": 3, "desc": "5.1.1.12 MME - CSS\n\n                                    [pic]\n\n  Legend:\n     Diameter: This protocol supports transferring of CSG subscription data\n         for roaming subscribers only between MME and CSS (S7a). Diameter is\n         defined in RFC\u00c2\u00a03588\u00c2\u00a0[31].\n     Stream Control Transmission Protocol (SCTP): This protocol transfers\n         signalling messages. SCTP is defined in RFC\u00c2\u00a04960\u00c2\u00a0[35].\n\n\n             Figure 5.1.1.12-1: Control Plane for S7a interface\n\n\n"}, {"key": "MME - RCAF", "numbering": "5.1.1.13", "title_level": 3, "desc": "5.1.1.13 MME - RCAF\n\n                                    [pic]\n\n  Legend:\n     Nq-AP: This application layer protocol supports the IMSI and APN\n         retrieval procedure between the RCAF and the MME.\n     Stream Control Transmission Protocol (SCTP): This protocol transfers\n         signalling messages. SCTP is defined in RFC\u00c2\u00a04960\u00c2\u00a0[35].\n\n\n              Figure 5.1.1.13-1: Control Plane for Nq interface\n\n\n"}, {"key": "User Plane", "numbering": "5.1.2", "title_level": 2, "desc": "5.1.2  User Plane\n\n\n"}, {"key": "UE - P-GW user plane with E-UTRAN", "numbering": "5.1.2.1", "title_level": 3, "desc": "5.1.2.1  UE - P-GW user plane with E-UTRAN\n\n                                    [pic]\n\n  Legend:\n  -  GPRS Tunnelling Protocol for the user plane (GTP-U): This protocol\n         tunnels user data between eNodeB and the S-GW as well as between\n         the S-GW and the P-GW in the backbone network. GTP shall\n         encapsulate all end user packets. End user Ethernet packets are\n         only used with a combined PDN GW+SMF (as specified in\n         TS\u00c2\u00a023.501\u00c2\u00a0[83]).\n  -  MME controls the user plane tunnel establishment and establishes User\n         Plane Bearers between eNodeB and S-GW.\n  -  UDP/IP: These are the backbone network protocols used for routing user\n         data and control signalling.\n  -  LTE-Uu: The radio protocols of E-UTRAN between the UE and the eNodeB\n         are specified in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n\n                        Figure 5.1.2.1-1: User Plane\n\n\n"}, {"key": "eNodeB - S-GW", "numbering": "5.1.2.2", "title_level": 3, "desc": ""}, {"key": "UE - PDN GW user plane with G access via the S interface", "numbering": "5.1.2.3", "title_level": 3, "desc": ""}, {"key": "UE - PDN GW user plane with G access via the S interface", "numbering": "5.1.2.4", "title_level": 3, "desc": ""}, {"key": "UE - PDN GW user plane with G access via the S interface", "numbering": "5.1.2.5", "title_level": 3, "desc": "5.1.2.2  eNodeB - S-GW\n\n                                    [pic]\n\n  Legend:\n  -  GPRS Tunnelling Protocol for the user plane (GTP-U): This protocol\n         tunnels user data between eNodeB and S-GW.\n  -  User Datagram Protocol (UDP): This protocol transfers user data. UDP\n         is defined in RFC\u00c2\u00a0768\u00c2\u00a0[26].\n\n\n               Figure 5.1.2.2-1: User Plane for eNodeB \u00e2\u20ac\u201c S-GW\n\n  NOTE:  Refer to TS\u00c2\u00a036.300\u00c2\u00a0[5] for the corresponding user plane for the\n         HeNB Subsystem - S-GW.\n\n\n5.1.2.3  UE - PDN GW user plane with 2G access via the S4 interface\n\n                                    [pic]\n\n  Legend:\n  -  GPRS Tunnelling Protocol for the user plane (GTP-U): This protocol\n         tunnels user data between SGSN and the S-GW as well as between the\n         S-GW and the P-GW in the backbone network. GTP shall encapsulate\n         all end user IP packets.\n  -  UDP/IP: These are the backbone network protocols used for routing user\n         data and control signalling.\n  -  Protocols on the Um and the Gb interfaces are described in\n         TS\u00c2\u00a023.060\u00c2\u00a0[7].\n\n\n                 Figure 5.1.2.3-1: User Plane for A/Gb mode\n\n\n5.1.2.4  UE - PDN GW user plane with 3G access via the S12 interface\n\n                                    [pic]\n\n  Legend:\n  -  GPRS Tunnelling Protocol for the user plane (GTP-U): This protocol\n         tunnels user data between UTRAN and the S-GW as well as between the\n         S-GW and the P-GW in the backbone network. GTP shall encapsulate\n         all end user IP packets.\n  -  UDP/IP: These are the backbone network protocols used for routing user\n         data and control signalling.\n  -  Protocols on the Uu interface are described in TS\u00c2\u00a023.060\u00c2\u00a0[7].\n  -  SGSN controls the user plane tunnel establishment and establish a\n         Direct Tunnel between UTRAN and S-GW as shown in Figure\u00c2\u00a05.1.2.4-1.\n\n\n    Figure 5.1.2.4-1: User Plane for UTRAN mode and Direct Tunnel on S12\n\n\n5.1.2.5  UE - PDN GW user plane with 3G access via the S4 interface\n\n                                    [pic]\n\n  NOTE:  Please refer to TS\u00c2\u00a023.402\u00c2\u00a0[2] for the corresponding stack for PMIP\n         based S5/S8.\n\n\n  Legend:\n  -  GPRS Tunnelling Protocol for the user plane (GTP-U): This protocol\n         tunnels user data between UTRAN and the SGSN, between SGSN and S-GW\n         as well as between the S-GW and the P-GW in the backbone network.\n         GTP shall encapsulate all end user IP packets.\n  -  UDP/IP: These are the backbone network protocols used for routing user\n         data and control signalling.\n  -  Protocols on the Uu and the Iu interfaces are described in\n         TS\u00c2\u00a023.060\u00c2\u00a0[7].\n  -  SGSN controls the user plane tunnel establishment and establishes a\n         tunnel between SGSN and S-GW. If Direct Tunnel is established\n         between UTRAN and S-GW, see Figure 5.1.2.4-1.\n\n\n                  Figure 5.1.2.5-1: User Plane for Iu mode\n\n\n"}, {"key": "UE - P-GW user plane with Control Plane CIoT EPS Optimisations", "numbering": "5.1.2.6", "title_level": 3, "desc": "5.1.2.6  UE - P-GW user plane with Control Plane CIoT EPS Optimisations\n\n                                    [pic]\n\n  Legend:\n  -  GTP-u (GPRS Tunnelling Protocol User plane): This protocol tunnels\n         user data between MME and the S-GW as well as between the S-GW and\n         the P-GW in the backbone network. GTP shall encapsulate all end\n         user packets. End user Ethernet packets are only used with a\n         combined PDN GW+SMF (as specified in TS\u00c2\u00a023.501\u00c2\u00a0[83]).\n  -  UDP/IP: These are the backbone network protocols used for routing user\n         data and control signalling.\n  -  NAS: this is the Non Access Stratum Layer used to carry Data between\n         UE and MME and may include Header compression and security\n         functions of user plane IP data. Whether a convergence protocol\n         sublayer may be required for this purpose is a stage 3 matter.\n\n\n   Figure 5.1.2.6-1: User Plane with Control Plane CIoT EPS Optimisations\n\n\n"}, {"key": "Identities", "numbering": "5.2", "title_level": 1, "desc": "5.2  Identities\n\n\n"}, {"key": "EPS bearer identity", "numbering": "5.2.1", "title_level": 2, "desc": "5.2.1  EPS bearer identity\n\nAn EPS bearer identity uniquely identifies an EPS bearer for one UE\naccessing via E-UTRAN. The EPS Bearer Identity is allocated by the MME.\nWhen using an EPS Radio Bearer, there is a one to one mapping between EPS\nRB and EPS Bearer, and the mapping between EPS RB Identity and EPS Bearer\nIdentity is made by E-UTRAN. The E-RAB ID value used at S1 and X2\ninterfaces to identify an E-RAB is the same as the EPS Bearer ID value used\nto identify the associated EPS Bearer. When using Control Plane CIoT EPS\nOptimisation for user data transport for the PDN connectivity service, the\nMME (for uplink) and UE (for downlink) uses the EPS Bearer Identity\ncontained within the NAS PDUs to identify the associated EPS bearer.\n\nWhen there is a mapping between an EPS bearer and a PDP context, the same\nidentity value is used for the EPS bearer ID and the NSAPI/RAB ID.\n\nIn some SM signalling messages in GERAN/UTRAN, transaction identifier (TI)\nrepresents NSAPI. The TI is dynamically allocated by the UE for UE-\nrequested PDP context activation, and by the network for network-requested\nPDP context activation. A corresponding allocation is also needed for EPS\nBearers in order to successfully transfer Bearers to GERAN/UTRAN. The TI is\ndeallocated when a PDP context/EPS Bearer has been deactivated. TI usage is\ndefined in TS\u00c2\u00a023.060\u00c2\u00a0[7].\n\n\n"}, {"key": "Globally Unique Temporary UE Identity", "numbering": "5.2.2", "title_level": 2, "desc": "5.2.2  Globally Unique Temporary UE Identity\n\nThe MME shall allocate a Globally Unique Temporary Identity (GUTI) to the\nUE. The GUTI is defined in TS\u00c2\u00a023.003\u00c2\u00a0[9].\n\n\n"}, {"key": "Tracking Area Identity (TAI)", "numbering": "5.2.3", "title_level": 2, "desc": ""}, {"key": "eNodeB S-AP UE Identity (eNodeB S-AP UE ID)", "numbering": "5.2.4", "title_level": 2, "desc": ""}, {"key": "MME S-AP UE Identity (MME S-AP UE ID)", "numbering": "5.2.5", "title_level": 2, "desc": "5.2.3  Tracking Area Identity (TAI)\n\nThis is the identity used to identify tracking areas. The Tracking Area\nIdentity is constructed from the MCC (Mobile Country Code), MNC (Mobile\nNetwork Code) and TAC (Tracking Area Code).\n\nA TAI should be associated with a single time zone. All TAIs served by one\neNodeB shall be in the same time zone.\n\n  NOTE:  Changes in the TAI of a cell can occur but are normally infrequent\n         and linked with O+M activity.\n\n\n5.2.4  eNodeB S1-AP UE Identity (eNodeB S1-AP UE ID)\n\nThis is the temporary identity used to identify a UE on the S1-MME\nreference point within the eNodeB. It is unique within the eNodeB.\n\n\n5.2.5  MME S1-AP UE Identity (MME S1-AP UE ID)\n\nThis is the temporary identity used to identify a UE on the S1-MME\nreference point within the MME. It is unique within the MME.\n\n\n"}, {"key": "Closed Subscriber Group ID", "numbering": "5.2.6", "title_level": 2, "desc": "5.2.6  Closed Subscriber Group ID\n\nA CSG ID is a unique identifier within the scope of PLMN defined in\nTS\u00c2\u00a023.003\u00c2\u00a0[9] which identifies a Closed Subscriber Group (CSG) in the PLMN\nassociated with a CSG cell or group of CSG cells.\n\n\n"}, {"key": "UE Radio Capability identity", "numbering": "5.2.7", "title_level": 2, "desc": "5.2.7  UE Radio Capability identity\n\nThe UE Radio Capability ID is a short pointer with format defined in\nTS\u00c2\u00a023.003\u00c2\u00a0[9] that is used to uniquely identify a set of UE Radio\nCapabilities. The UE Radio Capability ID is assigned either by the serving\nPLMN or by the UE manufacturer, as follows:\n\n  -  Manufacturer-assigned: The UE Radio Capability ID may be assigned by\n    the UE manufacturer in which case it is accompanied with the UE\n    manufacturer information (e.g. TAC field in the IMEI). In this case,\n    the UE Radio Capability ID uniquely identifies a set of UE Radio\n    Capabilities for this manufacturer, and together with this UE\n    manufacturer information uniquely identify this set of UE Radio\n    Capabilities in any PLMN.\n\n  -  PLMN-assigned: If a manufacturer-assigned UE Radio Capability ID is\n    not used by the UE or the serving network, or it is not recognised by\n    the serving PLMN UCMF, the UCMF may allocate UE Radio Capability IDs\n    for the UE corresponding to different sets of UE Radio capabilities the\n    PLMN may receive from the UE at different times. In this case, the UE\n    Radio Capability IDs the UE receives are applicable to the serving PLMN\n    and uniquely identify the corresponding sets of UE Radio Capabilities\n    in this PLMN.\n\nThe type of UE Radio Capability ID (Manufacturer-assigned or PLMN-assigned)\nis distinguished when a UE Radio Capability ID is signalled.\n\n\n"}, {"key": "Authentication, security and location management", "numbering": "5.3", "title_level": 1, "desc": "5.3  Authentication, security and location management\n\n\n"}, {"key": "IP address allocation", "numbering": "5.3.1", "title_level": 2, "desc": "5.3.1  IP address allocation\n\n\n"}, {"key": "General", "numbering": "5.3.1.1", "title_level": 3, "desc": "5.3.1.1  General\n\nThe procedures of clause\u00c2\u00a05.3.1 apply to UEs activating a PDN connection of\nPDN Type IPv4, IPv6 or IPv4v6. Part of it also applies for PDN Type Non-IP\nwhen SGi PtP Tunnelling based on UDP/IP, see clause\u00c2\u00a04.3.17.8, is used. The\nprocedures of clause\u00c2\u00a05.3.1 do not apply to UEs activating a PDN connection\nof PDN Type Ethernet.\n\nA UE shall perform the address allocation procedures for at least one IP\naddress (either IPv4 address or IPv6 prefix) after the default bearer\nactivation if no IPv4 address is allocated during the default bearer\nactivation.\n\nOne of the following ways shall be used to allocate IP addresses for the\nUE:\n\n  a) The HPLMN allocates the IP address to the UE when the default bearer\n    is activated (dynamic or static HPLMN address);\n\n  b) The VPLMN allocates the IP address to the UE when the default bearer\n    is activated (dynamic VPLMN address); or\n\n  c) The PDN operator or administrator allocates an (dynamic or static) IP\n    address to the UE when the default bearer is activated (External PDN\n    Address Allocation).\n\nThe IP address allocated for the default bearer shall also be used for the\ndedicated bearers within the same PDN connection. IP address allocation for\nPDN connections, which are activated by the UE requested PDN connectivity\nprocedure, is handled with the same set of mechanisms as those used within\nthe Attach procedure.\n\nPDN types IPv4, IPv6 and IPv4v6 are supported. An EPS Bearer of PDN type\nIPv4v6 may be associated with one IPv6 prefix only or with both one IPv4\naddress and one IPv6 prefix. PDN type IPv4 is associated with an IPv4\naddress. PDN type IPv6 is associated with an IPv6 prefix. PDN types IPv4\nand IPv6 are utilised for the UE and/or the PDN GW support IPv4 addressing\nonly or IPv6 prefix only; or operator preferences dictate the use of a\nsingle IP version only, or the subscription is limited to IPv4 only or IPv6\nonly for this APN. In addition, PDN type IPv4 and IPv6 are utilised for\ninterworking with nodes of earlier releases.\n\nThe way that the UE sets the requested PDN type may be pre-configured in\nthe device per APN. Unless otherwise configured (including when the UE does\nnot send any APN), the UE sets the PDN type during the Attach or PDN\nConnectivity procedures based on its IP stack configuration as follows:\n\n  -  A UE which is IPv6 and IPv4 capable shall request for PDN type IPv4v6.\n\n  -  A UE which is only IPv4 capable shall request for PDN type IPv4.\n\n  -  A UE which is only IPv6 capable shall request for PDN type IPv6.\n\n  -  When the IP version capability of the UE is unknown in the UE (as in\n    the case when the MT and TE are separated and the capability of the TE\n    is not known in the MT), the UE shall request for PDN type IPv4v6.\n\n  NOTE\u00c2\u00a01:  At intersystem changes between GERAN/UTRAN and E-UTRAN there is\n         a 1-to-1 mapping between PDP type IPv4v6 and PDN type IPv4v6\n         without re-negotiation of the PDP/PDN type used for a PDN\n         connection.\n\nThe HSS stores one or more PDN types per APN in the subscription data.\nDuring the Attach or UE requested PDN connectivity procedure the MME\ncompares the requested PDN type to the PDN type in the subscription records\nfor the given APN and sets the PDN type as follows:\n\n  -  If the requested PDN type is allowed by subscription, the MME sets the\n    PDN type as requested.\n\n  -  If the requested PDN type is IPv4v6 and subscription data only allows\n    PDN type IPv4 or only allows PDN type IPv6, the MME sets the PDN type\n    according to the subscribed value. A reason cause shall be returned to\n    the UE indicating that only the assigned PDN type is allowed. In this\n    case the UE shall not request another PDN connection to the same APN\n    for the other IP version during the existence of the PDN connection.\n\n  -  If the requested PDN type is IPv4 or IPv6, and either the requested\n    PDN type or PDN type IPv4v6 are subscribed, the MME sets the PDN type\n    as requested. Otherwis the PDN connection request is rejected.\n\n  -  If the requested PDN type is IPv4v6, and both IPv4 and IPv6 PDN types\n    are allowed by subscription but not IPv4v6, the MME shall set the PDN\n    type to IPv4 or IPv6 where the selection between IPv4 and IPv6 is\n    implementation specific. The UE should then initiate the UE requested\n    PDN connectivity procedure to this APN in order to activate a second\n    PDN connection with the other single address PDN type which was not\n    allocated by the network.\n\n  NOTE\u00c2\u00a02:  If the MT and TE are separated, the UE might not be able to use\n         reason cause \"single address bearers only\" as a trigger for\n         activating a second single-stack EPS bearer.\n\nThe PDN GW may restrict the usage of a PDN type IPv4v6 as follows.\n\n  -  If the PDN GW receives a request for PDN type IPv4v6, but the PDN GW\n    operator preferences dictate the use of IPv4 addressing only or IPv6\n    prefix only for this APN, the PDN type shall be changed to a single\n    address PDN type (IPv4 or IPv6) and a reason cause shall be returned to\n    the UE indicating that only the assigned PDN type is allowed. In this\n    case the UE shall not request another PDN connection to the same APN\n    for the other IP version during the existence of the PDN connection.\n\n  -  If the PDN GW receives a request for PDN type IPv4v6, but the MME does\n    not set the Dual Address Bearer Flag due to the MME operator using\n    single addressing per bearer to support interworking with nodes of\n    earlier releases the PDN type shall be changed to a single IP version\n    only and a reason cause shall be returned to the UE indicating that\n    only single IP version per PDN connection is allowed. In this case the\n    UE should request another PDN connection for the other IP version using\n    the UE requested PDN connectivity procedure to the same APN with a\n    single address PDN type (IPv4 or IPv6) other than the one already\n    activated.\n\nDuring inter-RAT mobility between E-UTRAN and UTRAN/GERAN, an EPS bearer\nwith PDN type IPv4v6 shall be mapped one-to-one to PDP type IPv4v6.\n\nDuring inter-RAT mobility between E-UTRAN and UTRAN/GERAN, an EPS bearer\nwith PDN type IPv4 shall be mapped one-to-one to a PDP context of PDP type\nIPv4. An EPS bearer with PDN type IPv6 shall be mapped one-to-one to a PDP\ncontext of PDP type IPv6.\n\nIt is the HPLMN operator that shall define in the subscription whether a\ndynamic HPLMN or VPLMN address may be used.\n\nThe EPS UE may indicate to the network within the Protocol Configuration\nOptions element that the UE wants to obtain the IPv4 address with DHCPv4,\nwhich is a deferred IPv4 address allocation option, or during the default\nbearer activation procedure. This implies the following behaviour both for\nstatic and dynamic address allocation:\n\n  -  the UE may indicate that it prefers to obtain an IPv4 address as part\n    of the default bearer activation procedure. In such a case, the UE\n    relies on the EPS network to provide IPv4 address to the UE as part of\n    the default bearer activation procedure.\n\n  -  the UE may indicate that it prefers to obtain the IPv4 address after\n    the default bearer setup by DHCPv4. That is, when the EPS network\n    supports DHCPv4 and allows that, it does not provide the IPv4 address\n    for the UE as part of the default bearer activation procedures. The\n    network may respond to the UE by setting the PDN Address to 0.0.0.0.\n    After the default bearer establishment procedure is completed, the UE\n    uses the connectivity with the EPS and initiates the IPv4 address\n    allocation on its own using DHCPv4. However, if the EPS network\n    provides IPv4 address to the UE as part of the default bearer\n    activation procedure, the UE should accept the IPv4 address indicated\n    in the default bearer activation procedure.\n\n  -  if the UE sends no Address Allocation Preference, the PDN GW\n    determines whether DHCPv4 is used between the UE and the PDN GW (for\n    the deferred IPv4 address allocation) or not, based on per APN\n    configuration\n\nBoth EPS network elements and UE shall support the following mechanisms:\n\n  a. IPv4 address allocation via default bearer activation, if IPv4 is\n    supported.\n\n  b. /64 IPv6 prefix allocation via IPv6 Stateless Address\n    autoconfiguration according to RFC\u00c2\u00a04862\u00c2\u00a0[18], if IPv6 is supported;\n\nFurthermore, the Protocol Configuration Options may be used during bearer\nactivation to configure parameters which are needed for IP address\nallocation.\n\nBoth EPS network elements and UE may support the following mechanisms:\n\n  a. IPv4 address allocation and IPv4 parameter configuration after the\n    attach procedure via DHCPv4 according to RFC\u00c2\u00a02131\u00c2\u00a0[19] and\n    RFC\u00c2\u00a04039\u00c2\u00a0[25];\n\n  b. IPv6 parameter configuration via Stateless DHCPv6 according to\n    RFC\u00c2\u00a03736\u00c2\u00a0[20].\n\n  c. Allocation of IPv6 prefixes using DHCPv6 according to RFC\u00c2\u00a03633\u00c2\u00a0[21].\n\nEPS network elements may support the following mechanism:\n\n  a. Allocation of a static IPv4 address and/or a static IPv6 prefix based\n    on subscription data in the HSS.\n\nIf the static IP address/prefix is not stored in the HSS subscription\nrecord, it may be configured on a per-user per-APN basis in the\nDHCP/Radius/Diameter server and the PDN GW retrieves the IP address/prefix\nfor the UE from the DHCP/Radius/Diameter server. In this case, static IP\naddress/prefix is allocated by the same procedures as the dynamic IP\naddress/prefix allocation (i.e. in such cases it is transparent to the PDN\nGW if the IP address is static or dynamic).\n\nIf the static IP address/prefix is stored in the HSS subscription record,\nduring the default bearer establishment the PDN GW receives this static IP\naddress/prefix from Serving GW. In this case the PDN GW shall deliver the\nreceived address/prefix to the UE. The static IP address/prefix is\ndelivered to the UE in the same way as a dynamic IP address/prefix. Thus it\nis transparent to the UE whether the PLMN or the external PDN allocates the\nIP address and whether the IP address is static or dynamic.\n\nThe following clauses describe how the above listed IP address allocation\nmechanisms work when GTP based S5/S8 is used. The way of working of the IP\naddress allocation mechanisms for PMIP based S5/S8 can be found in\nTS\u00c2\u00a023.402\u00c2\u00a0[2].The procedures can be used both for PLMN (VPLMN/HPLMN) or\nexternal PDN based IP address allocation.\n\nIn order to support DHCP based IP address configuration, the PDN GW shall\nact as the DHCP server towards the UE for both HPLMN assigned dynamic and\nstatic IP addressing and for VPLMN assigned dynamic IP addressing. When\nDHCP is used for external PDN assigned addressing and parameter\nconfiguration, the PDN GW shall act as the DHCP server towards the UE and\nit shall act as the DHCP client towards the external DHCP server. The\nServing GW does not have any DHCP functionality. It forwards packets,\nincluding DHCP packets, between the UE and the PDN GW.\n\nIPv6 Stateless Address autoconfiguration specified in RFC\u00c2\u00a04862\u00c2\u00a0[18] is the\nbasic mechanism to allocate /64 IPv6 prefix to the UE.\n\nDuring default bearer establishment, the PDN GW sends the IPv6 prefix and\nInterface Identifier to the S-GW, and then the S-GW forwards the IPv6\nprefix and Interface Identifier to the MME or to the SGSN. The MME or the\nSGSN forwards the IPv6 Interface Identifier to the UE. The MME does not\nforward the IPv6 prefix to the UE. If the UE receives the IPv6 prefix from\nthe SGSN during PDP Context Activation procedure, it shall ignore it.\n\n\n"}, {"key": "IP address allocation, renewal and release mechanisms for GTP", "numbering": "5.3.1.2", "title_level": 3, "desc": ""}, {"key": "IPv address allocation via default bearer activation and", "numbering": "5.3.1.2.1", "title_level": 4, "desc": ""}, {"key": "Allocation, renewal and release of the IPv default prefix via", "numbering": "5.3.1.2.2", "title_level": 4, "desc": ""}, {"key": "IPv parameter configuration via stateless DHCPv", "numbering": "5.3.1.2.3", "title_level": 4, "desc": ""}, {"key": "IPv address allocation, renewal and release and IPv parameter", "numbering": "5.3.1.2.4", "title_level": 4, "desc": "5.3.1.2  IP address allocation, renewal and release mechanisms for GTP\n           based S5/S8\n\n\n5.3.1.2.1   IPv4 address allocation via default bearer activation and\n             release via PDN connection release\n\nAn IPv4 address may be provided to the UE as part of the default bearer\nactivation and the IPv4 address is released when PDN connection associated\nwith the IPv4 address is released.\n\nWhen the PLMN allocates an IPv4 address, it is the PDN\u00c2\u00a0GW responsibility to\nallocate and release the IPv4 address. The PDN GW may use an internal IPv4\naddress pool in this case. The PDN GW allocates an IPv4 address upon\ndefault bearer activation and it releases the IPv4 address upon PDN\nconnection release associated with the IPv4 address for a given UE.\n\n  NOTE:  If the PDN type is IPv4v6, when the PDN Connection is released,\n         the IPv6 address is also released.\n\nWhen an IPv4 address is allocated from an external PDN, it is the PDN GW\nresponsibility to obtain the IPv4 address from the external PDN, and to\nallocate, renew and release the IPv4 address. The PDN GW may use DHCPv4 to\nobtain, renew and release the IPv4 address from the external PDN. If RADIUS\nor Diameter is used towards the external PDN, as described in\nTS\u00c2\u00a029.061\u00c2\u00a0[38], the IP address can be obtained, renewed and released as\npart of these procedures. If DHCPv4 is used, the PDN GW functions as a\nDHCPv4 Client. If RADIUS is used, the PDN GW functions as a RADIUS Client.\nIf Diameter is used, the PDN GW functions as a Diameter Client.\n\nAfter releasing the IPv4 address, the PDN GW should not assign that IPv4\naddress to other user immediately.\n\n\n5.3.1.2.2   Allocation, renewal and release of the IPv6 default prefix via\n             IPv6 stateless address autoconfiguration\n\nWhen the PLMN allocates an IPv6 prefix, it is the PDN GW responsibility to\nallocate and release the IPv6 prefix. The PDN GW may use an internal IPv6\nprefix pool in this case. The PDN GW allocates a globally unique /64 IPv6\nprefix via Router Advertisement to a given UE.\n\nWhen an IPv6 prefix is allocated from an external PDN, it is the PDN GW\nresponsibility to obtain the IPv6 prefix from the external PDN and to\nallocate, renew and release the IPv6 prefix. The PDN GW may use DHCPv6 to\nobtain the IPv6 prefix from the external PDN. In this case, the PDN GW\nfunctions as a DHCPv6 client. If RADIUS or Diameter is used towards the\nexternal PDN as described in TS\u00c2\u00a029.061\u00c2\u00a0[38], the IPv6 prefix can be\nobtained, renewed and released as part of these procedures. If RADIUS is\nused, the PDN GW functions as the RADIUS Client. If Diameter is used, the\nPDN GW functions as the Diameter Client.\n\nThe procedure of stateless IPv6 address autoconfiguration is the following:\nAfter default bearer establishment the UE may send a Router Solicitation\nmessage to the PDN GW to solicit a Router Advertisement message. The PDN\u00c2\u00a0GW\nsends a Router Advertisement message (solicited or unsolicited) to the UE.\nThe Router Advertisement messages shall contain the same IPv6 prefix as the\none provided during default bearer establishment. If the UE receives an\nIPv6 prefix from a SGSN during the PDP Context activation procedure, it\nshall ignore it.\n\nAfter the UE has received the Router Advertisement message, it constructs a\nfull IPv6 address via IPv6 Stateless Address autoconfiguration in\naccordance with RFC\u00c2\u00a04862\u00c2\u00a0[18]. To ensure that the link-local address\ngenerated by the UE does not collide with the link-local address of the PDN\nGW, the PDN GW shall provide an interface identifier (see RFC\u00c2\u00a04862\u00c2\u00a0[18]) to\nthe UE and the UE shall use this interface identifier to configure its link-\nlocal address. For stateless address autoconfiguration however, the UE can\nchoose any interface identifier to generate IPv6 addresses, other than link-\nlocal, without involving the network. However, the UE shall not use any\nidentifiers defined in TS\u00c2\u00a023.003\u00c2\u00a0[9] as the basis for generating the\ninterface identifier. For privacy, the UE may change the interface\nidentifier used to generate full IPv6 address, as defined in TS\u00c2\u00a023.221\u00c2\u00a0[27]\nwithout involving the network.\n\nAny prefix that the PDN GW advertises to the UE is globally unique. The PDN\nGW shall also record the relationship between the UE's identity (IMSI) and\nthe allocated IPv6 prefix. Because any prefix that the PDN GW advertises to\nthe UE is globally unique, there is no need for the UE to perform Duplicate\nAddress Detection for any IPv6 address configured from the allocated IPv6\nprefix. Even if the UE does not need to use Neighbor Solicitation messages\nfor Duplicate Address Detection, the UE may, for example, use them to\nperform Neighbor Unreachability Detection towards the PDN GW, as defined in\nRFC\u00c2\u00a04861\u00c2\u00a0[32]. Therefore, the PDN GW shall respond with a Neighbor\nAdvertisement upon receiving a Neighbor Solicitation message from the UE.\n\nIn order to renew the allocated IPv6 prefix, the PDN GW sends a Router\nAdvertisement (solicited or unsolicited) to the UE with the same prefix and\nnew non-zero values in preferred and valid lifetime fields.\n\nIn order to release the allocated IPv6 prefix, the PDN GW shall initiate\nthe PDN connection release procedure. Upon release of the PDN connection,\nthe UE shall implicitly release the prefix for the corresponding PDN\nconnection.\n\n  NOTE\u00c2\u00a02:  If the PDN type is IPv4v6, when the PDN Connection is released,\n         the IPv4 address is also released.\n\nAfter releasing the IPv6 prefix, the PDN GW should not assign that IPv6\nprefix to other user immediately.\n\n\n5.3.1.2.3   IPv6 parameter configuration via stateless DHCPv6\n\nThe UE may use stateless DHCPv6 for additional parameter configuration. The\nPDN GW acts as the DHCP server. When PLMN based parameter configuration is\nused, the PDN GW provides the requested parameters from locally provisioned\ndatabase. When external PDN based parameter configuration is used, the PDN\nGW obtains the requested configuration parameters from the external PDN as\ndescribed in the previous clauses. When the PDN GW acts as a DHCPv6 server\ntowards the UE, the PDN GW may act as DHCPv6 client towards the external\nPDN to request the configuration parameters for the UE. If RADIUS or\nDiameter is used towards the external PDN as described in TS\u00c2\u00a029.061\u00c2\u00a0[38],\nthe requested configuration parameters can be fetched as part of these\nprocedures.\n\n\n5.3.1.2.4   IPv4 address allocation, renewal and release and IPv4 parameter\n             configuration via DHCPv4\n\nWhen the PLMN allocates an IPv4 address, it is the PDN GW responsibility to\nallocate, renew and release the IPv4 address.\n\nWhen external PDN allocation is used, the PDN GW functions as a DHCPv4\nserver towards the UE. The PDN GW may act as a DHCP Client when interacting\nwith a DHCPv4 server in the external PDN in order to obtain, renew and\nrelease the IPv4 address and to obtain the configuration parameters. Or, if\nRADIUS or Diameter is used towards the external PDN as described in\nTS\u00c2\u00a029.061\u00c2\u00a0[38], the IPv4 address and the requested configuration parameters\ncan be obtained, renewed and released as part of these procedures.\n\nIf dynamic policy provisioning is deployed, and the PCRF was not informed\nabout the IPv4 address at IP-CAN session establishment, the PDN GW shall\ninitiate an IP-CAN Session Modification procedure to inform the PCRF about\nan allocated IPv4 address. If the IPv4 address is released, the PDN GW\nshall inform the PCRF about the de-allocation of an IPv4 address.\n\nIf the UE sends DHCPv4 lease renewal message to renew the lease of the\nallocated IPv4 address, the PDN GW shall renew the lease of the allocated\nIPv4 address. If the IPv4 address was obtained from an external PDN, the\nPDN GW shall perform the DHCPv4 lease renewal procedure with the external\nPDN if DHCPv4 was used for obtaining IPv4 address from external PDN. If\nDiameter or RADIUS procedures where used to obtain the IPv4 address from\nexternal PDN, the PDN GW may perform corresponding update procedures as\napplicable. If the external PDN extends lease of the allocated IPv4\naddress, the PDN GW responds accordingly to the UE. Otherwise, if the\nexternal PDN does not extend the lease of the allocated IPv4 address, the\nPDN GW responds with the remaining lease time of the IPv4 address. If there\nis no PDN address allocated to the UE for this PDN connection, the PDN GW\nshall perform PDN GW initiated bearer deactivation procedure as defined in\nclause\u00c2\u00a05.4.4.1.\n\nIf the UE sends DHCPv4 release message to release the allocated IPv4\naddress for the PDN connection, the PDN GW may anytime thereafter release\nthe IPv4 address. If the PDN connection has no allocated PDN address, the\nPDN GW may at any time initiate PDN GW initiated bearer deactivation\nprocedure as defined in clause\u00c2\u00a05.4.4.1.\n\n  NOTE:  If the PDN type is IPv4v6 the release of the allocated IPv4\n         address does not mean that there is no allocated PDN address for\n         the PDN connection, as the IPv6 prefix still remains allocated to\n         that PDN connection.\n\nIf the PDN connection is released without any DHCPv4 release signalling\nwith the UE, the UE and the PDN GW shall release the IPv4 address\nimplicitly, as soon as the PDN connection is released.\n\nAfter releasing the IPv4 address, the PDN GW should not assign that IPv4\naddress to any other user immediately.\n\n\n"}, {"key": "Void", "numbering": "5.3.1.2.5", "title_level": 4, "desc": ""}, {"key": "IPv Prefix Delegation via DHCPv", "numbering": "5.3.1.2.6", "title_level": 4, "desc": "5.3.1.2.5   Void\n\n\n\n\n5.3.1.2.6   IPv6 Prefix Delegation via DHCPv6\n\nOptionally a single network prefix shorter than the default /64 prefix may\nbe assigned to a PDN connection. In this case, the /64 default prefix used\nfor IPv6 stateless autoconfiguration will be allocated from this network\nprefix; the remaining address space from the network prefix can be\ndelegated to the PDN connection using prefix delegation after the default\nbearer establishment and IPv6 prefix allocation via IPv6 stateless address\nautoconfiguration as defined in clause\u00c2\u00a05.3.1.2.2. When PLMN based parameter\nconfiguration is used, the PDN GW provides the requested IPv6 prefix from a\nlocally provisioned pool. When external PDN based IPv6 prefix allocation is\nused, the PDN GW obtains the prefix from the external PDN.\n\n  NOTE:  Allocation of IPv6 prefixes with flexible prefix length can\n         leverage e.g. local configuration on the PDN\u00c2\u00a0GW or interaction with\n         the AAA server.\n\nThe address space provided is maintained as an IPv6 address space pool\navailable to the PDN connection for DHCPv6 IPv6 prefix requests with the\nexclusion of the IPv6 prefix that is allocated to the PDN connection during\ndefault bearer establishment as defined in clause\u00c2\u00a05.3.1.2.2. The total IPv6\naddress space available for the PDN connection (UE default bearer prefix\nand UE PDN connection IPv6 address space pool) shall be possible to\naggregate into one IPv6 prefix that will represent all IPv6 addresses that\nthe UE may use. If the UE had indicated that it supports prefix exclusion\nand the prefix to be delegated to the UE includes the /64 prefix that was\nallocated to the PDN Connection, the PDN GW shall utilise the prefix\nexclusion feature as specified for DHCPv6 Prefix Delegation in\nIETF\u00c2\u00a0RFC\u00c2\u00a06603\u00c2\u00a0[70].\n\nThe UE uses DHCPv6 to request additional IPv6 prefixes (i.e. prefixes in\naddition to the default prefix) from the PDN GW after completing stateless\nIPv6 address autoconfiguration procedures. The UE acts as a \"Requesting\nRouter\" as described in RFC\u00c2\u00a03633\u00c2\u00a0[21] and inserts one or more IA_PD\noption(s) into a DHCPv6 Solicit message sent from the UE to the PDN GW. The\nPDN GW acts as the DHCP server and fulfils the role of a \"Delegating\nRouter\" according to RFC\u00c2\u00a03633\u00c2\u00a0[21]. The UE optionally includes the\nRAPID_COMMIT option in the DHCPv6 Solicit message to trigger two-message\nDHCPv6 procedure instead of the four-message DHCPv6 procedure. The UE shall\ninclude OPTION_PD_EXCLUDE option code in an OPTION_ORO option to indicate\nsupport for prefix exclusion. In response to the DHCPv6 Solicit message,\nthe UE receives a DHCPv6 Reply message with one or more IA_PD prefix(es)\nfor every IA_PD option that it sent in the DHCPv6 Solicit message. The PDN\nGW delegates a prefix excluding the default prefix with help of\nOPTION_PD_EXCLUDE. Prefix exclusion procedures shall follow\nIETF\u00c2\u00a0RFC\u00c2\u00a06603\u00c2\u00a0[70].\n\n\n"}, {"key": "Attach procedure", "numbering": "5.3.2", "title_level": 2, "desc": "5.3.2  Attach procedure\n\n\n"}, {"key": "E-UTRAN Initial Attach", "numbering": "5.3.2.1", "title_level": 3, "desc": "5.3.2.1  E-UTRAN Initial Attach\n\nA UE/user needs to register with the network to receive services that\nrequire registration. This registration is described as Network Attachment.\nThe always-on connectivity for UE/users of the EPS may be enabled by\nestablishing a default EPS bearer during Network Attachment. The PCC rules\napplied to the default EPS bearer may be predefined in the PDN GW and\nactivated in the attachment by the PDN GW itself. The Attach procedure may\ntrigger one or multiple Dedicated Bearer Establishment procedures to\nestablish dedicated EPS bearer(s) for that UE. During the attach procedure,\nthe UE may request for an IP address allocation. Terminals utilising only\nIETF based mechanisms for IP address allocation are also supported.\n\nDuring the Initial Attach procedure the Mobile Equipment Identity is\nobtained from the UE. The MME operator may check the ME Identity with an\nEIR. The MME passes the ME Identity (IMEISV) to the HSS and to the PDN\u00c2\u00a0GW.\n\nDuring the Initial Attach procedure, if the MME supports SRVCC and if any\nof the conditions described in step\u00c2\u00a08 in Figure 5.3.2.1-1 are satisfied,\nthe MME informs the HSS with the UE SRVCC capability e.g. for further IMS\nregistration.\n\nThe E-UTRAN Initial Attach procedure is used for Emergency Attach by UEs\nthat need to perform emergency services but cannot gain normal services\nfrom the network. These UEs are in limited service state as defined in\nTS\u00c2\u00a023.122\u00c2\u00a0[10]. Also UEs that had attached for normal services and do not\nhave emergency bearers established and are camped on a cell in limited\nservice state (e.g. restricted Tracking Area or not allowed CSG) shall\ninitiate the Attach procedures indicating that the attach is to receive\nemergency services. UEs that camp normally on a cell, i.e. UEs that are not\nin limited service state, should initiate normal initial attach when not\nalready attached and shall initiate the UE Requested PDN Connectivity\nprocedure to receive emergency EPS bearer services.\n\n  NOTE\u00c2\u00a01:  A UE that is emergency attached performs initial attach\n         procedure before being able to obtain normal services.\n\nThe E-UTRAN Initial Attach procedure is used for RLOS Attach by UEs in\nlimited service state as defined in TS\u00c2\u00a023.122\u00c2\u00a0[10], as well as UEs attached\nfor normal services but moved to a cell in limited service state (e.g.\nrestricted Tracking Area or not allowed CSG).\n\nIn order to limit load on the network, only when performing an E-UTRAN\nAttach with a new PLMN (i.e. not the registered PLMN or an equivalent PLMN\nof the registered PLMN), a UE configured to perform Attach with IMSI at\nPLMN change (see TS\u00c2\u00a024.368\u00c2\u00a0[69]) shall identify itself by its IMSI instead\nof any stored temporary identifier.\n\nThis procedure is also used to establish the first PDN connection over E-\nUTRAN when the UE already has active PDN connections over a non-3GPP access\nnetwork and wants to establish simultaneous PDN connections to different\nAPNs over multiple accesses.\n\n                                    [pic]\n\n                     Figure 5.3.2.1-1: Attach procedure\n\n  NOTE\u00c2\u00a02:  For a PMIP-based S5/S8, procedure steps (A), (B), and (C) are\n         defined in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps\u00c2\u00a07, 10, 13, 14, 15 and 23a/b concern\n         GTP based S5/S8.\n\n  NOTE\u00c2\u00a03:  The Serving GWs and PDN GWs involved in steps\u00c2\u00a07 and/or 10 may be\n         different to those in steps\u00c2\u00a013-15.\n\n  NOTE\u00c2\u00a04:  The steps in (D) are executed only upon handover from non-3GPP\n         access or if Presence Reporting Area Information is received from\n         the MME.\n\n  NOTE\u00c2\u00a05:  More detail on procedure steps (E) is defined in the procedure\n         steps (B) in clause\u00c2\u00a05.3.8.3.\n\n  NOTE\u00c2\u00a06:  More detail on procedure steps (F) is defined in the procedure\n         steps (B) in clause\u00c2\u00a05.3.8.4.\n\n  1. A UE, camping on an E-UTRAN cell reads the related System Information\n    Broadcast.\n\n     An E-UTRAN cell for a PLMN that supports CIoT enhancements shall\n    broadcast:\n\n     For the NB-IoT case:\n\n    -  Whether it can connect to an MME which supports EPS Attach without\n       PDN Connectivity.\n\n     For the WB-E-UTRAN case:\n\n    -  Whether it supports Control Plane CIoT EPS Optimisation and it can\n       connect to an MME which supports Control Plane CIoT EPS Optimisation.\n\n    -  Whether it supports User Plane CIoT EPS Optimisation and it can\n       connect to an MME which supports User Plane CIoT EPS Optimisation.\n\n    -  Whether it can connect to an MME which supports EPS Attach without\n       PDN Connectivity.\n\n     If the PLMN does not advertise support of EPS attach without PDN\n    connectivity and the UE can only attach without PDN connectivity, then\n    the UE shall not attach to the PLMN in this cell and shall proceed as\n    specified in TS\u00c2\u00a023.122\u00c2\u00a0[10].\n\n     In the case of WB-E-UTRAN, if the PLMN does not support Control Plane\n    CIoT EPS Optimisation, and the UE only supports Control Plane CIoT EPS\n    Optimisation and cannot otherwise attach, then the UE shall not proceed\n    with the Attach to the PLMN in this cell and shall proceed as specified\n    in TS\u00c2\u00a023.122\u00c2\u00a0[10].\n\n     An E-UTRAN cell for a PLMN that supports Restricted Local Operator\n    Service shall broadcast:\n\n    -  Whether it supports Restricted Local Operator Service.\n\n     If the PLMN does not advertise support for Restricted Local Operator\n    Services, the UE shall not proceed with the Attach with indication that\n    the attach is to receive Restricted Local Operator Services to the PLMN\n    in this cell.\n\n     If a Service Gap timer is running in the UE (see clause\u00c2\u00a04.3.17.9) and\n    the Attach Type is not Emergency Attach and it is not an Attach without\n    PDN connectivity, then the UE shall not send Attach Requests to this\n    PLMN or any other PLMN as long as the timer is running.\n\n     If the UE can proceed to attach, it initiates the Attach procedure by\n    the transmission, to the eNodeB, of an Attach Request (IMSI or old\n    GUTI, Old GUTI type, last visited TAI (if available), UE Core Network\n    Capability, UE Specific DRX parameters, extended idle mode DRX\n    parameters, Attach Type, ESM message container (Request Type, PDN Type,\n    Protocol Configuration Options, Ciphered Options Transfer Flag, Header\n    Compression Configuration), KSIASME, NAS sequence number, NAS-MAC,\n    additional GUTI, P-TMSI signature, Voice domain preference and UE's\n    usage setting, Preferred Network behaviour, MS Network Capability,\n    Support for restriction of use of Enhanced Coverage, UE has UE Radio\n    Capability ID assigned for the selected PLMN) message together with RRC\n    parameters indicating the Selected Network and the old GUMMEI.\n\n     In the RRC connection establishment signalling associated with the\n    Attach Request, the UE indicates its support of the CIoT EPS\n    Optimisations, relevant for MME selection.\n\n     If the UE identifies itself with the old GUTI, the UE shall set the\n    Old GUTI Type to indicate whether the Old GUTI is a native GUTI or is\n    mapped from a P-TMSI and RAI. The old GUTI may be derived from a P-TMSI\n    and RAI. IMSI shall be included if the UE does not have a valid GUTI or\n    a valid P-TMSI available, or if the UE is configured to perform Attach\n    with IMSI at PLMN change and is accessing a new PLMN. The UE stores the\n    TIN in detached state. If the UE's TIN indicates \"GUTI\" or \"RAT-related\n    TMSI\" and the UE holds a valid GUTI then the old GUTI indicates this\n    valid GUTI. If the UE's TIN indicates \"P-TMSI\" and the UE holds a valid\n    P-TMSI and related RAI then these two elements are indicated as the old\n    GUTI. Mapping a P-TMSI and RAI to a GUTI is specified in TS\u00c2\u00a023.003\u00c2\u00a0[9].\n    If the UE holds a valid GUTI and the old GUTI indicates a GUTI mapped\n    from a P-TMSI and RAI, then the UE indicates the GUTI as additional\n    GUTI. If the old GUTI indicates a GUTI mapped from a P-TMSI and RAI and\n    the UE has a valid P-TMSI signature associated to it, the P-TMSI\n    signature shall be included. The UE sets the voice domain preference\n    and UE's usage setting according to its configuration, as described in\n    clause\u00c2\u00a04.3.5.9.\n\n     Alternatively, when a UE only supports E-UTRAN, if the UE has a GUTI\n    available and the UE is accessing the same PLMN (or ePLMN), then it\n    identifies itself with the old GUTI and sets the Old GUTI Type to\n    'native', otherwise the UE configuration determines whether the UE\n    identifies itself with its IMSI or the Old GUTI.\n\n     The UE includes the extended idle mode DRX parameters information\n    element if the UE needs to enable extended idle mode DRX.\n\n     If available, the last visited TAI shall be included in order to help\n    the MME produce a good list of TAIs for any subsequent Attach Accept\n    message. Selected Network indicates the PLMN that is selected for\n    network sharing purposes. The RRC parameter \"old GUMMEI\" takes its\n    value from the \"old GUTI\" contained in the Attach Request. UE Network\n    Capability is described in UE capabilities, see clause\u00c2\u00a05.11.\n\n     If the UE has valid security parameters, the Attach Request message\n    shall be integrity protected by the NAS-MAC in order to allow\n    validation of the UE by the MME. KSIASME, NAS sequence number and NAS-\n    MAC are included if the UE has valid EPS security parameters. NAS\n    sequence number indicates the sequential number of the NAS message. If\n    the UE does not have a valid EPS security association, then the Attach\n    Request message is not integrity protected. In this case the security\n    association is established in step\u00c2\u00a05a. The UE network capabilities\n    indicate also the supported NAS and AS security algorithms.\n\n     PDN type indicates the requested IP version (IPv4, IPv4/IPv6, IPv6).\n    For a UE that support CIoT EPS Optimisations, the PDN type may also be\n    \"Non-IP\". PDN type may also indicate Ethernet.\n\n     Protocol Configuration Options (PCO) are used to transfer parameters\n    between the UE and the PDN GW, and sent transparently through the MME\n    and the Serving GW. The Protocol Configuration Options may include the\n    Address Allocation Preference indicating that the UE prefers to obtain\n    an IPv4 address only after the default bearer activation by means of\n    DHCPv4. If the UE intends to send PCO which require ciphering (e.g.,\n    PAP/CHAP usernames and passwords) or send an APN, or both, the UE shall\n    set the Ciphered Options Transfer Flag and send PCO or APN or both only\n    after authentication and NAS security setup have been completed (see\n    below).\n\n  NOTE\u00c2\u00a07:  External network operators wanting to use PAP for authentication\n         are warned that PAP is an obsolete protocol from a security point\n         of view. CHAP provides stronger security than PAP.\n\n     If the UE supports 3GPP PS Data Off, it shall include in the PCO the\n    3GPP PS Data Off UE Status, which indicates whether the user has\n    activated or deactivated 3GPP PS Data Off.\n\n     If the UE has UTRAN or GERAN capabilities, it shall send the NRSU in\n    the PCO to indicate the support of the network requested bearer control\n    in UTRAN/GERAN. The UE sends the ETFTU in the PCO to indicate the\n    support of the extended TFT filter format. Request Type is included in\n    the ESM message container and indicates \"Handover\" when the UE has\n    already an activated PDN GW/HA due to mobility with non-3GPP accesses.\n\n     If a UE indicates support of CIoT EPS Optimisations in the RRC\n    message, it may omit the ESM message container. If the ESM message\n    container is omitted the MME shall not establish a PDN connection as\n    part of the Attach procedure. In this case steps 6, 12 to 16 and 23 to\n    26 are not executed. In addition, for the case of UEs attaching with\n    Control Plane CIoT EPS Optimisation with no user plane establishment,\n    steps 17 to 22 are replaced by S1 AP NAS Transport and RRC Direct\n    Transfer messages that just transport the NAS Attach Accept and NAS\n    Attach Complete messages.\n\n     Attach Type indicates whether it is an EPS attach or a combined\n    EPS/IMSI attach or an Emergency Attach or an RLOS Attach. Emergency\n    Attach and RLOS Attach shall not be indicated when the UE is using NB-\n    IoT. When using CIoT EPS Optimisations, the UE may indicate EPS attach\n    and request SMS by setting the \"SMS transfer without Combined Attach\"\n    flag in the Preferred Network Behaviour IE.\n\n     If a UE includes a Preferred Network Behaviour, this defines the\n    Network Behaviour the UE is expecting to be available in the network as\n    defined in clause\u00c2\u00a04.3.5.10.\n\n     If a UE indicated Control Plane CIoT EPS Optimisation supported in\n    Preferred Network Behavior, and the UE included the ESM message\n    container, and the PDN type was IPv4 or IPv6 or IPv4v6, and the UE\n    supports header compression, it shall include the Header Compression\n    Configuration. The Header Compression Configuration includes the\n    information necessary for the ROHC channel setup. Optionally, the\n    Header Compression Configuration may include additional header\n    compression context setup parameters if the UE already has the\n    application traffic information, e.g. the target server IP address.\n\n     For an Emergency Attach the UE shall set both the Attach Type and the\n    Request Type to \"Emergency\" and the IMSI shall be included if the UE\n    does not have a valid GUTI or a valid P-TMSI available. The IMEI shall\n    be included when the UE has no IMSI, no valid GUTI and no valid P-TMSI.\n\n     For RLOS attach, the UE shall set the Attach Type to \"RLOS\" and the\n    Request Type to \"RLOS\", the IMSI shall be included if available. The\n    IMEI shall be included when the UE has no IMSI, no valid GUTI and no\n    valid P-TMSI.\n\n     If the UE supports RACS as defined in clause\u00c2\u00a05.11.3a, and if the UE is\n    provisioned with a UE Radio Capability ID for use in the selected PLMN\n    (i.e.PLMN-assigned for the specific PLMN or manufacturer-assigned), the\n    UE includes a flag that indicates it has an assigned UE Radio\n    Capability ID for use in the selected PLMN but the actual UE Radio\n    Capability is provided to MME after security context is established in\n    step\u00c2\u00a06 (see below).\n\n  2. The eNodeB derives the MME address from the RRC parameters carrying\n    the old GUMMEI, the indicated Selected Network and the RAT (NB-IoT or\n    WB-E-UTRAN). If that MME is not associated with the eNodeB or the old\n    GUMMEI is not available, the eNodeB selects an MME as described in\n    clause 4.3.8.3 on \"MME selection function\". The eNodeB forwards the\n    Attach Request message in a S1-MME control message (Initial UE message)\n    together with the Selected Network, CSG access mode, CSG ID, L-GW\n    address, TAI+ECGI of the cell from where it received the message to the\n    new MME. CSG ID is provided if the UE attaches via a CSG cell or hybrid\n    cell. CSG access mode is provided if the UE attaches via a hybrid cell.\n    If the CSG access mode is not provided but the CSG ID is provided, the\n    MME shall consider the cell as a CSG cell. If the eNodeB has a\n    collocated L-GW, it includes the L-GW address in the Initial UE message\n    to the MME.\n\n     If the MME is not configured to support Emergency Attach the MME shall\n    reject any Attach Request that indicates Attach Type \"Emergency\".\n\n     If the MME is not configured to support RLOS Attach, the MME shall\n    reject any Attach Request that indicates Attach Type \"RLOS\".\n\n     If the UE has included the Preferred Network Behaviour, and what the\n    UE indicated it supports in Preferred Network Behaviour is incompatible\n    with the network support e.g. the UE indicated support only for Control\n    Plane CIoT EPS Optimisation and the MME only supports User Plane CIoT\n    EPS Optimisation, the MME shall reject the Attach Request with an\n    appropriate cause value (e.g. one that avoids retries on this PLMN).\n\n     To assist Location Services, the eNB indicates the UE's Coverage Level\n    to the MME.\n\n  3. If the UE identifies itself with GUTI and the MME has changed since\n    detach, the new MME determines the type of the old node, i.e. MME or\n    SGSN, as specified in clause\u00c2\u00a04.3.19, uses the GUTI received from the UE\n    to derive the old MME/SGSN address, and sends an Identification Request\n    (old GUTI, complete Attach Request message) to the old MME/SGSN to\n    request the IMSI. If the request is sent to an old MME, the old MME\n    first verifies the Attach Request message by NAS MAC and then responds\n    with Identification Response (IMSI, MM Context). If the request is sent\n    to an old SGSN, the old SGSN first verifies the Attach Request message\n    by the P-TMSI signature and then responds with Identification Response\n    (MM Context). If the UE is not known in the old MME/SGSN or if the\n    integrity check or P-TMSI signature check for the Attach Request\n    message fails, the old MME/SGSN responds with an appropriate error\n    cause. The MM context contains security related information as well as\n    other parameters (including IMSI) as described in clause\u00c2\u00a05.7.2\n    (Information Storage for MME).\n\n     The additional GUTI in the Attach Request message allows the new MME\n    to find any already existing UE context stored in the new MME when the\n    old GUTI indicates a GUTI mapped from a P-TMSI and RAI.\n\n     For an Emergency Attach or a RLOS Attach, if the UE identifies itself\n    with a temporary identity that is not known to the MME the MME\n    immediately requests the IMSI from the UE. If the UE identifies itself\n    with IMEI, the IMSI request shall be skipped.\n\n  NOTE\u00c2\u00a08:  A SGSN always responds with the UMTS security parameters and the\n         MME may store it for later use.\n\n  4. If the UE is unknown in both the old MME/SGSN and new MME, the new MME\n    sends an Identity Request to the UE to request the IMSI. The UE\n    responds with Identity Response (IMSI).\n\n  5a If no UE context for the UE exists anywhere in the network, if the\n    Attach Request (sent in step 1) was not integrity protected, or if the\n    check of the integrity failed, then authentication and NAS security\n    setup to activate integrity protection and NAS ciphering are mandatory.\n    Otherwise it is optional. If NAS security algorithm is to be changed,\n    the NAS security setup is performed in this step. The authentication\n    and NAS security setup functions are defined in clause\u00c2\u00a05.3.10 on\n    \"Security Function\".\n\n     If the UE supports RACS as indicated in the UE Network Capability, and\n    if the UE indicated that it is provisioned with UE Radio Capability ID\n    for the selected PLMN then authentication and NAS security setup to\n    activate integrity protection and NAS ciphering are mandatory. The MME\n    shall request the UE to provide the UE Radio Capability ID in Security\n    Mode Command and the UE shall include the UE Radio Capability ID in\n    Security Mode Command Accept for the supported UE radio capabilities.\n\n     If the MME is configured to support Emergency Attach for\n    unauthenticated IMSIs and the UE indicated Attach Type \"Emergency\" the\n    MME skips the authentication and security setup or the MME accepts that\n    the authentication may fail and continues the attach procedure.\n\n     If the MME is configured to support RLOS Attach and the UE indicated\n    Attach Type \"RLOS\", based on local regulation and operator policy, the\n    MME may skip the authentication and security setup, or the MME may\n    perform authentication if security information is available or\n    obtainable from HSS and continues the attach procedure regardless of\n    the authentication result.\n\n     After step\u00c2\u00a05a, all NAS messages shall be protected by the NAS security\n    functions (integrity and ciphering) indicated by the MME unless the UE\n    is emergency attached and not successfully authenticated.\n\n  5b.  The ME Identity (IMEISV) shall be retrieved from the UE. The ME\n    identity shall be transferred encrypted unless the UE performs\n    Emergency Attach or RLOS Attach and cannot be authenticated.\n\n     For an Emergency Attach or RLOS Attach, the UE may have included the\n    IMEI in the Emergency Attach or RLOS Attach. If so, the ME Identity\n    retrieval is skipped.\n\n     In order to minimise signalling delays, the retrieval of the ME\n    Identity may be combined with NAS security setup in step\u00c2\u00a05a. The MME\n    may send the ME Identity Check Request (ME Identity, IMSI) to the EIR.\n    The EIR shall respond with ME Identity Check Ack (Result). Dependent\n    upon the Result, the MME decides whether to continue with this Attach\n    procedure or to reject the UE.\n\n     For an Emergency Attach or RLOS Attach, the IMEI check to the EIR may\n    be performed. If the IMEI is blocked, operator policies determine\n    whether the Emergency Attach or RLOS Attach procedure continues or is\n    stopped.\n\n     If the UE supports RACS, as indicated in the UE Core Network\n    Capability IE, the MME shall use the IMEI of the UE to obtain the TAC\n    for the purpose of RACS operation.\n\n  6. If the UE has set the Ciphered Options Transfer Flag in the Attach\n    Request message, the Ciphered Options i.e. PCO or APN or both, shall\n    now be retrieved from the UE.\n\n     In order to handle situations where the UE may have subscriptions to\n    multiple PDNs, if the Protocol Configuration Options contains user\n    credentials (e.g. user name/password within PAP or CHAP parameters)\n    then the UE should also send the APN to the MME.\n\n  7. If there are active bearer contexts in the new MME for this particular\n    UE (i.e. the UE re-attaches to the same MME without having properly\n    detached before), the new MME deletes these bearer contexts by sending\n    Delete Session Request (LBI) messages to the GWs involved. The GWs\n    acknowledge with Delete Session Response (Cause) message. If a PCRF is\n    deployed, the PDN GW employs an IP-CAN Session Termination procedure to\n    indicate that resources have been released.\n\n  8. If the MME has changed since the last detach, or if there is no valid\n    subscription context for the UE in the MME, or if the UE provides an\n    IMSI or the UE provides an old GUTI which doesn't refer to a valid\n    context in the MME, or for some network sharing scenario (e.g. GWCN) if\n    the PLMN-ID of the TAI supplied by the eNodeB is different from that of\n    the GUTI in the UE's context, the MME sends an Update Location Request\n    (MME Identity, IMSI, ME Identity (IMEISV), MME Capabilities, ULR-Flags,\n    Homogeneous Support of IMS Voice over PS Sessions, UE SRVCC capability,\n    equivalent PLMN list) message to the HSS. The MME capabilities indicate\n    the MME's support for regional access restrictions functionality. ULR-\n    Flags indicates \"Initial-Attach-Indicator\" as this is an Attach\n    procedure. The inclusion of the equivalent PLMN list indicates that the\n    MME supports the inter-PLMN handover to a CSG cell in an equivalent\n    PLMN using the subscription information of the target PLMN. The\n    \"Homogenous Support of IMS Voice over PS Sessions\" indication (see\n    clause\u00c2\u00a04.3.5.8A) shall not be included unless the MME has completed its\n    evaluation of the support of \"IMS Voice over PS Session\" as specified\n    in clause\u00c2\u00a04.3.5.8.\n\n  NOTE\u00c2\u00a09:  At this step, the MME may not have all the information needed to\n         determine the setting of the IMS Voice over PS Session Supported\n         indication for this UE (see clause\u00c2\u00a04.3.5.8). Hence the MME can send\n         the \"Homogenous Support of IMS Voice over PS Sessions\" later on in\n         this procedure.\n\n     If the UE performs Initial or Handover Attach in a VPLMN supporting\n    Autonomous CSG Roaming and the HPLMN has enabled Autonomous CSG Roaming\n    in the VPLMN (via Service Level Agreement) and the MME needs to\n    retrieve the CSG subscription information of the UE from the CSS, the\n    MME initiates the Update CSG Location Procedure with CSS as described\n    in clause\u00c2\u00a05.3.12.\n\n     If the MME determines that only the UE SRVCC capability has changed,\n    the MME sends a Notify Request to the HSS to inform about the changed\n    UE SRVCC capability.\n\n     If there is a valid subscription context for the UE in the MME with a\n    Service Gap timer running and the Attach Type is not Emergency Attach\n    and it is not an Attach without PDN connectivity, the MME rejects the\n    Attach Request from the UE with an appropriate cause value. In\n    addition, MME may also provide a UE with a Mobility Management Back-off\n    Timer set to the remaining value of the Service Gap timer.\n\n     For an Emergency Attach in which the UE was not successfully\n    authenticated, the MME shall not send an Update Location Request to the\n    HSS.\n\n     For an RLOS Attach the MME shall not send an Update Location Request\n    to the HSS.\n\n  9. The HSS sends Cancel Location (IMSI, Cancellation Type) to the old\n    MME. The old MME acknowledges with Cancel Location Ack (IMSI) and\n    removes the MM and bearer contexts. If the ULR-Flags indicates \"Initial-\n    Attach-Indicator\" and the HSS has the SGSN registration, then the HSS\n    sends Cancel Location (IMSI, Cancellation Type) to the old SGSN. The\n    Cancellation Type indicates the old MME/SGSN to release the old Serving\n    GW resource.\n\n  10.  If there are active bearer contexts in the old MME/SGSN for this\n    particular UE, the old MME/SGSN deletes these bearer contexts by\n    sending Delete Session Request (LBI) messages to the GWs involved. The\n    GWs return Delete Session Response (Cause) message to the old MME/SGSN.\n    If a PCRF is deployed, the PDN GW employs an IP-CAN Session Termination\n    procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6] to indicate that resources have\n    been released.\n\n  11.  The HSS acknowledges the Update Location message by sending an\n    Update Location Ack (IMSI, Subscription data) message to the new MME.\n    The Subscription Data contain one or more PDN subscription contexts.\n    Each PDN subscription context contains an 'EPS subscribed QoS profile'\n    and the subscribed APN-AMBR (see clause\u00c2\u00a04.7.3) and the WLAN\n    offloadability indication (see clause\u00c2\u00a04.3.23). The new MME validates\n    the UE's presence in the (new) TA.\n\n     If due to regional subscription restrictions or access restrictions\n    (e.g. CSG restrictions) the UE is not allowed to attach in the TA or\n    due to subscription checking fails for other reasons, the new MME\n    rejects the Attach Request with an appropriate cause. If all checks are\n    successful then the new MME constructs a context for the UE. If the APN\n    provided by the UE is not allowed by subscription, based on operator\n    policy, the MME may reject the Attach Request from the UE with an\n    appropriate cause, or accept the Attach Request by replacing the UE\n    requested APN with a network supported APN. The MME uses that network\n    supported APN for the remainder of this procedure, except that the MME\n    provides to the UE the same APN that the UE requested. If the Update\n    Location is rejected by the HSS, the new MME rejects the Attach Request\n    from the UE with an appropriate cause.\n\n     The Subscription Data may contain CSG subscription information for the\n    registered PLMN and for the equivalent PLMN list requested by MME in\n    step\u00c2\u00a08.\n\n     The subscription data may contain Enhanced Coverage Restricted\n    parameter. If received from the HSS, MME stores this Enhanced Coverage\n    Restricted parameter in the MME MM context.\n\n     The subscription data may contain Service Gap Time parameter. If\n    received from the HSS, MME stores this Service Gap Time in the MME MM\n    context and passes it to the UE in the Attach Accept message.\n\n     The subscription data may contain Subscribed Paging Time Window\n    parameter that applies to the UEs on a specific RAT, e.g. NB-IoT. If\n    received from the HSS, MME stores this Subscribed Paging Time Window\n    parameter in the MME MM context.\n\n     If the UE provided APN is authorized for LIPA according to the user\n    subscription, the MME shall use the CSG Subscription Data to authorize\n    the connection.\n\n     For an Emergency Attach or RLOS Attach, the MME shall not check for\n    access restrictions, regional restrictions or subscription restrictions\n    (e.g. CSG restrictions). For an Emergency Attach, the MME shall ignore\n    any unsuccessful Update Location Response from HSS and continue with\n    the Attach procedure.\n\n  12.  If an ESM container was not included in the Attach Request, steps\n    12, 13,14,15,16 are skipped. If the attach type is not set to\n    \"Emergency\" or \"RLOS\", and the ESM container was included in the Attach\n    Request, and the UE has indicated support for Attach without PDN\n    Connectivity, and the network supports Attach without PDN Connectivity,\n    and the PDN Connection Restriction is set in the subscriber data, then\n    the new MME shall not establish PDN connection, and steps 12, 13, 14,\n    15 and 16 are skipped.\n\n     For an Emergency Attach the MME applies the parameters from MME\n    Emergency Configuration Data for the emergency bearer establishment\n    performed in this step and any potentially stored IMSI related\n    subscription data are ignored by the MME.\n\n     For a RLOS Attach, the MME applies the parameters from MME RLOS\n    Configuration Data for the RLOS default bearer establishment performed\n    in this step and any potentially stored IMSI related subscription data\n    are ignored by the MME.\n\n     If the UE performs Initial or Handover Attach via a CSG cell and there\n    is no subscription for that CSG or the CSG subscription is expired the\n    MME shall reject the Attach Request with an appropriate cause. If the\n    UE has this CSG ID and associated PLMN on its Allowed CSG list the UE\n    shall remove the CSG ID and associated PLMN from the list when\n    receiving this reject cause.\n\n     If a subscribed PDN address is allocated for the UE for this APN, the\n    PDN subscription context contains the UE's IPv4 address and/or the IPv6\n    prefix and optionally the PDN GW identity. If the PDN subscription\n    context contains a subscribed IPv4 address and/or IPv6 prefix, the MME\n    indicates it in the PDN address. For Request Type indicating \"Initial\n    request\", if the UE does not provide an APN, the MME shall use the PDN\n    GW corresponding to the default APN for default bearer activation. If\n    the UE provides an APN, this APN shall be employed for default bearer\n    activation. For Request Type indicating \"Handover\", if the UE provides\n    an APN, the MME shall use the PDN GW corresponding to the provided APN\n    for default bearer activation, If the UE does not provide an APN, and\n    the subscription context from HSS contains a PDN GW identity\n    corresponding to the default APN, the MME shall use the PDN GW\n    corresponding to the default APN for default bearer activation. The\n    case where the Request Type indicates \"Handover\" and the UE does not\n    provide an APN, and the subscription context from HSS does not contain\n    a PDN GW identity corresponding to the default APN constitutes an error\n    case. If the Request Type indicates \"Initial request\" and the selected\n    PDN subscription context contains no PDN GW identity the new MME\n    selects a PDN GW as described in clause\u00c2\u00a04.3.8.1 on PDN GW selection\n    function (3GPP accesses). If the PDN subscription context contains a\n    dynamically allocated PDN GW identity and the Request Type does not\n    indicate \"Handover\" the MME may select a new PDN GW as described in\n    clause PDN GW selection function, e.g. to allocate a PDN GW that allows\n    for more efficient routing.\n\n     For initial and handover Emergency Attach the MME uses the PDN GW\n    Selection function defined in clause\u00c2\u00a04.3.12.4 to select a PDN GW.\n\n     For initial RLOS Attach, the MME uses the PDN GW Selection function\n    defined in clause\u00c2\u00a04.3.12a.4 to select a PDN GW.\n\n     If the subscription context does not indicate that the APN is for a\n    PDN connection to an SCEF, the new MME selects a Serving GW as\n    described in clause 4.3.8.2 on Serving GW selection function and\n    allocates an EPS Bearer Identity for the Default Bearer associated with\n    the UE. Then it sends a Create Session Request (IMSI, MSISDN, MME TEID\n    for control plane, PDN GW address, PDN Address, APN, RAT type, LTE-M\n    RAT type reporting to PGW flag, Default EPS Bearer QoS, PDN Type, APN-\n    AMBR, EPS Bearer Identity, Protocol Configuration Options, Handover\n    Indication, ME Identity (IMEISV), User Location Information (ECGI), UE\n    Time Zone, User CSG Information, MS Info Change Reporting support\n    indication, Selection Mode, Charging Characteristics, Trace Reference,\n    Trace Type, Trigger Id, OMC Identity, Maximum APN Restriction, Dual\n    Address Bearer Flag, the Protocol Type over S5/S8, Serving Network, APN\n    Rate Control Status) message to the selected Serving GW. If Control\n    Plane CIoT EPS Optimisation applies, then the MME shall also indicate\n    S11-U tunnelling of NAS user data and send its own S11-U IP address and\n    MME DL TEID for DL data forwarding by the SGW. User CSG Information\n    includes CSG ID, access mode and CSG membership indication.\n\n     For PDN type \"non-IP\" when Control Plane CIoT EPS Optimisations are\n    enabled for the UE, if APN subscription data indicate a SCEF connection\n    needs to be used, then the MME allocates an EPS Bearer Identity for the\n    Default Bearer associated with the UE and establishes a connection to\n    the SCEF address indicated in subscription data as per TS\u00c2\u00a023.682\u00c2\u00a0[74]\n    and the steps 12,13,14,15,16 are not executed. The rest of the\n    interactions with the UE apply as specified below.\n\n     If the MME determines the PDN connection shall only use the Control\n    Plane CIoT EPS Optimisation, the MME shall include a Control Plane Only\n    PDN Connection Indicator in Create Session Request.\n\n     If the Request Type indicates \"Emergency\" or \"RLOS\", Maximum APN\n    restriction control shall not be performed.\n\n     For emergency attached or RLOS attached UEs IMSI is included if\n    available and if the IMSI cannot be authenticated then the IMSI shall\n    be marked as unauthenticated.\n\n     The RAT type is provided in this message for the later PCC decision.\n    The RAT type shall distinguish between NB-IoT, LTE-M and WB-E-UTRA\n    types. The subscribed APN-AMBR for the APN is also provided in this\n    message. The MSISDN is included if provided in the subscription data\n    from the HSS. Handover Indication is included if the Request Type\n    indicates handover. Selection Mode indicates whether a subscribed APN\n    was selected, or a non-subscribed APN sent by the UE was selected.\n    Charging Characteristics indicates which kind of charging the bearer\n    context is liable for. The MME may change the requested PDN type\n    according to the subscription data for this APN as described in\n    clause\u00c2\u00a05.3.1.1. The MME shall set the Dual Address Bearer Flag when the\n    PDN type is set to IPv4v6 and all SGSNs which the UE may be handed over\n    to are Release\u00c2\u00a08 or above supporting dual addressing, which is\n    determined based on node pre-configuration by the operator. The\n    Protocol Type over S5/S8 is provided to Serving GW which protocol\n    should be used over S5/S8 interface.\n\n     The charging characteristics for the PS subscription and individually\n    subscribed APNs as well as the way of handling Charging Characteristics\n    and whether to send them or not to the P-GW is defined in\n    TS\u00c2\u00a032.251\u00c2\u00a0[44]. The MME shall include Trace Reference, Trace Type,\n    Trigger Id, and OMC Identity if S-GW and/or P-GW trace is activated.\n    The MME shall copy Trace Reference, Trace Type, and OMC Identity from\n    the trace information received from the HLR or OMC.\n\n     The Maximum APN Restriction denotes the most stringent restriction as\n    required by any already active bearer context. If there are no already\n    active bearer contexts, this value is set to the least restrictive type\n    (see clause 15.4 of TS\u00c2\u00a023.060\u00c2\u00a0[7]). If the P-GW receives the Maximum\n    APN Restriction, then the P-GW shall check if the Maximum APN\n    Restriction value does not conflict with the APN Restriction value\n    associated with this bearer context request. If there is no conflict\n    the request shall be allowed, otherwise the request shall be rejected\n    with sending an appropriate error cause to the UE.\n\n     If the MME requires the eNB to check whether the UE radio capabilities\n    are compatible with the network configuration (e.g. whether the SRVCC\n    or frequency support by the UE matches that of the network) to be able\n    to set the IMS voice over PS Session Supported Indication (see\n    clause\u00c2\u00a04.3.5.8), then the MME may send a UE Radio Capability Match\n    Request to the eNB as defined in clause\u00c2\u00a05.3.14.\n\n     The MME includes the latest APN Rate Control status if it has stored\n    it.\n\n  13.  The Serving GW creates a new entry in its EPS Bearer table and sends\n    a Create Session Request (IMSI, MSISDN, APN, Serving GW Address for the\n    user plane, Serving GW TEID of the user plane, Serving GW TEID of the\n    control plane, RAT type, Default EPS Bearer QoS, PDN Type, PDN Address,\n    subscribed APN-AMBR, EPS Bearer Identity, Protocol Configuration\n    Options, Handover Indication, ME Identity, User Location Information\n    (ECGI), UE Time Zone, User CSG Information, MS Info Change Reporting\n    support indication, PDN Charging Pause Support indication, Selection\n    Mode, Charging Characteristics, Trace Reference, Trace Type, Trigger\n    Id, OMC Identity, Maximum APN Restriction, Dual Address Bearer Flag,\n    Serving Network, APN Rate Control Status) message to the PDN GW\n    indicated by the PDN GW address received in the previous step. After\n    this step, the Serving GW buffers any downlink packets it may receive\n    from the PDN GW without sending a Downlink Data Notification message to\n    the MME until it receives the Modify Bearer Request message in step 23\n    below. The MSISDN is included if received from the MME.\n\n     If the Serving GW has received the Control Plane Only PDN Connection\n    Indicator in step\u00c2\u00a012, the Serving GW informs the PDN GW this\n    information in Create Session Request. The Serving GW and PDN GW shall\n    indicate the use of CP only on their CDRs.\n\n     PDN\u00c2\u00a0GWs shall not perform any checks of Maximum APN Restriction if\n    Create Session Request includes the emergency APN or RLOS APN.\n\n     For emergency attached or RLOS attached UEs IMSI is included if\n    available and if the IMSI cannot be authenticated then the IMSI shall\n    be marked as unauthenticated.\n\n     In the case of handover attach, and if the PDN GW detects that the\n    3GPP PS Data Off UE Status is active, the PDN GW shall indicate this\n    status to the charging system for offline and online charging.\n\n  14.  If dynamic PCC is deployed and the Handover Indication is not\n    present, the PDN GW performs an IP-CAN Session Establishment procedure\n    as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6], and thereby obtains the default PCC rules\n    for the UE. If the UE is accessing over WB-E-UTRA, this may lead to the\n    establishment of a number of dedicated bearers following the procedures\n    defined in clause 5.4.1 in association with the establishment of the\n    default bearer, which is described in Annex\u00c2\u00a0F.\n\n     The IMSI, APN, UE IP address, User Location Information (ECGI), UE\n    Time Zone, Serving Network, RAT type, APN-AMBR, Default EPS Bearer QoS,\n    ETFTU (if ETFTU is not provided it means UE and/or the PDN\u00c2\u00a0GW does not\n    support the extended TFT filter format) are provided to the PCRF by the\n    PDN GW if received by the previous message. The User Location\n    Information and UE Time Zone are used for location based charging. For\n    emergency attached or RLOS attached UEs which are unauthenticated the\n    PDN\u00c2\u00a0GW provides the IMEI as the UE Identity instead of IMSI, to the\n    PCRF. If the PCRF decides that the PDN connection may use the extended\n    TFT filter format, it shall return the ETFTN indicator to the PDN\u00c2\u00a0GW\n    for inclusion in the protocol Configuration Options returned to the UE.\n\n     The PCRF may modify the APN-AMBR and the QoS parameters (QCI and ARP)\n    associated with the default bearer in the response to the PDN GW as\n    defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n     If the PCC is configured to support emergency services and if dynamic\n    PCC is deployed, the PCRF, based on the emergency APN, sets the ARP of\n    the PCC rules to a value that is reserved for emergency services and\n    the authorization of dynamic PCC rules as described in of\n    TS\u00c2\u00a023.203\u00c2\u00a0[6]. If dynamic PCC is not deployed, the PDN GW uses the ARP\n    of the default emergency EPS bearer for any potentially initiated\n    dedicated emergency EPS bearer. The P-GW determines that emergency\n    services are requested based on the emergency APN received in Create\n    Session Request message.\n\n     If the PCC is configured to support Restricted Local Operator Services\n    and if dynamic PCC is deployed, the PCRF, based on the RLOS APN, sets\n    the ARP of the PCC rules to a value based on operator policy and the\n    authorization of dynamic PCC rules as described in of TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  NOTE\u00c2\u00a010: While the PDN GW/PCEF may be configured to activate predefined\n         PCC rules for the default bearer, the interaction with the PCRF is\n         still required to provide e.g. the UE IP address information to the\n         PCRF.\n\n  NOTE\u00c2\u00a011: If the IP address is not available when the PDN GW performs the\n         IP-CAN Session Establishment procedure with the PCRF, the PDN GW\n         initiates an IP-CAN Session Modification procedure to inform the\n         PCRF about an allocated IP address as soon as the address is\n         available. In this version of the specification, this is applicable\n         only to IPv4 address allocation.\n\n     If dynamic PCC is deployed and the Handover Indication is present, the\n    PDN GW executes a PCEF Initiated IP-CAN Session Modification procedure\n    with the PCRF as specified in TS\u00c2\u00a023.203\u00c2\u00a0[6] to report the new IP-CAN\n    type. Depending on the active PCC rules, the establishment of dedicated\n    bearers for the UE may be required. The establishment of those bearers\n    shall take place in combination with the default bearer activation as\n    described in Annex\u00c2\u00a0F. This procedure can continue without waiting for a\n    PCRF response. If changes to the active PCC rules are required, the\n    PCRF may provide them after the handover procedure is finished.\n\n     In both cases (Handover Indication is present or not), if dynamic PCC\n    is not deployed, the PDN GW may apply local QoS policy. If the UE is\n    accessing over WB-E-UTRA, this may lead to the establishment of a\n    number of dedicated bearers for the UE following the procedures defined\n    in clause\u00c2\u00a05.4.1 in combination with the establishment of the default\n    bearer, which is described in Annex\u00c2\u00a0F.\n\n     If the CSG information reporting triggers are received from the PCRF,\n    the PDN\u00c2\u00a0GW should set the CSG Information Reporting Action IE\n    accordingly.\n\n     If 3GPP PS Data Off status is received in the PCO from the UE and PDN\n    GW supports 3GPP PS Data Off, the PDN GW shall provide the 3GPP PS Data\n    Off status to the PCRF. If the PCRF supports 3GPP PS Data Off, it shall\n    return 3GPP PS Data Off support to the PDN GW for inclusion in the PCO\n    returned to the UE.\n\n     The additional behaviour of the PDN GW for 3GPP PS Data Off is defined\n    in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n     If received, the PDN GW may take the APN Rate Control Status into\n    account when encoding the APN Rate Control parameters in Protocol\n    Configuration Options and when enforcing the APN Rate Control as\n    described in clause\u00c2\u00a04.7.7.3.\n\n  15.  The P-GW creates a new entry in its EPS bearer context table and\n    generates a Charging Id for the Default Bearer. The new entry allows\n    the P-GW to route user plane PDUs between the S-GW and the packet data\n    network, and to start charging. The way the P-GW handles Charging\n    Characteristics that it may have received is defined in TS\u00c2\u00a032.251\u00c2\u00a0[44].\n\n     The PDN GW returns a Create Session Response (PDN GW Address for the\n    user plane, PDN GW TEID of the user plane, PDN GW TEID of the control\n    plane, PDN Type, PDN Address, EPS Bearer Identity, EPS Bearer QoS,\n    Protocol Configuration Options, Charging Id, Prohibit Payload\n    Compression, APN Restriction, Cause, MS Info Change Reporting Action\n    (Start) (if the PDN GW decides to receive UE's location information\n    during the session), CSG Information Reporting Action (Start) (if the\n    PDN GW decides to receive UE's User CSG information during the\n    session), Presence Reporting Area Action (if the PDN GW decides to\n    receive notifications about a change of UE presence in Presence\n    Reporting Area), PDN Charging Pause Enabled indication (if PDN GW has\n    chosen to enable the function), APN-AMBR, Delay Tolerant Connection)\n    message to the Serving GW.\n\n     The PDN GW takes into account the received PDN type, the Dual Address\n    Bearer Flag and the policies of operator when the PDN GW selects the\n    PDN type to be used as follows. If the received PDN type is IPv4v6 and\n    both IPv4 and IPv6 addressing is possible in the PDN but the Dual\n    Address Bearer Flag is not set, or only single IP version addressing\n    for this APN is possible in the PDN, the PDN GW selects a single IP\n    version (either IPv4 or IPv6). If the received PDN type is IPv4 or IPv6\n    or \"Non-IP\" or \"Ethernet\", the PDN GW uses the received PDN type if it\n    is supported in the PDN, otherwise an appropriate error cause will be\n    returned. For IPv4, IPv6 and IPv4v6, the PDN GW allocates a PDN Address\n    according to the selected PDN type. If the PDN GW has selected a PDN\n    type different from the received PDN Type, the PDN GW indicates\n    together with the PDN type IE a reason cause to the UE why the PDN type\n    has been modified, as described in clause\u00c2\u00a05.3.1.1. The PDN GW shall\n    either accept or reject (but not modify) the PDN type if the PDN type\n    is set to \"Non-IP\" or \"Ethernet\". PDN Address may contain an IPv4\n    address for IPv4 and/or an IPv6 prefix and an Interface Identifier, or\n    be omitted for PDN types \"Non-IP\" and \"Ethernet\". If the PDN has been\n    configured by the operator so that the PDN addresses for the requested\n    APN shall be allocated by usage of DHCPv4 only, or if the PDN GW allows\n    the UE to use DHCPv4 for address allocation according to the Address\n    Allocation Preference received from the UE, the PDN Address shall be\n    set to 0.0.0.0, indicating that the IPv4 PDN address shall be\n    negotiated by the UE with DHCPv4 after completion of the Default Bearer\n    Activation procedure. For external PDN addressing for IPv6, the PDN GW\n    obtains the IPv6 prefix from the external PDN using either RADIUS or\n    Diameter client function. In the PDN Address field of the Create\n    Session Response, the PDN GW includes the Interface Identifier and IPv6\n    prefix. The PDN GW sends Router Advertisement to the UE after default\n    bearer establishment with the IPv6 prefix information for all cases.\n\n     If the PDN address is contained in the Create Session Request, the PDN\n    GW shall allocate the IPv4 address and/or IPv6 prefix contained in the\n    PDN address to the UE. The IP address allocation details are described\n    in clause 5.3.1 on \"IP Address Allocation\". The PDN GW derives the BCM\n    based on the NRSU and operator policy. The PDN\u00c2\u00a0GW derives whether the\n    extended TFT filter format is to be used based on the ETFTU, ETFTN\n    received from the PCRF and operator policy. Protocol Configuration\n    Options contains the BCM, ETFTN as well as optional PDN parameters that\n    the P-GW may transfer to the UE. These optional PDN parameters may be\n    requested by the UE, or may be sent unsolicited by the P-GW. Protocol\n    Configuration Options are sent transparently through the MME.\n\n     The PDN GW includes a Delay Tolerant Connection indication if the PDN\n    GW supports receiving a rejection cause from the SGW indicating that\n    the UE is temporarily not reachable due to power saving and holding\n    mobile terminated procedures, until the PDN GW receives a message\n    indicating that the UE is available for end to end signalling.\n\n     When the Handover Indication is present, the PDN GW does not yet send\n    downlink packets to the S-GW; the downlink path is to be switched at\n    step\u00c2\u00a023a.\n\n     If the PDN GW is an L-GW, it does not forward downlink packets to the\n    S-GW. The packets will only be forwarded to the HeNB at step\u00c2\u00a020 via the\n    direct user plane path.\n\n     If the 3GPP PS Data Off UE Status was present in the Create Session\n    Request PCO and the network supports 3GPP PS Data Off feature, the PDN\n    GW shall include the 3GPP PS Data Off Support Indication in the Create\n    Session Response PCO.\n\n  16.  The Serving GW returns a Create Session Response (PDN Type, PDN\n    Address, Serving GW address for User Plane, Serving GW TEID User Plane,\n    Serving GW TEID for control plane, EPS Bearer Identity, EPS Bearer QoS,\n    PDN GW addresses and TEIDs (GTP-based S5/S8) or GRE keys (PMIP-based\n    S5/S8) at the PDN GW(s) for uplink traffic, Protocol Configuration\n    Options, Prohibit Payload Compression, APN Restriction, Cause, MS Info\n    Change Reporting Action (Start), Presence Reporting Area Action, CSG\n    Information Reporting Action (Start), APN-AMBR, Delay Tolerant\n    Connection) message to the new MME.\n\n     If Control Plane CIoT EPS Optimisation applies, and if the MME does\n    not include Control Plane Only PDN Connection Indicator in the Create\n    Session Request:\n\n    -  If separation of S11-U from S1-U is required, the Serving GW shall\n       include the Serving GW IP address and TEID for S11-U and additionally\n       the Serving GW IP address and TEID for S1-U in Create Session\n       Response.\n\n    -  Otherwise, if separation of S11-U from S1-U is not required, the\n       Serving GW includes the Serving GW IP address and TEID for S11-U in\n       Create Session Response.\n\n  17.  If an APN Restriction is received, then the MME shall store this\n    value for the Bearer Context and the MME shall check this received\n    value with the stored value for the Maximum APN Restriction to ensure\n    there are no conflicts between values. If the Bearer Context is\n    accepted, the MME shall determine a (new) value for the Maximum APN\n    Restriction. If there is no previously stored value for Maximum APN\n    Restriction, then the Maximum APN Restriction shall be set to the value\n    of the received APN Restriction. MME shall not deactivate bearer(s)\n    with emergency ARP, if present, to maintain valid APN restriction\n    combination.\n\n     The P-GW shall ignore Maximum APN restriction if the request includes\n    the Emergency APN.\n\n     If the MS Info Change Reporting Action (Start) and/or the CSG\n    Information Reporting Action (Start) are received for this bearer\n    context, then the MME shall store this for the bearer context and the\n    MME shall report to that P-GW via the S-GW whenever a UE's location\n    and/or User CSG information change occurs that meets the P-GW request,\n    as described in clause\u00c2\u00a015.1.1a of TS\u00c2\u00a023.060\u00c2\u00a0[7]. If Presence Reporting\n    Area Action is received for this bearer context, the MME shall store\n    this information for the bearer context and shall report to that P-GW\n    via the S-GW whenever a change of UE presence in a Presence Reporting\n    Area is detected, as described in clause\u00c2\u00a05.9.2.2.\n\n     The MME determines the UE AMBR to be used by the eNodeB based on the\n    subscribed UE-AMBR and the APN-AMBR for the default APN, see\n    clause\u00c2\u00a04.7.3.\n\n     For emergency attach or RLOS attach the MME determines the UE-AMBR to\n    be used by the eNodeB from the APN AMBR received from the S-GW.\n\n     If new MME hasn't received, from Step 12, Voice Support Match\n    Indicator for the UE from the eNB then, based on implementation, the\n    MME may set IMS Voice over PS session supported Indication and update\n    it at a later stage.\n\n     The new MME sends an Attach Accept (GUTI, TAI List, Session Management\n    Request (APN, PDN Type, PDN Address, EPS Bearer Identity, Protocol\n    Configuration Options, Header Compression Configuration, Control Plane\n    Only Indicator), NAS sequence number, NAS-MAC, IMS Voice over PS\n    session supported Indication, Emergency Service Support indicator, LCS\n    Support Indication, Supported Network Behaviour, Service Gap Time,\n    Enhanced Coverage Restricted, Indication for support of 15 EPS bearers\n    per UE) message to the eNodeB. GUTI is included if the new MME\n    allocates a new GUTI. PDN Type and PDN Address are omitted if the\n    Attach Request (step\u00c2\u00a01) did not contain an ESM message container. The\n    MME indicates the CIoT EPS Optimisations it accepts in the Supported\n    Network Behaviour information as defined in clause\u00c2\u00a04.3.5.10. Service\n    Gap Time is included if Service Gap Time is present in the subscription\n    information (step\u00c2\u00a011) and the UE has indicated UE Service Gap Control\n    Capability. This message is contained in an S1_MME control message\n    Initial Context Setup Request, unless the MME has selected to use the\n    Control Plane CIoT EPS Optimisation, or, the UE did not include the ESM\n    message container in the Attach Request (step\u00c2\u00a01), in which case an S1-\n    AP Downlink NAS transport message is used. The S1-AP Initial Context\n    Setup Request message also includes the AS security context information\n    for the UE, the Handover Restriction List, the EPS Bearer QoS, the UE-\n    AMBR, EPS Bearer Identity, as well as the TEID at the Serving GW used\n    for user plane and the address of the Serving GW for user plane and\n    whether User Plane CIoT EPS Optimisation is allowed for the UE. If the\n    PDN type is set to \"Non-IP\" the MME includes it in the S1-AP Initial\n    Context Setup Request so that the eNodeB disables header compression.\n    If the PDN type is set to \"Ethernet\" the MME includes it in the S1-AP\n    Initial Context Setup Request so that any eNodeB header compression\n    functionality can act appropriately. In addition, if the PDN connection\n    is established for Local IP Access, the corresponding S1 Initial\n    Context Setup Request message includes a Correlation ID for enabling\n    the direct user plane path between the HeNB and the L-GW. If the PDN\n    connection is established for SIPTO at the Local Network with L-GW\n    function collocated with the (H)eNB, the corresponding S1-AP Initial\n    Context Setup Request message includes a SIPTO Correlation ID for\n    enabling the direct user plane path between the (H)eNB and the L-GW.\n    LIPA and SIPTO do not apply to Control Plane CIoT EPS Optimisation.\n\n  NOTE\u00c2\u00a012: In this release of the 3GPP specification the Correlation ID and\n         SIPTO Correlation ID is set equal to the user plane PDN GW TEID\n         (GTP-based S5) or GRE key (PMIP-based S5) that the MME has received\n         in step\u00c2\u00a016.\n\n     If Control Plane CIoT EPS Optimisation applies for an IP PDN\n    connection, and the UE has sent in the Attach Request the Header\n    Compression Configuration, and the MME supports the header compression\n    parameters, the MME shall include the Header Compression Configuration\n    in the PDN Connectivity Accept message. The MME also binds the uplink\n    and downlink ROHC channels to support header compression feedback\n    signalling. If the UE has included header compression context setup\n    parameters in Header Compression Configuration in the Attach Request,\n    the MME may acknowledge the header compression context setup\n    parameters. If the ROHC context is not established during the attach\n    procedure for the PDN connection, before using the compressed format\n    for sending the data, the UE and the MME need to establish the ROHC\n    context with ROHC IR packet based on Header Compression Configuration.\n\n     If the MME based on local policy determines the PDN connection shall\n    only use the Control Plane CIoT EPS Optimisation, the MME shall include\n    a Control Plane Only Indicator in the Session Management Request. For\n    PDN connections with an SCEF, the MME shall always include the Control\n    Plane Only Indicator.A UE receiving the Control Plane Only Indicator,\n    for a PDN connection shall only use the Control Plane CIoT EPS\n    Optimisation for this PDN connection.\n\n     If the ESM container was not included in the Attach Request in step\u00c2\u00a01,\n    then the Attach Accept message shall not include PDN related\n    parameters, and the Downlink NAS transfer S1-AP message shall not\n    include Access stratum context related information but may include CSG\n    related information.\n\n     If the attach type is not set to \"Emergency\", and the ESM container\n    was included in Attach Request in step\u00c2\u00a01, and the UE indicated support\n    of Attach without PDN Connection in the Attach Request, and the MME\n    supports Attach without PDN Connection, and PDN connection restriction\n    is set in subscriber data, then the MME shall discard the ESM container\n    in the Attach Request message, and shall not include PDN related\n    parameters in the Attach Accept, but may include CSG related\n    information.\n\n     In the Attach Accept message, the MME does not include the IPv6 prefix\n    within the PDN Address. The MME includes the EPS Bearer QoS parameter\n    QCI and APN-AMBR into the Session Management Request. Furthermore, if\n    the UE has UTRAN or GERAN capabilities and the network supports\n    mobility to UTRAN or GERAN, the MME uses the EPS bearer QoS information\n    to derive the corresponding PDP context parameters QoS Negotiated (R99\n    QoS profile), Radio Priority, Packet Flow Id and TI and includes them\n    in the Session Management Request. If the UE indicated in the UE\n    Network Capability it does not support BSS packet flow procedures, then\n    the MME shall not include the Packet Flow Id. Handover Restriction List\n    is described in clause\u00c2\u00a04.3.5.7 \"Mobility Restrictions\". The MME sets\n    the IMS Voice over PS session supported Indication as described in\n    clause\u00c2\u00a04.3.5.8. LCS Support Indication indicates whether the network\n    supports the EPC-MO-LR and/or CS-MO-LR as described in TS\u00c2\u00a023.271\u00c2\u00a0[57].\n    The MME may include an indication whether the traffic of this PDN\n    Connection is allowed to be offloaded to WLAN, as described in\n    clause\u00c2\u00a04.3.23. Indication for support of 15 EPS bearers per UE\n    indicates the network support for up to 15 EPS bearers per UE as\n    defined in clause\u00c2\u00a04.12.\n\n     If the UE initiates the Attach procedure at a hybrid cell, the MME\n    shall check whether the CSG ID is contained in the CSG subscription and\n    is not expired. The MME shall send an indication whether the UE is a\n    CSG member to the RAN along with the S1-MME control message. Based on\n    this information the RAN may perform differentiated treatment for CSG\n    and non-CSG members.\n\n     If the MME or PDN GW has changed the PDN Type, an appropriate reason\n    cause shall be returned to the UE as described in clause\u00c2\u00a05.3.1.1. If\n    the UE has indicated PDN type \"Non-IP\" or \"Ethernet\", the MME and PDN\n    GW shall not change PDN type.\n\n     For an emergency attached UE, i.e. for UEs that have only emergency\n    EPS bearers established, there is no AS security context information\n    included in the S1 control messages and there is no NAS level security\n    when the UE cannot be authenticated. The Emergency Service Support\n    indicator informs the UE that Emergency bearer services are supported,\n    i.e. the UE is allowed to request PDN connectivity for emergency\n    services.\n\n     For RLOS attached UEs, i.e. for UEs that have only RLOS PDN connection\n    established, there is no AS security context information included in\n    the S1 control messages and there is no NAS level security when the UE\n    cannot be successfully authenticated.\n\n     If the UE included extended idle mode DRX parameters information\n    element, the MME includes extended idle mode DRX parameters information\n    element if it decides to enable extended idle mode DRX with Paging Time\n    Window length assigned considering Subscribed Paging Time Window (if\n    available) and the local policy.\n\n     If the UE included support for restriction of use of Enhanced Coverage\n    in step\u00c2\u00a01, the MME sends Enhanced Coverage Restricted parameter to the\n    eNB in S1-AP Initial Context Set-up Request message. MME also sends\n    Enhanced Coverage Restricted parameter to the UE in the Attach Accept\n    message.\n\n     If the UE has indicated support for dual connectivity with NR in the\n    Attach Request and the UE is not allowed to use NR as Secondary RAT,\n    the MME indicates that to the UE in the Attach Accept message.\n\n     If RACS is supported in the MME and MME has received UE Radio\n    Capability ID earlier in this procedure, it signals the UE Radio\n    Capability ID to the eNB in S1-AP Initial Context Set-up Request\n    message. If the eNB does not have mapping between the specific UE Radio\n    Capability ID and the UE radio capabilities, it shall use the procedure\n    described in TS\u00c2\u00a036.413\u00c2\u00a0[36] to retrieve the mapping from the MME.\n\n  18.  If the eNodeB received an S1-AP Initial Context Setup Request the\n    eNodeB sends the RRC Connection Reconfiguration message including the\n    EPS Radio Bearer Identity to the UE, and the Attach Accept message will\n    be sent along to the UE.\n\n     If the eNodeB received an S1-AP Downlink NAS Transport message (e.g.\n    containing the Attach Accept message), the eNode B sends a RRC Direct\n    Transfer message to the UE.\n\n     The UE shall store the QoS Negotiated, Radio Priority, Packet Flow Id\n    and TI, which it received in the Session Management Request, for use\n    when accessing via GERAN or UTRAN. The APN is provided to the UE to\n    notify it of the APN for which the activated default bearer is\n    associated. For further details, see TS\u00c2\u00a036.331\u00c2\u00a0[37]. The UE may provide\n    EPS Bearer QoS parameters to the application handling the traffic\n    flow(s). The application usage of the EPS Bearer QoS is implementation\n    dependent. The UE shall not reject the RRC Connection Reconfiguration\n    on the basis of the EPS Bearer QoS parameters contained in the Session\n    Management Request.\n\n     If the UE receives Enhanced Coverage Restricted parameter in the\n    Attach Accept message, UE shall store this information and shall use\n    the value of Enhanced Coverage Restricted parameter to determine if\n    enhanced coverage feature should be used or not. If the UE receives a\n    Service Gap Time in the Attach Accept message, the UE shall store this\n    parameter and apply Service Gap Control (see clause\u00c2\u00a04.3.17.9).\n\n     If the attach procedure is initiated by manual CSG selection and\n    occurs via a CSG cell, the UE upon receiving the Attach accept shall\n    check if the CSG ID and associated PLMN of the cell where the UE has\n    sent the Attach Request message is contained in its Allowed CSG list.\n    If the CSG ID and associated PLMN is not in the UE's Allowed CSG list,\n    the UE shall add the CSG ID and associated PLMN to its Allowed CSG\n    list. Manual CSG selection is not supported when an emergency service\n    has been initiated.\n\n  NOTE\u00c2\u00a013: If the UE receives an Attach Accept message via a hybrid cell,\n         the UE does not add the corresponding CSG ID and associated PLMN to\n         its Allowed CSG list. Adding a CSG ID and associated PLMN to the\n         UE's local Allowed CSG list for a hybrid cell is performed only by\n         OTA or OMA DM procedures.\n\n     When receiving the Attach Accept message the UE shall set its TIN to\n    \"GUTI\" as no ISR Activated is indicated.\n\n     If the UE receives an IPv4 address set to 0.0.0.0, it may negotiate\n    the IPv4 address with DHCPv4 as specified in TS\u00c2\u00a029.061\u00c2\u00a0[38]. If the UE\n    receives an IPv6 interface identifier, it may wait for the Router\n    Advertisement from the network with the IPv6 prefix information or it\n    may send a Router Solicitation if necessary.\n\n  NOTE\u00c2\u00a014: The IP address allocation details are described in clause 5.3.1\n         on \"IP Address Allocation\".\n\n     If Control Plane CIoT EPS Optimisation applies or the UE has not\n    included the ESM message container in the Attach Request in step\u00c2\u00a01,\n    then the steps 19 and 20 are not executed.\n\n  19.  The UE sends the RRC Connection Reconfiguration Complete message to\n    the eNodeB. For further details, see TS\u00c2\u00a036.331\u00c2\u00a0[37].\n\n  20.  The eNodeB sends the Initial Context Response message to the new\n    MME. This Initial Context Response message includes the TEID of the\n    eNodeB and the address of the eNodeB used for downlink traffic on the\n    S1_U reference point.\n\n     The MME shall be prepared to receive this message either before or\n    after the Attach Complete message (sent in step\u00c2\u00a022).\n\n     If the Correlation ID or SIPTO Correlation ID was included in the\n    Initial Context Setup Request message, the eNodeB shall use the\n    included information to establish direct user plane path with the L-GW\n    and forward uplink data for Local IP Access or SIPTO at the Local\n    Network with L-GW function collocated with the (H)eNB accordingly.\n\n  21.  The UE sends a Direct Transfer message to the eNodeB, which includes\n    the Attach Complete (EPS Bearer Identity, NAS sequence number, NAS-MAC)\n    message. If the UE omitted the ESM message container from the Attach\n    Request message in step\u00c2\u00a01, then the EPS Bearer Identity is omitted from\n    the Attach Complete message.\n\n  22.  The eNodeB forwards the Attach Complete message to the new MME in an\n    Uplink NAS Transport message.\n\n     If the ESM message container was included in step\u00c2\u00a01, after the Attach\n    Accept message and once the UE has obtained (if applicable to the PDN\n    type) a PDN Address, the UE can then send uplink packets towards the\n    eNodeB which will then be tunnelled to the Serving GW and PDN GW. If\n    Control Plane CIoT EPS Optimisations apply, UL data is sent as\n    specified in clause\u00c2\u00a05.3.4B. If the UE requested for a dual address PDN\n    type (IPv4v6) to a given APN and was granted a single address PDN type\n    (IPv4 or IPv6) by the network with a reason cause indicating that only\n    single IP version per PDN connection is allowed sent together with the\n    PDN type, the UE should request for the activation of a parallel PDN\n    connection to the same APN with a single address PDN type (IPv4 or\n    IPv6) other than the one already activated. If the UE receives no\n    reason cause in step\u00c2\u00a018 in response to an IPv4v6 PDN type and it\n    receives an IPv6 Interface Identifier apart from the IPv4 address or\n    0.0.0.0 in the PDN Address field, it considers that the request for a\n    dual address PDN was successful. It can wait for the Router\n    Advertisement from the network with the IPv6 prefix information or it\n    may send Router Solicitation if necessary.\n\n  23.  Upon reception of both, the Initial Context Response message in\n    step\u00c2\u00a020 and the Attach Complete message in step\u00c2\u00a022, the new MME sends a\n    Modify Bearer Request (EPS Bearer Identity, eNodeB address, eNodeB\n    TEID, Handover Indication, Presence Reporting Area Information, RAT\n    type, LTE-M RAT type reporting to PGW) message to the Serving GW. If\n    the Control Plane CIoT EPS Optimisation applies and the PDN connection\n    is not served by a SCEF and if the MME does not need to report a change\n    of UE presence in Presence Reporting Area, sending of Modify Bearer\n    Request and steps 23a, 23b and 24 are skipped; otherwise if the PDN\n    connection is served by SCEF, steps 23,24, 25, and 26 are not executed.\n    If the MME has been requested to report a change of UE presence in\n    Presence Reporting Area, the MME includes in this message the Presence\n    Reporting Area Information comprising the PRA identifier(s) and\n    indication(s) on whether the UE is inside or outside the area(s). When\n    receiving the request for reporting change of UE presence in Presence\n    Reporting Area, and the MME decides not to activate reporting UE\n    presence in one or more of the received Presence Reporting Area(s), the\n    MME reports also the inactive Presence Reporting Area(s) in this\n    message. The RAT type information element is included if the UE is\n    using the LTE-M RAT type. If PDN GW expects the LTE-M RAT type\n    reporting as specified in clause\u00c2\u00a05.11.5, the MME also includes the LTE-\n    M RAT type reporting to PGW flag to indicate that the Serving GW needs\n    to forward the LTE-M RAT type to the PGW.\n\n  23a. If the Handover Indication is included in step 23, the Serving GW\n    sends a Modify Bearer Request (Handover Indication) message to the PDN\n    GW to prompt the PDN GW to tunnel packets from non 3GPP IP access to\n    3GPP access system and immediately start routing packets to the Serving\n    GW for the default and any dedicated EPS bearers established. If\n    Presence Reporting Area Information is included in step\u00c2\u00a023, the Serving\n    GW sends a Modify Bearer Request (Presence Reporting Area Information)\n    message to the PDN GW. If the LTE-M RAT type and the LTE-M RAT type\n    reporting to PGW flag were received at step\u00c2\u00a023, the Serving GW shall\n    include the LTE-M RAT type in the Modify Bearer Request message to the\n    PGW. Otherwise the Serving GW includes RAT type WB-E-UTRAN.\n\n  NOTE\u00c2\u00a015: The PDN GW is expected to handle the uplink packets sent by the\n         UE via 3GPP access after step\u00c2\u00a022, even if they arrive before path\n         switch in step\u00c2\u00a023.\n\n  NOTE\u00c2\u00a016: The PDN GW forwards the Presence Reporting Area Information to\n         the PCRF, to the OCS or to both as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  23b. The PDN GW acknowledges by sending Modify Bearer Response to the\n    Serving GW.\n\n  24.  The Serving GW acknowledges by sending Modify Bearer Response (EPS\n    Bearer Identity) message to the new MME. The Serving GW can then send\n    its buffered downlink packets.\n\n     If there is a \"Availability after DDN Failure\" monitoring event or a\n    \"UE Reachability\" monitoring event configured for the UE in the EMM\n    Context of the MME, the MME sends an event notification (see\n    TS\u00c2\u00a023.682\u00c2\u00a0[74] for further information).\n\n  25.  After the MME receives Modify Bearer Response (EPS Bearer Identity)\n    message, if Request Type does not indicate handover and an EPS bearer\n    was established and the subscription data indicates that the user is\n    allowed to perform handover to non-3GPP accesses, and if the MME\n    selected a PDN GW that is different from the PDN GW identity which was\n    indicated by the HSS in the PDN subscription context, the MME shall\n    send a Notify Request including the APN and PDN GW identity to the HSS\n    for mobility with non-3GPP accesses. The message shall include\n    information that identifies the PLMN in which the PDN\u00c2\u00a0GW is located.\n\n     If the ME identity of the UE has changed and step\u00c2\u00a08 has not been\n    performed, the MME sends a Notify Request (ME Identity) message to\n    inform the HSS of the updated ME identity.\n\n     For an unauthenticated or roaming UE, if the Request Type of the UE\n    requested connectivity procedure indicates \"Emergency\", the MME shall\n    not send any Notify Request to an HSS. For a non-roaming authenticated\n    UE, based on operator configuration (e.g. on whether Voice over WLAN is\n    supported or not by the operator, on whether the operator uses a fixed\n    PDN GW for emergency calls, etc.), if the Request Type indicates\n    \"Emergency\", the MME may send a Notify Request to the HSS including the\n    \"PDN GW currently in use for emergency services\", which comprises the\n    PDN GW address and an indication that the PDN connection is for\n    emergency services. The HSS shall store it as part of the UE context\n    for emergency services.\n\n     For any UEs, if Request Type of the UE requested connectivity\n    procedure indicates \"RLOS\", the MME shall not send any Notify Request\n    to an HSS.\n\n     After step\u00c2\u00a08, and in parallel to any of the preceding steps, the MME\n    shall send a Notify Request (Homogeneous Support of IMS Voice over PS\n    Sessions) message to the HSS:\n\n    -  If the MME has evaluated the support of IMS Voice over PS Sessions,\n       see clause\u00c2\u00a04.3.5.8, and\n\n    -  If the MME determines that it needs to update the Homogeneous\n       Support of IMS Voice over PS Sessions, see clause\u00c2\u00a04.3.5.8A.\n\n  26.  In the case of non-emergency services, the HSS stores the APN and\n    PDN GW identity pair. In the case of emergency services, the HSS stores\n    the \"PDN GW currently in use for emergency services\". The HSS then\n    sends a Notify Response to the MME.\n\n  NOTE\u00c2\u00a017: For handover from non-3GPP access, the PDN GW initiates resource\n         allocation deactivation procedure in the trusted/untrusted non-3GPP\n         IP access as specified in TS\u00c2\u00a023.402\u00c2\u00a0[2].\n\n\n"}, {"key": "UTRAN/GERAN Initial Attach", "numbering": "5.3.2.2", "title_level": 3, "desc": "5.3.2.2  UTRAN/GERAN Initial Attach\n\nWhen a UE attaches to UTRAN/GERAN, it executes the normal attach procedure\nas defined in TS\u00c2\u00a023.060\u00c2\u00a0[7]. When the UE needs an IP address, it initiates\nPDP context activation procedure as defined in TS\u00c2\u00a023.060\u00c2\u00a0[7].\n\nThis procedure along with PDP context activation is also used to establish\nthe first PDN connection over UTRAN/GERAN when the UE already has active\nPDN connections over a non-3GPP access network and wants to establish\nsimultaneous PDN connections to different APNs over multiple accesses.\n\n\n"}, {"key": "Tracking Area Update procedures", "numbering": "5.3.3", "title_level": 2, "desc": "5.3.3  Tracking Area Update procedures\n\n\n"}, {"key": "Triggers for tracking area update", "numbering": "5.3.3.0", "title_level": 3, "desc": "5.3.3.0  Triggers for tracking area update\n\nA stand-alone tracking area update (with or without S-GW change, described\nin clauses\u00c2\u00a05.3.3.1 and 5.3.3.2 respectively) occurs when a GPRS-attached or\nE-UTRAN-attached UE experiences any of the following conditions:\n\n  -  UE detects it has entered a new TA that is not in the list of TAIs\n    that the UE registered with the network (except for the case of a UE\n    configured to perform Attach with IMSI when entering a TA in a new non-\n    equivalent PLMN in RRC-IDLE mode);\n\n  -  the periodic TA update timer has expired;\n\n  -  UE was in UTRAN PMM_Connected state (e.g. URA_PCH) when it reselects\n    to E-UTRAN;\n\n  -  UE was in GPRS READY state when it reselects to E-UTRAN;\n\n  -  the TIN indicates \"P-TMSI\" when the UE reselects to E-UTRAN (e.g. due\n    to bearer configuration modifications performed on GERAN/UTRAN);\n\n  -  the RRC connection was released with release cause \"load re-balancing\n    TAU required\";\n\n  -  the RRC layer in the UE informs the UE's NAS layer that an RRC\n    connection failure (in either E-UTRAN or UTRAN) has occurred;\n\n  -  a change of the UE Network Capability and/or MS Network Capability\n    and/or UE Specific DRX Parameters and/or TS\u00c2\u00a024.008\u00c2\u00a0[47] MS Radio Access\n    capability (e.g. due to GERAN radio capability change, E-UTRAN, NG-RAN\n    capability change or cdma2000 Radio Access Technology Capability\n    change) information of the UE.\n\n  -  for UE supporting RACS in ECM-IDLE as defined in clause\u00c2\u00a05.11.3a, a\n    change in UE Radio Access capability (e.g. due to GERAN radio\n    capability change, E-UTRAN, NG-RAN capability change or cdma2000 Radio\n    Access Technology Capability change) corresponding to signalling a\n    different UE Radio Capability ID.\n\n  -  a change in conditions in the UE require a change in the extended idle\n    mode DRX parameters previously provided by the MME.\n\n  -  for a UE supporting CS fallback, or configured to support IMS voice,\n    or both, a change of the UE's usage setting or voice domain preference\n    for E-UTRAN.\n\n  -  for a SR-VCC capable UE, a change of MS Classmark 2 and/or MS\n    Classmark 3 and/or Supported Codecs.\n\n  -  UE manually selects a CSG cell whose CSG ID and associated PLMN is\n    absent from both the UE's Allowed CSG list and the UE's Operator CSG\n    list.\n\n  -  UE receives a paging request from the MME while the Mobility\n    Management back off timer is running and the UE's TIN indicates \"P-\n    TMSI\".\n\n  -  a change in any of the values of information included in Preferred\n    Network Behaviour as defined in clause\u00c2\u00a04.3.5.10 that would create\n    incompatibility with the Supported Network Behaviour provided by the\n    serving MME.\n\n  NOTE\u00c2\u00a01:  The complete list of TAU triggers is specified in\n         TS\u00c2\u00a024.301\u00c2\u00a0[46].\n\nThe procedure is initiated by an UE in either ECM-IDLE state or ECM-\nCONNECTED state. The decision to perform S-GW change during the tracking\narea update procedure is made by the MME independently from the triggers\nabove.\n\nIf SIPTO is allowed for the APN associated with a PDN connection, the MME\nshould re-evaluate whether the PDN\u00c2\u00a0GW location is still acceptable. If the\nMME determines that PDN GW re-location is needed, the MME may initiate PDN\ndeactivation with reactivation requested according to clause\u00c2\u00a05.10.3 at the\nend of the tracking area/routing area update procedure.\n\n  NOTE\u00c2\u00a02.  It depends on the operator's configuration in the MME whether to\n         use the deactivation with reactivation request or allow the\n         continued usage of the already connected GW.\n\nIf SIPTO at the local network is allowed for the APN associated with a PDN\nconnection the MME handles the SIPTO at the Local Network PDN connection as\nfollows.\n\n     For a L-GW collocated with (H)eNB:\n\n  -  For intra-MME mobility, upon completion of the TAU procedure the MME\n    shall deactivate the SIPTO at the local Network PDN connection with the\n    \"reactivation requested\" cause value according to clause\u00c2\u00a05.10.3. If the\n    UE has no other PDN connection, the MME initiates \"explicit detach with\n    reattach required\" procedure according to clause\u00c2\u00a05.3.8.3.\n\n  -  For Inter-MME/SGSN mobility, as part of the Tracking Area Update\n    procedure, the source MME shall remove the bearer(s) corresponding to\n    the SIPTO at Local Network PDN connection and shall release the core\n    network resources associated to the SIPTO at the Local Network PDN\n    connection by performing the MME-initiated PDN Connection Deactivation\n    before sending the Context Response message.\n\n     For a stand-alone GW:\n\n  -  For intra-MME mobility, upon completion of the TAU procedure the MME\n    checks that the Local Home Network ID has changed and decides whether\n    to deactivate the SIPTO at the local Network PDN connection with the\n    \"reactivation requested\" cause value according to clause\u00c2\u00a05.10.3. If the\n    UE has no other PDN connection, the MME initiates \"explicit detach with\n    reattach required\" procedure according to clause\u00c2\u00a05.3.8.3.\n\n  -  For Inter-MME/SGSN mobility, upon completion of the TAU/RAU procedure\n    the new MME/SGSN checks that the Local Home Network ID has changed and\n    decides whether to deactivate the SIPTO at the Local Network PDN\n    connection with the \"reactivation requested\" cause value according to\n    clause\u00c2\u00a05.10.3. If the UE has no other PDN connection, the MME initiates\n    \"explicit detach with reattach required\" procedure according to\n    clause\u00c2\u00a05.3.8.3.\n\nIf LIPA is active for a PDN connection of the UE, the source MME (or S4-\nSGSN) shall not include LIPA bearer(s) in the EPS bearer Context during\nTracking Area Update procedure and shall release the core network resources\nof this LIPA PDN connection by peforming the MME requested PDN\ndisconnection procedure according to steps\u00c2\u00a02 to 6 of clause\u00c2\u00a05.10.3 before\nit responds with the Context Response message in the case of inter-MME/SGSN\nmobility or after it receives Tracking Area Update Request in the case of\nintra-MME mobility.\n\n  NOTE\u00c2\u00a03:  The source MME may not be able to release the LIPA PDN\n         connection after the Context Response is sent as when there is no S-\n         GW relocation, the S-GW will assign the S11 control tunnel of the\n         UE to the new MME after the new MME updates the context\n         information.\n\nDuring the Tracking Area Update procedure, if the MME supports SRVCC and if\nthe UE SRVCC capability has changed, the MME informs the HSS with the UE\nSRVCC capability e.g. for further IMS registration.\n\nThe cell selection for UTRAN is described in TS\u00c2\u00a025.304\u00c2\u00a0[12] and\nTS\u00c2\u00a025.331\u00c2\u00a0[33].\n\nIf during the Tracking Area Update procedure the MME detects that the\nServing GW or/and the MME needs be relocated, the old MME may reject any\nPDN GW initiated EPS bearer(s) request received since the Tracking Area\nUpdate procedure started and if rejected, the old MME shall include an\nindication that the request has been temporarily rejected due to mobility\nprocedure in progress. The rejection is forwarded by the Serving GW to the\nPDN GW, with the indication that the request has been temporarily rejected.\n\nUpon reception of a rejection for an EPS bearer(s) PDN GW initiated\nprocedure with an indication that the request has been temporarily rejected\ndue to mobility procedure in progress, the PDN GW start a locally\nconfigured guard timer. The PDN GW shall re-attempt, up to a pre-configured\nnumber of times, when either it detects that the Tracking Area Update\nprocedure is completed or has failed using message reception or at expiry\nof the guard timer.\n\n\n"}, {"key": "Provision of UE's TAI to MME in ECM-CONNECTED state", "numbering": "5.3.3.0A", "title_level": 3, "desc": "5.3.3.0A Provision of UE's TAI to MME in ECM-CONNECTED state\n\nThe eNodeB shall include the TAI+ECGI of the current cell in every S1-AP\nUPLINK NAS TRANSPORT message. If Dual Connectivity is activated for the UE,\nthe eNodeB shall also include the PSCell ID in every S1-AP UPLINK NAS\nTRANSPORT message.\n\n  NOTE:  An eNodeB can contain cells from more than one Tracking Area and\n         intra-eNodeB cell changes are not normally notified to the MME.\n         However, the MME needs to know the UE's current TAI in order to\n         correctly produce a TAU accept message.\n\n\n"}, {"key": "Tracking Area Update procedure with Serving GW change", "numbering": "5.3.3.1", "title_level": 3, "desc": "5.3.3.1  Tracking Area Update procedure with Serving GW change\n\n                                    [pic]\n\n   Figure 5.3.3.1-1: Tracking Area Update procedure with Serving GW change\n\n  NOTE\u00c2\u00a01:  For a PMIP-based S5/S8, procedure steps (A) and (B) are defined\n         in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps 9 and 10 concern GTP based S5/S8.\n\n  NOTE\u00c2\u00a02:  In case of Tracking Area Update without MME change the\n         signalling in steps 4, 5, 7 and steps 12-17 are skipped.\n\n  1. One of the triggers described in clause\u00c2\u00a05.3.3.0 for starting the TAU\n    procedure occurs.\n\n  2. The UE initiates the TAU procedure by sending, to the eNodeB, a TAU\n    Request (UE Core Network Capability, MS Network Capability, Preferred\n    Network behaviour, Support for restriction of use of Enhanced Coverage,\n    old GUTI, Old GUTI type, last visited TAI, active flag, signalling\n    active flag, EPS bearer status, P-TMSI Signature, additional GUTI,\n    eKSI, NAS sequence number, NAS-MAC, KSI, Voice domain preference and\n    UE's usage setting, UE has UE Radio Capability ID assigned for the\n    selected PLMN) message together with RRC parameters indicating the\n    Selected Network and the old GUMMEI. An exception is that, if the TAU\n    was triggered for load re-balancing purposes (see clause\u00c2\u00a04.3.7.3), the\n    old GUMMEI is not included in the RRC parameters. The UE shall set the\n    Old GUTI Type to indicate whether the Old GUTI is a native GUTI or is\n    mapped from a P-TMSI and RAI.\n\n     If the UE's TIN indicates \"GUTI\" or \"RAT-related TMSI\" and the UE\n    holds a valid GUTI then the old GUTI indicates this valid GUTI. If the\n    UE's TIN indicates \"P-TMSI\" and the UE holds a valid P-TMSI and related\n    RAI then these two elements are indicated as the old GUTI. Mapping a P-\n    TMSI and RAI to a GUTI is specified in Annex\u00c2\u00a0H. When the UE is in\n    connected mode (e.g. in URA_PCH) when it reselects to E-UTRAN, the UE\n    shall set its TIN to \"P-TMSI\".\n\n     If the UE holds a valid GUTI and the old GUTI indicates a GUTI mapped\n    from a P-TMSI and RAI, then the UE indicates the GUTI as additional\n    GUTI. If the old GUTI indicates a GUTI mapped from a P-TMSI and RAI,\n    and the UE has a valid P-TMSI signature, the P-TMSI signature shall be\n    included.\n\n     The additional GUTI in the Tracking Area Update Request message allows\n    the new MME to find any already existing UE context stored in the new\n    MME when the old GUTI indicates a value mapped from a P-TMSI and RAI.\n\n     Alternatively, when a UE only supports E-UTRAN, it identifies itself\n    with the old GUTI and sets the Old GUTI Type to 'native'.\n\n     The RRC parameter \"old GUMMEI\" takes its value from the identifier\n    that is signalled as the old GUTI according to the rules above. For a\n    combined MME/SGSN the eNodeB is configured to route the MME-code(s) of\n    this combined node to the same combined node. This eNodeB is also\n    configured to route MME-code(s) of GUTIs that are generated by the UE's\n    mapping of the P-TMSIs allocated by the combined node. Such an eNodeB\n    configuration may also be used for separate nodes to avoid changing\n    nodes in the pool caused by inter RAT mobility.\n\n     The last visited TAI shall be included in order to help the MME\n    produce a good list of TAIs for any subsequent TAU Accept message.\n    Selected Network indicates the network that is selected. Active flag is\n    a request by UE to activate the radio and S1 bearers for all the active\n    EPS Bearers by the TAU procedure when the UE is in ECM-IDLE state.\n    Signalling active flag is a request by UE using Control Plane CIoT EPS\n    Optimisation to maintain the NAS signalling connection after Tracking\n    Area Update Procedure is completed in order to transmit pending Data\n    using the Data Transport in Control Plane CIoT EPS Optimisation or NAS\n    signalling. The EPS bearer status indicates each EPS bearer that is\n    active in the UE. The TAU Request message shall be integrity protected\n    by the NAS-MAC as described in TS\u00c2\u00a033.401\u00c2\u00a0[41]. eKSI, NAS sequence\n    number and NAS-MAC are included if the UE has valid EPS security\n    parameters. NAS sequence number indicates the sequential number of the\n    NAS message. KSI is included if the UE indicates a GUTI mapped from a P-\n    TMSI in the information element \"old GUTI\".\n\n     In the RRC connection establishment signalling associated with the TAU\n    Request, the UE indicates its support of the CIoT EPS Optimisations\n    relevant for MME selection.\n\n     For UE using CIoT EPS Optimisation without any activated PDN\n    connection, there is no active flag or EPS bearer status included in\n    the TAU Request message. For a UE with a running Service Gap timer in\n    the UE the UE shall not set the active flag and the signalling active\n    flag in the TAU request message (see clause\u00c2\u00a04.3.17.9).\n\n     If the UE has any PDN connection of PDN Type \"non-IP\" or \"Ethernet\",\n    the UE shall send the EPS bearer status in the TAU Request message.\n\n     The UE sets the voice domain preference and UE's usage setting\n    according to its configuration, as described in clause\u00c2\u00a04.3.5.9.\n\n     The UE includes extended idle mode DRX parameters information element\n    if it needs to enable extended idle mode DRX, even if extended idle\n    mode DRX parameters were already negotiated before.\n\n     If a UE includes a Preferred Network Behaviour, this defines the\n    Network Behaviour the UE is expecting to be available in the network as\n    defined in clause\u00c2\u00a04.3.5.10.\n\n     If the UE supports RACS as defined in clause\u00c2\u00a05.11.3a, and if the UE is\n    provisioned with a UE Radio Capability ID for use in the selected PLMN\n    (i.e.PLMN-assigned for the specific PLMN or manufacturer-assigned), the\n    UE includes a flag that indicates it has an assigned UE Radio\n    Capability ID for use in the selected PLMN but the actual UE Radio\n    Capability is provided to MME after security context is established in\n    step\u00c2\u00a06 (see below).\n\n  3. The eNodeB derives the MME address from the RRC parameters carrying\n    the old GUMMEI, the indicated Selected Network and the RAT (NB-IoT or\n    WB-E-UTRAN). If that MME is not associated with that eNodeB or the\n    GUMMEI is not available or the UE indicates that the TAU procedure was\n    triggered by load re-balancing, the eNodeB selects an MME as described\n    in clause 4.3.8.3 on \"MME Selection Function\".\n\n     The eNodeB forwards the TAU Request message together with the CSG\n    access mode, CSG ID, TAI+ECGI of the cell from where it received the\n    message and with the Selected Network to the new MME. CSG ID is\n    provided by RAN if the UE sends the TAU Request message via a CSG cell\n    or a hybrid cell. CSG access mode is provided if the UE sends the TAU\n    Request message via a hybrid cell. If the CSG access mode is not\n    provided but the CSG ID is provided, the MME shall consider the cell as\n    a CSG cell. For SIPTO at the Local Network with stand-alone GW\n    architecture the eNodeB includes the Local Home Network ID in the\n    Initial UE Message and in Uplink NAS Transport message if the target\n    cell is in a Local Home Network.\n\n     To assist Location Services, the eNB indicates the UE's Coverage Level\n    to the MME.\n\n  4. The new MME differentiates the type of the old node, i.e. MME or SGSN,\n    as specified in clause\u00c2\u00a04.3.19, uses the GUTI received from the UE to\n    derive the old MME/S4 SGSN address, and sends a Context Request (old\n    GUTI, complete TAU Request message, P-TMSI Signature, MME Address, UE\n    validated, CIoT EPS Optimisation support inidication) message to the\n    old MME/old S4 SGSN to retrieve user information. UE Validated\n    indicates that the new MME has validated the integrity protection of\n    the TAU message, e.g. based on native EPS security context for the UE.\n    To validate the Context Request the old MME uses the complete TAU\n    Request message and the old S4 SGSN uses the P-TMSI Signature and\n    responds with an appropriate error if integrity check fails in old\n    MME/S4 SGSN. This shall initiate the security functions in the new MME.\n    If the security functions authenticate the UE correctly, the new MME\n    shall send a Context Request (IMSI, complete TAU Request message, MME\n    Address, UE Validated) message to the old MME/S4 SGSN with the UE\n    Validated set. If the new MME indicates that it has authenticated the\n    UE or if the old MME/old S4 SGSN correctly validates the UE, then the\n    old MME/old S4\u00c2\u00a0SGSN starts a timer.\n\n     If the UE with emergency bearers is not authenticated in the old\n    MME/old S4 SGSN (in a network supporting unauthenticated UEs) the old\n    MME/old S4 SGSN continues the procedure with sending a Context Response\n    and starting the timer also when it cannot validate the Context\n    Request.\n\n     If a RLOS attached UE is not successfully authenticated in the old\n    MME, the old MME continues the procedure with sending a Context\n    Response and starting the existing timer also when it cannot validate\n    the Context Request.\n\n     If the new MME supports CIoT EPS Optimisation, CIoT EPS Optimisation\n    support indication is included in the Context Request indicating\n    support for various CIoT EPS Optimisations (e.g. support for header\n    compression for CP CIoT EPS Optimisation, etc.).\n\n  5. If the Context Request is sent to an old MME the old MME responds with\n    a Context Response (IMSI, ME Identity (IMEISV), MM Context, EPS Bearer\n    Context(s), Serving GW signalling Address and TEID(s), ISR Supported,\n    MS Info Change Reporting Action (if available), CSG Information\n    Reporting Action (if available), UE Time Zone, UE Core Network\n    Capability, UE Specific DRX Parameters, Remaining Running Service Gap\n    timer, LTE-M UE Indication) message. If the new MME supports CIoT EPS\n    Optimisation and the use of header compression has been negotiated\n    between the UE and the old MME, the Context Response also includes the\n    Header Compression Configuration which includes the information\n    necessary for the ROHC channel setup but not the RoHC context itself.\n\n     If the Context Request is sent to an old S4\u00c2\u00a0SGSN the old S4\u00c2\u00a0SGSN\n    responds with a Context Response (MM Context, EPS Bearer Context(s),\n    Serving GW signalling Address and TEID(s), ISR Supported, MS Info\n    Change Reporting Action (if available), CSG Information Reporting\n    Action (if available), UE Time Zone, UE Core Network Capability, UE\n    Specific DRX Parameters). If the source MME has not yet reported a non-\n    zero MO Exception Data Counter to the PDN GW, the Context Response also\n    includes the MO Exception Data Counter as described in TS\u00c2\u00a029.274\u00c2\u00a0[43].\n\n     The MM Context contains security related information as well as other\n    parameters (including IMSI and ME Identity (if available)) as described\n    in clause\u00c2\u00a05.7.2 (Information Storage for MME). The unused\n    Authentication Quintets in the MM Context are also maintained in the\n    SGSN. TS\u00c2\u00a033.401\u00c2\u00a0[41] gives further details on the transfer of security\n    related information.\n\n     If the MM Context received with the Context Response message did not\n    include IMEISV and the MME does not already store the IMEISV of the UE,\n    the MME shall retrieve the ME Identity (IMEISV) from the UE.\n\n     The PDN GW Address and TEID(s) (for GTP-based S5/S8) or GRE Keys (PMIP-\n    based S5/S8 at the PDN GW(s) for uplink traffic) and the TI(s), is part\n    of the EPS Bearer Context. If the UE is not known in the old MME/old\n    S4\u00c2\u00a0SGSN or if the integrity check for the TAU Request message fails,\n    the old MME/old S4\u00c2\u00a0SGSN responds with an appropriate error cause. ISR\n    Supported is indicated if the old MME/old S4 SGSN and associated\n    Serving GW are capable to activate ISR for the UE.\n\n     If the UE receives emergency bearer services from the old MME/old S4\n    SGSN and the UE is UICCless, IMSI can not be included in the Context\n    Response. For emergency attached UEs, if the IMSI cannot be\n    authenticated, then the IMSI shall be marked as unauthenticated. Also,\n    in this case, security parameters are included only if available.\n\n     For a RLOS attached UE, the old MME includes an RLOS indication to the\n    new MME. If the RLOS attached UE in the old MME does not have a USIM,\n    IMSI can not be included in the Context Response. If the RLOS attached\n    UE has USIM but the IMSI cannot be successfully authenticated, then the\n    IMSI shall be marked as unauthenticated. Also, in this case, security\n    parameters are included only if available.\n\n     If SIPTO at the Local Network is active for a PDN connection in the\n    architecture with stand-alone GW, the old MME/old S4 SGSN shall include\n    the Local Home Network ID of the old cell in the EPS Bearer context\n    corresponding to the SIPTO at the Local Network PDN connection.\n\n     For UE using CIoT EPS Optimisation without any activated PDN\n    connection, there is no EPS Bearer Context(s) included in the Context\n    Response message.\n\n     Based on the CIoT EPS Optimisation support indication, old MME only\n    transfers the EPS Bearer Context(s) that the new MME supports. If the\n    new MME does not support CIoT EPS Optimisation, EPS Bearer Context(s)\n    of non-IP PDN connection are not transferred to the new MME. If the new\n    MME does not support Ethernet PDN Type, EPS Bearer Context(s) of\n    Ethernet PDN type are not transferred to the new MME. If the EPS Bearer\n    Context(s) of a PDN connection has not been transferred, the old MME\n    shall consider all bearers of that PDN connection as failed and release\n    that PDN connection by triggering the MME requested PDN disconnection\n    procedure specified in clause\u00c2\u00a05.10.3. The buffered data in the old MME\n    is discarded after receipt of Context Acknowledgement.\n\n     If the EPS Bearer Context(s) are to be transferred to the new MME, the\n    old MME also includes the Serving GW IP address and TEID for both S1-U\n    and S11-U, if available.\n\n     If the Old MME is aware the UE is a LTE-M UE, it provides the LTE-M UE\n    Indication to the new MME.\n\n  6. If the integrity check of TAU Request message (sent in step\u00c2\u00a02) failed,\n    then authentication is mandatory. The authentication functions are\n    defined in clause\u00c2\u00a05.3.10 on \"Security Function\". Ciphering procedures\n    are described in clause\u00c2\u00a05.3.10 on \"Security Function\". If GUTI\n    allocation is going to be done and the network supports ciphering, the\n    NAS messages shall be ciphered.\n\n     If this TAU request is received for a UE which is already in\n    ECM_CONNECTED state and the PLMN-ID of the TAI sent by the eNodeB in\n    Step\u00c2\u00a03 is different from that of the GUTI, included in the TAU Request\n    message, the MME shall delay authenticating the UE until after Step\u00c2\u00a021\n    (TAU Complete message).\n\n  NOTE\u00c2\u00a03:  The MME delays the authentication such that the UE first updates\n         its registered PLMN-ID to the new PLMN-ID selected by the RAN\n         during handover. The new PLMN-ID is provided by the MME to the UE\n         as part of the GUTI in the TAU accept message in Step\u00c2\u00a020. Doing\n         this ensures that the same PLMN-ID is used in the derivation of the\n         Kasme key by both the network and the UE.\n\n     If the new MME is configured to allow emergency bearer services for\n    unauthenticated UE the new MME behave as follows:\n\n    -  where a UE has only emergency bearer services, the MME either skip\n       the authentication and security procedure or accepts that the\n       authentication may fail and continues the Tracking Area Update\n       procedure; or\n\n    -  where a UE has both emergency and non emergency bearer services and\n       authentication fails, the MME continues the Tracking Area Update\n       procedure and deactivates all the non-emergency PDN connections as\n       specified in clause\u00c2\u00a05.10.3.\n\n     If the new MME is configured to allow Restricted Local Operator\n    Services, the new MME, based on local regulation and operator policy,\n    may skip the authentication and security procedure, or may perform\n    authentication if security parameters are available, or obtainable from\n    HSS, and continues the Tracking Area Update procedure regardless of the\n    authentication result.\n\n     If the UE indicated it has a UE Radio Capability ID assigned for use\n    in the selected PLMN in step\u00c2\u00a02, the MME may request the UE to provide\n    the UE Radio Capability ID in Security Mode Command, if the MME needs\n    to get the UE Radio Capability ID from the UE e.g. at inter-PLMN\n    mobility. If enquired by the MME the UE shall include the UE Radio\n    Capability ID in Security Mode Command Accept for the supported UE\n    radio capabilities.\n\n  7. The MME (if the MME has changed then it is the new MME) determines to\n    relocate the Serving GW. The Serving GW is relocated when the old\n    Serving GW cannot continue to serve the UE. The MME (if the MME has\n    changed then it is the new MME) may also decide to relocate the Serving\n    GW if a new Serving GW is expected to serve the UE longer and/or with a\n    more optimal UE to PDN GW path, or if a new Serving GW can be co-\n    located with the PDN GW. Selection of a new Serving GW is performed\n    according to clause\u00c2\u00a04.3.8.2 on \"Serving GW selection function\".\n\n     If the MME has changed the new MME sends a Context Acknowledge\n    (Serving GW change indication) message to the old MME/old S4 SGSN.\n    Serving GW change indication indicates a new Serving GW has been\n    selected. The old MME/old S4 SGSN marks in its UE context that the\n    information in the GWs is invalid. And, if the old node is an MME, the\n    old MME marks in its UE context that the information in the HSS is\n    invalid. This ensures that the old MME/old S4 SGSN updates the GWs, and\n    the old MME updates the HSS, if the UE initiates a TAU or RAU procedure\n    back to the old MME/old S4 SGSN before completing the ongoing TAU\n    procedure.\n\n  NOTE\u00c2\u00a04:  Updating the GWs refers to deletion of session(s) on the Serving\n         GW followed by re-creation of session(s) on the Serving GW. The re-\n         creation of session(s) on the Serving GW will result in successful\n         re-establishment of the S5/S8 tunnel between the selected Serving\n         GW and the PDN GW.\n\n     If the security functions do not authenticate the UE correctly, then\n    the TAU shall be rejected, and the new MME shall send a reject\n    indication to the old MME/old S4 SGSN. The old MME/old S4 SGSN shall\n    continue as if the Identification and Context Request was never\n    received.\n\n     ISR is not indicated in the Context Acknowledge as ISR is not\n    activated due to the S-GW change.\n\n     For UE using CIoT EPS Optimisation without any activated PDN\n    connection, the steps 8, 9, 10, 11, 18 and 19 are skipped.\n\n  8. If the MME has changed the new MME verifies the EPS bearer status\n    received from the UE with the bearer contexts received from the old\n    MME/old S4 SGSN. If the MME has not changed the MME verifies EPS bearer\n    status from the UE with the bearer contexts available in the MM\n    context. The MME releases any network resources related to EPS bearers\n    that are not active in the UE. If there is no bearer context at all,\n    the MME rejects the TAU Request.\n\n     If the MME selected a new Serving GW it sends a Create Session Request\n    (IMSI, bearer contexts, MME Address and TEID, Type, the Protocol Type\n    over S5/S8, RAT type, LTE-M RAT type reporting to PGW flag, Serving\n    Network, UE Time Zone, MO Exception data counter) message per PDN\n    connection to the selected new Serving GW. The PDN GW address and TFT\n    (for PMIP-based S5/S8) are indicated in the bearer Contexts. Type\n    indicates to the Serving GW to send the Modify Bearer Request to the\n    PDN GW. The Protocol Type over S5/S8 is provided to Serving GW which\n    protocol should be used over S5/S8 interface. RAT type indicates a\n    change in radio access. If it is a mobility from a SGSN to a MME and if\n    the MME supports location information change reporting, the MME shall\n    include the User Location Information (according to the supported\n    granularity) in the Create Session Request, regardless of whether\n    location information change reporting had been requested in the\n    previous RAT by the PDN GW. If it is an inter MME mobility and if the\n    PDN GW requested location information change reporting, the MME\n    includes the User Location Information IE in this message if it is\n    different compared to the previously sent information. If the PDN GW\n    requested User CSG information, the MME also includes the User CSG\n    Information IE in this message. If Control Plane CIoT EPS Optimisation\n    applies, the MME may also indicate S11-U tunnelling of NAS user data\n    and send its own S11-U IP address and MME DL TEID for DL data\n    forwarding by the SGW. The MME shall include the MO Exception data\n    counter if it has received the counter for RRC cause \"MO Exception\n    data\" in the Context Response message.\n\n     If only the Control Plane CIoT EPS Optimisation is used, the MME shall\n    include a Control Plane Only PDN Connection Indicator in Create Session\n    Request.\n\n     If the new MME receives the EPS bearer context with SCEF, then the new\n    MME updates the SCEF as defined in TS\u00c2\u00a023.682\u00c2\u00a0[74].\n\n     If the UE is using the LTE-M RAT type and the PDN GW expects the LTE-M\n    RAT type reporting as specified in clause\u00c2\u00a05.11.5, the MME also includes\n    the LTE-M RAT type reporting to PGW flag to indicate to the Serving GW\n    to forward the LTE-M RAT type to the PDN GW.\n\n  9. The Serving GW informs the PDN\u00c2\u00a0GW(s) about the change of for example\n    the RAT type that e.g. can be used for charging, by sending the message\n    Modify Bearer Request (Serving GW Address and TEID, RAT type, Serving\n    Network, PDN Charging Pause Support Indication) per PDN connection to\n    the PDN\u00c2\u00a0GW(s) concerned. User Location Information IE and/or UE Time\n    Zone IE and/or User CSG Information IE and/or MO Exception data counter\n    are also included if they are present in step\u00c2\u00a08. The Serving GW and PDN\n    GW indicate each use of the RRC establishment cause \"MO Exception Data\"\n    by the related counter on its CDR.\n\n     If the Serving GW has received the Control Plane Only PDN Connection\n    Indicator in step\u00c2\u00a08, the Serving GW indicates the use of CP only on its\n    CDR.\n\n     If LTE-M RAT type and the LTE-M RAT type reporting to PGW flag were\n    received at step\u00c2\u00a08, the Serving GW shall include the LTE-M RAT type in\n    the Modify Bearer Request message to the PGW. Otherwise the Serving GW\n    includes RAT type WB-E-UTRAN.\n\n  9a If dynamic PCC is deployed, and RAT type information needs to be\n    conveyed from the PDN\u00c2\u00a0GW to the PCRF, then the PDN\u00c2\u00a0GW shall send RAT\n    type information to the PCRF by means of an IP-CAN Session Modification\n    procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  NOTE\u00c2\u00a05:  The PDN\u00c2\u00a0GW does not need to wait for the PCRF response, but\n         continues in the next step. If the PCRF response leads to an EPS\n         bearer modification the PDN\u00c2\u00a0GW should initiate a bearer update\n         procedure.\n\n  10.  The PDN GW updates its bearer contexts and returns a Modify Bearer\n    Response (MSISDN, Charging Id, PDN Charging Pause Enabled Indication\n    (if PDN GW has chosen to enable the function)) message. The MSISDN is\n    included if the PDN GW has it stored in its UE context. If there has\n    been a RAT change towards E-UTRAN and location information change\n    reporting is required and supported in the target MME, the PDN\u00c2\u00a0GW shall\n    provide MS Info Change Reporting Action in the Modify Bearer Response.\n\n     If the Serving GW is relocated, the PDN GW shall send one or more \"end\n    marker\" packets on the old path immediately after switching the path in\n    order to assist the reordering function in the target eNodeB. If the\n    Serving GW has no downlink user plane established, the Serving GW shall\n    discard the \"end marker\" received from the PDN GW and shall not send\n    Downlink Data Notification. Otherwise the Serving GW shall forward the\n    \"end marker\" packets to the source eNodeB or source S4 SGSN.\n\n  11.  The Serving GW updates its bearer context. This allows the Serving\n    GW to route bearer PDUs to the PDN GW when received from eNodeB.\n\n     The Serving GW returns a Create Session Response (Serving GW address\n    and TEID for user plane and control plane and PDN\u00c2\u00a0GW TEIDs (for GTP-\n    based S5/S8) or GRE keys (for PMIP-based S5/S8) for uplink traffic and\n    control plane, MS Info Change Reporting Action) message to the new MME.\n\n     If Control Plane CIoT EPS Optimisation applies and if the MME does not\n    include Control Plane Only PDN Connection Indicator in the Create\n    Session Request:\n\n    -  If separation of S11-U from S1-U is required, the Serving GW shall\n       include the Serving GW IP address and TEID for S11-U and additionally\n       the Serving GW IP address and TEID for S1-U in the Create Session\n       Response.\n\n    -  Otherwise, if separation of S11-U from S1-U is not required, the\n       Serving GW includes the Serving GW IP address and TEID for S11-U in\n       Create Session Response.\n\n     When the MME receives the Create Session Response message, the MME\n    checks if there is a \"Availability after DDN Failure\" monitoring event\n    or a \"UE Reachability\" monitoring event configured for the UE in the\n    MME and in such a case sends an event notification (see TS\u00c2\u00a023.682\u00c2\u00a0[74]\n    for further information).\n\n  12.  The new MME verifies whether it holds subscription data for the UE\n    identified by the GUTI, the additional GUTI or by the IMSI received\n    with the context data from the old CN node.\n\n     If there are no subscription data in the new MME for this UE, or for\n    some network sharing scenario (e.g. GWCN) if the PLMN-ID of the TAI\n    supplied by the eNodeB is different from that of the GUTI in the UE's\n    context, then the new MME sends an Update Location Request (MME\n    Identity, IMSI, ULR-Flags, MME Capabilities, Homogeneous Support of IMS\n    Voice over PS Sessions, UE SRVCC capability, equivalent PLMN list, ME\n    Identity (IMEISV)) message to the HSS. ULR-Flags indicates that update\n    location is sent from an MME and the MME registration shall be updated\n    in HSS. The HSS does not cancel any SGSN registration. The MME\n    capabilities indicate the MME's support for regional access\n    restrictions functionality. The inclusion of the equivalent PLMN list\n    indicates that the MME supports the inter-PLMN handover to a CSG cell\n    in an equivalent PLMN using the subscription information of the target\n    PLMN. The \"Homogenous Support of IMS Voice over PS Sessions\" indication\n    (see clause\u00c2\u00a04.3.5.8A) shall not be included unless the MME has\n    completed its evaluation of the support of \"IMS Voice over PS Session\"\n    as specified in clause\u00c2\u00a04.3.5.8. The ME Identity is included if step\u00c2\u00a05\n    caused the MME to retrieve the IMEISV from the UE.\n\n  NOTE\u00c2\u00a06:  At this step, the MME may not have all the information needed to\n         determine the setting of the IMS Voice over PS Session Supported\n         indication for this UE (see clause\u00c2\u00a04.3.5.8). Hence the MME can send\n         the \"Homogenous Support of IMS Voice over PS Sessions\" later on in\n         this procedure.\n\n     If the UE initiates the TAU procedure in a VPLMN supporting Autonomous\n    CSG Roaming and the HPLMN has enabled Autonomous CSG Roaming in the\n    VPLMN (via Service Level Agreement) and the MME needs to retrieve the\n    CSG subscription information of the UE from the CSS, the MME initiates\n    the Update CSG Location Procedure with CSS as described in\n    clause\u00c2\u00a05.3.12.\n\n     If the MME determines that only the UE SRVCC capability has changed,\n    the MME sends a Notify Request to the HSS to inform about the changed\n    UE SRVCC capability.\n\n     If all the EPS bearers of the UE have emergency ARP value, the new MME\n    may skip the update location procedure or proceed even if the update\n    location fails.\n\n     If the UE is RLOS attached, the new MME skips the Update Location\n    procedure.\n\n  13.  The HSS sends the message Cancel Location (IMSI, Cancellation Type)\n    to the old MME with Cancellation Type set to Update Procedure.\n\n  14.  If the timer started in step 4 is not running, the old MME removes\n    the MM context. Otherwise, the contexts are removed when the timer\n    expires. It also ensures that the MM context is kept in the old MME for\n    the case the UE initiates another TAU procedure before completing the\n    ongoing TAU procedure to the new MME. The old MME acknowledges with the\n    message Cancel Location Ack (IMSI).\n\n  15.  When old S4 SGSN receives the Context Acknowledge message and if the\n    UE is in Iu Connected, the old S4\u00c2\u00a0SGSN sends an Iu Release Command\n    message to the RNC after the timer started in step\u00c2\u00a04 has expired.\n\n  16.  The RNC responds with an Iu Release Complete message.\n\n  17.  The HSS acknowledges the Update Location Request message by sending\n    an Update Location Ack (IMSI, Subscription Data) message to the new\n    MME. The Subscription Data may contain the CSG subscription data for\n    the registered PLMN and for the equivalent PLMN list requested by MME\n    in step\u00c2\u00a012.\n\n     The subscription data may contain Enhanced Coverage Restricted\n    parameter. If received from the HSS, MME stores this Enhanced Coverage\n    Restricted parameter in the MME MM context.\n\n     The subscription data may contain a Service Gap Time. If received from\n    the HSS, the MME stores this Service Gap Time in the MME MM context for\n    the UE and passes it to the UE in the Tracking Area Update Accept\n    message.\n\n     The subscription data may contain Subscribed Paging Time Window\n    parameter that applies to the UEs on a specific RAT, e.g. NB-IoT. If\n    received from the HSS, MME stores this Subscribed Paging Time Window\n    parameter in the MME MM context.\n\n     If the Update Location is rejected by the HSS, the new MME rejects the\n    TAU Request from the UE with an appropriate cause. In such cases, the\n    new MME releases any local MME EPS Bearer contexts for this particular\n    UE, and additionally deletes the EPS bearer resources in the new\n    Serving GW by sending the Delete Session Request (Cause, Operation\n    Indication) messages to the new Serving GW. The Operation Indication\n    flag shall not be set. Therefore, the new Serving GW receiving this\n    request shall not initiate a delete procedure towards the PDN GW.\n\n     If the UE initiates the TAU procedure at a CSG cell, the new MME shall\n    check whether the CSG ID and associated PLMN is contained in the CSG\n    subscription and is not expired. If the CSG ID and associated PLMN is\n    not present or expired, the MME shall send a Tracking Area Update\n    reject message to the UE with an appropriate cause value. The UE shall\n    remove the CSG ID and associated PLMN from its Allowed CSG list if\n    present. If the UE has ongoing emergency bearer services no CSG access\n    control shall be performed.\n\n     If all checks are successful then the new MME constructs a context for\n    the UE.\n\n  18.  If the MME has changed, when the timer started in step\u00c2\u00a04 expires the\n    old MME/old S4 SGSN releases any local MME or SGSN bearer resources and\n    additionally the old MME/old S4 SGSN deletes the EPS bearer resources\n    by sending the Delete Session Request (Cause, Operation Indication)\n    messagesto the old Serving GW if it received the Serving GW change\n    indication in the Context Acknowledge message in step\u00c2\u00a07. When the\n    Operation Indication flag is not set, that indicates to the old Serving\n    GW that the old Serving GW shall not initiate a delete procedure\n    towards the PDN GW. If ISR is activated the Cause indicates to the old\n    S-GW that the old S-GW shall delete the bearer resources on the other\n    old CN node by sending Delete Bearer Request message(s) to that CN\n    node.\n\n     If the MME has not changed, step 11 triggers the release of the EPS\n    bearer resources at the old Serving GW.\n\n  19.  The Serving GW acknowledges with Delete Session Response (Cause)\n    messages. The Serving GW discards any packets buffered for the UE.\n\n  20.  If due to regional subscription restrictions or access restrictions\n    (e.g. CSG restrictions) (received in update location procedure in\n    step\u00c2\u00a017) the UE is not allowed to access the TA:\n\n    -  The MME rejects the Tracking Area Update Request with an appropriate\n       cause to the UE.\n\n    -  For UEs with emergency EPS bearers, i.e. at least one EPS bearer has\n       an ARP value reserved for emergency services, the new MME accepts the\n       Tracking Area Update Request and deactivates all non-emergency PDN\n       connections as specified in clause\u00c2\u00a05.10.3. If the Tracking Area\n       Update procedure is initiated in ECM-IDLE state, all non-emergency\n       EPS bearers are deactivated by the Tracking Area Update procedure\n       without bearer deactivation signalling between the UE and the MME.\n\n     The MME sends a TAU Accept (GUTI, TAI list, EPS bearer status, NAS\n    sequence number, NAS-MAC, IMS Voice over PS session supported,\n    Emergency Service Support indicator, LCS Support Indication, Supported\n    Network Behaviour, Service Gap Time, Enhanced Coverage Restricted,\n    Indication of support of 15 EPS bearers per UE) message to the UE. If\n    the active flag is set the MME may provide the eNodeB with Handover\n    Restriction List. GUTI is included if the MME allocates a new GUTI. If\n    the active flag is set in the TAU Request message the user plane setup\n    procedure can be activated in conjunction with the TAU Accept message.\n    If the DL Data Buffer Expiration Time for the UE in the MME has not\n    expired, the user plane setup procedure is activated even if the MME\n    did not receive the active flag in the TAU Request message. If the new\n    MME receives the Downlink Data Notification message or any downlink\n    signalling message while the UE is still connected, the user plane\n    setup procedure may be activated even if the new MME did not receive\n    the active flag in the TAU Request message. The procedure is described\n    in detail in TS\u00c2\u00a036.300\u00c2\u00a0[5]. The message sequence should be the same as\n    for the UE triggered Service Request procedure specified in clause\n    5.3.4.1 from the step when MME establishes the bearer(s). The MME\n    indicates the EPS bearer status IE to the UE. The UE removes any\n    internal resources related to bearers that are not marked active in the\n    received EPS bearer status. If the EPS bearer status information was in\n    the TAU Request, the MME shall indicate the EPS bearer status to the\n    UE. Handover Restriction List is described in clause\u00c2\u00a04.3.5.7 \"Mobility\n    Restrictions\". The MME sets the IMS Voice over PS session supported as\n    described in clause\u00c2\u00a04.3.5.8.\n\n     For UE using CIoT EPS Optimisation without any activated PDN\n    connection, there is no EPS bearer status included in the TAU Accept\n    message.\n\n     The MME indicates the CIoT EPS Optimisations it supports and prefers\n    in the Supported Network Behaviour information as defined in\n    clause\u00c2\u00a04.3.5.10.\n\n     If there is a Service Gap timer running for the UE in the MME, and the\n    active flag or the signalling active flag is received in the TAU\n    Request message, the MME shall ignore the active flag and signalling\n    active flag and not perform any of the actions related to these flags.\n\n     The MME shall include the Service Gap Time in the TAU Accept message\n    if the UE has indicated Service Gap Control capability and either if\n    Service Gap Time was received in step\u00c2\u00a017 from HSS in the subscription\n    information or if the Service Gap Time in the subscription information\n    has been updated by HSS User Profile management (i.e. the Insert\n    Subscriber Data procedure in clause\u00c2\u00a05.3.9.2).\n\n     If the UE included support for restriction of use of Enhanced Coverage\n    in step\u00c2\u00a01, the MME sends Enhanced Coverage Restricted parameter to the\n    eNB in the S1-AP message as defined in clause\u00c2\u00a04.3.28. The MME also\n    sends the Enhanced Coverage Restricted parameter to the UE in the TAU\n    Accept message. UE shall store Enhanced Coverage Restricted parameter\n    and shall use the value of Enhanced Coverage Restricted parameter to\n    determine if enhanced coverage feature should be used or not.\n\n     If the MME successfully obtained Header Compression Configuration\n    parameters in step\u00c2\u00a05 it indicates the continued use of previous\n    negotiated configuration to the UE in the Header Compression Context\n    Status for each EPS Bearer of the UE. When Header Compression Context\n    Status indicates that the previous negotiated configuration can no\n    longer be used for some EPS bearers, the UE shall stop performing\n    header compression and decompression, when sending or receiving data\n    using Control Plane CIoT EPS Optimisation on these EPS bearers.\n\n     If the MME did not receive the Voice Support Match Indicator in the MM\n    Context, then the MME may send a UE Radio Capability Match Request to\n    the eNB as described in clause\u00c2\u00a05.3.14. If the MME hasn't received Voice\n    Support Match Indicator from the eNB then, based on implementation, MME\n    may set IMS Voice over PS session supported Indication and update it at\n    a later stage. After step\u00c2\u00a012, and in parallel to any of the preceding\n    steps, the MME shall send a Notify Request (Homogeneous Support of IMS\n    Voice over PS Sessions) message to the HSS:\n\n    -  If the MME has evaluated the support of IMS Voice over PS Sessions,\n       see clause\u00c2\u00a04.3.5.8, and\n\n    -  If the MME determines that it needs to update the Homogeneous\n       Support of IMS Voice over PS Sessions, see clause\u00c2\u00a04.3.5.8A.\n\n     The Emergency Service Support indicator informs the UE that Emergency\n    bearer services are supported. LCS Support Indication indicates whether\n    the network supports the EPC-MO-LR and/or CS-MO-LR as described in\n    TS\u00c2\u00a023.271\u00c2\u00a0[57]. Indication for support of 15 EPS bearers per UE\n    indicates the network support for up to 15 EPS bearers per UE as\n    defined in clause\u00c2\u00a04.12.\n\n     If the UE included extended idle mode DRX parameters information\n    element, the MME includes extended idle mode DRX parameters information\n    element if it decides to enable extended idle mode DRX with Paging Time\n    Window length assigned considering Subscribed Paging Time Window (if\n    available) and the local policy.\n\n     When receiving the TAU Accept message and there is no ISR Activated\n    indication the UE shall set its TIN to \"GUTI\".\n\n     For a S-GW change, ISR Activated is never indicated by the MME as it\n    needs a RAU with the same S-GW first to activate ISR. For an MME\n    change, ISR is not activated by the new MME to avoid context transfer\n    procedures with two old CN nodes.\n\n     If the TAU procedure is initiated by manual CSG selection and occurs\n    via a CSG cell, the UE upon receiving the TAU Accept message shall add\n    the CSG ID and associated PLMN to its Allowed CSG list if it is not\n    already present. Manual CSG selection is not supported if the UE has\n    emergency bearers established.\n\n     If the user plane setup is performed in conjunction with the TAU\n    Accept message and the TAU is performed via a hybrid cell, then the MME\n    shall send an indication whether the UE is a CSG member to the RAN\n    along with the S1-MME control message. Based on this information the\n    RAN may perform differentiated treatment for CSG and non-CSG members.\n\n  NOTE\u00c2\u00a07:  If the UE receives a TAU Accept message via a hybrid cell, the\n         UE does not add the corresponding CSG ID and associated PLMN to its\n         Allowed CSG list. Adding a CSG ID and associated PLMN to the UE's\n         local Allowed CSG list for a hybrid cell is performed only by OTA\n         or OMA DM procedures.\n\n     If the UE receives a Service Gap Time in the TAU Accept message, the\n    UE shall store this parameter and apply Service Gap Control (see\n    clause\u00c2\u00a04.3.17.9).\n\n     If the UE has indicated support for dual connectivity with NR in the\n    TAU Request and the UE is not allowed to use NR as Secondary RAT, the\n    MME indicates that to the UE in the TAU Accept message.\n\n     If the user plane setup is performed and if RACS is supported and MME\n    has UE Radio Capability ID in UE context, it signals the UE Radio\n    Capability ID to the eNB as defined in clause\u00c2\u00a05.11.3a. If the eNB does\n    not have mapping between the specific UE Radio Capability ID and the UE\n    radio capabilities, it shall use the procedure described in\n    TS\u00c2\u00a036.413\u00c2\u00a0[36] to retrieve the mapping from the Core Network.\n\n  21.  If GUTI was included in the TAU Accept, the UE acknowledges the\n    received message by returning a TAU Complete message to the MME.\n\n     When the \"Active flag\" is not set in the TAU Request message and the\n    Tracking Area Update was not initiated in ECM-CONNECTED state, the new\n    MME releases the signalling connection with UE, according to\n    clause\u00c2\u00a05.3.5. For a UE using Control Plane CIoT EPS Optimisation, when\n    the \"Signalling active flag\" is set, the new MME shall not release the\n    NAS signalling connection with the UE immediately after the TAU\n    procedure is completed.\n\n  NOTE\u00c2\u00a08:  The new MME may initiate E-RAB establishment (see\n         TS\u00c2\u00a036.413\u00c2\u00a0[36]) after execution of the security functions, or wait\n         until completion of the TA update procedure. For the UE, E-RAB\n         establishment may occur anytime after the TA update request is\n         sent.\n\nIn the case of a rejected tracking area update operation, due to regional\nsubscription, roaming restrictions or access restrictions (see\nTS\u00c2\u00a023.221\u00c2\u00a0[27] and TS\u00c2\u00a023.008\u00c2\u00a0[28]) the new MME should not construct an MM\ncontext for the UE. In the case of receiving the subscriber data from HSS,\nthe new MME may construct an MM context and store the subscriber data for\nthe UE to optimise signalling between the MME and the HSS. A reject shall\nbe returned to the UE with an appropriate cause and the S1 connection shall\nbe released. Upon return to idle, the UE shall act according to\nTS\u00c2\u00a023.122\u00c2\u00a0[10].\n\nThe new MME shall determine the Maximum APN restriction based on the\nreceived APN Restriction of each bearer context in the Context Response\nmessage and then store the new Maximum APN restriction value.\n\nThe bearer contexts shall be prioritized by the new MME. If the new MME is\nunable to support the same number of active bearer contexts as received\nfrom old MME/SGSN, the prioritisation is used to decide which bearer\ncontexts to maintain active and which ones to delete. In any case, the new\nMME shall first update all contexts in one or more P-GWs and then\ndeactivate the bearer context(s) that it cannot maintain as described in\nthe clause \"MME Initiated Dedicated Bearer Deactivation Procedure\". This\nshall not cause the MME to reject the tracking area update.\n\nThe new MME shall not deactivate emergency service related EPS bearers,\ni.e. EPS bearers with ARP value reserved for emergency services.\n\n  NOTE\u00c2\u00a09:  If MS (UE) was in PMM-CONNECTED state the bearer contexts are\n         sent already in the Forward Relocation Request message as described\n         in the clause \"Serving RNS relocation procedures\" of TS\u00c2\u00a023.060\u00c2\u00a0[7].\n\nIf the tracking area update procedure fails a maximum allowable number of\ntimes, or if the MME returns a Tracking Area Update Reject (Cause) message,\nthe UE shall enter EMM DEREGISTERED state.\n\nIf the new MME identifies that the RAT type has changed, the MME checks the\nsubscription information to identify for each APN whether to maintain the\nPDN connection, disconnect the PDN connection with a reactivation request,\nor, disconnect the PDN connection without reactivation request. If the MME\ndecides to deactivate a PDN connection it performs MME-initiated PDN\nConnection Deactivation procedure after the tracking area update procedure\nis completed but before the S1/RRC interface connection is released.\nExisting ESM cause values as specified in TS\u00c2\u00a024.301\u00c2\u00a0[46] (e.g. #39,\n\"reactivation requested\"; #66 \"Requested APN not supported in current RAT\nand PLMN combination\"; and for a dedicated bearer, possibly #37 \"EPS QoS\nnot accepted\") are used to cause predictable UE behaviour. If all the PDN\nconnections are disconnected and the UE does not support \"attach without\nPDN connectivity\", the MME shall request the UE to detach and reattach.\n\n\n"}, {"key": "Tracking Area Update procedure with Serving GW change and data", "numbering": "5.3.3.1A", "title_level": 3, "desc": "5.3.3.1A Tracking Area Update procedure with Serving GW change and data\n           forwarding\n\n                                    [pic]\n\n  Figure 5.3.3.1A-1: Tracking Area Update procedure with Serving GW change\n                             and data forwarding\n\n  NOTE\u00c2\u00a01:  The procedure steps (A) and (B) are defined in clause\u00c2\u00a05.3.3.1.\n         Step 5 in the figure above has compared to clause\u00c2\u00a05.3.3.1 one\n         additional parameter which is described below.\n\n  4. The timer setting by the old S4 SGSN or MME in step\u00c2\u00a04 (as in\n    clause\u00c2\u00a05.3.3.1) shall ensure that the buffered data in the old Serving\n    GW can be forwarded before the old Serving GW resource is released.\n\n  5. DL data is being buffered in the old Serving GW and the DL Data\n    Expiration Time has not expired, therefore the old MME/old S4-SGSN\n    indicates Buffered DL Data Waiting in the Context Response. This\n    triggers the new MME to setup the user plane and invoke data\n    forwarding. For Control Plane CIoT EPS Optimisation, if the DL data is\n    buffered in the old Serving GW, and when the Buffered DL Data Waiting\n    is indicated, the new MME shall setup the S11 user plane with the new\n    Serving GW and invoke data forwarding. If the DL data is buffered in\n    the old MME and the DL Data Expiration Time has not expired, the old\n    MME shall discard the buffered DL data.\n\n  11-12. The user plane is setup. These procedure steps are defined in\n    clause\u00c2\u00a05.3.4.1, steps 4-7 and steps 8-12 respectively in the UE\n    Triggered Service Request procedure.\n\n  NOTE\u00c2\u00a02:  It is assumed that Pause of PGW Charging is not invoked by SGW\n         that is performing extended data buffering.\n\n     For Control Plane CIoT EPS Optimisation, steps\u00c2\u00a011 and 12 are skipped.\n\n  13.  Since it was indicated in step\u00c2\u00a05 that buffered DL data is waiting,\n    the new MME sets up forwarding parameters by sending Create Indirect\n    Data Forwarding Tunnel Request (target eNodeB addresses and TEIDs for\n    forwarding) to the Serving GW. The Serving GW sends a Create Indirect\n    Data Forwarding Tunnel Response (target Serving GW addresses and TEIDs\n    for forwarding) to the target MME. For Control Plane CIoT EPS\n    Optimisation, the new MME sets up forwarding parameters by sending\n    Create Indirect Data Forwarding Tunnel Request (target MME address and\n    TEID for forwarding) to the Serving GW. Upon receipt of the Create\n    Indirect Data Forwarding Tunnel Response message the new MME starts a\n    timer for release of resources if resources for indirect forwarding\n    were allocated in the new S-GW.\n\n     Indirect forwarding may be performed via a Serving GW which is\n    different from the Serving GW used as the anchor point for the UE.\n\n  14.  This procedure step\u00c2\u00a0is defined in clause\u00c2\u00a05.3.3.1, step\u00c2\u00a07. In\n    addition the new MME includes the F-TEID where buffered DL data should\n    be forwarded and a Forwarding indication in the Context Acknowledge\n    message. The F-TEID is the F-TEID for the indirect forwarding received\n    from step\u00c2\u00a013 or it may be the F-TEID of the eNB (when eNB supports\n    forwarding).\n\n  15.  A Modify Bearer Request( F-TEID ) is sent to the old Serving GW. The\n    F-TEID is the Forwarding F-TEID where the buffered DL data shall be\n    forwarded.\n\n  16.  The old Serving GW forwards its buffered data towards the received F-\n    TEID in step\u00c2\u00a015. The buffered DL data is sent to the UE over the radio\n    bearers established in step\u00c2\u00a011. For Control Plane CIoT EPS\n    Optimisation, the buffered DL data is sent to the new MME from the new\n    Serving GW and is sent to the UE as described in steps 12-14 of\n    clause\u00c2\u00a05.3.4B.3.\n\n  17-18. As steps 15-16, 18-19 in clause\u00c2\u00a05.3.3.1.\n\n  19.  If indirect forwarding was used, then the expiry of the timer at the\n    new MME started at step\u00c2\u00a013 triggers the new MME to send a Delete\n    Indirect Data Forwarding Tunnel Request message to the new S-GW to\n    release temporary resources used for indirect forwarding that were\n    allocated at step\u00c2\u00a013.\n\n\n"}, {"key": "E-UTRAN Tracking Area Update without S-GW Change", "numbering": "5.3.3.2", "title_level": 3, "desc": "5.3.3.2  E-UTRAN Tracking Area Update without S-GW Change\n\n                                    [pic]\n\n     Figure 5.3.3.2-1: E-UTRAN Tracking Area Update without S-GW change\n\n  NOTE\u00c2\u00a01:  For a PMIP-based S5/S8, procedure steps (A) are defined in\n         TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps\u00c2\u00a012 and 14 concern GTP based S5/S8.\n\n  NOTE\u00c2\u00a02:  In case of Tracking Area Update without MME change the\n         signalling in steps 4, 5, 7 and steps 9-19 are skipped. A change of\n         UE Time Zone, User CSG information or Serving Network is signalled\n         in the next Service Request. If TAI change need to be reported to\n         the PDN\u00c2\u00a0GW, location information change reporting procedure\n         described in clause\u00c2\u00a05.9.2 is performed.\n\n  NOTE\u00c2\u00a03:  Deferred reporting of UE Time Zone, or Serving Network per NOTE\n         2 may fail when inter-MME/SGSN mobility occurs before a UE sends\n         SERVICE REQUEST and the target MME/SGSN (e.g. pre-Release 10) does\n         not support the \"Change to Report\" flag.\n\n  1. One of the triggers described in clause\u00c2\u00a05.3.3.0 for starting the TAU\n    procedure occurs.\n\n  2. The UE initiates a TAU procedure by sending, to the eNodeB, a Tracking\n    Area Update Request (UE Core Network Capability, MS Network Capability,\n    Preferred Network behaviour, Support for restriction of use of Enhanced\n    Coverage, active flag, signalling active flag, EPS bearer status, old\n    GUTI, Old GUTI Type, last visited TAI, P-TMSI signature, additional\n    GUTI, KSISGSN, KSIASME, NAS sequence number, NAS-MAC, Voice domain\n    preference and UE's usage setting, UE has UE Radio Capability ID\n    assigned for the selected PLMN) message together with RRC parameters\n    indicating the Selected Network and the old GUMMEI. An exception is\n    that, if the TAU was triggered for load re-balancing purposes (see\n    clause\u00c2\u00a04.3.7.3), the old GUMMEI is not included in the RRC parameters.\n    The UE shall set the Old GUTI Type to indicate whether the Old GUTI is\n    a native GUTI or is mapped from a P-TMSI and RAI.\n\n     If the UE's TIN indicates \"GUTI\" or \"RAT-related TMSI\" and the UE\n    holds a valid GUTI then the old GUTI indicates this valid GUTI. If the\n    UE's TIN indicates \"P-TMSI\" and the UE holds a valid P-TMSI and related\n    RAI then these two elements are indicated as the old GUTI. Mapping a P-\n    TMSI and RAI to a GUTI is specified in Annex\u00c2\u00a0H. When the UE is in\n    connected mode (e.g. in URA_PCH) when it reselects to E-UTRAN, the UE\n    shall set its TIN to \"P-TMSI\".\n\n     If the UE holds a valid GUTI and the old GUTI indicates a GUTI mapped\n    from a P-TMSI and RAI, then the UE indicates the GUTI as additional\n    GUTI. If the old GUTI indicates a GUTI mapped from a P-TMSI and RAI,\n    and the UE has a valid P-TMSI signature, the P-TMSI signature shall be\n    included.\n\n     The additional GUTI in the Tracking Area Update Request message allows\n    the new MME to find any already existing UE context stored in the new\n    MME when the old GUTI indicates a value mapped from a P-TMSI and RAI.\n\n     Alternatively, when a UE only supports E-UTRAN, it identifies itself\n    with the old GUTI and sets the Old GUTI Type to 'native'.\n\n     The RRC parameter \"old GUMMEI\" takes its value from the identifier\n    that is signalled as the old GUTI according to the rules above. For a\n    combined MME/SGSN the eNodeB is configured to route the MME-code(s) of\n    this combined node to the same combined node. This eNodeB is also\n    configured to route MME-code(s) of GUTIs that are generated the UE's\n    mapping of the P-TMSIs allocated by the combined node. Such an eNodeB\n    configuration may also be used for separate nodes to avoid changing\n    nodes in the pool caused by inter RAT mobility.\n\n     The last visited TAI shall be included in order to help the MME\n    produce a good list of TAIs for any subsequent TAU Accept message.\n    Selected Network indicates the network that is selected. Active flag is\n    a request by the UE to activate the radio and S1 bearers for all the\n    active EPS Bearers by the TAU procedure. Signalling active flag is a\n    request by UE using Control Plane CIoT EPS Optimisation to maintain the\n    NAS signalling connection after Tracking Area Update Procedure is\n    completed in order to transmit pending Data using the Data Transport in\n    Control Plane CIoT EPS Optimisation or NAS signalling. The UE's ISR\n    capability is included in the UE Core Network Capability element. The\n    EPS bearer status indicates each EPS bearer that is active in the UE.\n    The TAU Request message shall be integrity protected by the NAS-MAC as\n    described in TS\u00c2\u00a033.401\u00c2\u00a0[41]. KSIASME is included if the UE has valid\n    security parameters. NAS sequence number indicates the sequential\n    number of the NAS message.\n\n     In the RRC connection establishment signalling associated with the TAU\n    Request, the UE indicates its support of the CIoT EPS Optimisations\n    relevant for MME selection.\n\n     For UE using CIoT EPS Optimisation without any activated PDN\n    connection, there is no active flag or EPS bearer status included in\n    the TAU Request message. For a UE with a running Service Gap timer in\n    the UE the UE shall not set the active flag or the signalling active\n    flag in the TAU request message (see clause\u00c2\u00a04.3.17.9).\n\n     If the UE has any PDN connection of PDN Type \"non-IP\" or \"Ethernet\",\n    the UE shall send the EPS bearer status in the TAU Request message.\n\n     KSISGSN is included if the UE indicates a GUTI mapped from a P-TMSI in\n    the information element \"old GUTI\".\n\n     The UE sets the voice domain preference and UE's usage setting\n    according to its configuration, as described in clause\u00c2\u00a04.3.5.9.\n\n     The UE includes extended idle mode DRX parameters information element\n    if it needs to enable extended idle mode DRX, even if extended idle\n    mode DRX parameters were already negotiated before.\n\n     If a UE includes a Preferred Network Behaviour, this defines the\n    Network Behaviour the UE is expecting to be available in the network as\n    defined in clause\u00c2\u00a04.3.5.10.\n\n     If the UE supports RACS as defined in clause\u00c2\u00a05.11.3a, and if the UE is\n    provisioned with a UE Radio Capability ID for use in the selected PLMN\n    (i.e.PLMN-assigned for the specific PLMN or manufacturer-assigned), the\n    UE includes a flag that indicates it has an assigned UE Radio\n    Capability ID for use in the selected PLMN but the actual UE Radio\n    Capability is provided to MME after security context is established in\n    step\u00c2\u00a06 (see below).\n\n  3. The eNodeB derives the MME address from the RRC parameters carrying\n    the old GUMMEI, the indicated Selected Network and the RAT (NB-IoT or\n    WB-E-UTRAN). If that GUMMEI is not associated with the eNodeB, or the\n    GUMMEI is not available or the UE indicates that the TAU procedure was\n    triggered by load re-balancing, the eNodeB selects the MME as described\n    in clause 4.3.8.3 on \"MME Selection Function\". The eNodeB forwards the\n    TAU Request message together with the CSG access mode, CSG ID, TAI+ECGI\n    of the cell from where it received the message and with the Selected\n    Network to the MME. CSG ID is provided by RAN if the UE sends the TAU\n    Request message via a CSG cell or a hybrid cell. CSG access mode is\n    provided if the UE sends the TAU Request message via a hybrid cell. If\n    the CSG access mode is not provided but the CSG ID is provided, the MME\n    shall consider the cell as a CSG cell. For SIPTO at the Local Network\n    with stand-alone GW architecture the eNodeB includes the Local Home\n    Network ID in the Initial UE Message and in Uplink NAS Transport\n    message if the target cell is in a Local Home Network.\n\n     To assist Location Services, the eNB indicates the UE's Coverage Level\n    to the MME.\n\n  4. The new MME differentiates the type of the old node, i.e. MME or SGSN,\n    as specified in clause\u00c2\u00a04.3.19, uses the GUTI received from the UE to\n    derive the old MME/S4 SGSN address and sends a Context Request (old\n    GUTI, MME Address, UE Validated, complete TAU Request message, P-TMSI\n    Signature, CIoT EPS Optimisation support inidication) message to the\n    old MME/S4\u00c2\u00a0SGSN to retrieve the user information. UE Validated\n    indicates that the new MME has validated the integrity protection of\n    the TAU message, e.g. based on native EPS security context for the UE.\n    To validate the Context Request the old MME uses the complete TAU\n    Request message and the old S4 SGSN uses the P-TMSI Signature and\n    responds with an appropriate error if integrity check fails in old\n    MME/S4 SGSN. This shall initiate the security functions in the new MME.\n    If the security functions authenticate the UE correctly, the new MME\n    shall send a Context Request (IMSI, complete TAU Request message, MME\n    Address, UE Validated) message to the old MME/S4 SGSN with the UE\n    Validated set. If the new MME indicates that it has authenticated the\n    UE or if the old MME/old S4\u00c2\u00a0SGSN authenticates the UE, the old MME/old\n    S4\u00c2\u00a0SGSN starts a timer.\n\n     If the UE with emergency bearers is not authenticated in the old\n    MME/old S4 SGSN (in a network supporting unauthenticated UEs) the old\n    MME/old S4 SGSN continues the procedure with sending a Context Response\n    and starting the timer also when it cannot validate the Context\n    Request.\n\n     If a RLOS attached UE is not successfully authenticated in the old MME\n    and/or the Context Request cannot be validated, the old MME continues\n    the procedure with sending a Context Response and starting the existing\n    timer.\n\n     If the new MME supports CIoT EPS Optimisation, CIoT EPS Optimisation\n    support indication is included in the Context Request indicating\n    support for various CIoT EPS Optimisations (e.g. support for header\n    compression for CP CIoT EPS Optimisation, etc.).\n\n  5. If the Context Request is sent to an old MME the old MME responds with\n    a Context Response (IMSI, ME Identity (IMEISV), unused EPS\n    Authentication Vectors, KSIASME, KASME, EPS Bearer Context(s), Serving\n    GW signalling Address and TEID(s), MS Info Change Reporting Action (if\n    available), CSG Information Reporting Action (if available), UE Time\n    Zone, UE Core Network Capability, UE Specific DRX Parameters, Change to\n    Report (if present), Remaining Running Service Gap timer, LTE-M UE\n    Indication) message. If the new MME supports CIoT EPS Optimisation and\n    the use of header compression has been negotiated between the UE and\n    old MME, the Context Response also includes the Header Compression\n    Configuration which includes the information necessary for the ROHC\n    channel setup but not the RoHC context itself.\n\n     If the Context Request is sent to an old S4\u00c2\u00a0SGSN the old S4 SGSN\n    responds with a Context Response (IMSI, ME Identity (if available),\n    unused Authentication Quintets, CK, IK, KSISGSN, EPS Bearer Context(s),\n    Serving GW signalling Address and TEID(s), ISR Supported, MS Info\n    Change Reporting Action (if available), CSG Information Reporting\n    Action (if available), UE Time Zone, UE Core Network Capability, UE\n    Specific DRX Parameters, Change to Report (if present)) message. The\n    Authentication Quintets are maintained by the old S4 SGSN.\n    TS\u00c2\u00a033.401\u00c2\u00a0[41] gives further details on the transfer of security\n    related information.\n\n     Change to Report flag is included by the old MME or the old S4 SGSN if\n    reporting of change of UE Time Zone, or Serving Network, or both\n    towards Serving GW / PDN GW was deferred by the old MME or old S4 SGSN.\n\n     If the Context Response message did not include IMEISV and the MME\n    does not already store the IMEISV of the UE, the MME shall retrieve the\n    ME Identity (IMEISV) from the UE.\n\n     The PDN GW Address and TEID(s) (for GTP-based S5/S8) or GRE Keys (PMIP-\n    based S5/S8 at the PDN GW(s) for uplink traffic and the TI(s), is part\n    of the EPS Bearer Context. ISR Supported is indicated if the old SGSN\n    and associated Serving GW are capable to activate ISR for the UE.\n\n     The new MME shall ignore the UE Core Network Capability contained in\n    the Context Response only when it has previously received an UE Core\n    Network Capability in the Tracking Area Update Request. If the UE is\n    not known in the old MME/old S4\u00c2\u00a0SGSN or if the integrity check for the\n    TAU request message fails, the old MME/old S4\u00c2\u00a0SGSN responds with an\n    appropriate error cause.\n\n     If the DL Data Buffer Expiration Time for the UE has not expired (see\n    High latency communication in clause\u00c2\u00a04.3.17.7), the old MME/old S4-SGSN\n    indicates Buffered DL Data Waiting in the Context Response. When this\n    is indicated, the new MME shall setup the user plane in conjunction to\n    the TAU procedure for delivery of the buffered DL data.\n\n     If the UE receives emergency bearer services from the old MME/old S4\n    SGSN and the UE is UICCless, IMSI can not be included in the Context\n    Response. For emergency attached UEs, if the IMSI cannot be\n    authenticated, then the IMSI shall be marked as unauthenticated. Also,\n    in this case, security parameters are included only if available.\n\n     For a RLOS attached UE, the old MME includes an RLOS indication to the\n    new MME. If the RLOS attached UE in the old MME does not have a USIM,\n    IMSI can not be included in the Context Response. If the RLOS attached\n    UE has USIM but the IMSI cannot be successfully authenticated, then the\n    IMSI shall be marked as unauthenticated. Also, in this case, security\n    parameters are included only if available.\n\n     If SIPTO at the Local Network is active for a PDN connection in the\n    architecture with stand-alone GW, the old MME/old S4 SGSN shall include\n    the Local Home Network ID of the old cell in the EPS Bearer context\n    corresponding to the SIPTO at the Local Network PDN connection.\n\n     For UE using CIoT EPS Optimisation without any activated PDN\n    connection, there is no EPS Bearer Context(s) included in the Context\n    Response message.\n\n     Based on the CIoT EPS Optimisation support indication, old MME only\n    transfers the EPS Bearer Context(s) that the new MME supports. If the\n    new MME does not support CIoT EPS Optimisation, EPS Bearer Context(s)\n    of non-IP PDN connection are not transferred to the new MME. If the new\n    MME does not support Ethernet PDN Type, EPS Bearer Context(s) of\n    Ethernet PDN type are not transferred to the new MME. If the EPS Bearer\n    Context(s) of a PDN connection has not been transferred, the old MME\n    shall consider all bearers of that PDN connection as failed and release\n    that PDN connection by triggering the MME requested PDN disconnection\n    procedure specified in clause\u00c2\u00a05.10.3. The buffered data in the old MME\n    is discarded after receipt of Context Acknowledgement.\n\n     If the EPS Bearer Context(s) are to be transferred to the new MME, the\n    old MME also includes the Serving GW IP address and TEID for both S1-U\n    and S11-U, if available.\n\n     If the Old MME is aware the UE is a LTE-M UE, it provides the LTE-M UE\n    Indication to the new MME.\n\n  6. If the integrity check of TAU Request message (sent in step\u00c2\u00a02) failed,\n    then authentication is mandatory. The authentication functions are\n    defined in clause\u00c2\u00a05.3.10 on \"Security Function\". Ciphering procedures\n    are described in clause\u00c2\u00a05.3.10 on \"Security Function\". If GUTI\n    allocation is going to be done and the network supports ciphering, the\n    NAS messages shall be ciphered.\n\n     If this TAU request is received for a UE which is already in\n    ECM_CONNECTED state and the PLMN-ID of the TAI sent by the eNodeB in\n    Step\u00c2\u00a03 is different from that of the GUTI included in the TAU Request\n    message, the MME shall delay authenticating the UE until after Step\u00c2\u00a021\n    (TAU Complete message).\n\n  NOTE\u00c2\u00a04:  The MME delays the authentication such that the UE first updates\n         its registered PLMN-ID to the new PLMN-ID selected by the RAN\n         during handover. The new PLMN-ID is provided by the MME to the UE\n         as part of the GUTI in the TAU accept message in Step\u00c2\u00a020. Doing\n         this ensures that the same PLMN-ID is used in the derivation of the\n         Kasme key by both the network and the UE.\n\n     If the new MME is configured to allow emergency bearer services for\n    unauthenticated UE the new MME behave as follows:\n\n    -  where a UE has only emergency bearer services, the MME either skip\n       the authentication and security procedure or accepts that the\n       authentication may fail and continues the Tracking Area Update\n       procedure; or\n\n    -  where a UE has both emergency and non emergency bearer services and\n       authentication fails, the MME continues the Tracking Area Update\n       procedure and deactivates all the non-emergency PDN connections as\n       specified in clause\u00c2\u00a05.10.3.\n\n     If the new MME is configured to support Restricted Local Operator\n    Services, the new MME, based on local regulation and operator policy,\n    may skip the authentication and security procedure, or may perform\n    authentication if security parameters are available or obtainable from\n    HSS and continues the Tracking Area Update procedure regardless of the\n    authentication result.\n\n     If the UE indicated it has a UE Radio Capability ID assigned for use\n    in the selected PLMN in step\u00c2\u00a02, the MME may request the UE to provide\n    the UE Radio Capability ID in Security Mode Command, if the MME needs\n    to get the UE Radio Capability ID from the UE e.g. at inter-PLMN\n    mobility. If enquired by the MME the UE shall include the UE Radio\n    Capability ID in Security Mode Command Accept for the supported UE\n    radio capabilities.\n\n  7. If the old node is an old MME the new MME sends a Context Acknowledge\n    message to the old MME. The old MME marks in its context that the\n    information in the GW and the HSS are invalid. This ensures that the\n    MME updates the GWs and the HSS if the UE initiates a TAU procedure\n    back to the MME before completing the ongoing TAU procedure.\n\n  NOTE\u00c2\u00a05:  Updating the GWs refers to modification of session(s) on the\n         Serving GW. This will result in successful re-establishment of the\n         S11/S4 tunnel between the MME/SGSN and the Serving GW.\n\n     If the old node is an old S4\u00c2\u00a0SGSN the MME sends a Context Acknowledge\n    (ISR Activated) message to the old SGSN. Unless ISR Activated is\n    indicated by the MME, the old S4\u00c2\u00a0SGSN marks in its context that the\n    information in the GWs is invalid. This ensures that the old S4\u00c2\u00a0SGSN\n    updates the GWs if the UE initiates a RAU procedure back to the old\n    S4\u00c2\u00a0SGSN before completing the ongoing TAU procedure. If ISR Activated\n    is indicated to the old S4\u00c2\u00a0SGSN, this indicates that the old S4\u00c2\u00a0SGSN\n    shall maintain its UE context including authentication quintets and\n    stop the timer started in step\u00c2\u00a04. In this case, if the Implicit Detach\n    timer is running, the old S4 SGSN shall re-start it with a slightly\n    larger value than the UE's GERAN/UTRAN Deactivate ISR timer. Also, in\n    this case, if the old SGSN has maintained the Serving GW address for\n    user plane and S4 GTP-U TEID, the old SGSN shall remove Serving GW\n    address for user plane and S4 GTP-U TEID locally. When ISR Activated is\n    not indicated and this timer expires the old SGSN deletes all bearer\n    resources of that UE. As the Context Acknowledge from the MME does not\n    include any S-GW change the S4\u00c2\u00a0SGSN does not send any Delete Session\n    Request message to the S-GW. The MME shall not activate ISR if the\n    associated Serving GW does not support ISR.\n\n     If the security functions do not authenticate the UE correctly, then\n    the TAU shall be rejected, and the MME shall send a reject indication\n    to the old MME/old S4 SGSN. The old MME/old S4 SGSN shall continue as\n    if the Identification and Context Request was never received.\n\n     For UE using CIoT EPS Optimisation without any activated PDN\n    connection, the steps 9, 10, 11, 12 and 13 are skipped.\n\n  8. Void.\n\n  9. If the MME has changed the new MME adopts the bearer contexts received\n    from the old MME/SGSN as the UE's EPS bearer contexts to be maintained\n    by the new MME. The MME establishes the EPS bearer(s) in the indicated\n    order. The MME deactivates the EPS bearers which cannot be established.\n\n     The MME verifies the EPS bearer status received from the UE with the\n    EPS bearer contexts it maintains and releases any network resources\n    related to EPS bearers that are not active in the UE. If there is no\n    bearer context at all, the MME rejects the TAU Request. If the MME has\n    changed the new MME sends a Modify Bearer Request (new MME address and\n    TEID, ISR Activated, RAT type, LTE-M RAT type reporting to PGW flag)\n    message per PDN connection to the Serving GW. If there is no need for\n    the SGW to send the signalling to the PDN GW, the MME may send Modify\n    Access Bearers Request (new MME address and TEID) per UE to the Serving\n    GW to optimise the signalling. The PDN GW address is indicated in the\n    bearer contexts. If indicated, the information ISR Activated indicates\n    that ISR is activated. If it is a mobility from a SGSN to a MME and if\n    the MME supports location information change reporting, the MME shall\n    include the User Location Information (according to the supported\n    granularity) in the Modify Bearer Request, regardless of whether\n    location information change reporting had been requested in the\n    previous RAT by the PDN GW. If it is an inter MME mobility and if the\n    PDN GW requested location information change reporting, the MME\n    includes the User Location Information IE in this message if it is\n    different compared to the previously sent information. If the PDN GW\n    requested User CSG information, the MME also includes the User CSG\n    Information IE in this message. If either the UE Time Zone has changed\n    or Context Response message indicated pending UE Time Zone change\n    reporting (via Change to Report flag), the MME includes the UE Time\n    Zone IE in this message. If either the Serving Network has changed or\n    Context Response message indicated pending Serving Network change\n    reporting (via Change to Report flag) the MME includes the new Serving\n    Network IE in this message. In network sharing scenarios Serving\n    Network denotes the serving core network. If the old node is an old MME\n    at a Tracking Area Update with a MME change ISR Activated shall not be\n    indicated.\n\n  NOTE\u00c2\u00a06:  The User CSG Information IE is only sent in step\u00c2\u00a09 if the\n         \"Active flag\" is set in the TAU Request message.\n\n     When the Modify Access Bearers Request or Modify Bearer Request does\n    not indicate ISR Activated the S-GW deletes any ISR resources by\n    sending a Delete Bearer Request to the other CN node that has bearer\n    resources on the S-GW reserved.\n\n     If the new MME receives the EPS bearer context with SCEF, then the new\n    MME updates the SCEF as defined in TS\u00c2\u00a023.682\u00c2\u00a0[74].\n\n     For Control Plane CIoT EPS Optimisation, if the DL data is buffered in\n    the Serving GW, and if this is a Tracking Area Update without MME\n    change and the DL Data Buffer Expiration Time in the MM context for the\n    UE in the MME has not expired, or if this is a Tracking Area Update\n    with MME change and the old MME/old S4-SGSN indicated Buffered DL Data\n    Waiting in the Context Response in step\u00c2\u00a05, the MME shall also indicate\n    S11-U tunnelling of NAS user data and include it's own S11-U IP address\n    and MME DL TEID for DL data forwarding by the SGW in the Modify Bearer\n    Request. The MME may also do so without DL data buffered in the SGW.\n\n     If the UE is using the LTE-M RAT type and the PDN GW expects the LTE-M\n    RAT type reporting as specified in clause\u00c2\u00a05.11.5, the MME also includes\n    the LTE-M RAT type reporting to PGW flag to indicate to the Serving GW\n    to forward the LTE-M RAT type to the PDN GW.\n\n  10.  If the RAT type has changed, or the Serving GW has received the User\n    Location Information IE or the UE Time Zone IE or User CSG Information\n    IE and/or the Serving Network IE from the MME in step\u00c2\u00a09, the Serving GW\n    informs the PDN GW(s) about this information that e.g. can be used for\n    charging, by sending the message Modify Bearer Request (RAT type) per\n    PDN connection to the PDN GW(s) concerned. User Location Information IE\n    and/or UE Time Zone IE and/or User CSG Information IE and/or Serving\n    Network IE are also included if they are present in step\u00c2\u00a09.\n\n     If the Modify Bearer Request message is not sent because of above\n    reasons and the PDN GW charging is paused, then the SGW shall send\n    Modify Bearer Request message with PDN Charging Pause Stop Indication\n    to inform the PDN GW that the charging is no longer paused. Other IEs\n    are not included in this message.\n\n     If LTE-M RAT type and the LTE-M RAT type reporting to PGW flag were\n    received at step\u00c2\u00a09, the Serving GW shall include the LTE-M RAT type in\n    the Modify Bearer Request message to the PGW. Otherwise the Serving GW\n    includes RAT type WB-E-UTRAN.\n\n  11.  If dynamic PCC is deployed, and RAT type information or UE location\n    information needs to be conveyed from the PDN GW to the PCRF, then the\n    PDN GW shall send this information to the PCRF by means of an IP-CAN\n    Session Modification procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  NOTE\u00c2\u00a07:  The PDN GW does not need to wait for the PCRF response, but\n         continues in the next step. If the PCRF response leads to an EPS\n         bearer modification the PDN GW should initiate a bearer update\n         procedure.\n\n  12.  The PDN GW updates its context field to allow DL PDUs to be routed\n    to the correct Serving GW. PDN GW returns a Modify Bearer Response\n    (MSISDN) to the Serving GW. The MSISDN is included if the PDN GW has it\n    stored in its UE context. If there has been a RAT change towards E-\n    UTRAN and location information change reporting is required and\n    supported in the target MME, the PDN GW shall provide MS Info Change\n    Reporting Action in the Modify Bearer Response.\n\n  13.  The Serving GW updates its bearer context. If ISR Activated is\n    indicated in step\u00c2\u00a09 and RAT Type received in step\u00c2\u00a09 indicates E-UTRAN,\n    then the Serving GW only updates the MME Control Plane Address stored\n    locally and keep the SGSN related information unchanged. Also, in this\n    case, if the Serving GW has maintained the SGSN address for user plane\n    and S4 GTP-U TEID, the Serving GW removes the SGSN address for user\n    plane and S4 GTP-U TEID locally. Otherwise the Serving GW shall update\n    all of the information stored locally for this UE with the related\n    information received from the MME. This allows the Serving GW to route\n    Bearer PDUs to the PDN GW when received from eNodeB. The Serving GW\n    shall return a Modify Bearer Response (Serving GW address and TEID for\n    uplink traffic, MS Info Change Reporting Action) message to the new MME\n    as a response to a Modify Bearer Request message, or a Modify Access\n    Bearers Response (Serving GW address and TEID for uplink traffic) as a\n    response to a Modify Access Bearers Request message. If the Serving GW\n    cannot serve the MME Request in the Modify Access Bearers Request\n    message without S5/S8 signalling other than to unpause charging in the\n    PDN GW or without corresponding Gxc signalling when PMIP is used over\n    the S5/S8 interface, it shall respond to the MME with indicating that\n    the modifications are not limited to S1-U bearers, and the MME shall\n    repeat its request using Modify Bearer Request message per PDN\n    connection.\n\n     When the MME receives the Modify Bearer Response or the Modify Access\n    Bearers Response message, the MME checks if there is a \"Availability\n    after DDN Failure\" monitoring event or a \"UE Reachability\" monitoring\n    event configured for the UE in the MME and in such a case sends an\n    event notification (see TS\u00c2\u00a023.682\u00c2\u00a0[74] for further information).\n\n     For Control Plane CIoT EPS Optimisation, if the MME address and MME DL\n    TEID are provided in step\u00c2\u00a09, the Serving GW includes Serving GW address\n    and Serving GW UL TEID in the Modify Bearer Response message. The DL\n    data is sent to the MME from the Serving GW.\n\n     The buffered DL data is sent to the UE as described in steps 12-14 of\n    clause\u00c2\u00a05.3.4B.3.\n\n  14.  The new MME verifies whether it holds subscription data for the UE\n    identified by the GUTI, the additional GUTI or by the IMSI received\n    with the context data from the old CN node.\n\n     If there are no subscription data in the new MME for this UE, or for\n    some network sharing scenario (e.g. GWCN) if the PLMN-ID of the TAI\n    supplied by the eNodeB is different from that of the GUTI in the UE's\n    context, then the new MME informs the HSS of the change of MME by\n    sending an Update Location Request (MME Id, IMSI, ULR-Flags, MME\n    Capabilities, Homogenous Support of IMS Voice over PS Sessions, UE\n    SRVCC capability, equivalent PLMN list, ME Identity (IMEISV)) message\n    to the HSS. ULR-Flags indicates that update location is sent from an\n    MME and the MME registration shall be updated in HSS. The HSS does not\n    cancel any SGSN registration. The MME capabilities indicate the MME's\n    support for regional access restrictions functionality. The inclusion\n    of the equivalent PLMN list indicates that the MME supports the inter-\n    PLMN handover to a CSG cell in an equivalent PLMN using the\n    subscription information of the target PLMN. The \"Homogenous Support of\n    IMS Voice over PS Sessions\" indication (see clause\u00c2\u00a04.3.5.8A) shall not\n    be included unless the MME has completed its evaluation of the support\n    of \"IMS Voice over PS Session\" as specified in clause\u00c2\u00a04.3.5.8. The ME\n    Identity is included if step\u00c2\u00a05 caused the MME to retrieve the IMEISV\n    from the UE.\n\n  NOTE\u00c2\u00a08:  At this step, the MME may not have all the information needed to\n         determine the setting of the IMS voice over PS Session Supported\n         indication for this UE (see clause\u00c2\u00a04.3.5.8). Hence the MME can send\n         the \"Homogenous Support of IMS Voice over PS Sessions\" later on in\n         this procedure.\n\n     If the UE initiates the TAU procedure in a VPLMN supporting Autonomous\n    CSG Roaming and the HPLMN has enabled Autonomous CSG Roaming in the\n    VPLMN (via Service Level Agreement) and the MME needs to retrieve the\n    CSG subscription information of the UE from the CSS, the MME initiates\n    the Update CSG Location Procedure with CSS as described in\n    clause\u00c2\u00a05.3.12.\n\n     If the MME determines that only the UE SRVCC capability has changed,\n    the MME sends a Notify Request to the HSS to inform about the changed\n    UE SRVCC capability.\n\n     If all the EPS bearers of the UE have emergency ARP value, the new MME\n    may skip the update location procedure or proceed even if the update\n    location fails.\n\n     If the UE is RLOS attached, the new MME skips the update location\n    procedure and the TAU procedure proceeds.\n\n  15.  The HSS sends a Cancel Location (IMSI, Cancellation type) message to\n    the old MME with a Cancellation Type set to Update Procedure.\n\n  16.  When receiving a Cancel Location message and the timer started in\n    step 4 is not running, the old MME removes the MM and bearer contexts.\n    Otherwise, the contexts are removed when the timer expires. It also\n    ensures that the MM context is kept in the old MME for the case the UE\n    initiates another TAU procedure before completing the ongoing TAU\n    procedure to the new MME. The old MME acknowledges with a Cancel\n    Location Ack (IMSI) message.\n\n  NOTE\u00c2\u00a09:  ISR Activated is never indicated from new to old MME.\n\n     So an old MME deletes all the bearer resources of the UE in any case\n    when the timer started in step\u00c2\u00a04 expires, which is independent on\n    receiving a Cancel Location message.\n\n  17.  When receiving the Context Acknowledge message and if the UE is Iu\n    Connected, the old SGSN sends an Iu Release Command message to the RNC\n    after the timer started in step\u00c2\u00a04 has expired.\n\n  18.  The RNC responds with an Iu Release Complete message.\n\n  19.  The HSS acknowledges the Update Location Request by returning an\n    Update Location Ack (IMSI, Subscription Data) message to the new MME\n    after the cancelling of the old MME context is finished. If all checks\n    are successful, the MME constructs an MM context for the UE. The\n    Subscription Data may contain the CSG subscription data for the\n    registered PLMN and for the equivalent PLMN list requested by MME in\n    step\u00c2\u00a014.\n\n     The subscription data may contain Enhanced Coverage Restricted\n    parameter. If received from the HSS, MME stores this Enhanced Coverage\n    Restricted parameter in the MME MM context.\n\n     The subscription data may contain Service Gap Time. If received from\n    the HSS, the MME stores this Service Gap Time in the MME MM context for\n    the UE and passes it to the UE in the Tracking Area Update Accept\n    message if the UE has indicated Service Gap Control capability.\n\n     The subscription data may contain Subscribed Paging Time Window\n    parameter that applies to the UEs on a specific RAT, e.g. NB-IoT. If\n    received from the HSS, MME stores this Subscribed Paging Time Window\n    parameter in the MME MM context.\n\n     If the UE initiates the TAU procedure at a CSG cell, the new MME shall\n    check whether the CSG ID and associated PLMN is contained in the CSG\n    subscription and is not expired. If the CSG ID and associated PLMN is\n    not present or expired, the MME shall send a Tracking Area Update\n    reject message to the UE with an appropriate cause value. The UE shall\n    remove the CSG ID and associated PLMN from its Allowed CSG list if\n    present.\n\n     If the Update Location is rejected by the HSS, the new MME rejects the\n    TAU Request from the UE with an appropriate cause sent in the TAU\n    Reject message to the UE. In such cases, the new MME releases any local\n    MME EPS Bearer contexts for this particular UE.\n\n  20.  If due to regional subscription restrictions or access restrictions\n    (e.g. CSG restrictions) (received in update location procedure in\n    step\u00c2\u00a019) the UE is not allowed to access the TA:\n\n    -  The MME rejects the Tracking Area Update Request with an appropriate\n       cause to the UE.\n\n    -  For UEs with emergency EPS bearers, i.e. at least one EPS bearer has\n       an ARP value reserved for emergency services, the new MME accepts the\n       Tracking Area Update Request and deactivates all non-emergency PDN\n       connections as specified in clause\u00c2\u00a05.10.3. If the Tracking Area\n       Update procedure is initiated in ECM-IDLE state, all non-emergency\n       EPS bearers are deactivated by the Tracking Area Update procedure\n       without bearer deactivation signalling between the UE and the MME.\n\n     The MME responds to the UE with a Tracking Area Update Accept (GUTI,\n    TAI-list, EPS bearer status, NAS sequence number, NAS-MAC, ISR\n    Activated, IMS Voice over PS session supported, Emergency Service\n    Support indicator, LCS Support Indication, Supported Network Behaviour,\n    Service Gap Time, Enhanced Coverage Restricted, Indication of support\n    of 15 EPS bearers per UE) message. If the active flag is set the\n    Handover Restriction List may be sent to eNodeB as eNodeB handles the\n    roaming restrictions and access restrictions in the Intra E-UTRAN case.\n    If the active flag is set in the TAU Request message the user plane\n    setup procedure is activated in conjunction with the TAU Accept\n    message. If this is a Tracking Area Update without MME change and the\n    DL Data Buffer Expiration Time in the MM context for the UE in the MME\n    has not expired, or if this is a Tracking Area Update with MME change\n    and the old MME/old S4-SGSN indicated Buffered DL Data Waiting in the\n    Context Response in step\u00c2\u00a05, the user plane setup procedure is activated\n    even if the MME did not receive the active flag in the TAU Request\n    message. If the new MME receives the Downlink Data Notification message\n    or any downlink signalling message while the UE is still connected, the\n    user plane setup procedure may be activated even if the new MME did not\n    receive the active flag in the TAU Request message. The procedure is\n    described in detail in TS\u00c2\u00a036.300\u00c2\u00a0[5]. The message sequence should be\n    the same as for the UE triggered Service Request procedure specified in\n    clause 5.3.4.1 from the step when MME establish the bearers(s). The EPS\n    bearer status indicates the active bearers in the network. The UE\n    removes any internal resources related to bearers not marked active in\n    the received EPS bearer status. If the EPS bearer status information\n    was in the TAU Request, the MME shall indicate the EPS bearer status to\n    the UE. If ISR Activated is indicated to the UE, this indicates that\n    its P-TMSI and RAI shall remain registered with the network and shall\n    remain valid in the UE. At a Tracking Area Update with an MME change\n    ISR Activated shall not be indicated. At a Tracking Area Update without\n    an MME change, if ISR is activated for the UE when the MME receives the\n    Tracking Area Update Request, the MME should maintain ISR by indicating\n    ISR Activated in the Tracking Area Update Accept message. Handover\n    Restriction List is described in clause 4.3.5.7 \"Mobility\n    Restrictions\". The MME sets the IMS Voice over PS session supported as\n    described in clause\u00c2\u00a04.3.5.8.\n\n     For UE using CIoT EPS Optimisation without any activated PDN\n    connection, there is no EPS bearer status included in the TAU Accept\n    message.\n\n     The MME indicates the CIoT EPS Optimisations it supports and prefers\n    in the Supported Network Behaviour information as defined in\n    clause\u00c2\u00a04.3.5.10.\n\n     If there is a Service Gap timer running for the UE in the MME, the MME\n    shall ignore the active flag and signalling active flag and not perform\n    any of the actions related to these flags.\n\n     The MME shall include the Service Gap Time in the TAU Accept message\n    if the UE has indicated Service Gap Control capability and either if\n    Service Gap Time was received in step\u00c2\u00a019 from HSS in the subscription\n    information or if the Service Gap Time in the subscription information\n    has been updated by HSS User Profile management (i.e. the Insert\n    Subscriber Data procedure in clause\u00c2\u00a05.3.9.2).\n\n     If the UE included support for restriction of use of Enhanced Coverage\n    in step\u00c2\u00a01, the MME sends Enhanced Coverage Restricted parameter to the\n    eNB in the S1-AP message as defined in clause\u00c2\u00a04.3.28. The MME also\n    sends the Enhanced Coverage Restricted parameter to the UE in the TAU\n    Accept message. UE shall store Enhanced Coverage Restricted parameter\n    and shall use the value of Enhanced Coverage Restricted parameter to\n    determine if enhanced coverage feature should be used or not.\n\n     If the MME successfully obtained Header Compression Configuration\n    parameters in step\u00c2\u00a05 it indicates he continued use of previous\n    negotiated configuration to the UE in the Header Compression Context\n    Status for each EPS Bearer of the UE. When Header Compression Context\n    Status indicates that the previous negotiated configuration can no\n    longer be used for some EPS bearers, the UE shall stop performing\n    header compression and decompression when sending or receiving data\n    using Control Plane CIoT EPS Optimisation on these EPS bearers.\n\n     The MME checks if there is a \"Availability after DDN Failure\"\n    monitoring event or a \"UE Reachability\" monitoring event configured for\n    the UE in the MME for which an event notification has not yet been\n    sent. In such a case an event notification is sent (see TS\u00c2\u00a023.682\u00c2\u00a0[74]\n    for further information).\n\n     If the MME did not receive the Voice support match indicator in the MM\n    Context, then the MME may send a UE Radio Capability Match Request to\n    the eNB as described in clause\u00c2\u00a05.3.14. If the MME hasn't received Voice\n    support match indicator from the eNB then based on implementation MME\n    may set IMS Voice over PS session supported Indication and update it at\n    a later stage. After step\u00c2\u00a014, and in parallel to any of the preceding\n    steps, the MME shall send a Notify Request (Homogeneous Support of IMS\n    Voice over PS Sessions) message to the HSS:\n\n    -  If the MME has evaluated the support of IMS Voice over PS Sessions,\n       see clause\u00c2\u00a04.3.5.8, and\n\n    -  If the MME determines that it needs to update the Homogeneous\n       Support of IMS Voice over PS Sessions, see clause\u00c2\u00a04.3.5.8A.\n\n     The Emergency Service Support indicator informs the UE that Emergency\n    bearer services are supported. LCS Support Indication indicates whether\n    the network supports the EPC-MO-LR and/or CS-MO-LR as described in\n    TS\u00c2\u00a023.271\u00c2\u00a0[57]. Indication for support of 15 EPS bearers per UE\n    indicates the network supports 15 EPS bearers as defined in\n    clause\u00c2\u00a04.12.\n\n     When receiving the TAU Accept message and there is no ISR Activated\n    indication the UE shall set its TIN to \"GUTI\". When ISR Activated is\n    indicated and the UE's TIN indicates \"GUTI\" the UE's TIN shall not be\n    changed. When ISR Activated is indicated and the TIN is \"P-TMSI\" or\n    \"RAT-related TMSI\" the UE shall set its TIN to \"RAT-related TMSI\".\n\n     For an MME change ISR is not activated by the new MME to avoid context\n    transfer procedures with two old CN nodes.\n\n     For an emergency attached UE, emergency ISR is not activated.\n\n     If the TAU procedure is initiated by manual CSG selection and occurs\n    via a CSG cell, the UE upon receiving TAU Accept message shall add the\n    CSG ID and associated PLMN to its Allowed CSG list if it is not already\n    present. Manual CSG selection is not supported if the UE has emergency\n    bearers established.\n\n     If the UE included extended idle mode DRX parameters information\n    element, the MME includes extended idle mode DRX parameters information\n    element in the TAU accept if it decides to enable extended idle mode\n    DRX with Paging Time Window length assigned considering Subscribed\n    Paging Time Window (if available) and the local policy.\n\n     If the user plane setup is performed in conjunction with the TAU\n    Accept message and the TAU is performed via a hybrid cell, then the MME\n    shall send an indication whether the UE is a CSG member to the RAN\n    along with the S1-MME control message. Based on this information the\n    RAN may perform differentiated treatment for CSG and non-CSG members.\n\n  NOTE\u00c2\u00a010: If the UE receives a TAU Accept message via a hybrid cell, the\n         UE does not add the corresponding CSG ID and associated PLMN to its\n         Allowed CSG list. Adding a CSG ID and associated PLMN to the UE's\n         local Allowed CSG list for a hybrid cell is performed only by OTA\n         or OMA DM procedures.\n\n     If the UE receives a Service Gap Time in the TAU Accept message, the\n    UE shall store this parameter and apply Service Gap Control (see\n    clause\u00c2\u00a04.3.17.9).\n\n     If the UE has indicated support for dual connectivity with NR in the\n    TAU Request and the UE is not allowed to use NR as Secondary RAT, the\n    MME indicates that to the UE in the TAU Accept message.\n\n     If the user plane setup is performed and if RACS is supported and MME\n    has UE Radio Capability ID in UE context, it signals the UE Radio\n    Capability ID to the eNB as defined in clause\u00c2\u00a05.11.3a. If the eNB does\n    not have mapping between the specific UE Radio Capability ID and the UE\n    radio capabilities, it shall use the procedure described in\n    TS\u00c2\u00a036.413\u00c2\u00a0[36] to retrieve the mapping from the Core Network.\n\n  21.  If the GUTI was changed the UE acknowledges the new GUTI by\n    returning a Tracking Area Update Complete message to the MME.\n\n     When the \"Active flag\" is not set in the TAU Request message and the\n    Tracking Area Update was not initiated in ECM-CONNECTED state, the MME\n    releases the signalling connection with UE, according to clause\u00c2\u00a05.3.5.\n    For a UE using Control Plane CIoT EPS Optimisation, when the\n    \"Signalling active flag\" is set, the new MME shall not release the NAS\n    signalling connection with the UE immediately after the TAU procedure\n    is completed.\n\n  NOTE\u00c2\u00a011: The new MME may initiate E-RAB establishment (see\n         TS\u00c2\u00a036.413\u00c2\u00a0[36]) after execution of the security functions, or wait\n         until completion of the TA update procedure. For the UE, E-RAB\n         establishment may occur anytime after the TA update request is\n         sent.\n\nIn the case of a rejected tracking area update operation, due to regional\nsubscription, roaming restrictions, or access restrictions (see\nTS\u00c2\u00a023.221\u00c2\u00a0[27] and TS\u00c2\u00a023.008\u00c2\u00a0[28]) the new MME should not construct an MM\ncontext for the UE. In the case of receiving the subscriber data from HSS,\nthe new MME may construct an MM context and store the subscriber data for\nthe UE to optimise signalling between the MME and the HSS. A reject shall\nbe returned to the UE with an appropriate cause and the S1 connection shall\nbe released. Upon return to idle, the UE shall act according to\nTS\u00c2\u00a023.122\u00c2\u00a0[10].\n\nIf the new MME is unable to update the bearer context in one or more P-GWs,\nthe new MME shall deactivate the corresponding bearer contexts as described\nin clause \"MME Initiated Dedicated Bearer Deactivation Procedure\". This\nshall not cause the MME to reject the tracking area update.\n\nThe new MME shall determine the Maximum APN restriction based on the\nreceived APN Restriction of each bearer context in the Context Response\nmessage and then store the new Maximum APN restriction value.\n\nThe bearer contexts shall be prioritized by the new MME. If the new MME is\nunable to support the same number of active bearer contexts as received\nfrom old MME/SGSN, the prioritisation is used to decide which bearer\ncontexts to maintain active and which ones to delete. In any case, the new\nMME shall first update all contexts in one or more P-GWs and then\ndeactivate the context(s) that it cannot maintain as described in clause\n\"MME Initiated Dedicated Bearer Deactivation Procedure\". This shall not\ncause the MME to reject the tracking area update.\n\nThe new MME shall not deactivate emergency service related EPS bearers,\ni.e. EPS bearers with ARP value reserved for emergency services.\n\n  NOTE\u00c2\u00a012: If MS (UE) was in PMM-CONNECTED state the bearer contexts are\n         sent already in the Forward Relocation Request message as described\n         in clause \"Serving RNS relocation procedures\" of TS\u00c2\u00a023.060\u00c2\u00a0[7].\n\nIf the tracking area update procedure fails a maximum allowable number of\ntimes, or if the MME returns a Tracking Area Update Reject (Cause) message,\nthe UE shall enter EMM DEREGISTERED state.\n\nIf the new MME identifies that the RAT type has changed, the MME checks the\nsubscription information to identify for each APN whether to maintain the\nPDN connection, disconnect the PDN connection with a reactivation request,\nor, disconnect the PDN connection without reactivation request. If the MME\ndecides to deactivate a PDN connection it performs MME-initiated PDN\nConnection Deactivation procedure after the tracking area update procedure\nis completed but before the S1/RRC interface connection is released.\nExisting ESM cause values as specified in TS\u00c2\u00a024.301\u00c2\u00a0[46] (e.g. #39,\n\"reactivation requested\"; #66 \"Requested APN not supported in current RAT\nand PLMN combination\"; and for a dedicated bearer, possibly #37 \"EPS QoS\nnot accepted\") are used to cause predictable UE behaviour. If all the PDN\nconnections are disconnected and the UE does not support \"attach without\nPDN connectivity\", the MME shall request the UE to detach and reattach.\n\n\n"}, {"key": "Routing Area Update with MME interaction and without S-GW change", "numbering": "5.3.3.3", "title_level": 3, "desc": "5.3.3.3  Routing Area Update with MME interaction and without S-GW change\n\nThe Routing Area Update without S-GW change procedure takes place when a UE\nthat is registered with an MME selects a UTRAN or GERAN cell and the S-GW\nis not changed by the procedure. In this case, the UE changes to a Routing\nArea that the UE has not yet registered with the network. This procedure is\ninitiated by an ECM-IDLE state UE and may also be initiated if the UE is in\nECM-CONNECTED state. The RA update case is illustrated in Figure 5.3.3.3-1.\n\n  NOTE\u00c2\u00a01:  This procedure covers the MME to 2G or 3G SGSN RAU.\n\n                                    [pic]\n\n Figure 5.3.3.3-1: Routing Area Update with MME interaction and without S-GW\n                                   change\n\n  NOTE\u00c2\u00a02:  For a PMIP-based S5/S8, procedure steps (A) and (B) are defined\n         in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps 8 and 10 concern GTP based S5/S8.\n\n  1. The UE selects a UTRAN or GERAN cell. This cell is in a Routing Area\n    that the UE not yet registered with the network, or the UE reselects a\n    UTRAN or GERAN cell and the TIN indicates \"GUTI\". The UE in ECM-\n    CONNECTED state may change to the GERAN cell through Network Assisted\n    Cell Change (NACC).\n\n  2a.  The UE sends a Routing Area Update Request (old P-TMSI, P-TMSI Type,\n    old RAI, UE Core Network Capability, MS Network Capability, P-TMSI\n    Signature, additional P-TMSI/RAI, KSI, Voice domain preference and UE's\n    usage setting) message to the new SGSN. The UE shall set the P-TMSI\n    Type to indicate whether the P-TMSI is a native P-TMSI or is mapped\n    from a GUTI.\n\n     If the UE's internal TIN indicates \"GUTI\" and the UE holds a valid\n    GUTI then the UE indicates the GUTI as the old P-TMSI and old RAI. If\n    the UE's TIN indicates \"P-TMSI\" or \"RAT-related TMSI\" and the UE holds\n    a valid P-TMSI and related RAI then these two elements are indicated as\n    old P-TMSI and old RAI. Mapping a GUTI to a P-TMSI and an RAI is\n    specified in TS\u00c2\u00a023.003\u00c2\u00a0[9].\n\n     If the UE holds a valid P-TMSI and related RAI and the old P-TMSI and\n    old RAI indicate a P-TMSI/RAI mapped from a GUTI, then the UE indicates\n    these parameters as additional P-TMSI/RAI.\n\n     The old P-TMSI is indicated in the RAU Request message for Iu-mode\n    only. For Gb mode the TLLI is derived from the value that is determined\n    as the old P-TMSI according to the rules above. The routing parameter\n    that is signalled in the RRC signalling to the RNC for routing to the\n    SGSN is derived from the identifier that is signalled as the old P-TMSI\n    according to the rules above. For a combined MME/SGSN the RAN is\n    configured to route the NRI(s) of this combined node to the same\n    combined node. The RAN is also configured to route NRI(s) of P-TMSIs\n    that are generated by the UE's mapping of the GUTIs allocated by the\n    combined node. Such a RAN configuration may also be used for separate\n    nodes to avoid changing nodes in the pool caused by inter RAT mobility.\n\n     If the UE has a follow-on request, i.e. if there is pending uplink\n    traffic (signalling or data), the 3G\u00c2\u00a0SGSN may use, as an implementation\n    option, the follow-on request indication to release or keep the Iu\n    connection after the completion of the RA update procedure.\n\n     KSI is mapped from an eKSI identifying a KASME if the UE indicates a P-\n    TMSI mapped from GUTI in the information element \"old P-TMSI\". KSI\n    identifies a (CK, IK) pair if the UE indicates a P-TMSI in the\n    information element \"old P-TMSI\".\n\n     The UE sets the voice domain preference and UE's usage setting\n    according to its configuration, as described in clause\u00c2\u00a04.3.5.9.\n\n  2b.  The RNC shall add the Routing Area Identity, CSG access mode, CSG ID\n    before forwarding the message to the SGSN. This RA identity corresponds\n    to the RAI in the MM system information sent by the RNC to the UE. The\n    BSS shall add the Cell Global Identity (CGI) of the cell where the UE\n    is located before passing the message to the new SGSN. CSG ID is\n    provided by RAN if the UE sends the RAU Request message via a CSG cell\n    or a hybrid cell. CSG access mode is provided if the UE sends the RAU\n    Request message via a hybrid cell. If the CSG access mode is not\n    provided but the CSG ID is provided, the SGSN shall consider the cell\n    as a CSG cell. For SIPTO at the Local Network the with stand-alone GW\n    architecture the RNC includes the Local Home Network ID in the Initial\n    UE Message and in Direct Transfer message if the target cell is in a\n    Local Home Network.\n\n  3. The new S4\u00c2\u00a0SGSN determines the type of the old node, i.e. MME or SGSN,\n    as specified in clause\u00c2\u00a04.3.19, uses the old RAI received from the UE to\n    derive the old MME address, and sends a Context Request (P-TMSI, old\n    RAI, New SGSN Address, P-TMSI Signature) message to the old MME to get\n    the context for the UE. To validate the Context Request the old MME\n    uses a NAS token mapped from the P-TMSI Signature. If the UE is not\n    known in the old MME, the old MME responds with an appropriate error\n    cause. If integrity check fails in the old MME, the old MME responds\n    with an appropriate error cause which shall initiate the security\n    functions in the new S4 SGSN. If the security functions authenticate\n    the UE correctly, the new S4 SGSN shall send a Context Request (IMSI,\n    old RAI, New SGSN Address, UE Validated) message to the old MME.UE\n    Validated indicates that the new S4 SGSN has authenticated the UE. If\n    the new S4 SGSN indicates that it has authenticated the UE or if the\n    old MME authenticates the UE, the old MME starts a timer.\n\n     If the UE with emergency bearers is not authenticated in the old MME\n    (in a network supporting unauthenticated UEs) the old MME continues the\n    procedure with sending a Context Response and starting the timer also\n    when it cannot validate the Context Request.\n\n  4. The old MME responds with one Context Response (IMSI, ME Identity (if\n    available), KSI, CK, IK, unused Authentication Quintets, EPS Bearer\n    Contexts, Serving GW signalling Address and TEID(s), ISR Supported, MS\n    Info Change Reporting Action (if available), CSG Information Reporting\n    Action (if available), UE Time Zone, UE Core Network Capability, UE\n    Specific DRX Parameters, Change to Report (if present)) message. The\n    PDN\u00c2\u00a0GW Address and TEID(s) (for GTP-based S5/S8) or GRE Keys (PMIP-\n    based S5/S8) for uplink traffic and control plane, and the TI(s) is\n    part of the EPS Bearer context(s). The unused Authentication Quintets\n    in the MM Context may be sent if stored by the MME and the MME received\n    the unused Authentication Quintets from the same SGSN previously. ISR\n    Supported is indicated if the old MME and associated Serving GW are\n    capable to activate ISR for the UE.\n\n     If the UE receives emergency bearer services from the old MME and the\n    UE is UICCless, IMSI can not be included in the Context Response. For\n    emergency attached UEs, if the IMSI cannot be authenticated, then the\n    IMSI shall be marked as unauthenticated. Also, in this case, security\n    parameters are included only if available.\n\n     The new S4\u00c2\u00a0SGSN shall ignore the UE Core Network Capability contained\n    in the Context Response only when it has previously received an UE Core\n    Network Capability in the Routing Area Update Request. If UE is not\n    known in the old MME, the old MME responds with an appropriate error\n    cause.\n\n     Change to Report flag is included by the old MME if reporting of\n    change of UE Time Zone, or Serving Network, or both towards Serving GW\n    / PDN GW was deferred by the old MME.\n\n     The new SGSN maps the EPS bearers to PDP contexts 1-to-1 and maps the\n    EPS Bearer QoS parameter values of an EPS bearer to the Release\u00c2\u00a099 QoS\n    parameter values of a PDP context as defined in Annex E. The PDP\n    context(s) are established in the indicated order. The SGSN deactivates\n    the PDP contexts which cannot be established.\n\n     If SIPTO at the Local Network is active for a PDN connection in the\n    architecture with stand-alone GW, the old MME shall include the Local\n    Home Network ID of the old cell in the EPS Bearer context corresponding\n    to the SIPTO at the Local Network PDN connection.\n\n     For UE using CIoT EPS Optimisation without any activated PDN\n    connection, there is no EPS Bearer Context(s) included in the Context\n    Response message.\n\n     The old MME only transfers the EPS Bearer Context(s) that the new SGSN\n    supports. If not supported, EPS Bearer Context(s) of non-IP PDN\n    connection are not transferred to the new SGSN. EPS Bearer Context(s)\n    of Ethernet PDN connection type are not transferred to the new SGSN. If\n    the EPS Bearer Context(s) of a PDN connection has not been transferred,\n    the old MME shall consider all bearers of that PDN connection as failed\n    and release that PDN connection by triggering the MME requested PDN\n    disconnection procedure specified in clause\u00c2\u00a05.10.3.\n\n  5. Security functions may be executed. Procedures are defined in\n    clause\u00c2\u00a05.3.10 on \"Security Function\".\n\n     If the new SGSN is configured to allow emergency bearer services for\n    unauthenticated UE the new SGSN behave as follows:\n\n    -  where a UE has only emergency bearer services, the SGSN either skip\n       the authentication and security procedure or accepts that the\n       authentication may fail and continues the Routing Area Update\n       procedure; or\n\n    -  where a UE has both emergency and non emergency bearer services and\n       authentication fails, the SGSN continues the Routing Area Update\n       procedure and deactivates all the non-emergency PDP contexts as\n       specified in TS\u00c2\u00a023.060\u00c2\u00a0[7].\n\n  6. The new S4\u00c2\u00a0SGSN sends a Context Acknowledge (ISR Activated) message to\n    the old MME. Unless ISR is indicated by the new S4\u00c2\u00a0SGSN, the old MME\n    marks in its context that the information in the GWs is invalid. This\n    ensures that the old MME updates the GW if the UE initiates a TAU\n    procedure back to the old MME before completing the ongoing RAU\n    procedure.\n\n  NOTE\u00c2\u00a03:  Updating the GWs refers to modification of session(s) on the\n         Serving GW. This will result in successful re-establishment of the\n         S11/S4 tunnel between the MME/SGSN and the Serving GW.\n\n     ISR Activated indicates to the old MME that it shall maintain the UE's\n    contexts and the MME stops the timer started in step 3. In this case,\n    if the Implicit Detach timer is running, the old MME shall re-start it\n    with a slightly larger value than the UE's E-UTRAN Deactivate ISR\n    timer. When ISR Activated is not indicated and this timer expires the\n    old MME deletes all bearer resources of that UE. As the Context\n    Acknowledge from the new S4\u00c2\u00a0SGSN does not include any S-GW change the\n    old MME does not send any Delete Session Request message to the S-GW.\n    The SGSN shall not activate ISR if the associated Serving GW does not\n    support ISR.\n\n     If the security functions do not authenticate the UE correctly, then\n    the RAU is rejected, and the new S4\u00c2\u00a0SGSN sends a reject indication to\n    the old MME. The old MME shall continue as if the Identification and\n    Context Request was never received.\n\n     For UE using CIoT EPS Optimisation without any activated PDN\n    connection, the steps 7, 8, 9, 10, and 11 are skipped.\n\n     If the new SGSN identifies that the RAT type has changed, the SGSN\n    checks the subscription information to identify for each APN whether to\n    maintain the PDN connection, disconnect the PDN connection with a\n    reactivation request or disconnect PDN connection without reactivation\n    request. If the SGSN decides to deactive a PDN connection it performs\n    SGSN-initiated PDN Connection Deactivation procedure after tracking\n    area procedure is completed. Existing SM cause values as specified in\n    TS\u00c2\u00a024.008\u00c2\u00a0[47] (e.g. #39, \"reactivation requested\"; #66 \"Requested APN\n    not supported in current RAT and PLMN combination\"; and for a dedicated\n    bearer, possibly #37 \"QoS not accepted\") are used to cause predictable\n    UE behaviour.\n\n  7. In this procedure flow the Serving GW is not relocated. The SGSN sends\n    a Modify Bearer Request (new SGSN Address and TEID, RAT type, ISR\n    Activated) message per PDN connection to the Serving GW. If indicated,\n    the information ISR Activated indicates that ISR is activated. As it is\n    a mobility from E-UTRAN, if the target SGSN supports location\n    information change reporting, the target SGSN shall include the User\n    Location Information (according to the supported granularity) in the\n    Modify Bearer Request, regardless of whether location information\n    change reporting had been requested in the previous RAT by the PDN GW.\n    If the PDN GW requested User CSG information, the SGSN also includes\n    the User CSG information IE in this message. If either the UE Time Zone\n    has changed , or Context Response message from old MME indicated\n    pending UE Time Zone change reporting (via Change to Report flag), the\n    SGSN includes the UE Time Zone IE in this message. If either the\n    Serving Network has changed, or Context Response message from old MME\n    indicated pending Serving Network change reporting (via Change to\n    Report flag) the SGSN includes the new Serving Network IE in this\n    message. In network sharing scenarios Serving Network denotes the\n    serving core network.\n\n     When the Modify Bearer Request does not indicate ISR Activated the S-\n    GW deletes any ISR resources by sending a Delete Bearer Request to the\n    other CN node that has bearer resources on the S-GW reserved. RAT type\n    indicates a change in radio access.\n\n     If ISR Activated is indicated or SGSN and SGW are configured to\n    release S4 U-Plane when EPS Bearer Contexts associated with the\n    released RABs are to be preserved, the SGSN does not send SGSN address\n    and TEID for U-Plane in Modify Bearer Request.\n\n  NOTE\u00c2\u00a04:  The User CSG Information IE is not sent in step\u00c2\u00a07 if the \"follow-\n         on request indication\" indicates releasing the Iu connection after\n         the completion of the RA update procedure.\n\n  8. If the RAT type has changed or the Serving GW has received the User\n    Location Information IE and/or the UE Time Zone IE and/or User CSG\n    information IE and/or the Serving Network IE from the MME in step\u00c2\u00a07 the\n    Serving GW informs the PDN GW(s) about the change of this information\n    that e.g. can be used for charging, by sending the message Modify\n    Bearer Request (RAT type) per PDN connection to the PDN GW(s)\n    concerned. User Location Information IE and/or UE Time Zone IE and/or\n    User CSG information IE and/or Serving Network IE are also included if\n    they are present in step\u00c2\u00a07.\n\n  9. If dynamic PCC is deployed, and RAT type information or UE location\n    information needs to be conveyed from the PDN GW to the PCRF, then the\n    PDN GW shall send this information to the PCRF by means of an IP-CAN\n    Session Modification procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  NOTE\u00c2\u00a05:  The PDN GW does not need to wait for the PCRF response, but\n         continues in the next step. If the PCRF response leads to an EPS\n         bearer modification the PDN GW should initiate a bearer update\n         procedure.\n\n  10.  The PDN GW updates its context field and returns a Modify Bearer\n    Response (MSISDN) message to the Serving GW. MSISDN is included if the\n    PDN GW has it stored in its UE context. If location information change\n    reporting is required and supported in the target SGSN, the PDN GW\n    shall provide MS Info Change Reporting Action in the Modify Bearer\n    Response.\n\n  11.  The Serving GW updates its context fields. If ISR Activated is\n    indicated in step 7 and RAT Type received in step 7 indicates UTRAN or\n    GERAN, then the Serving GW only updates the SGSN Control Plane Address\n    and keeps the MME related information unchanged. Otherwise the Serving\n    GW shall update all of the information stored locally for this UE with\n    the related information received from the SGSN. Then the Serving GW\n    returns a Modify Bearer Response (Serving GW address and TEID for\n    uplink traffic, MS Info Change Reporting Action) message.\n\n     When the SGSN receives the Modify Bearer Response message, the SGSN\n    checks if there is a \"Availability after DDN Failure\" monitoring event\n    or a \"UE Reachability\" monitoring event configured for the UE in the\n    SGSN and in such a case sends an event notification (see TS\u00c2\u00a023.682\u00c2\u00a0[74]\n    for further information).\n\n  12.  The new SGSN verifies whether it holds subscription data for the UE\n    identified by the P-TMSI, the additional PTMSI/RAI or by the IMSI\n    received with the context data from the old CN node.\n\n     The additional P-TMSI/RAI allows the new SGSN to find any already\n    existing UE context stored in the new SGSN. If there are no\n    subscription data in the new SGSN for this UE, or for some network\n    sharing scenario (e.g. GWCN) if the PLMN-ID of the RAI supplied by the\n    RNC is different from that of the RAI in the UE's context, then the new\n    SGSN informs the HSS of the change of the SGSN by sending an Update\n    Location (SGSN Number, SGSN Address, IMSI, Homogenous Support of IMS\n    Voice over PS Sessions, UE SRVCC capability, equivalent PLMN list)\n    message to the HSS. For \"Homogenous Support of IMS Voice over PS\n    Sessions\", see clause\u00c2\u00a05.3.8A of TS\u00c2\u00a023.060\u00c2\u00a0[7]. The inclusion of the\n    equivalent PLMN list indicates that the SGSN supports the inter-PLMN\n    handover to a CSG cell in an equivalent PLMN using the subscription\n    information of the target PLMN.\n\n     If the UE initiates the RAU procedure in a VPLMN supporting Autonomous\n    CSG Roaming and the HPLMN has enabled Autonomous CSG Roaming in the\n    VPLMN (via Service Level Agreement) and the SGSN needs to retrieve the\n    CSG subscription information of the UE from the CSS, the SGSN initiates\n    the Update CSG Location Procedure with CSS as described in\n    clause\u00c2\u00a05.3.12.\n\n  13.  The HSS sends a Cancel Location (IMSI, Cancellation Type) message to\n    the old SGSN with the Cancellation Type set to Update Procedure.\n\n     When receiving the Cancel Location message the old SGSN removes all\n    the UE contexts. The old SGSN acknowledges with a Cancel Location Ack\n    (IMSI) message.\n\n  14.  When receiving the Context Acknowledge message from the new SGSN and\n    if the old MME has an S1-MME association for the UE, the source MME\n    sends a S1-U Release Command to the source eNodeB after the timer\n    started in step\u00c2\u00a03 has expired. The RRC connection is released by the\n    source eNodeB. The source eNodeB confirms the release of the RRC\n    connection and of the S1-U connection by sending a S1-U Release\n    Complete message to the source MME.\n\n  15.  The HSS acknowledges the Update Location message by sending an\n    Update Location Ack (IMSI, Subscription Data) to the new SGSN. The\n    Subscription Data may contain the CSG subscription data for the\n    registered PLMN and for the equivalent PLMN list requested by SGSN in\n    step\u00c2\u00a012.\n\n     If the UE initiates the RAU procedure at a CSG cell, the new S4 SGSN\n    shall check whether the CSG ID and associated PLMN is contained in the\n    CSG subscription and is not expired. If the CSG ID and associated PLMN\n    is not present or expired, the S4 SGSN shall send a RAU reject message\n    to the UE with an appropriate cause value. The UE shall remove the CSG\n    ID and associated PLMN from its Allowed CSG list if present.\n\n     If the Update Location is rejected by the HSS, the new SGSN rejects\n    the RAU Request from the UE with an appropriate cause sent in the RAU\n    Reject message to the UE. In such cases, the new SGSN releases any\n    local SGSN EPS Bearer contexts for this particular UE.\n\n  16.  Void.\n\n  17.  Void.\n\n  18.  If due to regional subscription restrictions or access restrictions\n    (e.g. CSG restrictions) the UE is not allowed to access the RA:\n\n    -  For UEs with ongoing emergency bearer services, the new SGSN accept\n       the Routing Area Update Request and deactivates the non-emergency PDP\n       contexts as specified in clause\u00c2\u00a09.2.4.2 in TS\u00c2\u00a023.060\u00c2\u00a0[7]. .If the\n       Routing Area Update procedure is initiated in PMM-IDLE/STANDBY state,\n       all non-emergency PDP Contexts are deactivated by the Routing Area\n       without PDP Context deactivation signalling between the UE and the\n       SGSN\n\n    -  For all other cases, the new SGSN rejects Routing Area Update\n       Request with an appropriate cause to the UE and notifies the HSS of\n       rejection (details of this notification is covered in stage 3).\n\n     The new SGSN responds to the UE with a Routing Area Update Accept (P-\n    TMSI, P-TMSI signature, ISR Activated, Emergency Service Support\n    indicator, PDP context status) message to the UE. P-TMSI is included if\n    the SGSN allocates a new P-TMSI. The Emergency Service Support\n    indicator informs the UE that Emergency bearer services are supported\n    over UTRAN.\n\n     If ISR Activated is indicated to the UE, its GUTI and list of TAs\n    shall remain registered with the network and shall remain valid in the\n    UE.\n\n     When receiving the RAU Accept message and there is no ISR Activated\n    indication the UE shall set its TIN to \"P-TMSI\". When ISR Activated is\n    indicated and the UE's TIN indicates \"P-TMSI\" the TIN shall not be\n    changed. When ISR Activated is indicated and the UE's TIN indicates\n    \"GUTI\" or \"RAT-related TMSI\" the UE shall set its TIN to \"RAT-related\n    TMSI\".\n\n     If an SGSN change ISR is not activated by the new SGSN to avoid\n    context transfer procedures with two old CN nodes.\n\n     If the RAU procedure is initiated by manual CSG selection and occurs\n    via a CSG cell, the UE upon receiving the RAU Accept shall add the CSG\n    ID and associated PLMN to its Allowed CSG list if it is not already\n    present. Manual CSG selection is not supported if the UE has emergency\n    bearers established.\n\n     In Iu mode, if after step\u00c2\u00a07 the new SGSN receives a Downlink Data\n    Notification message or any other downlink signalling message while the\n    UE is still connected, the new SGSN may prolong the PS signalling\n    connection with the UE.\n\n     If there is DL data buffered for a UE using power saving functions\n    (i.e. the DL Data Buffer Expiration Time in the MM context for the UE\n    in the SGSN has not expired), the user plane setup is performed in\n    conjunction with the RAU Accept message.\n\n     With the PDP context status information, the UE shall deactivate all\n    those bearers contexts locally which are active in the UE, but are\n    indicated by the SGSN as being inactive.\n\n     If the user plane setup is performed in conjunction with the RAU\n    Accept message and the RAU is performed via a hybrid cell, then the\n    SGSN shall send an indication whether the UE is a CSG member to the RAN\n    along with the RANAP message. Based on this information the RAN may\n    perform differentiated treatment for CSG and non-CSG members.\n\n  NOTE\u00c2\u00a06:  If the UE receives a RAU Accept message via a hybrid cell, the\n         UE does not add the corresponding CSG ID and associated PLMN to its\n         Allowed CSG list. Adding a CSG ID and associated PLMN to the UE's\n         local Allowed CSG list for a hybrid cell is performed only by OTA\n         or OMA DM procedures.\n\n  19.  If P-TMSI was included in the Routing Area Update Accept message,\n    the UE acknowledges the new P-TMSI by returning a Routing Area Update\n    Complete message to the SGSN.\n\n  20.  For Iu-mode, if the UE has uplink data or signalling pending it\n    shall send a Service Request (P-TMSI, CKSN, Service Type) message to\n    the new SGSN. If a P-TMSI was allocated in step 18, that P-TMSI is the\n    one included in this message. Service Type specifies the requested\n    service. Service Type shall indicate one of the following: Data or\n    Signalling.\n\n  21.  If the UE has sent the Service Request, the new 3G SGSN requests the\n    RNC to establish a radio access bearer by sending a RAB Assignment\n    Request (RAB ID(s), QoS Profile(s), GTP SNDs, GTP SNUs, PDCP SNUs)\n    message to the RNC. If Direct Tunnel is established the SGSN provides\n    to the RNC the Serving GW's Address for User Plane and TEID for uplink\n    data.\n\n  22.  If the SGSN established Direct Tunnel in step 21) it shall send\n    Modify Bearer Request per PDN connection to the Serving GW and include\n    the RNC's Address for User Plane and downlink TEID for data. The\n    Serving GW updates the Address for User Plane and TEID for downlink\n    data and return a Modify Bearer Response.\n\n  NOTE\u00c2\u00a07:  EPS does not support any CAMEL procedures.\n\n  NOTE\u00c2\u00a08:  The new SGSN may initiate RAB establishment after execution of\n         the security functions (step\u00c2\u00a05), or wait until completion of the RA\n         update procedure. For the MS, RAB establishment may occur anytime\n         after the RA update request is sent (step\u00c2\u00a02).\n\nIn the case of a rejected routing area update operation, due to regional\nsubscription, roaming restrictions or access restrictions (see\nTS\u00c2\u00a023.221\u00c2\u00a0[27] and TS\u00c2\u00a023.008\u00c2\u00a0[28]) the new SGSN should not construct an MM\ncontext. In the case of receiving the subscriber data from HSS, the new\nSGSN may construct an MM context and store the subscriber data for the UE\nto optimise signalling between the SGSN and the HSS. A reject shall be\nreturned to the UE with an appropriate cause and the PS signalling\nconnection shall be released. Upon return to idle, the UE shall act\naccording to TS\u00c2\u00a023.122\u00c2\u00a0[10].\n\nIf the network supports the MOCN configuration for network sharing, the\nSGSN may, if the UE is not a 'Network Sharing Supporting MS', in this case\ndecide to initiate redirection by sending a Reroute Command to the RNS, as\ndescribed in TS\u00c2\u00a023.251\u00c2\u00a0[24] instead of rejecting the routing area update.\n\nIf the new SGSN is unable to update the bearer context in one or more P-\nGWs, the new SGSN shall deactivate the corresponding bearer contexts as\ndescribed in clause \"SGSN-initiated PDP Context Deactivation Procedure\" of\nTS\u00c2\u00a023.060\u00c2\u00a0[7]. This shall not cause the SGSN to reject the routing area\nupdate.\n\nThe new SGSN shall determine the Maximum APN restriction based on the\nreceived APN Restriction of each bearer context in the Context Response\nmessage and then store the new Maximum APN restriction value.\n\nThe PDP contexts shall be prioritized by the new SGSN. If the new SGSN is\nunable to support the same number of active PDP contexts as received from\nthe old MME, the prioritisation is used to decide which PDP contexts to\nmaintain active and which ones to delete. In any case, the new SGSN shall\nfirst update all PDP contexts in one or more P-GWs and then deactivate the\nPDP context(s) that it cannot maintain as described in clause \"SGSN-\ninitiated PDP Context Deactivation Procedure\" of TS\u00c2\u00a023.060\u00c2\u00a0[7]. This shall\nnot cause the SGSN to reject the routing area update.\n\n  NOTE\u00c2\u00a09:  If the UE was in PMM-CONNECTED state the bearer contexts are\n         sent already in the Forward Relocation Request message as described\n         in clause \"Serving RNS relocation procedures\" of TS\u00c2\u00a023.060\u00c2\u00a0[7].\n\nIf the routing area update procedure fails a maximum allowable number of\ntimes, or if the SGSN returns a Routing Area Update Reject (Cause) message,\nthe UE shall enter PMM DETACHED state.\n\n\n"}, {"key": "Void", "numbering": "5.3.3.4", "title_level": 3, "desc": "5.3.3.4  Void\n\n\n\n\n"}, {"key": "Void", "numbering": "5.3.3.5", "title_level": 3, "desc": "5.3.3.5  Void\n\n\n\n\n"}, {"key": "Routing Area Update with MME interaction and with S-GW change", "numbering": "5.3.3.6", "title_level": 3, "desc": "5.3.3.6  Routing Area Update with MME interaction and with S-GW change\n\nThe Routing Area Update with S-GW change procedure takes place when a UE\nthat is registered with an MME selects a UTRAN or GERAN cell and the S-GW\nis changed by the procedure. In this case, the UE changes to a Routing Area\nthat the UE has not yet registered with the network. This procedure is\ninitiated by an ECM-IDLE state UE and may also be initiated if the UE is in\nECM-CONNECTED state. This RA update case is illustrated in Figure 5.3.3.6-\n1.\n\n  NOTE\u00c2\u00a01:  This procedure covers the MME to 2G or 3G SGSN RAU.\n\n                                    [pic]\n\n  Figure 5.3.3.6-1: Routing Area Update with MME interaction and with S-GW\n                                   change\n\n  NOTE\u00c2\u00a02:  For a PMIP-based S5/S8, procedure steps (A) and (B) are defined\n         in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps 8 and 10 concern GTP based S5/S8\n\n  1. The UE selects a UTRAN or GERAN cell. This cell is in a Routing Area\n    that the UE not yet registered with the network or the UE reselects a\n    UTRAN or GERAN cell and the TIN indicates \"GUTI\". The UE in ECM-\n    CONNECTED state may change to the GERAN cell through Network Assisted\n    Cell Change (NACC).\n\n  2a.  The UE sends a Routing Area Update Request (old RAI, old P-TMSI, P-\n    TMSI Type, UE Core Network Capability, MS Network Capability, P-TMSI\n    Signature, additional P-TMSI/RAI, KSI, Voice domain preference and UE's\n    usage setting) message to the new SGSN. The UE shall set the P-TMSI\n    Type to indicate whether the P-TMSI is a native P-TMSI or is mapped\n    from a GUTI.\n\n     If the UE's TIN indicates \"GUTI\" and the UE holds a valid GUTI then\n    the UE indicates the GUTI as the old P-TMSI and old RAI. If the UE's\n    TIN indicates \"P-TMSI\" or \"RAT-related TMSI\" and the UE holds a valid P-\n    TMSI and related RAI then these two elements are indicated as old P-\n    TMSI and old RAI. Mapping a GUTI to a P-TMSI and an RAI is specified in\n    TS\u00c2\u00a023.003\u00c2\u00a0[9].\n\n     If the UE holds a valid P-TMSI and related RAI and the old P-TMSI and\n    old RAI indicate a P-TMSI/RAI mapped from a GUTI, then the UE indicates\n    these parameters as additional P-TMSI/RAI.\n\n     The old P-TMSI is indicated in the RAU Request message for Iu-mode\n    only. For Gb mode the TLLI is derived from the value that is determined\n    as the old P-TMSI according to the rules above. The routing parameter\n    that is signalled in the RRC signalling to the RNC for routing to the\n    SGSN is derived from the identifier that is signalled as the old P-TMSI\n    according to the rules above. For a combined MME/SGSN the RAN is\n    configured to route the NRI(s) of this combined node to the same\n    combined node. The RAN is also configured to route NRI(s) of P-TMSIs\n    that are generated by the UE's mapping of the GUTIs allocated by the\n    combined node. Such a RAN configuration may also be used for separate\n    nodes to avoid changing nodes in the pool caused by inter RAT mobility.\n\n     If the UE has a follow-on request, i.e. if there is pending uplink\n    traffic (signalling or data), the 3G-SGSN may use, as an implementation\n    option, the follow-on request indication to release or keep the Iu\n    connection after the completion of the RA update procedure.\n\n     KSI is mapped from an eKSI identifying a KASME if the UE indicates a P-\n    TMSI mapped from GUTI in the information element \"old P-TMSI\". KSI\n    identifies a (CK, IK) pair if the UE indicates a P-TMSI in the\n    information element \"old P-TMSI\".\n\n     The UE sets the voice domain preference and UE's usage setting\n    according to its configuration, as described in clause\u00c2\u00a04.3.5.9.\n\n  2b.  The RNC shall add the Routing Area Identity, CSG access mode, CSG ID\n    before forwarding the message to the SGSN. This RA identity corresponds\n    to the RAI in the MM system information sent by the RNC to the UE. The\n    BSS shall add the Cell Global Identity (CGI) of the cell where the UE\n    is located before passing the message to the new SGSN. CSG ID is\n    provided by RAN if the UE sends the RAU Request message via a CSG cell\n    or a hybrid cell. CSG access mode is provided if the UE sends the RAU\n    Request message via a hybrid cell. If the CSG access mode is not\n    provided but the CSG ID is provided, the SGSN shall consider the cell\n    as a CSG cell. For SIPTO at the Local Network the with stand-alone GW\n    architecture the RNC includes the Local Home Network ID in the Initial\n    UE Message and in Direct Transfer message if the target cell is in a\n    Local Home Network.\n\n  3. The new S4\u00c2\u00a0SGSN determines the type of the old node, i.e. MME or SGSN,\n    as specified in clause\u00c2\u00a04.3.19, uses the old RAI received from the UE to\n    derive the old MME address, and the new S4 SGSN sends a Context Request\n    (P-TMSI, old RAI, New SGSN Address, P-TMSI Signature) message to the\n    old MME to get the context for the UE. To validate the Context Request\n    the old MME uses a NAS token mapped from the P-TMSI Signature. If the\n    UE is not known in the old MME, the old MME responds with an\n    appropriate error cause. If integrity check fails in the old MME, the\n    old MME responds with an appropriate error cause which should initiate\n    the security functions in the new S4 SGSN. If the security functions\n    authenticate the UE correctly, the new S4 SGSN shall send a Context\n    Request (IMSI, old RAI, New SGSN Address, UE Validated) message to the\n    old MME. UE Validated indicates that the new S4 SGSN has authenticated\n    the UE. If the new S4\u00c2\u00a0SGSN indicates that it has authenticated the UE\n    or if the old MME authenticates the UE, the old MME starts a timer.\n\n     If the UE with emergency bearers is not authenticated in the old MME\n    (in a network supporting unauthenticated UEs) the old MME continues the\n    procedure with sending a Context Response and starting the timer also\n    when it cannot validate the Context Request.\n\n  4. The old MME responds with a Context Response (MM Context, EPS Bearer\n    Contexts, Serving GW signalling Address and TEID(s), MS Info Change\n    Reporting Action (if available), CSG Information Reporting Action (if\n    available), UE Time Zone and ISR Supported) message. The MM context\n    contains security related information as well as other parameters\n    (including IMSI) as described in clause\u00c2\u00a05.7.2 (Information Storage for\n    MME). The PDN GW Address and TEID(s) (for GTP-based S5/S8) or GRE Keys\n    (PMIP-based S5/S8) for uplink traffic and control plane, and the TI(s)\n    is part of the EPS Bearer context(s). The unused Authentication\n    Quintets in the MM Context may be sent if stored by the MME and if the\n    MME received the unused Authentication Quintets from the same SGSN\n    previously.\n\n     If the UE receives only emergency bearer services from the old MME and\n    the UE is UICCless, IMSI can not be included in the Context Response.\n    For emergency attached UEs, if the IMSI cannot be authenticated, then\n    the IMSI shall be marked as unauthenticated. Also, in this case,\n    security parameters are included only if available. ISR Supported is\n    indicated if the old MME and associated Serving GW are capable to\n    activate ISR for the UE.\n\n     The new SGSN shall ignore the UE Core Network Capability in the MM\n    Context of the Context Response only when it has previously received an\n    UE Core Network Capability in the Routing Area Request. If UE is not\n    known in the old MME, the old MME responds with a appropriate error\n    cause.\n\n     The new SGSN maps the EPS bearers to PDP contexts 1-to-1 and maps the\n    EPS Bearer QoS parameter values of an EPS bearer to the Release\u00c2\u00a099 QoS\n    parameter values of a bearer context as defined in Annex E. The PDP\n    context(s) are established in the indicated order. The SGSN deactivates\n    the PDP contexts which cannot be established.\n\n     If SIPTO at the Local Network is active for a PDN connection in the\n    architecture with stand-alone GW, the old MME shall include the Local\n    Home Network ID of the old cell in the EPS Bearer context corresponding\n    to the SIPTO at the Local Network PDN connection.\n\n     If the UE uses power saving functions and the DL Data Buffer\n    Expiration Time for the UE has not expired (see High latency\n    communication in clause\u00c2\u00a04.3.17.7), the old MME indicates Buffered DL\n    Data Waiting in the Context Response. When this is indicated, the new\n    SGSN shall invoke data forwarding (corresponding to clause\u00c2\u00a05.3.3.1A)\n    and setup the user plane in conjunction to the RAU procedure for\n    delivery of the buffered DL data to the UE.\n\n     For UE using CIoT EPS Optimisation without any activated PDN\n    connection, there is no EPS Bearer Context(s) included in the Context\n    Response message.\n\n     The old MME only transfers the EPS Bearer Context(s) that the new SGSN\n    supports. If not supported, EPS Bearer Context(s) of non-IP PDN\n    connection are not transferred to the new SGSN. EPS Bearer Context(s)\n    of Ethernet PDN connection type are not transferred to the new SGSN. If\n    the EPS Bearer Context(s) of a PDN connection has not been transferred,\n    the old MME shall consider all bearers of that PDN connection as failed\n    and release that PDN connection by triggering the MME requested PDN\n    disconnection procedure specified in clause\u00c2\u00a05.10.3.\n\n  5. Security functions may be executed. Procedures are defined in\n    clause\u00c2\u00a05.3.10 on \"Security Function\".\n\n     For ongoing emergency services only, if the new SGSN is configured to\n    support emergency bearer services in limited service state, it may skip\n    the authentication procedure or proceed even if authentication fails.\n    If the new SGSN does not support emergency bearer services in limited\n    service state, then it rejects the RAU request with an appropriate\n    reject cause.\n\n  6. If the new SGSN identifies that the RAT type has changed, the SGSN\n    checks the subscription information to identify for each APN whether to\n    maintain the PDN connection, disconnect the PDN connection with a\n    reactivation request or disconnect PDN connection without reactivation\n    request. If the SGSN decides to deactive a PDN connection it performs\n    SGSN-initiated PDN Connection Deactivation procedure after tracking\n    area procedure is completed. Existing SM cause values as specified in\n    TS\u00c2\u00a024.008\u00c2\u00a0[47] (e.g. #39, \"reactivation requested\"; #66 \"Requested APN\n    not supported in current RAT and PLMN combination\"; and for a dedicated\n    bearer, possibly #37 \"QoS not accepted\") are used to cause predictable\n    UE behaviour.\n\n     The new SGSN determines to relocate the Serving GW. The Serving GW is\n    relocated when the old Serving GW cannot continue to serve the UE. The\n    new SGSN may also decide to relocate the Serving GW if a new Serving GW\n    is expected to serve the UE longer and/or with a more optimal UE to PDN\n    GW path, or if a new Serving GW can be co-located with the PDN GW.\n    Selection of a new Serving GW is performed according to clause\u00c2\u00a04.3.8.2\n    on \"Serving GW selection function\".\n\n     The new SGSN sends a Context Acknowledge (Serving GW change\n    indication) message to the old MME. Serving GW change indication\n    indicates a new Serving GW has been selected. The old MME marks in its\n    context that the information in the GWs is invalid. This ensures that\n    the old MME updates the GWs if the UE initiates a TAU procedure back to\n    the old MME before completing the ongoing RAU procedure.\n\n  NOTE\u00c2\u00a03:  Updating the GWs refers to deletion of session(s) on the Serving\n         GW followed by re-creation of session(s) on the Serving GW. The re-\n         creation of session(s) on the Serving GW will result in successful\n         re-establishment of the S5/S8 tunnel between the selected Serving\n         GW and the PDN GW.\n\n     The old MME deletes all bearer resources of the UE when the timer\n    started in step\u00c2\u00a03 expires.\n\n     If the security functions do not authenticate the UE correctly, then\n    the RAU is rejected, and the new S4\u00c2\u00a0SGSN sends a reject indication to\n    the old MME. The MME shall continue as if the Identification and\n    Context Request was never received.\n\n     For UE using CIoT EPS Optimisation without any activated PDN\n    connection, the steps 7, 8, 9, 10, 11, 16 and 17 are skipped.\n\n  7. In this procedure flow the Serving GW is relocated. The SGSN sends a\n    Create Session Request (IMSI, bearer contexts, SGSN Address and TEID\n    for the control plane, RAT Type, Type, the Protocol Type over S5/S8,\n    Serving Network, UE Time Zone, etc) message per PDN connection to the\n    selected new Serving GW. The PDN GW address is indicated in the bearer\n    contexts. Type indicates to the Serving GW to send the Modify Bearer\n    Request to the PDN GW. The Protocol Type over S5/S8 is provided to\n    Serving GW which protocol should be used over S5/S8 interface. RAT type\n    indicates a change in radio access. As it is a mobility from E-UTRAN,\n    if the target SGSN supports location information change reporting, the\n    target SGSN shall include the User Location Information (according to\n    the supported granularity) in the Modify Bearer Request, regardless of\n    whether location information change reporting had been requested in the\n    previous RAT by the PDN GW. If the PDN GW requested User CSG\n    information, the SGSN also includes the User CSG Information IE in this\n    message.\n\n  8. The new Serving GW sends the message Modify Bearer Request (Serving GW\n    Address, Serving GW TEID, RAT type, Serving Network) per PDN connection\n    to the PDN GW concerned. User Location Information IE and/or UE Time\n    Zone IE and/or User CSG Information IE are also included if they are\n    present in step\u00c2\u00a07.\n\n  9. If dynamic PCC is deployed, and RAT type information or UE location\n    information or UE Time Zone needs to be conveyed from the PDN GW to the\n    PCRF, then the PDN GW shall send this information to the PCRF by means\n    of an IP-CAN Session Modification procedure as defined in\n    TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  NOTE\u00c2\u00a04:  The PDN GW does not need to wait for the PCRF response, but\n         continues in the next step. If the PCRF response leads to an EPS\n         bearer modification the PDN GW should initiate a bearer update\n         procedure.\n\n  10.  The PDN GW updates its context field and returns a Modify Bearer\n    Response (Charging Id, MSISDN) message to the Serving GW. The MSISDN is\n    included if the PDN GW has it stored in its UE context. If location\n    information change reporting is required and supported in the target\n    SGSN, the PDN GW shall provide MS Info Change Reporting Action in the\n    Modify Bearer Response.\n\n     If the Serving GW is relocated, the PDN GW shall send one or more \"end\n    marker\" packets on the old path immediately after switching the path.\n    If the source Serving GW has no downlink user plane established, the\n    Serving GW shall discard the \"end marker\" received from the PDN GW and\n    shall not send Downlink Data Notification. Otherwise the Serving GW\n    shall forward the \"end marker\" packets to the source eNodeB.\n\n  11.  The new Serving GW updates its bearer context. This allows the\n    Serving GW to route Bearer PDUs to the PDN GW when received from RNC.\n    The new Serving GW returns a Create Session Response (Serving GW\n    address and TEID, PDN GW Address and TEIDs (for GTP-based S5/S8) or GRE\n    keys (for PMIP-based S5/S8, MS Info Change Reporting Action) at the PDN\n    GW(s) for uplink traffic) message to the SGSN.\n\n     When the SGSN receives the Create Session Response message, the SGSN\n    checks if there is a \"Availability after DDN Failure\" monitoring event\n    or a \"UE Reachability\" monitoring event configured for the UE in the\n    SGSN and in such a case sends an event notification (see TS\u00c2\u00a023.682\u00c2\u00a0[74]\n    for further information).\n\n  12.  The new SGSN verifies whether it holds subscription data for the UE\n    identified by the P-TMSI, the additional P-TMSI/RAI or by the IMSI\n    received with the context data from the old CN node.\n\n     The additional P-TMSI/RAI allows the new SGSN to find any already\n    existing UE context stored in the new SGSN. If there are no\n    subscription data in the new SGSN for this UE, or for some network\n    sharing scenario (e.g. GWCN) if the PLMN-ID of the RAI supplied by the\n    RNC is different from that of the RAI in the UE's context, then the new\n    SGSN informs the HSS of the change of SGSN by sending an Update\n    Location (SGSN Number, SGSN Address, IMSI, Homogenous Support of IMS\n    Voice over PS Session, UE SRVCC capability, equivalent PLMN list)\n    message to the HSS. For \"Homogenous Support of IMS Voice over PS\n    Sessions\", see clause\u00c2\u00a05.3.8A of TS\u00c2\u00a023.060\u00c2\u00a0[7]. The inclusion of the\n    equivalent PLMN list indicates that the SGSN supports the inter-PLMN\n    handover to a CSG cell in an equivalent PLMN using the subscription\n    information of the target PLMN.\n\n     If the UE initiates the RAU procedure in a VPLMN supporting Autonomous\n    CSG Roaming and the HPLMN has enabled Autonomous CSG Roaming in the\n    VPLMN (via Service Level Agreement) and the SGSN needs to retrieve the\n    CSG subscription information of the UE from the CSS, the SGSN initiates\n    the Update CSG Location Procedure with CSS as described in\n    clause\u00c2\u00a05.3.12.\n\n  13.  The HSS sends a Cancel Location (IMSI, Cancellation Type) message to\n    the old SGSN with the Cancellation Type set to Update Procedure.\n\n     When receiving the Cancel Location message the old SGSN removes all\n    the UE contexts. The old SGSN acknowledges with a Cancel Location Ack\n    (IMSI) message.\n\n  14.  When receiving the Context Acknowledge message from the new S4 SGSN\n    and if the old MME has an S1-MME association for the UE, the source MME\n    sends a S1-U Release Command to the source eNodeB after the timer\n    started in step3 has expired. The RRC connection is released by the\n    source eNodeB. The source eNodeB confirms the release of the RRC\n    connection and of the S1-U connection by sending a S1-U Release\n    Complete message to the source MME.\n\n  15.  The HSS acknowledges the Update Location message by sending an\n    Update Location Ack (IMSI, Subscription Data) to the new SGSN. If the\n    Update Location is rejected by the HSS, the new SGSN rejects the RAU\n    Request from the UE with an appropriate cause. In such cases, the SGSN\n    releases any local SGSN EPS Bearer contexts for this particular UE, and\n    additionally deletes the EPS bearer resources in the new Serving GW by\n    sending the Delete Session Request (Cause, Operation Indication)\n    messages to the new Serving GW. The Operation Indication flag shall not\n    be set. Therefore, the new Serving GW receiving this request shall not\n    initiate a delete procedure towards the PDN GW.\n\n     The new SGSN validates the UE's presence in the (new) RA. If due to\n    regional subscription restrictions or access restrictions (e.g. CSG\n    restrictions) the UE is not allowed to be attached in the RA, the SGSN\n    rejects the Routing Area Update Request with an appropriate cause to\n    the UE and notifies the HSS of the rejection. The Subscription Data may\n    contain the CSG subscription data for the registered PLMN and for the\n    equivalent PLMN list requested by SGSN in step\u00c2\u00a012.\n\n     If the UE initiates the RAU procedure at a CSG cell, the new S4 SGSN\n    shall check whether the CSG ID and associated PLMN is contained in the\n    CSG subscription and is not expired. If the CSG ID and associated PLMN\n    is not present or expired, the S4 SGSN shall send a RAU reject message\n    to the UE with an appropriate cause value. The UE shall remove the CSG\n    ID and associated PLMN from its Allowed CSG list if present.\n\n  16.  When the timer started in step\u00c2\u00a03 expires and the old MME received\n    the Serving GW change indication in the Context Acknowledge message,\n    the old MME deletes the EPS bearer resources by sending Delete Session\n    Request (Cause, Operation Indication) messages to the old Serving GW.\n    The operation Indication flag is not set, that indicates to the old\n    Serving GW that the old Serving GW shall not initiate a delete\n    procedure towards the PDN GW. If ISR is activated the cause indicates\n    to the old S-GW that the old S-GW shall delete the bearer resources on\n    the other old CN node by sending Delete Bearer Request message(s) to\n    that CN node.\n\n  17.  The old Serving GW acknowledges with Delete Session Response (Cause)\n    messages. The old Serving GW discards any packets buffered for the UE.\n\n  18.  If due to regional subscription restrictions or access restrictions\n    the UE is not allowed to access the RA:\n\n  -  For UEs with ongoing emergency bearer services, the new SGSN accept\n    the Routing Area Update Request and deactivates the non-emergency PDP\n    contexts as specified in clause\u00c2\u00a09.2.4.2 of TS\u00c2\u00a023.060\u00c2\u00a0[7]. If the\n    Routing Area Update procedure is initiated in PMM-IDLE/STANDBY state,\n    all non-emergency PDP Contexts are deactivated by the Routing Area\n    Update procedure without PDP Context deactivation signalling between\n    the UE and the SGSN.\n\n  -  For all other cases, the new SGSN rejects Routing Area Update Request\n    with an appropriate cause to the UE and notifies the HSS of rejection\n    (details of this notification is specified in stage\u00c2\u00a03).\n\n     The new SGSN responds to the UE with a Routing Area Update Accept (P-\n    TMSI, P-TMSI Signature, Emergency Service Support indicator, PDP\n    context status) message. The Emergency Service Support indicator\n    informs the UE that Emergency bearer services are supported over UTRAN.\n\n     For an S-GW change ISR Activated is never indicated by the SGSN to the\n    UE as it needs a TAU with the same S-GW first to activate ISR. For an\n    SGSN change ISR is not activated by the new SGSN to avoid context\n    transfer procedures with two old CN nodes.\n\n     When receiving the RAU Accept message, as there is no ISR Activated\n    indication, the UE shall set its TIN to \"P-TMSI\".\n\n     In Iu mode, if after step\u00c2\u00a07 the new SGSN receives a Downlink Data\n    Notification message or any other downlink signalling message while the\n    UE is still connected, the new SGSN may prolong the PS signalling\n    connection with the UE.\n\n     If there is DL data buffered for a UE using power saving functions\n    (i.e. the DL Data Buffer Expiration Time in the MM context for the UE\n    in the SGSN has not expired), the user plane setup is performed in\n    conjunction with the RAU Accept message.\n\n     If the RAU procedure is initiated by manual CSG selection and occurs\n    via a CSG cell, the UE upon receiving the RAU Accept message shall add\n    the CSG ID and associated PLMN to its Allowed CSG list if it is not\n    already present. Manual CSG selection is not supported if the UE has\n    emergency bearers established.\n\n     With the PDP context status information, the UE shall deactivate all\n    those bearers contexts locally which are active in the UE, but are\n    indicated by the SGSN as being inactive.\n\n     If the user plane setup is performed in conjunction with the RAU\n    Accept message and the RAU is performed via a hybrid cell, then the\n    SGSN shall send an indication whether the UE is a CSG member to the RAN\n    along with the RANAP message. Based on this information the RAN may\n    perform differentiated treatment for CSG and non-CSG members.\n\n  NOTE\u00c2\u00a05:  If the UE receives a RAU Accept message via a hybrid cell, the\n         UE does not add the corresponding CSG ID and associated PLMN to its\n         Allowed CSG list. Adding a CSG ID and associated PLMN to the UE's\n         local Allowed CSG list for a hybrid cell is performed only by OTA\n         or OMA DM procedures.\n\n  NOTE\u00c2\u00a06:  When ISR Activated is indicated and the UE's TIN indicates \"P-\n         TMSI\" the TIN is not changed. When ISR Activated is indicated and\n         the UE's TIN indicates \"GUTI\" or \"RAT-related TMSI\" the UE shall\n         set its TIN to \"RAT-related TMSI\".\n\n  19.  If the P-TMSI was included in the RAU Accept message, the UE\n    acknowledges the new P-TMSI by returning a Routing Area Update Complete\n    message to the SGSN.\n\n  20.  For Iu-mode, if the UE has uplink data or signalling pending it\n    shall send a Service Request (P-TMSI, CKSN, Service Type) message to\n    the new SGSN. If a P-TMSI was allocated in step 18, that P-TMSI is the\n    one included in this message. Service Type specifies the requested\n    service. Service Type shall indicate one of the following: Data or\n    Signalling.\n\n  21.  If the UE has sent the Service Request, the new 3G SGSN requests the\n    RNC to establish a radio access bearer by sending a RAB Assignment\n    Request (RAB ID(s), QoS Profile(s), GTP SNDs, GTP SNUs, PDCP SNUs)\n    message to the RNC. If Direct Tunnel is established the SGSN provides\n    to the RNC the Serving GW's Address for User Plane and TEID for uplink\n    data.\n\n  22.  If the SGSN established Direct Tunnel in step 21) it shall send\n    Modify Bearer Request to the Serving GW and include the RNC's Address\n    for User Plane and downlink TEID for data. The Serving GW updates the\n    Address for User Plane and TEID for downlink data and return a Modify\n    Bearer Response.\n\n  NOTE\u00c2\u00a07:  EPS does not support any CAMEL procedures.\n\nIn the case of a rejected routing area update operation, due to regional\nsubscription, roaming restrictions, access restrictions (see TS\u00c2\u00a023.221\u00c2\u00a0[27]\nand TS\u00c2\u00a023.008\u00c2\u00a0[28]) or because the SGSN cannot determine the HLR address to\nestablish the locating updating dialogue, the new SGSN should not construct\nan MM context. In the case of receiving the subscriber data from HLR, the\nnew SGSN may construct an MM context and store the subscriber data for the\nUE to optimise signalling between the SGSN and the HSS. A reject shall be\nreturned to the UE with an appropriate cause and the PS signalling\nconnection shall be released. Upon return to idle, the UE shall act\naccording to TS\u00c2\u00a023.122\u00c2\u00a0[10].\n\nIf the new SGSN is unable to update the bearer context in one or more P-\nGWs, the new SGSN shall deactivate the corresponding bearer contexts as\ndescribed in clause \"SGSN-initiated PDP Context Deactivation Procedure\" of\nTS\u00c2\u00a023.060\u00c2\u00a0[7]. This shall not cause the SGSN to reject the routing area\nupdate.\n\nThe new SGSN shall determine the Maximum APN restriction based on the\nreceived APN Restriction of each bearer context in the Context Response\nmessage and then store the new Maximum APN restriction value.\n\nThe PDP contexts shall be prioritized by the new SGSN. If the new SGSN is\nunable to support the same number of active PDP contexts as received from\nold MME, the prioritisation is used to decide which PDP contexts to\nmaintain active and which ones to delete. In any case, the new SGSN shall\nfirst update all PDP contexts in one or more P-GWs and then deactivate the\nPDP context(s) that it cannot maintain as described in clause \"SGSN-\ninitiated PDP Context Deactivation Procedure\" of TS\u00c2\u00a023.060\u00c2\u00a0[7]. This shall\nnot cause the SGSN to reject the routing area update.\n\nIf the routing area update procedure fails a maximum allowable number of\ntimes, or if the SGSN returns a Routing Area Update Reject (Cause) message,\nthe MS shall enter IDLE state.\n\n\n"}, {"key": "Service Request procedures", "numbering": "5.3.4", "title_level": 2, "desc": "5.3.4  Service Request procedures\n\n\n"}, {"key": "UE triggered Service Request", "numbering": "5.3.4.1", "title_level": 3, "desc": "5.3.4.1  UE triggered Service Request\n\n                                    [pic]\n\n          Figure 5.3.4.1-1: UE triggered Service Request procedure\n\nThe Service Request procedure in this clause\u00c2\u00a0is triggered by the UE in ECM-\nIDLE status to establish user plane radio bearers for the UE.\n\nThe UE in ECM-IDLE state can also use this procedure to establish user\nplane radio bearers even if the UE applies Control Plane CIoT EPS\nOptimisation, when the UE and MME supports S1-U data transfer or User Plane\nEPS Optimisation in addition to Control Plane CIoT EPS Optimisation.\n\n  NOTE\u00c2\u00a01:  For a PMIP-based S5/S8, procedure steps (A) are defined in\n         TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps\u00c2\u00a09 and 11 concern GTP-based S5/S8.\n\n  1. The UE sends NAS message Service Request towards the MME encapsulated\n    in an RRC message to the eNodeB. The RRC message(s) that can be used to\n    carry the S-TMSI and this NAS message are described in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n  2. The eNodeB forwards NAS message to MME. NAS message is encapsulated in\n    an S1-AP: Initial UE Message (NAS message, TAI+ECGI of the serving\n    cell, S-TMSI, CSG ID, CSG access Mode, RRC establishment cause).\n    Details of this step are described in TS\u00c2\u00a036.300\u00c2\u00a0[5]. If the MME can't\n    handle the Service Request it will reject it. CSG ID is provided if the\n    UE sends the Service Request message via a CSG cell or a hybrid cell.\n    CSG access mode is provided if the UE sends the Service Request message\n    via a hybrid cell. If the CSG access mode is not provided but the CSG\n    ID is provided, the MME shall consider the cell as a CSG cell.\n\n     If a CSG ID is indicated and CSG access mode is not provided, and\n    there is no subscription data for this CSG ID and associated PLMN or\n    the CSG subscription is expired, the MME rejects the Service Request\n    with an appropriate cause. The UE shall remove the CSG ID and\n    associated PLMN of the cell where the UE has initiated the service\n    request procedure from the Allowed CSG list, if present.\n\n     For UEs with emergency EPS bearers, i.e. at least one EPS bearer has\n    an ARP value reserved for emergency services, if CSG access\n    restrictions do not allow the UE to get normal services the MME shall\n    deactivate all non-emergency bearers and accept the Service Request.\n\n     If LIPA is active for a PDN connection and if the cell accessed by the\n    UE does not link to the L-GW where the UE inititiated the LIPA PDN\n    Connection, the MME shall not request the establishment of the bearers\n    of the LIPA PDN connection from the eNodeB in step\u00c2\u00a04 and shall request\n    disconnection of the LIPA PDN connection according to clause\u00c2\u00a05.10.3. If\n    the UE has no other PDN connection then the MME shall reject the\n    Service Request with an appropriate cause value resulting in the UE\n    detaching, skip the following steps of the procedure and initiate the\n    release of the core network resources with the implicit MME-initiated\n    Detach procedure according to clause\u00c2\u00a05.3.8.3.\n\n     If there is a \"Availability after DDN Failure\" monitoring event or a\n    \"UE Reachability\" monitoring event configured for the UE in the MME,\n    the MME sends an event notification (see TS\u00c2\u00a023.682\u00c2\u00a0[74] for further\n    information).\n\n     To assist Location Services, the eNB indicates the UE's Coverage Level\n    to the MME.\n\n  3. NAS authentication/security procedures as defined in clause\u00c2\u00a05.3.10 on\n    \"Security function\" may be performed.\n\n     If the MME is configured to support RLOS and the UE indicated Attach\n    Type \"RLOS\", based on local regulation and operator policy, the MME may\n    skip the authentication and security setup, or the MME may perform\n    authentication if security information is available or obtainable from\n    a HSS, and continue the Service Request procedure regardless of the\n    authentication result.\n\n  4. If there is a Service Gap timer running in the MME MM Context for the\n    UE and the MME is not waiting for a MT paging response from the UE, the\n    MME rejects the Service Request with an appropriate cause. In addition,\n    MME may also provide a UE with a Mobility Management Back-off timer set\n    to the remaining value of the Service Gap timer.\n\n     The MME deletes S11-U related information in UE context if there is\n    any, including TEID(DL) for the S11-U for Control Plane CIoT EPS\n    Optimisation if data buffering is in the MME, ROHC context for Control\n    Plane CIoT EPS Optimisation, etc, but not the Header Compression\n    Configuration. The MME sends S1-AP Initial Context Setup Request\n    (Serving GW address, S1-TEID(s) (UL), EPS Bearer QoS(s), Security\n    Context, MME Signalling Connection Id, Handover Restriction List, CSG\n    Membership Indication) message to the eNodeB. If there is a PDN\n    connection established for Local IP Access, this message includes a\n    Correlation ID for enabling the direct user plane path between the HeNB\n    and the L-GW. If there is a PDN connection established for SIPTO at the\n    Local Network with L-GW function collocated with the (H)eNB, this\n    message includes a SIPTO Correlation ID for enabling the direct user\n    plane path between the (H)eNB and the L-GW. This step activates the\n    radio and S1 bearers for all the active EPS Bearers. The eNodeB stores\n    the Security Context, MME Signalling Connection Id, EPS Bearer QoS(s)\n    and S1-TEID(s) in the UE RAN context. The step is described in detail\n    in TS\u00c2\u00a036.300\u00c2\u00a0[5]. Handover Restriction List is described in clause\n    4.3.5.7 \"Mobility Restrictions\".\n\n  NOTE\u00c2\u00a02:  In this release of the 3GPP specification the Correlation ID and\n         SIPTO Correlation ID is set equal to the user plane PDN GW TEID\n         (GTP-based S5) or GRE key (PMIP-based S5) which is specified in\n         clause\u00c2\u00a05.3.2.1 and clause\u00c2\u00a05.10.2.\n\n     If the UE included support for restriction of use of Enhanced\n    Coverage, the MME sends Enhanced Coverage Restricted parameter to the\n    eNB in the S1-AP message.\n\n     The MME shall only request to establish Emergency EPS Bearer if the UE\n    is not allowed to access the cell where the UE initiated the service\n    request procedure due to CSG access restriction.\n\n     If the Service Request is performed via a hybrid cell, CSG Membership\n    Indication indicating whether the UE is a CSG member shall be included\n    in the S1-AP message from the MME to the RAN. Based on this information\n    the RAN can perform differentiated treatment for CSG and non-CSG\n    members.\n\n     If RACS is supported and MME has UE Radio Capability ID in UE context,\n    it signals the UE Radio Capability ID to the eNB as defined in\n    clause\u00c2\u00a05.11.3a. If the eNB does not have mapping between the specific\n    UE Radio Capability ID and the UE radio capabilities, it shall use the\n    procedure described in TS\u00c2\u00a036.413\u00c2\u00a0[36] to retrieve the mapping from the\n    Core Network.\n\n  5. The eNodeB performs the radio bearer establishment procedure. The user\n    plane security is established at this step, which is described in\n    detail in TS\u00c2\u00a036.300\u00c2\u00a0[5]. When the user plane radio bearers are setup.\n    EPS bearer state synchronization is performed between the UE and the\n    network, i.e. the UE shall locally remove any EPS bearer for which no\n    radio bearers are setup and, if the radio bearer for a default EPS\n    bearer is not established, the UE shall locally deactivate all EPS\n    bearers associated to that default EPS bearer.\n\n  6. The uplink data from the UE can now be forwarded by eNodeB to the\n    Serving GW. The eNodeB sends the uplink data to the Serving GW address\n    and TEID provided in the step 4. The Serving GW forwards the uplink\n    data to the PDN\u00c2\u00a0GW.\n\n  7. The eNodeB sends an S1-AP message Initial Context Setup Complete\n    (eNodeB address, List of accepted EPS bearers, List of rejected EPS\n    bearers, S1 TEID(s) (DL)) to the MME. This step is described in detail\n    in TS\u00c2\u00a036.300\u00c2\u00a0[5]. If the Correlation ID or SIPTO Correlation ID is\n    included in step\u00c2\u00a04, the eNodeB shall use the included information to\n    establish a direct user plane path to the L-GW and forward uplink data\n    for Local IP Access or SIPTO at the Local Network with L-GW function\n    collocated with the (H)eNB accordingly.\n\n  8. The MME sends a Modify Bearer Request message (eNodeB address, S1\n    TEID(s) (DL) for the accepted EPS bearers, Delay Downlink Packet\n    Notification Request, RAT Type, MO Exception data counter) per PDN\n    connection to the Serving GW. If the Serving GW supports Modify Access\n    Bearers Request procedure and if there is no need for the Serving GW to\n    send the signalling to the PDN GW, the MME may send Modify Access\n    Bearers Request (eNodeB address(es) and TEIDs for downlink user plane\n    for the accepted EPS bearers, Delay Downlink Packet Notification\n    Request) per UE to the Serving GW to optimise the signalling. The\n    Serving GW is now able to transmit downlink data towards the UE. The\n    usage of the Delay Downlink Packet Notification Request Information\n    Element is specified in clause 5.3.4.2 below. If the PDN GW requested\n    UE's location and/or User CSG information and the UE's location and/or\n    User CSG information has changed, the MME also includes the User\n    Location Information IE and/or User CSG Information IE in this message.\n    If ISR is activated or if the Serving Network IE has changed compared\n    to the last reported Serving Network IE then the MME also includes the\n    Serving Network IE in this message. If the UE Time Zone has changed\n    compared to the last reported UE Time Zone then the MME shall include\n    the UE Time Zone IE in this message. If the internal flag Pending\n    Network Initiated PDN Connection Signalling is set, the MME indicates\n    UE available for end to end signalling in the Modify Bearer Request\n    message and reset the flag.\n\n     The MME only includes the MO Exception data counter if the RRC\n    establishment cause is set to \"MO exception data\" and the UE is\n    accessing via the NB-IoT RAT. The MME maintains the MO Exception Data\n    Counter for Serving PLMN Rate Control purposes (see clause\u00c2\u00a04.7.7.2).\n    The MME may immediately send the MO Exception Data Counter to the\n    Serving GW. Alternatively, in order to reduce signalling, the MME may\n    send the MO Exception Data Counter to the Serving GW as described in\n    TS\u00c2\u00a029.274\u00c2\u00a0[43].\n\n     The MME and the Serving GW clears the DL Data Buffer Expiration Time\n    in their UE contexts if it was set, to remember that any DL data\n    buffered for a UE using power saving functions has been delivered and\n    to avoid any unnecessary user plane setup in conjunction with a later\n    TAU.\n\n     If a default EPS bearer is not accepted by the eNodeB, all the EPS\n    bearers associated to that default bearer shall be treated as non-\n    accepted bearers. The MME releases the non-accepted bearers by\n    triggering the bearer release procedure as specified in clause\u00c2\u00a05.4.4.2.\n    If the Serving GW receives a DL packet for a non-accepted bearer, the\n    Serving GW drops the DL packet and does not send a Downlink Data\n    Notification to the MME.\n\n  9. If the RAT Type has changed compared to the last reported RAT Type or\n    if the UE's Location and/or Info IEs and/or UE Time Zone and/or if ISR\n    is not activated and Serving Network id and/or the indication UE\n    available for end to end signalling are present in step\u00c2\u00a08, the Serving\n    GW shall send the Modify Bearer Request message (RAT Type, MO Exception\n    data counter) per PDN connection to the PDN GW. User Location\n    Information IE and/or User CSG Information IE and/or Serving Network IE\n    and/or UE Time Zone and/or the indication UE available for end to end\n    signalling are also included if they are present in step\u00c2\u00a08.\n\n     If the Modify Bearer Request message is not sent because of above\n    reasons and the PDN GW charging is paused, then the SGW shall send a\n    Modify Bearer Request message with PDN Charging Pause Stop Indication\n    to inform the PDN GW that the charging is no longer paused. Other IEs\n    are not included in this message.\n\n     If the Modify Bearer Request message is not sent because of above\n    reasons but the MME indicated the MO Exception data counter, then the\n    Serving Gateway should notify the PDN GW that this RRC establishment\n    cause has been used by the MO Exception Data Counter (see\n    TS\u00c2\u00a029.274\u00c2\u00a0[43]). The Serving GW indicates each use of this RRC\n    establishment cause by the related counter on its CDR.\n\n  10.  If dynamic PCC is deployed, the PDN GW interacts with the PCRF to\n    get the PCC rule(s) according to the RAT Type by means of a PCEF\n    initiated IP-CAN Session Modification procedure as defined in\n    TS\u00c2\u00a023.203\u00c2\u00a0[6]. If dynamic PCC is not deployed, the PDN GW may apply\n    local QoS policy.\n\n     The PDN GW indicates each use of the RRC establishment cause \"MO\n    Exception Data\" by the related counter on its CDR.\n\n  11.  The PDN GW sends the Modify Bearer Response to the Serving GW.\n\n  12.  The Serving GW shall return a Modify Bearer Response (Serving GW\n    address and TEID for uplink traffic) to the MME as a response to a\n    Modify Bearer Request message, or a Modify Access Bearers Response\n    (Serving GW address and TEID for uplink traffic) as a response to a\n    Modify Access Bearers Request message. If the Serving GW cannot serve\n    the MME Request in the Modify Access Bearers Request message without\n    S5/S8 signalling other than to unpause charging in the PDN GW or\n    without corresponding Gxc signalling when PMIP is used over the S5/S8\n    interface, it shall respond to the MME with indicating that the\n    modifications are not limited to S1-U bearers, and the MME shall repeat\n    its request using a Modify Bearer Request message per PDN connection.\n\n     If SIPTO at the Local Network is active for a PDN connection with\n    stand-alone GW deployment and the Local Home Network ID for stand-alone\n    accessed by the UE differs from the Local Home Network ID where the UE\n    initiated the SIPTO@LN PDN Connection, the MME shall request\n    disconnection of the SIPTO at the local network PDN connection(s) with\n    the \"reactivation requested\" cause value according to clause\u00c2\u00a05.10.3. If\n    the UE has no other PDN connection, the MME initiated \"explicit detach\n    with reattach required\" procedure according to clause\u00c2\u00a05.3.8.3.\n\n     If SIPTO at the Local Network is active for a PDN connection with\n    collocated LGW deployement and the L-GW CN address of the cell accessed\n    by the UE differs from the L-GW CN address of the cell where the UE\n    initiated the SIPTO at the Local Network PDN Connection, the MME shall\n    request disconnection of the SIPTO at the local network PDN\n    connection(s) with the \"reactivation requested\" cause value according\n    to clause\u00c2\u00a05.10.3. If the UE has no other PDN connection, the MME\n    initiated \"explicit detach with reattach required\" procedure according\n    to clause\u00c2\u00a05.3.8.3.\n\n\n"}, {"key": "Handling of abnormal conditions in UE triggered Service Request", "numbering": "5.3.4.2", "title_level": 3, "desc": "5.3.4.2  Handling of abnormal conditions in UE triggered Service Request\n\nUnder certain conditions, the current UE triggered Service Request\nprocedure can cause unnecessary Downlink Packet Notification messages which\nincrease the load of the MME.\n\nThis can occur when uplink data sent in step 6 causes a response on the\ndownlink which arrives at the Serving GW before the Modify Bearer Request\nmessage, step 8. This data cannot be forwarded from the Serving GW to the\neNodeB and hence it triggers a Downlink Data Notification message.\n\nIf the MME receives a Downlink Data Notification after step 2 and before\nstep 9, the MME shall not send S1 interface paging messages. However,\nacross all the UEs on that MME, the MME shall monitor the rate at which\nthese events occur. If the rate becomes significant (as configured by the\noperator) and the MME's load exceeds an operator configured value, the MME\nshall indicate \"Delay Downlink Packet Notification Request\" with parameter\nD to the Serving Gateway, where D is the requested delay given as an\ninteger multiple of 50\u00c2\u00a0ms, or zero. The Serving GW then uses this delay in\nbetween receiving downlink data and sending the Downlink Data Notification\nmessage.\n\n  NOTE\u00c2\u00a01:  A low rate of reception of Downlink Data Notifications between\n         steps 2 and 9 should be considered a normal circumstance, e.g. due\n         to the chance that a UE Terminating call/session is initiated at\n         roughly the same time as the UE triggered Service Request\n         procedure.\n\n  NOTE\u00c2\u00a02:  It is recommended that this rate is determined over 60\u00c2\u00a0second\n         periods.\n\nThe MME shall use the step 8 Modify Access Bearers Request or Modify Bearer\nRequest of the UE initiated Service Request procedure to indicate \"Delay\nDownlink Packet Notification Request\" to the Serving GW.\n\nTo determine the amount of delay requested by a given MME, the Serving GW\neither uses the last Modify Access Bearers Request or Modify Bearer Request\nmessage which is part of a Service Request procedure, or, just uses one of\nthe Service Request procedure's Modify Access Bearers Request or Modify\nBearer Request messages received within the preceding 30\u00c2\u00a0seconds. The\nlatter mode of operation shall be taken into account when implementing the\nMME.\n\nThe MME is responsible for setting the value of D. The exact algorithm for\nsetting the value is implementation dependent, two examples are given below\nto serve as a guideline:\n\n  EXAMPLE 1:  The MME adaptively increases the value of D when the rate of\n             unnecessary Downlink Data Notifications is too high; and\n             correspondingly it decreases the value when the rate is not\n             too high.\n\n  EXAMPLE 2:  When unnecessary Downlink Data Notifications arrive, the MME\n             measures the average time from the reception of the\n             unnecessary Downlink Data Notification to the reception of the\n             Modify Access Bearers Request or Modify Bearer Response from\n             the Serving GW in the same UE triggered Service Request\n             Procedure. The value of D is calculated from this average, by\n             adding a safety margin.\n\nNormally, upon receipt of a downlink data packet for which there is no DL-\nTEID of the S1 user plane tunnel, the S-GW shall send the Downlink Data\nNotification message to the MME without delay.\n\nIf the S-GW determines from the last Modify Access Bearers Request or\nModify Bearer Request message which is part of a Service Request procedure\nthat a given MME request delaying of the Downlink Packet Notification by a\ndelay of D, it shall (only for UEs of that MME) buffer the Downlink Data\nfor a period D. If the DL-TEID and eNodeB address for the UE is received\nbefore the expiry of the timer, the timer shall be cancelled and the\nNetwork triggered Service Request procedure is finished without sending the\nDownlink Data Notification message to the MME, i.e. DL data are sent to the\nUE. Otherwise the Downlink Data Notification message is sent to the MME\nwhen the timer expires.\n\n  NOTE\u00c2\u00a03:  The above procedure and indicated time values are intended to\n         ensure that the procedure is \"stable\"; avoids RAN impacts; and,\n         that the negative impacts of shortening the DRX interval on UE\n         battery life are avoided.\n\n\n"}, {"key": "Network Triggered Service Request", "numbering": "5.3.4.3", "title_level": 3, "desc": "5.3.4.3  Network Triggered Service Request\n\n                                    [pic]\n\n        Figure 5.3.4.3-1: Network triggered Service Request procedure\n\nIf the MME needs to signal with the UE that is in ECM-IDLE state, e.g. to\nperform the MME/HSS-initiated detach procedure for the ECM-IDLE mode UE or\nthe S-GW receives control signalling (e.g. Create Bearer Request or Update\nBearer Request), the MME starts network triggered service request procedure\nfrom step 3a in the Network Triggered Service request procedure.\n\nIf the MME wishes to use the Control Plane CIoT EPS Optimisation for mobile\nterminating services, then the procedure of clause\u00c2\u00a05.3.4B.3 is used to\nreplace the procedure of this clause.\n\nIf ISR is activated, when the Serving GW receives a Create Bearer Request\nor Update Bearer Request for a UE, and the S-GW does not have a downlink S1-\nU and the SGSN has notified the Serving GW that the UE has moved to PMM-\nIDLE or STANDBY state, the Serving GW buffers signalling messages and sends\na Downlink Data Notification to trigger the MME and SGSN to page the UE. If\nthe Serving GW, while waiting for the user plane to be established, is\ntriggered to send a second Downlink Data Notification with higher priority\n(i.e. ARP priority level) than the first Downlink Data Notification was\nsent with, the Serving GW sends a new Downlink Data Notification message\nindicating the higher priority to the MME. If the Serving GW receives\nadditional downlink signalling messages for a bearer with same or lower\npriority than the first Downlink Data Notification was sent for or if the\nServing GW has sent the second Downlink Data Notification message\nindicating the higher priority and receives additional downlink signalling\nmessages for this UE, the Serving GW buffers these downlink signalling\nmessages and does not send a new Downlink Data Notification. The S-GW will\nbe notified about the current RAT type based on the UE triggered service\nrequest procedure. The S-GW will go on executing the dedicated bearer\nactivation or dedicated bearer modification procedure, i.e. send the\ncorresponding buffered signalling to MME or SGSN which UE resides in now\nand inform the current RAT type to the PDN GW if the RAT type has been\nchanged compared to the last reported RAT Type. If dynamic PCC is deployed,\nthe current RAT type information shall also be conveyed from the PDN GW to\nthe PCRF. If the PCRF response leads to an EPS bearer modification the PDN\nGW should initiate a bearer update procedure as specified in clause\u00c2\u00a05.4.2.1\nbelow.\n\nWhen the Serving GW sends a Downlink Data Notification, it shall include\nboth EPS Bearer ID and ARP. If the Downlink Data Notification is triggered\nby the arrival of downlink data packets at the Serving GW, the Serving GW\nshall include the EPS Bearer ID and ARP associated with the bearer on which\nthe downlink data packet was received. If the Downlink Data Notification is\ntriggered by the arrival of control signalling, the Serving GW shall\ninclude the EPS Bearer ID and ARP if present in the control signalling. If\nthe ARP is not present in the control signalling, the Serving GW shall\ninclude the ARP in the stored EPS bearer context.\n\nIf a LIPA PDN connection exists, when the L-GW receives the downlink data\nfor a UE that is in ECM-IDLE state, the L-GW sends the first downlink user\npacket to Serving GW and buffers all other downlink user packets. The\nServing GW will trigger the MME to page the UE.\n\n  1. When the Serving GW receives a downlink data packet/control signalling\n    for a UE known as not user plane connected (i.e. the S-GW context data\n    indicates no downlink user plane TEID), it buffers the downlink data\n    packet and identifies which MME or SGSN is serving that UE.\n\n     If that MME has requested the Serving GW to throttle downlink low\n    priority traffic and if the downlink data packet is received on a low\n    priority bearer to be throttled (see clause\u00c2\u00a04.3.7.4.1a), the SGW drops\n    the downlink data. The steps below are not executed.\n\n     If that MME has requested the S-GW to delay sending the Downlink Data\n    Notification (see clause 5.3.4.2 on \"Handling of abnormal conditions in\n    UE triggered Service Request\"), the Serving GW buffers the downlink\n    data and waits until the timer expires before continuing with step 2.\n    If the DL-TEID and eNodeB address for that UE is received before the\n    expiry of the timer, the timer shall be cancelled and the Network\n    triggered Service Request procedure is finished without executing the\n    steps below, i.e. DL data are sent to the UE.\n\n     If the Serving GW receives additional downlink data packets/control\n    signalling for this UE before the expiry of the timer, the Serving GW\n    does not restart this timer.\n\n  2. The Serving GW sends a Downlink Data Notification message (ARP, EPS\n    Bearer ID, Paging Policy Indication) to the MME and SGSN nodes for\n    which it has control plane connectivity for the given UE. The ARP and\n    EPS Bearer ID are always set in Downlink Data Notification. The MME and\n    SGSN respond to the S-GW with a Downlink Data Notification Ack message.\n    When supporting Paging Policy Differentiation, the Serving GW indicates\n    in the message the Paging Policy Indication related to the downlink\n    data that triggered the Downlink Data Notification message, as\n    described in clause\u00c2\u00a04.9.\n\n  NOTE\u00c2\u00a01:  The ARP, the EPS Bearer ID and optionally the Paging Policy\n         Indication are sent to the SGSN as well as MME, but the usage of\n         these parameters at SGSN is not specified in this release of the\n         specification.\n\n     An MME and an SGSN that detects that the UE is in a power saving state\n    (e.g. Power Saving Mode or extended idle mode DRX) and cannot be\n    reached by paging at the moment, shall invoke extended buffering\n    depending on operator configuration, except for cases described in next\n    paragraphs. MME/SGSN derives the expected time before radio bearers can\n    be established to the UE. The MME/SGSN then indicates DL Buffering\n    Requested to the Serving GW in the Downlink Data Notification Ack\n    message and includes a DL Buffering Duration time and optionally a DL\n    Buffering Suggested Packet Count. The MME/SGSN stores a new value for\n    the DL Data Buffer Expiration Time in the MM context for the UE based\n    on the DL Buffering Duration time and skips the remaining steps of this\n    procedure. The DL Data Buffer Expiration Time is used for UEs using\n    power saving state and indicates that there are buffered data in the\n    Serving GW and that the user plane setup procedure is needed when the\n    UE makes signalling with the network. When the DL Data Buffer\n    Expiration Time has expired, the MME/SGSN considers no DL data to be\n    buffered and no indications of Buffered DL Data Waiting are sent during\n    context transfers at TAU procedures.\n\n     If there is a \"Availability after DDN Failure\" monitoring event\n    configured for the UE in the MME/SGSN, the MME/SGSN does not invoke\n    extended buffering. Instead, the MME/SGSN sets the Notify-on-available-\n    after-DDN-failure flag to remember to send an \"Availability after DDN\n    Failure\" notification when the UE becomes available. If there is a \"UE\n    Reachability\" monitoring event configured for the UE in the MME/SGSN,\n    the MME/SGSN should not need to invoke extended buffering.\n\n  NOTE\u00c2\u00a02:  When \"Availability after DDN failure\" and \"UE reachability\"\n         monitoring events are used for a UE, the application server is\n         assumed to send data when the UE is reachable or about to become\n         reachable, hence no extended buffering is needed. If there are\n         multiple application servers, the event notifications and extended\n         buffering may be needed simultaneously. It is assumed this is\n         handled through additional information based on SLA as described in\n         the next paragraph.\n\n     The MME/SGSN may use additional information based on a SLA with the\n    MTC user for when to invoke extended buffering, e.g. only invoke it for\n    a certain APN, do not invoke it for certain subscribers, invoke\n    extended buffering in conjunction with \"Availability after DDN failure\"\n    and \"UE reachability\" monitoring events, etc.\n\n     A Serving GW that receives a DL Buffering Requested indication in a\n    Downlink Data Notification Ack message stores a new value for the DL\n    Data Buffer Expiration Time based on the DL Buffering Duration time and\n    does not send any additional Downlink Data Notification if subsequent\n    downlink data packets are received in the Serving GW before the buffer\n    time DL Data Buffer Expiration Time has expired for the UE.\n\n     If the Serving GW, while waiting for the user plane to be established,\n    is triggered to send a second Downlink Data Notification for a bearer\n    with higher priority (i.e. ARP priority level) than the first Downlink\n    Data Notification was sent for, the SGW sends a new Downlink Data\n    Notification message indicating the higher priority to the MME. If the\n    Serving GW receives additional downlink data packets for a bearer with\n    same or lower priority than the first Downlink Data Notification was\n    sent for or if the Serving GW has sent the second Downlink Data\n    Notification message indicating the higher priority and receives\n    additional downlink data packets for this UE, the Serving GW buffers\n    these downlink data packets and does not send a new Downlink Data\n    Notification.\n\n     If the Serving GW, while waiting for the user plane to be established,\n    receives a Modify Bearer Request message from MME or SGSN other than\n    the one it sent a Downlink Data Notification message to, the Serving GW\n    re-sends the Downlink Data Notification message only to the new MME or\n    SGSN from which it received the Modify Bearer Request message even if\n    ISR is active.\n\n     If the Tracking Area Update procedure with MME change or the Routing\n    Area Update procedure is in progress when the old MME receives a\n    Downlink Data Notification message, the old MME may reject a Downlink\n    Data Notification message with an indication that the Downlink Data\n    Notification message has been temporarily rejected.\n\n     Similarly, if the Routing Area Update procedure with SGSN change or\n    the Tracking Area Update procedure is in progress when the old SGSN\n    receives a Downlink Data Notification message, the old SGSN may reject\n    a Downlink Data Notification message with an indication that the\n    Downlink Data Notification message has been temporarily rejected.\n\n     Upon reception of a Downlink Data Notification Ack message with an\n    indication that the Downlink Data Notification message has been\n    temporarily rejected and if the Downlink Data Notification is triggered\n    by the arrival of downlink data packets at the Serving GW, the Serving\n    GW may start a locally configured guard timer and buffers all downlink\n    user packets received to the given UE and waits for a Modify Bearer\n    Request message to come. Upon reception of a Modify Bearer Request\n    message, the Serving GW re-sends the Downlink Data Notification message\n    only to the new MME or SGSN from which it received the Modify Bearer\n    Request message even if ISR is active. Otherwise the Serving GW\n    releases buffered downlink user packets at expiry of the guard timer or\n    receiving the Delete Session Request message from MME/SGSN.\n\n     Upon reception of a Downlink Data Notification Ack message with an\n    indication that the Downlink Data Notification message has been\n    temporarily rejected and if the Downlink Data Notification is triggered\n    by the arrival of signalling messages at the Serving GW, the Serving GW\n    may reject the PDN GW initiated EPS bearer(s) request with the same\n    indication that the request has been temporarily rejected. Upon\n    reception of a rejection for an EPS bearer(s) PDN GW initiated\n    procedure with an indication that the request has been temporarily\n    rejected, the PDN GW may start a locally configured guard timer. The\n    PDN GW may re-attempt, up to a pre-configured number of times, when\n    either it detects the UE accesses via a new SGW or at expiry of the\n    guard timer.\n\n  3a.  If the UE is registered in the MME and considered reachable for\n    paging, the MME sends a Paging message (NAS ID for paging, TAI(s), UE\n    identity based DRX index, Paging DRX length, list of CSG IDs for\n    paging, Paging Priority indication, Enhanced Coverage Restricted, CE\n    mode B Restricted) to each eNodeB belonging to the tracking area(s) in\n    which the UE is registered. The step is described in detail in\n    TS\u00c2\u00a036.300\u00c2\u00a0[5] and TS\u00c2\u00a036.413\u00c2\u00a0[36]. Steps 3-4 are omitted if the MME\n    already has a signalling connection over S1-MME towards the UE but the\n    S1-U tunnel has not yet been established.\n\n     If extended idle mode DRX is enabled for the UE, the MME pages the UE\n    just before the occurrence of the UE's next paging occasion, which is\n    determined as described in TS\u00c2\u00a023.682\u00c2\u00a0[74].\n\n  NOTE\u00c2\u00a03:  Steps 3a and 4a are performed also when the UE and the network\n         support User Plane CIoT EPS Optimisation and the previous RRC\n         connection has been suspended.\n\n     Paging priority indication is included only:\n\n    -  if the MME receives a Downlink Data Notification or Create Bearer\n       Request with an ARP priority level associated with MPS or other\n       priority services, as configured by the operator.\n\n    -  One Paging Priority level can be used for multiple ARP priority\n       level values. The mapping of ARP priority level values to Paging\n       Priority level (or levels) is configured by operator policy.\n\n     During a congestion situation the eNodeB may prioritise the paging of\n       UEs according to the Paging Priority indications.\n\n     If the MME, while waiting for a UE response to the Paging Request\n    message sent without Paging Priority indication, receives an Update\n    Bearer Request, Create Bearer Request or Downlink Data Notification,\n    any of which indicates an ARP priority level associated with MPS or\n    other priority services, as configured by the operator, the MME shall\n    send another paging message with the suitable Paging Priority.\n\n     When the MME is configured to support CSG paging optimisation in the\n    CN, the MME should avoid sending Paging messages to those eNodeB(s)\n    with CSG cells for which the UE does not have a CSG subscription. When\n    the MME is configured to support CSG paging optimisation in the HeNB\n    Subsystem, the list of CSG IDs for paging is included in the Paging\n    message. For CSG paging optimisation, the CSG IDs of expired CSG\n    subscriptions and valid CSG subscriptions are both included in the\n    list. If the UE has emergency bearer service the MME shall not perform\n    the CSG paging optimisation.\n\n  NOTE\u00c2\u00a04:  An expired CSG subscription indicates that the UE is not allowed\n         service in the CSG. However, since the removal of the CSG from the\n         UE is pending, it is possible the UE will camp on that CSG and\n         therefore the UE is still paged for the CSG.\n\n  NOTE\u00c2\u00a05:  The eNodeB reports to the MME the CSG ID supported. For More\n         detail of this procedure refer to TS\u00c2\u00a036.413\u00c2\u00a0[36].\n\n     When the MME supports SIPTO at Local Network and LIPA paging for\n    traffic arriving on the PDN connection with L-GW function collocated\n    with the (H)eNB the MME should only page this (H)eNB to avoid sending\n    Paging messages to eNodeB(s) that are not handling this specific PDN\n    connection.\n\n     Paging strategies may be configured in the MME for different\n    combinations of APN, Paging Policy Indication from SGW when available\n    (see clause\u00c2\u00a04.9) and other EPS bearer context information e.g. QCI. APN\n    and any EPS bearer context information are identified by EPS bearer ID\n    received in Downlink Data Notification. Paging strategies may include:\n\n    -  paging retransmission scheme (e.g. how frequently the paging is\n       repeated or with what time interval);\n\n    -  determining whether to send the Paging message to the eNodeBs during\n       certain MME high load conditions;\n\n    -  whether to apply sub-area based paging (e.g. first page in the last\n       known ECGI or TA and retransmission in all registered TAs).\n\n     If extended idle mode DRX was enabled in the UE, the MME may\n    additionally take into account the Paging Time Window length for paging\n    retransmission schemes.\n\n  NOTE\u00c2\u00a06:  The Paging priority in the Paging message is set based on\n         priority level of the ARP IE received in Downlink Data Notification\n         or Create/Update Bearer Request message and is independent from any\n         paging strategy.\n\n     The MME and the E-UTRAN may support further paging optimisations in\n    order to reduce the signalling load and the network resources used to\n    successfully page a UE by one or several following means:\n\n    -  by the MME implementating specific paging strategies (e.g. the S1\n       Paging message is sent to the eNB that served the UE last);\n\n    -  by the MME considering Information On Recommended Cells And ENBs\n       provided by the E-UTRAN at transition to ECM IDLE. The MME takes the\n       eNB related part of this information into account to determine the\n       eNBs to be paged, and provides the information on recommended cells\n       within the S1 Paging message to each of these eNBs;\n\n    -  by the E-UTRAN considering the Paging Attempt Count Information\n       provided by the MME at paging.\n\n     When implementing such optimisations/strategies, the MME shall take\n    into account any PSM active timer and the DRX interval for the UE.\n\n     If the UE Radio Capability for Paging Information is available in the\n    MME, the MME adds the UE Radio Capability for Paging Information in the\n    S1 Paging message to the eNB.\n\n     If the Information On Recommended Cells And ENBs For Paging is\n    available in the MME, the MME shall take that information into account\n    to determine the eNBs for paging and, when paging an eNB, the MME may\n    transparently convey the information on recommended cells to the eNB.\n\n     The MME may include in the S1AP Paging message(s) the paging attempt\n    count information. The paging attempt count information shall be the\n    same for all eNBs selected by the MME for paging.\n\n     If the MME has Information for Enhanced Coverage stored and Enhanced\n    Coverage is not restricted then the MME shall include Information for\n    Enhanced Coverage in the Paging message for all eNBs selected by the\n    MME for paging. For including the Enhanced Coverage Restricted\n    parameter in the paging message, see clause\u00c2\u00a04.3.28.\n\n     For including the CE mode B Restricted parameter in the Paging\n    message, see clause\u00c2\u00a04.3.27a.\n\n  3b.  If the UE is registered in the SGSN, the SGSN sends paging messages\n    to RNC/BSS, which is described in detail in TS\u00c2\u00a023.060\u00c2\u00a0[7].\n\n  4a.  If eNodeBs receive paging messages from the MME, the UE is paged by\n    the eNodeBs. The step is described in detail in TS\u00c2\u00a036.300\u00c2\u00a0[5] and\n    TS\u00c2\u00a036.304\u00c2\u00a0[34].\n\n  4b.  If RNC/BSS nodes receive paging messages from the SGSN the UE is\n    paged by the RNSC/BSS, which is described in detail in TS\u00c2\u00a023.060\u00c2\u00a0[7].\n\n  5. When UE is in the ECM-IDLE state, upon reception of paging indication\n    in E-UTRAN access, the UE initiates the UE triggered Service Request\n    procedure (clause\u00c2\u00a05.3.4.1) or, if the UE is enabled to use User Plane\n    CIoT EPS Optimisation and there is suspended access stratum context\n    stored in the UE, the UE initiates the Connection Resume procedure\n    (clause\u00c2\u00a05.3.5A). If the MME already has a signalling connection over S1-\n    MME towards the UE but the S1-U tunnel has not yet been established,\n    then the messages sequence performed start from the step when MME\n    establishes the bearer(s).\n\n     Upon reception of paging indication in UTRAN or GERAN access, the MS\n    shall respond in respective access as specified TS\u00c2\u00a024.008\u00c2\u00a0[47] and the\n    SGSN shall notify the S-GW.\n\n     The MME and/or SGSN supervises the paging procedure with a timer. If\n    the MME and/or SGSN receives no response from the UE to the Paging\n    Request message, it may repeat the paging according to any applicable\n    paging strategy described in step\u00c2\u00a02.\n\n     If the MME and/or SGSN receives no response from the UE after this\n    paging repetition procedure, it shall use the Downlink Data\n    Notification Reject message to notify the Serving GW about the paging\n    failure, if paging was triggered by a Downlink Data Notification\n    message, unless the MME or SGSN is aware of an ongoing MM procedure\n    that prevents the UE from responding, i.e. the MME or SGSN received a\n    Context Request message indicating that the UE performs TAU or RAU\n    procedure with another MME or SGSN. If paging was triggered by control\n    signalling from the Serving GW and if the MME or SGSN receives no\n    response from the UE after this paging repetition procedure, the MME or\n    SGSN shall reject that control signalling. When a Downlink Data\n    Notification Reject message is received, if ISR is not activated, the\n    Serving GW deletes the buffered packet(s). If ISR is activated and the\n    Serving GW receives Downlink Data Notification Reject message from both\n    SGSN and MME, the Serving GW deletes the buffered packet(s) or rejects\n    the control signalling which triggers the Service Request procedure.\n    The Serving GW may invoke the procedure PDN GW Pause of Charging\n    (clause\u00c2\u00a05.3.6A) if UE is in ECM IDLE and the PDN GW has enabled \"PDN\n    charging pause\" feature.\n\n  NOTE\u00c2\u00a07:  The Serving GW may initiate the procedure PDN GW Pause of\n         Charging at any time before step\u00c2\u00a05 if the UE is in ECM IDLE and the\n         PDN GW has indicated that the feature is enabled for this PDN. See\n         clause\u00c2\u00a05.3.6A.\n\n  6a.  If ISR is activated and paging response is received in E-UTRAN\n    access the Serving GW sends a \"Stop Paging\" message to the SGSN.\n\n  6b.  If ISR is activated and paging response is received in UTRAN or\n    GERAN access the Serving GW sends a \"Stop Paging\" message to the MME.\n\nThe Serving GW transmits downlink data towards the UE via the RAT which\nperformed the Service Request procedure.\n\nFor a LIPA PDN connection, after the UE enters connected mode, the packets\nbuffered in the L-GW are forwarded to the HeNB on the direct path. If the\nUE enters connected mode at a different cell than the one where the L-GW is\ncolocated, the MME shall deactivate the LIPA PDN connection as defined in\nclause\u00c2\u00a05.3.4.1 step\u00c2\u00a02.\n\nIf the network triggered service request fails due to no response from the\nUE, then MME and/or SGSN may based on operator policy initiate the\nDedicated Bearer Deactivation procedure for preserved GBR bearers. For\ndetails, see clause\u00c2\u00a05.4.4.2 for MME and TS\u00c2\u00a023.060\u00c2\u00a0[7] for SGSN.\n\n\n"}, {"key": "Connection Suspend procedure", "numbering": "5.3.4A", "title_level": 2, "desc": "5.3.4A Connection Suspend procedure\n\nThis procedure is used by the network to suspend the connection if the UE\nand the network support User Plane CIoT EPS Optimisation (see\nTS\u00c2\u00a036.300\u00c2\u00a0[5]).\n\n                                    [pic]\n\n       Figure 5.3.4A-1: eNodeB initiated Connection Suspend procedure\n\n  1. The eNodeB initiates the Connection Suspend procedure to the MME, see\n    TS\u00c2\u00a036.413\u00c2\u00a0[36]. The eNodeB indicates to the MME that the UE's RRC\n    connection is to be suspended upon which MME enters ECM-IDLE. Data\n    related to the S1AP association, UE Context and bearer context,\n    necessary to resume the connection is kept in the eNB, UE and the MME.\n\n     The eNodeB may include the Information On Recommended Cells And eNBs\n    For Paging in the S1 UE Context Suspend Request message. If available,\n    the MME shall store this information to be used when paging the UE.\n\n     The eNB includes Information for Enhanced Coverage, if available, in\n    the S1 UE Context Suspend Request message.\n\n     If the PLMN has configured secondary RAT reporting and the eNodeB has\n    Secondary RAT usage data to report, the Secondary RAT usage data is\n    included.\n\n     If Service Gap Control is being applied to the UE (see\n    clause\u00c2\u00a04.3.17.9) and the Service Gap timer is not already running, the\n    Service Gap timer shall be started in the MME when entering ECM-IDLE,\n    unless the connection was initiated after a paging of an MT event, or\n    after a TAU procedure without any active flag or signalling active flag\n    set.\n\n  1a-d.  If the eNodeB provided Secondary RAT usage data in step\u00c2\u00a01 and if\n    PGW secondary RAT usage data reporting is active, the MME initiates the\n    Secondary RAT usage data reporting procedure in clause\u00c2\u00a05.7A.3 as\n    illustrated in figure 5.7A.3-2.\n\n  2. The MME sends a Release Access Bearers Request (Secondary RAT usage\n    data) message to the Serving GW that requests the release of all S1-U\n    bearers for the UE. If Secondary RAT usage data was received in step\u00c2\u00a01,\n    Secondary RAT usage data is included in this message. The message\n    indicates that the SGW is the target for the reporting.\n\n  3. The Serving GW releases all eNodeB related information (address and\n    downlink TEIDs) for the UE and responds with a Release Access Bearers\n    Response message to the MME. Other elements of the UE's Serving GW\n    context are not affected. If downlink packets arrive for the UE, the\n    Serving GW starts buffering downlink packets received for the UE and\n    initiating the \"Network Triggered Service Request\" procedure, described\n    in clause\u00c2\u00a05.3.4.3.\n\n  NOTE:  Based on operator policy any received Indication of \"Abnormal\n         Release of Radio Link\" may be used by Serving GW in subsequent\n         decisions to trigger PDN charging pause if the feature has been\n         enabled on that PDN.\n\n     The Serving GW informs the MME in the Release Access Bearer Response\n    message about release of S1-U bearers.\n\n  4. The MME sends an S1AP: UE Context Suspend Response message to the eNB\n    to successfully terminate the Connection Suspend procedure initiated by\n    the eNB, see TS\u00c2\u00a036.413\u00c2\u00a0[36].\n\n  5. The eNodeB sends RRC message to suspend the RRC Connection towards the\n    UE, see TS\u00c2\u00a036.300\u00c2\u00a0[5]).\n\n     If Service Gap Control is being applied for the UE (see\n    clause\u00c2\u00a04.3.17.9) and the Service Gap timer is not already running, the\n    Service Gap timer shall be started in the UE when entering ECM-IDLE,\n    unless the connection was initiated as a response to paging of an MT\n    event, or after a TAU procedure without any active flag or signalling\n    active flag set.\n\n\n"}, {"key": "Data Transport in Control Plane CIoT EPS Optimisation", "numbering": "5.3.4B", "title_level": 2, "desc": "5.3.4B Data Transport in Control Plane CIoT EPS Optimisation\n\n\n"}, {"key": "General", "numbering": "5.3.4B.1", "title_level": 3, "desc": "5.3.4B.1 General\n\nIf the UE and MME use the Control Plane CIoT EPS Optimisation, they can\ntransfer data in NAS PDUs including the EPS Bearer Identity of the PDN\nconnection they relate to, for which there is no S1-U bearers established\n(i.e. when an S1-U bearer is established the UE shall use S1-U to transfer\ndata PDUs). All PDN types are supported. If the UE and the MME support\nControl Plane CIoT EPS Optimisation, then for SMS transfer and EPC Mobile\nOriginated Location Request (EPC-MO-LR) or EPC Mobile Terminated Location\nRequest (EPC-MT-LR) the Service Request procedures defined in clause\u00c2\u00a05.3.4\nare not used for MO and MT SMS or for EPC-MO-LR and EPC-MT-LR, but instead\nUE and MME shall be using the Data Transport in Control Plane CIoT EPS\nOptimisation.\n\nThis is accomplished by using the NAS transport capabilities of RRC and S1-\nAP protocols and the data transport of GTP-u tunnels between MME and S-GW\nand between S-GW and P-GW, or if a Non-IP connection is provided by via the\nMME with the SCEF, then data transfer occurs as indicated in\nTS\u00c2\u00a023.682\u00c2\u00a0[74].\n\nFor IP data, the UE and MME may perform header compression based on ROHC\nframework IETF\u00c2\u00a0RFC\u00c2\u00a05795\u00c2\u00a0[77]. For uplink IP data, UE implements ROHC\ncompressor, and MME implements the decompressor. For downlink IP data, MME\nimplements the ROHC compressor, and UE implements the decompressor. The\nuplink and downlink ROHC channels are bound by UE and MME to support\nfeedback. The configurations for the header compression are established\nduring the PDN connection establishment procedure.\n\nTo minimise potential conflicts between NAS signalling PDUs and NAS Data\nPDUs, the MME should complete any security related procedures (e.g.\nAuthetication, Security Mode Command, GUTI reallocation) before alerting\nthe HSS, MSC or SGW of the UE's entry into ECM-CONNECTED state, and before\ncommencing downlink transfer of NAS Data PDUs. The priority handling\nbetween the EMM/ESM NAS signalling PDUs and NAS Data PDUs is specified in\nTS\u00c2\u00a024.301\u00c2\u00a0[46].\n\n\n"}, {"key": "Mobile Originated Data Transport in Control Plane CIoT EPS", "numbering": "5.3.4B.2", "title_level": 3, "desc": "5.3.4B.2 Mobile Originated Data Transport in Control Plane CIoT EPS\n           Optimisation with P-GW connectivity\n\n                                    [pic]\n\n               Figure 5.3.4B.2-1: MO Data transport in NAS PDU\n\n  0. The UE is ECM-IDLE.\n\n  1. The UE establishes a RRC connection or sends the RRCEarlyDataRequest\n    message as defined in TS\u00c2\u00a036.300\u00c2\u00a0[5] and sends as part of it an\n    integrity protected NAS PDU. The NAS PDU carries the EPS Bearer ID and\n    encrypted Uplink Data. For IP PDN type PDN connections configured to\n    support Header Compression, the UE shall apply header compression\n    before encapsulating data into the NAS message. The UE may also\n    indicate in a NAS Release Assistance Information in the NAS PDU whether\n    no further Uplink or Downlink Data transmissions are expected, or only\n    a single Downlink data transmission (e.g. Acknowledgement or response\n    to Uplink data) subsequent to this Uplink Data transmission is\n    expected.\n\n  1b.  In the NB-IoT case, the eNB, based on configuration, may retrieve\n    the EPS negotiated QoS profile from the MME, if not previously\n    retrieved. The MME Code within the S-TMSI in the RRCConnectionRequest\n    message is used to identify the MME. In the case of network sharing,\n    the MME Codes shall be unique within the area of overlapping MME pools\n    of the participating operators. The eNB may apply prioritisation\n    between requests from different UEs before triggering step\u00c2\u00a02 and\n    throughout the RRC connection. The eNB may retrieve additional\n    parameters (e.g., UE Radio Capabilities - see TS\u00c2\u00a036.413\u00c2\u00a0[36]).\n\n  2. The NAS PDU sent in step\u00c2\u00a01 is relayed to the MME by the eNodeB using a\n    S1-AP Initial UE message. If the RRCEarlyDataRequest message was\n    received in step\u00c2\u00a01, the eNB includes the \"EDT Session\" indication in\n    the S1-AP Initial UE message.\n\n     To assist Location Services, the eNB indicates the UE's Coverage Level\n    to the MME.\n\n     If the NAS Release Assistance Information is received from the UE it\n    overrides the Traffic Profile (see TS\u00c2\u00a023.682\u00c2\u00a0[74]) and the MME does not\n    send the Traffic Profile to the eNB.\n\n  3. If there is a Service Gap timer running in the MME MM Context for the\n    UE and the MME is not waiting for a MT paging response from the UE, the\n    MME rejects the request by discarding the NAS data PDU and sending a\n    Service Reject message to the UE with an appropriate cause. The MME may\n    also provide UE with a Mobility Management Back-off timer set to the\n    remaining value of Service Gap timer, followed by executing step\u00c2\u00a015.\n\n     The MME checks the integrity of the incoming NAS PDU and decrypts the\n    data it contains. When the ROHC is configured to be used, the MME shall\n    decompress the IP header if header compression applies to the PDN\n    connection.\n\n     The MME performs (and the UE responds to) any EMM or ESM procedures if\n    necessary, e.g. the security related procedures. Steps 4 to 9 can\n    continue in parallel to this, however, steps 10 and 11 shall await\n    completion of all the EMM and ESM procedures.\n\n  4a.  If the S11-U connection is not established, the MME sends a Modify\n    Bearer Request message (MME address, MME TEID DL, Delay Downlink Packet\n    Notification Request, RAT Type, LTE-M RAT type reporting to PGW flag,\n    MO Exception data counter) for each PDN connection to the Serving GW.\n    The Serving GW is now able to transmit downlink data towards the UE.\n    The usage of the Delay Downlink Packet Notification Request Information\n    Element is specified in clause\u00c2\u00a05.3.4.2 with reference to the UE\n    initiated service request procedure, but it equally applies in this\n    case. The MME shall indicate S11-U tunnelling of NAS user data and send\n    its own S11-U IP address and MME DL TEID for DL data forwarding by the\n    SGW. Also, regardless of whether the S11-U was already established:\n\n    -  If the PDN GW requested UE's location and/or User CSG information\n       and the UE's location and/or User CSG information has changed, the\n       MME shall send the Modify Bearer Request message and also includes\n       the User Location Information IE and/or User CSG Information IE in\n       this message.\n\n    -  If the Serving Network IE has changed compared to the last reported\n       Serving Network IE then the MME shall send the Modify Bearer Request\n       message and also includes the Serving Network IE in this message.\n\n    -  If the UE Time Zone has changed compared to the last reported UE\n       Time Zone then the MME shall send the Modify Bearer Request message\n       and include the UE Time Zone IE in this message.\n\n     If the RAT type currently used is NB-IOT this shall be reported as\n    different from other E-UTRA flavours.\n\n     If the UE is using the LTE-M RAT type and the PDN GW expects the LTE-M\n    RAT type reporting as specified in clause\u00c2\u00a05.11.5, the MME also includes\n    the LTE-M RAT type reporting to PGW flag to indicate to the Serving GW\n    to forward the LTE-M RAT type to the PDN GW.\n\n     The MME only includes MO Exception data counter if the RRC\n    establishment cause is set to \"MO exception data\" and the UE is\n    accessing via the NB-IoT RAT. The Serving GW indicates each use of this\n    RRC establishment cause by the related counter on its CDR. The MME\n    maintains the MO Exception Data Counter for Serving PLMN Rate Control\n    purposes (see clause\u00c2\u00a04.7.7.2). The MME may immediately send the MO\n    Exception Data Counter to the Serving GW. Alternatively, in order to\n    reduce signalling, the MME may send the MO Exception Data Counter to\n    the Serving GW as indicated in TS\u00c2\u00a029.274\u00c2\u00a0[43].\n\n  4b If the S11-U connection is established and the UE is accessing via the\n    NB-IoT RAT with the RRC establishment cause set to \"MO exception data\",\n    the MME should notify the Serving Gateway. The MME maintains the MO\n    Exception Data Counter for Serving PLMN Rate Control purposes (see\n    clause\u00c2\u00a04.7.7.2). The MME may immediately send the MO Exception Data\n    Counter to the Serving GW. Alternatively, in order to reduce\n    signalling, the MME may send the MO Exception Data Counter to the\n    Serving GW as indicated in TS\u00c2\u00a029.274\u00c2\u00a0[43].\n\n  5. If the RAT Type has changed compared to the last reported RAT Type or\n    if the UE's Location and/or Info IEs and/or UE Time Zone and Serving\n    Network id are present in step\u00c2\u00a04, the Serving GW shall send the Modify\n    Bearer Request message (RAT Type, MO Exception data counter) to the PDN\n    GW. User Location Information IE and/or User CSG Information IE and/or\n    Serving Network IE and/or UE Time Zone are also included if they are\n    present in step\u00c2\u00a04.\n\n     If LTE-M RAT type and the LTE-M RAT type reporting to PGW flag were\n    received at step\u00c2\u00a04a, the Serving GW shall include the LTE-M RAT type in\n    the Modify Bearer Request message to the PGW. Otherwise the Serving GW\n    includes RAT type WB-E-UTRAN.\n\n     If the Modify Bearer Request message is not sent because of above\n    reasons and the PDN GW charging is paused, then the SGWS-GW shall send\n    a Modify Bearer Request message with PDN Charging Pause Stop Indication\n    to inform the PDN GW that the charging is no longer paused. Other IEs\n    are not included in this message.\n\n     If the Modify Bearer Request message is not sent because of above\n    reasons but the MME indicated MO Exception data counter, then the\n    Serving Gateway should notify the PDN GW that this RRC establishment\n    cause has been used by the indication of the MO Exception Data Counter\n    (see TS\u00c2\u00a029.274\u00c2\u00a0[43]). The Serving GW indicates each use of this RRC\n    establishment cause by the related counter on its CDR.\n\n  6. The PDN GW sends the Modify Bearer Response to the Serving GW.\n\n     The PDN GW indicates each use of the RRC establishment cause \"MO\n    Exception Data\" by the related counter on its CDR.\n\n  7. If a Modify Bearer Request message was sent at step\u00c2\u00a04 the Serving GW\n    shall return a Modify Bearer Response (Serving GW address and TEID for\n    uplink traffic) to the MME as a response to a Modify Bearer Request\n    message. The Serving GW address for S11-U User Plane and Serving GW\n    TEID are used by the MME to forward UL data to the SGW.\n\n  8. The MME sends Uplink data to the P-GW via the S-GW.\n\n  9. If no Downlink Data are expected based on the NAS Release Assistance\n    Information from the UE in step\u00c2\u00a01, this means that all application\n    layer data exchanges have completed with the UL data transfer, and if\n    the MME is not aware of pending MT traffic and S1-U bearers are not\n    established, step\u00c2\u00a010 is skipped and step\u00c2\u00a011 applies.\n\n     Otherwise, Downlink data may arrive at the P-GW and the P-GW sends\n    them to the MME via the S-GW. If no data is received steps10-12 are\n    skipped and the eNB may trigger step\u00c2\u00a014 after step\u00c2\u00a013 detects no\n    activity. While the RRC connection is active, the UE may still send\n    Uplink data and may receive Downlink data in NAS PDUs that are carried\n    in a S1AP Uplink or (respectively) Downlink messages (not shown in the\n    figure). At any time the UE has no user plane bearers established it\n    may provide NAS Release Assistance Information with the Uplink data. In\n    this case, to assist Location Services, the eNB may indicate, if\n    needed, the UE's Coverage Level to the MME.\n\n  10.  If Downlink data are received in step\u00c2\u00a09, the MME encrypts and\n    integrity protects the Downlink data.\n\n  11.  If step\u00c2\u00a010 is executed then Downlink data are encapsulated in a NAS\n    PDU and sent to the eNB in a S1-AP Downlink NAS Message. If the\n    configuration in the MME indicates that the eNodeB supports\n    acknowledgements of downlink NAS data PDUs and if acknowledgements of\n    downlink NAS data PDUs are enabled in the subscription information for\n    the UE, the MME indicates in the S1-AP Downlink NAS message that\n    acknowledgment is requested from the eNodeB. For IP PDN type PDN\n    connections configured to support Header Compression, the MME shall\n    apply header compression before encapsulating data into the NAS\n    message. If step\u00c2\u00a010 is not executed, or NAS Service Accept message is\n    not to be sent, the MME sends Connection Establishment Indication\n    message to the eNB to complete the establishment of the UE-associated\n    logical S1-connection. The UE Radio Capability may be provided from the\n    MME to the eNB in the DL NAS Transport message or Connection\n    Establishment Indication message, and the eNB shall store the received\n    UE Radio Capability information as specified in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n     If the NAS Release Assistance Information was received with Uplink\n    data and it indicated that Downlink data was expected, it means that\n    the next downlink packet following the sending of the NAS Release\n    Assistance Information is the last packet of the application layer data\n    exchange, then for this case, unless the MME is aware of additional\n    pending MT traffic and unless S1-U bearers are established, the MME\n    sends a S1 UE Context Release Command immediately after the S1-AP\n    message including the Downlink data encapsulated in NAS PDU as an\n    indication that the eNodeB shall release the RRC connection promptly\n    after successfully sending data to the UE. Alternatively, if \"EDT\n    Session\" indication was received in step\u00c2\u00a02, the MME may include End\n    Indication for no further data in the S1-AP message including the\n    Downlink data encapsulated in NAS PDU. If the MME includes the End\n    Indication indicating no further data and if the eNB does not proceed\n    with RRC connection establishment, then the eNB skips step\u00c2\u00a012a and\n    initiates step\u00c2\u00a012b.\n\n     If the NAS Release Assistance Information was received indicating no\n    Downlink Data expected, it means that all application layer data\n    exchanges have completed with the UL data transfer, then for this case,\n    unless the MME is aware of additional pending MT traffic and unless S1-\n    U bearers are established:\n\n    -  the MME sends S1AP UE Context Release Command either:\n\n       -  immediately after the S1AP DL NAS TRANSPORT (NAS Service Accept),\n         in which case steps 12b and 14 are skipped, or\n\n       -  immediately after S1AP CONNECTION ESTABLISHMENT INDICATION, in\n         which case steps 12a, 12b, 13, and 14 are skipped.\n\n    -  Alternatively, if the MME received \"EDT Session\" indication from the\n       eNB in step\u00c2\u00a02, the MME should include End Indication with no further\n       data in S1AP DL NAS TRANSPORT (NAS Service Accept) or S1AP CONNECTION\n       ESTABLISHMENT INDICATION. If the eNB does not proceed with RRC\n       connection establishment, the eNB skips step\u00c2\u00a012a and initiates\n       stop\u00c2\u00a012b.\n\n     If the UE is accessing via an NB-IoT cell, or if it is accessing via\n    an WB-E-UTRAN cell and is capable of CE mode B, to determine the NAS\n    PDU retransmission strategy the MME should take into account the\n    transmission delay of the NAS PDU and the CE mode B Restricted\n    parameter stored in the MME's MM context and, if applicable, the CE\n    mode, i.e. set the NAS timers long enough according to the worst\n    transmission delay (see TS\u00c2\u00a024.301\u00c2\u00a0[46]).\n\n  12a. The eNB sends a RRC Downlink data message including the Downlink\n    data encapsulated in NAS PDU. If in step\u00c2\u00a011 the S1-AP message with the\n    NAS DATA PDU was followed by an S1 UE Context Release Command, step\u00c2\u00a015\n    is completed promptly after the Downlink Data transmission of the NAS\n    PDU to the UE and the acknowledgement to MME in step\u00c2\u00a013 have been\n    completed at the eNB, and the eNB does not need to enter step\u00c2\u00a014. If\n    header compression was applied to the PDN, the UE would perform header\n    decompression to rebuild the IP header.\n\n  12b. If End Indication with no further data is received in S1AP message\n    from the MME, the eNB may send the RRCEarlyDataComplete message with\n    any NAS payload received from step\u00c2\u00a011 (either NAS data PDU or NAS\n    service accept) as defined in TS\u00c2\u00a036.300\u00c2\u00a0[5]. Step\u00c2\u00a014 is skipped in this\n    case.\n\n  13.  The eNodeB sends a NAS Delivery indication to the MME if requested.\n    If the eNodeB reports an unsuccessful delivery with an S1-AP NAS Non\n    Delivery Indication, the MME should wait for some time until the UE has\n    potentially changed cell and re-established contact with the MME, by\n    which MME should resend the Downlink S1-AP message to the eNodeB,\n    otherwise the MME reports an unsuccessful delivery to the SCEF in case\n    of T6a procedure (see TS\u00c2\u00a023.682\u00c2\u00a0[74], clause\u00c2\u00a05.13.3). If the eNodeB\n    reports a successful delivery with an S1-AP NAS Delivery Indication and\n    if the Downlink data was received over the T6a interface, the MME\n    should respond to the SCEF (see TS\u00c2\u00a023.682\u00c2\u00a0[74], clause\u00c2\u00a05.13.3). If the\n    eNodeB does not support S1-AP NAS delivery indications, the MME\n    indicates a cause code 'Success Unacknowledged Delivery' to the SCEF\n    otherwise 'Success Acknowledged Delivery', for the SCEF to know if\n    reliable delivery was possible or not.\n\n  14.  If no NAS PDU activity exists for a while, the eNB starts an S1\n    release in step\u00c2\u00a015.\n\n  15.  An S1 release procedure according to clause\u00c2\u00a05.3.5 triggered by the\n    eNodeB or MME. Alternatively, if the MME in step\u00c2\u00a011 sent S1 UE Context\n    Release Command then the procedure starts with step\u00c2\u00a05 in clause\u00c2\u00a05.3.5,\n    or Connection Suspend Procedure defined in clause\u00c2\u00a05.3.4A. The UE and\n    the MME shall store the ROHC configuration and context for the\n    uplink/downlink data transmission when entering ECM_CONNECTED state\n    next time.\n\n\n"}, {"key": "Mobile Terminated Data Transport in Control Plane CIoT EPS", "numbering": "5.3.4B.3", "title_level": 3, "desc": ""}, {"key": "Establishment of S-U bearer during Data Transport in Control", "numbering": "5.3.4B.4", "title_level": 3, "desc": "5.3.4B.3 Mobile Terminated Data Transport in Control Plane CIoT EPS\n           Optimisation with P-GW connectivity\n\n                                    [pic]\n\n              Figure 5.3.4B.3-1: MT Data transport in NAS PDUs\n\n  0. The UE is EPS attached and in ECM-Idle mode.\n\n  1. When the S-GW receives a downlink data packet/control signalling for a\n    UE, if the S- GW context data indicates no downlink user plane TEID\n    towards the MME), it buffers the downlink data packet and identifies\n    which MME is serving that UE.\n\n     If that MME has requested the Serving GW to throttle downlink low\n    priority traffic and if the downlink data packet is received on a low\n    priority bearer to be throttled (see clause\u00c2\u00a04.3.7.4.1a), the S-GW drops\n    the downlink data. The steps below are not executed.\n\n     If that MME has requested the S-GW to delay sending the Downlink Data\n    Notification (see clause\u00c2\u00a05.3.4.2 on \"Handling of abnormal conditions in\n    UE triggered Service Request\"), the Serving GW buffers the downlink\n    data and waits until the timer expires before continuing with step\u00c2\u00a02.\n    If the DL-TEID and MME address for that UE is received before the\n    expiry of the timer, the timer shall be cancelled and the Mobile\n    Terminated Data transport procedure is progressed from step\u00c2\u00a011 as\n    Downlink data are sent to the UE.\n\n     If the Serving GW receives additional downlink data packets/control\n    signalling for this UE before the expiry of the timer, the Serving GW\n    does not restart this timer.\n\n  2. If the Serving GW is buffering data in step\u00c2\u00a01, the Serving GW sends a\n    Downlink Data Notification message (ARP, EPS Bearer ID) to the MME for\n    which it has control plane connectivity for the given UE. The ARP and\n    EPS Bearer ID are always set in Downlink Data Notification. The MME\n    responds to the S-GW with a Downlink Data Notification Ack message.\n\n     An MME detects that the UE is in a power saving state (e.g. Power\n    Saving Mode) and cannot be reached by paging at the time of receiving\n    Downlink data notification, shall invoke extended buffering depending\n    on operator configuration, except for cases described in next\n    paragraphs. The MME derives the expected time before radio bearers can\n    be established to the UE. The MME then indicates Downlink Buffering\n    Requested to the Serving GW in the Downlink Data Notification Ack\n    message and includes a Downlink Buffering Duration time and optionally\n    a Downlink Buffering Suggested Packet Count. The MME stores a new value\n    for the Downlink Data Buffer Expiration Time in the MM context for the\n    UE based on the Downlink Buffering Duration time and skips the\n    remaining steps of this procedure. The Downlink Data Buffer Expiration\n    Time is used for UEs using power saving state and indicates that there\n    are buffered data in the Serving GW and that the user plane setup\n    procedure is needed when the UE makes signalling with the network. When\n    the Downlink Data Buffer Expiration Time has expired, the MME considers\n    no Downlink data to be buffered and no indications of Buffered Downlink\n    Data Waiting are sent during context transfers at TAU procedures.\n\n     If there is an \"Availability after DDN Failure\" monitoring event\n    configured for the UE in the MME, the MME does not invoke extended\n    buffering. Instead, the MME sets the Notify-on-available-after-DDN-\n    failure flag to remember to send an \"Availability after DDN Failure\"\n    notification when the UE becomes available. If there is a \"UE\n    Reachability\" monitoring event configured for the UE in the MME, the\n    MME does not invoke extended buffering.\n\n  NOTE\u00c2\u00a01:  When \"Availability after DDN failure\" and \"UE reachability\"\n         monitoring events are used for a UE, the application server is\n         assumed to send data only when the UE is reachable, hence no\n         extended buffering is needed. If there are multiple application\n         servers, the event notifications and extended buffering may be\n         needed simultaneously. It is assumed this is handled through\n         additional information based on SLA as described in the next\n         paragraph.\n\n     The MME may use additional information based on a SLA with the MTC\n    user for when to invoke extended buffering, e.g. only invoke it for a\n    certain APN, do not invoke it for certain subscribers, invoke extended\n    buffering in conjunction with \"Availability after DDN failure\" and \"UE\n    reachability\" monitoring events, etc.\n\n     A Serving GW that receives a Downlink Buffering Requested indication\n    in a Downlink Data Notification Ack message stores a new value for the\n    Downlink Data Buffer Expiration Time based on the Downlink Buffering\n    Duration time and does not send any additional Downlink Data\n    Notification if subsequent downlink data packets are received in the\n    Serving GW before the buffer time Downlink Data Buffer Expiration Time\n    has expired for the UE.\n\n     If the Serving GW, while waiting for the user plane to be established,\n    is triggered to send a second Downlink Data Notification for a bearer\n    with higher priority (i.e. ARP priority level) than that of the bearer\n    for which the first Downlink Data Notification was sent, the S-GW sends\n    a new Downlink Data Notification message indicating the higher priority\n    to the MME. If the Serving GW receives additional downlink data packets\n    for a bearer with same or lower priority than the first Downlink Data\n    Notification was sent for or if the Serving GW has sent the second\n    Downlink Data Notification message indicating the higher priority and\n    receives additional downlink data packets for this UE, the Serving GW\n    buffers these downlink data packets and does not send a new Downlink\n    Data Notification.\n\n     If the Serving GW, while waiting for the user plane to be established,\n    receives a Modify Bearer Request message from an MME other than the one\n    it sent a Downlink Data Notification message to, the Serving GW re-\n    sends the Downlink Data Notification message but only to the new MME\n    from which it received the Modify Bearer Request message.\n\n     Upon reception of a Downlink Data Notification Ack message with an\n    indication that the Downlink Data Notification message has been\n    temporarily rejected and if the Downlink Data Notification is triggered\n    by the arrival of downlink data packets at the Serving GW, the Serving\n    GW may start a locally configured guard timer and buffers all downlink\n    user packets received to the given UE and waits for a Modify Bearer\n    Request message to come. Upon reception of a Modify Bearer Request\n    message, the Serving GW re-sends the Downlink Data Notification message\n    but only to the new MME from which it received the Modify Bearer\n    Request message. Otherwise the Serving GW releases buffered downlink\n    user packets upon expiry of the guard timer or upon receiving the\n    Delete Session Request message from MME.\n\n     If the S11-U is already established (buffering is in the MME), step\u00c2\u00a02\n    is not executed and step\u00c2\u00a011 is immediately executed. Steps 7,8,9,10 are\n    executed only if conditions are met when the NAS control plane service\n    request is received at step\u00c2\u00a06, as outlined below in the respective\n    clauses.\n\n     An MME detecting that the UE is in a power saving state (e.g. Power\n    Saving Mode) and cannot be reached by paging at the time of receiving\n    Downlink data, shall start extended buffering depending on operator\n    configuration, except for cases described in next paragraphs. The MME\n    derives the expected time before radio bearers can be established to\n    the UE, stores a new value for the Downlink Data Buffer Expiration Time\n    in the MM context for the UE and skips the remaining steps of this\n    procedure. When the Downlink Data Buffer Expiration Time has expired,\n    the MME considers no Downlink data to be buffered.\n\n     Also for the case of buffering in the MME the \"Availability after DDN\n    Failure\" monitoring event can be configured for the UE, even though the\n    actual DDN is not received and the Downlink data is received. The \"UE\n    Reachability\" monitoring event can be configured.also. The extended\n    buffering can also be configured as per what is described above in this\n    step\u00c2\u00a0of the procedure for the case of buffering in S-GW.\n\n  3. If the UE is registered in the MME and considered reachable, the MME\n    sends a Paging message (NAS ID for paging, TAI(s), UE identity based\n    DRX index, Paging DRX length, list of CSG IDs for paging, Paging\n    Priority indication, Enhanced Coverage Restricted, CE mode B\n    Restricted) to each eNodeB belonging to the tracking area(s) in which\n    the UE is registered.\n\n     Paging priority indication is included only:\n\n    -  if the MME receives a Downlink Data Notification (or a Downlink\n       packet for a EPS bearer, for the case of buffering in MME) with an\n       ARP priority level associated with priority services, as configured\n       by the operator.\n\n    -  One Paging Priority level can be used for multiple ARP priority\n       level values. The mapping of ARP priority level values to Paging\n       Priority level (or levels) is configured by operator policy.\n\n     During a congestion situation the eNodeB may prioritise the paging of\n       UEs according to the Paging Priority indications.\n\n     If the MME, while waiting for a UE response to the Paging Request\n       message sent without Paging Priority indication, receives a Downlink\n       Data Notification (or a Downlink packet for a EPS bearer, for the\n       case of buffering in MME) which indicates an ARP priority level\n       associated with priority services, as configured by the operator, the\n       MME shall send another paging message with the suitable Paging\n       Priority.\n\n     When the MME is configured to support CSG paging optimisation in the\n       CN, the MME should avoid sending Paging messages to those eNodeB(s)\n       with CSG cells for which the UE does not have a CSG subscription.\n       When the MME is configured to support CSG paging optimisation in the\n       HeNB Subsystem, the list of CSG IDs for paging is included in the\n       Paging message. For CSG paging optimisation, the CSG IDs of expired\n       CSG subscriptions and valid CSG subscriptions are both included in\n       the list. If the UE has emergency bearer service the MME shall not\n       perform the CSG paging optimisation.\n\n  NOTE\u00c2\u00a02:  An expired CSG subscription indicates that the UE is not allowed\n         service in the CSG. However, since the removal of the CSG from the\n         UE is pending, it is possible the UE will camp on that CSG and\n         therefore the UE is still paged for the CSG.\n\n  NOTE\u00c2\u00a03:  The eNodeB reports to the MME the CSG ID supported. For More\n         detail of this procedure refer to TS\u00c2\u00a036.413\u00c2\u00a0[36].\n\n     Paging strategies may be configured in the MME. Paging strategies may\n       include:\n\n    -  paging retransmission scheme (e.g. how frequently the paging is\n       repeated or with what time interval);\n\n    -  determining whether to send the Paging message to the eNodeBs during\n       certain MME high load conditions;\n\n    -  whether to apply sub-area based paging (e.g. first page in the last\n       known ECGI or TA and retransmission in all registered TAs).\n\n  NOTE\u00c2\u00a04:  The Paging priority in the Paging message is set based on\n         priority level of the ARP IE received in Downlink Data Notification\n         or Create/Update Bearer Request message and is independent from any\n         paging strategy.\n\n     The MME and the E-UTRAN may support further paging optimisations in\n    order to reduce the signalling load and the network resources used to\n    successfully page a UE by one or several following means:\n\n    -  by the MME implementating specific paging strategies (e.g. the S1\n       Paging message is sent to the eNB that served the UE last);\n\n    -  by the MME considering Information On Recommended Cells And eNodeBs\n       provided by the E-UTRAN at transition to ECM IDLE. The MME takes the\n       eNB related part of this information into account to determine the\n       eNBs to be paged, and provides the information on recommended cells\n       within the S1 Paging message to each of these eNBs;\n\n    -  by the E-UTRAN considering the Paging Attempt Count Information\n       provided by the MME at paging.\n\n     When implementing such optimisations/strategies, the MME shall take\n    into account any PSM active timer and the DRX interval for the UE.\n\n     If the UE Radio Capability for Paging Information is available in the\n    MME, the MME adds the UE Radio Capability for Paging Information in the\n    S1 Paging message to the eNB.\n\n     If the Information on Recommended Cells And ENBs For Paging is\n    available in the MME, the MME shall take that information into account\n    to determine the eNBs for paging and, when paging an eNB, the MME may\n    transparently convey the information on recommended cells to the eNB.\n\n     The MME may include in the S1AP Paging message(s) the paging attempt\n    count information. The paging attempt count information shall be the\n    same for all eNBs selected by the MME for paging.\n\n     If the MME has Information for Enhanced Coverage stored and Enhanced\n    Coverage is not restricted then the MME shall include Information for\n    Enhanced Coverage in the Paging message for all eNBs selected by the\n    MME for paging. For including the Enhanced Coverage Restricted\n    parameter in the paging message, see clause\u00c2\u00a04.3.28.\n\n     For including the CE mode B Restricted parameter in the Paging\n    message, see clause\u00c2\u00a04.3.27a.\n\n  4. If eNodeBs receive paging messages from the MME, the UE is paged by\n    the eNodeBs.\n\n  5. As the UE is in the ECM-IDLE state, upon reception of paging\n    indication, the UE sends Control Plane Service Request NAS message (as\n    defined in TS\u00c2\u00a024.301\u00c2\u00a0[46]) over RRC Connection request and S1-AP\n    initial message. The Control Plane Service Request NAS message, when\n    Control Plane CIoT EPS Optimisation applies, does not trigger Data\n    radio bearer establishment by the MME and the MME can immediately send\n    Downlink Data it receives using a NAS PDU to the eNodeB. The MME\n    supervises the paging procedure with a timer. If the MME receives no\n    response from the UE to the Paging Request message, it may repeat the\n    paging according to any applicable paging strategy described in step\u00c2\u00a03.\n\n  5b.  In the NB-IoT case, the eNB, based on configuration, may retrieve\n    the EPS negotiated QoS profile from the MME, if not previously\n    retrieved. The MME Code within the S-TMSI in the RRCConnectionRequest\n    message is used to identify the MME. In the case of network sharing,\n    the MME Codes shall be unique within the area of overlapping MME pools\n    of the participating operators. The eNB may apply prioritisation\n    between requests from different UEs before triggering step\u00c2\u00a06 and\n    throughout the RRC connection. The eNB may retrieve additional\n    parameters (e.g., UE Radio Capabilities - see TS\u00c2\u00a036.413\u00c2\u00a0[36]).\n\n  6. If the MME receives no response from the UE after this paging\n    repetition procedure, it shall use the Downlink Data Notification\n    Reject message to notify the Serving GW about the paging failure (or,\n    equivalently, if the buffering is in the MME, the MME simply discards\n    data for the UE locally), unless the MME is aware of an ongoing MM\n    procedure that prevents the UE from responding, i.e. the MME received a\n    Context Request message indicating that the UE performs TAU with\n    another MME. When a Downlink Data Notification Reject message is\n    received, the Serving GW deletes the buffered packet(s). The Serving GW\n    may invoke the procedure PDN GW Pause of Charging (clause\u00c2\u00a05.3.6A) if UE\n    is in ECM IDLE and the PDN GW has enabled \"PDN charging pause\" feature.\n    If buffering is in the MME, Pause Charging is triggered by the MME via\n    a Release Access Bearer Request to the S-GW(not shown in Figure\n    5.3.4B.3-1) including a \"Abnormal Release of Radio Link\" cause , which\n    releases the S11-U.\n\n  NOTE\u00c2\u00a05:  The Serving GW (or MME, in the case of buffering in the MME) may\n         initiate the procedure P-GW Pause of Charging at any time before\n         step\u00c2\u00a05 if the UE is in ECM IDLE and the P-GW has indicated that the\n         feature is enabled for this PDN. See clause\u00c2\u00a05.3.6A.0.\n\n     To assist Location Services, the eNB indicates the UE's Coverage Level\n    to the MME.\n\n     The MME performs (and the UE responds to) any EMM or ESM procedures if\n    necessary, e.g. the security related procedures. Steps 7 to 11 can\n    continue in parallel to this, however, steps 12 and 13 shall await\n    completion of all the EMM and ESM procedures.\n\n  7. If the S11-U is not established, the MME sends a Modify Bearer Request\n    message (MME address, MME TEID DL, Delay Downlink Packet Notification\n    Request, RAT Type, LTE-M RAT type reporting to PGW flag) for each PDN\n    connection to the Serving GW. The Serving GW is now able to transmit\n    downlink data towards the UE. The usage of the Delay Downlink Packet\n    Notification Request Information Element is specified in clause\u00c2\u00a05.3.4.2\n    with reference to the UE initiated service request procedure, but it\n    equally applies in this case. The MME shall indicate S11-U tunnelling\n    of NAS user data and send its own S11-U IP address and MME DL TEID for\n    DL data forwarding by the SGW. Also, regardless of whether the S11-U\n    was already established:\n\n    -  If the P-GW requested UE's location and/or User CSG information and\n       the UE's location and/or User CSG information has changed, the MME\n       shall send the Modify Bearer Request message and also includes the\n       User Location Information IE and/or User CSG Information IE in this\n       message.\n\n    -  If the Serving Network IE has changed compared to the last reported\n       Serving Network IE then the MME shall send the Modify Bearer Request\n       message and also includes the Serving Network IE in this message.\n\n    -  If the UE Time Zone has changed compared to the last reported UE\n       Time Zone then the MME shall send the Modify Bearer Request message\n       and include the UE Time Zone IE in this message.\n\n     If the RAT type currently used is NB-IOT this shall be reported as\n    different from other -E-UTRA flavours.\n\n     If the UE is using the LTE-M RAT type and the PDN GW expects the LTE-M\n    RAT type reporting as specified in clause\u00c2\u00a05.11.5, the MME also includes\n    the LTE-M RAT type reporting to PGW flag to indicate to the Serving GW\n    to forward the LTE-M RAT type to the PDN GW.\n\n  8. If the RAT Type has changed compared to the last reported RAT Type or\n    if the UE's Location and/or Info IEs and/or UE Time Zone and Serving\n    Network id are present in step\u00c2\u00a07, the Serving GW shall send the Modify\n    Bearer Request message (RAT Type) to the P-GW. User Location\n    Information IE and/or User CSG Information IE and/or Serving Network IE\n    and/or UE Time Zone are also included if they are present in step\u00c2\u00a07.\n\n     If LTE-M RAT type and the LTE-M RAT type reporting to PGW flag were\n    received at step\u00c2\u00a07, the Serving GW shall include the LTE-M RAT type in\n    the Modify Bearer Request message to the PGW. Otherwise the Serving GW\n    includes RAT type WB-E-UTRAN.\n\n     If the Modify Bearer Request message is not sent because of above\n    reasons and the PDN GW charging is paused, then the S-GW shall send a\n    Modify Bearer Request message with PDN Charging Pause Stop Indication\n    to inform the PDN GW that the charging is no longer paused. Other IEs\n    are not included in this message.\n\n  9. The PDN GW sends the Modify Bearer Response to the Serving GW.\n\n  10.  If a Modify Bearer Request message was sent at step\u00c2\u00a07, the Serving\n    GW shall return a Modify Bearer Response (Serving GW address and TEID\n    for uplink traffic) to the MME as a response to a Modify Bearer Request\n    message. The Serving GW address for S11-U User Plane and Serving GW\n    TEID are used by the MME to forward UL data to the SGW.\n\n  11.  Buffered (if S11-U was not established) Downlink data is sent by the\n    S-GW to the MME.\n\n  12-13. The MME encrypts and integrity protects Downlink data and sends it\n    to the eNodeB using a NAS PDU carried by a Downlink S1-AP message. If\n    the configuration in the MME indicates that the eNodeB supports\n    acknowledgements of downlink NAS data PDUs and if acknowledgements of\n    downlink NAS data PDUs are enabled in the subscription information for\n    the UE, the MME indicates in the Downlink S1-AP message that\n    acknowledgment is requested from the eNodeB. For IP PDN type PDN\n    connections configured to support Header Compression, the MME shall\n    apply header compression before encapsulating data into the NAS\n    message. Alternatively and if the MME decides that S1-U bearers need to\n    be established in case the UE and MME accept User Plane EPS\n    Optimisation or S1-U data transfer, steps 4-12 from clause\u00c2\u00a05.3.4.1 are\n    followed.\n\n     If the UE is accessing via an NB-IoT cell, or if it is accessing via\n    an WB-E-UTRAN cell and is capable of CE mode B, to determine the NAS\n    PDU retransmission strategy the MME should take into account the\n    transmission delay of the NAS PDU and the CE mode B Restricted\n    parameter stored in the MME's MM context and, if applicable, the CE\n    mode, i.e. set the NAS timers long enough according to the worst\n    transmission delay (see TS\u00c2\u00a024.301\u00c2\u00a0[46]).\n\n  14.  The NAS PDU with data is delivered to the UE via a Downlink RRC\n    message. This is taken by the UE as implicit acknowledgment of the\n    Service Request message sent in step\u00c2\u00a05. If header compression was\n    applied, to the PDN, the UE shall perform header decompression to\n    rebuild the IP header.\n\n  15.  The eNodeB sends a NAS Delivery indication to the MME if requested.\n    If the eNodeB reports an unsuccessful delivery with an S1-AP NAS Non\n    Delivery Indication, the MME should wait for some time until the UE has\n    potentially changed cell and re-established contact with the MME, by\n    which MME should resend the Downlink S1-AP message to the eNodeB,\n    otherwise the MME reports an unsuccessful delivery to the SCEF in case\n    of T6a procedure (see TS\u00c2\u00a023.682\u00c2\u00a0[74], clause\u00c2\u00a05.13.3). If the eNodeB\n    reports a successful delivery with an S1-AP NAS Delivery Indication and\n    if the Downlink data was received over the T6a interface, the MME\n    should respond to the SCEF (see TS\u00c2\u00a023.682\u00c2\u00a0[74], clause\u00c2\u00a05.13.3). If the\n    eNodeB does not support S1-AP NAS delivery indications, the MME\n    indicates a cause code 'Success Unacknowledged Delivery' to the SCEF\n    otherwise 'Success Acknowledged Delivery', for the SCEF to know if\n    reliable delivery was possible or not.\n\n  16.  While the RRC connection is still up, further Uplink and Downlink\n    data can be transferred using NAS PDUs. In step\u00c2\u00a017 an Uplink data\n    transfer is shown using an Uplink RRC message encapsulating a NAS PDU\n    with data. At any time the UE has no user plane bearers established,\n    the UE may provide a Release Assistance Information with Uplink data in\n    the NAS PDU.\n\n     For IP PDN type PDN connections configured to support Header\n    Compression, the UE shall apply header compression before encapsulating\n    it into the NAS message.\n\n  17.  The NAS PDU with data is send to the MME in a Uplink S1-AP message.\n\n     To assist Location Services, the eNB may indicate, if changed, the\n    UE's Coverage Level to the MME.\n\n     If the Release Assistance Information is received from the UE it\n    overrides the Traffic Profile (see TS\u00c2\u00a023.682\u00c2\u00a0[74]) and the MME does not\n    send the Traffic Profile to the eNB.\n\n  18.  The data is checked for integrity and decrypted. If header\n    compression was applied to the PDN, the MME shall perform header\n    decompression to rebuild the IP header.\n\n  19.  The MME sends Uplink data to the PDN GW via the S-GW and executes\n    any action related to the presence of Release Assistance Information as\n    follows:\n\n    -  for the case where the Release Assistance Information indicates\n       there is no downlink data to follow the uplink data then unless the\n       MME is aware of pending MT traffic, and unless S1-U bearers exist,\n       the MME immediately releases the connection and therefore step\u00c2\u00a021 is\n       executed.\n\n    -  for the case where the Release Assistance Information indicates that\n       downlink data will follow the uplink transmission then unless the MME\n       is aware of additional pending MT traffic and unless S1-U bearers\n       exist, the MME sends a S1 UE Context Release Command to the eNodeB\n       immediately after the S1-AP message including the Downlink data\n       encapsulated in NAS PDU.\n\n  20.  If no NAS activity exists for a while the eNB detects inactivity and\n    executes step\u00c2\u00a021.\n\n  21.  The eNB starts an eNodeB initiated S1 release procedure according to\n    clause\u00c2\u00a05.3.5 or Connection Suspend Procedure defined in clause\u00c2\u00a05.3.4A.\n    The UE and the MME shall store the ROHC configuration and context for\n    the uplink/downlink data transmission when entering ECM_CONNECTED state\n    next time.\n\n\n5.3.4B.4 Establishment of S1-U bearer during Data Transport in Control\n           Plane CIoT EPS Optimisation\n\n                                    [pic]\n\n  Figure 5.3.4B.4-1: Establishment of S1-U bearer during Data Transport in\n                     Control Plane CIoT EPS Optimisation\n\nUE or MME can use this procedure if the UE and MME successfully negotiate\nS1-U data transfer or User Plane CIoT EPS Optimisation in addition to\nControl Plane CIoT EPS Optimisation based on the Preferred and Supported\nNetwork Behaviour as defined in clause\u00c2\u00a04.3.5.10. The MME either because it\nhas received the NAS message as defined in steps 2-3 or the MME decides\nthat S1-U based data transfer is now preferred e.g. determined by the size\nof data transferred in UL and DL using Control Plane CIoT EPS Optimisation\ntriggers the establishment of S1-U bearer(s). The MME checks if the UE can\nsupport the establishment of required number of additional user plane radio\nbearers based on the maximum number of user plane radio bearers indicated\nby UE in the UE Network Capability IE as defined in clause\u00c2\u00a05.11.3. If the\nMME takes the decision that S1-U data transfer is now preferred steps 2-3\nare not needed.\n\n  1. UE is sending and receiving data in NAS PDUs using the Control Plane\n    CIoT EPS Optimisation.\n\n  2. The UE may be triggered to establish user plane bearers and sends a\n    Control Plane Service Request with an active flag towards the MME\n    encapsulated in an RRC message to the eNodeB. The RRC message and this\n    NAS message are described in TS\u00c2\u00a036.300\u00c2\u00a0[5] and TS\u00c2\u00a024.301\u00c2\u00a0[46]\n    respectively.\n\n  3. The eNodeB forwards the Control Plane Service Request with active flag\n    to MME. NAS message is encapsulated in an S1-AP UL NAS Transport\n    Message (NAS message, TAI+ECGI of the serving cell, S-TMSI, CSG ID, CSG\n    access Mode). Details of this step\u00c2\u00a0are described in TS\u00c2\u00a036.300\u00c2\u00a0[5]. If\n    the MME receives the Control Plane Service Request with active flag\n    defined in steps 2-3 it shall establish S1-U bearer(s) and execute the\n    transfer. If the MME cannot handle the procedure associated to the\n    Control Plane Service Request with active flag, it shall reject it. CSG\n    ID is provided if the UE sends the NAS message via a CSG cell or a\n    hybrid cell. CSG access mode is provided if the UE sends the NAS\n    message via a hybrid cell. If the CSG access mode is not provided but\n    the CSG ID is provided, the MME shall consider the cell as a CSG\n    cell.If a CSG ID is indicated and CSG access mode is not provided, and\n    there is no subscription data for this CSG ID and associated PLMN or\n    the CSG subscription is expired, the MME rejects the Control Plane\n    Service Request with an appropriate cause. The UE shall remove the CSG\n    ID and associated PLMN of the cell where the UE has initiated the\n    service request procedure from the Allowed CSG list, if present.\n\n  4. The MME shall send any remaining UL data over S11-U and in order to\n    minimize the possible occurrence of out of order DL data e.g. caused by\n    earlier DL data which were sent on the Control Plane may send a Release\n    Access Bearers Request message to the Serving GW that requests the\n    release of all S11-U bearers for the UE. The MME locally deletes any\n    existing ROHC context used for Control Plane CIoT EPS Optimisation, and\n    other S11-U related information in UE context, including TEID (DL) for\n    the S11-U, etc, but not the Header Compression Configuration.\n\n  NOTE:  The MME may use the \"Delay Downlink Packet Notification Request\"\n         causing the Serving GW to not send Downlink Data Notifications as\n         described in clause\u00c2\u00a05.3.4.2 to minimize the impact of possible\n         Downlink Data Notifications this step\u00c2\u00a0may cause.\n\n  5. If the Serving GW receives the Release Access Bearers Request message\n    it releases all MME related information (address and downlink TEIDs)\n    for the UE and responds with a Release Access Bearers Response message\n    to the MME. Other elements of the UE's Serving GW context are not\n    affected. If downlink packets arrive for the UE, the Serving GW starts\n    buffering downlink packets received for the UE and initiating the\n    \"Network Triggered Service Request\" procedure, described in\n    clause\u00c2\u00a05.3.4.3.\n\n  6. The MME sends S1-AP Initial Context Setup Request (Serving GW address,\n    S1-TEID(s) (UL), EPS Bearer QoS(s), Security Context, MME Signalling\n    Connection Id, Handover Restriction List, CSG Membership Indication,\n    Service Accept) message to the eNodeB for all PDN connections that MME\n    has not included Control Plane Only Indicator in ESM request. The MME\n    responds to the UE with a Service Accept message. The eNodeB stores the\n    Security Context, MME Signalling Connection Id, EPS Bearer QoS(s) and\n    S1-TEID(s) in the UE RAN context. The step\u00c2\u00a0is described in detail in\n    TS\u00c2\u00a036.300\u00c2\u00a0[5]. Handover Restriction List is described in clause\u00c2\u00a04.3.5.7\n    \"Mobility Restrictions\".\n\n  7. If the Control Plane Service Request is performed via a hybrid cell,\n    CSG Membership Indication indicating whether the UE is a CSG member\n    shall be included in the S1-AP message from the MME to the RAN. Based\n    on this information the RAN can perform differentiated treatment for\n    CSG and non-CSG members. The eNodeB performs the radio bearer\n    establishment procedure. The user plane security is established at this\n    step, which is described in detail in TS\u00c2\u00a036.300\u00c2\u00a0[5]. The UE needs to\n    locally delete any existing ROHC context used for Control Plane CIoT\n    EPS Optimisation. When the user plane radio bearers are setup, EPS\n    bearer state synchronization is performed between the UE and the\n    network, i.e. the UE shall locally remove any EPS bearer for which the\n    MME has not included Control Plane Only Indicator in ESM request and\n    for which no radio bearers are setup. If the radio bearer for a default\n    EPS bearer is not established, the UE shall locally deactivate all EPS\n    bearers associated to that default EPS bearer.\n\n  8. As the user plane radio bearers are setup the UE shall use user plane\n    bearers to transfer data PDUs, except for EPS bearers the MME has\n    included Control Plane Only Indicator in ESM request and for which\n    Control Plane CIoT EPS Optimisation is still be used. The uplink data\n    from the UE can now be forwarded by eNodeB to the Serving GW. The\n    eNodeB sends the uplink data to the Serving GW address and TEID\n    provided in the step\u00c2\u00a06. The Serving GW forwards the uplink data to the\n    PDN GW.\n\n  9. The eNodeB sends an S1-AP message Initial Context Setup Complete\n    (eNodeB address, List of accepted EPS bearers, List of rejected EPS\n    bearers, S1 TEID(s) (DL)) to the MME. This step\u00c2\u00a0is described in detail\n    in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n  10.  The MME sends a Modify Bearer Request message (eNodeB address, S1\n    TEID(s) (DL) for the accepted EPS bearers, Delay Downlink Packet\n    Notification Request, RAT Type) per PDN connection to the Serving GW.\n    If the Serving GW supports Modify Access Bearers Request procedure and\n    if there is no need for the Serving GW to send the signalling to the\n    PDN GW, the MME may send Modify Access Bearer Request (eNodeB\n    address(es) and TEIDs for downlink user plane for the accepted EPS\n    bearers, Delay Downlink Packet Notification Request) per UE to the\n    Serving GW to optimise the signalling. The Serving GW is now able to\n    transmit downlink data towards the UE.\n\n  11.  The Serving GW shall return a Modify Bearer Response (Serving GW\n    address and TEID for uplink traffic) to the MME as a response to a\n    Modify Bearer Request message, or a Modify Access Bearers Response\n    (Serving GW address and TEID for uplink traffic) as a response to a\n    Modify Access Bearers Request message. If the Serving GW cannot serve\n    the MME Request in the Modify Access Bearers Request message without\n    S5/S8 signalling other than to unpause charging in the PDN GW or\n    without corresponding Gxc signalling when PMIP is used over the S5/S8\n    interface, it shall respond to the MME with indicating that the\n    modifications are not limited to S1-U bearers, and the MME shall repeat\n    its request using a Modify Bearer Request message per PDN connection.\n\n\n"}, {"key": "eNB Control Plane Relocation Indication procedure", "numbering": "5.3.4B.5", "title_level": 3, "desc": ""}, {"key": "S release procedure", "numbering": "5.3.5", "title_level": 2, "desc": "5.3.4B.5 eNB Control Plane Relocation Indication procedure\n\nFor intra-NB-IoT mobility for UE and MME using Control Plane CIoT EPS\nOptimisation the eNB CP Relocation Indication procedures may be used. The\npurpose of the eNB CP Relocation Indication procedure is to request the MME\nto authenticate the UE's re-establishment request as described in\nTS\u00c2\u00a033.401\u00c2\u00a0[41], and initiate the establishment of the UE's S1 connection\nand, if necessary, the S11-U connection after the UE has initiated a RRC Re-\nestablishment procedure in a new eNB.\n\nMore details are defined in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n\n5.3.5  S1 release procedure\n\nThis procedure is used to release the logical S1-AP signalling connection\n(over S1-MME) and all S1 bearers (in S1-U) for a UE. This Procedure\nreleases the S11-U bearer in Control Plane CIoT EPS Optimisation (except in\ncase of buffering in MME), instead of the S1-U bearer. The procedure will\nmove the UE from ECM-CONNECTED to ECM-IDLE in both the UE and MME, and all\nUE related context information is deleted in the eNodeB. When the S1-AP\nsignalling connection is lost, e.g. due to loss of the signalling transport\nor because of an eNodeB or MME failure, the S1 release procedure is\nperformed locally by the eNodeB and by the MME. When the S1 release\nprocedure is performed locally by the eNodeB or by the MME each node\nperforms locally its actions as described in the procedure flow below\nwithout using or relying on any of the signalling shown directly between\neNodeB and MME.\n\nIf Service Gap Control shall be applied for the UE (see clause\u00c2\u00a04.3.17.9)\nand the Service Gap timer is not already running, the Service Gap timer\nshall be started in MME and UE when entering ECM-IDLE, unless the\nconnection was initiated after a paging of an MT event, or after a TAU\nprocedure without any active flag set or signalling active flag set.\n\nThe initiation of S1 Release procedure is either:\n\n  -  eNodeB-initiated with cause e.g. O&M Intervention, Unspecified\n    Failure, User Inactivity, Repeated RRC signalling Integrity Check\n    Failure, Release due to UE generated signalling connection release, CS\n    Fallback triggered, Inter-RAT Redirection, etc. as defined in\n    TS\u00c2\u00a036.413\u00c2\u00a0[36]; or\n\n  -  MME-initiated with cause e.g. authentication failure, detach, not\n    allowed CSG cell (e.g. the CSG ID of the currently used CSG cell\n    expires or is removed from the CSG subscription data), etc.\n\nBoth eNodeB-initiated and MME-initiated S1 release procedures are shown in\nFigure 5.3.5-1.\n\n                                    [pic]\n\n                    Figure 5.3.5-1: S1 Release Procedure\n\n  1a.  In certain cases the eNodeB may release the UE's signalling\n    connection before or in parallel to requesting the MME to release the\n    S1 context, e.g. the eNodeB initiates an RRC Connection Release for CS\n    Fallback by redirection. If the reason for the release is that the\n    eNodeB received Release Assistance Indicator in Access Stratum as\n    defined in TS\u00c2\u00a036.321\u00c2\u00a0[87], the eNodeB should not immediately release\n    the RRC connection, instead send S1 UE context Release Request with\n    appropriate cause value e.g. user inactivity.\n\n  1b.  If the eNodeB detects a need to release the UE's signalling\n    connection and all radio bearers for the UE, the eNodeB sends an S1 UE\n    Context Release Request (Cause) message to the MME. Cause indicates the\n    reason for the release (e.g. O&M intervention, unspecified failure,\n    user inactivity, repeated integrity checking failure, or release due to\n    UE generated signalling connection release).\n\n     If the PLMN has configured secondary RAT reporting and the eNodeB has\n    Secondary RAT usage data to report, the Secondary RAT usage data is\n    included in S1 UE Context Release Request.\n\n  NOTE\u00c2\u00a01:  Step 1 is only performed when the eNodeB-initiated S1 release\n         procedure is considered. Step 1 is not performed and the procedure\n         starts with Step 2 when the MME-initiated S1 release procedure is\n         considered.\n\n     The MME upon receiving S1 UE context Release Request with Cause=user\n    inactivity continues with the S1 release procedure unless the MME is\n    aware of pending MT traffic or signalling and/or NAS Release Assistance\n    Information that may have been received in NAS PDU when Control Plane\n    CIoT EPS Optimisation is used, which indicates that downlink data is\n    expected.\n\n     For Control Plane CIoT EPS Optimisation with data buffering in the\n    MME, step\u00c2\u00a02 and step\u00c2\u00a03 are skipped.\n\n  2. The MME sends a Release Access Bearers Request (Abnormal Release of\n    Radio Link Indication, Secondary RAT usage data) message to the S-GW\n    that requests the release of all S1-U bearers for the UE, or the S11-U\n    in Control Plane CIoT EPS Optimisation if buffering is in the S-GW.\n    This message is triggered either by an S1 Release Request message from\n    the eNodeB, or by another MME event. The Abnormal Release of Radio Link\n    Indication is included if the S1 release procedure is due to an\n    abnormal release of the radio link. If secondary RAT usage data was\n    received in Step 1b, the MME includes Secondary RAT usage data in this\n    message.\n\n  3. If the S-GW has received a Release Access Bearers Request, the S-GW\n    releases all eNodeB related information (address and TEIDs), or the MME\n    TEIDs related information in Control Plane CIoT EPS Optimisation\n    (address and TEIDs), for the UE and responds with a Release Access\n    Bearers Response message to the MME. Other elements of the UE's S-GW\n    context are not affected. The S-GW retains the S1-U configuration that\n    the S-GW allocated for the UE's bearers. The S-GW starts buffering\n    downlink packets received for the UE and initiating the \"Network\n    Triggered Service Request\" procedure, described in clause 5.3.4.3, if\n    downlink packets arrive for the UE. In Control Plane CIoT EPS\n    Optimisation Downlink data triggers Mobile Terminated Data transport in\n    NAS signalling defined in clause\u00c2\u00a05.3.4B.3.\n\n  NOTE\u00c2\u00a02:  Based on operator policy any received Indication of \"Abnormal\n         Release of Radio Link\" may be used by Serving GW in subsequent\n         decisions to trigger PDN charging pause if the feature has been\n         enabled on that PDN.\n\n  4. The MME releases S1 by sending the S1 UE Context Release Command\n    (Cause) message to the eNodeB.\n\n  5. If the RRC connection is not already released, the eNodeB sends a RRC\n    Connection Release message to the UE in Acknowledged Mode. Once the\n    message is acknowledged by the UE, the eNodeB deletes the UE's context.\n\n  6. The eNodeB confirms the S1 Release by returning an S1 UE Context\n    Release Complete (ECGI, TAI, Secondary RAT usage data) message to the\n    MME. With this, the signalling connection between the MME and the\n    eNodeB for that UE is released. This step shall be performed promptly\n    after step\u00c2\u00a04, e.g. it shall not be delayed in situations where the UE\n    does not acknowledge the RRC Connection Release.\n\n     If Dual Connectivity was active at the time of the release, the eNodeB\n    shall include the PSCell ID.\n\n     The eNodeB may include the Information On Recommended Cells And\n    eNodeBs For Paging in the S1 UE Context Release Complete message. If\n    available, the MME shall store this information to be used when paging\n    the UE.\n\n     The eNB includes Information for Enhanced Coverage, if available, in\n    the S1 UE Context Release Complete message.\n\n     If the PLMN has configured secondary RAT usage data reporting, the\n    eNodeB has not included Secondary RAT usage data at step\u00c2\u00a01b, and the\n    eNodeB has Secondary RAT usage data to report, the Secondary RAT usage\n    data is included in this message. If Secondary RAT usage data was\n    included at step\u00c2\u00a01b then MME ignores Secondary RAT usage data at\n    step\u00c2\u00a06.\n\n     The MME deletes any eNodeB related information (\"eNodeB Address in Use\n    for S1-MME\", \"MME UE S1 AP ID\" and \"eNB UE S1AP ID\") from the UE's MME\n    context, but, retains the rest of the UE's MME context including the S-\n    GW's S1-U configuration information (address and TEIDs). All non-GBR\n    EPS bearers established for the UE are preserved in the MME and in the\n    Serving GW.\n\n     If the cause of S1 release is because of User I inactivity, Inter-RAT\n    Redirection, the MME shall preserve the GBR bearers. If the cause of S1\n    release is because of CS Fallback triggered, further details about\n    bearer handling are described in TS\u00c2\u00a023.272\u00c2\u00a0[58]. Otherwise, e.g. Radio\n    Connection With UE Lost, S1 signalling connection lost, eNodeB failure\n    the MME shall trigger the MME Initiated Dedicated Bearer Deactivation\n    procedure (clause\u00c2\u00a05.4.4.2) for the GBR bearer(s) of the UE after the S1\n    Release procedure is completed.\n\n  NOTE\u00c2\u00a03:  EPC does not support the GPRS preservation feature with setting\n         the MBR for GBR bearers to zero.\n\n  NOTE\u00c2\u00a04:  The MME can defer the deactivation of GBR bearers for a short\n         period (in the order of seconds) upon receipt of an S1AP UE Context\n         Release Request due to radio reasons, so as to allow the UE to re-\n         establish the corresponding radio and S1-U bearers and thus avoid\n         deactivation of the GBR bearers.\n\n     If LIPA is active for a PDN connection, the HeNB informs the\n    collocated L-GW by internal signalling to releases the direct user\n    plane path to the HeNB. After the direct user plane path is released,\n    if downlink packets arrive for the UE, the L-GW forwards the first\n    packet on the S5 tunnel to the S-GW to initiate the \"Network Triggered\n    Service Request\" procedure, as described in clause\u00c2\u00a05.3.4.3.\n\n  7. If the eNodeB provided and MME accepted Secondary RAT usage data in\n    step\u00c2\u00a06 (i.e. MME initiated S1 release), the MME initiates the Secondary\n    RAT usage data reporting procedure in clause\u00c2\u00a05.7A.3 as illustrated in\n    figure 5.7A.3-2 (steps 7a - 7d). If PGW secondary RAT usage reporting\n    is active, steps 7b and 7c are performed, otherwise only steps 7a and\n    7d are performed.\n\n     If the eNodeB provided Secondary RAT usage data in step\u00c2\u00a01b (i.e. eNB\n    initiated S1 release) and PGW secondary RAT usage data reporting is\n    active, the MME initiates the Secondary RAT usage data reporting\n    procedure in clause\u00c2\u00a05.7A.3 as illustrated in figure 5.7A.3-2.\n\n\n"}, {"key": "Connection Resume procedure", "numbering": "5.3.5A", "title_level": 2, "desc": "5.3.5A Connection Resume procedure\n\nThis procedure is used by the UE to resume the ECM-connection if the UE and\nthe network support User Plane CIoT EPS Optimisation and the UE has stored\nthe necessary information to conduct the Connection Resume procedure (see\nTS\u00c2\u00a036.300\u00c2\u00a0[5]) otherwise the Service Request procedures are used, see\nclause\u00c2\u00a05.3.4.\n\n                                    [pic]\n\n          Figure 5.3.5A-1: UE initiated Connection Resume procedure\n\n  1. The UE triggers the Random Access procedure to the eNodeB, see\n    TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n  2. The UE triggers the RRC Connection Resume procedure including\n    information needed by the eNodeB to access the UE's stored AS context,\n    see TS\u00c2\u00a036.300\u00c2\u00a0[5]. The E-UTRAN performs security checks. EPS bearer\n    state synchronization is performed between the UE and the network, i.e.\n    the UE shall locally remove any EPS bearer for which no radio bearer is\n    setup and which is not a Control Plane CIoT EPS bearer. If the radio\n    bearer for a default EPS bearer is not established, the UE shall\n    locally deactivate all EPS bearers associated to that default EPS\n    bearer.\n\n  3. The eNodeB notifies the MME that the UE's RRC connection is resumed in\n    the S1-AP UE Context Resume Request message which includes an RRC\n    resume cause. If the eNodeB is not able to admit all suspended bearers,\n    the eNodeB shall indicate this in the list of rejected EPS bearers, see\n    TS\u00c2\u00a036.413\u00c2\u00a0[36].\n\n     If there is a Service Gap timer running in the MME for the UE and the\n    MME is not waiting for a MT paging response from the UE and the RRC\n    Connection Establishment Cause for the Connection Resume Request is not\n    'mo-Signalling', the MME rejects the resume request by sending a S1-AP\n    UE Context Resume Reject message to eNodeB.\n\n  NOTE:  If the UE then sends a subsequent Service Request while the\n         Service Gap timer is running, the MME will send a Service Reject\n         NAS message to the UE with a Mobility Management back-off timer\n         corresponding to the remaining time of the current Service Gap\n         timer (see procedure in clause\u00c2\u00a05.3.4).\n\n     The MME enters the ECM-CONNECTED state. The MME identifies that the UE\n    returns at the eNodeB for which MME has stored data related to the S1AP\n    association, UE Context and bearer context including the DL TEID(s),\n    necessary to resume the connection, see Connection Suspend procedure in\n    clause\u00c2\u00a05.3.4A.\n\n     If a default EPS bearer is not accepted by the eNodeB, all the EPS\n    bearers associated to that default bearer shall be treated as non-\n    accepted bearers. The MME releases the non-accepted and non-established\n    bearers by triggering the bearer release procedure as specified in\n    clause\u00c2\u00a05.4.4.2.\n\n     To assist Location Services, the eNB indicates the UE's Coverage Level\n    to the MME.\n\n  3a.  If the S1-U connection is resumed and the UE is accessing via the NB-\n    IoT RAT with the RRC resume cause set to \"MO exception data\", the MME\n    should notify the Serving Gateway of each use of this establishment\n    cause by the MO Exception Data Counter. The MME maintains the MO\n    Exception Data Counter and sends it to the Serving GW as indicated in\n    TS\u00c2\u00a029.274\u00c2\u00a0[43].\n\n  3b.  The Serving Gateway should notify the PDN GW if the RRC\n    establishment cause \"MO Exception Data\" has been used by the MO\n    Exception Data Counter (see TS\u00c2\u00a029.274\u00c2\u00a0[43]). The Serving GW indicates\n    each use of this RRC establishment cause by the related counter on its\n    CDR.\n\n  3c.  The PDN GW indicates each use of the RRC establishment cause \"MO\n    Exception Data\" by the related counter on its CDR.\n\n  4. MME acknowledges the connection resumption in S1-AP UE Context Resume\n    Response message. If the MME is not able to admit all suspended E-RABs\n    the MME shall indicate this in the E-RABs Failed To Resume List IE.\n\n  5. If the MME included in step\u00c2\u00a04 a list of E-RABs failed to resume, the\n    eNodeB reconfigures the radio bearers.\n\n  6. The uplink data from the UE can now be forwarded by eNodeB to the\n    Serving GW. The eNodeB sends the uplink data to the Serving GW address\n    and TEID stored during the Connection Suspend procedure, see\n    clause\u00c2\u00a05.3.4A. The Serving GW forwards the uplink data to the PDN GW.\n\n  7. The MME sends a Modify Bearer Request message (eNodeB address, S1\n    TEID(s) (DL) for the accepted EPS bearers, Delay Downlink Packet\n    Notification Request, RAT Type) per PDN connection to the Serving GW.\n    If the Serving GW supports Modify Access Bearers Request procedure and\n    if there is no need for the Serving GW to send the signalling to the\n    PDN GW, the MME may send Modify Access Bearers Request (eNodeB\n    address(es) and TEIDs for downlink user plane for the accepted EPS\n    bearers, Delay Downlink Packet Notification Request) per UE to the\n    Serving GW to optimise the signalling. The Serving GW is now able to\n    transmit downlink data towards the UE.\n\n     The MME and the Serving GW clears the DL Data Buffer Expiration Time\n    in their UE contexts if it was set, to remember that any DL data\n    buffered for a UE using power saving functions has been delivered and\n    to avoid any unnecessary user plane setup in conjunction with a later\n    TAU.\n\n  8. The Serving GW shall return a Modify Bearer Response (Serving GW\n    address and TEID for uplink traffic) to the MME as a response to a\n    Modify Bearer Request message, or a Modify Access Bearers Response\n    (Serving GW address and TEID for uplink traffic) as a response to a\n    Modify Access Bearers Request message. If the Serving GW cannot serve\n    the MME Request in the Modify Access Bearers Request message without\n    S5/S8 signalling other than to unpause charging in the PDN GW or\n    without corresponding Gxc signalling when PMIP is used over the S5/S8\n    interface, it shall respond to the MME with indicating that the\n    modifications are not limited to S1-U bearers, and the MME shall repeat\n    its request using a Modify Bearer Request message per PDN connection.\n\n     If SIPTO at the Local Network is active for a PDN connection with\n    stand-alone GW deployment and the Local Home Network ID for stand-alone\n    accessed by the UE differs from the Local Home Network ID where the UE\n    initiated the SIPTO@LN PDN Connection, the MME shall request\n    disconnection of the SIPTO at the local network PDN connection(s) with\n    the \"reactivation requested\" cause value according to clause\u00c2\u00a05.10.3. If\n    the UE has no other PDN connection, the MME initiated \"explicit detach\n    with reattach required\" procedure according to clause\u00c2\u00a05.3.8.3.\n\n     If SIPTO at the Local Network is active for a PDN connection with\n    collocated LGW deployement and the L-GW CN address of the cell accessed\n    by the UE differs from the L-GW CN address of the cell where the UE\n    initiated the SIPTO at the Local Network PDN Connection, the MME shall\n    request disconnection of the SIPTO at the local network PDN\n    connection(s) with the \"reactivation requested\" cause value according\n    to clause\u00c2\u00a05.10.3. If the UE has no other PDN connection, the MME\n    initiated \"explicit detach with reattach required\" procedure according\n    to clause\u00c2\u00a05.3.8.3.\n\n\n"}, {"key": "Void", "numbering": "5.3.6", "title_level": 2, "desc": "5.3.6  Void\n\n\n\n\n"}, {"key": "PDN GW Pause of Charging procedure", "numbering": "5.3.6A", "title_level": 2, "desc": "5.3.6A PDN GW Pause of Charging procedure\n\nThe PDN GW Pause of Charging procedure is optionally supported by the\nServing GW and PDN GW and has the purpose to limit a mismatch between PDN\nGW and Serving GW charging volume and packet counts. Generally, it aims for\nthe PDN GW charging and usage monitoring data to more accurately reflect\nthe downlink traffic actually sent to the E-UTRAN.\n\n  NOTE\u00c2\u00a01:  A consequence of using this procedure is that PDN GW charging\n         data does not correspond to the volume that traversed the PDN GW,\n         and it is therefore not possible to count the downlink packets\n         dropped between the PDN GW and the E-UTRAN.\n\nThe Serving GW may indicate support of this function to the PDN GW when the\nPDN connection is activated or when a new/target Serving GW is used for a\nPDN connection. This is indicated to the PDN GW by a \"PDN Charging Pause\nSupport Indication\" in the Create Session Request during PDN\nactivation/Attach and in the Modify Bearer Request in procedures with a\nchange of Serving GW.\n\n  NOTE\u00c2\u00a02:  It is assumed that Pause of PGW Charging is not invoked by SGW\n         that is performing extended data buffering.\n\nThe PDN GW may indicate if the feature is to be enabled on a per PDN\nconnection basis, if the current Serving GW supports the feature and the\noperator's policy is to enable the feature. This is indicated to the\nServing GW by a \"PDN Charging Pause Enabled\" Indication in the Create\nSession Response during PDN activation/Attach and in the Modify Bearer\nResponse in procedures with a change of Serving GW. This is an indication\nto the Serving GW that when the criteria for pause of PDN GW charging are\nmet (as described further down in this clause) the PDN GW charging can be\npaused.\n\n  NOTE\u00c2\u00a03:  PDNs where this function applies are based on an operator policy\n         in the PDN GW. What enters into that policy is operator specific\n         but may be based on for example if the PDN uses SDF based charging,\n         UE is in home or visited network, APN employed, UE is configured\n         for NAS signalling low priority, Charging Characteristics value\n         etc.\n\nThe PDN GW shall stop any charging and usage monitoring actions for the PDN\nconnection upon receiving a \"PDN Charging Pause Start\" Indication in a\nModify Bearer Request. When the PDN GW receives a Modify Bearer Request for\na PDN connection for which charging has been stopped previously and, if the\nModify Bearer Request contains a \"PDN Charging Pause Stop\" Indication or\ndoes not contain a \"PDN Charging Pause Start\" Indication, then the PDN GW\nshall continue charging for the PDN connection.\n\n  NOTE\u00c2\u00a04:  In addition to the Service Request Procedure, the PDN GW\n         charging is also unpaused during mobility procedures involving the\n         Serving GW based on Modify Bearer Request messages without \"PDN\n         Charging Pause Start\" indication or during mobility procedures\n         involving the Gn/Gp SGSN based on Update PDP Context Request\n         messages.\n\n  NOTE\u00c2\u00a05:  A Delete Bearer Command or Delete Bearer Request or Delete\n         Bearer Response for a dedicated bearer does not unpause a\n         previously paused PDN charging.\n\nWhen bearers become suspended for a UE (see TS\u00c2\u00a023.272\u00c2\u00a0[58]), the PDN GW\ncharging is no longer paused and the PDN GW continues charging for the PDN\nconnection after suspended bearers are resumed.\n\n  NOTE\u00c2\u00a06:  The PDN GW discards packets received for a suspended UE as\n         described in TS\u00c2\u00a023.272\u00c2\u00a0[58].\n\nWhile the PDN GW charging is currently paused and the UE is in ECM-IDLE\n(for ISR case the device is at same time in PMM-IDLE or STANDBY in\nUTRAN/GERAN accesses) the following applies:\n\n  -  The PDN GW shall not perform charging and usage monitoring actions for\n    downlink traffic on this PDN.\n\n  NOTE\u00c2\u00a07:  The Serving GW charges anyway only for the amount of transmitted\n         downlink traffic as described in clause\u00c2\u00a05.7A.\n\n  -  Based on operator policy/configuration in the PDN GW, the PDN GW may\n    limit the rate of downlink traffic sent to the Serving GW.\n\nBased on operator policy/configuration in the Serving GW, the Serving GW\nmay discard rather than buffer the downlink user plane packets for this PDN\nconnection while the PDN GW charging is paused. This is to avoid delivery\nof user plane packets to the UE that were not counted in the PDN GW for\ncharging and usage monitoring purposes. Regardless of operator\npolicy/configuration, the downlink user plane packets received from PDN GW\nat the Serving GW shall trigger Downlink Data Notifications as described in\nclause\u00c2\u00a05.3.4.3.\n\nWhen the Serving GW receives a Modify Bearer Request or Modify Access\nBearers Request for a PDN connection triggering a Modify Bearer Request\ntowards the PDN GW, the Serving GW shall consider the PDN charging as being\nunpaused if it has been paused previously.\n\n                                    [pic]\n\n              Figure 5.3.6A: PDN GW Pause of charging procedure\n\n  1. The Serving GW receives downlink data packets for a UE known as not\n    user plane connected (i.e. the Serving GW context data indicates no\n    downlink user plane TEID for the eNodeB) as described in clause\u00c2\u00a05.3.4.3\n    step\u00c2\u00a01, i.e. the packets are buffered or discarded in Serving GW based\n    on operator policy.\n\n  2. Based on operator policy/configuration the Serving GW triggers the\n    procedure to pause PDN charging. Triggering criteria are based on\n    Serving GW operator policy/configuration. Example of such policy may\n    be:\n\n    a. Operator specified criteria/threshold (e.g. number/fraction of\n       packets/bytes dropped at Serving GW in downlink since last time the\n       UE was in ECM-CONNECTED state (or for ISR case PMM-CONNECTED state)).\n\n    b. Recent indication of \"Abnormal Release of Radio Link\" (see\n       clause\u00c2\u00a05.3.5) or a recent Downlink Data Notification Reject\n       (clause\u00c2\u00a05.3.4.3) without UE shortly re-entering ECM-CONNECTED state\n       (or for ISR case without also re-entering PMM-CONNECTED state).\n\n  3. Serving GW sends a Modify Bearer Request (PDN Charging Pause Start)\n    message to the PDN GW. PDN Charging Pause Start indicates that PDN GW\n    charging shall be paused.\n\n  4. PDN GW confirms with a Modify Bearer Response message.\n\n\n"}, {"key": "GUTI Reallocation procedure", "numbering": "5.3.7", "title_level": 2, "desc": "5.3.7  GUTI Reallocation procedure\n\nThe MME may initiate the GUTI Reallocation procedure to reallocate the GUTI\nand/or TAI list at any time when a signalling association is established\nbetween UE and MME. The GUTI Reallocation procedure allocates a new GUTI\nand/or a new TAI list to the UE. The GUTI and/or the TAI list may also be\nreallocated by the Attach or the Tracking Area Update procedures.\n\nThe GUTI Reallocation procedure is illustrated in Figure 5.3.7-1.\n\n                                    [pic]\n\n                 Figure 5.3.7-1: GUTI Reallocation Procedure\n\n  1. The MME sends GUTI Reallocation Command (GUTI, TAI list) to the UE.\n\n  2. The UE returns GUTI Reallocation Complete message to the MME.\n\n\n"}, {"key": "Detach procedure", "numbering": "5.3.8", "title_level": 2, "desc": "5.3.8  Detach procedure\n\n\n"}, {"key": "General", "numbering": "5.3.8.1", "title_level": 3, "desc": "5.3.8.1  General\n\nThe Detach procedure allows:\n\n  -  the UE to inform the network that it does not want to access the EPS\n    any longer, and\n\n  -  the network to inform the UE that it does not have access to the EPS\n    any longer.\n\nThe UE is detached either explicitly or implicitly:\n\n  -  Explicit detach: The network or the UE explicitly requests detach and\n    signal with each other.\n\n  -  Implicit detach: The network detaches the UE, without notifying the\n    UE. This is typically the case when the network presumes that it is not\n    able to communicate with the UE, e.g. due to radio conditions.\n\nFour detach procedures are provided when the UE accesses the EPS through E-\nUTRAN. The first detach procedure is UE-initiated detach procedure and\nother detach procedures are network-initiated detach procedure:\n\n  -  UE-Initiated Detach Procedure. In the ISR activated case the UE\n    initiated detach is split into two sub procedures, one for UE camping\n    on E-UTRAN and one for UE camping on GERAN/UTRAN;\n\n  -  MME-Initiated Detach Procedure;\n\n  -  SGSN-Initiated Detach procedure with ISR activated;\n\n  -  HSS-Initiated Detach Procedure.\n\n  NOTE\u00c2\u00a01:  The MME and the UE may enter EMM-DEREGISTERED state without the\n         above procedures.\n\n\n"}, {"key": "UE-initiated Detach procedure", "numbering": "5.3.8.2", "title_level": 3, "desc": "5.3.8.2  UE-initiated Detach procedure\n\nThe Detach procedure when initiated by the UE is described in\nclauses\u00c2\u00a05.3.8.2.1 and 5.3.8.2.2.\n\n\n"}, {"key": "UE-initiated Detach procedure for E-UTRAN", "numbering": "5.3.8.2.1", "title_level": 4, "desc": "5.3.8.2.1   UE-initiated Detach procedure for E-UTRAN\n\nFigure\u00c2\u00a05.3.8.2-1 shows the case when UE camps on E-UTRAN and Detach Request\nis sent to MME.\n\n                                    [pic]\n\n   Figure 5.3.8.2-1: UE-Initiated Detach Procedure - UE camping on E-UTRAN\n\n  NOTE\u00c2\u00a01:  For a PMIP-based S5/S8, procedure steps (A) are defined in\n         TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps\u00c2\u00a06, 7 and 8 concern GTP based S5/S8\n\n  1. The UE sends NAS message Detach Request (GUTI, Switch Off) to the MME.\n    This NAS message is used to trigger the establishment of the S1\n    connection if the UE was in ECM-IDLE mode. Switch Off indicates whether\n    detach is due to a switch off situation or not. The eNodeB forwards\n    this NAS message to the MME along with the TAI+ECGI of the cell which\n    the UE is using.\n\n     If the MME receives a Detach Request via a CSG cell with Switch Off\n    parameter indicating that detach is not due to a switch off situation,\n    and the CSG subscription for this CSG ID and associated PLMN is absent\n    or expired, the MME shall trigger a MME-initiated Detach procedure as\n    specified in clause\u00c2\u00a05.3.8.3.\n\n     If Dual Connectivity is active for the UE, the PSCell ID shall be\n    included in the Uplink NAS Transport that carries the Detach Request\n    message.\n\n  NOTE\u00c2\u00a02:  Security procedures may be invoked if the NAS message is used to\n         establish the S1 connection.\n\n  NOTE\u00c2\u00a03:  For emergency attached or RLOS attached UEs that were not\n         successfully authenticated, security procedures are not performed.\n\n  2. If the UE has no activated PDN connection, then steps 2 to 10 are not\n    executed. If the PLMN has configured secondary RAT usage data\n    reporting, the MME shall wait for step\u00c2\u00a011, if applicable, and shall\n    perform step\u00c2\u00a012 before step\u00c2\u00a02 onwards. For any PDN connection to the\n    SCEF, the MME indicates to the SCEF that the PDN connection for the UE\n    is no longer available according to TS\u00c2\u00a023.682\u00c2\u00a0[74] and steps 2 to 10\n    are not executed. For PDN connections to the P-GW, the active EPS\n    Bearers in the Serving GW regarding this particular UE are deactivated\n    by the MME sending Delete Session Request (LBI, User Location\n    Information (ECGI), Secondary RAT usage data) per PDN connection to the\n    Serving GW. If ISR is activated, then the Serving GW shall not release\n    the Control Plane TEID allocated for MME/SGSN until it receives the\n    Delete Session Request message in step\u00c2\u00a05. If the UE Time Zone has\n    changed, the MME includes the UE Time Zone IE in this message. If\n    Secondary RAT usage data report was received from RAN, the MME includes\n    this in the Delete Session Request message.\n\n  3. When the S-GW receives the first Delete Session Request message from\n    the MME or SGSN in ISR activated state, the Serving GW deactivates ISR,\n    releases the related EPS Bearer context information and responds with\n    Delete Session Response (Cause).\n\n     When the S-GW receives the Delete Session Request message from the MME\n    or SGSN in ISR deactivated state, the Serving GW releases the related\n    EPS Bearer context information and jumps to step\u00c2\u00a06 by sending a Delete\n    Session Request (LBI) message per PDN connection to the PDN GW. After\n    step\u00c2\u00a07 the Serving GW responds back to the MME/SGSN with the Delete\n    Session Response (Cause and, optionally, APN Rate Control Status\n    according to clause\u00c2\u00a04.7.7.3) message.\n\n  4. If ISR is activated, MME sends Detach Indication (Cause) message to\n    the associated SGSN. The Cause indicates complete detach.\n\n  5. The active PDP contexts in the Serving GW regarding this particular UE\n    are deactivated by the SGSN sending Delete Session Request (LBI,\n    CGI/SAI) per PDN connection to the Serving GW. If the UE Time Zone has\n    changed, the SGSN includes the UE Time Zone IE in this message.\n\n  6. If ISR is activated, Serving GW deactivates ISR. If ISR is not\n    activated in the Serving GW, the Serving GW sends Delete Session\n    Request (LBI, User Location Information (ECGI or CGI/SAI), Secondary\n    RAT usage data) per PDN connection to the PDN GW. If ISR is not\n    activated, this step shall be triggered by step\u00c2\u00a02. This message\n    indicates that all bearers belonging to that PDN connection shall be\n    released. If the MME and/or SGSN sends UE's Location Information,\n    and/or UE Time Zone Information, and/or Secondary RAT usage data in\n    step\u00c2\u00a02 and/or step\u00c2\u00a05, the S-GW includes the User Location Information,\n    and/or UE Time Zone, and/or User CSG Information with the least age in\n    this message and/or Secondary RAT usage data information.\n\n  7. The PDN GW acknowledges with Delete Session Response (Cause and,\n    optionally, APN Rate Control Status according to clause\u00c2\u00a04.7.7.3).\n\n  8. The PDN GW employs a PCEF initiated IP-CAN Session Termination\n    Procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6] with the PCRF to indicate to the\n    PCRF that EPS Bearer is released if PCRF is applied in the network. If\n    requested by the PCRF the PDN\u00c2\u00a0GW indicates User Location Information\n    and/or UE Time Zone Information to the PCRF as defined in\n    TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  9. The Serving GW acknowledges with Delete Session Response (Cause and,\n    optionally, APN Rate Control Status).\n\n  10.  The SGSN sends Detach Acknowledge message to the MME (optionally APN\n    Rate Control Status). If received, the MME stores the APN Rate Control\n    Status in the MM context.\n\n  11.  If Switch Off indicates that detach is not due to a switch off\n    situation, the MME sends a Detach Accept to the UE.\n\n  12.  The MME releases the S1-MME signalling connection for the UE by\n    sending S1 Release Command to the eNodeB with Cause set to Detach. The\n    details of this step are covered in the \"S1 Release Procedure\", as\n    described in clause 5.3.5.\n\n  NOTE\u00c2\u00a04:  In the \"S1 Release Procedure\", if Dual Connectivity was active\n         at the time of the release, the eNodeB includes the PSCell ID.\n\n\n"}, {"key": "UE-initiated Detach procedure for GERAN/UTRAN with ISR", "numbering": "5.3.8.2.2", "title_level": 4, "desc": "5.3.8.2.2   UE-initiated Detach procedure for GERAN/UTRAN with ISR\n             activated\n\nFigure\u00c2\u00a05.3.8.2-2 shows the case when UE with ISR Activated camps on\nGERAN/UTRAN and Detach Request is sent to SGSN. Refer to clause\u00c2\u00a06.6.1 of\nTS\u00c2\u00a023.060\u00c2\u00a0[7] for the UE-initiated Detach procedure when ISR is not\nactivated.\n\n                                    [pic]\n\n       Figure 5.3.8.2-2: UE-Initiated Detach Procedure - UE camping on\n                         GERAN/UTRAN, ISR activated\n\n  1. The UE sends NAS message Detach Request (Detach Type, P-TMSI, P-TMSI-\n    Signature, Switch Off) to the SGSN. Detach Type indicates which type of\n    detach is to be performed, i.e. GPRS Detach only, IMSI Detach only or\n    combined GPRS and IMSI Detach. Switch Off indicates whether detach is\n    due to a switch off situation or not. The Detach Request message\n    includes P-TMSI and P-TMSI Signature. P-TMSI Signature is used to check\n    the validity of the Detach Request message. If P-TMSI Signature is not\n    valid or is not included, the authentication procedure should be\n    performed.\n\n     If the SGSN receives a Detach Request via a CSG cell with Switch Off\n    parameter indicating that detach is not due to a switch off situation,\n    and the CSG subscription for this CSG ID and associated PLMN is absent\n    or expired, the SGSN shall trigger a SGSN-initiated Detach procedure as\n    specified in clause\u00c2\u00a05.3.8.3A.\n\n  2. The active EPS Bearers in the Serving GW regarding this particular UE\n    are deactivated by the SGSN sending Delete Session Request (LBI, User\n    Location Information (CGI/SAI)) per PDN connection to the Serving GW.\n    Because ISR is activated, then the Serving GW shall not release the\n    Control Plan TEID allocated for MME/SGSN until it receives the Delete\n    Session Request message in step\u00c2\u00a05. If the UE Time Zone has changed, the\n    SGSN includes the UE Time Zone IE in this message.\n\n  3. Because the Serving GW receives this message in ISR activated state,\n    the Serving GW deactivates ISR and acknowledges with Delete Session\n    Response (Cause).\n\n  4. Because ISR is activated, the SGSN sends Detach Notification (Cause)\n    message to the associated MME. Cause indicates complete detach.\n\n  5. The active PDP contexts in the Serving GW regarding this particular UE\n    are deactivated by the MME sending Delete Session Request (LBI, ECGI)\n    per PDN connection to the Serving GW. If the UE Time Zone has changed,\n    the MME includes the UE Time Zone IE in this message.\n\n  6. Serving GW deactivates ISR and sends Delete Session Request (LBI, User\n    Location Information (ECGI or CGI/SAI)) per PDN connection to the PDN\n    GW. If ISR is not activated, this step shall be triggered by step\u00c2\u00a02.\n    This message indicates that all bearers belonging to that PDN\n    connection shall be released. If the MME and/or SGSN sends UE's\n    Location Information and/or UE Time Zone Information in step\u00c2\u00a02 and/or\n    step\u00c2\u00a05, the S-GW includes the User Location Information and/or UE Time\n    Zone with the least age in this message.\n\n  7. The PDN GW acknowledges with Delete Session Response (Cause).\n\n  8. The PDN GW employs a PCEF initiated IP CAN Session Termination\n    Procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6] with the PCRF to indicate to the\n    PCRF that EPS Bearer is released if PCRF is applied in the network. If\n    requested by the PCRF the PDN\u00c2\u00a0GW indicates User Location Information\n    and/or UE Time Zone Information to the PCRF as defined in\n    TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  9. The Serving GW acknowledges with Delete Session Response (Cause).\n\n  10.  The MME sends Detach Acknowledge message to the SGSN.\n\n  11.  If Switch Off indicates that detach is not due to a switch off\n    situation, the SGSN sends a Detach Accept to the UE.\n\n  12.  If the MS was GPRS detached, then the 3G SGSN releases the PS\n    signalling connection.\n\n\n"}, {"key": "MME-initiated Detach procedure", "numbering": "5.3.8.3", "title_level": 3, "desc": "5.3.8.3  MME-initiated Detach procedure\n\nThe MME-Initiated Detach procedure when initiated by the MME is illustrated\nin Figure 5.3.8.3-1.\n\nThis procedure may be also used as part of the SIPTO function when the MME\ndetermines that GW relocation is desirable for all PDN connection(s)\nserving SIPTO-allowed APNs. The MME initiates the \"explicit detach with\nreattach required\" procedure and the UE should then re-establish those PDN\nconnections for the same APN(s).\n\n                                    [pic]\n\n              Figure 5.3.8.3-1: MME-Initiated Detach Procedure\n\n  NOTE\u00c2\u00a01:  For a PMIP-based S5/S8, procedure steps (A) are defined in\n         TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps 3, 4 and 5 concern GTP based S5/S8.\n\n  NOTE\u00c2\u00a02:  Procedure steps (B) are used by the procedure steps (E) in\n         clause\u00c2\u00a05.3.2.1.\n\n  1. The MME initiated detach procedure is either explicit (e.g. by O&M\n    intervention) or implicit. The MME may implicitly detach a UE, if it\n    has not had communication with UE for a long period of time. The MME\n    does not send the Detach Request (Detach Type) message to the UE for\n    implicit detach. The implicit detach is local to the MME, i.e. an SGSN\n    registration will not be detached. If the UE is in ECM-CONNNECTED state\n    the MME may explicitly detach the UE by sending a Detach Request\n    message to the UE. The Detach Type may be set to re-attach in which\n    case the UE should re-attach at the end of the detach process. If the\n    UE is in ECM-IDLE state the MME pages the UE.\n\n     For emergency attached UEs, MME initiated implicit detach procedures\n    are based on an inactivity timeout specific to emergency.\n\n     If this Detach procedure is due to the UE's Detach Request via a CSG\n    cell which the UE is not allowed to access, i.e. the CSG subscription\n    for this CSG ID and associated PLMN is absent or expired, the MME shall\n    send a Detach Request to UE with an appropriate cause indicating the UE\n    is not allowed to access this CSG.\n\n  2. If the UE has no activated PDN connection, then steps 2 to 10 are not\n    executed. If the PLMN has configured secondary RAT usage reporting, the\n    MME shall wait for step\u00c2\u00a011, if applicable, and perform step\u00c2\u00a012 before\n    step\u00c2\u00a02 onwards. For any PDN connections to the SCEF, the MME indicates\n    to the SCEF that the PDN connection for the UE is no longer available\n    according to TS\u00c2\u00a023.682\u00c2\u00a0[74] and steps 2 to 10 are not executed. For PDN\n    connections to the P-GW, any EPS Bearer Context information in the\n    Serving GW regarding this particular UE and related to the MME are\n    deactivated by the MME sending Delete Session Request (LBI, User\n    Location Information (ECGI), NAS Release Cause if available, Secondary\n    RAT usage data) message per PDN connection to the Serving GW. If the UE\n    Time Zone has changed, the MME includes the UE Time Zone IE in this\n    message. NAS Release Cause is only sent by the MME to the PDN GW if\n    this is permitted according to MME operator's policy. If Secondary RAT\n    usage data report was received from the RAN, the MME includes this in\n    the Delete Session Request message.\n\n  3. When the S-GW receives the first Delete Session Request message from\n    the MME or SGSN in ISR activated state, the Serving GW deactivates ISR,\n    releases the related EPS Bearer context information and responds with\n    Delete Session Response (Cause).\n\n     When the S-GW receives the Delete Session Request message from the MME\n    or SGSN in ISR deactivated state, the Serving GW releases the related\n    EPS Bearer context information and jumps to step\u00c2\u00a06 by sending a Delete\n    Session Request (LBI) message to the PDN GW. After step\u00c2\u00a07 the Serving\n    GW responds back to the MME/SGSN with the Delete Session Response\n    (Cause and, optionally, APN Rate Control Status according to\n    clause\u00c2\u00a04.7.7.3) message.\n\n  4. If ISR is activated, MME sends Detach Notification (Cause) message to\n    the associated SGSN. The cause indicates whether it is a local or\n    complete detach.\n\n  5. If cause indicates complete detach then the SGSN sends a Delete\n    Session Request (LBI, CGI/SAI) message per PDN connection to the\n    Serving GW. If Cause indicates local detach then SGSN deactivates ISR\n    and steps\u00c2\u00a05 to 9 shall be skipped. If the UE Time Zone has changed, the\n    SGSN includes the UE Time Zone IE in this message.\n\n  6. If ISR is activated, Serving GW deactivates ISR.\n\n     If ISR is not activated and the Serving GW received one or several\n    Delete Bearer Request message(s) from SGSN in step\u00c2\u00a02, the Serving GW\n    sends a Delete Session Request (LBI, User Location Information (ECGI or\n    CGI/SAI), NAS Release Cause if available, Secondary RAT usage data)\n    message for each associated PDN connection to the PDN GW. NAS Release\n    Cause is the one received in the Delete Session Request from the MME.\n    This message indicates that all bearers belonging to that PDN\n    connection shall be released.\n\n     If the MME and/or SGSN send(s) UE's Location Information, and/or UE\n    Time Zone and/or Secondary RAT usage data in step\u00c2\u00a02 and/or step\u00c2\u00a05, the\n    S-GW includes the User Location Information, and/or UE Time Zone\n    Information with the least age in this message and/or Secondary RAT\n    usage data.\n\n  7. The PDN GW acknowledges with Delete Session Response (Cause and,\n    optionally, APN Rate Control Status according to clause\u00c2\u00a04.7.7.3)\n    message.\n\n  8. The PDN GW employs an IP-CAN Session Termination procedure as defined\n    in TS\u00c2\u00a023.203\u00c2\u00a0[6] with the PCRF to indicate to the PCRF that the EPS\n    Bearer(s) are released if a PCRF is configured. If requested by the\n    PCRF the PDN\u00c2\u00a0GW indicates User Location Information and/or UE Time Zone\n    Information and NAS Release Cause (if available) to the PCRF as defined\n    in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  9. The Serving GW acknowledges with Delete Session Response (Cause, APN\n    Rate Control Status) message.\n\n  10.  The SGSN sends Detach Acknowledge message to the MME (APN Rate\n    Control Status). The MME stores the APN Rate Control Status in the MM\n    context.\n\n  11.  If the UE receives the Detach Request message from the MME in the\n    step 1, the UE sends a Detach Accept message to the MME any time after\n    step 1. The eNodeB forwards this NAS message to the MME along with the\n    TAI+ECGI of the cell which the UE is using.\n\n     If Dual Connectivity is active for the UE, the PSCell ID shall be\n    included in the Uplink NAS Transport that carries the Detach Accept\n    message.\n\n     If the UE receives Detach Request from the MME via a CSG cell with the\n    cause indicating the UE is not allowed to access this CSG, the UE shall\n    remove this CSG ID and associated PLMN from its Allowed CSG list, if\n    present.\n\n  12.  After receiving the Detach Accept message, Delete Session Response\n    and, if appropriate, Detach Acknowledge message, the MME releases the\n    S1-MME signalling connection for the UE by sending an S1 Release\n    Command (Cause) message to the eNodeB. The details of this step are\n    covered in the \"S1 Release Procedure\", as described in clause\u00c2\u00a05.3.5 by\n    step\u00c2\u00a04 to step\u00c2\u00a06. If the Detach Type requests the UE to make a new\n    attach, the UE reattaches after the RRC Connection Release is\n    completed.\n\n  NOTE\u00c2\u00a03:  In the \"S1 Release Procedure\", if Dual Connectivity was active\n         at the time of the release, the eNodeB includes the PSCell ID.\n\n\n"}, {"key": "SGSN-initiated Detach procedure with ISR activated", "numbering": "5.3.8.3A", "title_level": 3, "desc": "5.3.8.3A SGSN-initiated Detach procedure with ISR activated\n\nThe SGSN-Initiated Detach procedure with ISR activated is illustrated in\nFigure\u00c2\u00a05.3.8.3A-1. Refer to clause\u00c2\u00a06.6.2.1 of TS\u00c2\u00a023.060\u00c2\u00a0[7] for the SGSN-\ninitiated Detach procedure when ISR is not activated.\n\n                                    [pic]\n\n    Figure 5.3.8.3A-1: SGSN-Initiated Detach Procedure with ISR activated\n\n  NOTE\u00c2\u00a01:  For a PMIP-based S5/S8, procedure steps (A) are defined in\n         TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps\u00c2\u00a03, 4 and 5 concern GTP based S5/S8.\n\n  1. The SGSN initiated detach procedure is either explicit (e.g. by O&M\n    intervention) or implicit. The SGSN may implicitly detach a UE, if it\n    has not had communication with UE for a long period of time. The SGSN\n    does not send the Detach Request (Detach Type) message to the UE for\n    implicit detach. The implicit detach is local to the SGSN, i.e. an MME\n    registration will not be detached. If the UE is in PMM-CONNNECTED state\n    the SGSN may explicitly detach the UE by sending a Detach Request\n    message to the UE. The Detach Type may be set to re-attach in which\n    case the UE should re-attach at the end of the detach process. If the\n    UE is in PMM-IDLE state the SGSN pages the UE.\n\n     If this Detach procedure is due to the UE's Detach Request via a CSG\n    cell which the UE is not allowed to access, i.e. the CSG subscription\n    for this CSG ID and associated PLMN is absent or expired, the SGSN\n    shall send a Detach Request to UE with an appropriate cause indicating\n    the UE is not allowed to access this CSG.\n\n  2. Any EPS Bearer Context information in the Serving GW regarding this\n    particular UE and related to the SGSN is deactivated by the SGSN\n    sending Delete Session Request (LBI, User Location Information (ECGI))\n    message per PDN connection to the Serving GW. If the UE Time Zone has\n    changed, the SGSN includes the UE Time Zone IE in this message.\n\n  3. Because the Serving GW receives this message in ISR activated state,\n    the Serving GW deactivates ISR, releases the SGSN related EPS Bearer\n    context information and acknowledges with Delete Session Response\n    (Cause).\n\n  4. Because ISR is activated, the SGSN sends Detach Notification (Cause)\n    message to the associated MME. The cause indicates whether it is a\n    local or complete detach.\n\n  5. If cause indicates complete detach then the MME sends a Delete Session\n    Request (LBI, User Location Information (ECGI)) message per PDN\n    connection to the Serving GW. If Cause indicates local detach then MME\n    deactivates ISR and steps\u00c2\u00a05 to 9 shall be skipped. If the UE Time Zone\n    has changed, the MME includes the UE Time Zone IE in this message.\n\n  6. The Serving GW sends a Delete Session Request (LBI, User Location\n    Information (ECGI or CGI/SAI)) message per PDN connection to the PDN\n    GW. This message indicates that all bearers belonging to that PDN\n    connection shall be released. If the MME and/or SGSN sends UE's\n    Location Information and/or UE Time Zone in step\u00c2\u00a02 and/or step\u00c2\u00a05, the S-\n    GW includes the User Location Information and/or UE Time Zone\n    Information with the least age in this message.\n\n  7. The PDN GW acknowledges with Delete Session Response (Cause) message.\n\n  8. The PDN GW employs an IP CAN Session Termination procedure as defined\n    in TS\u00c2\u00a023.203\u00c2\u00a0[6] with the PCRF to indicate to the PCRF that the EPS\n    Bearer(s) are released if a PCRF is configured. If requested by the\n    PCRF the PDN\u00c2\u00a0GW indicates User Location Information and/or UE Time Zone\n    Information to the PCRF as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  9. The Serving GW acknowledges with Delete Session Response (Cause)\n    message.\n\n  10.  The MME sends Detach Acknowledge message to the SGSN.\n\n  11.  If the UE receives the Detach Request message from the SGSN in the\n    step\u00c2\u00a01, the UE sends a Detach Accept message to the SGSN any time after\n    step\u00c2\u00a01.\n\n     If the UE receives Detach Request from the SGSN via a CSG cell with\n    the cause indicating the UE is not allowed to access this CSG, the UE\n    shall remove this CSG ID and associated PLMN from its Allowed CSG list,\n    if present.\n\n  12.  After receiving the Detach Accept message, if Detach Type did not\n    request the UE to make a new attach, then the 3G SGSN releases the PS\n    signalling connection.\n\n\n"}, {"key": "HSS-initiated Detach procedure", "numbering": "5.3.8.4", "title_level": 3, "desc": "5.3.8.4  HSS-initiated Detach procedure\n\nThe HSS-Initiated Detach procedure is initiated by the HSS. The HSS uses\nthis procedure for operator-determined purposes to request the removal of a\nsubscriber's MM and EPS bearer at the MME and also at the SGSN if both an\nMME and an SGSN are registered in the HSS.\n\nFor UEs with emergency EPS bearers, the MME/SGSN shall not initiate detach\nprocedure. Instead the MME/SGSN shall deactivate all the non emergency PDN\nconnection.\n\nIf the HSS-Initiated Detach procedure is initiated, and UE is RLOS attached\n, the MME shall not initiate detach procedure.\n\n  NOTE\u00c2\u00a01:  HSS-initiated Detach can happen for a UE that camps on a cell in\n         limited state due to UE moving to a forbidden area performs RLOS\n         attach and the MME does not perform Purge procedure for the UE\n         towards the HSS (as specified in clause\u00c2\u00a05.3.9.3).\n\nFor subscription change, e.g. RAT restrictions to disallow one of the RATs,\nthe Insert Subscription Data procedure shall be used towards the MME, and\nalso towards the SGSN if both an MME and an SGSN are registered in the HSS.\n\nThis procedure is not applied if a Cancel Location is sent to the MME or\nthe SGSN with a cause other than Subscription Withdrawn.\n\nThe HSS-Initiated Detach Procedure is illustrated in Figure 5.3.8.4-1.\n\n                                    [pic]\n\n              Figure 5.3.8.4-1: HSS-Initiated Detach Procedure\n\n  NOTE\u00c2\u00a02:  For a PMIP-based S5/S8, procedure steps (A) are defined in\n         TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps 4, 5 and 6 concern GTP based S5/S8.\n\n  NOTE\u00c2\u00a03:  Procedure steps (B) are used by the procedure steps (F) in\n         clause\u00c2\u00a05.3.2.1.\n\n  NOTE\u00c2\u00a04:  The steps below apply for an S4-SGSN. For Gn/Gp SGSN, the\n         procedure specified in clause\u00c2\u00a06.6.2.2. of TS\u00c2\u00a023.060\u00c2\u00a0[7] applies for\n         the SGSN.\n\n  1. If the HSS wants to request the immediate deletion of a subscriber's\n    MM contexts and EPS Bearers, the HSS shall send a Cancel Location\n    (IMSI, Cancellation Type) message with Cancellation Type set to\n    Subscription Withdrawn to the registered MME and also to the SGSN if an\n    SGSN is also registered. When receiving the Cancel Location Message the\n    MME/SGSN acknowledges with a Cancel Location ACK (IMSI) message to the\n    HSS.\n\n  2. If Cancellation Type is Subscription Withdrawn, the MME/SGSN which has\n    an active UE context informs the UE which is in ECM-CONNECTED state,\n    that it has been detached, by sending Detach Request (Detach Type)\n    message to the UE. If the Cancel Location message includes a flag to\n    indicate re-attach is required, the MME/SGSN shall set the Detach Type\n    to indicate that re-attach is required. If the UE is in ECM-IDLE state\n    the MME pages the UE.\n\n  NOTE\u00c2\u00a05:  The UE will receive only one Detach Request message in the RAT\n         where it currently camps on.\n\n  3a.  If the UE has no activated PDN connection, then steps 3 to 7 are not\n    executed. If the PLMN has configured secondary RAT usage data\n    reporting, the MME shall wait for Step 8a, if applicable, and perform\n    step\u00c2\u00a010a before step\u00c2\u00a03a. If the MME has an active UE context, for any\n    PDN connection to the SCEF, the MME indicates to the SCEF that the PDN\n    connection for the UE is no longer available according to\n    TS\u00c2\u00a023.682\u00c2\u00a0[74] and steps 3 to 7 are not executed. For PDN connections\n    to the P-GW, the MME sends a Delete Session Request (LBI, User Location\n    Information (ECGI), NAS Release Cause if available, Secondary RAT usage\n    data if available) message per PDN connection to the Serving GW to\n    deactivate the EPS Bearer Context information in the Serving GW. NAS\n    Release Cause is only sent by the MME to the PDN GW if this is\n    permitted according to MME operator's policy.\n\n  3b.  If the SGSN has an active UE context, the SGSN sends a Delete\n    Session Request (LBI, User Location Information (CGI/SAI)) per PDN\n    connection to the Serving GW to deactivate the EPS Bearer Context\n    information in the Serving GW.\n\n  4. When the S-GW receives the first Delete Session Request message from\n    the MME or SGSN in ISR activated state, the Serving GW deactivates ISR,\n    releases the related EPS Bearer context information and responds with\n    Delete Session Response in step\u00c2\u00a07.\n\n     When the S-GW receives one or several Delete Session Request\n    message(s) from the MME or SGSN in ISR deactivated state, the Serving\n    GW releases the related EPS Bearer context information and sends a\n    Delete Session Request (LBI, User Location Information (ECGI or\n    CGI/SAI), NAS Release Cause if available, Secondary RAT usage data if\n    PGW secondary RAT usage data reporting is active) message for each\n    associated PDN connection to the PDN GW. NAS Release Cause is the one\n    received in the Delete Session Request from the MME or SGSN. This\n    message indicates that all bearers belonging to that PDN connection\n    shall be released. If the UE Time Zone has changed, the MME includes\n    the UE Time Zone IE in this message. If the MME and/or SGSN sends UE's\n    Location Information and/or UE Time Zone Information in step\u00c2\u00a03a and/or\n    step\u00c2\u00a03b, the S-GW includes the User Location Information and/or UE Time\n    Zone with the least age in this message.\n\n  5. The PDN GW acknowledges with Delete Session Response (Cause and,\n    optionally, APN Rate Control Status according to clause\u00c2\u00a04.7.7.3)\n    message.\n\n  6. The PDN GW employs a PCEF initiated IP-CAN Session Termination\n    procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6] with the PCRF to indicate to the\n    PCRF that the EPS bearer is released if a PCRF is configured. If\n    requested by the PCRF the PDN\u00c2\u00a0GW indicates User Location Information\n    and/or UE Time Zone Information and NAS Release Cause (if available) to\n    the PCRF as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  7. The Serving GW acknowledges with Delete Session Response (TEID and,\n    optionally, APN Rate Control Status) message.\n\n     If received, the MME stores the APN Rate Control Status in the MM\n    context.\n\n  8. If the UE receives the Detach Request message from the MME/SGSN, the\n    UE sends a Detach Accept message to the MME/SGSN any time after step 2.\n    The message is sent either in E-UTRAN or GERAN/UTRAN access depending\n    on which access the UE received the Detach Request. For the Detach\n    Accept message from UE to MME the eNodeB forwards this NAS message to\n    the MME along with the TAI+ECGI of the cell which the UE is using.\n\n     If Dual Connectivity is active for the UE, the PSCell ID shall be\n    included in the Uplink NAS Transport that carries the Detach Accept\n    message.\n\n  9. Void.\n\n  10a. After receiving the Detach Accept message, the MME releases the S1-\n    MME signalling connection for the UE by sending S1 Release Command\n    (Cause) message to the eNodeB with Cause set to Detach. The details of\n    this step are covered in the \"S1 Release Procedure\", as described in\n    clause 5.3.5.\n\n  NOTE\u00c2\u00a06:  In the \"S1 Release Procedure\", if Dual Connectivity was active\n         at the time of the release, the eNodeB includes the PSCell ID.\n\n  10b. After receiving the Detach Accept message, if Detach Type did not\n    request the UE to make a new attach, then the 3G SGSN releases the PS\n    signalling connection.\n\n\n"}, {"key": "HSS User Profile management function procedure", "numbering": "5.3.9", "title_level": 2, "desc": "5.3.9  HSS User Profile management function procedure\n\n\n"}, {"key": "General", "numbering": "5.3.9.1", "title_level": 3, "desc": "5.3.9.1  General\n\nThe HSS user profile management function allows the HSS to update the HSS\nuser profile stored in the MME. Whenever the HSS user profile is changed\nfor a user in the HSS, and the changes affect the HSS user profile stored\nin the MME, the MME shall be informed about these changes by the means of\nthe following procedure:\n\n  -  Insert Subscriber Data procedure, used to add or modify the HSS user\n    profile in the MME.\n\n\n"}, {"key": "Insert Subscriber Data procedure", "numbering": "5.3.9.2", "title_level": 3, "desc": "5.3.9.2  Insert Subscriber Data procedure\n\nThe Insert Subscriber Data procedure is illustrated in Figure\u00c2\u00a05.3.9.2-1.\n\n                                    [pic]\n\n             Figure 5.3.9.2-1: Insert Subscriber Data procedure\n\n  1. The HSS sends an Insert Subscriber Data (IMSI, Subscription Data)\n    message to the MME.\n\n  2. The MME updates the stored Subscription Data and acknowledges the\n    Insert Subscriber Data message by returning an Insert Subscriber Data\n    Ack (IMSI) message to the HSS. The update result should be contained in\n    the Ack message.\n\n     The MME initiates appropriate action according to the changed\n    subscriber data (e.g. MME initiates detach if the UE is not allowed to\n    roam in this network). For received PDN subscription contexts that have\n    no related active PDN connection in the MME, no further action is\n    required except storage in the MME. Otherwise if the subscribed QoS\n    Profile has been modified and the UE is in ECM-CONNECTED state or in\n    ECM-IDLE state when ISR is not activated but the UE is reachable by the\n    MME, the HSS Initiated Subscribed QoS Modification procedure, as\n    described in Figure\u00c2\u00a05.4.2.2-1, is invoked from step\u00c2\u00a02a. When ISR is not\n    activated and the UE is in ECM IDLE state and is not reachable by the\n    MME, e.g. when the UE is suspended, when the UE has entered into power\n    saving mode or when the PPF is cleared in the MME, the HSS Initiated\n    Subscribed QoS Modification procedure, as described in Figure 5.4.2.2-\n    1, is invoked from step\u00c2\u00a02a at the next ECM IDLE to ECM CONNECTED\n    transition. If the UE is in ECM-IDLE state and the ISR is activated,\n    this procedure is invoked at the next ECM-IDLE to ECM-CONNECTED\n    transition. If the UE is in ECM-IDLE state and the ISR is not activated\n    and if the subscription change no longer allows the PDN connection, the\n    MME initiated PDN disconnection procedure in clause 5.10.3 is used to\n    delete the concerned PDN connection. If the MME receives RAT specific\n    Subscribed Paging Time Window that is different from the one stored in\n    the MME MM context, the MME updates RAT specific Subscribed Paging Time\n    Window parameter in the MME MM context to the value received from the\n    HSS.\n\n     If the UE is in ECM-CONNECTED state and connected via a CSG or hybrid\n    cell, the MME shall check the received CSG subscription data. If the\n    MME detects that the CSG membership to that cell has changed or\n    expired, the MME initiates the procedure in clause\u00c2\u00a05.16.\n\n     If the MME received a changed Service Gap Time parameter in the\n    updated subscription data, the MME shall provide the new Service Gap\n    Time value to the UE in the next Tracking Area Update Accept message,\n    or, if the UE does not send any Tracking Area Update Request within a\n    certain time period that shall be longer than any PSM or eDRX interval\n    used by the UE, the MME may initiate a detach with reattach required of\n    the UE or an RRC connection release with release cause load balancing\n    TAU required of the UE.\n\n\n"}, {"key": "Purge function", "numbering": "5.3.9.3", "title_level": 3, "desc": "5.3.9.3  Purge function\n\nThe Purge function allows an MME to inform the HSS that it has deleted the\nsubscription data and MM context of a detached UE. The MME may, as an\nimplementation option, delete the subscription data and MM context of an UE\nimmediately after the implicit or explicit detach of the UE. Alternatively\nthe MME may keep for some time the subscription data and the MM context of\nthe detached UE, so that the data can be reused at a later attach without\naccessing the HSS.\n\n                                    [pic]\n\n                      Figure 5.3.9.3-1: Purge Procedure\n\n  1. After deleting the Subscription data and MM contexts of a detached UE,\n    the MME sends Purge UE (IMSI) message to the HSS.\n\n  2. The HSS sets the UE Purged for E-UTRAN flag and acknowledges with a\n    Purge UE Ack message.\n\n\n"}, {"key": "Security Function", "numbering": "5.3.10", "title_level": 2, "desc": "5.3.10 Security Function\n\n\n"}, {"key": "General", "numbering": "5.3.10.1", "title_level": 3, "desc": "5.3.10.1 General\n\nThe security functions include:\n\n  -  Guards against unauthorised EPS service usage (authentication of the\n    UE by the network and service request validation).\n\n  -  Provision of user identity confidentiality (temporary identification\n    and ciphering).\n\n  -  Provision of user data and signalling confidentiality (ciphering).\n\n  -  Provision of origin authentication of signalling data (integrity\n    protection).\n\n  -  Authentication of the network by the UE.\n\nSecurity-related network functions for EPS are described in TS\u00c2\u00a033.401\u00c2\u00a0[41].\n\n\n"}, {"key": "Authentication and Key Agreement", "numbering": "5.3.10.2", "title_level": 3, "desc": "5.3.10.2 Authentication and Key Agreement\n\nEPS AKA is the authentication and key agreement procedure that shall be\nused over E-UTRAN, between the UE and MME. EPS AKA is specified in\nTS\u00c2\u00a033.401\u00c2\u00a0[41].\n\n\n"}, {"key": "User Identity Confidentiality", "numbering": "5.3.10.3", "title_level": 3, "desc": "5.3.10.3 User Identity Confidentiality\n\nAn M-TMSI identifies a user between the UE and the MME. The relationship\nbetween M-TMSI and IMSI is known only in the UE and in the MME.\n\n\n"}, {"key": "User Data and Signalling Confidentiality", "numbering": "5.3.10.4", "title_level": 3, "desc": "5.3.10.4 User Data and Signalling Confidentiality\n\nThere are two different levels of the security associations between the UE\nand the network.\n\n  i) RRC and UP security association is between the UE and E-UTRAN. The RRC\n    security associations protect the RRC signalling between the UE and E-\n    UTRAN (integrity protection and ciphering). The UP security association\n    is also between the UE and E-UTRAN and provide user plane encryption\n    function.\n\n  ii)  NAS security association is between the UE and the MME. It provides\n    integrity protection and encryption of NAS signalling and, when the\n    Control Plane CIoT EPS Optimisation is used, user data.\n\n\n"}, {"key": "AS security mode command procedure", "numbering": "5.3.10.4.1", "title_level": 4, "desc": "5.3.10.4.1  AS security mode command procedure\n\nThe MME triggers the RRC level AS security mode command procedure by\nsending the needed security parameters to the eNodeB. This enables\nciphering of the UP traffic and ciphering and integrity protection of the\nRRC signalling as described in TS\u00c2\u00a033.401\u00c2\u00a0[41].\n\n\n"}, {"key": "NAS Security Mode Command procedure", "numbering": "5.3.10.4.2", "title_level": 4, "desc": "5.3.10.4.2  NAS Security Mode Command procedure\n\nThe MME uses the NAS Security Mode Command (SMC) procedure to establish a\nNAS security association between the UE and MME, in order to protect the\nfurther NAS signalling messages. This procedure is also used to make\nchanges in the security association, e.g. to change the security algorithm.\n\n                                    [pic]\n\n          Figure 5.3.10.4.2-1: NAS Security Mode Command Procedure\n\n  1. The MME sends NAS Security Mode Command (Selected NAS algorithms,\n    eKSI, ME Identity request, UE Security Capability) message to the UE.\n    ME identity request may be included when NAS SMC is combined with ME\n    Identity retrieval (see clause\u00c2\u00a05.3.10.5).\n\n  2. The UE responds NAS with Security Mode Complete (NAS-MAC, ME Identity)\n    message. The UE includes the ME Identity if it was requested in step\u00c2\u00a01.\n\n  NOTE:  The NAS Security Mode Command procedure is typically executed as\n         part of the Attach procedure (see clause\u00c2\u00a05.3.2.1) in advance of, or\n         in combination with, executing the ME Identity Check procedure (see\n         clause\u00c2\u00a05.3.10.5) and in the TAU procedure (see clauses\u00c2\u00a05.3.3.1 and\n         5.3.3.2).\n\nMore details of the procedure are described in TS\u00c2\u00a033.401\u00c2\u00a0[41].\n\n\n"}, {"key": "ME identity check procedure", "numbering": "5.3.10.5", "title_level": 3, "desc": "5.3.10.5 ME identity check procedure\n\nThe Mobile Equipment Identity Check Procedure permits the operator(s) of\nthe MME and/or the HSS and/or the PDN\u00c2\u00a0GW to check the Mobile Equipment's\nidentity (e.g. to check that it has not been stolen, or, to verify that it\ndoes not have faults).\n\nThe ME Identity can be checked by the MME passing it to an Equipment\nIdentity Register (EIR) and then the MME analysing the response from the\nEIR in order to determine its subsequent actions (e.g. sending an Attach\nReject if the EIR indicates that the Mobile Equipment is blacklisted).\n\nThe ME identity check procedure is illustrated in Figure 5.3.10.5-1.\n\n                                    [pic]\n\n                 Figure 5.3.10.5-1: Identity Check Procedure\n\n  1. The MME sends Identity Request (Identity Type) to the UE. The UE\n    responds with Identity Response (Mobile Identity).\n\n  2. If the MME is configured to check the IMEI against the EIR, it sends\n    ME Identity Check (ME Identity, IMSI) to EIR. The EIR responds with ME\n    Identity Check Ack (Result).\n\n  NOTE:  The Identity Check Procedure is typically executed as part of the\n         Attach procedure (see clause\u00c2\u00a05.3.2.1).\n\n\n"}, {"key": "UE Reachability procedures", "numbering": "5.3.11", "title_level": 2, "desc": "5.3.11 UE Reachability procedures\n\n\n"}, {"key": "General", "numbering": "5.3.11.1", "title_level": 3, "desc": "5.3.11.1 General\n\nThere are two procedures necessary for any service related entity that\nwould need to be notified by the reachability of the UE at EPC NAS level:\n\n  -  UE Reachability Notification Request procedure; and\n\n  -  UE Activity Notification procedure.\n\n\n"}, {"key": "UE Reachability Notification Request procedure", "numbering": "5.3.11.2", "title_level": 3, "desc": "5.3.11.2 UE Reachability Notification Request procedure\n\nThe UE Reachability Notification Request procedure is illustrated in\nFigure\u00c2\u00a05.3.11.2-1.\n\n                                    [pic]\n\n      Figure 5.3.11.2-1: UE Reachability Notification Request Procedure\n\n  1) If a service-related entity requests the HSS to provide an indication\n    regarding UE reachability on EPS, the HSS stores the service-related\n    entity and sets the URRP-MME parameter to indicate that such request is\n    received. If the value of URRP-MME parameter has changed from \"not set\"\n    to \"set\", the HSS sends a UE-REACHABILITY-NOTIFICATION-REQUEST (URRP-\n    MME) to the MME. If the MME has an MM context for that user, the MME\n    sets URRP-MME to indicate the need to report to the HSS information\n    regarding changes in UE reachability, e.g. when the next NAS activity\n    with that UE is detected.\n\n\n"}, {"key": "UE Activity Notification procedure", "numbering": "5.3.11.3", "title_level": 3, "desc": "5.3.11.3 UE Activity Notification procedure\n\nThe UE Activity Notification procedure is illustrated in Figure\u00c2\u00a05.3.11.3-1.\n\n                                    [pic]\n\n                  Figure 5.3.11.3-1: UE Activity Procedure\n\n  1) The MME receives an indication regarding UE reachability, e.g. an\n    Attach Request message from the UE or MME receive an indication from S-\n    GW that UE has handed over to non-3GPP coverage.\n\n  2) If the MME contains an MM context of the UE and if URRP-MME for that\n    UE is configured to report once that the UE is reachable, the MME shall\n    send a UE-Activity-Notification (IMSI, UE-Reachable) message to the HSS\n    and clears the corresponding URRP-MME for that UE.\n\n  3) When the HSS receives the UE-Activity-Notification (IMSI, UE-\n    Reachable) message or the Update Location message for an UE that has\n    URRP-MME set, it triggers appropriate notifications to the entities\n    that have subscribed to the HSS for this notification and clears the\n    URRP-MME for that UE.\n\n\n"}, {"key": "Update CSG Location Procedure", "numbering": "5.3.12", "title_level": 2, "desc": "5.3.12 Update CSG Location Procedure\n\nThe Update CSG Location procedure takes place when the SGSN/MME needs to\nretrieve the CSG subscription information of the UE from the CSS.\n\n                                    [pic]\n\n               Figure 5.3.12-1: Update CSG Location Procedure\n\n  1. The SGSN/MME sends Update CSG Location Request (MME Identity, IMSI,\n    MSISDN) to the CSS. The MSIDSN is included if available.\n\n  2. The CSS acknowledges the Update CSG Location message by sending an\n    Update CSG Location Ack (IMSI, CSG Subscription data) message to the\n    SGSN/MME.\n\n\n"}, {"key": "CSS subscription data management function procedure", "numbering": "5.3.13", "title_level": 2, "desc": "5.3.13 CSS subscription data management function procedure\n\n\n"}, {"key": "General", "numbering": "5.3.13.1", "title_level": 3, "desc": "5.3.13.1 General\n\nThe CSS subscription data management function allows the CSS to update the\nCSS subscription data stored in the MME.\n\nThe CSS subscription data is stored and managed in the MME independently\nfrom the Subscription Data received from the HSS.\n\nWhenever the CSS subscription data is changed for a user in the CSS, and\nthe changes affect the CSG subscription information stored in the MME, the\nMME shall be informed about these changes by the means of the following\nprocedure:\n\n  -  Insert CSG Subscriber Data procedure, used to add or modify the CSS\n    subscription data in the MME.\n\n\n"}, {"key": "Insert CSG Subscriber Data procedure", "numbering": "5.3.13.2", "title_level": 3, "desc": "5.3.13.2 Insert CSG Subscriber Data procedure\n\nThe Insert CSG Subscriber Data procedure is illustrated in Figure 5.3.13.2-\n1.\n\n                                    [pic]\n\n           Figure 5.3.13.2-1: Insert CSG Subscriber Data procedure\n\n  1. The CSS sends an Insert CSG Subscriber Data (IMSI, CSG Subscription\n    Data) message to the MME.\n\n  2. The MME updates the stored CSG Subscription Data and acknowledges the\n    Insert CSG Subscriber Data message by returning an Insert CSG\n    Subscriber Data Ack (IMSI) message to the CSS. The update result should\n    be contained in the Ack message.\n\n     The MME initiates appropriate action according to the changed CSG\n    subscriber data. If the UE is in ECM-CONNECTED state and connected via\n    a CSG or hybrid cell, the MME shall check the received CSG subscriber\n    data. If the MME detects that the CSG membership to that cell has\n    changed or expired, the MME initiates the procedure in clause\u00c2\u00a05.16.\n\n\n"}, {"key": "UE Radio Capability Match Request", "numbering": "5.3.14", "title_level": 2, "desc": "5.3.14 UE Radio Capability Match Request\n\nIf the MME, e.g. based on SRVCC capability in NAS, UE Usage Type or local\npolicy, requires more information on the UE radio capabilities support to\nbe able to set the IMS voice over PS Session Supported Indication (see\nclause\u00c2\u00a04.3.5.8), then the MME may send a UE Radio Capability Match Request\nmessage to the eNB. This procedure is typically used during the Initial\nAttach procedure, during Tracking Area Update procedure for the \"first TAU\nfollowing GERAN/UTRAN Attach\" or for \"UE radio capability update\" or when\nMME has not received the Voice Support Match Indicator (as part of the MM\nContext).\n\n                                    [pic]\n\n             Figure 5.3.14-1: UE Radio Capability Match Request\n\n  1  The MME indicates whether the MME wants to receive Voice support match\n    indicator. The MME may include the UE Radio Capability information that\n    it has previously received from the eNB via a S1-AP UE CAPABILITY INFO\n    INDICATION as described in clause\u00c2\u00a05.11.2.\n\n  2. Upon receiving a UE Radio Capability Match Request from the MME, if\n    the eNB has not already received the UE radio capabilities from the UE\n    or from MME in step\u00c2\u00a01, the eNB requests the UE to upload the UE radio\n    capability information by sending the RRC UE Capability Enquiry.\n\n  3. The UE provides the eNB with its UE radio capabilities sending the RRC\n    UE Capability Information.\n\n  4. The eNB checks whether the UE radio capabilities are compatible with\n    the network configuration for ensuring voice service continuity of\n    voice calls initiated in IMS.\n\n     For determining the appropriate UE Radio Capability Match Response,\n    the eNB is configured by the operator to check whether the UE supports\n    certain capabilities required for Voice continuity of voice calls using\n    IMS PS. In a shared network, the eNB keeps a configuration separately\n    per PLMN.\n\n  NOTE\u00c2\u00a01:  What checks to perform depends on network configuration, i.e.\n         following are some examples of UE capabilities to be taken into\n         account:\n\n         -  the SRVCC, and UTRAN/E-UTRAN Voice over PS capabilities;\n\n         -  the Radio capabilities for UTRAN/E-UTRAN FDD and/or TDD; and/or\n\n         -  the support of UTRAN/E-UTRAN frequency bands.\n\n  NOTE\u00c2\u00a02:  The network configuration considered in the decision for the\n         Voice Support Match Indicator is homogenous within a certain area\n         (e.g. MME Pool Area) in order to guarantee that the Voice Support\n         Match Indicator from the eNB is valid within such area.\n\n     The eNB provides a Voice Support Match Indicator to the MME to\n    indicate whether the UE capabilities and networks configuration are\n    compatible for ensuring voice service continuity of voice calls\n    initiated in IMS.\n\n     The MME stores the received Voice support match indicator in the MM\n    Context and uses it as an input for setting the IMS voice over PS\n    Session Supported Indication.\n\n  5. If eNB requested radio capabilities from UE in step\u00c2\u00a02 and 3, eNB also\n    sends the UE radio capabilities to the MME using the S1-AP UE\n    CAPABILITY INFO INDICATION. The MME stores the UE radio capabilities\n    without interpreting them for further provision to the eNB in cases\n    described in clause\u00c2\u00a05.11.2.\n\n  NOTE\u00c2\u00a03:  Steps 4 and 5 may be received by the MME in any order.\n\n\n"}, {"key": "Session Management, QoS and interaction with PCC functionality", "numbering": "5.4", "title_level": 1, "desc": "5.4  Session Management, QoS and interaction with PCC functionality\n\n\n"}, {"key": "Dedicated bearer activation", "numbering": "5.4.1", "title_level": 2, "desc": "5.4.1  Dedicated bearer activation\n\nThe dedicated bearer activation procedure for a GTP based S5/S8 is depicted\nin figure 5.4.1-1. This procedure shall not be used when the UE is\naccessing over NB-IoT (i.e. RAT Type = NB-IoT).\n\n                                    [pic]\n\n            Figure 5.4.1-1: Dedicated Bearer Activation Procedure\n\n  NOTE\u00c2\u00a01:  Steps 3-10 are common for architecture variants with GTP based\n         S5/S8 and PMIP-based S5/S8. For an PMIP-based S5/S8, procedure\n         steps (A) and (B) are defined in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps 1, 2, 11 and\n         12 concern GTP based S5/S8.\n\n  1. If dynamic PCC is deployed, the PCRF sends a PCC decision provision\n    (QoS policy) message to the PDN GW. This corresponds to the initial\n    steps of the PCRF-Initiated IP-CAN Session Modification procedure or to\n    the PCRF response in the PCEF initiated IP-CAN Session Modification\n    procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6], up to the point that the PDN GW\n    requests IP-CAN Bearer Signalling. The PCC decision provision message\n    may indicate that User Location Information and/or UE Time Zone\n    Information is to be provided to the PCRF as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n    If dynamic PCC is not deployed, the PDN GW may apply local QoS policy.\n\n  2. The PDN GW uses this QoS policy to assign the EPS Bearer QoS, i.e., it\n    assigns the values to the bearer level QoS parameters QCI, ARP, GBR and\n    MBR; see clause 4.7.3. If this dedicated bearer is created as part of\n    the handover procedure from non-3GPP access with GTP-based S2a/S2b,\n    then the PDN GW applies the Charging Id already in use for the\n    corresponding dedicated bearer while the UE was in non-3GPP access (i.e\n    bearer with the same QCI and ARP as in non-3GPP access). Otherwise, the\n    PDN GW generates a Charging Id for the dedicated bearer. The PDN GW\n    sends a Create Bearer Request message (IMSI, PTI, EPS Bearer QoS,\n    Maximum Packet Loss Rate (UL, DL), TFT, S5/S8 TEID, Charging Id, LBI,\n    Protocol Configuration Options) to the Serving GW, the Linked EPS\n    Bearer Identity (LBI) is the EPS Bearer Identity of the default bearer.\n    The Procedure Transaction Id (PTI) parameter is only used when the\n    procedure was initiated by a UE Requested Bearer Resource Modification\n    Procedure - see clause 5.4.5. Protocol Configuration Options may be\n    used to transfer application level parameters between the UE and the\n    PDN GW (see TS\u00c2\u00a023.228\u00c2\u00a0[52]), and are sent transparently through the MME\n    and the Serving GW.\n\n  NOTE\u00c2\u00a02:  The PCO is sent in the dedicated bearer activation procedure\n         either in response to a PCO received from the UE, or without the\n         need to send a response to a UE provided PCO e.g. when the network\n         wants the bearer to be dedicated for IMS signalling.\n\n     For a QCI=1 bearer, the Maximum Packet Loss Rate (UL, DL) may be\n    provided by the PDN GW as described in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  3. The Serving GW sends the Create Bearer Request (IMSI, PTI, EPS Bearer\n    QoS, Maximum Packet Loss Rate (UL, DL), TFT, S1-TEID, PDN GW TEID (GTP-\n    based S5/S8), LBI, Protocol Configuration Options) message to the MME.\n    If the UE is in ECM-IDLE state the MME will trigger the Network\n    Triggered Service Request from step 3 (which is specified in clause\n    5.3.4.3). In that case the following steps 4-7 may be combined into\n    Network Triggered Service Request procedure or be performed stand-\n    alone. The MME checks if the UE can support the establishment of\n    additional user plane radio bearer based on the maximum number of user\n    plane radio bearers indicated by NB-IoT UE in the UE Network Capability\n    IE as defined in clause\u00c2\u00a05.11.3 and for WB-E-UTRAN in clause\u00c2\u00a04.12.\n\n     If the UE is in ECM-IDLE state and extended idle mode DRX is enabled\n    for the UE, the MME will trigger Network Triggered Service Request from\n    step\u00c2\u00a03 (which is specified in clause\u00c2\u00a05.3.4.3), and start a timer which\n    is configured to a value smaller than the GTP re-transmission timer. If\n    the MME receives no response from the UE before the timer expires, the\n    MME sends a Create Bearer Response with a rejection cause indicating\n    that the UE is temporarily not reachable due to power saving and, if a\n    Delay Tolerant Connection indication was set for the PDN connection,\n    the MME sets the internal flag Pending Network Initiated PDN Connection\n    Signalling. The rejection is forwarded by the Serving GW to the PDN GW.\n    In this case, the steps 4-11 are skipped.\n\n  NOTE\u00c2\u00a03:  If ISR is activated and the Serving GW does not have a downlink\n         S1-U and the SGSN has notified the Serving GW that the UE has moved\n         to PMM-IDLE or STANDBY state, the Serving GW sends Downlink Data\n         Notification to trigger MME and SGSN to page the UE (as specified\n         in clause\u00c2\u00a05.3.4.3) before sending the Create Bearer Request\n         message.\n\n  4. The MME selects an EPS Bearer Identity, which has not yet been\n    assigned to the UE. The MME then builds a Session Management Request\n    including the PTI, TFT, EPS Bearer QoS parameters (excluding ARP),\n    Protocol Configuration Options, the EPS Bearer Identity, the Linked EPS\n    Bearer Identity (LBI) and a WLAN offloadability indication. If the UE\n    has UTRAN or GERAN capabilities and the network supports mobility to\n    UTRAN or GERAN, the MME uses the EPS bearer QoS parameters to derive\n    the corresponding PDP context parameters QoS Negotiated (R99 QoS\n    profile), Radio Priority, Packet Flow Id and TI and includes them in\n    the Session Management Request. If the UE indicated in the UE Network\n    Capability it does not support BSS packet flow procedures, then the MME\n    shall not include the Packet Flow Id. The MME then signals the Bearer\n    Setup Request (EPS Bearer Identity, EPS Bearer QoS, Maximum Packet Loss\n    Rate (UL, DL), Session Management Request, S1-TEID) message to the\n    eNodeB.\n\n     The MME may include an indication whether the traffic of this PDN\n    Connection is allowed to be offloaded to WLAN as described in\n    clause\u00c2\u00a04.3.23.\n\n  5. The eNodeB maps the EPS Bearer QoS to the Radio Bearer QoS. It then\n    signals a RRC Connection Reconfiguration (Radio Bearer QoS, Session\n    Management Request, EPS RB Identity) message to the UE. The UE shall\n    store the QoS Negotiated, Radio Priority, Packet Flow Id and TI, which\n    it received in the Session Management Request, for use when accessing\n    via GERAN or UTRAN. The UE NAS stores the EPS Bearer Identity and links\n    the dedicated bearer to the default bearer indicated by the Linked EPS\n    Bearer Identity (LBI). The UE uses the uplink packet filter (UL TFT) to\n    determine the mapping of traffic flows to the radio bearer. The UE may\n    provide the EPS Bearer QoS parameters to the application handling the\n    traffic flow. The application usage of the EPS Bearer QoS is\n    implementation dependent. The UE shall not reject the RRC Connection\n    Reconfiguration on the basis of the EPS Bearer QoS parameters contained\n    in the Session Management Request.\n\n  NOTE\u00c2\u00a04:  How the eNB uses the Maximum Packet Loss Rate (UL, DL) for\n         handover threshold decision, if provided, is out of scope of 3GPP\n         specifications.\n\n  NOTE\u00c2\u00a05:  The details of the Radio Bearer QoS are specified in\n         TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n  6. The UE acknowledges the radio bearer activation to the eNodeB with a\n    RRC Connection Reconfiguration Complete message.\n\n  7. The eNodeB acknowledges the bearer activation to the MME with a Bearer\n    Setup Response (EPS Bearer Identity, S1-TEID) message. The eNodeB\n    indicates whether the requested EPS Bearer QoS could be allocated or\n    not.\n\n     The MME shall be prepared to receive this message either before or\n    after the Session Management Response message (sent in step\u00c2\u00a09).\n\n  8. The UE NAS layer builds a Session Management Response including EPS\n    Bearer Identity. The UE then sends a Direct Transfer (Session\n    Management Response) message to the eNodeB.\n\n  9. The eNodeB sends an Uplink NAS Transport (Session Management Response)\n    message to the MME.\n\n  10.  Upon reception of the Bearer Setup Response message in step 7 and\n    the Session Management Response message in step 9, the MME acknowledges\n    the bearer activation to the Serving GW by sending a Create Bearer\n    Response (EPS Bearer Identity, S1-TEID, User Location Information\n    (ECGI)) message.\n\n  11.  The Serving GW acknowledges the bearer activation to the PDN GW by\n    sending a Create Bearer Response (EPS Bearer Identity, S5/S8-TEID, User\n    Location Information (ECGI)) message.\n\n  12.  If the dedicated bearer activation procedure was triggered by a PCC\n    Decision Provision message from the PCRF, the PDN GW indicates to the\n    PCRF whether the requested PCC decision (QoS policy) could be enforced\n    or not, allowing the completion of the PCRF-Initiated IP-CAN Session\n    Modification procedure or the PCEF initiated IP-CAN Session\n    Modification procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6], after the\n    completion of IP-CAN bearer signalling. If requested by the PCRF the\n    PDN\u00c2\u00a0GW indicates User Location Information and/or UE Time Zone\n    Information to the PCRF as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n     If the dedicated bearer activation is rejected with a cause indicating\n    that the UE is temporarily not reachable due to power saving, then the\n    PDN GW re-attempts the same procedure after it receives the indication\n    that the is UE available for end to end signalling in the subsequent\n    Modify Bearer Request message.\n\n  NOTE\u00c2\u00a06:  The exact signalling of step 1 and 12 (e.g. for local break-out)\n         is outside the scope of this specification. This signalling and its\n         interaction with the dedicated bearer activation procedure are to\n         be specified in TS\u00c2\u00a023.203\u00c2\u00a0[6]. Steps 1 and 12 are included here\n         only for completeness.\n\n\n"}, {"key": "Bearer modification with bearer QoS update", "numbering": "5.4.2", "title_level": 2, "desc": "5.4.2  Bearer modification with bearer QoS update\n\n\n"}, {"key": "PDN GW initiated bearer modification with bearer QoS update", "numbering": "5.4.2.1", "title_level": 3, "desc": "5.4.2.1  PDN GW initiated bearer modification with bearer QoS update\n\nThe PDN\u00c2\u00a0GW initiated bearer modification procedure (including EPS Bearer\nQoS update) for a GTP based S5/S8 is depicted in figure 5.4.2.1-1. This\nprocedure is used in cases when one or several of the EPS Bearer QoS\nparameters QCI, GBR, MBR or ARP are modified (including the QCI or the ARP\nof the default EPS bearer e.g. due to the HSS Initiated Subscribed QoS\nModification procedure, as described in clause\u00c2\u00a05.4.2.2) or to modify the\nAPN-AMBR. Modification from a QCI of resource type non-GBR to a QCI of\nresource type GBR and vice versa is not supported by this procedure.\n\n  NOTE\u00c2\u00a01:  The QCI of an existing dedicated bearer should only be modified\n         if no additional bearer can be established with the desired QCI.\n\n                                    [pic]\n\n   Figure 5.4.2.1-1: Bearer Modification Procedure with Bearer QoS Update\n\n  NOTE\u00c2\u00a02:  Steps 3-10 are common for architecture variants with GTP based\n         S5/S8 and PMIP-based S5/S8. For a PMIP-based S5/S8, procedure steps\n         (A) and (B) are defined in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps 1, 2, 11 and 12\n         concern GTP based S5/S8.\n\n  1. If dynamic PCC is deployed, the PCRF sends a PCC decision provision\n    (QoS policy) message to the PDN GW. This corresponds to the initial\n    steps of the PCRF-Initiated IP-CAN Session Modification procedure or to\n    the PCRF response in the PCEF initiated IP-CAN Session Modification\n    procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6], up to the point that the PDN GW\n    requests IP-CAN Bearer Signalling. The PCC decision provision message\n    may indicate that User Location Information and/or UE Time Zone\n    Information is to be provided to the PCRF as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n    If dynamic PCC is not deployed, the PDN GW may apply local QoS policy.\n\n  2. The PDN GW uses this QoS policy to determine that the authorized QoS\n    of a service data flow has changed or that a service data flow shall be\n    aggregated to or removed from an active bearer. The PDN GW generates\n    the TFT and updates the EPS Bearer QoS to match the traffic flow\n    aggregate. The PDN GW then sends the Update Bearer Request (PTI, EPS\n    Bearer Identity, EPS Bearer QoS, APN-AMBR, TFT, Maximum Packet Loss\n    Rate (UL, DL)) message to the Serving GW. The Procedure Transaction Id\n    (PTI) parameter is used when the procedure was initiated by a UE\n    Requested Bearer Resource Modification Procedure - see clause\u00c2\u00a05.4.5.\n    For APN-AMBR, the EPS bearer identity must refer to a non-GBR bearer.\n\n     For a QCI=1 bearer, the Maximum Packet Loss Rate (UL, DL) may be\n    provided by the PDN GW as described in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  3. The Serving GW sends the Update Bearer Request (PTI, EPS Bearer\n    Identity, EPS Bearer QoS, TFT, APN-AMBR, Maximum Packet Loss Rate (UL,\n    DL)) message to the MME. If the UE is in ECM-IDLE state the MME will\n    trigger the Network Triggered Service Request from step\u00c2\u00a03 (which is\n    specified in clause\u00c2\u00a05.3.4.3). In that case the following steps\u00c2\u00a04-7 may\n    be combined into Network Triggered Service Request procedure or be\n    performed stand-alone. If only the QoS parameter ARP is modified and if\n    the UE is in ECM IDLE state the MME shall skip the Network Triggered\n    Service Request. In that case the following steps 4-9 are also skipped\n    and the MME sends an Update Bearer Response to the Serving GW.\n\n     If extended idle mode DRX is enabled for the UE, the MME will trigger\n    Network Triggered Service Request from step\u00c2\u00a03 (which is specified in\n    clause\u00c2\u00a05.3.4.3), and start a timer which is configured to a value\n    smaller than the GTP re-transmission timer. If the MME receives no\n    response from the UE before the timer expires, the MME sends an Update\n    Bearer Response with a rejection cause indicating that the UE is\n    temporarily not reachable due to power saving and, if a Delay Tolerant\n    Connection indication was set for the PDN connection, the MME sets the\n    internal flag Pending Network Initiated PDN Connection Signalling. The\n    rejection is forwarded by the Serving GW to the PDN GW. In this case,\n    the steps 4-11 are skipped.\n\n  NOTE\u00c2\u00a03:  If ISR is activated and the Serving GW does not have a downlink\n         S1-U and the SGSN has notified the Serving GW that the UE has moved\n         to PMM-IDLE or STANDBY state, the Serving GW sends Downlink Data\n         Notification to trigger MME and SGSN to page the UE (as specified\n         in clause\u00c2\u00a05.3.4.3) before sending the Update Bearer Request\n         message.\n\n  4. The MME builds a Session Management Request including the PTI, EPS\n    Bearer QoS parameters (excluding ARP), TFT, APN-AMBR, EPS Bearer\n    Identity and a WLAN offloadability indication. If the UE has UTRAN or\n    GERAN capabilities and the network supports mobility to UTRAN or GERAN,\n    the MME uses the EPS Bearer QoS parameters to derive the corresponding\n    PDP context parameters QoS Negotiated (R99 QoS profile), Radio Priority\n    and Packet Flow Id and includes them in the Session Management Request.\n    If the UE indicated in the UE Network Capability it does not support\n    BSS packet flow procedures, then the MME shall not include the Packet\n    Flow Id. If the APN-AMBR has changed the MME may update the UE-AMBR if\n    appropriate. The MME then sends the Bearer Modify Request (EPS Bearer\n    Identity, EPS Bearer QoS, Session Management Request, UE-AMBR, Maximum\n    Packet Loss Rate (UL, DL)) message to the eNodeB.\n\n     The MME may include an indication whether the traffic of this PDN\n    Connection is allowed to be offloaded to WLAN as described in\n    clause\u00c2\u00a04.3.23.\n\n  5. The eNodeB maps the modified EPS Bearer QoS to the Radio Bearer QoS.\n    It then signals a RRC Connection Reconfiguration (Radio Bearer QoS,\n    Session Management Request, EPS RB Identity) message to the UE. The UE\n    shall store the QoS Negotiated, Radio Priority, Packet Flow Id, which\n    it received in the Session Management Request, for use when accessing\n    via GERAN or UTRAN. If the APN-AMBR has changed, the UE stores the\n    modified APN-AMBR value and sets the MBR parameter of the corresponding\n    non-GBR PDP contexts (of this PDN connection) to the new value. The UE\n    uses the uplink packet filter (UL TFT) to determine the mapping of\n    traffic flows to the radio bearer. The UE may provide EPS Bearer QoS\n    parameters to the application handling the traffic flow(s). The\n    application usage of the EPS Bearer QoS is implementation dependent.\n    The UE shall not reject the Radio Bearer Modify Request on the basis of\n    the EPS Bearer QoS parameters contained in the Session Management\n    Request. The UE shall set its TIN to \"GUTI\" if the modified EPS bearer\n    was established before ISR activation.\n\n  NOTE\u00c2\u00a04:  The details of the Radio Bearer QoS are specified in\n         TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n  6. The UE acknowledges the radio bearer modification to the eNodeB with a\n    RRC Connection Reconfiguration Complete message.\n\n  7. The eNodeB acknowledges the bearer modification to the MME with a\n    Bearer Modify Response (EPS Bearer Identity) message. With this\n    message, the eNodeB indicates whether the requested EPS Bearer QoS\n    could be allocated or not.\n\n     The MME shall be prepared to receive this message either before or\n    after the Session Management Response message (sent in step\u00c2\u00a09).\n\n  8. The UE NAS layer builds a Session Management Response including EPS\n    Bearer Identity. The UE then sends a Direct Transfer (Session\n    Management Response) message to the eNodeB.\n\n  9. The eNodeB sends an Uplink NAS Transport (Session Management Response)\n    message to the MME.\n\n  10.  Upon reception of the Bearer Modify Response message in step 7 and\n    the Session Management Response message in step 9, the MME acknowledges\n    the bearer modification to the Serving GW by sending an Update Bearer\n    Response (EPS Bearer Identity, User Location Information (ECGI))\n    message.\n\n  11.  The Serving GW acknowledges the bearer modification to the PDN GW by\n    sending an Update Bearer Response (EPS Bearer Identity, User Location\n    Information (ECGI)) message.\n\n  12.  If the Bearer modification procedure was triggered by a PCC Decision\n    Provision message from the PCRF, the PDN GW indicates to the PCRF\n    whether the requested PCC decision (QoS policy) could be enforced or\n    not by sending a Provision Ack message allowing the completion of the\n    PCRF-Initiated IP-CAN Session Modification procedure or the PCEF\n    initiated IP-CAN Session Modification procedure as defined in\n    TS\u00c2\u00a023.203\u00c2\u00a0[6], after the completion of IP-CAN bearer signalling. If\n    requested by the PCRF the PDN\u00c2\u00a0GW indicates User Location Information\n    and/or UE Time Zone Information to the PCRF as defined in\n    TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n     If the Bearer modification is rejected with a cause indicating that\n    the UE is temporarily not reachable due to power saving, then the PDN\n    GW re-attempts the same procedure after it receives the indication that\n    the is UE available for end to end signalling in the subsequent Modify\n    Bearer Request message.\n\n  NOTE\u00c2\u00a05:  The exact signalling of step 1 and 12 (e.g. for local break-out)\n         is outside the scope of this specification. This signalling and its\n         interaction with the bearer activation procedure are to be\n         specified in TS\u00c2\u00a023.203\u00c2\u00a0[6]. Steps 1 and 12 are included here only\n         for completeness.\n\n\n"}, {"key": "HSS Initiated Subscribed QoS Modification", "numbering": "5.4.2.2", "title_level": 3, "desc": "5.4.2.2  HSS Initiated Subscribed QoS Modification\n\nThe HSS Initiated Subscribed QoS Modification for a GTP-based S5/S8 is\ndepicted in figure 5.4.2.2-1.\n\n                                    [pic]\n\n         Figure 5.4.2.2-1: HSS Initiated Subscribed QoS Modification\n\n  NOTE\u00c2\u00a01:  For a PMIP-based S5/S8, procedure steps (A) and steps (B) are\n         defined in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps\u00c2\u00a03, 4, 5, 7 and 8 concern GTP based\n         S5/S8.\n\n  1. The HSS sends an Insert Subscriber Data (IMSI, Subscription Data)\n    message to the MME. The Subscription Data includes EPS subscribed QoS\n    (QCI, ARP) and the subscribed UE-AMBR and APN-AMBR.\n\n  1a.  The MME updates the stored Subscription Data and acknowledges the\n    Insert Subscriber Data message by returning an Insert Subscriber Data\n    Ack (IMSI) message to the HSS (see clause\u00c2\u00a05.3.9.2).\n\n  2a If only the subscribed UE-AMBR has been modified, the MME calculates a\n    new UE-AMBR value as described in clause\u00c2\u00a04.7.3 and may then signal a\n    modified UE-AMBR value to the eNodeB by using S1-AP UE Context\n    Modification Procedure. The HSS Initiated Subscribed QoS Modification\n    Procedure ends after completion of the UE Context Modification\n    Procedure.\n\n  2b.  If the QCI and/or ARP and/or subscribed APN-AMBR has been modified\n    and there is related active PDN connection with the modified QoS\n    Profile the MME sends the Modify Bearer Command (EPS Bearer Identity,\n    EPS Bearer QoS, APN-AMBR) message to the Serving GW. The EPS Bearer\n    Identity identifies the default bearer of the affected PDN connection.\n    The EPS Bearer QoS contains the EPS subscribed QoS profile to be\n    updated.\n\n  3. The Serving GW sends the Modify Bearer Command (EPS Bearer Identity,\n    EPS Bearer QoS, APN-AMBR) message to the PDN GW.\n\n  4. If PCC infrastructure is deployed, the PDN GW informs the PCRF about\n    the updated EPS Bearer QoS and APN-AMBR. The PCRF sends new updated PCC\n    decision to the PDN GW. This corresponds to the PCEF-initiated IP-CAN\n    Session Modification procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n     The PCRF may modify the APN-AMBR and the QoS parameters (QCI and ARP)\n    associated with the default bearer in the response to the PDN GW as\n    defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  5. The PDN GW modifies the default bearer of each PDN connection\n    corresponding to the APN for which subscribed QoS has been modified. If\n    the subscribed ARP parameter has been changed, the PDN\u00c2\u00a0GW shall also\n    modify all dedicated EPS bearers having the previously subscribed ARP\n    value unless superseded by PCRF decision. The PDN GW then sends the\n    Update Bearer Request (EPS Bearer Identity, EPS Bearer QoS, TFT, APN-\n    AMBR) message to the Serving GW.\n\n  NOTE\u00c2\u00a02:  As no PTI is included the MME use protocol specific details, as\n         described in TS\u00c2\u00a029.274\u00c2\u00a0[43], to determine if the Update Bearer\n         Request was triggered by this procedure or not.\n\n  6. If the QCI and/or ARP parameter(s) have been modified, steps 3 to 10,\n    as described in clause\u00c2\u00a05.4.2.1, Figure 5.4.2.1-1, are invoked. If\n    neither the QCI nor the ARP have been modified, but instead only the\n    APN-AMBR was updated, steps 3 to 8, as described in clause\u00c2\u00a05.4.3,\n    Figure 5.4.3-1, are invoked.\n\n  7. The Serving GW acknowledges the bearer modification to the PDN GW by\n    sending an Update Bearer Response (EPS Bearer Identity, User Location\n    Information (ECGI)) message. If the bearer modification fails the PDN\n    GW deletes the concerned EPS Bearer.\n\n  8. The PDN GW indicates to the PCRF whether the requested PCC decision\n    was enforced or not by sending a Provision Ack message.\n\n\n"}, {"key": "PDN GW initiated bearer modification without bearer QoS update", "numbering": "5.4.3", "title_level": 2, "desc": "5.4.3  PDN GW initiated bearer modification without bearer QoS update\n\nThe bearer modification procedure without bearer QoS update is used to\nupdate the TFT for an active default or dedicated bearer, to modify the APN-\nAMBR, to retrieve User Location from the MME, to inform PCO to UE or to\ninstruct the MME (e.g. to activate/deactivate the location reporting).\n\nThe procedure for a GTP based S5/S8 is depicted in figure 5.4.3-1. In this\nprocedure there is no need to update the underlying radio bearer(s). This\nprocedure may be triggered if the APN-AMBR is changed by the PCRF/PDN GW.\n\n                                    [pic]\n\n   Figure 5.4.3-1: Bearer Modification Procedure without Bearer QoS Update\n\n  NOTE\u00c2\u00a01:  Steps 3-8 are common for architecture variants with GTP based\n         S5/S8 and PMIP-based S5/S8. For an PMIP-based S5/S8, procedure\n         steps (A) and (B) are defined in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps 1, 2, 9 and\n         10 concern GTP based S5/S8. Steps\u00c2\u00a03-8 may also be used within the\n         HSS Initiated Subscribed QoS Modification.\n\n  1. If dynamic PCC is deployed, the PCRF sends a PCC decision provision\n    (QoS policy) message to the PDN GW. This corresponds to the beginning\n    of the PCRF-initiated IP-CAN Session Modification procedure or to the\n    PCRF response in the PCEF initiated IP-CAN Session Modification\n    procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6], up to the point that the PDN GW\n    requests IP-CAN Bearer Signalling. The PCC decision provision message\n    may indicate that User Location Information and/or UE Time Zone\n    Information is to be provided to the PCRF as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n    If dynamic PCC is not deployed, the PDN GW may apply local QoS policy.\n\n  2. The PDN GW uses this QoS policy to determine that a service data flow\n    shall be aggregated to or removed from an active bearer. The PDN GW\n    generates the TFT and determines that no update of the EPS Bearer QoS\n    is needed. The PDN GW then sends the Update Bearer Request (PTI, EPS\n    Bearer Identity, APN-AMBR, TFT, Retrieve Location) message to the\n    Serving GW. The Procedure Transaction Id (PTI) parameter is used when\n    the procedure was initiated by a UE Requested Bearer Resource\n    Modification procedure - see clause\u00c2\u00a05.4.5. \"Retrieve Location\" is\n    indicated if requested by the PCRF. If the PDN GW initiated bearer\n    modification procedure was triggered by a UE requested bearer resource\n    modification procedure and if 3GPP PS Data Off UE Status was present in\n    the Bearer Resource Command PCO, the PDN GW shall include the 3GPP PS\n    Data Off Support Indication in the Update Bearer Request PCO.\n\n  3. The Serving GW sends the Update Bearer Request (PTI, EPS Bearer\n    Identity, APN-AMBR, TFT, Retrieve Location) message to the MME. If the\n    UE is in ECM-IDLE state (and extended idle mode DRX is not enabled) the\n    MME will trigger the Network Triggered Service Request from step 3\n    (which is specified in clause 5.3.4.3). In that case the following\n    steps 4-7 may be combined into Network Triggered Service Request\n    procedure or be performed stand-alone. If both the PCO and the TFT are\n    absent and the APN-AMBR has not been modified, the MME shall skip the\n    following steps 4-7.\n\n     If the UE is in ECM-IDLE state and extended idle mode DRX is enabled\n    for the UE, the MME will trigger Network Triggered Service Request from\n    step\u00c2\u00a03 (which is specified in clause\u00c2\u00a05.3.4.3), , and start a timer\n    which is configured to a value smaller than the GTP re-transmission\n    timer . If the MME receives no response from the UE before the timer\n    expires, the MME sends an Update Bearer Response with a rejection cause\n    indicating that UE is temporarily not reachable due to power saving and\n    then sets the internal flag Pending Network Initiated PDN Connection\n    Signalling. The rejection is forwarded by the Serving GW to the PDN GW.\n    In this case, the steps 4-9 are skipped.\n\n  NOTE\u00c2\u00a02:  If ISR is activated and the Serving GW does not have a downlink\n         S1-U and the SGSN has notified the Serving GW that the UE has moved\n         to PMM-IDLE or STANDBY state, the Serving GW sends Downlink Data\n         Notification to trigger MME and SGSN to page the UE (as specified\n         in clause\u00c2\u00a05.3.4.3) before sending the Update Bearer Request\n         message.\n\n  NOTE\u00c2\u00a03:  The PCO can be set by the PDN GW in accordance with the\n         TS\u00c2\u00a023.380\u00c2\u00a0[75].\n\n  4. The MME builds a Session Management Request message including the TFT,\n    APN-AMBR, EPS Bearer Identity and a WLAN offloadability indication. The\n    MME then sends a Downlink NAS Transport (Session Management\n    Configuration) message to the eNodeB. If the APN AMBR has changed, the\n    MME may also update the UE AMBR. And if the UE-AMBR is updated, the MME\n    signal a modified UE-AMBR value to the eNodeB by using S1-AP UE Context\n    Modification Procedure.\n\n     The MME may include an indication whether the traffic of this PDN\n    Connection is allowed to be offloaded to WLAN as described in\n    clause\u00c2\u00a04.3.23.\n\n  5. The eNodeB sends the Direct Transfer (Session Management Request)\n    message to the UE. The UE uses the uplink packet filter (UL TFT) to\n    determine the mapping of traffic flows to the radio bearer. The UE\n    stores the modified APN-AMBR value and sets the MBR parameter of the\n    corresponding non-GBR PDP contexts (of this PDN connection) to the new\n    value. The UE shall set its TIN to \"GUTI\" if the modified EPS bearer\n    was established before ISR activation.\n\n  6. The UE NAS layer builds a Session Management Response including EPS\n    Bearer Identity. The UE then sends a Direct Transfer (Session\n    Management Response) message to the eNodeB.\n\n  7. The eNodeB sends an Uplink NAS Transport (Session Management Response)\n    message to the MME.\n\n  8. If the procedure is performed without steps 4-7 and location retrieval\n    is requested and the UE is ECM_CONNECTED and unless the MME is\n    configured not to retrieve ECGI from the eNodeB under this condition,\n    the MME uses the Location Reporting Procedure described in clause\u00c2\u00a05.9.1\n    to retrieve the ECGI from the eNodeB. The MME acknowledges the bearer\n    modification to the Serving GW by sending an Update Bearer Response\n    (EPS Bearer Identity, User Location Information (ECGI)) message. The\n    MME includes the last known User Location information.\n\n  NOTE\u00c2\u00a04:  Based on operator policy and local regulation the MME may,\n         instead of using the Location Reporting Procedure described in\n         clause\u00c2\u00a05.9.1 to retrieve the ECGI from the eNodeB, use the last\n         known User Location information obtained from e.g. attach\n         procedure, tracking area update procedure, etc.\n\n  9. The Serving GW acknowledges the bearer modification to the PDN GW by\n    sending an Update Bearer Response (EPS Bearer Identity, User Location\n    Information (ECGI)) message.\n\n  10.  If the bearer modification procedure was triggered by a PCC Decision\n    Provision message from the PCRF, the PDN GW indicates to the PCRF\n    whether the requested PCC decision (QoS policy) could be enforced or\n    not by sending a Provision Ack message. This then allows the PCRF-\n    Initiated IP-CAN Session Modification procedure or the PCEF initiated\n    IP-CAN Session Modification procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6] to\n    continue and eventually conclude, proceeding after the completion of IP-\n    CAN bearer signalling. If requested by the PCRF the PDN\u00c2\u00a0GW indicates\n    User Location Information and/or UE Time Zone Information to the PCRF\n    as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n     If the bearer modification is rejected with a cause indicating that\n    the UE is temporarily not reachable due to power saving, then the PDN\n    GW re-attempts the same procedure after it receives the indication that\n    the is UE available for end to end signalling in the subsequent Modify\n    Bearer Request message.\n\n  NOTE\u00c2\u00a05:  The exact signalling of step 1 and 10 (e.g. for local break-out)\n         is outside the scope of this specification. This signalling and its\n         interaction with the bearer activation procedure are to be\n         specified in TS\u00c2\u00a023.203\u00c2\u00a0[6]. Steps 1 and 10 are included here only\n         for completeness.\n\n\n"}, {"key": "Bearer deactivation", "numbering": "5.4.4", "title_level": 2, "desc": "5.4.4  Bearer deactivation\n\n\n"}, {"key": "PDN GW initiated bearer deactivation", "numbering": "5.4.4.1", "title_level": 3, "desc": "5.4.4.1  PDN GW initiated bearer deactivation\n\nThe bearer deactivation procedure for a GTP based S5/S8 is depicted in\nfigure 5.4.4.1-1. This procedure can be used to deactivate a dedicated\nbearer or deactivate all bearers belonging to a PDN address. If the default\nbearer belonging to a PDN connection is deactivated, the PDN GW deactivates\nall bearers belonging to the PDN connection.\n\nWhen the last bearer belonging to the last PDN connection of a given APN is\nreleased, the PGW may forward to the MME the APN Rate Control Status for\nstoring it in the MM context according to clause\u00c2\u00a04.7.7.3.\n\n                                    [pic]\n\n           Figure 5.4.4.1-1: PDN GW Initiated Bearer Deactivation\n\n  NOTE\u00c2\u00a01:  Steps 3-8 are common for architecture variants with GTP based\n         S5/S8 and PMIP-based S5/S8. For an PMIP-based S5/S8, procedure\n         steps (A) and (B) are defined in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps 1, 2, 9 and\n         10 concern GTP-based S5/S8.\n\n  1. If dynamic PCC is not deployed, the PDN GW is triggered to initiate\n    the Bearer Deactivation procedure due either a QoS policy or on request\n    from the MME (as outlined in clause 5.4.4.2) or on intra-node\n    signalling request from the HeNB to release the LIPA PDN Connection.\n    Optionally, the PCRF sends QoS policy to the PDN GW. This corresponds\n    to the initial steps of the PCRF-initiated IP-CAN Session Modification\n    procedure or the response to the PCEF initiated IP-CAN Session\n    Modification procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6], up to the point\n    that the PDN GW requests IP-CAN Bearer Signalling. The PCC decision\n    provision message may indicate that User Location Information and/or UE\n    Time Zone Information is to be provided to the PCRF as defined in\n    TS\u00c2\u00a023.203\u00c2\u00a0[6]. If dynamic PCC is not deployed, the PDN GW may apply\n    local QoS policy. The PDN GW initiated Bearer deactivation is also\n    performed when handovers occur from 3GPP to non-3GPP, in which case,\n    the default bearer and all the dedicated bearers associated with the\n    PDN address are released, but the PDN address is kept in the PDN GW.\n\n     For an emergency PDN connection the PDN GW initiates the deactivation\n    of all bearers of that emergency PDN connection when the PDN connection\n    is inactive (i.e. not transferring any packets) for a configured period\n    of time or when triggered by dynamic PCC.\n\n     For an PDN connection established towards the APN dedicated for\n    Restricted Local Operator Services, the PDN GW initiates the\n    deactivation of all bearers of the PDN connection per local operator\n    policy e.g when the duration of such PDN connection reaches a pre-\n    configured period of time.\n\n  2. The PDN GW sends a Delete Bearer Request (PTI, EPS Bearer Identity,\n    Causes and, optionally, APN Rate Control Status according to\n    clause\u00c2\u00a04.7.7.3) message to the Serving GW. The Procedure Transaction Id\n    (PTI) parameter in this step and in the following steps is only used\n    when the procedure was initiated by a UE Requested Bearer Resource\n    Modification Procedure - see clause\u00c2\u00a05.4.5. This message can include an\n    indication that all bearers belonging to that PDN connection shall be\n    released. The PDN GW includes 'Cause' IE in the Delete Bearer Request\n    message and sets the IE to 'RAT changed from 3GPP to Non-3GPP' if the\n    Delete Bearer Request message is caused by a handover from 3GPP to non-\n    3GPP.\n\n  3a.  The Serving GW sends the Delete Bearer Request (PTI, EPS Bearer\n    Identity, Cause and, optionally, APN Rate Control Status) message to\n    the MME. This message can include an indication that all bearers\n    belonging to that PDN connection shall be released.\n\n  3b.  If ISR is activated, the Serving GW sends the Delete Bearer Request\n    (PTI, EPS Bearer Identity, Cause) message to the SGSN. This message can\n    include an indication that all bearers belonging to that PDN connection\n    shall be released, and the SGSN releases all bearer resources of the\n    PDN connection.\n\n  NOTE\u00c2\u00a02:  If all the bearers belonging to a UE are released due to a\n         handover from 3GPP to non-3GPP, the SGSN changes the MM state of\n         the UE to IDLE (GERAN network) or PMM-DETACHED (UTRAN network).\n\n     If ISR is activated, upon receiving Delete Bearer Request from SGW for\n    the last PDN connection for a given UE, MME shall locally de-activate\n    ISR.\n\n  NOTE\u00c2\u00a03:  In this case, SGSN locally de-activates ISR as well (see\n         TS\u00c2\u00a023.060\u00c2\u00a0[7]).\n\n     If received, the MME stores the APN Rate Control Status in the MM\n    context.\n\nSteps 4 to 7 are not performed if at least one of the following three\nconditions is fulfilled:\n\n  (i)  The UE is in ECM-IDLE and the last PDN connection of the UE is not\n    being deleted and the Delete Bearer Request received from the Serving\n    GW does not contain the cause \"reactivation requested\", which has been\n    sent from the PDN GW;\n\n  (ii) UE is in ECM-IDLE and the last PDN connection is deleted due to ISR\n    deactivation;\n\n  (iii)  UE is in ECM-IDLE and the last PDN connection is deleted in 3GPP\n    due to handover to non-3GPP access.\n\nWhen steps 4 to 7 are not performed, the EPS bearer state is synchronized\nbetween the UE and the network at the next ECM-IDLE to ECM-CONNECTED\ntransition (e.g. Service Request or TAU procedure).\n\n  4a.  If the last PDN connection of a UE that does not support \"Attach\n    without PDN connectivity\" is being released and the bearer deletion is\n    neither due to ISR deactivation nor due to handover to non-3GPP\n    accesses, the MME explicitly detaches the UE by sending a Detach\n    Request message to the UE. If the UE is in ECM-IDLE state the MME\n    initiates paging via Network Triggered Service Request procedure in\n    clause\u00c2\u00a05.3.4.3 from step\u00c2\u00a03a onwards in order to inform UE of the\n    request. Steps\u00c2\u00a04b to 7b are skipped in this case, and the procedure\n    continues from step\u00c2\u00a07c.\n\n  4b.  If the UE is in ECM-IDLE state and the reason for releasing PDN\n    connection is \"reactivation requested\", the MME initiates paging via\n    Network Triggered Service Request procedure in clause\u00c2\u00a05.3.4.3 from\n    step\u00c2\u00a03a onwards in order to inform UE of the request and step\u00c2\u00a04c is\n    performed after completion of the paging.\n\n  4c.  If the release of the bearer in E-UTRAN has already been signalled\n    to the MME, steps\u00c2\u00a04c to  7 are omitted. Otherwise, if this is not the\n    last PDN connection for the UE which is being released, the MME sends\n    the S1-AP Deactivate Bearer Request (EPS Bearer Identity) message to\n    the eNodeB. The MME builds a NAS Deactivate EPS Bearer Context Request\n    message including the EPS Bearer Identity and a WLAN offloadability\n    indication, and includes it in the S1-AP Deactivate Bearer Request\n    message. When the bearer deactivation procedure was originally\n    triggered by a UE request, the NAS Deactivate EPS Bearer Context\n    Request message includes the PTI.\n\n     The MME may include an indication whether the traffic of this PDN\n    Connection is allowed to be offloaded to WLAN as described in\n    clause\u00c2\u00a04.3.23 if the PDN connection is not released.\n\n  5. The eNodeB sends the RRC Connection Reconfiguration message including\n    the EPS Radio Bearer Identity to release and the NAS Deactivate EPS\n    Bearer Context Request message to the UE.\n\n  6a.  The UE RRC releases the radio bearers indicated in the RRC message\n    in step 5, and indicates the radio bearer status to the UE NAS. Then\n    the UE NAS removes the UL TFTs and EPS Bearer Identity according to the\n    radio bearer status indication from the UE RRC. The UE responds to the\n    RRC Connection Reconfiguration Complete message to the eNodeB.\n\n  6b.  The eNodeB acknowledges the bearer deactivation to the MME with a\n    Deactivate Bearer Response (EPS Bearer Identity, ECGI, TAI, PSCell ID,\n    Secondary RAT usage data) message. If the PLMN has configured secondary\n    RAT usage reporting and the eNodeB has Secondary RAT usage data to\n    report, the Secondary RAT usage data is included.\n\n     The PSCell ID is included if Dual Connectivity is active for the UE in\n    the RAN.\n\n     The MME shall be prepared to receive this message either before or\n    after the Session Management Response message sent in step\u00c2\u00a07b, and\n    before or after, any Detach Request message sent in step\u00c2\u00a07c.\n\n  7a The UE NAS layer builds a Deactivate EPS Bearer Context Accept message\n    including EPS Bearer Identity. The UE then sends a Direct Transfer\n    (Deactivate EPS Bearer Context Accept) message to the eNodeB.\n\n  7b.  The eNodeB sends an Uplink NAS Transport (Deactivate EPS Bearer\n    Context Accept) message to the MME.\n\n  7c.  If the UE receives the Detach Request message from the MME in the\n    step 4a, the UE sends a Detach Accept message to the MME any time after\n    step 4a. The eNodeB forwards this NAS message to the MME along with the\n    TAI+ECGI of the cell which the UE is using.\n\n  NOTE\u00c2\u00a04:  The UE may not be able to send this message, e.g. when the UE is\n         out of coverage of E-UTRAN due to mobility to non-3GPP access.\n\n  7a,b,c If Dual Connectivity is active for the UE, the PSCell ID shall be\n    included in the Uplink NAS Transport sent by the eNodeB.\n\n  8a.  After reception of both the Deactivate Bearer Response message in\n    step\u00c2\u00a06b and the Deactivate EPS Bearer Context Accept message in\n    step\u00c2\u00a07b, the MME deletes the bearer context related to the deactivated\n    EPS bearer and acknowledges the bearer deactivation to the Serving GW\n    by sending a Delete Bearer Response (EPS Bearer Identity, User Location\n    Information (ECGI), RAN/NAS Release Cause, Secondary RAT usage data)\n    message. If the MME received Secondary RAT usage data in step\u00c2\u00a06b, the\n    MME shall include it in this message. If extended idle mode DRX is\n    enabled, then the MME acknowledges the bearer deactivation to the\n    Serving GW and at the same time the MME initiates the deactivation\n    towards the UE. If the S1 connection had already been released by the\n    eNB due to radio link failure and the MME receives a Delete Bearer\n    Request while it is still deferring the sending of the S1 release (see\n    clause\u00c2\u00a05.3.5), the MME shall include in the Delete Bearer Response the\n    RAN/NAS Cause received in the S1 Release due to radio link failure\n    procedure.\n\n  8b The SGSN deletes PDP Context related to the deactivated EPS bearer and\n    acknowledges the bearer deactivation to the Serving GW by sending a\n    Delete Bearer Response (EPS Bearer Identity, User Location Information\n    (CGI/SAI)) message. If extended idle mode DRX is enabled, then the SGSN\n    acknowledges the bearer deactivation to the Serving GW and at the same\n    time the SGSN initiates the deactivation towards the UE.\n\n  9. If ISR is activated, after receiving the two Delete Bearer Response\n    messages from the MME and the SGSN, or if ISR is not activated, after\n    receiving the Delete Bearer Response messages from the MME, the Serving\n    GW deletes the bearer context related to the deactivated EPS bearer\n    acknowledges the bearer deactivation to the PDN GW by sending a Delete\n    Bearer Response (EPS Bearer Identity, User Location Information (ECGI\n    or CGI/SAI), Secondary RAT usage data) message. If the MME and/or SGSN\n    sent UE's Location Information and/or UE Time Zone in step\u00c2\u00a08a and/or\n    step\u00c2\u00a08b, the Serving GW includes the User Location Information and/or\n    UE Time Zone Information with the least age in this message. The\n    Serving GW includes the Secondary RAT usage data if it was received in\n    step\u00c2\u00a08a and if PGW secondary RAT usage data reporting is active.\n\n  10.  The PDN GW deletes the bearer context related to the deactivated EPS\n    bearer. If the dedicated bearer deactivation procedure was triggered by\n    receiving a PCC decision message from the PCRF, the PDN GW indicates to\n    the PCRF whether the requested PCC decision was successfully enforced\n    by completing the PCRF-initiated IP-CAN Session Modification procedure\n    or the PCEF initiated IP-CAN Session Modification procedure as defined\n    in TS\u00c2\u00a023.203\u00c2\u00a0[6], proceeding after the completion of IP-CAN bearer\n    signalling. If requested by the PCRF the PDN\u00c2\u00a0GW indicates User Location\n    Information and/or UE Time Zone Information to the PCRF as defined in\n    TS\u00c2\u00a023.203\u00c2\u00a0[6]. If available, the PDN GW shall send RAN/NAS Release\n    Cause to the PCRF as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  11.  If the UE is being explicitly detached, the MME releases the S1-MME\n    signalling connection for the UE by sending an S1 Release Command\n    (Cause) message to the eNodeB. The details of this step are covered in\n    the \"S1 Release Procedure\", as described in clause\u00c2\u00a05.3.5 by step 4 to\n    step\u00c2\u00a06.\n\n  NOTE\u00c2\u00a05:  In the \"S1 Release Procedure\", if Dual Connectivity was active\n         at the time of the release, the eNodeB includes the PSCell ID.\n\n  NOTE\u00c2\u00a06:  The exact signalling of step 1 and 10 (e.g. for local break-out)\n         is outside the scope of this specification. This signalling and its\n         interaction with the dedicated bearer activation procedure are to\n         be specified in TS\u00c2\u00a023.203\u00c2\u00a0[6]. Steps 1 and 10 are included here\n         only for completeness.\n\nIf all the bearers belonging to a UE that does not support \"Attach without\nPDN connectivity\" are released, the MME shall change the MM state of the UE\nto EMM-DEREGISTERED and the MME sends the S1 Release Command to the eNodeB,\nwhich initiates the release of the RRC connection for the given UE if it is\nnot released yet, and returns an S1 Release Complete message to the MME.\n\nIf all bearers of an emergency attached or RLOS attached UE are deactivated\nthe MME may initiate the explicit MME-Initiated Detach procedure.\nRegardless of the outcome of any explicit Detach procedure the MME changes\nthe EMM state of the UE to EMM-DEREGISTERED and the MME sends the S1\nRelease Command to the eNodeB if it is not yet released.\n\nIf the default bearer belonging to a PDN connection is deactivated, the MME\ndetermines the Maximum APN Restriction for the remaining PDN connections\nand stores this new value for the Maximum APN Restriction. In addition if\nISR is activated the SGSN determines the Maximum APN Restriction for the\nremaining bearer contexts and stores this new value for the Maximum APN\nRestriction.\n\n\n"}, {"key": "MME Initiated Dedicated Bearer Deactivation", "numbering": "5.4.4.2", "title_level": 3, "desc": "5.4.4.2  MME Initiated Dedicated Bearer Deactivation\n\nMME initiated Dedicated Bearer Deactivation is depicted in Figure 5.4.4.2-1\nbelow. This procedure deactivates dedicated bearers. Default bearers are\nnot affected. To initiate the release of the full PDN connection including\nthe default bearer, the MME uses the UE or MME requested PDN disconnection\nprocedure defined in clause\u00c2\u00a05.10.3.\n\n                                    [pic]\n\n        Figure 5.4.4.2-1: MME initiated Dedicated Bearer Deactivation\n\n  NOTE\u00c2\u00a01:  For a PMIP-based S5/S8, procedure steps (A) and steps (B) are\n         defined in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps 3, 4, 5 and\u00c2\u00a09 concern GTP based\n         S5/S8\n\n  0. Radio bearers for the UE in the ECM-CONNECTED state may be released\n    due to local reasons (e.g. abnormal resource limitation or radio\n    conditions do not allow the eNodeB to maintain all the allocated GBR\n    bearers: it is not expected that non-GBR bearers are released by the\n    eNodeB unless caused by error situations). The UE deletes the bearer\n    contexts related to the released radio bearers.\n\n  1. When the eNodeB releases radio bearers in step 0, it sends an\n    indication of bearer release to the MME. This indication may be e.g.\n    the Bearer Release Request (EPS Bearer Identity) message to the MME, or\n    alternatively Initial Context Setup Complete, Handover Request Ack and\n    UE Context Response, Path Switch Request may also indicate the release\n    of a bearer.\n\n     The eNodeB includes the ECGI and TAI in the indication sent to the\n    MME. The eNodeB also includes the PSCell ID if Dual Connectivity is\n    active for the UE in the RAN.\n\n     If the PLMN has configured secondary RAT reporting and the eNodeB has\n    Secondary RAT usage data to report, the Secondary RAT usage data is\n    included.\n\n  2. The MME sends the Delete Bearer Command (EPS Bearer Identity, User\n    Location Information, UE Time Zone, RAN/NAS Release Cause if available,\n    Secondary RAT usage data) message per PDN connection to the Serving GW\n    to deactivate the selected dedicated bearer. RAN/NAS Release Cause\n    indicates the RAN release cause and/or the NAS release cause. RAN/NAS\n    Release Cause is only sent by the MME to the PDN GW if this is\n    permitted according to MME operator's policy. If the MME received\n    Secondary RAT usage data in step\u00c2\u00a01, the MME shall include it in this\n    message.\n\n  3. The Serving GW sends the Delete Bearer Command (EPS Bearer Identity,\n    User Location Information, UE Time Zone, RAN/NAS Release Cause,\n    Secondary RAT usage data) message per PDN connection to the PDN\u00c2\u00a0GW. The\n    Serving GW includes the Secondary RAT usage data it in this message if\n    it was received in the previous message and if PGW secondary RAT usage\n    data reporting is active.\n\n  4. If PCC infrastructure is deployed, the PDN GW informs the PCRF about\n    the loss of resources by means of a PCEF-initiated IP-CAN Session\n    Modification procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6] and provides the\n    User Location Information, UE Time Zone and RAN/NAS Release cause (if\n    available) received in the Delete Bearer Command from the S-GW if\n    requested by the PCRF as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6]. The PCRF sends an\n    updated PCC decision to the PDN GW.\n\n  NOTE\u00c2\u00a02:  User Location Information and UE Time Zone might not be\n         available if the MME or the Serving GW are of a previous release\n         and did not provide this information.\n\n  5. The PDN GW sends a Delete Bearer Request (EPS Bearer Identity) message\n    to the Serving GW.\n\n  6. The Serving GW sends the Delete Bearer Request (EPS Bearer Identity)\n    message to the MME.\n\n  7. Steps between steps\u00c2\u00a04 and 7, as described in clause\u00c2\u00a05.4.4.1, are\n    invoked. This is omitted if the bearer deactivation was triggered by\n    the eNodeB in step\u00c2\u00a00 and step\u00c2\u00a01.\n\n     This is also omitted if the MME initiated bearer release due to failed\n    bearer set up during handover, the UE and the MME deactivate the failed\n    contexts locally without peer-to peer ESM signalling.\n\n  8. The MME deletes the bearer contexts related to the deactivated EPS\n    bearer and acknowledges the bearer deactivation to the Serving GW by\n    sending a Delete Bearer Response (EPS Bearer Identity, User Location\n    Information (ECGI), Secondary RAT usage data) message. The MME includes\n    the Secondary RAT usage data if it received this in step\u00c2\u00a07 from the\n    eNodeB.\n\n  9. The Serving GW deletes the bearer context related to the deactivated\n    EPS bearer and acknowledges the bearer deactivation to the PDN GW by\n    sending a Delete Bearer Response (EPS Bearer Identity, Secondary RAT\n    usage data) message. The Serving GW includes the Secondary RAT usage\n    data if it was received in step\u00c2\u00a08 and if PGW secondary RAT usage data\n    reporting is active.\n\n\n"}, {"key": "UE requested bearer resource modification", "numbering": "5.4.5", "title_level": 2, "desc": "5.4.5  UE requested bearer resource modification\n\nThe UE requested bearer resource modification procedure for an E-UTRAN is\ndepicted in figure 5.4.5-1. The procedure allows the UE to request for a\nmodification of bearer resources (e.g. allocation or release of resources)\nfor one traffic flow aggregate with a specific QoS demand. Alternatively,\nthe procedure allows the UE to request for the modification of the packet\nfilters used for an active traffic flow aggregate, without changing QoS. If\naccepted by the network, the request invokes either the Dedicated Bearer\nActivation Procedure, the Bearer Modification Procedure or a dedicated\nbearer is deactivated using the PDN GW Initiated Bearer Deactivation\nProcedure. The procedure is used by the UE when the UE already has a PDN\nconnection with the PDN GW. A UE can send a subsequent Request Bearer\nResource Modification Message before the previous procedure is completed.\nThe UE requested bearer resource modification procedure is used to indicate\nthe change of 3GPP PS Data Off UE Status to the PDN GW via the PCO, only if\nthe UE has been previously informed that the PDN GW supports the 3GPP PS\nData Off feature. When a UE supports only Control Plane CIoT EPS\nOptimisation as defined in clause\u00c2\u00a05.3.4B the UE need not support the UE\nrequested bearer resource modification procedure in order to modify the\ntraffic flow aggregate, as the UE does not support any DRBs. The UE may\nneed to support UE requested bearer resource modification procedure for\nother purposes, e.g. header compression negotiation, see TS\u00c2\u00a024.301\u00c2\u00a0[46].\n\nThe UE supporting 15 EPS bearers as defined in clause\u00c2\u00a04.12 shall not\ninitiate a UE requested bearer resource modification procedure that would\ntrigger the establishment of a new EPS bearer, if it has already 8 EPS\nbearers established and the UE has not received an Indication for support\nof 15 EPS bearers per UE or has received cause #65 \"maximum number of EPS\nbearers reached\".\n\nIn this procedure the UE signals a Traffic Aggregate Description (TAD)\nwhich is a partial TFT, together with a Procedure Transaction Identifier\n(PTI), and an EPS Bearer Identity (when the TAD operation is modify, delete\nor add to an existing packet filter). When the TAD operation is modify or\ndelete, the packet filter identifiers of the TAD are the same as the TFT\npacket filter identifiers of the referenced EPS Bearer (as the\nconcatenation of the TFT packet filter identifier and the EPS Bearer\nidentifier represents a unique packet filter identifier within the PDN\nconnection), for which resources are being modified. The TAD is released by\nthe UE after it has received a TFT related to the current PTI from the\nnetwork.\n\n                                    [pic]\n\n          Figure 5.4.5-1: UE requested bearer resource modification\n\n  NOTE\u00c2\u00a01:  Steps 1, 2, and 5 are common for architecture variants with GTP-\n         based S5/S8 and PMIP-based S5/S8. The procedure steps marked (A)\n         differ in the case that PMIP-based S5/S8 is employed and is defined\n         in TS\u00c2\u00a023.402\u00c2\u00a0[2].\n\nIf the bearer resource modification procedure is initiated for re-\nnegotiation of header compression configuration for Control Plane CIoT EPS\nOptimisation, the MME shall not send Bearer Resource Command message to the\nServing GW. In this case, the Bearer Modification Procedures (according to\nclause\u00c2\u00a05.4.3) is invoked and only the steps from 4 to 7 are performed.\n\n  1. The UE sends a Request Bearer Resource Modification (LBI, PTI, EPS\n    Bearer Identity, QoS, TAD, Protocol Configuration Options) message to\n    the MME. If the UE was in ECM-IDLE mode, this NAS message is preceded\n    by the Service Request procedure.\n\n     The TAD indicates one requested operation (add, modify, or delete\n    packet filters). If traffic flows are added, the TAD includes the\n    packet filter(s) (consisting of the packet filter information including\n    packet filter precedence, but without a packet filter identifier) to be\n    added. The UE also sends the QCI requested and GBR, if applicable, for\n    the added traffic flows. If the UE wants to link the new packet\n    filter(s) to an existing packet filter to enable the usage of existing\n    bearer resources for the new packet filter(s), the UE shall provide an\n    existing packet filter identifier together with the new packet\n    filter(s). If the new packet filter(s) are not linked to an existing\n    packet filter the UE shall provide at least one UL packet filter in the\n    TAD. In case a downlink only traffic flow(s) is to be added the UE\n    shall provide an UL packet filter that effectively disallows any useful\n    packet flows (see clause\u00c2\u00a015.3.3.4 of TS\u00c2\u00a023.060\u00c2\u00a0[7] for an example of\n    such packet filter).\n\n  NOTE\u00c2\u00a02:  Receiving at least one UL packet filter from the UE ensures that\n         a valid state for the TFT settings of the PDN connection as defined\n         in clause\u00c2\u00a015.3.0 of TS\u00c2\u00a023.060\u00c2\u00a0[7] is maintained in case the TAD add\n         operation results in the establishment of a new dedicated EPS\n         bearer.\n\n     If the UE wants to change the GBR in addition, the UE includes the GBR\n    requirement of the EPS Bearer. The TAD is released when the procedure\n    is completed.\n\n     When only requesting for a modification of GBR (i.e. decrease or\n    increase), the TAD shall include the existing packet filter\n    identifier(s) for which the GBR change request applies to. The UE\n    includes the GBR requirement of the EPS Bearer. The TAD is released\n    when the procedure is completed.\n\n     When requesting for a modification of packet filter(s) (e.g. change of\n    port number), the TAD shall include packet filter identifier(s) for\n    which the change request applies to together with the changed packet\n    filter information.\n\n     If the UE requests for deletion of traffic flows, the TAD includes the\n    packet filter identifier(s) to be deleted. If the packet filters to be\n    deleted were mapped to a GBR Bearer, the UE includes the new GBR\n    requirement of the EPS Bearer.\n\n     The UE sends the Linked Bearer Id (LBI) only when the requested\n    operation is add, to indicate to which PDN connection the additional\n    bearer resource is linked to. The EPS Bearer Identity is only sent when\n    the requested operation is modify or delete. The Procedure Transaction\n    Id is dynamically allocated by the UE for this procedure. The UE should\n    ensure as far as possible that previously used PTI values are not\n    immediately reused. The PTI is released when the procedure is\n    completed. Protocol Configuration Options may be used to transfer\n    application level parameters between the UE and the PDN GW (see\n    TS\u00c2\u00a023.228\u00c2\u00a0[52]), and are sent transparently through the MME and the\n    Serving GW.\n\n     If the PDN GW indicated support for the 3GPP PS data off feature\n    during PDN connection setup, the UE shall include in the PCO the 3GPP\n    PS Data Off Support Indication, which indicates whether the user has\n    activated or deactivated 3GPP PS Data Off.\n\n  2. The MME sends the Bearer Resource Command (IMSI, LBI, PTI, EPS Bearer\n    Identity, QoS, TAD, Protocol Configuration Options) message to the\n    selected Serving GW. The MME validates the request using the Linked\n    Bearer Id. The same Serving GW address is used by the MME as for the\n    EPS Bearer identified by the Linked Bearer Id received in the Request\n    Bearer Resource Modification message.\n\n  3. The Serving GW sends the Bearer Resource Command (IMSI, LBI, PTI, EPS\n    Bearer Identity, QoS, TAD, Protocol Configuration Options) message to\n    the PDN GW. The Serving GW sends the message to the same PDN GW as for\n    the EPS Bearer identified by the Linked Bearer Id.\n\n  4. The PDN GW may either apply a locally configured QoS policy, or it may\n    interact with the PCRF to trigger the appropriate PCC decision, which\n    may take into account subscription information. This corresponds to the\n    beginning of a PCEF-initiated IP-CAN Session Modification procedure as\n    defined in TS\u00c2\u00a023.203\u00c2\u00a0[6], up to the point that the PDN GW requests IP-\n    CAN Bearer Signalling. When interacting with PCRF, the PDN GW provides\n    to the PCRF the content of the TAD and, if applicable, the GBR change\n    (increase or decrease) associated with the packet filter information\n    contained in the TAD. The GBR change is either calculated from the\n    current Bearer QoS and the requested Bearer QoS from the UE, or set to\n    the requested GBR if the TAD indicates an add operation and no EPS\n    Bearer Identity was received. If the TAD indicates an add operation,\n    the requested QCI is also provided to the PCRF unless an existing\n    packet filter identifier is provided together with the new packet\n    filter.\n\n     The PCC decision provision message may indicate that User Location\n    Information and/or UE Time Zone information is to be provided to the\n    PCRF as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n     If the TAD operation is modify, delete, a request for changing the\n    GBR, or add with a link to existing packet filter(s), then the PDN GW\n    provides to the PCRF the SDF filter identifier(s), previously assigned\n    on Gx, that correspond to the received packet filter identifiers of the\n    EPS bearer indicated by the received EPS bearer identity.\n\n  NOTE\u00c2\u00a03:  The ability of the PCRF to handle multiple PCC rules in the same\n         request depends on operator policy. It is therefore recommended\n         that the UE avoids providing references to multiple packet filters\n         for different applications and services.\n\n     If the PDN GW detects that the 3GPP PS Data Off UE Status has changed,\n    the PDN GW shall indicate this event to the charging system for offline\n    and online charging.\n\n     If the 3GPP PS Data Off UE Status indicates that 3GPP PS Data Off is\n    activated for the UE, the PDN GW shall enforce the PCC rules for\n    downlink traffic to be applied when 3GPP PS Data Off is activated, as\n    described in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  5. If the request is accepted, either the Dedicated Bearer Activation\n    Procedure (according to clause\u00c2\u00a05.4.1), the PDN GW Initiated Bearer\n    Deactivation Procedure (according to clause\u00c2\u00a05.4.4.1) or one of the\n    Bearer Modification Procedures (according to clause\u00c2\u00a05.4.2.1 or 5.4.3)\n    is invoked. The PTI allocated by the UE is used as a parameter in the\n    invoked Dedicated Bearer Activation Procedure, the PDN GW Initiated\n    Bearer Deactivation Procedure or the Bearer Modification Procedure to\n    correlate it to the UE Requested Bearer Resource Modification\n    Procedure. This provides the UE with the necessary linkage to what EPS\n    Bearer to be used for the new traffic flow aggregate. The PDN GW shall\n    not modify the QoS parameters requested by the UE.\n\n     The PDN GW inserts, modifies or removes packet filter(s) corresponding\n    to the TAD into the TFT for the EPS bearer. If PCC is in use, the PDN\n    GW uses the service data flow filters as specified in the resulting PCC\n    rule(s). The PDN GW validates the state of the TFT settings of the PDN\n    connection as defined in clause\u00c2\u00a015.3.0 of TS\u00c2\u00a023.060\u00c2\u00a0[7]. If after the\n    execution of all TAD operations the TFT of the dedicated EPS bearer\n    contains only packet filters for the downlink direction, the PDN GW\n    shall add a packet filter which effectively disallows any useful packet\n    flows in uplink direction (see clause\u00c2\u00a015.3.3.4 in TS\u00c2\u00a023.060\u00c2\u00a0[7] for an\n    example of such a packet filter) to the TFT.\n\n  NOTE\u00c2\u00a04:  The PDN GW addition of an uplink packet filter allows the\n         handling of pre-Release 11 UEs which may have provided only\n         downlink packet filters in a TAD add operation without linking to\n         an existing packet filter.\n\n     When a new packet filter is inserted into a TFT, the PDN GW assigns a\n    new packet filter identifier which is unique within the TFT. The PDN GW\n    maintains the relation between the SDF filter identifier in the PCC\n    rule received from the PCRF and the packet filter identifier of the TFT\n    of this EPS bearer. If all of the packet filter(s) for a dedicated EPS\n    bearer have been removed from the TFT, the PDN GW performs the PDN GW\n    Initiated Bearer Deactivation Procedure.\n\n     If the requested QoS is not granted (i.e. the requested QoS cannot be\n    accepted or resources could not be allocated), or the resulting TFT\n    settings of the PDN connection does not pass the validation, then the\n    PDN GW sends a Bearer Resource Failure Indication (with a cause\n    indicating the reason why the request failed or was rejected) message,\n    which shall be delivered to the UE.\n\n  6. If the PDN GW interacted with the PCRF in step\u00c2\u00a04, the PDN GW indicates\n    to the PCRF whether the PCC decision could be enforced or not. This\n    corresponds to the completion of the PCEF-initiated IP-CAN session\n    modification procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6], proceeding after\n    the completion of IP-CAN bearer signalling. If requested by the PCRF\n    the PDN\u00c2\u00a0GW indicates User Location Information and/or UE Time Zone\n    Information to the PCRF as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n\n"}, {"key": "Void", "numbering": "5.4.6", "title_level": 2, "desc": "5.4.6  Void\n\n\n\n\n"}, {"key": "E-UTRAN initiated E-RAB modification procedure", "numbering": "5.4.7", "title_level": 2, "desc": "5.4.7  E-UTRAN initiated E-RAB modification procedure\n\nWhen SCG bearer option is applied to support dual connectivity operation,\nthis procedure is used to transfer bearer contexts to and from Secondary\neNodeB (see TS\u00c2\u00a036.300\u00c2\u00a0[5]) or Secondary gNodeB (see TS\u00c2\u00a037.340\u00c2\u00a0[85]). During\nthis procedure, both the MME and Serving GW are never relocated. The\npresence of IP connectivity between the Serving GW and the Master eNodeB\n(see TS\u00c2\u00a036.300\u00c2\u00a0[5] or TS\u00c2\u00a037.340\u00c2\u00a0[85] for Master eNodeB definition), as well\nas between the Serving GW and the Secondary RAN node is assumed.\n\n  NOTE:  In E-UTRAN, eNodeB is not allowed to negotiate bearer-level QoS\n         parameters as defined in clause\u00c2\u00a04.7.2.1.\n\n                                    [pic]\n\n       Figure 5.4.7-1: E-UTRAN initiated E-RAB modification procedure\n\n  1. The Master eNodeB sends a E-RAB Modification Indication message\n    (eNodeB address(es) and TEIDs for downlink user plane for all the EPS\n    bearers, CSG Membership Information, Secondary RAT usage data) to the\n    MME. The Master eNB indicates for each bearer whether it is modified or\n    not. If the PLMN has configured secondary RAT usage reporting and the\n    eNodeB has Secondary RAT usage data to report, the Secondary RAT usage\n    data is included.\n\n     If the Secondary eNB is a hybrid access eNB, the Master eNB includes\n    the CSG Membership Information for the SCG bearer(s) in the E-RAB\n    Modification Indication message. The MME determines the CSG membership\n    based on the CSG Membership Information as specified in TS\u00c2\u00a036.300\u00c2\u00a0[5],\n    but does not update the User CSG Information in the Core Network. A\n    failure of the CSG Membership Information verification does not impact\n    the E-UTRAN initiated E-RAB modification procedure.\n\n  2. The MME sends a Modify Bearer Request (eNodeB address(es) and TEIDs\n    for downlink user plane for all the EPS bearers, ISR Activated,\n    Secondary RAT usage data and indication to send it to PDN\u00c2\u00a0GW) message\n    per PDN connection to the Serving GW, only for the affected PDN\n    connections. If ISR was activated before this procedure, MME should\n    maintain ISR. The UE is informed about the ISR status in the Tracking\n    Area Update procedure. If the Serving GW supports Modify Access Bearers\n    Request procedure and if there is no need for the SGW to send the\n    signalling to the PDN GW, the MME may send a Modify Access Bearers\n    Request (eNodeB address(es) and TEIDs for downlink user plane for all\n    the EPS bearers, ISR Activated) to the Serving GW to optimise the\n    signalling. If the MME received Secondary RAT usage data in step\u00c2\u00a01, the\n    MME shall include it in this message.\n\n     If Secondary RAT usage data was included and if PGW secondary RAT\n    usage data reporting is active, the Serving GW shall send Modify Bearer\n    Request (Secondary RAT usage data) message to the PDN GW for each PDN\n    connection. The PDN GW responds with Modify Bearer Response message to\n    the Serving GW.\n\n  3. The Serving GW returns a Modify Bearer Response (Serving GW address\n    and TEID for uplink traffic) message to the MME as a response to a\n    Modify Bearer Request message, or a Modify Access Bearers Response\n    (Serving GW address and TEID for uplink traffic) as a response to a\n    Modify Access Bearers Request message.\n\n     The Serving GW starts sending downlink packets to the eNodeB using the\n    newly received address and TEID.\n\n  4. In order to assist the reordering function in the Master eNodeB and/or\n    Secondary RAN nodes, for the bearers that are switched between Master\n    eNodeB and Secondary RAN nodes, the Serving GW shall send one or more\n    \"end marker\" packets on the old path immediately after switching the\n    path as defined in TS\u00c2\u00a036.300\u00c2\u00a0[5], clause\u00c2\u00a010.1.2.2.\n\n  5. The MME confirms the E-RAB modification with the E-RAB Modification\n    Confirm (CSG Membership Status) message. The MME indicates for each\n    bearer whether it was successfully modified, kept unmodified or already\n    released by the EPC as defined in TS\u00c2\u00a036.413\u00c2\u00a0[36]. For the EPS bearers\n    that have not been switched successfully in the core network, it is the\n    MME decision whether to maintain or release the corresponding EPS\n    bearers. The eNB uses the CSG Membership Status to decide on further\n    actions, as specified in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n\n"}, {"key": "E-UTRAN initiated UE Context Modification procedure", "numbering": "5.4.8", "title_level": 2, "desc": "5.4.8  E-UTRAN initiated UE Context Modification procedure\n\nWhen split bearer option is applied to support dual connectivity operation,\nthis procedure is used is by the eNB to request the modifications on the\nestablished UE Context. In the current version of the specification, this\nprocedure is only used for membership verification, as described in\nTS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n                                    [pic]\n\n     Figure 5.4.7-1: E-UTRAN initiated UE context modification procedure\n\n  1. The addition of an hybrid HeNB as the SeNB is triggered, providing the\n    CSG-ID and the CSG Membership Information to the MeNB.\n\n  2. The Master eNodeB sends UE Context Modification Indication message to\n    the MME, which includes the CSG Membership Information of the SeNB.\n\n  3. The MME verifies the CSG membership based on the provided CSG\n    Membership Information as specified in TS\u00c2\u00a036.300\u00c2\u00a0[5], but does not\n    update the User CSG Information in the Core Network. A failure of the\n    CSG Membership Information verification does not impact the E-UTRAN UE\n    Context Modification procedure.\n\n  4. The MME confirms the UE Context Modification Indication with the UE\n    Context Modification Confirm (CSG Membership Status) message. If CSG\n    Membership Information was not present in the UE Context Modification\n    Indication message, the MME can not perform CSG Membership Information\n    verification and does not provide CSG Membership Status in the UE\n    Context Modification Confirm message.\n\n  5. In case the CSG Membership Status returned by the MME is different\n    from what was reported by the UE, the eNB may decide on further\n    actions.\n\n\n"}, {"key": "Handover", "numbering": "5.5", "title_level": 1, "desc": "5.5  Handover\n\n\n\n\n"}, {"key": "Intra-E-UTRAN handover", "numbering": "5.5.1", "title_level": 2, "desc": ""}, {"key": "X-based handover", "numbering": "5.5.1.1", "title_level": 3, "desc": "5.5.1  Intra-E-UTRAN handover\n\n\n5.5.1.1  X2-based handover\n\n\n"}, {"key": "General", "numbering": "5.5.1.1.1", "title_level": 4, "desc": ""}, {"key": "X-based handover without Serving GW relocation", "numbering": "5.5.1.1.2", "title_level": 4, "desc": ""}, {"key": "X-based handover with Serving GW relocation", "numbering": "5.5.1.1.3", "title_level": 4, "desc": ""}, {"key": "S-based handover", "numbering": "5.5.1.2", "title_level": 3, "desc": "5.5.1.1.1   General\n\nThese procedures are used to hand over a UE from a source eNodeB to a\ntarget eNodeB using the X2 reference point. In these procedures the MME is\nunchanged. Two procedures are defined depending on whether the Serving GW\nis unchanged or is relocated. In addition to the X2 reference point between\nthe source and target eNodeB, the procedures rely on the presence of S1-MME\nreference point between the MME and the source eNodeB as well as between\nthe MME and the target eNodeB.\n\nThe handover preparation and execution phases are performed as specified in\nTS\u00c2\u00a036.300\u00c2\u00a0[5]. If emergency bearer services are ongoing for the UE handover\nto the target eNodeB is performed independent of the Handover Restriction\nList. The MME checks, as part of the Tracking Area Update in the execution\nphase, if the handover is to a restricted area and if so MME releases the\nnon-emergency bearers as specified in clause\u00c2\u00a05.10.3.\n\nIf the serving PLMN changes during X2-based handover, the source eNodeB\nshall indicate to the target eNodeB (in the Handover Restriction List) the\nPLMN selected to be the new Serving PLMN.\n\nWhen the UE receives the handover command it will remove any EPS bearers\nfor which it did not receive the corresponding EPS radio bearers in the\ntarget cell. As part of handover execution, downlink and optionally also\nuplink packets are forwarded from the source eNodeB to the target eNodeB.\nWhen the UE has arrived to the target eNodeB, downlink data forwarded from\nthe source eNodeB can be sent to it. Uplink data from the UE can be\ndelivered via the (source) Serving GW to the PDN GW or optionally forwarded\nfrom the source eNodeB to the target eNodeB. Only the handover completion\nphase is affected by a potential change of the Serving GW, the handover\npreparation and execution phases are identical.\n\nIf the MME receives a rejection to a NAS procedure (e.g. dedicated bearer\nestablishment/modification/release; location reporting control; NAS message\ntransfer; etc.) from the eNodeB with an indication that an X2 handover is\nin progress (see TS\u00c2\u00a036.300\u00c2\u00a0[5]), the MME shall reattempt the same NAS\nprocedure either when the handover is complete or the handover is deemed to\nhave failed, except in case of Serving GW relocation. The failure is known\nby expiry of the timer guarding the NAS procedure.\n\nIf the X2 handover includes the Serving GW relocation, and if the MME\nreceives a rejection to a NAS message transfer for a Downlink NAS Transport\nor Downlink Generic NAS Transport message from the eNodeB with an\nindication that an X2 handover is in progress, the MME should resend the\ncorresponding message to the target eNodeB when either the handover is\ncomplete or to the source eNodeB when the handover is deemed to have failed\nif the MME is still the serving MME.\n\nIf the MME receives a rejection to a NAS message transfer for a CS Service\nNotification or to a UE Context Modification Request message with a CS\nFallback indicator from the eNodeB with an indication that an X2 handover\nis in progress, the MME shall resend the corresponding message to the\ntarget eNodeB when the handover is complete or to the source eNodeB when\nthe handover is deemed to have failed.\n\nIf during the handover procedure the MME detects that the Serving GW needs\nbe relocated, the MME shall reject any PDN GW initiated EPS bearer(s)\nrequest received since handover procedure started and shall include an\nindication that the request has been temporarily rejected due to handover\nprocedure in progress. The rejection is forwarded by the Serving GW to the\nPDN GW, with the indication that the request has been temporarily rejected.\n\nUpon reception of a rejection for an EPS bearer(s) PDN GW initiated\nprocedure with an indication that the request has been temporarily rejected\ndue to handover procedure in progress, the PDN GW start a locally\nconfigured guard timer. The PDN GW shall re-attempt, up to a pre-configured\nnumber of times, when either it detects that the handover is completed or\nhas failed using message reception or at expiry of the guard timer.\n\nIf the source eNodeB and target eNodeB support RACS as defined in\nclause\u00c2\u00a05.11.3a, the Source to Target transparent container shall contain\nthe UE's UE Radio Capability ID.\n\n\n5.5.1.1.2   X2-based handover without Serving GW relocation\n\nThis procedure is used to hand over a UE from a source eNodeB to a target\neNodeB using X2 when the MME is unchanged and decides that the Serving GW\nis also unchanged. The presence of IP connectivity between the Serving GW\nand the source eNodeB, as well as between the Serving GW and the target\neNodeB is assumed.\n\n                                    [pic]\n\n     Figure 5.5.1.1.2-1: X2-based handover without Serving GW relocation\n\n  NOTE\u00c2\u00a01:  For a PMIP-based S5/S8, procedure steps (A) are defined in\n         TS\u00c2\u00a023.402\u00c2\u00a0[2].\n\n  1a.  If the PLMN has configured secondary RAT usage reporting, the source\n    eNodeB during the handover execution phase may provide RAN usage data\n    Report (Secondary RAT usage data, handover flag) to the MME. The source\n    eNB shall provide this only when the Target eNB has confirmed handover\n    over X2 interface (see TS\u00c2\u00a036.300\u00c2\u00a0[5] and the source eNB has sent a HO\n    command to the UE). The handover flag indicates to the MME that it\n    should buffer the usage data report before forwarding it to the Serving\n    GW.\n\n  1b.  The target eNodeB sends a Path Switch Request message to MME to\n    inform that the UE has changed cell, including the TAI+ECGI of the\n    target cell and the list of EPS bearers to be switched.\n\n     If Dual Connectivity is activated for the UE, the PSCell ID shall be\n    included in the Path Switch Request message.\n\n     If the target cell is a CSG cell , the target eNodeB includes the CSG\n    ID of the target cell in Path Switch Request message. If the target\n    cell is in hybrid mode, it includes the CSG ID of the target cell and\n    CSG Access Mode set to \"hybrid\" in the Path Switch Request message.\n    Moreover, the Path Switch Request message contains the CSG Membership\n    Status IE if the hybrid cell accessed by the UE has a different CSG\n    from the source cell or the source cell does not have a CSG ID. The MME\n    determines the CSG membership based on the CSG ID and the target PLMN\n    id received from the target eNodeB.The MME updates the User CSG\n    information based on the CSG ID and CSG Access Mode received from the\n    target eNodeB and CSG membership if one of the parameters has changed.\n\n     For SIPTO at the Local Network with stand-alone GW architecture, the\n    target eNodeB shall include the Local Home Network ID of the target\n    cell in the Path Switch Request message.\n\n     The MME determines that the Serving GW can continue to serve the UE.\n\n  2. The MME sends a Modify Bearer Request (eNodeB address(es) and TEIDs\n    for downlink user plane for the accepted EPS bearers, ISR Activated,\n    Secondary RAT usage data) message per PDN connection to the Serving GW\n    for each PDN connection where the default bearer has been accepted by\n    the target eNodeB. If the PDN GW requested location information change\n    reporting, the MME also includes the User Location Information IE in\n    this message if it is different compared to the previously sent\n    information. If the UE Time Zone has changed, the MME includes the UE\n    Time Zone IE in this message. If the Serving Network has changed, the\n    MME includes the new Serving Network IE in this message. If ISR was\n    activated before this procedure, MME should maintain ISR. The UE is\n    informed about the ISR status in the Tracking Area Update procedure. If\n    the Serving GW supports Modify Access Bearers Request procedure and if\n    there is no need for the SGW to send the signalling to the PDN GW, the\n    MME may send Modify Access Bearers Request (eNodeB address(es) and\n    TEIDs for downlink user plane for the accepted EPS bearers, ISR\n    Activated) per UE to the Serving GW to optimise the signalling. The MME\n    includes the Secondary RAT usage data if the MME received it from the\n    source eNodeB in step\u00c2\u00a01a.\n\n     If the PDN GW requested UE's User CSG information (determined from the\n    UE context), the MME includes the User CSG Information IE in this\n    message if the User CSG Information has changed.\n\n     The MME uses the list of EPS bearers to be switched, received in\n    step\u00c2\u00a01, to determine whether any dedicated EPS bearers in the UE\n    context have not been accepted by the target eNodeB. The MME releases\n    the non-accepted dedicated bearers by triggering the bearer release\n    procedure as specified in clause\u00c2\u00a05.4.4.2. If the Serving GW receives a\n    DL packet for a non-accepted bearer, the Serving GW drops the DL packet\n    and does not send a Downlink Data Notification to the MME.\n\n     If the default bearer of a PDN connection has not been accepted by the\n    target eNodeB and there are multiple PDN connections active, the MME\n    shall consider all bearers of that PDN connection as failed and release\n    that PDN connection by triggering the MME requested PDN disconnection\n    procedure specified in clause\u00c2\u00a05.10.3.\n\n     If none of the default EPS bearers have been accepted by the target\n    eNodeB or there is a LIPA PDN connection that has not been released,\n    the MME shall act as specified in step\u00c2\u00a06.\n\n  3. If the Serving GW has received the User Location Information IE and/or\n    the UE Time Zone IE and/or the Serving Network IE and/or User CSG\n    Information IE from the MME in step\u00c2\u00a02 the Serving GW informs the PDN\n    GW(s) about this information that e.g. can be used for charging, by\n    sending the message Modify Bearer Request (Serving GW Address and TEID,\n    User Location Information IE and/or UE Time Zone IE and/or Serving\n    Network IE and/or User CSG Information IE, Secondary RAT usage data)\n    per PDN connection to the PDN GW(s) concerned. The Serving GW shall\n    return a Modify Bearer Response (Serving GW address and TEID for uplink\n    traffic) message to the MME as a response to a Modify Bearer Request\n    message, or a Modify Access Bearers Response (Serving GW address and\n    TEID for uplink traffic) as a response to a Modify Access Bearers\n    Request message. If the Serving GW cannot serve the MME Request in the\n    Modify Access Bearers Request message without S5/S8 signalling or\n    without corresponding Gxc signalling when PMIP is used over the S5/S8\n    interface, it shall respond to the MME with indicating that the\n    modifications are not limited to S1-U bearers, and the MME shall repeat\n    its request using Modify Bearer Request message per PDN connection. The\n    Serving GW forwards the Secondary RAT usage data to the PDN GW, if the\n    Serving GW received it in step\u00c2\u00a02 and if PGW secondary RAT usage data\n    reporting is active.\n\n  4. The Serving GW starts sending downlink packets to the target eNodeB\n    using the newly received address and TEIDs. A Modify Bearer Response\n    message is sent back to the MME.\n\n  5. In order to assist the reordering function in the target eNodeB, the\n    Serving GW shall send one or more \"end marker\" packets on the old path\n    immediately after switching the path as defined in TS\u00c2\u00a036.300\u00c2\u00a0[5],\n    clause\u00c2\u00a010.1.2.2.\n\n  6. The MME confirms the Path Switch Request message with the Path Switch\n    Request Ack message. If the UE-AMBR is changed, e.g. all the EPS\n    bearers which are associated to the same APN are rejected in the target\n    eNodeB, the MME shall provide the updated value of UE-AMBR to the\n    target eNodeB in the Path Switch Request Ack message.\n\n     If the CSG membership status was included in the Path Switch Request\n    message, the MME shall include its verified CSG membership status in\n    the Path Switch Request Ack message.\n\n     If some EPS bearers have not been switched successfully in the core\n    network, the MME shall indicate in the Path Switch Request Ack message\n    which bearers failed to be established (see more detail in\n    TS\u00c2\u00a036.413\u00c2\u00a0[36]) and for dedicated bearers initiate the bearer release\n    procedure as specified in clause\u00c2\u00a05.4.4.2 to release the core network\n    resources of the failed dedicated EPS bearers. The target eNodeB shall\n    delete the corresponding bearer contexts when it is informed that\n    bearers have not been established in the core network.\n\n     If none of the default EPS bearers have been switched successfully in\n    the core network or if they have not been accepted by the target eNodeB\n    or the LIPA PDN connection has not been released, the MME shall send a\n    Path Switch Request Failure message (see more detail in TS\u00c2\u00a036.413\u00c2\u00a0[36])\n    to the target eNodeB. The MME performs explicit detach of the UE as\n    described in the MME initiated detach procedure of clause\u00c2\u00a05.3.8.3.\n\n     If the MME supports RACS as defined in clause\u00c2\u00a05.11.3a and has UE Radio\n    Capability ID stored in the UE's context it includes it in the Path\n    Switch Request Ack message.\n\n  7. By sending Release Resource the target eNodeB informs success of the\n    handover to source eNodeB and triggers the release of resources. This\n    step is specified in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n  8. The UE initiates a Tracking Area Update procedure when one of the\n    conditions listed in clause \"Triggers for tracking area update\"\n    applies. If ISR is activated for the UE when the MME receives the\n    Tracking Area Update Request, the MME should maintain ISR by indicating\n    ISR Activated in the Tracking Area Update Accept message.\n\n  NOTE\u00c2\u00a02:  It is only a subset of the TA update procedure that is performed\n         by the MME, since the UE is in ECM-CONNECTED state and the MME is\n         not changed.\n\n\n5.5.1.1.3   X2-based handover with Serving GW relocation\n\nThis procedure is used to hand over a UE from a source eNodeB to a target\neNodeB using X2 when the MME is unchanged and the MME decides that the\nServing GW is to be relocated. The presence of IP connectivity between the\nsource Serving GW and the source eNodeB, between the source Serving GW and\nthe target eNodeB, and between the target Serving GW and target eNodeB is\nassumed. (If there is no IP connectivity between target eNodeB and source\nServing GW, it is assumed that the S1-based handover procedure in clause\n5.5.1.2 shall be used instead.)\n\n                                    [pic]\n\n      Figure 5.5.1.1.3-1: X2-based handover with Serving GW relocation\n\n  NOTE\u00c2\u00a01:  For a PMIP-based S5/S8, procedure steps (A) and (B) are defined\n         in TS\u00c2\u00a023.402\u00c2\u00a0[2].\n\n  1a.  If the PLMN has configured Secondary RAT usage data reporting and\n    the source eNodeB has Secondary RAT usage data to report, the eNodeB\n    sends a RAN usage data Report (Secondary RAT usage data, handover flag)\n    message to the MME. The eNB shall provide this only when it is to\n    perform a Path Switch (i.e. the Target eNB has confirmed it is ready\n    over X2 interface (see TS\u00c2\u00a036.300\u00c2\u00a0[5] and the source eNB has sent a HO\n    command to the UE). The handover flag indicates to the MME that it\n    should buffer the report before forwarding the Secondary RAT usage\n    charging data.\n\n  1b.  The target eNodeB sends a Path Switch Request message to MME to\n    inform that the UE has changed cell, including the ECGI of the target\n    cell and the list of EPS bearers to be switched.\n\n     If Dual Connectivity is activated for the UE, the PSCell ID shall be\n    included in the Path Switch Request message.\n\n     If the target cell is a CSG cell, the target eNodeB includes the CSG\n    ID of the target cell in Path Switch Request message. If the target\n    cell is in hybrid mode, it includes the CSG ID of the target cell and\n    CSG Access Mode set to \"hybrid\" in the Path Switch Request message.\n    Moreover, the Path Switch Request message contains the CSG Membership\n    Status IE if the hybrid cell accessed by the UE has a different CSG\n    from the source cell or the source cell does not have a CSG ID. The MME\n    determines the CSG membership based on the CSG ID and the target PLMN\n    id received from the target eNodeB. The MME updates the User CSG\n    information based on the CSG ID and CSG Access Mode received from the\n    target eNodeB and CSG membership if one of the parameters has changed.\n\n     For SIPTO at the Local Network with stand-alone GW architecture, the\n    target eNodeB shall include the Local Home Network ID of the target\n    cell in the Path Switch Request message.\n\n     The MME determines that the Serving GW is relocated and selects a new\n    Serving GW according to clause 4.3.8.2 on \"Serving GW Selection\n    Function\".\n\n  NOTE\u00c2\u00a02:  The MME knows the S-GW Service Area with a TA granularity.\n\n  2. The MME sends a Create Session Request (bearer context(s) with PDN GW\n    addresses and TEIDs (for GTP-based S5/S8) or GRE keys (for PMIP-based\n    S5/S8) at the PDN GW(s) for uplink traffic, eNodeB address(es) and\n    TEIDs for downlink user plane for the accepted EPS bearers, the\n    Protocol Type over S5/S8, Serving Network, UE Time Zone, Secondary RAT\n    usage data) message per PDN connection to the target Serving GW for\n    each PDN connection where the default bearer has been accepted by the\n    target eNodeB. The target Serving GW allocates the S-GW addresses and\n    TEIDs for the uplink traffic on S1_U reference point (one TEID per\n    bearer). The Protocol Type over S5/S8 is provided to Serving GW which\n    protocol should be used over S5/S8 interface. If the PDN GW requested\n    location information change reporting, the MME also includes the User\n    Location Information IE in this message if it is different compared to\n    the previously sent information. If the PDN GW requested UE's User CSG\n    information (determined from the UE context), the MME includes the User\n    CSG Information IE in this message if the User CSG Information has\n    changed.\n\n     The MME uses the list of EPS bearers to be switched, received in\n    step\u00c2\u00a01, to determine whether any dedicated EPS bearers in the UE\n    context have not been accepted by the target eNodeB. The MME releases\n    the non-accepted dedicated bearers by triggering the bearer release\n    procedure as specified in clause\u00c2\u00a05.4.4.2 via target Serving GW. If the\n    Serving GW receives a DL packet for a non-accepted bearer, the Serving\n    GW drops the DL packet and does not send a Downlink Data Notification\n    to the MME.\n\n     If the default bearer of a PDN connection has not been accepted by the\n    target eNodeB and there are multiple PDN connections active, the MME\n    shall consider all bearers of that PDN connection as failed and release\n    that PDN connection by triggering the MME requested PDN disconnection\n    procedure specified in clause\u00c2\u00a05.10.3 via source Serving GW.\n\n     If none of the default EPS bearers have been accepted by the target\n    eNodeB or there is a LIPA PDN connection that has not been released,\n    the MME shall act as specified in step\u00c2\u00a05.\n\n     If the MME received it from the source eNodeB in step\u00c2\u00a01a and PDN GW\n    Secondary RAT reporting is active, the MME includes the Secondary RAT\n    usage data with a flag stating that the target SGW shall not process\n    the information and only forward it to the PDN GW.\n\n  3. The target Serving GW assigns addresses and TEIDs (one per bearer) for\n    downlink traffic from the PDN GW. The Serving GW allocates DL TEIDs on\n    S5/S8 even for non-accepted bearers. It sends a Modify Bearer Request\n    (Serving GW addresses for user plane and TEID(s), Serving Network, PDN\n    Charging Pause Support Indication, Secondary RAT usage data) message\n    per PDN connection to the PDN GW(s). The S-GW also includes User\n    Location Information IE and/or UE Time Zone IE and/or User CSG\n    Information IE if it is present in step\u00c2\u00a02. The PDN GW updates its\n    context field and returns a Modify Bearer Response (Charging Id,\n    MSISDN, PDN Charging Pause Enabled Indication (if PDN GW has chosen to\n    enable the function), etc.) message to the Serving GW. The MSISDN is\n    included if the PDN GW has it stored in its UE context. The PDN GW\n    starts sending downlink packets to the target GW using the newly\n    received address and TEIDs. These downlink packets will use the new\n    downlink path via the target Serving GW to the target eNodeB. The\n    Serving GW shall allocate TEIDs for the failed bearers and inform to\n    the MME. The Serving GW forwards the Secondary RAT usage data to the\n    PDN GW, if the Serving GW received it in step\u00c2\u00a02 and if PGW secondary\n    RAT usage data reporting is active.\n\n     If the Serving GW is relocated, the PDN GW shall send one or more \"end\n    marker\" packets on the old path immediately after switching the path in\n    order to assist the reordering function in the target eNodeB. The\n    source Serving GW shall forward the \"end marker\" packets to the source\n    eNodeB.\n\n  4. The target Serving GW sends a Create Session Response (Serving GW\n    addresses and uplink TEID(s) for user plane) message back to the target\n    MME. The MME starts a timer, to be used in step 7.\n\n  5. The MME confirms the Path Switch Request message with the Path Switch\n    Request Ack (Serving GW addresses and uplink TEID(s) for user plane)\n    message. If the UE-AMBR is changed, e.g. all the EPS bearers which are\n    associated to the same APN are rejected in the target eNodeB, the MME\n    shall provide the updated value of UE-AMBR to the target eNodeB in the\n    Path Switch Request Ack message. The target eNodeB starts using the new\n    Serving GW address(es) and TEID(s) for forwarding subsequent uplink\n    packets.\n\n     If the CSG membership status was included in the Path Switch Request\n    message, the MME shall include its verified CSG membership status in\n    the Path Switch Request Ack message.\n\n     If some EPS bearers have not been switched successfully in the core\n    network, the MME shall indicate in the Path Switch Request Ack message\n    which bearers failed to be established (see more detail in\n    TS\u00c2\u00a036.413\u00c2\u00a0[36]) and for dedicated bearers initiate the bearer release\n    procedure as specified in clause\u00c2\u00a05.4.4.2 to release the core network\n    resources of the failed dedicated EPS bearers. The target eNodeB shall\n    delete the corresponding bearer contexts when it is informed that\n    bearers have not been established in the core network.\n\n     If none of the default EPS bearers have been switched successfully in\n    the core network or if they have not been accepted by the target eNodeB\n    or the LIPA PDN connection has not been released, the MME shall send a\n    Path Switch Request Failure message (see more detail in TS\u00c2\u00a036.413\u00c2\u00a0[36])\n    to the target eNodeB. The MME performs explicit detach of the UE as\n    described in the MME initiated detach procedure of clause\u00c2\u00a05.3.8.3.\n\n     If the MME supports RACS as defined in clause\u00c2\u00a05.11.3a and has UE Radio\n    Capability ID stored in the UE's context it includes it in the Path\n    Switch Request Ack message.\n\n  6. By sending Release Resource the target eNodeB informs success of the\n    handover to source eNodeB and triggers the release of resources. This\n    step is specified in TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n  7. When the timer has expired after step 4, the source MME releases the\n    bearer(s) in the source Serving GW by sending a Delete Session Request\n    message (Cause, Operation Indication, Secondary RAT usage data). The\n    operation Indication flag is not set, that indicates to the Source\n    Serving GW that the Source Serving GW shall not initiate a delete\n    procedure towards the PDN GW. The Source Serving GW acknowledges with\n    Delete Session Response messages. If ISR has been activated before this\n    procedure, the cause indicates to the Source S-GW that the Source S-GW\n    shall delete the bearer resources on the other old CN node by sending\n    Delete Bearer Request message(s) to that CN node. The MME includes the\n    Secondary RAT usage data in this message if it received it in step\u00c2\u00a01a.\n\n  8. The UE initiates a Tracking Area Update procedure when one of the\n    conditions listed in clause \"Triggers for tracking area update\"\n    applies.\n\n  NOTE\u00c2\u00a03:  It is only a subset of the TA update procedure that is performed\n         by the MME, since the UE is in ECM-CONNECTED state. The UE is\n         informed about the ISR status in the Tracking Area Update\n         procedure.\n\n\n5.5.1.2  S1-based handover\n\n\n"}, {"key": "General", "numbering": "5.5.1.2.1", "title_level": 4, "desc": ""}, {"key": "S-based handover, normal", "numbering": "5.5.1.2.2", "title_level": 4, "desc": ""}, {"key": "S-based handover, Reject", "numbering": "5.5.1.2.3", "title_level": 4, "desc": ""}, {"key": "S-based handover, Cancel", "numbering": "5.5.1.2.4", "title_level": 4, "desc": "5.5.1.2.1   General\n\nThe S1-based handover procedure is used when the X2-based handover cannot\nbe used. The source eNodeB initiates a handover by sending Handover\nRequired message over the S1-MME reference point. This procedure may\nrelocate the MME and/or the Serving GW. The source MME selects the target\nMME. The MME should not be relocated during inter-eNodeB handover unless\nthe UE leaves the MME Pool Area where the UE is served. The MME (target MME\nfor MME relocation) determines if the Serving GW needs to be relocated. If\nthe Serving GW needs to be relocated the MME selects the target Serving GW,\nas specified in clause\u00c2\u00a04.3.8.2 on Serving GW selection function.\n\nThe source eNodeB decides which of the EPS bearers are subject for\nforwarding of downlink and optionally also uplink data packets from the\nsource eNodeB to the target eNodeB. The EPC does not change the decisions\ntaken by the RAN node. Packet forwarding can take place either directly\nfrom the source eNodeB to the target eNodeB, or indirectly from the source\neNodeB to the target eNodeB via the source and target Serving GWs (or if\nthe Serving GW is not relocated, only the single Serving GW).\n\nThe availability of a direct forwarding path is determined in the source\neNodeB and indicated to the source MME. If X2 connectivity is available\nbetween the source and target eNodeBs, a direct forwarding path is\navailable.\n\nIf a direct forwarding path is not available, indirect forwarding may be\nused. The source MME uses the indication from the source eNodeB to\ndetermine whether to apply indirect forwarding. The source MME indicates to\nthe target MME whether indirect forwarding should apply. Based on this\nindication, the target MME determines whether it applies indirect\nforwarding.\n\nIf the MME receives a rejection to an S1 interface procedure (e.g.\ndedicated bearer establishment/modification/release; location reporting\ncontrol; NAS message transfer; etc.) from the eNodeB with an indication\nthat an S1 handover is in progress (see TS\u00c2\u00a036.300\u00c2\u00a0[5]), the MME shall\nreattempt the same S1 interface procedure when either the handover is\ncomplete or is deemed to have failed if the MME is still the serving MME,\nexcept in case of Serving GW relocation. If the S1 handover changes the\nserving MME, the source MME shall terminate any other ongoing S1 interface\nprocedures except the handover procedure.\n\nIf the S1 handover includes the Serving GW relocation, and if the MME\nreceives a rejection to a NAS message transfer for a Downlink NAS Transport\nor Downlink Generic NAS Transport message from the eNodeB with an\nindication that an S1 handover is in progress, the MME should resend the\ncorresponding message to the target eNodeB when either the handover is\ncomplete or to the source eNodeB when the handover is deemed to have failed\nif the MME is still the serving MME.\n\nIf the MME receives a rejection to a NAS message transfer for a CS Service\nNotification or to a UE Context modification Request message with a CS\nFallback indication from the eNodeB with an indication that an S1 handover\nis in progress, the MME shall resend the corresponding message to the\ntarget eNodeB when either the handover is complete or to the source eNodeB\nwhen the handover is deemed to have failed if the MME is still the serving\nMME.\n\nIn order to minimise the number of procedures rejected by the eNodeB, the\nMME should pause non-handover related S1 interface procedures (e.g.\ndownlink NAS message transfer, E-RAB Setup/Modify/Release, etc.) while a\nhandover is ongoing (i.e. from the time that a Handover Required has been\nreceived until either the Handover procedure has succeeded (Handover\nNotify) or failed (Handover Failure)) and continue them once the Handover\nprocedure has completed if the MME is still the serving MME, except in case\nof Serving GW relocation.\n\nIf during the handover procedure the MME detects that the Serving GW or/and\nthe MME needs be relocated, the MME shall reject any PDN GW initiated EPS\nbearer(s) request received since handover procedure started and shall\ninclude an indication that the request has been temporarily rejected due to\nhandover procedure in progress. The rejection is forwarded by the Serving\nGW to the PDN GW, with the indication that the request has been temporarily\nrejected.\n\nUpon reception of a rejection for an EPS bearer(s) PDN GW initiated\nprocedure with an indication that the request has been temporarily rejected\ndue to handover procedure in progress, the PDN GW start a locally\nconfigured guard timer. The PDN GW shall re-attempt, up to a pre-configured\nnumber of times, when either it detects that the handover is completed or\nhas failed using message reception or at expiry of the guard timer.\n\nIf emergency bearer services are ongoing for the UE, handover to the target\neNodeB is performed independent of the Handover Restriction List. The MME\nchecks, as part of the Tracking Area Update in the execution phase, if the\nhandover is to a restricted area and if so MME releases the non-emergency\nbearers as specified in clause\u00c2\u00a05.10.3.\n\nIf emergency bearer services are ongoing for the UE, handover to the target\nCSG cell is performed independent of the UE's CSG subscription. If the\nhandover is to a CSG cell that the UE is not subscribed, the target eNodeB\nonly accepts the emergency bearers and the target MME releases the non-\nemergency PDN connections that were not accepted by the target eNodeB as\nspecified in clause\u00c2\u00a05.10.3.\n\nFor inter-PLMN handover to a CSG cell, if the source MME has the CSG-ID\nlist of the target PLMN, the source MME shall use it to validate the CSG\nmembership of the UE in the target CSG cell. Otherwise, based on operator's\nconfiguration the source MME may allow the handover by validating the CSG\nmembership of the UE in the target CSG cell using the CSG-ID list of the\nregistered PLMN-ID. If neither the CSG-ID list of the target PLMN nor the\noperator's configuration permits the handover,the source MME shall reject\nthe handover due to no CSG membership information of the target PLMN-ID.\n\nAs specified in clause\u00c2\u00a04.3.8.3, with regard to CIoT EPS Optimisations, the\nsource MME attempts to perform handover to a target MME that can support\nthe UE's Preferred Network Behaviour. For a UE that is using a Non-IP\nconnection to a PDN Gateway, or a PDN connection to a SCEF, if these\nbearers cannot be supported by the target MME, the source MME does not\nattempt to handover those bearers, but instead releases them upon\nsuccessful completion of the handover. If the MME does not have any bearer\nfor the UE that can be transferred, then the MME sends an S1-AP Handover\nPreparation Failure message to the source eNB.\n\nFor PDN connection of Ethernet Type, if the target MME does not support\nEthernet PDN Type, the source MME does not attempt to handover those\nbearers, but instead releases them upon successful completion of the\nhandover.\n\n  NOTE:  Inter-PLMN handover to a CSG cell in a PLMN which is not an\n         equivalent PLMN for the UE is not supported.\n\nIf the source eNodeB and target eNodeB support RACS as defined in\nclause\u00c2\u00a05.11.3a, the Source to Target transparent container shall contain\nthe UE's UE Radio Capability ID.\n\n\n5.5.1.2.2   S1-based handover, normal\n\nThis procedure describes the S1-based handover in the normal case,\nclause\u00c2\u00a05.5.1.2.3 describes it when the procedure is rejected by the target\neNodeB or the target MME and clause\u00c2\u00a05.5.1.2.4 describes when the procedure\nis canceled by the source eNodeB.\n\n                                    [pic]\n\n                    Figure 5.5.1.2.2-1: S1-based handover\n\n  NOTE\u00c2\u00a01:  For a PMIP-based S5/S8, procedure steps (A) and (B) are defined\n         in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps 16 and 16a concern GTP based S5/S8.\n\n  NOTE\u00c2\u00a02:  If the Serving GW is not relocated, the box \"Source Serving GW\"\n         in figure 5.5.1.2.2-1 is acting as the target Serving GW.\n\n  1. The source eNodeB decides to initiate an S1-based handover to the\n    target eNodeB. This can be triggered e.g. by no X2 connectivity to the\n    target eNodeB, or by an error indication from the target eNodeB after\n    an unsuccessful X2-based handover, or by dynamic information learnt by\n    the source eNodeB.\n\n  2. The source eNodeB sends Handover Required (Direct Forwarding Path\n    Availability, Source to Target transparent container, target eNodeB\n    Identity, CSG ID, CSG access mode, target TAI, S1AP Cause) to the\n    source MME. The source eNodeB indicates which bearers are subject to\n    data forwarding. Direct Forwarding Path Availability indicates whether\n    direct forwarding is available from the source eNodeB to the target\n    eNodeB. This indication from source eNodeB can be based on e.g. the\n    presence of X2. The target TAI is sent to MME to facilitate the\n    selection of a suitable target MME. When the target cell is a CSG cell\n    or a hybrid cell, the source eNodeB shall include the CSG ID of the\n    target cell. If the target cell is a hybrid cell, the CSG access mode\n    shall be indicated.\n\n  3. The source MME selects the target MME as described in clause 4.3.8.3\n    on \"MME Selection Function\" and if it has determined to relocate the\n    MME, it sends a Forward Relocation Request (MME UE context, Source to\n    Target transparent container, RAN Cause, target eNodeB Identity, CSG\n    ID, CSG Membership Indication, target TAI, MS Info Change Reporting\n    Action (if available), CSG Information Reporting Action (if available),\n    UE Time Zone, Direct Forwarding Flag, Serving Network, Local Home\n    Network ID, LTE-M UE Indication) message to the target MME. The target\n    TAI is sent to the target MME to help it to determine whether S-GW\n    relocation is needed (and, if needed, aid SGW selection). The old\n    Serving Network is sent to target MME to support the target MME to\n    resolve if Serving Network is changed.  In network sharing scenarios\n    Serving Network denotes the serving core network.\n\n     The source MME shall perform access control by checking the UE's CSG\n    subscription when CSG ID is provided by the source eNodeB. If there is\n    no subscription data for this CSG ID or the CSG subscription is\n    expired, and the target cell is a CSG cell, the source MME shall reject\n    the handover with an appropriate cause unless the UE has emergency\n    bearer services.\n\n     The MME UE context includes IMSI, ME Identity, UE security context, UE\n    Network Capability, AMBR, Selected CN operator ID, APN restriction,\n    Serving GW address and TEID for control signalling, and EPS Bearer\n    context(s).\n\n     An EPS Bearer context includes the PDN GW addresses and TEIDs (for GTP-\n    based S5/S8) or GRE keys (for PMIP-based S5/S8) at the PDN GW(s) for\n    uplink traffic, APN, Serving GW addresses and TEIDs for uplink traffic,\n    and TI.\n\n     Based on the CIoT EPS Optimisation capabilities of the target MME\n    (determined according to the target MME selection procedure of\n    clause\u00c2\u00a04.3.8.3) the source MME only includes the EPS Bearer Context(s)\n    that the target MME can support. If none of the UE's EPS Bearers can be\n    supported by the selected target MME, the source MME rejects the S1\n    handover attempt by sending a Handover Preparation Failure (Cause)\n    message to the Source eNodeB. If the target MME supports CIoT EPS\n    Optimisation and the use of header compression has been negotiated\n    between the UE and the source MME, the source MME also includes in the\n    Forward Relocation Request the previously negotiated Header Compression\n    Configuration that includes the information necessary for the ROHC\n    channel setup but not the RoHC context itself.\n\n     If the source MME includes EPS Bearer Context, in addition to the\n    Serving GW IP address and TEID for S1-U use plane, the source MME also\n    includes Serving GW IP address and TEID for S11-U, if available.\n\n  NOTE\u00c2\u00a03:  If the handover is successful, the source MME will signal to the\n         SGW and/or SCEF to release any non-included EPS Bearers after\n         step\u00c2\u00a014. The non-included bearers are locally released by the UE\n         following the Bearer Context Status synchronisation that occurs\n         during the Tracking Area Update at step\u00c2\u00a018.\n\n     If SIPTO at the Local Network is active for a PDN connection in the\n    architecture with stand-alone GW the source MME shall include the Local\n    Home Network ID of the source cell in the EPS Bearer context\n    corresponding to the SIPTO at the Local Network PDN connection.\n\n     RAN Cause indicates the S1AP Cause as received from source eNodeB.\n\n     The source MME includes the CSG ID in the Forward Relocation Request\n    when the target cell is a CSG or hybrid cell. When the target cell is a\n    hybrid cell, or if there are one or several emergency bearers and the\n    target cell is a CSG cell, the CSG Membership Indication indicating\n    whether the UE is a CSG member shall be included in the Forward\n    Relocation Request message.\n\n     The Direct Forwarding Flag indicates if direct forwarding is applied,\n    or if indirect forwarding is going to be set up by the source side.\n\n     The target MME shall determine the Maximum APN restriction based on\n    the APN Restriction of each bearer context in the Forward Relocation\n    Request, and shall subsequently store the new Maximum APN restriction\n    value.\n\n     If the UE receives only emergency services and the UE is UICCless,\n    IMSI can not be included in the MME UE context in Forward Relocation\n    Request message. For emergency attached UEs, if the IMSI cannot be\n    authenticated, then the IMSI shall be marked as unauthenticated. Also,\n    in this case, security parameters are included only if available.\n\n     If a UE is RLOS attached, the old MME includes an RLOS indication to\n    the new MME. If the RLOS attached UE in the old MME does not have a\n    USIM, IMSI can not be included in the Forward Relocation Request\n    message. If the RLOS attached UE has USIM but the IMSI cannot be\n    successfully authenticated, then the IMSI shall be marked as\n    unauthenticated. Also, in this case, security parameters are included\n    only if available.\n\n     If the Old MME is aware the UE is a LTE-M UE, it provides the LTE-M UE\n    Indication to the new MME.\n\n  4. If the MME has been relocated, the target MME verifies whether the\n    source Serving GW can continue to serve the UE. If not, it selects a\n    new Serving GW as described in clause 4.3.8.2 on \"Serving GW Selection\n    Function\". If the MME has not been relocated, the source MME decides on\n    this Serving GW re-selection.\n\n     If the source Serving GW continues to serve the UE, no message is sent\n    in this step. In this case, the target Serving GW is identical to the\n    source Serving GW.\n\n     If a new Serving GW is selected, the target MME sends a Create Session\n    Request (bearer context(s) with PDN GW addresses and TEIDs (for GTP-\n    based S5/S8) or GRE keys (for PMIP-based S5/S8) at the PDN GW(s) for\n    uplink traffic, Serving Network, UE Time Zone) message per PDN\n    connection to the target Serving GW. The target Serving GW allocates\n    the S-GW addresses and TEIDs for the uplink traffic on S1_U reference\n    point (one TEID per bearer). The target Serving GW sends a Create\n    Session Response (Serving GW addresses and uplink TEID(s) for user\n    plane) message back to the target MME.\n\n  5. The Target MME sends Handover Request (EPS Bearers to Setup, AMBR,\n    S1AP Cause, Source to Target transparent container, CSG ID, CSG\n    Membership Indication, Handover Restriction List, UE Radio Capability\n    ID) message to the target eNodeB. This message creates the UE context\n    in the target eNodeB, including information about the bearers, and the\n    security context. For each EPS Bearer, the Bearers to Setup includes\n    Serving GW address and uplink TEID for user plane, and EPS Bearer QoS.\n    If the direct forwarding flag indicates unavailability of direct\n    forwarding and the target MME knows that there is no indirect data\n    forwarding connectivity between source and target, the Bearers to Setup\n    shall include \"Data forwarding not possible\" indication for each EPS\n    bearer. Handover Restriction List is sent if available in the Target\n    MME; it is described in clause 4.3.5.7 \"Mobility Restrictions\".\n\n     S1AP Cause indicates the RAN Cause as received from source MME.\n\n     The Target MME shall include the CSG ID and CSG Membership Indication\n    when provided by the source MME in the Forward Relocation Request\n    message.\n\n     The target eNodeB sends a Handover Request Acknowledge (EPS Bearer\n    Setup list, EPS Bearers failed to setup list Target to Source\n    transparent container) message to the target MME. The EPS Bearer Setup\n    list includes a list of addresses and TEIDs allocated at the target\n    eNodeB for downlink traffic on S1-U reference point (one TEID per\n    bearer) and addresses and TEIDs for receiving forwarded data if\n    necessary. If the UE-AMBR is changed, e.g. all the EPS bearers which\n    are associated to the same APN are rejected in the target eNodeB, the\n    MME shall recalculate the new UE-AMBR and signal the modified UE-AMBR\n    value to the target eNodeB.\n\n     If none of the default EPS bearers have been accepted by the target\n    eNodeB, the target MME shall reject the handover as specified in\n    clause\u00c2\u00a05.5.1.2.3.\n\n     If the target cell is a CSG cell, the target eNodeB shall verify the\n    CSG ID provided by the target MME, and reject the handover with an\n    appropriate cause if it does not match the CSG ID for the target cell.\n    If the target eNodeB is in hybrid mode, it may use the CSG Membership\n    Indication to perform differentiated treatment for CSG and non-CSG\n    members. If the target cell is a CSG cell, and if the CSG Membership\n    Indication is \"non member\", the target eNodeB only accepts the\n    emergency bearers.\n\n     If the MME supports RACS as defined in clause\u00c2\u00a05.11.3a and has UE Radio\n    Capability ID stored in the UE's context it includes it in the Handover\n    Request message.\n\n  6. If indirect forwarding applies and the Serving GW is relocated, the\n    target MME sets up forwarding parameters by sending Create Indirect\n    Data Forwarding Tunnel Request (target eNodeB addresses and TEIDs for\n    forwarding) to the Serving GW. The Serving GW sends a Create Indirect\n    Data Forwarding Tunnel Response (target Serving GW addresses and TEIDs\n    for forwarding) to the target MME. If the Serving GW is not relocated,\n    indirect forwarding may be set up in step\u00c2\u00a08 below.\n\n     Indirect forwarding may be performed via a Serving GW which is\n    different from the Serving GW used as the anchor point for the UE.\n\n  7. If the MME has been relocated, the target MME sends a Forward\n    Relocation Response (Cause, Target to Source transparent container,\n    Serving GW change indication, EPS Bearer Setup List, Addresses and\n    TEIDs) message to the source MME. For indirect forwarding, this message\n    includes Serving GW Address and TEIDs for indirect forwarding (source\n    or target). Serving GW change indication indicates a new Serving GW has\n    been selected.\n\n  8. If indirect forwarding applies, the source MME sends Create Indirect\n    Data Forwarding Tunnel Request (addresses and TEIDs for forwarding) to\n    the Serving GW. If the Serving GW is relocated it includes the tunnel\n    identifier to the target serving GW.\n\n     The Serving GW responds with a Create Indirect Data Forwarding Tunnel\n    Response (Serving GW addresses and TEIDs for forwarding) message to the\n    source MME.\n\n     Indirect forwarding may be performed via a Serving GW which is\n    different from the Serving GW used as the anchor point for the UE.\n\n  9. The source MME sends a Handover Command (Target to Source transparent\n    container, Bearers subject to forwarding, Bearers to Release) message\n    to the source eNodeB. The Bearers subject to forwarding includes list\n    of addresses and TEIDs allocated for forwarding. The Bearers to Release\n    includes the list of bearers to be released.\n\n  9a.  The Handover Command is constructed using the Target to Source\n    transparent container and is sent to the UE. Upon reception of this\n    message the UE will remove any EPS bearers for which it did not receive\n    the corresponding EPS radio bearers in the target cell.\n\n  9b.  If the PLMN has configured Secondary RAT usage data reporting and\n    the source eNodeB has Secondary RAT usage data to report, the eNodeB\n    sends a RAN Usage data Report (Secondary RAT usage data, handover flag)\n    message to the source MME. The handover flag indicates to the MME that\n    it should buffer the report before forwarding the Secondary RAT usage\n    data.\n\n  10.  The source eNodeB sends the eNodeB Status Transfer message to the\n    target eNodeB via the MME(s) to convey the PDCP and HFN status of the E-\n    RABs for which PDCP status preservation applies, as specified in\n    TS\u00c2\u00a036.300\u00c2\u00a0[5]. The source eNodeB may omit sending this message if none\n    of the E-RABs of the UE shall be treated with PDCP status preservation.\n\n     If there is an MME relocation the source MME sends this information to\n    the target MME via the Forward Access Context Notification message\n    which the target MME acknowledges. The source MME or, if the MME is\n    relocated, the target MME, sends the information to the target eNodeB\n    via the MME Status Transfer message.\n\n  11.  The source eNodeB should start forwarding of downlink data from the\n    source eNodeB towards the target eNodeB for bearers subject to data\n    forwarding. This may be either direct (step 11a) or indirect forwarding\n    (step 11b).\n\n  12.  After the UE has successfully synchronized to the target cell, it\n    sends a Handover Confirm message to the target eNodeB. Downlink packets\n    forwarded from the source eNodeB can be sent to the UE. Also, uplink\n    packets can be sent from the UE, which are forwarded to the target\n    Serving GW and on to the PDN GW.\n\n  13.  The target eNodeB sends a Handover Notify (TAI+ECGI, Local Home\n    Network ID) message to the target MME. If Dual Connectivity is\n    activated for the UE, the PSCell ID shall be included in the Handover\n    Notify message.\n\n     For SIPTO at the Local Network with stand-alone GW architecture, the\n    target eNodeB shall include the Local Home Network ID of the target\n    cell in the Handover Notify message.\n\n  14.  If the MME has been relocated, the target MME sends a Forward\n    Relocation Complete Notification message to the source MME. The source\n    MME in response sends a Forward Relocation Complete Acknowledge\n    (Secondary RAT usage data) message to the target MME. The source MME\n    includes Secondary RAT usage data in this message if it received this\n    in step\u00c2\u00a09b. Regardless if MME has been relocated or not, a timer in\n    source MME is started to supervise when resources in Source eNodeB and\n    if the Serving GW is relocated, also resources in Source Serving GW\n    shall be released.\n\n     Upon receipt of the Forward Relocation Complete Acknowledge message\n    the target MME starts a timer if the target MME allocated S-GW\n    resources for indirect forwarding.\n\n     For all bearers that were not included in the Forward Relocation\n    Request message sent in step\u00c2\u00a03, the MME now releases them by sending a\n    Delete Bearer Command to the SGW, or, the appropriate message to the\n    SCEF.\n\n  15.  The MME sends a Modify Bearer Request (eNodeB address and TEID\n    allocated at the target eNodeB for downlink traffic on S1-U for the\n    accepted EPS bearers, ISR Activated, Secondary RAT usage data if PGW\n    secondary RAT usage data reporting is active) message to the target\n    Serving GW for each PDN connection, including the PDN connections that\n    need to be released. If the PDN GW requested location information\n    change reporting and/or User CSG information (determined from the UE\n    context), the MME also includes the User Location Information IE (if it\n    is different compared to the previously sent information) and/or User\n    CSG Information IE in this message. If the UE Time Zone has changed,\n    the MME includes the UE Time Zone IE in this message. If Serving GW is\n    not relocated but the Serving Network has changed or if the MME has not\n    received any old Serving Network information from the old MME, the MME\n    includes the Serving Network IE in this message. For the case that\n    neither MME nor S-GW changed, if ISR was activated before this\n    procedure MME should maintain ISR. The UE is informed about the ISR\n    status in the Tracking Area Update procedure. If the Serving GW\n    supports Modify Access Bearers Request procedure and if there is no\n    need for the SGW to send the signalling to the PDN GW, the MME may send\n    Modify Access Bearers Request (eNodeB address and TEID allocated at the\n    target eNodeB for downlink traffic on S1 U for the accepted EPS\n    bearers, ISR Activated) per UE to the Serving GW to optimise the\n    signalling. If Serving GW is not relocated and if Secondary RAT usage\n    data was received in step\u00c2\u00a09a, the MME includes the Secondary RAT usage\n    data in the message. If the Serving GW has been relocated and if PGW\n    Secondary RAT reporting is active, the MME includes the Secondary RAT\n    usage data and also includes a flag stating that the Serving GW should\n    not process the information and only forward it to the PDN GW.\n\n     The MME releases the non-accepted dedicated bearers by triggering the\n    bearer release procedure as specified in clause\u00c2\u00a05.4.4.2. If the Serving\n    GW receives a DL packet for a non-accepted bearer, the Serving GW drops\n    the DL packet and does not send a Downlink Data Notification to the\n    MME.\n\n     If the default bearer of a PDN connection has not been accepted by the\n    target eNodeB and there are other PDN connections active, the MME shall\n    handle it in the same way as if all bearers of a PDN connection have\n    not been accepted. The MME releases these PDN connections by triggering\n    the MME requested PDN disconnection procedure specified in\n    clause\u00c2\u00a05.10.3.\n\n     When the Modify Bearer Request does not indicate ISR Activated the\n    Serving GW deletes any ISR resources by sending a Delete Bearer Request\n    to the other CN node that has bearer resources on the Serving GW\n    reserved.\n\n  16.  If the Serving GW is relocated, the target Serving GW assigns\n    addresses and TEIDs (one per bearer) for downlink traffic from the PDN\n    GW. It sends a Modify Bearer Request (Serving GW addresses for user\n    plane and TEID(s), Serving Network, PDN Charging Pause Support\n    Indication, Secondary RAT usage data) message per PDN connection to the\n    PDN GW(s). The S-GW also includes User Location Information IE and/or\n    UE Time Zone IE and/or User CSG Information IE if they are present in\n    step\u00c2\u00a015. The Serving GW also includes Serving Network IE if it is\n    present in step\u00c2\u00a04 or step\u00c2\u00a015. The Serving GW allocates DL TEIDs on\n    S5/S8 even for non-accepted bearers. The PDN GW updates its context\n    field and returns a Modify Bearer Response (Charging Id, MSISDN, PDN\n    Charging Pause Enabled Indication (if PDN GW has chosen to enable the\n    function), etc.) message to the target Serving GW. The MSISDN is\n    included if the PDN GW has it stored in its UE context. The PDN GW\n    starts sending downlink packets to the target GW using the newly\n    received address and TEIDs. These downlink packets will use the new\n    downlink path via the target Serving GW to the target eNodeB. The\n    Secondary RAT usage data is included if it was received in step\u00c2\u00a015 and\n    if PGW secondary RAT usage data reporting is active.\n\n     If the Serving GW is not relocated, but has received the User Location\n    Information IE and/or UE Time Zone IE and/or User CSG Information IE\n    and/or Serving Network IE from the MME in step\u00c2\u00a015, the Serving GW shall\n    inform the PDN GW(s) about these information that e.g. can be used for\n    charging, by sending the message Modify Bearer Request (User Location\n    Information IE, UE Time Zone IE, User CSG Information IE, Serving\n    Network IE) to the PDN GW(s) concerned. A Modify Bearer Response\n    message is sent back to the Serving GW.\n\n     If the Serving GW is not relocated and it has not received User\n    Location Information IE nor UE Time Zone IE nor User CSG Information IE\n    nor Serving Network IE from the MME in step\u00c2\u00a015, no message is sent in\n    this step and downlink packets from the Serving-GW are immediately sent\n    on to the target eNodeB.\n\n     If the Serving GW is relocated, the PDN GW shall send one or more \"end\n    marker\" packets on the old path immediately after switching the path in\n    order to assist the reordering function in the target eNodeB. The\n    source Serving GW shall forward the \"end marker\" packets to the source\n    eNodeB. If data forwarding -direct or indirect) occurs, the source\n    eNodeB shall forward the \"end marker\" packets to the target eNodeB via\n    the forwarding tunnel.\n\n  17.  The Serving GW shall return a Modify Bearer Response (Serving GW\n    address and TEID for uplink traffic) message to the MME as a response\n    to a Modify Bearer Request message, or a Modify Access Bearers Response\n    (Serving GW address and TEID for uplink traffic) as a response to a\n    Modify Access Bearers Request message. If the Serving GW cannot serve\n    the MME Request in the Modify Access Bearers Request message without\n    S5/S8 signalling other than to unpause charging in the PDN GW or\n    without corresponding Gxc signalling when PMIP is used over the S5/S8\n    interface, it shall respond to the MME with indicating that the\n    modifications are not limited to S1-U bearers, and the MME shall repeat\n    its request using Modify Bearer Request message per PDN connection.\n\n     If the Serving GW does not change, the Serving GW shall send one or\n    more \"end marker\" packets on the old path immediately after switching\n    the path in order to assist the reordering function in the target\n    eNodeB. If data forwarding -direct or indirect) occurs, the source\n    eNodeB shall forward the \"end marker\" packets to the target eNodeB via\n    the forwarding tunnel.18.  The UE initiates a Tracking Area Update\n    procedure when one of the conditions listed in clause \"Triggers for\n    tracking area update\" applies.\n\n     For a UE supporting CIoT EPS Optimisations, the EPS bearer status\n    information shall be included in the TAU Request. The MME shall then\n    indicate the EPS bearer status to the UE in the TAU Accept and the UE\n    shall locally release any non-transferred bearer.\n\n     The target MME knows that it is a Handover procedure that has been\n    performed for this UE as it received the bearer context(s) by handover\n    messages and therefore the target MME performs only a subset of the TA\n    update procedure, specifically it excludes the context transfer\n    procedures between source MME and target MME. In this case, the target\n    MME shall set the Header Compression Context Status for each EPS Bearer\n    in the TAU Accept message based on information obtained in step\u00c2\u00a03.\n\n  19.  When the timer started in step 14 expires the source MME sends a UE\n    Context Release Command () message to the source eNodeB. The source\n    eNodeB releases its resources related to the UE and responds with a UE\n    Context Release Complete () message. When the timer started in step 14\n    expires and if the source MME received the Serving GW change indication\n    in the Forward Relocation Response message, it deletes the EPS bearer\n    resources by sending Delete Session Request (Cause, LBI, Operation\n    Indication, Secondary RAT usage data) messages to the Source Serving\n    GW. The operation Indication flag is not set, that indicates to the\n    Source Serving GW that the Source Serving GW shall not initiate a\n    delete procedure towards the PDN GW. Secondary RAT usage data is\n    included if it was received in step\u00c2\u00a09b. The Source Serving GW\n    acknowledges with Delete Session Response () messages. If ISR has been\n    activated before this procedure, the cause indicates to the Source S-GW\n    that the Source S-GW shall delete the bearer resources on the other old\n    CN node by sending Delete Bearer Request message(s) to that CN node.\n\n  20.  If indirect forwarding was used then the expiry of the timer at\n    source MME started at step\u00c2\u00a014 triggers the source MME to send a Delete\n    Indirect Data Forwarding Tunnel Request message to the S-GW to release\n    the temporary resources used for indirect forwarding that were\n    allocated at step\u00c2\u00a08.\n\n  21.  If indirect forwarding was used and the Serving GW is relocated,\n    then the expiry of the timer at target MME started at step\u00c2\u00a014 triggers\n    the target MME to send a Delete Indirect Data Forwarding Tunnel Request\n    message to the target S-GW to release temporary resources used for\n    indirect forwarding that were allocated at step\u00c2\u00a06.\n\n\n5.5.1.2.3   S1-based handover, Reject\n\nThe Target eNodeB rejects the use of the Handover procedure if none of the\nrequested bearers in the Handover Request message could be established. In\nthis case no UE context is established in the target MME/eNodeB and no\nresources are allocated. Further, the Target MME rejects the handover\nrequest and clears all resource in Target eNodeB and Target MME if the\nTarget eNodeB accepts the handover request but none of the default EPS\nbearers gets resources allocated. In both cases, the UE remains in the\nSource eNodeB/MME.\n\n                                    [pic]\n\n                Figure 5.5.1.2.3-1: S1-based handover, Reject\n\n  NOTE\u00c2\u00a01:  Steps 3, 4, 7 and 8 are performed if the MME is relocated.\n\n  NOTE\u00c2\u00a02:  If the MME is not relocated Steps 5 and 6 are performed by the\n         source MME and, in the description below, the source MME acts as\n         the target MME.\n\n  1-5. Steps 1 to 5 in the flow are identical to steps 1-5 in\n    clause\u00c2\u00a05.5.1.2.2.\n\n  6a.  If the Target eNodeB fails to allocate any resources for any of the\n    requested EPS bearers it sends a Handover Failure (Cause) message to\n    the Target MME. The Target MME clears any reserved resources for this\n    UE in the target MME.\n\n  6b.  If the Target MME receives a Handover Request Acknowledge message\n    from the Target eNodeB but none of the default EPS bearers are in the\n    EPS Bearer Setup list IE, the Target MME clears any reserved resources\n    for this UE in both the Target MME and the Target eNodeB.\n\n  7. This step is only performed for Serving GW relocation, i.e. if\n    steps\u00c2\u00a04/4a have been performed. The Target MME deletes the EPS bearer\n    resources by sending Delete Session Request (Cause) messages to the\n    Target Serving GW. The Target Serving GW acknowledges with Delete\n    Session Response (Cause) messages.\n\n  8. The Target MME sends the Forward Relocation Response (Cause) message\n    to the Source MME.\n\n  9. When the Source MME receives the Forward Relocation Response message,\n    it sends a Handover Preparation Failure (Cause) message to the Source\n    eNodeB.\n\n\n5.5.1.2.4   S1-based handover, Cancel\n\nInstead of completing the handover procedure, the source eNodeB may at any\ntime during the handover procedure, up to the time when a handover command\nmessage is sent to the UE cancel the handover.\n\nThe MME shall cancel the handover resources as defined in clause\u00c2\u00a05.5.2.5.1\nfor case the source RAN is eNodeB.\n\n\n"}, {"key": "Inter RAT handover", "numbering": "5.5.2", "title_level": 2, "desc": "5.5.2  Inter RAT handover\n\n\n"}, {"key": "General", "numbering": "5.5.2.0", "title_level": 3, "desc": "5.5.2.0  General\n\nDuring Inter RAT handover indirect forwarding may apply for the downlink\ndata forwarding performed as part of the handover. From its configuration\ndata the MME knows whether indirect forwarding applies and it allocates a\ndownlink data forwarding path on a Serving GWs for indirect forwarding.\nFrom its configuration data the S4 SGSN knows whether indirect forwarding\napplies and it allocates downlink data forwarding paths on Serving GWs for\nindirect forwarding. It is configured on MME and S4 SGSN whether indirect\ndownlink data forwarding does not apply, applies always or applies only for\ninter PLMN inter RAT handovers.\n\nDuring the handover procedure, the source MME shall reject any PDN GW\ninitiated EPS bearer(s) request received since handover procedure started\nand shall include an indication that the request has been temporarily\nrejected due to handover procedure in progress. The rejection is forwarded\nby the Serving GW to the PDN GW, with the indication that the request has\nbeen temporarily rejected.\n\nUpon reception of a rejection for an EPS bearer(s) PDN GW initiated\nprocedure with an indication that the request has been temporarily rejected\ndue to handover procedure in progress, the PDN GW behaves as specified in\nclause\u00c2\u00a05.5.1.2.1.\n\nFor inter-PLMN handover to a CSG cell, if the source MME/S4-SGSN has the\nCSG-ID list of the target PLMN, the source MME/S4-SGSN shall use it to\nvalidate the CSG membership of the UE in the target CSG cell. Otherwise,\nbased on operator's configuration the source MME/S4-SGSN may allow the\nhandover by validating the CSG membership of the UE in the target CSG cell\nusing the CSG-ID list of the registered PLMN-ID. If neither the CSG-ID list\nof the target PLMN nor the operator's configuration permits the handover,\nthe source MME/S4-SGSN shall reject the handover due to no CSG membership\ninformation of the target PLMN-ID\n\n  NOTE\u00c2\u00a01:  Inter-PLMN handover to a CSG cell in a PLMN which is not an\n         equivalent PLMN for the UE is not supported.\n\n  NOTE\u00c2\u00a02:  Inter-PLMN handover to a CSG cell of an equivalent PLMN is only\n         supported if the CSG-ID of the cell is in the CSG-ID list of both\n         equivalent PLMNs.\n\n  NOTE\u00c2\u00a03:  Upon bearer loss or UE-detected bearer QoS degradation during\n         inter-RAT 3GPP handover, after receiving the Handover Command the\n         UE can adopt an implementation dependent mechanism to trigger the\n         handover of one or more PDN connections or mobility of one or more\n         IP flows to WLAN (e.g. taking into account policies obtained from\n         ANDSF).\n\n\n"}, {"key": "E-UTRAN to UTRAN Iu mode Inter RAT handover", "numbering": "5.5.2.1", "title_level": 3, "desc": "5.5.2.1  E-UTRAN to UTRAN Iu mode Inter RAT handover\n\n\n"}, {"key": "General", "numbering": "5.5.2.1.1", "title_level": 4, "desc": "5.5.2.1.1   General\n\nPre-conditions:\n\n-  The UE is in ECM-CONNECTED state (E-UTRAN mode).\n\nIf emergency bearer services are ongoing for an UE, handover to the target\nRNC is performed independent of the Handover Restriction List. The SGSN\nchecks, as part of the Routing Area Update in the execution phase, if the\nhandover is to a restricted area and if so SGSN deactivate the non-\nemergency PDP context as specified in TS\u00c2\u00a023.060\u00c2\u00a0[7], clause\u00c2\u00a09.2.4.2.\n\nIf emergency bearer services are ongoing for the UE, the source MME\nevaluates the handover to the target CSG cell independent of the UE's CSG\nsubscription. If the handover is to a CSG cell that the UE is not\nsubscribed, the target RNC will only accept the emergency bearers and the\ntarget SGSN deactivates the non-emergency PDP contexts that were not\naccepted by the target RNC as specified in TS\u00c2\u00a023.060\u00c2\u00a0[7], clause\u00c2\u00a09.2.4.2.\n\n\n"}, {"key": "Preparation phase", "numbering": "5.5.2.1.2", "title_level": 4, "desc": "5.5.2.1.2   Preparation phase\n\n                                    [pic]\n\n   Figure 5.5.2.1.2-1: E-UTRAN to UTRAN Iu mode Inter RAT HO, preparation\n                                    phase\n\n  1. The source eNodeB decides to initiate an Inter-RAT handover to the\n    target access network, UTRAN Iu mode. At this point both uplink and\n    downlink user data is transmitted via the following: Bearer(s) between\n    UE and source eNodeB, GTP tunnel(s) between source eNodeB, Serving GW\n    and PDN GW.\n\n     If the UE has an ongoing emergency bearer service the source eNodeB\n    shall not initiate PS handover to a UTRAN cell that is not IMS voice\n    capable.\n\n  NOTE\u00c2\u00a01:  The process leading to the handover decision is outside of the\n         scope of this specification.\n\n  2. The source eNodeB sends a Handover Required (S1AP Cause, Target RNC\n    Identifier, CSG ID, CSG access mode, Source to Target Transparent\n    Container) message to the source MME to request the CN to establish\n    resources in the target RNC, target SGSN and the Serving GW. The\n    bearers that will be subject to data forwarding (if any) are identified\n    by the target SGSN in a later step (see step\u00c2\u00a07 below). When the target\n    cell is a CSG cell or a hybrid cell, the source eNodeB shall include\n    the CSG ID of the target cell. If the target cell is a hybrid cell, the\n    CSG access mode shall be indicated.\n\n  3. The source MME determines from the 'Target RNC Identifier' IE that the\n    type of handover is IRAT Handover to UTRAN Iu mode. The source MME\n    selects the target SGSN as described in clause\u00c2\u00a04.3.8.4 on \"SGSN\n    Selection Function\". The Source MME initiates the Handover resource\n    allocation procedure by sending a Forward Relocation Request (IMSI,\n    Target Identification, CSG ID, CSG Membership Indication, MM Context,\n    PDN Connections, MME Tunnel Endpoint Identifier for Control Plane, MME\n    Address for Control plane, Source to Target Transparent Container, RAN\n    Cause, MS Info Change Reporting Action (if available), CSG Information\n    Reporting Action (if available), UE Time Zone, ISR Supported, Serving\n    Network) message to the target SGSN. The information ISR Supported is\n    indicated if the source MME and associated Serving GW are capable to\n    activate ISR for the UE. When ISR is activated the message should be\n    sent to the SGSN that maintains ISR for the UE when this SGSN is\n    serving the target identified by the Target Identification. This\n    message includes all PDN Connections active in the source system and\n    for each PDN Connection includes the associated APN, the address and\n    the uplink Tunnel endpoint parameters of the Serving GW for control\n    plane, and a list of EPS Bearer Contexts. RAN Cause indicates the S1AP\n    Cause as received from source eNodeB. The old Serving Network is sent\n    to target MME to support the target MME to resolve if Serving Network\n    is changed.\n\n     The source MME shall perform access control by checking the UE's CSG\n    subscription when CSG ID is provided by the source eNodeB. If there is\n    no subscription data for this CSG ID or the CSG subscription is\n    expired, and the target cell is a CSG cell, the source MME shall reject\n    the handover with an appropriate cause unless the UE has emergency\n    bearer services.\n\n     The source MME includes the CSG ID in the Forward Relocation Request\n    when the target cell is a CSG cell or hybrid cell. When the target cell\n    is a hybrid cell, or if there are one or several emergency bearers and\n    the target cell is a CSG cell, the CSG Membership Indication indicating\n    whether the UE is a CSG member shall be included in the Forward\n    Relocation Request message.\n\n     The MM context includes information on the EPS Bearer context(s). The\n    source MME does not include any EPS Bearer Context information for \"Non-\n    IP\" bearers or for any SCEF connection. If none of the UE's EPS Bearers\n    can be supported by the selected target SGSN, the source MME rejects\n    the handover attempt by sending a Handover Preparation Failure (Cause)\n    message to the Source eNodeB.\n\n  NOTE\u00c2\u00a02:  If the handover is successful, the source MME will signal to the\n         SGW and/or SCEF to release any non-included EPS Bearers after\n         step\u00c2\u00a06 of the Execution procedure. The non-included bearers are\n         locally released by the UE following the Bearer Context Status\n         synchronisation that occurs during the Routing Area Update at\n         step\u00c2\u00a010 of the Execution procedure.\n\n     The target SGSN maps the EPS bearers to PDP contexts 1-to-1 and maps\n    the EPS Bearer QoS parameter values of an EPS bearer to the Release\u00c2\u00a099\n    QoS parameter values of a bearer context as defined in Annex E\n\n     Prioritization of PDP Contexts is performed by the target core network\n    node, i.e. target SGSN.\n\n     The MM context contains security related information, e.g. supported\n    ciphering algorithms as described in TS\u00c2\u00a029.274\u00c2\u00a0[43]. Handling of\n    security keys is described in TS\u00c2\u00a033.401\u00c2\u00a0[41].\n\n     The target SGSN shall determine the Maximum APN restriction based on\n    the APN Restriction of each bearer context in the Forward Relocation\n    Request, and shall subsequently store the new Maximum APN restriction\n    value.\n\n     If SIPTO at the Local Network is active for a PDN connection in the\n    architecture with stand-alone GW the source MME shall include the Local\n    Home Network ID of the source cell in the PDN Connections corresponding\n    to the SIPTO at the Local Network PDN connection.\n\n  4. The target SGSN determines if the Serving GW is to be relocated, e.g.,\n    due to PLMN change. If the Serving GW is to be relocated, the target\n    SGSN selects the target Serving GW as described under clause 4.3.8.2 on\n    \"Serving GW selection function\", and sends a Create Session Request\n    message (IMSI, SGSN Tunnel Endpoint Identifier for Control Plane, SGSN\n    Address for Control plane, PDN GW address(es) for user plane, PDN GW UL\n    TEID(s) for user plane, PDN GW address(es) for control plane, and PDN\n    GW TEID(s) for control plane, the Protocol Type over S5/S8, Serving\n    Network) per PDN connection to the target Serving GW. The Protocol Type\n    over S5/S8 is provided to Serving GW which protocol should be used over\n    S5/S8 interface.\n\n     The target SGSN establishes the EPS Bearer context(s) in the indicated\n    order. The SGSN deactivates, as provided in step\u00c2\u00a07 of the execution\n    phase, the EPS Bearer contexts which cannot be established.\n\n  4a.  The target Serving GW allocates its local resources and returns a\n    Create Session Response (Serving GW address(es) for user plane, Serving\n    GW UL TEID(s) for user plane, Serving GW Address for control plane,\n    Serving GW TEID for control plane) message to the target SGSN.\n\n  5. The target SGSN requests the target RNC to establish the radio network\n    resources (RABs) by sending the message Relocation Request (UE\n    Identifier, Cause, CN Domain Indicator, Integrity protection\n    information (i.e. IK and allowed Integrity Protection algorithms),\n    Encryption information (i.e. CK and allowed Ciphering algorithms), RAB\n    to be setup list, CSG ID, CSG Membership Indication, Source RNC to\n    Target RNC Transparent Container, Service Handover related\n    information). If the Access Restriction is present in the MM context,\n    the Service Handover related information shall be included by the\n    target SGSN for the Relocation Request message in order for RNC to\n    restrict the UE in connected mode to handover to the RAT prohibited by\n    the Access Restriction.\n\n     For each RAB requested to be established, RABs To Be Setup shall\n    contain information such as RAB ID, RAB parameters, Transport Layer\n    Address, and Iu Transport Association. The RAB ID information element\n    contains the NSAPI value, and the RAB parameters information element\n    gives the QoS profile. The Transport Layer Address is the Serving GW\n    Address for user plane (if Direct Tunnel is used) or the SGSN Address\n    for user plane (if Direct Tunnel is not used), and the Iu Transport\n    Association corresponds to the uplink Tunnel Endpoint Identifier Data\n    in Serving GW or SGSN respectively.\n\n     Ciphering and integrity protection keys are sent to the target RNC to\n    allow data transfer to continue in the new RAT/mode target cell without\n    requiring a new AKA (Authentication and Key Agreement) procedure.\n    Information that is required to be sent to the UE (either in the\n    Relocation Command message or after the handover completion message)\n    from RRC in the target RNC shall be included in the RRC message sent\n    from the target RNC to the UE via the transparent container. More\n    details are described in TS\u00c2\u00a033.401\u00c2\u00a0[41].\n\n     The Target SGSN shall include the CSG ID and CSG Membership Indication\n    when provided by the source MME in the Forward Relocation Request\n    message.\n\n     In the target RNC radio and Iu user plane resources are reserved for\n    the accepted RABs. Cause indicates the RAN Cause as received from\n    source MME. The Source RNC to Target RNC Transparent Container includes\n    the value from the Source to Target Transparent Container received from\n    the source eNodeB.\n\n     If the target cell is a CSG cell, the target RNC shall verify the CSG\n    ID provided by the target SGSN, and reject the handover with an\n    appropriate cause if it does not match the CSG ID for the target cell.\n    If the target cell is in hybrid mode, the target RNC may use the CSG\n    Membership Indication to perform differentiated treatment for CSG and\n    non-CSG members. If the target cell is a CSG cell, and if the CSG\n    Membership Indication is \"non member\", the target RNC only accepts the\n    emergency bearers.\n\n  5a.  The target RNC allocates the resources and returns the applicable\n    parameters to the target SGSN in the message Relocation Request\n    Acknowledge (Target RNC to Source RNC Transparent Container, RABs setup\n    list, RABs failed to setup list).\n\n     Upon sending the Relocation Request Acknowledge message the target RNC\n    shall be prepared to receive downlink GTP PDUs from the Serving GW, or\n    Target SGSN if Direct Tunnel is not used, for the accepted RABs.\n\n     Each RABs setup list is defined by a Transport Layer Address, which is\n    the target RNC Address for user data, and the Iu Transport Association,\n    which corresponds to the downlink Tunnel Endpoint Identifier for user\n    data.\n\n     Any EPS Bearer contexts for which a RAB was not established are\n    maintained in the target SGSN and the UE. These EPS Bearer contexts\n    shall be deactivated by the target SGSN via explicit SM procedures upon\n    the completion of the routing area update (RAU) procedure.\n\n  6. If 'Indirect Forwarding' and relocation of Serving GW apply and Direct\n    Tunnel is used the target SGSN sends a Create Indirect Data Forwarding\n    Tunnel Request message (Target RNC Address and TEID(s) for DL data\n    forwarding) to the Serving GW. If 'Indirect Forwarding' and relocation\n    of Serving GW apply and Direct Tunnel is not used, then the target SGSN\n    sends a Create Indirect Data Forwarding Tunnel Request message (SGSN\n    Address and TEID(s) for DL data forwarding) to the Serving GW.\n\n     Indirect forwarding may be performed via a Serving GW which is\n    different from the Serving GW used as the anchor point for the UE.\n\n  6a.  The Serving GW returns a Create Indirect Data Forwarding Tunnel\n    Response (Cause, Serving GW Address(es) and Serving GW DL TEID(s) for\n    data forwarding) message to the target SGSN.\n\n  7. The target SGSN sends the message Forward Relocation Response (Cause,\n    SGSN Tunnel Endpoint Identifier for Control Plane, SGSN Address for\n    Control Plane, Target to Source Transparent Container, Cause, RAB Setup\n    Information, Additional RAB Setup Information, Address(es) and TEID(s)\n    for User Traffic Data Forwarding, Serving GW change indication) to the\n    source MME. Serving GW change indication indicates a new Serving GW has\n    been selected. The Target to Source Transparent Container contains the\n    value from the Target RNC to Source RNC Transparent Container received\n    from the target RNC.\n\n     The IE 'Address(es) and TEID(s) for User Traffic Data Forwarding'\n    defines the destination tunnelling endpoint for data forwarding in\n    target system, and it is set as follows:\n\n    -  If 'Direct Forwarding' applies, or if 'Indirect Forwarding' and no\n       relocation of Serving GW apply and Direct Tunnel is used, then the IE\n       'Address(es) and TEID(s) for User Traffic Data Forwarding' contains\n       the addresses and GTP-U tunnel endpoint parameters to the Target RNC\n       received in step\u00c2\u00a05a.\n\n    -  If 'Indirect Forwarding' and relocation of Serving GW apply, then\n       the IE 'Address(es) and TEID(s) for User Traffic Data Forwarding'\n       contains the addresses and DL GTP-U tunnel endpoint parameters to the\n       Serving GW received in step\u00c2\u00a06. This is independent from using Direct\n       Tunnel or not.\n\n    -  If 'Indirect Forwarding' applies and Direct Tunnel is not used and\n       relocation of Serving GW does not apply, then the IE 'Address(es) and\n       TEID(s) for User Traffic Data Forwarding' contains the DL GTP-U\n       tunnel endpoint parameters to the Target SGSN.\n\n  8. If \"Indirect Forwarding\" applies, the Source MME sends the message\n    Create Indirect Data Forwarding Tunnel Request (Address(es) and TEID(s)\n    for Data Forwarding (received in step 7)), EPS Bearer ID(s)) to the\n    Serving GW used for indirect forwarding.\n\n     Indirect forwarding may be performed via a Serving GW which is\n    different from the Serving GW used as the anchor point for the UE.\n\n  8a.  The Serving GW returns the forwarding parameters by sending the\n    message Create Indirect Data Forwarding Tunnel Response (Cause, Serving\n    GW Address(es) and TEID(s) for Data Forwarding). If the Serving GW\n    doesn't support data forwarding, an appropriate cause value shall be\n    returned and the Serving GW Address(es) and TEID(s) will not be\n    included in the message.\n\n\n"}, {"key": "Execution phase", "numbering": "5.5.2.1.3", "title_level": 4, "desc": "5.5.2.1.3   Execution phase\n\n                                    [pic]\n\n Figure 5.5.2.1.3-1: E-UTRAN to UTRAN Iu mode Inter RAT HO, execution phase\n\n  NOTE:  For a PMIP-based S5/S8, procedure steps (A) and (B) are defined in\n         TS\u00c2\u00a023.402\u00c2\u00a0[2]. Step (B) shows PCRF interaction in the case of PMIP-\n         based S5/S8. Steps 8 and 8a concern GTP based S5/S8\n\n     The source eNodeB continues to receive downlink and uplink user plane\n    PDUs.\n\n  1. The source MME completes the preparation phase towards source eNodeB\n    by sending the message Handover Command (Target to Source Transparent\n    Container, E-RABs to Release List, Bearers Subject to Data Forwarding\n    List). The \"Bearers Subject to Data forwarding list\" IE may be included\n    in the message and it shall be a list of 'Address(es) and TEID(s) for\n    user traffic data forwarding' received from target side in the\n    preparation phase (Step\u00c2\u00a07 of the preparation phase) when 'Direct\n    Forwarding' applies, or the parameters received in Step\u00c2\u00a08a of the\n    preparation phase when 'Indirect Forwarding' applies.\n\n     The source eNodeB initiates data forwarding for bearers specified in\n    the \"Bearers Subject to Data Forwarding List\". The data forwarding may\n    go directly to target RNC or alternatively go via the Serving GW if so\n    decided by source MME and or/ target SGSN in the preparation phase.\n\n  2. The source eNodeB will give a command to the UE to handover to the\n    target access network via the message HO from E-UTRAN Command. This\n    message includes a transparent container including radio aspect\n    parameters that the target RNC has set-up in the preparation phase. The\n    details of this E-UTRAN specific signalling are described in\n    TS\u00c2\u00a036.300\u00c2\u00a0[5].\n\n     Upon the reception of the HO from E-UTRAN Command message containing\n    the Handover Command message, the UE shall associate its bearer IDs to\n    the respective RABs based on the relation with the NSAPI and shall\n    suspend the uplink transmission of the user plane data.\n\n  3. If the PLMN has configured Secondary RAT usage data reporting and the\n    source eNodeB has Secondary RAT usage data to report, the eNodeB sends\n    the RAN Usage data report message (Secondary RAT usage data) to the\n    MME. Since the handover is an inter-RAT handover, the MME continues\n    with the Secondary RAT usage data reporting procedure as in\n    clause\u00c2\u00a05.7A.3. The reporting procedure in clause\u00c2\u00a05.7A.3 is only\n    performed if PGW secondary RAT usage reporting is active.\n\n  4. The UE moves to the target UTRAN Iu (3G) system and executes the\n    handover according to the parameters provided in the message delivered\n    in step 2. The procedure is the same as in step 6 and 8 in clause\n    5.2.2.2 in TS\u00c2\u00a043.129\u00c2\u00a0[8] with the additional function of association of\n    the received RABs and existing Bearer Id related to the particular\n    NSAPI.\n\n     The UE may resume the user data transfer only for those NSAPIs for\n    which there are radio resources allocated in the target RNC.\n\n  5. When the new source RNC-ID + S-RNTI are successfully exchanged with\n    the UE, the target RNC shall send the Relocation Complete message to\n    the target SGSN. The purpose of the Relocation Complete procedure is to\n    indicate by the target RNC the completion of the relocation from the\n    source E-UTRAN to the RNC. After the reception of the Relocation\n    Complete message the target SGSN shall be prepared to receive data from\n    the target RNC. Each uplink N-PDU received by the target SGSN is\n    forwarded directly to the Serving GW.\n\n     For SIPTO at the Local Network with stand-alone GW architecture, the\n    target RNC shall include the Local Home Network ID of the target cell\n    in the Relocation Complete message.\n\n  6. Then the target SGSN knows that the UE has arrived to the target side\n    and target SGSN informs the source MME by sending the Forward\n    Relocation Complete Notification (ISR Activated, Serving GW change)\n    message. If indicated, ISR Activated indicates to the source MME that\n    it shall maintain the UE's context and that it shall activate ISR,\n    which is only possible when the S-GW is not changed. The source MME\n    will also acknowledge that information. A timer in source MME is\n    started to supervise when resources in Source eNodeB and Source Serving\n    GW (for Serving GW relocation) shall be released.\n\n     When the timer expires and ISR Activated is not indicated by the\n    target SGSN the source MME releases all bearer resources of the UE. If\n    Serving GW change is indicated and this timer expires the source MME\n    deletes the EPS bearer resources by sending Delete Session Request\n    (Cause, Operation Indication) messages to the Source Serving GW. The\n    operation Indication flag is not set, that indicates to the Source\n    Serving GW that the Source Serving GW shall not initiate a delete\n    procedure towards the PDN GW. If ISR has been activated before this\n    procedure, the cause indicates to the Source S-GW that the Source S-GW\n    shall delete the bearer resources on the other old CN node by sending\n    Delete Bearer Request message(s) to that CN node.\n\n     Upon receipt of the Forward Relocation Complete Acknowledge message\n    the target SGSN starts a timer if the target SGSN allocated S-GW\n    resources for indirect forwarding.\n\n     For all bearers that were not included in the Forward Relocation\n    Request message sent in step\u00c2\u00a03, the MME now releases them by sending a\n    Delete Bearer Command to the SGW, or, the appropriate message to the\n    SCEF.\n\n  7. The target SGSN will now complete the Handover procedure by informing\n    the Serving GW (for Serving GW relocation this will be the Target\n    Serving GW) that the target SGSN is now responsible for all the EPS\n    Bearer Contexts the UE has established. This is performed in the\n    message Modify Bearer Request (SGSN Tunnel Endpoint Identifier for\n    Control Plane, NSAPI(s), SGSN Address for Control Plane, SGSN\n    Address(es) and TEID(s) for User Traffic for the accepted EPS bearers\n    (if Direct Tunnel is not used) or RNC Address(es) and TEID(s) for User\n    Traffic for the accepted EPS bearers (if Direct Tunnel is used) and RAT\n    type, ISR Activated) per PDN connection. As it is a mobility from E-\n    UTRAN, if the target SGSN supports location information change\n    reporting, the target SGSN shall include the User Location Information\n    (according to the supported granularity) in the Modify Bearer Request,\n    regardless of whether location information change reporting had been\n    requested in the previous RAT by the PDN GW. If the PDN GW requested\n    User CSG information (determined from the UE context), the SGSN also\n    includes the User CSG Information IE in this message. If the UE Time\n    Zone has changed, the SGSN includes the UE Time Zone IE in this\n    message. If Serving GW is not relocated but the Serving Network has\n    changed or if the SGSN has not received any old Serving Network\n    information from the old MME, the SGSN includes the new Serving Network\n    IE in this message. In network sharing scenarios Serving Network\n    denotes the serving core network. If indicated, the information ISR\n    Activated indicates that ISR is activated, which is only possible when\n    the S-GW is not changed. When the Modify Bearer Request does not\n    indicate ISR Activated and S-GW is not changed, the S-GW deletes any\n    ISR resources by sending a Delete Bearer Request to the other CN node\n    that has bearer resources on the S-GW reserved.\n\n     The SGSN releases the non-accepted EPS Bearer contexts by triggering\n    the Bearer Context deactivation procedure. If the Serving GW receives a\n    DL packet for a non-accepted bearer, the Serving GW drops the DL packet\n    and does not send a Downlink Data Notification to the SGSN.\n\n  8. The Serving GW (for Serving GW relocation this will be the Target\n    Serving GW) may inform the PDN GW(s) the change of for example for\n    Serving GW relocation or the RAT type that e.g. can be used for\n    charging, by sending the message Modify Bearer Request per PDN\n    connection. The S-GW also includes User Location Information IE and/or\n    UE Time Zone IE and/or User CSG Information IE if they are present in\n    step\u00c2\u00a07. Serving Network should be included if it is received in step\u00c2\u00a07\n    or in step\u00c2\u00a04 in clause\u00c2\u00a05.5.2.1.2. For Serving GW relocation, the\n    Serving GW allocates DL TEIDs on S5/S8 even for non-accepted bearers\n    and may include the PDN Charging Pause Support Indication. The PDN GW\n    must acknowledge the request with the message Modify Bearer Response.\n    In the case of Serving GW relocation, the PDN GW updates its context\n    field and returns a Modify Bearer Response (Charging Id, MSISDN, PDN\n    Charging Pause Enabled Indication (if PDN GW has chosen to enable the\n    function), etc.) message to the Serving GW. The MSISDN is included if\n    the PDN GW has it stored in its UE context. If location information\n    change reporting is required and supported in the target SGSN, the PDN\n    GW shall provide MS Info Change Reporting Action in the Modify Bearer\n    Response.\n\n     If PCC infrastructure is used, the PDN GW informs the PCRF about the\n    change of, for example, the RAT type.\n\n     If the Serving GW is relocated, the PDN GW shall send one or more \"end\n    marker\" packets on the old path immediately after switching the path.\n    The source Serving GW shall forwards the \"end marker\" packets to the\n    source eNodeB.\n\n  9. The Serving GW (for Serving GW relocation this will be the Target\n    Serving GW) acknowledges the user plane switch to the target SGSN via\n    the message Modify Bearer Response (Cause, Serving GW Tunnel Endpoint\n    Identifier for Control Plane, Serving GW Address for Control Plane,\n    Protocol Configuration Options, MS Info Change Reporting Action). At\n    this stage the user plane path is established for all EPS Bearer\n    contexts between the UE, target RNC, target SGSN if Direct Tunnel is\n    not used, Serving GW (for Serving GW relocation this will be the Target\n    Serving GW) and PDN GW.\n\n     If the Serving GW does not change, the Serving GW shall send one or\n    more \"end marker\" packets on the old path immediately after switching\n    the path.\n\n  10.  When the UE recognises that its current Routing Area is not\n    registered with the network, or when the UE's TIN indicates \"GUTI\", the\n    UE initiates a Routing Area Update procedure with the target SGSN\n    informing it that the UE is located in a new routing area. It is RAN\n    functionality to provide the PMM-CONNECTED UE with Routing Area\n    information.\n\n     The target SGSN knows that an IRAT Handover has been performed for\n    this UE as it received the bearer context(s) by handover messages and\n    therefore the target SGSN performs only a subset of the RAU procedure,\n    specifically it excludes the context transfer procedures between source\n    MME and target SGSN.\n\n     For a UE supporting CIoT EPS Optimisations, the UE uses the bearer\n    status information in the RAU Accept to identify any non-transferred\n    bearers that it shall locally release.\n\n  11.  When the timer started at step\u00c2\u00a06 expires, the source MME sends a\n    Release Resources message to the Source eNodeB. The Source eNodeB\n    releases its resources related to the UE.\n\n     When the timer started in step 6 expires and if the source MME\n    received the Serving GW change indication in the Forward Relocation\n    Response message, it deletes the EPS bearer resources by sending Delete\n    Session Request (Cause, Operation Indication, Secondary RAT usage data)\n    messages to the Source Serving GW. The operation indication flag is not\n    set, that indicates to the Source Serving GW that the Source Serving GW\n    shall not initiate a delete procedure towards the PDN GW. Secondary RAT\n    usage data is included if it was received in step\u00c2\u00a03. The Source Serving\n    GW acknowledges with Delete Session Response (Cause) messages. If ISR\n    has been activated before this procedure, the cause indicates to the\n    Source S-GW that the Source S-GW shall delete the bearer resources on\n    the other old CN node by sending Delete Bearer Request message(s) to\n    that CN node.\n\n  12.  If indirect forwarding was used then the expiry of the timer at\n    source MME started at step\u00c2\u00a06 triggers the source MME to send a Delete\n    Indirect Data Forwarding Tunnel Request message to the S-GW to release\n    the temporary resources used for indirect forwarding.\n\n  13.  If indirect forwarding was used and the Serving GW is relocated,\n    then the expiry of the timer at target SGSN started at step\u00c2\u00a06 triggers\n    the target SGSN to send a Delete Indirect Data Forwarding Tunnel\n    Request message to the target S-GW to release temporary resources used\n    for indirect forwarding.\n\n\n"}, {"key": "E-UTRAN to UTRAN Iu mode Inter RAT handover Reject", "numbering": "5.5.2.1.4", "title_level": 4, "desc": "5.5.2.1.4   E-UTRAN to UTRAN Iu mode Inter RAT handover Reject\n\nThe Target RNC may reject the use of the Handover procedure if none of the\nrequested RABs in the Relocation Request message could be established. In\nthis case no UE context is established in the target SGSN/RNC and no\nresources are allocated. The UE remains in the Source eNodeB/MME.\n\n                                    [pic]\n\n      Figure 5.5.2.1.4-1: E-UTRAN to UTRAN Iu mode Inter RAT HO reject\n\n  1. The Step 1 to 5 in the flow are identical to the ones in\n    clause\u00c2\u00a05.5.2.1.2.\n\n  6. If the Target RNC fails to allocate any resources for any of the\n    requested RABs it sends a Relocation Failure (Cause) message to the\n    Target SGSN. When the Target SGSN receives the Relocation Failure\n    message from Target RNC the Target SGSN clears any reserved resources\n    for this UE.\n\n  7. This step is only performed for Serving GW relocation, i.e. if\n    Steps\u00c2\u00a04/4a have been performed. The Target SGSN deletes the EPS bearer\n    resources by sending Delete Session Request (Cause) messages to the\n    Target Serving GW. The Target Serving GW acknowledges with Delete\n    Session Response (Cause) messages.\n\n  8. The Target SGSN sends the Forward Relocation Response (Cause) message\n    to the Source MME.\n\n  9. When the Source MME receives the Forward Relocation Response message\n    it send a Handover Preparation Failure (Cause) message to the Source\n    eNodeB.\n\n\n"}, {"key": "UTRAN Iu mode to E-UTRAN Inter RAT handover", "numbering": "5.5.2.2", "title_level": 3, "desc": "5.5.2.2  UTRAN Iu mode to E-UTRAN Inter RAT handover\n\n\n"}, {"key": "General", "numbering": "5.5.2.2.1", "title_level": 4, "desc": "5.5.2.2.1   General\n\nThe UTRAN Iu mode to E-UTRAN Inter RAT handover procedure takes place when\nthe network decides to perform a handover. The decision to perform PS\nhandover from UTRAN Iu mode to E-UTRAN is taken by the network based on\nradio condition measurements reported by the UE to the UTRAN RNC.\n\nIf emergency bearer services are ongoing for the UE, the MME checks as part\nof the Tracking Area Update in the execution phase, if the handover is to a\nrestricted area and if so MME releases the non-emergency bearers as\nspecified in clause\u00c2\u00a05.10.3.\n\nIf emergency bearer services are ongoing for the UE, the source SGSN\nevaluates the handover to the target CSG cell independent of the UE's CSG\nsubscription. If the handover is to a CSG cell that the UE is not\nsubscribed, the target eNodeB only accepts the emergency bearers and the\ntarget MME releases the non-emergency PDN connections that were not\naccepted by the target eNodeB as specified in clause\u00c2\u00a05.10.3.\n\n\n"}, {"key": "Preparation phase", "numbering": "5.5.2.2.2", "title_level": 4, "desc": "5.5.2.2.2   Preparation phase\n\n                                    [pic]\n\n   Figure 5.5.2.2.2-1: UTRAN Iu mode to E-UTRAN Inter RAT HO, preparation\n                                    phase\n\n  1. The source RNC decides to initiate an Inter-RAT handover to the E-\n    UTRAN. At this point both uplink and downlink user data is transmitted\n    via the following: Bearers between UE and source RNC, GTP tunnel(s)\n    between source RNC, source SGSN (only if Direct Tunnel is not used),\n    Serving GW and PDN GW.\n\n  NOTE\u00c2\u00a01:  The process leading to the handover decision is outside of the\n         scope of this specification.\n\n  2. The source RNC sends a Relocation Required (Cause, Target eNodeB\n    Identifier, CSG ID, CSG access mode, Source RNC Identifier, Source RNC\n    to Target RNC Transparent Container) message to the source SGSN to\n    request the CN to establish resources in the target eNodeB, Target MME\n    and the Serving GW. The bearers that will be subject to data forwarding\n    (if any) are identified by the target MME in a later step (see step\u00c2\u00a07\n    below). When the target cell is a CSG cell or a hybrid cell, the source\n    RNC shall include the CSG ID of the target cell. If the target cell is\n    a hybrid cell, the CSG access mode shall be indicated.\n\n  3. The source SGSN determines from the 'Target eNodeB Identifier' IE that\n    the type of handover is IRAT Handover to E-UTRAN. The source SGSN\n    selects the target MME as described in clause\u00c2\u00a04.3.8.3 on \"MME Selection\n    Function\". The Source SGSN initiates the Handover resource allocation\n    procedure by sending Forward Relocation Request (IMSI, Target\n    Identification, CSG ID, CSG Membership Indication, MM Context, PDN\n    Connections, SGSN Tunnel Endpoint Identifier for Control Plane, SGSN\n    Address for Control plane, Source to Target Transparent Container, RAN\n    Cause, MS Info Change Reporting Action (if available), CSG Information\n    Reporting Action (if available), UE Time Zone, ISR Supported, Serving\n    Network, Change to Report (if present)) message to the target MME. This\n    message includes all EPS Bearer contexts corresponding to all the\n    bearers established in the source system and the uplink Tunnel endpoint\n    parameters of the Serving GW. If the information ISR Supported is\n    indicated, this indicates that the source SGSN and associated Serving\n    GW are capable to activate ISR for the UE. When ISR is activated the\n    message should be sent to the MME that maintains ISR for the UE when\n    this MME is serving the target identified by the Target Identification.\n    RAN Cause indicates the Cause as received from source RNC. The Source\n    to Target Transparent Container contains the value from the Source RNC\n    to Target RNC Transparent Container received from the Source RNC. The\n    old Serving Network is sent to target MME to support the target MME to\n    resolve if Serving Network is changed.\n\n     Change to Report flag is included by the source SGSN if reporting of\n    change of UE Time Zone, or Serving Network, or both towards Serving GW\n    / PDN GW was deferred by the source SGSN.\n\n     The source SGSN shall perform access control by checking the UE's CSG\n    subscription when CSG ID is provided by the source RNC. If there is no\n    subscription data for this CSG ID or the CSG subscription is expired,\n    and the target cell is a CSG cell, the source SGSN shall reject the\n    handover with an appropriate cause unless the UE has emergency bearer\n    services.\n\n     The source SGSN includes the CSG ID in the Forward Relocation Request\n    when the target cell is a CSG cell or hybrid cell. When the target cell\n    is a hybrid cell, or if there are one or several emergency bearers and\n    the target cell is a CSG cell, the CSG Membership Indication indicating\n    whether the UE is a CSG member shall be included in the Forward\n    Relocation Request message.\n\n     This message includes all PDN Connections active in the source system\n    and for each PDN Connection includes the associated APN, the address\n    and the uplink tunnel endpoint parameters of the Serving GW for control\n    plane, and a list of EPS Bearer Contexts.\n\n     Prioritization of EPS Bearer Contexts is performed by the target core\n    network node.\n\n     The MM context contains security related information, e.g. UE Network\n    capabilities and used UMTS integrity and ciphering algorithm(s) as well\n    as keys, as described in clause\u00c2\u00a05.7.2 (Information Storage for MME).\n\n     The target MME selects the NAS ciphering and integrity algorithms to\n    use. These algorithms will be sent transparently from the target eNodeB\n    to the UE in the Target to Source Transparent Container (EPC part).\n\n     The MME establishes the EPS bearer(s) in the prioritized order. The\n    MME deactivates, as provided in step\u00c2\u00a08 of the execution phase, the EPS\n    bearers which cannot be established.\n\n     The target MME shall determine the Maximum APN restriction based on\n    the APN Restriction of each bearer context received in the Forward\n    Relocation Request, and shall subsequently store the new Maximum APN\n    restriction value.\n\n     If SIPTO at the Local Network is active for a PDN connection in the\n    architecture with stand-alone GW the source SGSN shall include the\n    Local Home Network ID of the source cell in the PDN Connections\n    corresponding to the SIPTO at the Local Network PDN connection.\n\n  4. The target MME determines if the Serving GW is to be relocated, e.g.,\n    due to PLMN change. If the Serving GW is to be relocated, the target\n    MME selects the target Serving GW as described under clause 4.3.8.2 on\n    \"Serving GW selection function\". The target MME sends a Create Session\n    Request message (IMSI, MME Address and TEID, MME Tunnel Endpoint\n    Identifier for Control Plane, MME Address for Control plane, PDN GW\n    address(es) for user plane, PDN GW UL TEID(s) for user plane, PDN GW\n    address for control plane, and PDN GW TEID(s) for control plane, the\n    Protocol Type over S5/S8, Serving Network) per PDN connection to the\n    target Serving GW. The Protocol Type over S5/S8 is provided to Serving\n    GW which protocol should be used over S5/S8 interface.\n\n  4a.  The target Serving GW allocates its local resources and returns them\n    in a Create Session Response (Serving GW address(es) for user plane,\n    Serving GW UL TEID(s) for user plane, Serving GW Address for control\n    plane, Serving GW TEID for control plane) message to the target MME.\n\n  5. The target MME requests the target eNodeB to establish the bearer(s)\n    by sending the message Handover Request (UE Identifier, S1AP Cause,\n    KeNB, allowed AS Integrity Protection and Ciphering algorithm(s), NAS\n    Security Parameters to E-UTRAN, EPS Bearers to be setup list, CSG ID,\n    CSG Membership Indication, Source to Target Transparent Container). The\n    NAS Security Parameters to E-UTRAN includes the NAS Integrity\n    Protection and Ciphering algorithm(s), eKSI and NONCEMME are targeted\n    for the UE. S1AP Cause indicates the RAN Cause as received from source\n    SGSN. The Source to Target Transparent Container contains the value\n    from the RAN Transparent Container received from the source SGSN.\n\n  NOTE\u00c2\u00a02:  The target MME derives K'ASME from CK and IK in the MM context\n         and associates it with eKSI, as described in TS\u00c2\u00a033.401\u00c2\u00a0[41] and\n         selects NAS Integrity Protection and Ciphering algorithm(s). The\n         MME and UE derive the NAS keys and KeNB from K'ASME. If the MME\n         shares an EPS security association with the UE, the MME may\n         activate this native EPS security context by initiating a NAS SMC\n         procedure after having completed the handover procedure.\n\n     For each EPS bearer requested to be established, 'EPS Bearers To Be\n    Setup' IE shall contain information such as ID, bearer parameters,\n    Transport Layer Address, \"Data forwarding not possible\" indication, and\n    S1 Transport Association. The target MME ignores any Activity Status\n    Indicator within an EPS Bearer Context and requests the target eNodeB\n    to allocate resources for all EPS Bearer Contexts received from the\n    source side. The Transport Layer Address is the Serving GW Address for\n    user data, and the S1 Transport Association corresponds to the uplink\n    Tunnel Endpoint Identifier Data. \"Data forwarding not possible\"\n    indication shall be included if the target MME decides the\n    corresponding bearer will not be subject to data forwarding.\n\n     The target MME shall include the CSG ID and CSG Membership Indication\n    when provided by the source SGSN in the Handover Request message.\n\n     The information about the selected NAS ciphering and integrity\n    protection algorithm(s), KSI and NONCEMME will be sent transparently\n    from the target eNodeB to the UE in the Target to Source Transparent\n    Container, and in the message UTRAN HO Command from source RNC to the\n    UE. This will then allow data transfer to continue in the new RAT/mode\n    target cell without requiring a new AKA (Authentication and Key\n    Agreement) procedure. More details are described in TS\u00c2\u00a033.401\u00c2\u00a0[41].\n\n     If the target cell is a CSG cell, the target eNodeB shall verify the\n    CSG ID provided by the target MME, and reject the handover with an\n    appropriate cause if it does not match the CSG ID for the target cell.\n    If the target eNodeB is in hybrid mode, it may use the CSG Membership\n    Status to perform differentiated treatment for CSG and non-CSG members.\n    If the target cell is a CSG cell, and if the CSG Membership Indication\n    is \"non member\", the target eNodeB only accepts the emergency bearers.\n\n  5a.  The target eNodeB allocates the requested resources and returns the\n    applicable parameters to the target MME in the message Handover Request\n    Acknowledge (Target to Source Transparent Container, EPS Bearers setup\n    list, EPS Bearers failed to setup list). The target eNodeB shall ignore\n    it if the number of radio bearers in the Source to Target Transparent\n    container does not comply with the number of bearers requested by the\n    MME and allocate bearers as requested by the MME. Upon sending the\n    Handover Request Acknowledge message the target eNodeB shall be\n    prepared to receive downlink GTP PDUs from the Serving GW for the\n    accepted EPS bearers.\n\n     The target eNodeB selects AS integrity and ciphering algorithm(s). In\n    addition to the information provided by the MME (eKSI, NAS Integrity\n    Protection and Ciphering algorithm(s) and NONCEMME), the target eNodeB\n    inserts AS integrity and ciphering algorithm(s) into the UTRAN RRC\n    message, which is contained in the Target to Source Transparent\n    Container.\n\n  6. If 'Indirect Forwarding' and relocation of Serving GW apply the target\n    MME sends a Create Indirect Data Forwarding Tunnel Request message\n    (Target eNodeB Address, TEID(s) for DL data forwarding) to the Serving\n    GW.\n\n     Indirect forwarding may be performed via a Serving GW which is\n    different from the Serving GW used as the anchor point for the UE.\n\n  6a.  The Serving GW returns a Create Indirect Data Forwarding Tunnel\n    Response (Cause, Serving GW Address(es) and Serving GW DL TEID(s) for\n    data forwarding) message to the target MME.\n\n  7. The target MME sends the message Forward Relocation Response (Cause,\n    List of Set Up RABs, EPS Bearers setup list, MME Tunnel Endpoint\n    Identifier for Control Plane, RAN Cause, MME Address for control plane,\n    Target to Source Transparent Container, Address(es) and TEID(s) for\n    Data Forwarding, Serving GW change indication) to the source SGSN.\n    Serving GW change indication indicates whether a new Serving GW has\n    been selected. The Target to Source Transparent Container includes the\n    value from the Target to Source Transparent Container received from the\n    target eNodeB.\n\n     The IE 'Address(es) and TEID(s) for User Traffic Data Forwarding'\n    defines the destination tunnelling endpoint for data forwarding in\n    target system, and it is set as follows. If 'Direct Forwarding' or if\n    'Indirect Forwarding' but no relocation of Serving GW applies, then the\n    IEs 'Address(es) and TEID(s) for Data Forwarding' contains the\n    forwarding DL GTP-U tunnel endpoint parameters to the eNodeB received\n    in step\u00c2\u00a05a.\n\n     If 'Indirect Forwarding' and relocation of Serving GW apply the IEs\n    'Address(es) and TEID(s) for Data Forwarding' contains the DL GTP-U\n    tunnel endpoint parameters to the Target eNodeB or to the forwarding\n    Serving GW received in step\u00c2\u00a06a.\n\n  8. If \"Indirect Forwarding\" applies, the source SGSN shall send the\n    message Create Indirect Data Forwarding Tunnel Request (Address(es) and\n    TEID(s) for Data Forwarding (received in step\u00c2\u00a07)) to the Serving GW\n    used for indirect forwarding.\n\n     Indirect forwarding may be performed via a Serving GW which is\n    different from the Serving GW used as the anchor point for the UE.\n\n  8a.  The Serving GW returns the forwarding user plane parameters by\n    sending the message Create Indirect Data Forwarding Tunnel Response\n    (Cause, Serving GW Address(es) and TEID(s) for data forwarding). If the\n    Serving GW doesn't support data forwarding, an appropriate cause value\n    shall be returned and the Serving GW Address(es) and TEID(s) will not\n    be included in the message.\n\n\n"}, {"key": "Execution phase", "numbering": "5.5.2.2.3", "title_level": 4, "desc": "5.5.2.2.3   Execution phase\n\n                                    [pic]\n\n Figure 5.5.2.2.3-1: UTRAN Iu mode to E-UTRAN Inter RAT HO, execution phase\n\n  NOTE:  For a PMIP-based S5/S8, procedure steps (A) and (B) are defined in\n         TS\u00c2\u00a023.402\u00c2\u00a0[2]. Step (B) shows PCRF interaction in the case of PMIP-\n         based S5/S8. Steps 9 and 9a concern GTP based S5/S8.\n\n     The source RNC continues to receive downlink and uplink user plane\n    PDUs.\n\n  1. The source SGSN completes the preparation phase towards source RNC by\n    sending the message Relocation Command (Target RNC to Source RNC\n    Transparent Container, RABs to be Released List, RABs Subject to Data\n    Forwarding List). The \"RABs to be Released list\" IE will be the list of\n    all NSAPIs (RAB Ids) for which a Bearer was not established in Target\n    eNodeB. The \"RABs Subject to Data forwarding list\" IE may be included\n    in the message and it shall be a list of 'Address(es) and TEID(s) for\n    user traffic data forwarding' received from target side in step\u00c2\u00a07 of\n    the preparation phase when 'Direct Forwarding' applies. If 'Indirect\n    Forwarding' is applicable and Direct Tunnel is used the \"RABs Subject\n    to Data Forwarding List\" IE includes the parameters received in Step\u00c2\u00a08a\n    of the preparation phase. If 'Indirect Forwarding' is applicable and\n    Direct Tunnel is not used the \"RABs Subject to Data Forwarding List\" IE\n    includes the source SGSN address(es) and TEID(s) allocated for indirect\n    data forwarding by Source SGSN. The Target RNC to Source RNC\n    Transparent Container contains the value from the Target to Source\n    Transparent Container received from the target MME.\n\n  2. The source RNC will command to the UE to handover to the target eNodeB\n    via the message HO from UTRAN Command. The access network specific\n    message to UE includes a transparent container including radio aspect\n    parameters that the target eNodeB has set-up in the preparation phase.\n\n     The source RNC may initiate data forwarding for the indicated RABs/EPS\n    Bearer contexts specified in the \"RABs Subject to Data Forwarding\n    List\". The data forwarding may go directly to target eNodeB, or\n    alternatively go via the Serving GW if so decided by source SGSN and/or\n    target MME in the preparation phase.\n\n     Upon the reception of the HO from UTRAN Command message containing the\n    Relocation Command message, the UE shall associate its RAB IDs to the\n    respective bearers ID based on the relation with the NSAPI and shall\n    suspend the uplink transmission of the user plane data.\n\n  3. Void.\n\n  4. The UE moves to the E-UTRAN and performs access procedures toward\n    target eNodeB.\n\n  5. When the UE has got access to target eNodeB it sends the message HO to\n    E-UTRAN Complete.\n    The UE shall implicitly derive the EPS bearers for which an E-RAB was\n    not established from the HO from UTRAN Command and deactivate them\n    locally without an explicit NAS message at this step.\n\n  6. When the UE has successfully accessed the target eNodeB, the target\n    eNodeB informs the target MME by sending the message Handover Notify\n    (TAI+ECGI, Local Home Network ID).\n\n     For SIPTO at the Local Network with stand-alone GW architecture, the\n    target eNodeB shall include the Local Home Network ID of the target\n    cell in the Handover Notify message.\n\n  7. Then the target MME knows that the UE has arrived to the target side\n    and target MME informs the source SGSN by sending the Forward\n    Relocation Complete Notification (ISR Activated, Serving GW change)\n    message. If ISR Activated is indicated, this indicates to the source\n    SGSN that it shall maintain the UE's contexts and activate ISR, which\n    is only possible when the S-GW is not changed. The source SGSN shall\n    also acknowledge that information. A timer in source SGSN is started to\n    supervise when resources in the in Source RNC and Source Serving GW\n    (for Serving GW relocation) shall be released\n\n     Upon receipt of the Forward Relocation Complete Acknowledge message\n    the target MME starts a timer if the target MME applies indirect\n    forwarding.\n\n  8. The target MME will now complete the Inter-RAT Handover procedure by\n    informing the Serving GW (for Serving GW relocation this will be the\n    Target Serving GW) that the target MME is now responsible for all the\n    bearers the UE have established. This is performed in the message\n    Modify Bearer Request (Cause, MME Tunnel Endpoint Identifier for\n    Control Plane, EPS Bearer ID, MME Address for Control Plane, eNodeB\n    Address(es) and TEID(s) for User Traffic for the accepted EPS bearers\n    and RAT type, ISR Activated) per PDN connection. As it is a mobility\n    from UTRAN, if the target MME supports location information change\n    reporting, the target MME shall include the User Location Information\n    (according to the supported granularity) in the Modify Bearer Request,\n    regardless of whether location information change reporting had been\n    requested in the previous RAT by the PDN GW. If the PDN GW requested\n    User CSG information (determined from the UE context), the MME also\n    includes the User CSG Information IE in this message. If either the UE\n    Time Zone has changed or Forward Relocation Request message from source\n    SGSN indicated pending UE Time Zone change reporting (via Change to\n    Report flag), the MME includes the UE Time Zone IE in this message. If\n    either Serving GW is not relocated but the Serving Network has changed\n    or Forward Relocation Request message from source SGSN indicated\n    pending Serving Network change reporting (via Change to Report flag),\n    the MME includes the new Serving Network IE in this message. If\n    indicated, the information ISR Activated indicates that ISR is\n    activated, which is only possible when the S-GW was not changed. When\n    the Modify Bearer Request does not indicate ISR Activated and S-GW is\n    not changed, the S-GW deletes any ISR resources by sending a Delete\n    Bearer Request to the other CN node that has bearer resources on the S-\n    GW reserved.\n\n     The MME releases the non-accepted dedicated bearers by triggering the\n    bearer release procedure as specified in clause\u00c2\u00a05.4.4.2. If the Serving\n    GW receives a DL packet for a non-accepted bearer, the Serving GW drops\n    the DL packet and does not send a Downlink Data Notification to the\n    MME.\n\n     If the default bearer of a PDN connection has not been accepted by the\n    target eNodeB and there are other PDN connections active, the MME shall\n    handle it in the same way as if all bearers of a PDN connection have\n    not been accepted. The MME releases these PDN connections by triggering\n    the MME requested PDN disconnection procedure specified in\n    clause\u00c2\u00a05.10.3.\n\n  9. The Serving GW (for Serving GW relocation this will be the Target\n    Serving GW) may inform the PDN GW the change of for example for Serving\n    GW relocation or the RAT type that e.g. can be used for charging, by\n    sending the message Modify Bearer Request per PDN connection. The S-GW\n    also includes User Location Information IE and/or UE Time Zone IE\n    and/or User CSG Information IE if they are present in step\u00c2\u00a08. Serving\n    Network should be included if it is received in step\u00c2\u00a08 or in step\u00c2\u00a04 in\n    clause\u00c2\u00a05.5.2.2.2. For Serving GW relocation, the Serving GW allocates\n    DL TEIDs on S5/S8 even for non-accepted bearers and may include the PDN\n    Charging Pause Support Indication. The PDN GW must acknowledge the\n    request with the message Modify Bearer Response. In the case of Serving\n    GW relocation, the PDN GW updates its context field and returns a\n    Modify Bearer Response (Charging Id, MSISDN, PDN Charging Pause Enabled\n    Indication (if PDN GW has chosen to enable the function), etc.) message\n    to the Serving GW. The MSISDN is included if the PDN GW has it stored\n    in its UE context. If location information change reporting is required\n    and supported in the target MME, the PDN GW shall provide MS Info\n    Change Reporting Action in the Modify Bearer Response.\n\n     If PCC infrastructure is used, the PDN GW informs the PCRF about the\n    change of, for example, the RAT type.\n\n     If the Serving GW is relocated, the PDN GW shall send one or more \"end\n    marker\" packets on the old path immediately after switching the path in\n    order to assist the reordering function in the target eNodeB. The\n    source Serving GW shall forward the \"end marker\" packets to the source\n    SGSN or RNC.\n\n  10.  The Serving GW (for Serving GW relocation this will be the Target\n    Serving GW) acknowledges the user plane switch to the target MME via\n    the message Modify Bearer Response (Cause, Serving GW Tunnel Endpoint\n    Identifier for Control Plane, Serving GW Address for Control Plane,\n    Protocol Configuration Options, MS Info Change Reporting Action). At\n    this stage the user plane path is established for all bearers between\n    the UE, target eNodeB, Serving GW (for Serving GW relocation this will\n    be the Target Serving GW) and PDN GW.\n\n     If the Serving GW does not change, the Serving GW shall send one or\n    more \"end marker\" packets on the old path immediately after switching\n    the path in order to assist the reordering function in the target\n    eNodeB.\n\n  11.  The UE initiates a Tracking Area Update procedure when one of the\n    conditions listed in clause \"Triggers for tracking area update\"\n    applies.\n\n     The target MME knows that an IRAT Handover has been performed for this\n    UE as it received the bearer context(s) by handover messages and\n    therefore the target MME performs only a subset of the TA update\n    procedure, specifically it excludes the context transfer procedures\n    between source SGSN and target MME.\n\n     If the Subscription Data received from the HSS (during the TAU in\n    step\u00c2\u00a011) contains information that is necessary for the E-UTRAN to be\n    aware of (e.g. a restriction in the UE's permission to use NR as a\n    secondary RAT,  Unlicensed Spectrum or a combination of them), or an\n    existing UE context in the MME indicates that the UE is not permitted\n    to use NR as a secondary RAT or Unlicensed Spectrum or a combination of\n    them and the MME has not provided this information to the target eNodeB\n    during step\u00c2\u00a05 of the handover preparation phase, then the MME sends an\n    updated Handover Restriction List in the Downlink NAS Transport message\n    that it sends to RAN. If the UE is not allowed to use NR as Secondary\n    RAT, the MME indicates that to the UE in TAU Accept message.\n\n  12.  When the timer started in step 7 expires the source SGSN will clean-\n    up all its resources towards source RNC by sending the Iu Release\n    Command to the RNC. When there is no longer any need for the RNC to\n    forward data, the source RNC responds with an Iu Release Complete\n    message.\n\n     When the timer started in step 7 expires and if the source SGSN\n    received the Serving GW change indication in the Forward Relocation\n    Response message, it deletes the EPS bearer resources by sending Delete\n    Session Request (Cause, Operation Indication) messages to the Source\n    Serving GW. The operation Indication flag is not set, that indicates to\n    the Source Serving GW that the Source Serving GW shall not initiate a\n    delete procedure towards the PDN GW. The Source Serving GW acknowledges\n    with Delete Session Response (Cause) messages. If ISR has been\n    activated before this procedure, the cause indicates to the Source S-GW\n    that the Source S-GW shall delete the bearer resources on the other old\n    CN node by sending Delete Bearer Request message(s) to that CN node.\n\n  13.  If indirect forwarding was used then the expiry of the timer at\n    source SGSN started at step\u00c2\u00a07 triggers the source SGSN to send a Delete\n    Indirect Data Forwarding Tunnel Request message to the S-GW to release\n    the temporary resources used for indirect forwarding.\n\n  14.  If indirect forwarding was used and the Serving GW is relocated,\n    then the expiry of the timer at target MME started at step\u00c2\u00a07 triggers\n    the target MME to send a Delete Indirect Data Forwarding Tunnel Request\n    message to the target S-GW to release temporary resources used for\n    indirect forwarding.\n\n\n"}, {"key": "UTRAN Iu mode to E-UTRAN Inter RAT handover reject", "numbering": "5.5.2.2.4", "title_level": 4, "desc": "5.5.2.2.4   UTRAN Iu mode to E-UTRAN Inter RAT handover reject\n\nThe Target eNodeB may reject the use of the Handover procedure if none of\nthe requested EPS bearers in the Handover Request message could be\nestablished. In this case no UE context is established in the target\nMME/eNodeB and no resources are allocated. The UE remains in the Source\nRNC/SGSN.\n\n                                    [pic]\n\n      Figure 5.5.2.2.4-1: UTRAN Iu mode to E-UTRAN Inter RAT HO reject\n\n  1. Steps\u00c2\u00a01 to 5 in the flow are identical to the ones in\n    clause\u00c2\u00a05.5.2.2.2.\n\n  6. If the Target eNodeB fails to allocate any resources for any of the\n    requested EPS Bearers it sends a Handover Failure (Cause) message to\n    the Target MME. When the Target MME receives the Handover Failure\n    message from Target eNodeB the Target MME clears any reserved resources\n    for this UE.\n\n  7. This step is only performed for Serving GW relocation, i.e. if\n    Steps\u00c2\u00a04/4a have been performed. The Target MME deletes the EPS bearer\n    resources by sending Delete Session Request (Cause) messages to the\n    Target Serving GW. The Target Serving GW acknowledges with Delete\n    Session Response (Cause) messages.\n\n  8. The Target MME sends the Forward Relocation Response (Cause) message\n    to the Source SGSN.\n\n  9. When the Source SGSN receives the Forward Relocation Response message\n    it send a Relocation Preparation Failure (Cause) message to the Source\n    RNC.\n\n\n"}, {"key": "E-UTRAN to GERAN A/Gb mode Inter RAT handover", "numbering": "5.5.2.3", "title_level": 3, "desc": "5.5.2.3  E-UTRAN to GERAN A/Gb mode Inter RAT handover\n\n\n"}, {"key": "General", "numbering": "5.5.2.3.1", "title_level": 4, "desc": "5.5.2.3.1   General\n\nThe procedure is based on Packet-switched handover for GERAN A/Gb mode\ndefined in TS\u00c2\u00a043.129\u00c2\u00a0[8].\n\nPre-conditions:\n\n  -  The UE is in ECM-CONNECTED state (E-UTRAN mode);\n\n  -  The BSS must support PFM, Packet Flow Management, procedures.\n\n\n"}, {"key": "Preparation phase", "numbering": "5.5.2.3.2", "title_level": 4, "desc": "5.5.2.3.2   Preparation phase\n\n                                    [pic]\n\n  Figure 5.5.2.3.2-1: E-UTRAN to GERAN A/Gb Inter RAT HO, preparation phase\n\n  1. The source eNodeB decides to initiate an Inter RAT Handover to the\n    target GERAN A/Gb mode (2G) system. At this point both uplink and\n    downlink user data is transmitted via the following: Bearer(s) between\n    UE and Source eNodeB, GTP tunnel(s) between Source eNodeB, Serving GW\n    and PDN GW.\n\n     If the UE has an ongoing emergency bearer service the source eNodeB\n    shall not initiate PS handover to GERAN.\n\n  NOTE\u00c2\u00a01:  The process leading to the handover decision is outside of the\n         scope of this specification\n\n  2. The source eNodeB sends a Handover Required (S1AP Cause, Target System\n    Identifier, Source to Target Transparent Container) message to the\n    Source MME to request the CN to establish resources in the Target BSS,\n    Target SGSN and the Serving GW. The bearers that will be subject to\n    data forwarding (if any) are identified by the target SGSN in a later\n    step (see step\u00c2\u00a07 below).\n\n     The 'Target System Identifier' IE contains the identity of the target\n    global cell Id.\n\n  3. The Source MME determines from the 'Target System Identifier' IE that\n    the type of handover is IRAT Handover to GERAN A/Gb mode. The Source\n    MME selects the Target SGSN as described in clause\u00c2\u00a04.3.8.4 on \"SGSN\n    Selection Function\". The Source MME initiates the Handover resource\n    allocation procedure by sending a Forward Relocation Request (IMSI,\n    Target Identification (shall be set to \"empty\"), MM Context, PDN\n    Connections, MME Tunnel Endpoint Identifier for Control Plane, MME\n    Address for Control plane, Source to Target Transparent Container,\n    Packet Flow ID, XID parameters (if available), Target Cell\n    Identification, MS Info Change Reporting Action (if available), CSG\n    Information Reporting Action (if available), UE Time Zone, ISR\n    Supported, RAN Cause, Serving Network) message to the target SGSN. If\n    the information ISR Supported is indicated, this indicates that the\n    source MME and associated Serving GW are capable to activate ISR for\n    the UE. When ISR is activated the message should be sent to the SGSN\n    that maintains ISR for the UE when this SGSN is serving the target\n    identified by the Target Identification. This message includes all PDN\n    Connections active in the source system and for each PDN Connection\n    includes the associated APN, the address and the uplink Tunnel endpoint\n    parameters of the Serving GW for control plane, and a list of EPS\n    Bearer Contexts. The old Serving Network is sent to target MME to\n    support the target MME to resolve if Serving Network is changed. In\n    network sharing scenarios Serving Network denotes the serving core\n    network.\n\n     The MM context includes information on the EPS Bearer context(s). If\n    none of the UE's EPS Bearers can be supported by the selected target\n    SGSN, the source MME rejects the handover attempt by sending a Handover\n    Preparation Failure (Cause) message to the Source eNodeB.\n\n  NOTE\u00c2\u00a02:  If the handover is successful, the source MME will signal to the\n         SGW and/or SCEF to release any non-included EPS Bearers after\n         step\u00c2\u00a08 of the Execution procedure. The non-included bearers are\n         locally released by the UE following the Bearer Context Status\n         synchronisation that occurs during the Routing Area Update at\n         step\u00c2\u00a013 of the Execution procedure.\n\n     The target SGSN maps the EPS bearers to PDP contexts 1-to-1 and maps\n    the EPS Bearer QoS parameter values of an EPS bearer to the Release\u00c2\u00a099\n    QoS parameter values of a bearer context as defined in Annex E.\n\n     Prioritization of PDP Contexts is performed by the target core network\n    node, i.e. target SGSN.\n\n     If the Source MME supports IRAT Handover to GERAN A/Gb procedure it\n    has to allocate a valid PFI during the bearer activation procedure. RAN\n    Cause indicates the S1AP Cause as received from the source eNodeB. The\n    Source to Target Transparent Container includes the value from the\n    Source to Target Transparent Container received from the source eNodeB.\n\n     The MM context contains security related information, e.g. supported\n    ciphering algorithms, as described in TS\u00c2\u00a029.274\u00c2\u00a0[43]. Handling of\n    security keys is described in TS\u00c2\u00a033.401\u00c2\u00a0[41].\n\n     The target SGSN selects the ciphering algorithm to use. This algorithm\n    will be sent transparently from the target SGSN to the UE in the NAS\n    container for Handover (part of the Target to Source Transparent\n    Container). The IOV-UI parameter, generated in the target SGSN, is used\n    as input to the ciphering procedure and it will also be transferred\n    transparently from the target SGSN to the UE in the NAS container for\n    Handover. More details are described in TS\u00c2\u00a033.401\u00c2\u00a0[41].\n\n     When the target SGSN receives the Forward Relocation Request message\n    the required EPS Bearer, MM, SNDCP and LLC contexts are established and\n    a new P-TMSI is allocated for the UE. When this message is received by\n    the target SGSN, it begins the process of establishing PFCs for all EPS\n    Bearer contexts.\n\n     When the target SGSN receives the Forward Relocation Request message\n    it extracts from the EPS Bearer Contexts the NSAPIs and SAPIs and PFIs\n    to be used in the target SGSN. If for a given EPS Bearer Context the\n    target SGSN does not receive a PFI from the source MME, it shall not\n    request the target BSS to allocate TBF resources corresponding to that\n    EPS Bearer Context. If none of the EPS Bearer Contexts forwarded from\n    the source MME has a valid PFI allocated the target SGSN shall consider\n    this as a failure case and the request for Handover shall be rejected.\n\n     If when an SAPI and PFI was available at the source MME but the target\n    SGSN does not support the same SAPI and PFI for a certain NSAPI as the\n    source MME, the target SGSN shall continue the Handover procedure only\n    for those NSAPIs for which it can support the same PFI and SAPI as the\n    source MME. All EPS Bearer contexts for which no resources are\n    allocated by the target SGSN or for which it cannot support the same\n    SAPI and PFI (i.e. the corresponding NSAPIs are not addressed in the\n    response message of the target SGSN), are maintained and the related\n    SAPIs and PFIs are kept. These EPS Bearer contexts may be modified or\n    deactivated by the target SGSN via explicit SM procedures upon RAU\n    procedure.\n\n     The source MME shall indicate the current XID parameter settings if\n    available (i.e. those XID parameters received during a previous IRAT\n    Handover procedure) to the target SGSN. If the target SGSN can accept\n    all XID parameters as indicated by the source MME, the target SGSN\n    shall create a NAS container for Handover indicating 'Reset to the old\n    XID parameters'. Otherwise, if the target SGSN cannot accept all XID\n    parameters indicated by the source MME or if no XID parameters were\n    indicated by the source MME, the target SGSN shall create a NAS\n    container for Handover indicating Reset (i.e. reset to default\n    parameters).\n\n     The target SGSN shall determine the Maximum APN restriction based on\n    the APN Restriction of each bearer context received in the Forward\n    Relocation Request, and shall subsequently store the new Maximum APN\n    restriction value.\n\n     If SIPTO at the Local Network is active for a PDN connection in the\n    architecture with stand-alone GW the source MME shall include the Local\n    Home Network ID of the source cell in the PDN Connections corresponding\n    to the SIPTO at the Local Network PDN connection.\n\n  4. The target SGSN determines if the Serving GW is to be relocated, e.g.,\n    due to PLMN change. If the Serving GW is to be relocated, the target\n    SGSN selects the target Serving GW as described under clause 4.3.8.2 on\n    \"Serving GW selection function\", and sends a Create Session Request\n    message (IMSI, SGSN Tunnel Endpoint Identifier for Control Plane, SGSN\n    Address for Control plane, PDN GW address(es) for user plane, PDN GW UL\n    TEID(s) for user plane, PDN GW address(es) for control plane, and PDN\n    GW TEID(s) for control plane, the Protocol Type over S5/S8, Serving\n    Network) per PDN connection to the target Serving GW. The Protocol Type\n    over S5/S8 is provided to Serving GW which protocol should be used over\n    S5/S8 interface.\n\n  4a.  The target Serving GW allocates its local resources and returns a\n    Create Session Response (Serving GW address(es) for user plane, Serving\n    GW UL TEID(s) for user plane, Serving GW Address for control plane,\n    Serving GW TEID for control plane) message to the target SGSN.\n\n  5. The target SGSN establishes the EPS Bearer context(s) in the indicated\n    order. The SGSN deactivates, as provided in step\u00c2\u00a09 of the execution\n    phase, the EPS Bearer contexts which cannot be established.\n\n     The Target SGSN requests the Target BSS to establish the necessary\n    resources (PFCs) by sending the message PS Handover Request (Local\n    TLLI, IMSI, Cause, Target Cell Identifier, PFCs to be set-up list,\n    Source RNC to Target BSS Transparent Container and NAS container for\n    handover). The target SGSN shall not request resources for which the\n    Activity Status Indicator within a EPS Bearer Context indicates that no\n    active bearer exists on the source side for that PDP context. The Cause\n    indicates the RAN Cause as received from the source MME. The Source RNC\n    to Target BSS Transparent Container contains the value from the Source\n    to Target Transparent Container received from the source MME. All EPS\n    Bearer Contexts indicate active status because E-UTRAN does not support\n    selective RAB handling.\n\n     Based upon the ABQP for each PFC the target BSS makes a decision about\n    which PFCs to assign radio resources. The algorithm by which the BSS\n    decides which PFCs that need resources is implementation specific. Due\n    to resource limitations not all downloaded PFCs will necessarily\n    receive resource allocation. The target BSS allocates TBFs for each PFC\n    that it can accommodate.\n\n     The target BSS shall prepare the 'Target to Source Transparent\n    Container' which contains a PS Handover Command including the EPC part\n    (NAS container for Handover) and the RN part (Handover Radio\n    Resources).\n\n  5a.  The Target BSS allocates the requested resources and returns the\n    applicable parameters to the Target SGSN in the message PS Handover\n    Request Acknowledge (Local TLLI, List of set-up PFCs, Target BSS to\n    Source RNC Transparent Container, Cause). Upon sending the PS Handover\n    Request Acknowledge message the target BSS shall be prepared to receive\n    downlink LLC PDUs from the target SGSN for the accepted PFCs.\n\n     Any EPS Bearer contexts for which a PFC was not established are\n    maintained in the target SGSN and the related SAPIs and PFIs are kept.\n    These EPS Bearer contexts shall be deactivated by the target SGSN via\n    explicit SM procedures upon the completion of the routing area update\n    (RAU) procedure.\n\n  6. If indirect forwarding and relocation of Serving GW applies the target\n    SGSN sends a Create Indirect Data Forwarding Tunnel Request message\n    (Target SGSN Address(es) and TEID(s) for DL data forwarding) to the\n    Serving GW used for indirect packet forwarding.\n\n     Indirect forwarding may be performed via a Serving GW which is\n    different from the Serving GW used as the anchor point for the UE.\n\n  6a.  The Serving GW returns a Create Indirect Data Forwarding Tunnel\n    Response (Cause, Serving GW DL Address(es) and TEID(s) for data\n    forwarding) message to the target SGSN.\n\n  7. The Target SGSN sends the message Forward Relocation Response (Cause,\n    SGSN Tunnel Endpoint Identifier for Control Plane, SGSN Address for\n    Control Plane, Target to Source Transparent Container, RAN Cause, List\n    of set-up PFIs, Address(es) and TEID(s) for User Traffic Data\n    Forwarding, Serving GW change indication) to the Source MME. Serving GW\n    change indication indicates a new Serving GW has been selected. RAN\n    Cause indicates the Cause as received from the target BSS. The Target\n    to Source Transparent Container includes the value from the Target BSS\n    to Source RNC Transparent Container received from the target BSS.\n\n     If 'Indirect Forwarding' and relocation of Serving GW applies, then\n    the IEs 'Address(es) and TEID(s) for User Traffic Data Forwarding'\n    contain the DL GTP-U tunnel endpoint parameters received in step\u00c2\u00a06a.\n    Otherwise the IEs 'Address(es) and TEID(s) for User Traffic Data\n    Forwarding' contains the DL GTP-U tunnel endpoint parameters to the\n    Target SGSN.\n\n     The target SGSN activates the allocated LLC/SNDCP engines as specified\n    in TS\u00c2\u00a044.064\u00c2\u00a0[23] for an SGSN originated Reset or 'Reset to the old XID\n    parameters'.\n\n  8. If \"Indirect Forwarding\" applies, the Source MME sends the message\n    Create Indirect Data Forwarding Tunnel Request (Address(es) and TEID(s)\n    for Data Forwarding (received in step\u00c2\u00a07)) to the Serving GW used for\n    indirect packet forwarding.\n\n     Indirect forwarding may be performed via a Serving GW which is\n    different from the Serving GW used as the anchor point for the UE.\n\n  8a.  The Serving GW returns the forwarding user plane parameters by\n    sending the message Create Indirect Data Forwarding Tunnel Response\n    (Cause, Serving GW Address(es) and TEID(s) for Data Forwarding). If the\n    Serving GW doesn't support data forwarding, an appropriate cause value\n    shall be returned and the Serving GW Address(es) and TEID(s) will not\n    be included in the message.\n\n\n"}, {"key": "Execution phase", "numbering": "5.5.2.3.3", "title_level": 4, "desc": "5.5.2.3.3   Execution phase\n\n                                    [pic]\n\n   Figure 5.5.2.3.3-1: E-UTRAN to GERAN A/Gb mode Inter RAT HO, execution\n                                    phase\n\n  NOTE\u00c2\u00a01:  For a PMIP-based S5/S8, procedure steps (A) and (B) are defined\n         in TS\u00c2\u00a023.402\u00c2\u00a0[2]. Step (B) shows PCRF interaction in the case of\n         PMIP-based S5/S8. Steps 10 and 10a concern GTP based S5/S8\n\n     The source eNodeB continues to receive downlink and uplink user plane\n    PDUs.\n\n  1. The Source MME completes the preparation phase towards Source eNodeB\n    by sending the message Handover Command (Target to Source Transparent\n    Container (PS Handover Command with RN part and EPC part), E-RABs to\n    Release List, Bearers Subject to Data Forwarding List), S1AP Cause. The\n    \"Bearers Subject to Data forwarding list\" may be included in the\n    message and it shall be a list of 'Address(es) and TEID(s) for user\n    traffic data forwarding' received from target side in the preparation\n    phase (Step\u00c2\u00a07 of the preparation phase for Direct Forwarding, else\n    parameters received in Step\u00c2\u00a08a of the preparation phase). S1AP Cause\n    indicates the RAN Cause as received from the target SGSN.\n\n     Source eNodeB initiate data forwarding for the bearers specified in\n    the \"Bearers Subject to Data Forwarding List\". The data forwarding may\n    go directly i.e. to target SGSN or alternatively go via the Serving GW\n    if so decided by source MME and/or target SGSN in the preparation\n    phase.\n\n  2. The Source eNodeB will give a command to the UE to handover to the\n    Target Access System via the message HO from E-UTRAN Command. This\n    message includes a transparent container including radio aspect\n    parameters that the Target BSS has set-up in the preparation phase (RN\n    part). This message also includes the XID and IOV-UI parameters\n    received from the Target SGSN (EPC part).\n\n     Upon the reception of the HO from E-UTRAN Command message containing\n    the Handover Command message, the UE shall associate its bearer IDs to\n    the respective PFIs based on the relation with the NSAPI and shall\n    suspend the uplink transmission of the user plane data.\n\n  3. If the PLMN has configured Secondary RAT usage data reporting and the\n    source eNodeB has Secondary RAT usage data to report, the eNodeB sends\n    the RAN Usage data report message (Secondary RAT usage data) to the\n    MME. Since the handover is an inter-RAT handover, the MME continues\n    with the Secondary RAT usage data reporting procedure as in\n    clause\u00c2\u00a05.7A.3. The reporting procedure in clause\u00c2\u00a05.7A.3 is only\n    performed if PGW secondary RAT usage reporting is active.\n\n  4. The UE moves to the Target GERAN A/Gb (2G) system and performs\n    executes the handover according to the parameters provided in the\n    message delivered in step 2. The procedure is the same as in step 6 in\n    clause 5.3.2.2 in TS\u00c2\u00a043.129\u00c2\u00a0[8] with the additional function of\n    association of the received PFI and existing Bearer Id related to the\n    particular NSAPI.\n\n  5. After accessing the cell using access bursts and receiving timing\n    advance information from the BSS in step 4, the UE processes the NAS\n    container and then sends one XID response message to the target SGSN\n    via target BSS. The UE sends this message immediately after receiving\n    the Packet Physical Information message containing the timing advance\n    or, in the synchronised network case, immediately if the PS Handover\n    Access message is not required to be sent.\n\n     Upon sending the XID Response message, the UE shall resume the user\n    data transfer only for those NSAPIs for which there are radio resources\n    allocated in the target cell. For NSAPIs using LLC ADM, for which radio\n    resources were not allocated in the target cell, the UE may request for\n    radio resources using the legacy procedures.\n\n     If the Target SGSN indicated XID Reset (i.e. reset to default XID\n    parameters) in the NAS container included in the HO from E-UTRAN\n    Command message, and to avoid collision cases the mobile station may\n    avoid triggering XID negotiation for any LLC SAPI used in LLC ADM, but\n    wait for the SGSN to do so (see step 12). In any case the mobile\n    station may avoid triggering XID negotiation for any LLC SAPI used in\n    LLC ABM, but wait for the SGSN to do so (see step 12a).\n\n     This step is the same as specified in clause 5.3.2.2 in TS\u00c2\u00a043.129\u00c2\u00a0[8].\n\n  6. Upon reception of the first correct RLC/MAC block (sent in normal\n    burst format) from the UE to the Target BSS, the Target BSS informs the\n    Target SGSN by sending the message PS Handover Complete (IMSI, and\n    Local TLLI, Request for Inter RAT Handover Info). The target BSS that\n    supports inter-RAT PS handover to UTRAN shall, when the INTER RAT\n    HANDOVER INFO was not included in the Source BSS to Target BSS\n    transparent container received in the PS HANDOVER REQUEST message as\n    specified in TS\u00c2\u00a048.018\u00c2\u00a0[42], request the INTER RAT HANDOVER INFO from\n    the target SGSN by setting the 'Request for Inter RAT Handover Info' to\n    '1'.\n\n  7. The Target BSS also relays the message XID Response to the Target\n    SGSN. Note, the message in step 6 and 7 may arrive in any order in the\n    Target SGSN.\n\n  8. Then the Target SGSN knows that the UE has arrived to the target side\n    and Target SGSN informs the Source MME by sending the Forward\n    Relocation Complete Notification (ISR Activated, Serving GW change)\n    message. If ISR Activated is indicated, the source MME shall maintain\n    the UE's contexts and activate ISR, which is only possible when the S-\n    GW is not changed. The Source MME will also acknowledge that\n    information. A timer in source MME is started to supervise when\n    resources in Source eNodeB and Source Serving GW (for Serving GW\n    relocation) shall be released.\n\n     Upon receipt of the Forward Relocation Complete Acknowledge message\n    the target SGSN starts a timer if the target SGSN allocated S-GW\n    resources for indirect forwarding.\n\n     For all bearers that were not included in the Forward Relocation\n    Request message sent in step\u00c2\u00a03, the MME now releases them by sending a\n    Delete Bearer Command to the SGW, or, the appropriate message to the\n    SCEF.\n\n  9. The Target SGSN will now complete the Handover procedure by informing\n    the Serving GW (for Serving GW relocation this will be the Target\n    Serving GW) that the Target SGSN is now responsible for all the EPS\n    Bearer Context(s) the UE has established. This is performed in the\n    message Modify Bearer Request (SGSN Tunnel Endpoint Identifier for\n    Control Plane, NSAPI(s), SGSN Address for Control Plane, SGSN\n    Address(es) and TEID(s) for User Traffic for the accepted EPS bearers\n    and RAT type, ISR Activated) per PDN connection. As it is a mobility\n    from E-UTRAN, if the target SGSN supports location information change\n    reporting, the target SGSN shall include the User Location Information\n    (according to the supported granularity) in the Modify Bearer Request,\n    regardless of whether location information change reporting had been\n    requested in the previous RAT by the PDN GW. If the PDN GW requested\n    User CSG information (determined from the UE context), the SGSN also\n    includes the User CSG Information IE in this message. If the UE Time\n    Zone has changed, the SGSN includes the UE Time Zone IE in this\n    message. If Serving GW is not relocated but the Serving Network has\n    changed or if the SGSN has not received any old Serving Network\n    information from the old MME, the SGSN includes the new Serving Network\n    IE in this message. In network sharing scenarios Serving Network\n    denotes the serving core network. If indicated, ISR Activated indicates\n    that ISR is activated, which is only possible when the S-GW was not\n    changed. When the Modify Bearer Request does not indicate ISR Activated\n    and S-GW is not changed, the S-GW deletes any ISR resources by sending\n    a Delete Bearer Request to the other CN node that has bearer resources\n    on the S-GW reserved.\n\n     The SGSN releases the non-accepted EPS Bearer contexts by triggering\n    the EPS Bearer context deactivation procedure. If the Serving GW\n    receives a DL packet for a non-accepted bearer, the Serving GW drops\n    the DL packet and does not send a Downlink Data Notification to the\n    SGSN.\n\n  10.  The Serving GW (for Serving GW relocation this will be the Target\n    Serving GW) may inform the PDN GW the change of, for example, for\n    Serving GW relocation or the RAT type, that e.g. can be used for\n    charging, by sending the message Modify Bearer Request per PDN\n    connection. The S-GW also includes User Location Information IE and/or\n    UE Time Zone IE and/or User CSG Information IE if they are present in\n    step\u00c2\u00a09. Serving Network should be included if it is received in step\u00c2\u00a09\n    or in step\u00c2\u00a04 in clause\u00c2\u00a05.5.2.3.2. For Serving GW relocation, the\n    Serving GW allocates DL TEIDs on S5/S8 even for non-accepted bearers\n    and may include the PDN Charging Pause Supported Indication. The PDN GW\n    must acknowledge the request with the message Modify Bearer Response.\n    In the case of Serving GW relocation, the PDN GW updates its context\n    field and returns a Modify Bearer Response (Charging Id, MSISDN, PDN\n    Charging Pause Enabled Indication (if PDN GW has chosen to enable the\n    function), etc.) message to the Serving GW. The MSISDN is included if\n    the PDN GW has it stored in its UE context. If location information\n    change reporting is required and supported in the target SGSN, the PDN\n    GW shall provide MS Info Change Reporting Action in the Modify Bearer\n    Response.\n\n     If PCC infrastructure is used, the PDN GW informs the PCRF about the\n    change of, for example, the RAT type.\n\n     If the Serving GW is relocated, the PDN GW shall send one or more \"end\n    marker\" packets on the old path immediately after switching the path.\n    The source Serving GW shall forward the \"end marker\" packets to the\n    source eNodeB.\n\n  11.  The Serving GW (for Serving GW relocation this will be the Target\n    Serving GW) acknowledges the user plane switch to the Target SGSN via\n    the message Modify Bearer Response (Cause, Serving GW Tunnel Endpoint\n    Identifier for Control Plane, Serving GW Address for Control Plane,\n    Protocol Configuration Options, MS Info Change Reporting Action). At\n    this stage the user plane path is established for all EPS Bearer\n    contexts between the UE, Target BSS, Target SGSN, Serving GW (for\n    Serving GW relocation this will be the Target Serving GW) and PDN GW.\n\n     If the Serving GW does not change, the Serving GW shall send one or\n    more \"end marker\" packets on the old path immediately after switching\n    the path.\n\n  12.  If the Target SGSN indicated XID Reset (i.e. reset to default XID\n    parameters) in the NAS container included in the HO from E-UTRAN\n    Command message, then on receipt of the PS Handover Complete the Target\n    SGSN initiates an LLC/SNDCP XID negotiation for each LLC SAPI used in\n    LLC ADM. In this case if the Target SGSN wants to use the default XID\n    parameters, it shall send an empty XID Command. If the Target SGSN\n    indicated 'Reset to the old XID parameters' in the NAS container, no\n    further XID negotiation is required for LLC SAPIs used in LLC ADM only.\n\n  12a. The Target SGSN (re-)establishes LLC ABM for the EPS Bearer contexts\n    which use acknowledged information transfer. During the exchange of\n    SABM and UA the SGSN shall perform LLC/SNDCP XID negotiation.\n\n     These steps (12 and 12a) are the same as specified in clause 5.3.2.2\n    in TS\u00c2\u00a043.129\u00c2\u00a0[8].\n\n  13.  After the UE has finished the reconfiguration procedure the UE shall\n    initiate the Routing Area Update procedure.\n\n  NOTE\u00c2\u00a02:  The RAU procedure is performed regardless if the UE has this\n         routing area registered or not, as specified by TS\u00c2\u00a043.129\u00c2\u00a0[8]. This\n         is needed e.g. to update the START-PS value stored in the 2G-SGSN.\n         The START_PS is delivered to SGSN in INTER RAT HANDOVER INFO\n         parameter of RAU Complete message when requested by SGSN in RAU\n         Accepted.\n\n     The target SGSN knows that an IRAT Handover has been performed for\n    this UE as it received the bearer context(s) by handover messages and\n    therefore the target SGSN performs only a subset of the RAU procedure,\n    specifically it excludes the context transfer procedures between source\n    MME and target SGSN.\n\n     For a UE supporting CIoT EPS Optimisations, the UE uses the bearer\n    status information in the RAU Accept to identify any non-transferred\n    bearers that it shall locally release.\n\n  13a. Upon reception of the PS Handover Complete message with the 'Request\n    for Inter RAT Handover Info' set to '1', the SGSN should send then PS\n    Handover Complete Acknowledge (TLLI, INTER RAT HANDOVER INFO) to the\n    target BSS.\n\n  NOTE\u00c2\u00a03:  An SGSN that does not recognize the \"Request for Inter RAT\n         Handover Info\" in the PS Handover Complete message will not send\n         the PS Handover Complete Acknowledge message back to the BSS.\n\n     The target BSS receiving the PS Handover Complete Acknowledge message\n    shall set the 'Reliable INTER RAT HANDOVER' to '1' in the PS Handover\n    Required message in any subsequent PS handover to GERAN A/Gb mode. The\n    target BSS failing to receive the PS Handover Complete Acknowledge\n    message shall set the 'Reliable INTER RAT HANDOVER' to '0' in the PS\n    Handover Required message in any subsequent PS handover to GERAN A/Gb\n    mode. The Target BSS shall, upon receipt of the INTER RAT HANDOVER INFO\n    in the PS Handover Complete Acknowledge message, overwrite its current\n    INTER RAT HANDOVER INFO with this new one.\n\n  14.  When the timer started at step\u00c2\u00a08 expires, the source MME sends a\n    Release Resources message to the source eNodeB. The Source eNodeB\n    releases its resources related to the UE.\n\n     When the timer started in step 8 expires and if the source MME\n    received the Serving GW change indication in the Forward Relocation\n    Response message, it deletes the EPS bearer resources by sending Delete\n    Session Request (Cause, Operation Indication, Secondary RAT usage data)\n    messages to the Source Serving GW. The operation Indication flag is not\n    set, that indicates to the Source Serving GW that the Serving GW\n    changes and the Source Serving GW shall not initiate a delete procedure\n    towards the PDN GW. Secondary RAT usage data is included if it was\n    received in step\u00c2\u00a03. The Source Serving GW acknowledges with Delete\n    Session Response (Cause) messages. If ISR has been activated before\n    this procedure, the cause indicates to the Source S-GW that the Source\n    S-GW shall delete the bearer resources on the other old CN node by\n    sending Delete Bearer Request message(s) to that CN node.\n\n  15.  If indirect forwarding was used then the expiry of the timer at\n    source MME started at step\u00c2\u00a08 triggers the source MME to send a Delete\n    Indirect Data Forwarding Tunnel Request message to the S-GW to release\n    the temporary resources used for indirect forwarding.\n\n  16.  If indirect forwarding was used and the Serving GW is relocated,\n    then the expiry of the timer at target SGSN started at step\u00c2\u00a08 triggers\n    the target SGSN to send a Delete Indirect Data Forwarding Tunnel\n    Request message to the target S-GW to release temporary resources used\n    for indirect forwarding.\n\n\n"}, {"key": "E-UTRAN to GERAN A/Gb mode Inter RAT handover reject", "numbering": "5.5.2.3.4", "title_level": 4, "desc": "5.5.2.3.4   E-UTRAN to GERAN A/Gb mode Inter RAT handover reject\n\nThe Target BSS may reject the use of the Handover procedure if none of the\nrequested PFCs in the PS Handover Request message could be established. In\nthis case no UE context is established in the target SGSN/BSS and no\nresources are allocated. The UE remains in the Source eNodeB/MME.\n\n                                    [pic]\n\n        Figure 5.5.2.3.4-1: E-UTRAN to GERAN A/Gb Inter RAT HO reject\n\n  1. Steps\u00c2\u00a01 to 5 in the flow are identical to the ones in\n    clause\u00c2\u00a05.5.2.3.2.\n\n  6. If the Target BSS fails to allocate any resources for any of the\n    requested PFCs it sends a PS Handover Request Nack (Cause) message to\n    the Target SGSN. When the Target SGSN receives the PS Handover Request\n    Nack message from Target BSS the Target SGSN clears any reserved\n    resources for this UE.\n\n  7. This step is only performed for Serving GW relocation, i.e. if\n    Steps\u00c2\u00a04/4a have been performed. The Target SGSN deletes the EPS bearer\n    resources by sending Delete Session Request (Cause) messages to the\n    Target Serving GW. The Target Serving GW acknowledges with Delete\n    Session Response (Cause) messages.\n\n  8. The Target SGSN sends the Forward Relocation Response (Cause) message\n    to the Source MME.\n\n  9. When the Source MME receives the Forward Relocation Response message\n    it send a Handover Preparation Failure (Cause) message to the Source\n    eNodeB.\n\n\n"}, {"key": "GERAN A/Gb mode to E-UTRAN Inter RAT handover", "numbering": "5.5.2.4", "title_level": 3, "desc": "5.5.2.4  GERAN A/Gb mode to E-UTRAN Inter RAT handover\n\n\n"}, {"key": "General", "numbering": "5.5.2.4.1", "title_level": 4, "desc": "5.5.2.4.1   General\n\nThe procedure is based on Packet-switched handover for GERAN A/Gb mode,\ndefined in TS\u00c2\u00a043.129\u00c2\u00a0[8].\n\nPre-conditions:\n\n  -  The UE is in READY state (GERAN A/Gb mode);\n\n  -  The UE has at least one PDP/EPS Bearer Context established;\n\n  -  The BSS must support PFM, Packet Flow Management, procedures.\n\n\n"}, {"key": "Preparation phase", "numbering": "5.5.2.4.2", "title_level": 4, "desc": "5.5.2.4.2   Preparation phase\n\n                                    [pic]\n\n  Figure 5.5.2.4.2-1: GERAN A/Gb mode to E-UTRAN inter RAT HO, preparation\n                                    phase\n\n  1. The source access system, Source BSS, decides to initiate an Inter-RAT\n    Handover to the E-UTRAN. At this point both uplink and downlink user\n    data is transmitted via the following: Bearers between UE and Source\n    BSS, BSSGP PFC tunnel(s) between source BSS and source SGSN, GTP\n    tunnel(s) between Source SGSN, Serving GW and PDN GW.\n\n  NOTE\u00c2\u00a01:  The process leading to the handover decision is outside of the\n         scope of this specification.\n\n  2. The source BSS sends the message PS handover Required (TLLI, Cause,\n    Source Cell Identifier, Target eNodeB Identifier, Source eNodeB to\n    Target eNodeB Transparent Container and active PFCs list) to Source\n    SGSN to request the CN to establish resources in the Target eNodeB,\n    Target MME and the Serving GW.\n\n  NOTE\u00c2\u00a02:  In contrast to most inter-RAT handover preparation phases, this\n         Source to Target Transparent Container does not contain the UE's\n         target RAT radio capabilities.\n\n  3. The Source SGSN determines from the 'Target eNodeB Identifier' IE that\n    the type of handover is IRAT PS Handover to E-UTRAN. The Source SGSN\n    selects the Target MME as described in clause\u00c2\u00a04.3.8.3 on \"MME Selection\n    Function\". The Source SGSN initiates the Handover resource allocation\n    procedure by sending message Forward Relocation Request (IMSI, Target\n    Identification, MM Context, PDN Connections, SGSN Tunnel Endpoint\n    Identifier for Control Plane, SGSN Address for Control plane, Source to\n    Target Transparent Container, RAN Cause, Packet Flow ID, SNDCP XID\n    parameters, LLC XID parameters, MS Info Change Reporting Action (if\n    available), CSG Information Reporting Action (if available), UE Time\n    Zone, ISR Supported, Serving Network) to the target MME. When ISR is\n    activated the message should be sent to the MME that maintains ISR for\n    the UE when this MME is serving the target identified by the Target\n    Identification. If indicated, the information ISR Supported indicates\n    that the source SGSN and associated Serving GW are capable to activate\n    ISR for the UE. This message includes all PDN Connections active in the\n    source system and for each PDN Connection includes the associated APN,\n    the address and the uplink tunnel endpoint parameters of the Serving GW\n    for control plane, and a list of EPS Bearer Contexts established in the\n    source system. The EPS Bearer Contexts indicate the PFIs and the XID\n    parameters related to those EPS Bearer Contexts, and the uplink Tunnel\n    endpoint parameters of the Serving GW. The old Serving Network is sent\n    to target MME to support the target MME to resolve if Serving Network\n    is changed. In network sharing scenarios Serving Network denotes the\n    serving core network.\n\n     The RAN Cause includes the value from the Cause IE received from the\n    source BSS. Source to Target Transparent Container includes the value\n    from the Source eNodeB to Target eNodeB Transparent Container received\n    from the source BSS.\n\n     The MM context includes information on the EPS Bearer context(s). If\n    none of the UE's EPS Bearers can be supported by the selected target\n    MME, the source SGSN rejects the handover attempt by sending a PS\n    Handover Required Negative Acknowledge (Cause) message to the Source\n    BSS.\n\n  NOTE\u00c2\u00a03:  If the handover is successful, the source SGSN will signal to\n         the SGW and/or SCEF to release any non-included EPS Bearers after\n         step\u00c2\u00a06 of the Execution procedure. The non-included bearers are\n         locally released by the UE following the Bearer Context Status\n         synchronisation that occurs during the Tracking Area Update at\n         step\u00c2\u00a012 of the Execution procedure.\n\n     Prioritization of EPS Bearer Contexts is performed by the target core\n    network node.\n\n     The MME establishes the EPS bearer(s) in the prioritized order. The\n    MME deactivates, as provided in step\u00c2\u00a08 of the execution phase, the EPS\n    bearers which cannot be established.\n\n     The MM context contains security related information, e.g. supported\n    ciphering algorithms as described in TS\u00c2\u00a029.274\u00c2\u00a0[43]. Handling of\n    security keys is described in TS\u00c2\u00a033.401\u00c2\u00a0[41].\n\n     For the EPS Bearer Context with traffic class equals 'Background', the\n    source SGSN shall indicate via the Activity Status Indicator IE that\n    radio bearers shall be established on the target side.\n\n     The target MME shall determine the Maximum APN restriction based on\n    the APN Restriction of each bearer context received in the Forward\n    Relocation Request, and shall subsequently store the new Maximum APN\n    restriction value.\n\n  4. The target MME determines if the Serving GW is to be relocated, e.g.\n    due to PLMN change. If the Serving GW is to be relocated, the target\n    MME selects the target Serving GW as described under clause 4.3.8.2 on\n    \"Serving GW selection function\". The target MME sends a Create Session\n    Request message (IMSI, MME Tunnel Endpoint Identifier for Control\n    Plane, MME Address for Control plane, PDN GW address(es) for user\n    plane, PDN GW UL TEID(s) for user plane, PDN GW address for control\n    plane, and PDN GW TEID(s) for control plane, the Protocol Type over\n    S5/S8, Serving Network) per PDN connection to the target Serving GW.\n    The Protocol Type over S5/S8 is provided to Serving GW which protocol\n    should be used over S5/S8 interface.\n\n  4a.  The target Serving GW allocates its local resources and returns them\n    in a Create Session Response (Serving GW address(es) for user plane,\n    Serving GW UL TEID(s) for user plane, Serving GW Address for control\n    plane, Serving GW TEID for control plane) message to the target MME.\n\n  5. The Target MME will request the Target eNodeB to establish the\n    Bearer(s) by sending the message Handover Request (UE Identifier, S1AP\n    Cause, Integrity protection information (i.e. IK and allowed Integrity\n    Protection algorithms), Encryption information (i.e. CK and allowed\n    Ciphering algorithms), EPS Bearers to be setup list, Source to Target\n    Transparent Container, Handover Restriction List). The Target MME\n    ignores any Activity Status Indicator within an EPS Bearer Context and\n    requests the eNodeB to allocate resources for all EPS Bearer Contexts\n    received from the source side. The S1AP Cause includes the value from\n    the RAN Cause IE received from the source SGSN. The target eNodeB shall\n    ignore it if the number of radio bearers in the Source to Target\n    Transparent container does not comply with the number of bearers\n    requested by the MME and allocate bearers as requested by the MME.\n    Handover Restriction List is sent if it is available in the Target MME;\n    it is described in clause\u00c2\u00a04.3.5.7.\n\n     For each EPS bearer requested to be established, 'EPS Bearers To Be\n    Setup' IE shall contain information such as ID, bearer parameters,\n    Transport Layer Address, \"Data forwarding not possible\" indication, and\n    S1 Transport Association. The Transport Layer Address is the Serving GW\n    Address for user data, and the S1 Transport Association corresponds to\n    the uplink Tunnel Endpoint Identifier Data. \"Data forwarding not\n    possible\" indication shall be included if the target MME decides the\n    corresponding bearer will not be subject to data forwarding.\n\n     The ciphering and integrity protection keys will be sent transparently\n    from the target eNodeB to the UE in the Target to Source Transparent\n    Container, and in the message PS Handover Command from source BSS to\n    the UE. This will then allow data transfer to continue in the new\n    RAT/mode target cell without requiring a new AKA (Authentication and\n    Key Agreement) procedure. More details are described in TS\u00c2\u00a033.401\u00c2\u00a0[41].\n\n  5a.  The Target eNodeB allocates the request resources and returns the\n    applicable parameters to the Target MME in the message Handover Request\n    Acknowledge (Target to Source Transparent Container, S1AP Cause, EPS\n    Bearers setup list, EPS Bearers failed to setup list). Upon sending the\n    Handover Request Acknowledge message the target eNodeB shall be\n    prepared to receive downlink GTP PDUs from the Serving GW for the\n    accepted EPS bearers.\n\n  6. If 'Indirect Forwarding' and relocation of Serving GW apply, the\n    target MME sends a Create Indirect Data Forwarding Tunnel Request\n    message (Target eNodeB Address(es) and TEID(s) for DL data forwarding)\n    to the Serving GW.\n\n     Indirect forwarding may be performed via a Serving GW which is\n    different from the Serving GW used as the anchor point for the UE.\n\n  6a.  The Serving GW returns a Create Indirect Data Forwarding Tunnel\n    Response (Cause, Serving GW Address(es) and DL TEID(s) for data\n    forwarding) message to the target MME.\n\n  7. The Target MME sends the message Forward Relocation Response (Cause,\n    List of Set Up PFCs, MME Tunnel Endpoint Identifier for Control Plane,\n    RAN Cause, MME Address for control plane, Target to Source Transparent\n    Container, Address(es) and TEID(s) for Data Forwarding, Serving GW\n    change indication) to the Source SGSN. Serving GW change indication\n    indicates whether a new Serving GW has been selected. The RAN Cause\n    includes the value from the S1AP Cause IE received from the target\n    eNodeB. The Target to Source Transparent Container includes the value\n    from the Target to Source Transparent Container received from the\n    target eNodeB.\n\n     If 'Direct Forwarding' applies or if 'Indirect Forwarding' but no\n    relocation of Serving GW applies, then the IEs 'Address(es) and TEID(s)\n    for Data Forwarding' contain the DL GTP-U tunnel endpoint parameters to\n    the eNodeB received in step\u00c2\u00a05a. If 'Indirect Forwarding' and relocation\n    of Serving GW apply the IEs 'Address(es) and TEID(s) for Data\n    Forwarding' contain the DL GTP-U tunnel endpoint parameters to the\n    Serving GW received in step\u00c2\u00a06a.\n\n  8. If 'Indirect Forwarding' applies, the source SGSN shall send the\n    message Create Indirect Data Forwarding Tunnel Request (Address(es) and\n    TEID(s) for Data Forwarding (received in step\u00c2\u00a07)) to the Serving GW\n    used for indirect packet forwarding.\n\n     Indirect forwarding may be performed via a Serving GW which is\n    different from the Serving GW used as the anchor point for the UE.\n\n  8a.  The Serving GW returns the forwarding user plane parameters by\n    sending the message Create Indirect Data Forwarding Tunnel Response\n    (Cause, Serving GW Address(es) and TEID(s) for Data Forwarding). If the\n    Serving GW doesn't support data forwarding, an appropriate cause value\n    shall be returned and the Serving GW Address(es) and TEID(s) will not\n    be included in the message.\n\n\n"}, {"key": "Execution phase", "numbering": "5.5.2.4.3", "title_level": 4, "desc": "5.5.2.4.3   Execution phase\n\n                                    [pic]\n\n   Figure 5.5.2.4.3-1: GERAN A/Gb mode to E-UTRAN Inter RAT HO, execution\n                                    phase\n\n  NOTE:  For a PMIP-based S5/S8, procedure steps (A) are defined in\n         TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps 9 and 9a concern GTP based S5/S8.\n\nThe source SGSN continues to receive downlink and uplink user plane PDUs.\n\nWhen source SGSN receives the Forward Relocation Response message it may\nstart downlink N-PDU relay and duplication to the target eNodeB (for Direct\nForwarding) or via the Serving GW (for Indirect Forwarding), and the target\neNodeB may start blind transmission of downlink user data towards the UE\nover the allocated radio channels.\n\n  1. The Source SGSN completes the preparation phase towards Source BSS by\n    sending the message PS HO Required Acknowledge (TLLI, List of Set Up\n    PFCs, Target RNC to Source BSS Transparent Container, Cause). This\n    message includes all PFIs that could be established on the Target side.\n    The Cause includes the value from the RAN Cause IE received from the\n    target MME. The Target RNC to Source BSS Transparent Container includes\n    the value from the Target to Source Transparent Container received from\n    the target MME.\n\n     Before sending the PS Handover Required Acknowledge message, the\n    source SGSN may suspend downlink data transfer for any EPS Bearer\n    contexts.\n\n     Before sending the PS Handover Command message to the UE the source\n    BSS, may try to empty the downlink BSS buffer for any BSS PFCs.\n\n  2. The Source BSS will command the UE to handover to the target eNodeB\n    via the message PS Handover Command. The access system specific message\n    to UE includes a transparent container including radio aspect\n    parameters that the Target eNodeB has set-up in the preparation phase.\n\n  3. Void.\n\n  4. The UE moves to the E-UTRAN and performs access procedures toward\n    Target eNodeB.\n\n  5. When the UE has got access to Target eNodeB it sends the message HO to\n    E-UTRAN Complete.\n    The UE shall implicitly derive the EPS bearers for which an E-RAB was\n    not established from the PS Handover Command and deactivate them\n    locally without an explicit NAS message at this step.\n\n  6. When the UE has successfully accessed the Target eNodeB, the Target\n    eNodeB informs the Target MME by sending the message Handover Notify\n    (TAI+ECGI). As a separate activity the Target eNodeB retrieves the UE E-\n    UTRA capability information using the procedure for UE Radio Capability\n    Handling (see clause\u00c2\u00a05.11.2).\n\n     If Dual Connectivity is activated for the UE, the PSCell ID shall be\n    included in the Handover Notify message.\n\n  7. Then the Target MME knows that the UE has arrived to the target side\n    and Target MME informs the Source SGSN by sending the Forward\n    Relocation Complete Notification (ISR Activated, Serving GW change)\n    message. If indicated, ISR Activated indicates to the source SGSN that\n    it shall maintain the UE's contexts and activate ISR, which is only\n    possible when the S-GW is not changed. The Source SGSN shall also\n    acknowledge that information. When the Forward Relocation Complete\n    Notification message has been received and there is no longer any need\n    for the SGSN to forward data, the SGSN stops data forwarding. A timer\n    in source SGSN is started to supervise when resources in the Source\n    Serving GW (for Serving GW relocation) shall be released.\n\n     Upon receipt of the Forward Relocation Complete Acknowledge message\n    the target MME starts a timer if the target MME applies indirect\n    forwarding.\n\n  8. The Target MME will now complete the Handover procedure by informing\n    the Serving GW (for Serving GW relocation this will be the Target\n    Serving GW) that the Target MME is now responsible for all the EPS\n    bearers the UE have established. This is performed in the message\n    Modify Bearer Request (Cause, MME Tunnel Endpoint Identifier for\n    Control Plane, EPS Bearer ID(s), MME Address for Control Plane, eNodeB\n    Address(es) and TEID(s) for User Traffic for the accepted EPS bearers\n    and RAT type, ISR Activated) per PDN connection. As it is a mobility\n    from GERAN, if the target MME supports location information change\n    reporting, the target MME shall include the User Location Information\n    (according to the supported granularity) in the Modify Bearer Request,\n    regardless of whether location information change reporting had been\n    requested in the previous RAT by the PDN GW. If the PDN GW requested\n    User CSG information (determined from the UE context), the MME also\n    includes the User CSG Information IE in this message. If the UE Time\n    Zone has changed, the MME includes the UE Time Zone IE in this message.\n    If the Serving GW is not relocated but the Serving Network has changed\n    or if the MME has not received any old Serving Network information from\n    the old SGSN, the MME includes the new Serving Network IE in this\n    message. If indicated, ISR Activated indicates that ISR is activated,\n    which is only possible when the S-GW was not changed. When the Modify\n    Bearer Request does not indicate ISR Activated and S-GW is not changed,\n    the S-GW deletes any ISR resources by sending a Delete Bearer Request\n    to the other CN node that has bearer resources on the S-GW reserved.\n\n     The MME releases the non-accepted dedicated bearers by triggering the\n    bearer release procedure as specified in clause\u00c2\u00a05.4.4.2. If the Serving\n    GW receives a DL packet for a non-accepted bearer, the Serving GW drops\n    the DL packet and does not send a Downlink Data Notification to the\n    MME.\n\n     If the default bearer of a PDN connection has not been accepted by the\n    target eNodeB and there are other PDN connections active, the MME shall\n    handle it in the same way as if all bearers of a PDN connection have\n    not been accepted. The MME releases these PDN connections by triggering\n    the MME requested PDN disconnection procedure specified in\n    clause\u00c2\u00a05.10.3.\n\n  9. The Serving GW (for Serving GW relocation this will be the Target\n    Serving GW) informs the PDN GW(s) the change of, for example, for\n    Serving GW relocation or the RAT type, that e.g. can be used for\n    charging, by sending the message Modify Bearer Request per PDN\n    connection. The S-GW also includes User Location Information IE and/or\n    UE Time Zone IE and/or User CSG Information IE if they are present in\n    step\u00c2\u00a08. Serving Network should be included if it is received in step\u00c2\u00a08\n    or in step\u00c2\u00a04 in clause\u00c2\u00a05.5.2.4.2. For Serving GW relocation, the\n    Serving GW allocates DL TEIDs on S5/S8 even for non-accepted bearers\n    and PDN Charging Pause Support Indication shall be included. The PDN GW\n    must acknowledge the request with the message Modify Bearer Response\n    (Charging Id, MSISDN, PDN Charging Pause Enabled Indication (if PDN GW\n    has chosen to enable the function), etc.) to the Serving GW. If\n    location information change reporting is required and supported in the\n    target MME, the PDN GW shall provide MS Info Change Reporting Action in\n    the Modify Bearer Response.\n\n     If PCC infrastructure is used, the PDN GW informs the PCRF about the\n    change of, for example, the RAT type.\n\n     If the Serving GW is relocated, the PDN GW shall send one or more \"end\n    marker\" packets on the old path immediately after switching the path in\n    order to assist the reordering function in the target eNodeB. The\n    source Serving GW shall forward the \"end marker\" packets to the source\n    SGSN.\n\n  10.  The Serving GW (for Serving GW relocation this will be the Target\n    Serving GW) acknowledges the user plane switch to the Target MME via\n    the message Modify Bearer Response (Cause, Serving GW Tunnel Endpoint\n    Identifier for Control Plane, Serving GW (for Serving GW relocation\n    this will be the Target Serving GW) Address for Control Plane, Protocol\n    Configuration Options, MS Info Change Reporting Action). At this stage\n    the user plane path is established for all bearers between the UE,\n    Target eNodeB, Serving GW (for Serving GW relocation this will be the\n    Target Serving GW) and PDN GW.\n\n     If the Serving GW does not change, the Serving GW shall send one or\n    more \"end marker\" packets on the old path immediately after switching\n    the path in order to assist the reordering function in the target\n    eNodeB.\n\n  11.  When the timer at the source SGSN started in step 7 expires the\n    Source SGSN will clean-up all its resources towards Source BSS by\n    performing the BSS Packet Flow Delete procedure.\n\n  12.  The UE initiates a Tracking Area Update procedure when one of the\n    conditions listed in clause \"Triggers for tracking area update\"\n    applies.\n\n     The target MME knows that an IRAT Handover has been performed for this\n    UE as it received the bearer context(s) by handover messages and\n    therefore the target MME performs only a subset of the TA update\n    procedure, specifically it excludes the context transfer procedures\n    between source SGSN and target MME.\n\n     If the Subscription Data received from the HSS (during the TAU in\n    step\u00c2\u00a012) contains information that is necessary for the E-UTRAN to be\n    aware of (e.g. a restriction in the UE's permission to use NR as a\n    secondary RAT, Unlicensed Spectrum or a combination of them), or an\n    existing UE context in the MME indicates that the UE is not permitted\n    to use NR as a secondary RAT, Unlicensed Spectrum or a combination of\n    them and the MME has not provided this information to the target eNodeB\n    during step\u00c2\u00a05 of the handover preparation phase, then the MME sends an\n    updated Handover Restriction List in the Downlink NAS Transport message\n    that it sends to E-UTRAN. If the UE is not allowed to use NR as\n    Secondary RAT, the MME indicates that to the UE in TAU Accept message.\n\n  13.  When the timer at the source SGSN started in step\u00c2\u00a07 expires and if\n    the source SGSN received the Serving GW change indication in the\n    Forward Relocation Response message, it deletes the EPS bearer\n    resources by sending Delete Session Request (Cause, Operation\n    Indication) messages to the Source Serving GW. The operation Indication\n    flag is not set, that indicates to the Source Serving GW that the\n    Source Serving GW shall not initiate a delete procedure towards the PDN\n    GW. The Source Serving GW acknowledges with Delete Session Response\n    (Cause) messages. If ISR has been activated before this procedure, the\n    cause indicates to the Source S-GW that the Source S-GW shall delete\n    the bearer resources on the other old CN node by sending Delete Bearer\n    Request message(s) to that CN node.\n\n  14.  If indirect forwarding was used then the expiry of the timer at\n    source SGSN started at step\u00c2\u00a07 triggers the source SGSN to send a Delete\n    Indirect Data Forwarding Tunnel Request message to the S-GW to release\n    the temporary resources used for indirect forwarding.\n\n  15.  If indirect forwarding was used and the Serving GW is relocated,\n    then the expiry of the timer at target MME started at step\u00c2\u00a06 triggers\n    the target MME to send a Delete Indirect Data Forwarding Tunnel Request\n    message to the target S-GW to release temporary resources used for\n    indirect forwarding.\n\n\n"}, {"key": "GERAN A/Gb mode to E-UTRAN Inter RAT handover reject", "numbering": "5.5.2.4.4", "title_level": 4, "desc": "5.5.2.4.4   GERAN A/Gb mode to E-UTRAN Inter RAT handover reject\n\nThe Target eNodeB may reject the use of the Handover procedure if none of\nthe requested EPS bearers in the Handover Request message could be\nestablished. In this case no UE context is established in the target\nMME/eNodeB and no resources are allocated. The UE remains in the Source\nBSS/SGSN.\n\n                                    [pic]\n\n     Figure 5.5.2.4.4-1: GERAN A/Gb mode to E-UTRAN inter RAT HO reject\n\n  1. Steps 1 to 5 in the flow are identical to the ones in\n    clause\u00c2\u00a05.5.2.4.2.\n\n  6. If the Target eNodeB fails to allocate any resources for any of the\n    requested EPS Bearers it sends a Handover Failure (Cause) message to\n    the Target MME. When the Target MME receives the Handover Failure\n    message from Target eNodeB the Target MME clears any reserved resources\n    for this UE.\n\n  7. This step is only performed for Serving GW relocation, i.e. if\n    Steps\u00c2\u00a04/4a have been performed. The Target MME deletes the EPS bearer\n    resources by sending Delete Session Request (Cause) messages to the\n    Target Serving GW. The Target Serving GW acknowledges with Delete\n    Session Response (Cause) messages.\n\n  8. The Target MME sends the Forward Relocation Response (Cause) message\n    to the Source SGSN.\n\n  9. When the Source SGSN receives the Forward Relocation Response message\n    it send a PS Handover Required Negative Acknowledge (Cause) message to\n    the Source BSS.\n\n\n"}, {"key": "Inter RAT handover Cancel", "numbering": "5.5.2.5", "title_level": 3, "desc": "5.5.2.5  Inter RAT handover Cancel\n\n\n"}, {"key": "General", "numbering": "5.5.2.5.1", "title_level": 4, "desc": "5.5.2.5.1   General\n\nInstead of completing the handover procedure, the source RAN node (eNodeB,\nRNC or BSS) may at any time during the handover procedure, up to the time\nwhen a handover command message is sent to the UE cancel the handover. The\nreason for cancelling may be e.g. due to a timer expiration or due to other\nevents within the source RAN node and is initiated by sending a handover\ncancel PDU to the source EPC node (MME or SGSN).\n\nA handover cancel PDU shall also be sent by the source RAN node after a\nhandover command message is sent to the UE for the case where the handover\nfails and the UE returns to the old cell or radio contact with the UE is\nlost. This is done in order to release the resources reserved for the\nHandover in the target system.\n\n\n"}, {"key": "Source RAN to Target RAN Inter RAT handover Cancel", "numbering": "5.5.2.5.2", "title_level": 4, "desc": "5.5.2.5.2   Source RAN to Target RAN Inter RAT handover Cancel\n\n                                    [pic]\n\n                Figure 5.5.2.5.2-1: Inter RAT handover Cancel\n\n  1. The source RAN decides to cancel the previously requested relocation\n    of Handover resources. This may be due to not enough accepted bearers,\n    UE returned to source cell or any other reason.\n\n  2. The source RAN sends a Cancel message with a Cause to the source EPC\n    node (SGSN or MME). If the source RAN is:\n\n    a) BSS the message sent is PS Handover Cancel (Cause),\n\n    b) RNC the message sent is Relocation Cancel (Cause), or\n\n    c) eNodeB the message sent is Handover Cancel (Cause).\n\n  3. The source EPC node terminates the relocation towards the target side\n    by sending a Relocation Cancel Request (IMSI) message to the target EPC\n    node. The Source EPC node also resumes operation on the resources in\n    the source side.\n\n  4. The target EPC node triggers the release of resources in the target\n    RAN and also releases its own resources allocated for this handover.\n\n  5. This step is only performed for Serving GW relocation. The Target EPC\n    node deletes the EPS bearer resources by sending Delete Session Request\n    (Cause) messages to the Target Serving GW. The Target Serving GW\n    acknowledges with Delete Session Response (Cause) messages.\n\n  6. The target EPC node acknowledge the release of all resources on the\n    target side by returning a Relocation Cancel Response (Cause) message\n    to the source EPC node.\n\n  7. The source EPC node returns a Cancel acknowledge message to the source\n    RAN. If the source RAN is:\n\n    a) BSS there will be no acknowledge message sent to the source BSS,\n\n    b) RNC the message sent is Relocation Cancel Acknowledge (Cause), or\n\n    c) eNodeB the message sent is Handover Cancel Acknowledge (Cause).\n\n  8. If indirect forwarding tunnel is setup during handover preparation\n    then cancellation of handover triggers the source MME/SGSN to send a\n    Delete Indirect Data Forwarding Tunnel Request message to the S-GW to\n    release the temporary resources used for indirect forwarding.\n\n  9. If indirect forwarding tunnel is setup during handover preparation and\n    serving GW is relocated then cancellation of handover triggers the\n    target MME/SGSN to send a Delete Indirect Data Forwarding Tunnel\n    Request message to the S-GW to release the temporary resources used for\n    indirect forwarding.\n\n\n"}, {"key": "Network Assisted Cell Change", "numbering": "5.6", "title_level": 1, "desc": "5.6  Network Assisted Cell Change\n\nNetwork Assisted Cell Change (NACC) is a means that enables better\nperformance for packet data services upon inter-cell change for those\nnetworks that do not support PS Handover. It reduces the service\ninterruption time for UEs in active mode upon cell change by providing in\nthe source cell, prior to the cell change, system information of a target\ncell allowing packet access.\n\nWithin the scope of this specification, NACC is applicable for inter-RAT\ncell changes from a source E-UTRAN cell towards a target GERAN cell.\n\nWhen the UE changes from a source E-UTRAN cell towards a target GERAN cell,\nthe UE locally deactivates ISR by setting its TIN from \"RAT-related TMSI\"\nto \"GUTI\", if any EPS bearer context activated after the ISR was activated\nin the UE exists.\n\nWhen the UE changes from a source E-UTRAN cell in connected mode towards a\ntarget GERAN cell from the same RA via Cell Change Order that is not for CS\nfallback and the ISR is active, the UE locally deactivates ISR by setting\nits TIN from \"RAT-related TMSI\" to \"GUTI\".\n\n\n"}, {"key": "Architecture Principles for E-UTRAN to GERAN NACC", "numbering": "5.6.1", "title_level": 2, "desc": "5.6.1  Architecture Principles for E-UTRAN to GERAN NACC\n\nIntroducing NACC from E-UTRAN to GERAN follows the principles of the\nNetwork Assisted Cell Change between UTRAN and GERAN as described in\nTS\u00c2\u00a025.413\u00c2\u00a0[22] and TS\u00c2\u00a023.060\u00c2\u00a0[7]. It specifies the RAN Information\nManagement (RIM) procedures as specified in clause\u00c2\u00a05.15 and depicted in\nfigure\u00c2\u00a05.6-1.\n\n                                    [pic]\n\n       Figure 5.6-1: E-UTRAN to GERAN NACC basic network architecture\n\nThe support for the NACC from E-UTRAN to GERAN has the following impacts on\nE-UTRAN / GERAN architecture:\n\n  -  Affected nodes: BSC, eNodeB, MME, SGSN;\n\n  -  Affected network interfaces: Gb, Iu, S3, Gn, S1;\n\n  -  Affected radio interfaces: Um and Uu.\n\n\n"}, {"key": "Void", "numbering": "5.6.2", "title_level": 2, "desc": "5.6.2  Void\n\n\n\n\n"}, {"key": "Information storage", "numbering": "5.7", "title_level": 1, "desc": "5.7  Information storage\n\nThis clause describes information storage structures required for the EPS\nwhen 3GPP access only is deployed. Information storage for the case where\nnon 3GPP accesses are deployed is in TS\u00c2\u00a023.402\u00c2\u00a0[2].\n\n\n"}, {"key": "HSS", "numbering": "5.7.1", "title_level": 2, "desc": "5.7.1  HSS\n\nIMSI is the prime key to the data stored in the HSS. The data held in the\nHSS is defined in Table 5.7.1-1 here below.\n\nThe table below is applicable to E-UTRAN in stand-alone operation only.\n\n                           Table 5.7.1-1: HSS data\n\n|Field                  |Description                                        |\n|IMSI                   |IMSI is the main reference key.                    |\n|MSISDN                 |The basic MSISDN of the UE (Presence of MSISDN is  |\n|                       |optional).                                         |\n|IMEI / IMEISV          |International Mobile Equipment Identity - Software |\n|                       |Version Number                                     |\n|External Identifier    |External Identifier(s) used in the external        |\n|List                   |network(s) to refer to the subscription. See       |\n|                       |TS\u00c2\u00a023.682\u00c2\u00a0[74] for more information.               |\n|MME Identity           |The Identity of the MME currently serving this UE. |\n|MME Capabilities       |Indicates the capabilities of the MME with respect |\n|                       |to core functionality e.g. regional access         |\n|                       |restrictions.                                      |\n|MS PS Purged from EPS  |Indicates that the EMM and ESM contexts of the UE  |\n|                       |are deleted from the MME.                          |\n|ODB parameters         |Indicates that the status of the operator          |\n|                       |determined barring                                 |\n|Access Restriction     |Indicates the access restriction subscription      |\n|                       |information. It may include different values for   |\n|                       |HPLMN and roaming case. It includes separate       |\n|                       |settings for WB-E-UTRAN and NB-IoT. It includes    |\n|                       |restriction information on the use of NR as a      |\n|                       |secondary RAT for user plane connectivity and use  |\n|                       |of Unlicensed Spectrum (in the form of LAA, or     |\n|                       |LWA/LWIP).                                         |\n|EPS Subscribed Charging|The charging characteristics for the UE, e.g.      |\n|Characteristics        |normal, prepaid, flat-rate, and/or hot billing     |\n|                       |subscription.                                      |\n|Trace Reference        |Identifies a record or a collection of records for |\n|                       |a particular trace.                                |\n|Trace Type             |Indicates the type of trace, e.g. HSS trace, and/or|\n|                       |MME/ Serving GW / PDN GW trace.                    |\n|OMC Identity           |Identifies the OMC that shall receive the trace    |\n|                       |record(s).                                         |\n|Subscribed-UE-AMBR     |The Maximum Aggregated uplink and downlink MBRs to |\n|                       |be shared across all Non-GBR bearers according to  |\n|                       |the subscription of the user.                      |\n|APN-OI Replacement     |Indicates the domain name to replace the APN OI    |\n|                       |when constructing the PDN GW FQDN upon which to    |\n|                       |perform a DNS resolution. This replacement applies |\n|                       |for all the APNs in the subscriber's profile. See  |\n|                       |TS\u00c2\u00a023.003\u00c2\u00a0[9] clause\u00c2\u00a09.1.2 for more information on |\n|                       |the format of domain names that are allowed in this|\n|                       |field.                                             |\n|RFSP Index             |An index to specific RRM configuration in the      |\n|                       |E-UTRAN                                            |\n|Additional RRM Policy  |An index to additional RRM configuration in the    |\n|Index                  |E-UTRAN                                            |\n|URRP-MME               |UE Reachability Request Parameter indicating that  |\n|                       |UE activity notification from MME has been         |\n|                       |requested by the HSS.                              |\n|CSG Subscription Data  |The CSG Subscription Data is a list of CSG IDs per |\n|                       |PLMN and for each CSG ID optionally an associated  |\n|                       |expiration date which indicates the point in time  |\n|                       |when the subscription to the CSG ID expires; an    |\n|                       |absent expiration date indicates unlimited         |\n|                       |subscription.                                      |\n|                       |For a CSG ID that can be used to access specific   |\n|                       |PDNs via Local IP Access, the CSG ID entry includes|\n|                       |the corresponding APN(s).                          |\n|VPLMN LIPA Allowed     |Specifies per PLMN whether the UE is allowed to use|\n|                       |LIPA.                                              |\n|EPLMN list             |Indicates the Equivalent PLMN list for the UE's    |\n|                       |registered PLMN.                                   |\n|Subscribed Periodic    |Indicates a subscribed Periodic RAU/TAU Timer value|\n|RAU/TAU Timer          |                                                   |\n|Extended idle mode DRX |Indicates a subscribed extended idle mode DRX cycle|\n|cycle length           |length value.                                      |\n|RAT specific Subscribed|Indicates a Subscribed Paging Time Window value for|\n|Paging Time Window     |the associated RAT, NB-IoT, WB-E-UTRAN or both.    |\n|MPS CS priority        |Indicates that the UE is subscribed to the eMLPP or|\n|                       |1x RTT priority service in the CS domain.          |\n|UE-SRVCC- Capability   |Indicates whether the UE is UTRAN/GERAN SRVCC      |\n|                       |capable or not.                                    |\n|MPS EPS priority       |Indicates that the UE is subscribed to MPS in the  |\n|                       |EPS domain.                                        |\n|UE Usage Type          |Indicates the usage characteristics of the UE for  |\n|                       |use with Dedicated Core Networks (see              |\n|                       |clause\u00c2\u00a04.3.25).                                    |\n|Group ID-list          |List of the subscribed group(s) that the UE belongs|\n|                       |to                                                 |\n|Communication Patterns |Indicates per UE the Communication Patterns and    |\n|                       |their corresponding validity times as specified in |\n|                       |TS\u00c2\u00a023.682\u00c2\u00a0[74].The Communication Patterns are not  |\n|                       |provided to the SGSN.                              |\n|Monitoring Event       |Describes the monitoring event configuration       |\n|Information Data       |information. See TS\u00c2\u00a023.682\u00c2\u00a0[74] for more           |\n|                       |information.                                       |\n|PDN Connection         |Indicates whether the establishment of the PDN     |\n|Restriction            |connection is restricted for the UE.               |\n|Enhanced Coverage      |Specify PLMN(s) with Enhanced Coverage             |\n|Restricted             |restrictions.                                      |\n|Acknowledgements of    |Indicates whether acknowledgement of downlink NAS  |\n|downlink NAS data PDUs |data PDUs for Control Plane CIoT EPS Optimisation  |\n|                       |is disabled for this UE (enabled by default).      |\n|Service Gap Time       |Used to set the Service Gap timer for Service Gap  |\n|                       |Control (see clause\u00c2\u00a04.3.17.9).                     |\n|Each subscription profile contains one or more PDN subscription contexts:  |\n|Context Identifier     |Index of the PDN subscription context (Note 8).    |\n|PDN Address            |Indicates subscribed IP address(es).               |\n|PDN Type               |Indicates the subscribed PDN Type (IPv4, IPv6,     |\n|                       |IPv4v6, Non-IP, Ethernet)                          |\n|APN-OI Replacement     |APN level APN-OI Replacement which has same role as|\n|                       |UE level APN-OI Replacement but with higher        |\n|                       |priority than UE level APN-OI Replacement. This is |\n|                       |an optional parameter. When available, it shall be |\n|                       |used to construct the PDN\u00c2\u00a0GW FQDN instead of UE    |\n|                       |level APN-OI Replacement.                          |\n|Access Point Name (APN)|A label according to DNS naming conventions        |\n|                       |describing the access point to the packet data     |\n|                       |network (or a wildcard) (NOTE\u00c2\u00a06).                  |\n|Invoke SCEF Selection  |Indicates whether this APN is used for establishing|\n|                       |PDN connection to the SCEF                         |\n|SCEF ID                |Indicates the FQDN or IP address of the SCEF which |\n|                       |is to be selected for this APN. It is required if  |\n|                       |\"Invoke SCEF Seletion\" indicator is set.           |\n|SIPTO permissions      |Indicates whether the traffic associated with this |\n|                       |APN is prohibited for SIPTO, allowed for SIPTO     |\n|                       |excluding SIPTO at the local network, allowed for  |\n|                       |SIPTO including SIPTO at the local network or      |\n|                       |allowed for SIPTO at the local network only        |\n|                       |(NOTE\u00c2\u00a07).                                          |\n|LIPA permissions       |Indicates whether the PDN can be accessed via Local|\n|                       |IP Access. Possible values are: LIPA-prohibited,   |\n|                       |LIPA-only and LIPA-conditional.                    |\n|WLAN offloadability    |Indicates whether the traffic associated with this |\n|                       |APN is allowed to be offloaded to WLAN using the   |\n|                       |WLAN/3GPP Radio Interworking feature or if it shall|\n|                       |be kept on 3GPP access (see clause\u00c2\u00a04.3.23). The    |\n|                       |indication may contain separate values per RAT     |\n|                       |(E-UTRA and UTRA).                                 |\n|EPS subscribed QoS     |The bearer level QoS parameter values for that     |\n|profile                |APN's default bearer (QCI and ARP) (see clause     |\n|                       |4.7.3).                                            |\n|Subscribed-APN-AMBR    |The maximum aggregated uplink and downlink MBRs to |\n|                       |be shared across all Non-GBR bearers, which are    |\n|                       |established for this APN.                          |\n|EPS PDN Subscribed     |The charging characteristics of this PDN Subscribed|\n|Charging               |context for the UE, e.g. normal, prepaid,          |\n|Characteristics        |flat-rate, and/or hot billing subscription. The    |\n|                       |charging characteristics is associated with this   |\n|                       |APN.                                               |\n|VPLMN Address Allowed  |Specifies per VPLMN whether for this APN the UE is |\n|                       |allowed to use the PDN GW in the domain of the     |\n|                       |HPLMN only, or additionally the PDN GW in the      |\n|                       |domain of the VPLMN.                               |\n|PDN GW identity        |The identity of the PDN GW used for this APN. The  |\n|                       |PDN GW identity may be either an FQDN or an IP     |\n|                       |address. The PDN GW identity refers to a specific  |\n|                       |PDN GW.                                            |\n|PDN GW Allocation Type |Indicates whether the PDN GW is statically         |\n|                       |allocated or dynamically selected by other nodes. A|\n|                       |statically allocated PDN GW is not changed during  |\n|                       |PDN GW selection.                                  |\n|PDN continuity at inter|Provides for this APN how to handle a PDN          |\n|RAT mobility           |connection when UE the moves between \"broadband\"   |\n|                       |(WB-E-UTRAN and UTRAN) and \"narrowband\" (NB-IoT,   |\n|                       |GPRS, EC-GSM-IoT). Possible values are: maintain   |\n|                       |the PDN connection; disconnect the PDN connection  |\n|                       |with a reactivation request; disconnect PDN        |\n|                       |connection without reactivation request; or to     |\n|                       |leave it to local VPLMN policy.                    |\n|PLMN of PDN GW         |Identifies the PLMN in which the dynamically       |\n|                       |selected PDN GW is located.                        |\n|Homogenous Support of  |Indicates per UE and MME if \"IMS Voice over PS     |\n|IMS Voice over PS      |Sessions\" is homogeneously supported in all TAs in |\n|Sessions for MME       |the serving MME or homogeneously not supported, or,|\n|                       |support is non-homogeneous/unknown, see            |\n|                       |clause\u00c2\u00a04.3.5.8A.                                   |\n|List of APN - PDN GW ID relations (for PDN subscription context with       |\n|wildcard APN):                                                             |\n|APN - P-GW relation #n |The APN and the identity of the dynamically        |\n|                       |allocated PDN\u00c2\u00a0GW of a PDN connection that is       |\n|                       |authorised by the PDN subscription context with the|\n|                       |wildcard APN. The PDN\u00c2\u00a0GW identity may be either an |\n|                       |FQDN or an IP address. The PDN\u00c2\u00a0GW identity refers  |\n|                       |to a specific PDN\u00c2\u00a0GW.                              |\n\n  NOTE\u00c2\u00a01:  IMEI and SVN are stored in HSS when the Automatic Device\n         Detection feature is supported, see clause 15.5 of TS\u00c2\u00a023.060\u00c2\u00a0[7].\n\n  NOTE\u00c2\u00a02:  The 'EPS subscribed QoS profile' stored in HSS is complementary\n         to the legacy 'GPRS subscribed QoS profile'.\n\n  NOTE\u00c2\u00a03:  Void.\n\n  NOTE\u00c2\u00a04:  How to indicate which of the PDN subscription contexts stored in\n         the HSS is the default one for the UE is defined in stage\u00c2\u00a03.\n\n  NOTE\u00c2\u00a05:  To help with the selection of a co-located or topologically\n         appropriate PDN GW and Serving GW, the PDN GW identity shall be in\n         the form of an FQDN.\n\n  NOTE\u00c2\u00a06:  The \"Access Point Name (APN)\" field in the table above contains\n         the APN-NI part of the APN.\n\n  NOTE\u00c2\u00a07:  In this specification, the values \"prohibited for SIPTO\" and \"\n         allowed for SIPTO excluding SIPTO at the local network\" correspond\n         to the pre Rel-12 values \"prohibited for SIPTO\" and \"allowed for\n         SIPTO\". Actual coding of these values belongs to Stage 3 domain.\n\n  NOTE\u00c2\u00a08:  There may be at most three default APNs for a given user. One\n         default APN can belong to either of the three PDN types of \"IPv4\",\n         \"IPv6\", or \"IPv4v6\", one default APN can belong to PDN type of \"Non-\n         IP\" and another default APN can belong to PDN type of \"Ethernet\".\n\nAn expired CSG subscription should not be removed from the HSS subscription\ndata before it is removed from the UE's Allowed CSG list or Operator CSG\nlist. When a CSG subscription is cancelled it should be handled as an\nexpired subscription in HSS subscription data to allow for removing it from\nUE's Allowed CSG list or Operator CSG list first.\n\nOne (and only one) of the PDN subscription contexts stored in the HSS may\ncontain a wild card APN (see TS\u00c2\u00a023.003\u00c2\u00a0[9]) in the Access Point Name field.\n\nThe PDN subscription context marked as the default one shall not contain a\nwild card APN.\n\nThe PDN subscription context with a wildcard APN shall not contain a\nstatically allocated PDN\u00c2\u00a0GW.\n\nIf the LIPA permission and SIPTO permission flags are both included for a\nparticular APN, they shall be set in a consistent manner, e.g, if the LIPA\npermission is set to LIPA-only or LIPA-conditional, the SIPTO permission\nshall be set to SIPTO-prohibited. Conversely, if the SIPTO permission\nindicates the APN is a SIPTO-allowed APN, the LIPA permission shall be set\nto LIPA-prohibited. A SIPTO-allowed APN is an APN for which the SIPTO\npermission is set to allowed for SIPTO excluding SIPTO at the local\nnetwork, allowed for SIPTO including SIPTO at the local network or allowed\nfor SIPTO at the local network only.\n\n\n"}, {"key": "MME", "numbering": "5.7.2", "title_level": 2, "desc": "5.7.2  MME\n\nThe MME maintains MM context and EPS bearer context information for UEs in\nthe ECM-IDLE, ECM-CONNECTED and EMM-DEREGISTERED states. Table\u00c2\u00a05.7.2-1\nshows the context fields for one UE.\n\n                Table 5.7.2-1: MME MM and EPS bearer Contexts\n\n|Field                |Description                                         |\n|IMSI                 |IMSI (International Mobile Subscriber Identity) is  |\n|                     |the subscriber's permanent identity.                |\n|IMSI-unauthenticated-|This is an IMSI indicator to show the IMSI is       |\n|indicator            |unauthenticated.                                    |\n|RLOS-indicator       |This is indication to show that the UE is RLOS      |\n|                     |attached.                                           |\n|MSISDN               |The basic MSISDN of the UE. The presence is dictated|\n|                     |by its storage in the HSS.                          |\n|MM State             |Mobility management state ECM-IDLE, ECM-CONNECTED,  |\n|                     |EMM-DEREGISTERED.                                   |\n|GUTI                 |Globally Unique Temporary Identity.                 |\n|ME Identity          |Mobile Equipment Identity \u00e2\u20ac\u201c (e.g. IMEI/IMEISV)      |\n|                     |Software Version Number                             |\n|Tracking Area List   |Current Tracking area list                          |\n|TAI of last TAU      |TAI of the TA in which the last Tracking Area Update|\n|                     |was initiated.                                      |\n|E-UTRAN Cell Global  |Last known E-UTRAN cell                             |\n|Identity             |                                                    |\n|E-UTRAN Cell Identity|Time elapsed since the last E-UTRAN Cell Global     |\n|Age                  |Identity was acquired                               |\n|PS Cell Global       |Last known Primary Cell of Secondary Cell Group     |\n|Identity             |                                                    |\n|PS Cell Age          |Time elapsed since the last Primary Cell of         |\n|                     |Secondary Cell Group Identity was acquired          |\n|CSG ID               |Last known CSG ID when the UE was active            |\n|CSG membership       |Last known CSG membership of the UE when the UE was |\n|                     |active                                              |\n|Access mode          |Access mode of last known ECGI when the UE was      |\n|                     |active                                              |\n|Authentication Vector|Temporary authentication and key agreement data that|\n|                     |enables an MME to engage in AKA with a particular   |\n|                     |user. An EPS Authentication Vector consists of four |\n|                     |elements:                                           |\n|                     |a) network challenge RAND,                          |\n|                     |b) an expected response XRES,                       |\n|                     |c) Key KASME,                                       |\n|                     |d) a network authentication token AUTN.             |\n|UE Radio Access      |UE radio access capabilities including WB-E-UTRAN   |\n|Capability           |capabilities but not NB-IoT capabilities.           |\n|UE Radio Capability  |If RACS is supported, uniquely identifies a set of  |\n|ID                   |UE radio access capabilities                        |\n|LTE-M Indication     |Indicates the UE is a LTE-M UE and the UE Radio     |\n|                     |Access Capability includes LTE Cat- M1 or LTE Cat-M1|\n|                     |and LTE Cat-M2. This is based on indication from the|\n|                     |E-UTRAN provides.                                   |\n|NB-IoT specific UE   |NB-IoT specific UE radio access capabilities.       |\n|Radio Access         |                                                    |\n|Capability           |                                                    |\n|MS Classmark 2       |GERAN/UTRAN CS domain core network classmark (used  |\n|                     |if the MS supports SRVCC to GERAN or UTRAN)         |\n|MS Classmark 3       |GERAN CS domain radio network classmark (used if the|\n|                     |MS supports SRVCC to GERAN)                         |\n|Supported Codecs     |List of codecs supported in the CS domain (used if  |\n|                     |the MS supports SRVCC to GERAN or UTRAN)            |\n|UE Network Capability|UE network capabilities including security          |\n|                     |algorithms and key derivation functions supported by|\n|                     |the UE                                              |\n|MS Network Capability|For a GERAN and/or UTRAN capable UE, this contains  |\n|                     |information needed by the SGSN.                     |\n|UE Specific DRX      |UE specific DRX parameters for A/Gb mode, Iu mode   |\n|Parameters           |and S1-mode                                         |\n|Active Time value for|UE specific Active Time value allocated by MME for  |\n|PSM                  |power saving mode handling.                         |\n|Extended idle mode   |Negotiated extended idle mode DRX parameters for    |\n|DRX parameters       |S1-mode.                                            |\n|RAT specific         |Indicates a Subscribed Paging Time Window value for |\n|Subscribed Paging    |the associated RAT, NB-IoT, WB-E-UTRAN or both.     |\n|Time Window          |                                                    |\n|Selected NAS         |Selected NAS security algorithm                     |\n|Algorithm            |                                                    |\n|eKSI                 |Key Set Identifier for the main key KASME. Also     |\n|                     |indicates whether the UE is using security keys     |\n|                     |derived from UTRAN or E-UTRAN security association. |\n|KASME                |Main key for E-UTRAN key hierarchy based on CK, IK  |\n|                     |and Serving network identity                        |\n|NAS Keys and COUNT   |KNASint, K_NASenc, and NAS COUNT parameter.         |\n|Selected CN operator |Selected core network operator identity (to support |\n|id                   |network sharing as defined in TS\u00c2\u00a023.251\u00c2\u00a0[24]).      |\n|Recovery             |Indicates if the HSS is performing database         |\n|                     |recovery.                                           |\n|Access Restriction   |The access restriction subscription information. For|\n|                     |this purpose, WB-E-UTRAN and NB-IoT are separate    |\n|                     |RATs. In addition, it includes restriction          |\n|                     |information on the use of NR as secondary RAT for   |\n|                     |user plane connectivity and use of Unlicensed       |\n|                     |Spectrum (in the form of LAA, or LWA/LWIP).         |\n|ODB for PS parameters|Indicates that the status of the operator determined|\n|                     |barring for packet oriented services.               |\n|APN-OI Replacement   |Indicates the domain name to replace the APN-OI when|\n|                     |constructing the PDN\u00c2\u00a0GW FQDN upon which to perform a|\n|                     |DNS resolution. This replacement applies for all the|\n|                     |APNs in the subscriber's profile. See TS\u00c2\u00a023.003\u00c2\u00a0[9] |\n|                     |clause\u00c2\u00a09.1.2 for more information on the format of  |\n|                     |domain names that are allowed in this field.        |\n|MME IP address for   |MME IP address for the S11 interface (used by S-GW) |\n|S11                  |                                                    |\n|MME TEID for S11     |MME Tunnel Endpoint Identifier for S11 interface.   |\n|S-GW IP address for  |S-GW IP address for the S11 and S4 interfaces       |\n|S11/S4               |                                                    |\n|S-GW TEID for S11/S4 |S-GW Tunnel Endpoint Identifier for the S11 and S4  |\n|                     |interfaces.                                         |\n|SGSN IP address for  |SGSN IP address for the S3 interface (used if ISR is|\n|S3                   |activated for the GERAN and /or UTRAN capable UE)   |\n|SGSN TEID for S3     |SGSN Tunnel Endpoint Identifier for S3 interface    |\n|                     |(used if ISR is activated for the E-UTRAN capable   |\n|                     |UE)                                                 |\n|eNodeB Address in Use|The IP address of the eNodeB currently used for     |\n|for S1-MME           |S1-MME.                                             |\n|eNB UE S1AP ID       |Unique identity of the UE within eNodeB.            |\n|MME UE S1AP ID       |Unique identity of the UE within MME.               |\n|Subscribed UE-AMBR   |The Maximum Aggregated uplink and downlink MBR      |\n|                     |values to be shared across all Non-GBR bearers      |\n|                     |according to the subscription of the user.          |\n|UE-AMBR              |The currently used Maximum Aggregated uplink and    |\n|                     |downlink MBR values to be shared across all Non-GBR |\n|                     |bearers.                                            |\n|EPS Subscribed       |The charging characteristics for the UE e.g. normal,|\n|Charging             |prepaid, flat rate and/or hot billing.              |\n|Characteristics      |                                                    |\n|Subscribed RFSP Index|An index to specific RRM configuration in the       |\n|                     |E-UTRAN that is received from the HSS.              |\n|Subscribed Additional|An index to additional RRM configuration in the     |\n|RRM Policy Index     |E-UTRAN that is received from the HSS               |\n|RFSP Index in Use    |An index to specific RRM configuration in the       |\n|                     |E-UTRAN that is currently in use.                   |\n|Additional RRM Policy|An index to additional RRM configuration in the     |\n|Index in Use         |E-UTRAN that is currently in use                    |\n|Trace reference      |Identifies a record or a collection of records for a|\n|                     |particular trace.                                   |\n|Trace type           |Indicates the type of trace                         |\n|Trigger id           |Identifies the entity that initiated the trace      |\n|OMC identity         |Identifies the OMC that shall receive the trace     |\n|                     |record(s).                                          |\n|URRP-MME             |URRP-MME indicating that the HSS has requested the  |\n|                     |MME to notify the HSS regarding UE reachability at  |\n|                     |the MME                                             |\n|DL Data Buffer       |When extended buffering of DL data has been invoked |\n|Expiration Time      |for UEs that uses power saving functions e.g. PSM,  |\n|                     |this time is when the buffer will expire in the     |\n|                     |Serving GW.                                         |\n|Suggested number of  |Suggested number of buffered downlink packets at    |\n|buffered downlink    |extended buffering. This is an optional parameter.  |\n|packets              |                                                    |\n|CSG Subscription Data|The CSG Subscription Data is associated lists of CSG|\n|                     |IDs for the visiting PLMN and the equivalent PLMNs  |\n|                     |fo the visitng PLMN, and for each CSG ID optionally |\n|                     |an associated expiration date which indicates the   |\n|                     |point in time when the subscription to the CSG ID   |\n|                     |expires; an absent expiration date indicates        |\n|                     |unlimited subscription.                             |\n|                     |For a CSG ID that can be used to access specific    |\n|                     |PDNs via Local IP Access, the CSG ID entry includes |\n|                     |the corresponding APN(s).                           |\n|LIPA Allowed         |Specifies whether the UE is allowed to use LIPA in  |\n|                     |this PLMN.                                          |\n|Subscribed Periodic  |Indicates a subscribed Periodic RAU/TAU Timer value.|\n|RAU/TAU Timer        |                                                    |\n|MPS CS priority      |Indicates that the UE is subscribed to the eMLPP or |\n|                     |1x RTT priority service in the CS domain.           |\n|MPS EPS priority     |Indicates that the UE is subscribed to MPS in the   |\n|                     |EPS domain.                                         |\n|Voice Support Match  |An indication whether the UE radio capabilities are |\n|Indicator            |compatible with the network configuration (e.g.     |\n|                     |whether the SRVCC and frequency support by the UE   |\n|                     |matches those that the network relies upon for voice|\n|                     |coverage). The MME uses it as an input for setting  |\n|                     |the IMS voice over PS Session Supported Indication. |\n|Homogenous Support of|Indicates per UE if \"IMS Voice over PS Sessions\" is |\n|IMS Voice over PS    |homogeneously supported in all TAs in the serving   |\n|Sessions             |MME or homogeneously not supported, or, support is  |\n|                     |non-homogeneous/unknown, see clause\u00c2\u00a04.3.5.8A.       |\n|UE Radio Capability  |Information used by the eNB to enhance the paging   |\n|for Paging           |towards the UE (see clause\u00c2\u00a05.11.4). The UE Radio    |\n|Information          |Capability for Paging Information is defined in     |\n|                     |TS\u00c2\u00a036.413\u00c2\u00a0[36].                                     |\n|Information On       |Information sent by the eNB, and used by the MME    |\n|Recommended Cells And|when paging the UE to help determining the eNBs to  |\n|ENBs For Paging      |be paged as well as to provide the information on   |\n|                     |recommended cells to each of these eNBs, in order to|\n|                     |optimise the probability of successful paging while |\n|                     |minimizing the signalling load on the radio path.   |\n|Paging Attempt Count |Information provided by the MME and used by the eNB |\n|                     |to optimise signalling load and the use of network  |\n|                     |resources to successfully page a UE.                |\n|Information for      |Information for Enhanced Coverage level and cell ID |\n|Enhanced Coverage    |provided by the last eNB the UE was connected to.   |\n|CE mode B Support    |Indicates whether CE mode B is supported by the UE. |\n|Indicator            |The MME receives this from eNB (see TS\u00c2\u00a036.413\u00c2\u00a0[36]).|\n|Enhanced Coverage    |Specifies whether the UE is restricted to use       |\n|Restricted           |enhanced coverage feature or not.                   |\n|CE mode B Restricted |Specifies whether the UE is restricted to use CE    |\n|                     |mode B (i.e. Coverage Extension mode B) or not.     |\n|UE Usage Type        |Indicates the usage characteristics of the UE for   |\n|                     |use with Dedicated Core Networks (see               |\n|                     |clause\u00c2\u00a04.3.25).                                     |\n|Group ID-list        |List of the subscribed group(s) that the UE belongs |\n|                     |to                                                  |\n|Monitoring Event     |Describes the monitoring event configuration        |\n|Information Data     |information. See TS\u00c2\u00a023.682\u00c2\u00a0[74] for more            |\n|                     |information.                                        |\n|Delay Tolerant       |Indicates that the PDN connection is delay tolerant |\n|Connection           |such that the PDN GW supports holding the procedure,|\n|                     |after receiving a reject with a cause indicating    |\n|                     |that UE is temporarily not reachable due to power   |\n|                     |saving, until the PDN GW receives a message         |\n|                     |indicating that the UE is available for end to end  |\n|                     |signalling                                          |\n|PDN Connection       |Indicates whether the establishment of the PDN      |\n|Restriction          |connection is restricted for the UE.                |\n|Acknowledgements of  |Indicates whether acknowledgement of downlink NAS   |\n|downlink NAS data    |data PDUs for Control Plane CIoT EPS Optimisation is|\n|PDUs                 |disabled for this UE (enabled by default).          |\n|Service Gap Time     |Used to set the Service Gap timer for Service Gap   |\n|                     |Control (see clause\u00c2\u00a04.3.17.9).                      |\n|List of APN Rate     |Indicates for each APN, the APN Rate Control Status |\n|Control Statuses     |(see clause\u00c2\u00a04.7.7.3).                               |\n|For each active PDN connection:                                           |\n|APN in Use           |The APN currently used. This APN shall be composed  |\n|                     |of the APN Network Identifier and the default APN   |\n|                     |Operator Identifier, as specified in TS\u00c2\u00a023.003\u00c2\u00a0[9], |\n|                     |clause\u00c2\u00a09.1.2. Any received value in the APN OI      |\n|                     |Replacement field is not applied here.              |\n|APN Restriction      |Denotes the restriction on the combination of types |\n|                     |of APN for the APN associated with this EPS bearer  |\n|                     |Context.                                            |\n|APN Subscribed       |The subscribed APN received from the HSS.           |\n|PDN Type             |IPv4, IPv6, IPv4v6, Non-IP or Ethernet.             |\n|SCEF ID              |The IP address of the SCEF currently being used for |\n|                     |providing PDN connection to the SCEF.               |\n|IP Address(es)       |IPv4 address and/or IPv6 prefix                     |\n|                     |NOTE: The MME might not have information on the     |\n|                     |allocated IPv4 address. Alternatively, following    |\n|                     |mobility involving a pre-release 8 SGSN, this IPv4  |\n|                     |address might not be the one allocated to the UE.   |\n|Header Compression   |ROHC configuration and context(s) for IP header     |\n|Configuration        |compression for Control Plane CIoT EPS Optimisation.|\n|EPS PDN Charging     |The charging characteristics of this PDN connection,|\n|Characteristics      |e.g. normal, prepaid, flat-rate and/or hot billing. |\n|APN-OI Replacement   |APN level APN-OI Replacement which has same role as |\n|                     |UE level APN-OI Replacement but with higher priority|\n|                     |than UE level APN-OI Replacement. This is an        |\n|                     |optional parameter. When available, it shall be used|\n|                     |to construct the PDN\u00c2\u00a0GW FQDN instead of UE level    |\n|                     |APN-OI Replacement.                                 |\n|SIPTO permissions    |Indicates whether the traffic associated with this  |\n|                     |APN is prohibited for SIPTO, allowed for SIPTO      |\n|                     |excluding SIPTO at the local network, allowed for   |\n|                     |SIPTO including SIPTO at the local network or       |\n|                     |allowed for SIPTO at the local network only.        |\n|Local Home Network ID|If SIPTO@LN is enabled for this PDN connection it   |\n|                     |indicates the identity of the Local Home Network to |\n|                     |which the (H)eNB belongs.                           |\n|LIPA permissions     |Indicates whether the PDN can be accessed via Local |\n|                     |IP Access. Possible values are: LIPA-prohibited,    |\n|                     |LIPA-only and LIPA-conditional.                     |\n|WLAN offloadability  |Indicates whether the traffic associated with this  |\n|                     |PDN Connection is allowed to be offloaded to WLAN   |\n|                     |using the WLAN/3GPP Radio Interworking feature or if|\n|                     |it shall be kept on 3GPP access (see clause\u00c2\u00a04.3.23).|\n|                     |The indication may contain separate values per RAT  |\n|                     |(E-UTRA and UTRA).                                  |\n|VPLMN Address Allowed|Specifies whether the UE is allowed to use the APN  |\n|                     |in the domain of the HPLMN only, or additionally the|\n|                     |APN in the domain of the VPLMN.                     |\n|PDN GW Address in Use|The IP address of the PDN GW currently used for     |\n|(control plane)      |sending control plane signalling.                   |\n|PDN GW TEID for S5/S8|PDN GW Tunnel Endpoint Identifier for the S5/S8     |\n|(control plane)      |interface for the control plane. (For GTP-based     |\n|                     |S5/S8 only).                                        |\n|MS Info Change       |Need to communicate change in User Location         |\n|Reporting Action     |Information to the PDN GW with this EPS bearer      |\n|                     |Context.                                            |\n|CSG Information      |Need to communicate change in User CSG Information  |\n|Reporting Action     |to the PDN GW with this EPS bearer Context.         |\n|                     |This field denotes separately whether the MME/SGSN  |\n|                     |are requested to send changes in User CSG           |\n|                     |Information for (a) CSG cells, (b) hybrid cells in  |\n|                     |which the subscriber is a CSG member and (c) hybrid |\n|                     |cells in which the subscriber is not a CSG member.  |\n|Presence Reporting   |Need to communicate a change of UE presence in      |\n|Area Action          |Presence Reporting Area. This field denotes         |\n|                     |separately the PRA identifier(s), and the list(s) of|\n|                     |the Presence Reporting Area elements (if provided by|\n|                     |the PDN GW). The status (i.e. active or inactive)   |\n|                     |for each Presence Reporting Area is stored in the   |\n|                     |MME when dynamic resource handling for Presence     |\n|                     |Reporting Area is configured in the MME.            |\n|EPS subscribed QoS   |The bearer level QoS parameter values for that APN's|\n|profile              |default bearer (QCI and ARP) (see clause\u00c2\u00a04.7.3).    |\n|Subscribed APN-AMBR  |The Maximum Aggregated uplink and downlink MBR      |\n|                     |values to be shared across all Non-GBR bearers,     |\n|                     |which are established for this APN, according to the|\n|                     |subscription of the user.                           |\n|APN-AMBR             |The Maximum Aggregated uplink and downlink MBR      |\n|                     |values to be shared across all Non-GBR bearers,     |\n|                     |which are established for this APN, as decided by   |\n|                     |the PDN\u00c2\u00a0GW.                                         |\n|PDN GW GRE Key for   |PDN GW assigned GRE Key for the S5/S8 interface for |\n|uplink traffic (user |the user plane for uplink traffic. (For PMIP-based  |\n|plane)               |S5/S8 only)                                         |\n|Default bearer       |Identifies the EPS Bearer Id of the default bearer  |\n|                     |within the given PDN connection.                    |\n|low access priority  |Indicates that the UE requested low access priority |\n|                     |when the PDN connection was opened.                 |\n|                     |NOTE: The low access priority indicator is only     |\n|                     |stored for the purpose to be included in charging   |\n|                     |records.                                            |\n|Communication        |Indicates per UE the Communication Patterns and     |\n|Patterns             |their corresponding validity times as specified in  |\n|                     |TS\u00c2\u00a023.682\u00c2\u00a0[74]. The Communication Patterns are not  |\n|                     |provided to the SGSN.                               |\n|PDN continuity at    |Provides for this APN how to handle a PDN connection|\n|inter RAT mobility   |when UE the moves between \"broadband\" (WB-E-UTRAN   |\n|                     |and UTRAN) and \"narrowband\" (NB-IoT, GPRS,          |\n|                     |EC-GSM-IoT). Possible values are: maintain the PDN  |\n|                     |connection; disconnect the PDN connection with a    |\n|                     |reactivation request; disconnect PDN connection     |\n|                     |without reactivation request; or to leave it to     |\n|                     |local VPLMN policy.                                 |\n|For each bearer within the PDN connection:                                |\n|EPS Bearer ID        |An EPS bearer identity uniquely identifies an EP S  |\n|                     |bearer for one UE accessing via E-UTRAN             |\n|TI                   |Transaction Identifier                              |\n|S-GW IP address for  |IP address of the S-GW for the S1-u interface. Also |\n|S1-u/S11-u           |IP address of the S-GW for the S11-u interface if no|\n|                     |separation of S1-U and S11-U is required. The S11-u |\n|                     |interface is used for Control Plane CIoT EPS        |\n|                     |Optimisation.                                       |\n|S-GW IP address for  |IP address of the S-GW for the S11-u interfaces if  |\n|S11-u                |S11-u is separated from S1-u. The S11-u interface is|\n|                     |used for Control Plane CIoT EPS Optimisation.       |\n|S-GW TEID for        |Tunnel Endpoint Identifier of the S-GW for the S1-u |\n|S1-u/S11-u           |interface. Also Tunnel Endpoint Identifier of the   |\n|                     |S-GW for the S11-u interface if no separation of    |\n|                     |S1-U and S11-U is required. The S11-u interface is  |\n|                     |used for Control Plane CIoT EPS Optimisation.       |\n|S-GW TEID for S11-u  |Tunnel Endpoint Identifier of the S-GW for the S11-u|\n|                     |interface if S11-u is separated from S1-u. The S11-u|\n|                     |interface is used for Control Plane CIoT EPS        |\n|                     |Optimisation.                                       |\n|MME IP address for   |MME IP address for the S11-u interface (Used by the |\n|S11-u                |S-GW). The S11-u interface is used for Control Plane|\n|                     |CIoT EPS Optimisation.                              |\n|MME TEID for S11-u   |MME Tunnel Endpoint Identifier for the S11-u        |\n|                     |interface (Used by the S-GW). The S11-u interface is|\n|                     |used for Control Plane CIoT EPS Optimisation.       |\n|PDN GW TEID for S5/S8|P-GW Tunnel Endpoint Identifier for the S5/S8       |\n|(user plane)         |interface for the user plane. (Used for S-GW change |\n|                     |only).                                              |\n|                     |NOTE: The PDN GW TEID is needed in MME context as   |\n|                     |S-GW relocation is triggered without interaction    |\n|                     |with the source S-GW, e.g. when a TAU occurs. The   |\n|                     |Target S-GW requires this Information Element, so it|\n|                     |must be stored by the MME.                          |\n|PDN GW IP address for|P\u00c2\u00a0GW IP address for user plane for the S5/S8        |\n|S5/S8 (user plane)   |interface for the user plane. (Used for S-GW change |\n|                     |only).                                              |\n|                     |NOTE: The PDN GW IP address for user plane is needed|\n|                     |in MME context as S-GW relocation is triggered      |\n|                     |without interaction with the source S-GW, e.g. when |\n|                     |a TAU occurs. The Target S GW requires this         |\n|                     |Information Element, so it must be stored by the    |\n|                     |MME.                                                |\n|EPS bearer QoS       |QCI and ARP                                         |\n|                     |optionally: GBR and MBR for GBR bearer              |\n|TFT                  |Traffic Flow Template. (For PMIP-based S5/S8 only)  |\n|Serving              |The Serving PLMN-Rate-Control limits the maximum    |\n|PLMN-Rate-Control    |number of NAS Data PDUs per deci hour sent per      |\n|                     |direction (uplink/downlink) using the Control Plane |\n|                     |CIoT EPS Optimisation for a PDN connection.         |\n\n               Table 5.7.2-2: MME Emergency Configuration Data\n\nThe MME Emergency Configuration Data is used instead of UE subscription\ndata received from the HSS, for all emergency bearer services that are\nestablished by an MME on UE request.\n\n\n|Field                |Description                                         |\n|Emergency Access     |A label according to DNS naming conventions         |\n|Point Name (em APN)  |describing the access point used for Emergency PDN  |\n|                     |connection (wild card not allowed).                 |\n|Emergency QoS profile|The bearer level QoS parameter values for Emergency |\n|                     |APN's default bearer (QCI and ARP). The ARP is an   |\n|                     |ARP value reserved for emergency bearers.           |\n|Emergency APN-AMBR   |The Maximum Aggregated uplink and downlink MBR      |\n|                     |values to be shared across all Non-GBR bearers,     |\n|                     |which are established for the Emergency APN, as     |\n|                     |decided by the PDN GW.                              |\n|Emergency PDN GW     |The statically configured identity of the PDN GW    |\n|identity             |used for emergency APN. The PDN GW identity may be  |\n|                     |either an FQDN or an IP address.                    |\n|Non-3GPP HO Emergency|The statically configured identity of the PDN GW    |\n|PDN GW identity      |used for emergency APN when a PLMN supports handover|\n|                     |to non-3GPP access. The PDN GW identity may be      |\n|                     |either an FQDN or an IP address.(NOTE\u00c2\u00a01)            |\n|NOTE-1: The FQDN always resolves to one PDN GW.                           |\n\n  NOTE:  QCI for Emergency APN's default bearer is set per operator\n         configuration.\n\n                 Table 5.7.2-3: MME RLOS Configuration Data\n\nThe MME RLOS Configuration Data is used, for all RLOS PDN connection that\nare established by an MME on UE request instead of UE subscription data\nreceived from HSS.\n\n\n|Field                |Description                                         |\n|Restricted Local     |A label according to DNS naming conventions         |\n|Operator Services    |describing the access point used for RLOS PDN       |\n|Access Point Name    |connection (wild card not allowed).                 |\n|(RLOS APN)           |                                                    |\n|RLOS QoS profile     |The bearer level QoS parameter values for RLOS APN's|\n|                     |default bearer (QCI and ARP).                       |\n|RLOS APN-AMBR        |The Maximum Aggregated uplink and downlink MBR      |\n|                     |values to be shared across all Non-GBR bearers,     |\n|                     |which are established for the RLOS APN, as decided  |\n|                     |by the PDN GW.                                      |\n|RLOS PDN GW identity |The statically configured identity of the PDN GW    |\n|                     |used for RLOS APN. The PDN GW identity may be either|\n|                     |an FQDN or an IP address.                           |\n|NOTE-1: The FQDN always resolves to one PDN GW.                           |\n\n  NOTE:  QCI and ARP for RLOS APN's default bearer is set per operator\n         configuration.\n\n\n"}, {"key": "Serving GW", "numbering": "5.7.3", "title_level": 2, "desc": "5.7.3  Serving GW\n\nThe Serving GW maintains the following EPS bearer context information for\nUEs. Table\u00c2\u00a05.7.3-1 shows the context fields for one UE.\n\nFor emergency attached or RLOS attached UEs which are not authenticated,\nIMEI is stored in context.\n\n                   Table 5.7.3-1: S-GW EPS bearer context\n\n|Field              |Description                             |E-UTRAN |UTRAN/  |\n|                   |                                        |        |GERAN   |\n|IMSI               |IMSI (International Mobile Subscriber   |X       |X       |\n|                   |Identity) is the subscriber permanent   |        |        |\n|                   |identity.                               |        |        |\n|IMSI-unauthenticate|This is an IMSI indicator to show the   |X       |X       |\n|d-indicator        |IMSI is unauthenticated.                |        |        |\n|ME Identity        |Mobile Equipment Identity (e.g.         |X       |X       |\n|                   |IMEI/IMEISV).                           |        |        |\n|MSISDN             |The basic MSISDN of the UE. The presence|X       |X       |\n|                   |is dictated by its storage in the HSS.  |        |        |\n|Selected CN        |Selected core network operator identity |X       |X       |\n|operator id        |(to support network sharing as defined  |        |        |\n|                   |in TS\u00c2\u00a023.251\u00c2\u00a0[24]).                     |        |        |\n|LTE-M Indication   |Information used by the core network to |X       |        |\n|                   |differentiate traffic from category M   |        |        |\n|                   |UEs for charging purposes, where        |        |        |\n|                   |different values of M (e.g. M1, M2) are |        |        |\n|                   |defined in TS\u00c2\u00a036.306\u00c2\u00a0[82].              |        |        |\n|MME TEID for S11   |MME Tunnel Endpoint Identifier for the  |X       |        |\n|                   |S11 interface                           |        |        |\n|MME IP address for |MME IP address the S11 interface.       |X       |        |\n|S11                |                                        |        |        |\n|S-GW TEID for      |S-GW Tunnel Endpoint Identifier for the |X       |X       |\n|S11/S4 (control    |S11 Interface and the S4 Interface      |        |        |\n|plane)             |(control plane).                        |        |        |\n|S-GW IP address for|S-GW IP address for the S11 interface   |X       |X       |\n|S11/S4 (control    |and the S4 Interface (control plane).   |        |        |\n|plane)             |                                        |        |        |\n|SGSN IP address for|SGSN IP address for the S4 interface    |        |X       |\n|S4 (control plane) |(Used by the S-GW).                     |        |        |\n|SGSN TEID for S4   |SGSN Tunnel Endpoint Identifier for the |        |X       |\n|(control plane)    |S4 interface.                           |        |        |\n|Trace reference    |Identifies a record or a collection of  |X       |X       |\n|                   |records for a particular trace.         |        |        |\n|Trace type         |Indicates the type of trace             |X       |X       |\n|Trigger id         |Identifies the entity that initiated the|X       |X       |\n|                   |trace                                   |        |        |\n|OMC identity       |Identifies the OMC that shall receive   |X       |X       |\n|                   |the trace record(s).                    |        |        |\n|Last known Cell Id |This is the last location of the UE     |X       |X       |\n|                   |known by the network                    |(NOTE\u00c2\u00a01)|(NOTE\u00c2\u00a01)|\n|Last known Cell Id |This is the age of the above UE location|X       |X       |\n|age                |information                             |(NOTE\u00c2\u00a01)|(NOTE\u00c2\u00a01)|\n|DL Data Buffer     |The time until the Serving GW buffers DL|X       |X       |\n|Expiration Time    |data, when the MME has requested        |        |        |\n|                   |extended buffering in an DDN Ack (e.g.  |        |        |\n|                   |when a UE is in PSM).                   |        |        |\n|Serving            |For inclusion on Serving GW CDR to allow|X       |        |\n|PLMN-Rate-Control  |post processing of CDRs and permit      |        |        |\n|                   |detection of abusive UEs.               |        |        |\n|For each PDN Connection:                                                     |\n|NOTE: The following entries are repeated for each PDN.                       |\n|APN in Use         |The APN currently used, as received from|X       |X       |\n|                   |the MME or S4 SGSN.                     |        |        |\n|PDN Type           |IPv4, IPv6, IPv4v6, Non-IP or Ethernet. |X       |        |\n|                   |(This information is needed by the SGW  |        |        |\n|                   |in order to determine whether to perform|        |        |\n|                   |Paging Policy Differentiation).         |        |        |\n|EPS PDN Charging   |The charging characteristics of this PDN|X       |X       |\n|Characteristics    |connection, e.g. normal, prepaid,       |        |        |\n|                   |flat-rate and/or hot billing.           |        |        |\n|P-GW Address in Use|The IP address of the P-GW currently    |X       |X       |\n|(control plane)    |used for sending control plane          |        |        |\n|                   |signalling.                             |        |        |\n|P-GW TEID for S5/S8|P-GW Tunnel Endpoint Identifier for the |X       |X       |\n|(control plane)    |S5/S8 interface for the control plane.  |        |        |\n|                   |(For GTP-based S5/S8 only).             |        |        |\n|P-GW Address in Use|The IP address of the P-GW currently    |X       |X       |\n|(user plane)       |used for sending user plane traffic.    |        |        |\n|                   |(For PMIP-based S5/S8 only)             |        |        |\n|P-GW GRE Key for   |PDN GW assigned GRE Key for the S5/S8   |X       |X       |\n|uplink traffic     |interface for the user plane for uplink |        |        |\n|(user plane)       |traffic. (For PMIP-based S5/S8 only)    |        |        |\n|S-GW IP address for|S-GW IP address for the S5/S8 for the   |X       |X       |\n|S5/S8 (control     |control plane signalling.               |        |        |\n|plane)             |                                        |        |        |\n|S-GW TEID for S5/S8|S-GW Tunnel Endpoint Identifier for the |X       |X       |\n|(control plane)    |S5/S8 control plane interface. (For     |        |        |\n|                   |GTP-based S5/S8 only).                  |        |        |\n|S-GW Address in Use|The IP address of the S-GW currently    |X       |X       |\n|(user plane)       |used for sending user plane traffic.    |        |        |\n|                   |(For PMIP-based S5/S8 only)             |        |        |\n|S-GW GRE Key for   |Serving GW assigned GRE Key for the     |X       |X       |\n|downlink traffic   |S5/S8 interface for the user plane for  |        |        |\n|(user plane)       |downlink traffic. (For PMIP-based S5/S8 |        |        |\n|                   |only)                                   |        |        |\n|Default Bearer     |Identifies the default bearer within the|X       |X       |\n|                   |PDN connection by its EPS Bearer Id.    |        |        |\n|                   |(For PMIP based S5/S8.)                 |        |        |\n|For each EPS Bearer within the PDN Connection:                               |\n|NOTE: The following entries defining the EPS Bearer specific parameters are  |\n|included within the set of parameters defining the PDN Connection.           |\n|EPS Bearer Id      |An EPS bearer identity uniquely         |X       |X       |\n|                   |identifies an EPS bearer for one UE     |        |        |\n|                   |accessing via E-UTRAN                   |        |        |\n|TFT                |Traffic Flow Template                   |X       |X       |\n|P-GW Address in Use|The IP address of the P-GW currently    |X       |X       |\n|(user plane)       |used for sending user plane traffic.    |        |        |\n|                   |(For GTP-based S5/S8 only).             |        |        |\n|P-GW TEID for S5/S8|P-GW Tunnel Endpoint Identifier for the |X       |X       |\n|(user plane)       |S5/S8 interface for the user plane. (For|        |        |\n|                   |GTP-based S5/S8 only).                  |        |        |\n|S-GW IP address for|S-GW IP address for user plane data     |X       |X       |\n|S5/S8 (user plane) |received from PDN GW. (For GTP-based    |        |        |\n|                   |S5/S8 only).                            |        |        |\n|S-GW TEID for S5/S8|S-GW Tunnel Endpoint Identifier for the |X       |X       |\n|(user plane)       |S5/S8 interface for the user plane. (For|        |        |\n|                   |GTP-based S5/S8 only).                  |        |        |\n|S-GW IP address for|S-GW IP address for the S1-u interface  |X       |X       |\n|S1-u, S12, S4 (user|(used by the eNodeB), for the S12       |        |        |\n|plane) and S11-u   |interface (used by the RNC) and for the |        |        |\n|                   |S4 interface (used by the SGSN). Also   |        |        |\n|                   |S-GW IP address for the S11-u interface |        |        |\n|                   |(used by the MME) if no separation of   |        |        |\n|                   |S1-U and S11-U is required. The S11-u   |        |        |\n|                   |interface is used for Control Plane CIoT|        |        |\n|                   |EPS Optimisation.                       |        |        |\n|S-GW IP address for|S-GW IP address for the S11-u interface |X       |        |\n|S11-u              |(used by the MME). if S11-u is separated|        |        |\n|                   |from S1-u. The S11-u interface is used  |        |        |\n|                   |for Control Plane CIoT EPS Optimisation.|        |        |\n|S-GW TEID for S1-u,|S-GW Tunnel Endpoint Identifier for the |X       |X       |\n|S12, S4 (user      |S1-u interface, for the S12 interface   |        |        |\n|plane) and S11-u   |(used by the RNC) and for the S4        |        |        |\n|                   |interface (used by the SGSN). Also S-GW |        |        |\n|                   |Tunnel Endpoint Identifier for the S11-u|        |        |\n|                   |interface (used by the MME) if no       |        |        |\n|                   |separation of S1-U and S11-U is         |        |        |\n|                   |required. The S11-u interface is used   |        |        |\n|                   |for Control Plane CIoT EPS Optimisation.|        |        |\n|S-GW TEID for S11-u|S-GW Tunnel Endpoint Identifier for the |X       |        |\n|                   |S11-u interface (used by the MME) if    |        |        |\n|                   |S11-u is separated from S1-u. The S11-u |        |        |\n|                   |interface is used for Control Plane CIoT|        |        |\n|                   |EPS Optimisation.                       |        |        |\n|MME IP address for |MME IP address for the S11-u interface  |X       |        |\n|S11-u              |(Used by the S-GW). The S11-u interface |        |        |\n|                   |is used for Control Plane CIoT EPS      |        |        |\n|                   |Optimisation.                           |        |        |\n|MME TEID for S11-u |MME Tunnel Endpoint Identifier for the  |X       |        |\n|                   |S11-u interface (Used by the S-GW). The |        |        |\n|                   |S11-u interface is used for Control     |        |        |\n|                   |Plane CIoT EPS Optimisation.            |        |        |\n|eNodeB IP address  |eNodeB IP address for the S1-u interface|X       |        |\n|for S1-u           |(Used by the S-GW).                     |        |        |\n|eNodeB TEID for    |eNodeB Tunnel Endpoint Identifier for   |X       |        |\n|S1-u               |the S1-u interface.                     |        |        |\n|RNC IP address for |RNC IP address for the S12 interface    |        |X       |\n|S12                |(Used by the S-GW).                     |        |        |\n|RNC TEID for S12   |RNC Tunnel Endpoint Identifier for the  |        |X       |\n|                   |S12 interface.                          |        |        |\n|SGSN IP address for|SGSN IP address for the S4 interface    |        |X       |\n|S4 (user plane)    |(Used by the S-GW).                     |        |        |\n|SGSN TEID for S4   |SGSN Tunnel Endpoint Identifier for the |        |X       |\n|(user plane)       |S4 interface.                           |        |        |\n|EPS Bearer QoS     |ARP, GBR, MBR, QCI.                     |X       |X       |\n|Charging Id        |Charging identifier, identifies charging|X       |X       |\n|                   |records generated by S-GW and PDN GW.   |        |        |\n|NOTE\u00c2\u00a01: The \"Last Known Cell Id Age\" is stored so that when UE location      |\n|information is made available from both E-UTRAN and UTRAN/GERAN, the Serving |\n|GW can determine the \"Last Known Cell Id\".                                   |\n\n\n"}, {"key": "PDN GW", "numbering": "5.7.4", "title_level": 2, "desc": "5.7.4  PDN GW\n\nThe PDN GW maintains the following EPS bearer context information for UEs.\nTable\u00c2\u00a05.7.4-1 shows the context fields for one UE.\n\nFor emergency attached or RLOS attached UEs which are not authenticated,\nIMEI is stored in context.\n\n                         Table 5.7.4-1: P-GW context\n\n|Field              |Description                            |E-UTRAN |UTRAN/ |\n|                   |                                       |        |GERAN  |\n|IMSI               |IMSI (International Mobile Subscriber  |X       |X      |\n|                   |Identity) is the subscriber permanent  |        |       |\n|                   |identity.                              |        |       |\n|IMSI-unauthenticate|This is an IMSI indicator to show the  |X       |X      |\n|d-indicator        |IMSI is unauthenticated.               |        |       |\n|ME Identity        |Mobile Equipment Identity (e.g.        |X       |X      |\n|                   |IMEI/IMEISV).                          |        |       |\n|MSISDN             |The basic MSISDN of the UE. The        |X       |X      |\n|                   |presence is dictated by its storage in |        |       |\n|                   |the HSS.                               |        |       |\n|Selected CN        |Selected core network operator identity|X       |X      |\n|operator id        |(to support network sharing as defined |        |       |\n|                   |in TS\u00c2\u00a023.251\u00c2\u00a0[24]).                    |        |       |\n|RAT type           |Current RAT                            |X       |X      |\n|LTE-M Indication   |Information used by the core network to|X       |       |\n|                   |differentiate traffic from Category M  |        |       |\n|                   |UEs for charging purposes, where       |        |       |\n|                   |different values of M (e.g. M1, M2) are|        |       |\n|                   |defined in TS\u00c2\u00a036.306\u00c2\u00a0[82].             |        |       |\n|Trace reference    |Identifies a record or a collection of |X       |X      |\n|                   |records for a particular trace.        |        |       |\n|Trace type         |Indicates the type of trace            |X       |X      |\n|Trigger id         |Identifies the entity that initiated   |X       |X      |\n|                   |the trace                              |        |       |\n|OMC identity       |Identifies the OMC that shall receive  |X       |X      |\n|                   |the trace record(s).                   |        |       |\n|For each APN in use:                                                       |\n|NOTE: The following entries are repeated for each APN.                     |\n|APN in use         |The APN currently used, as received    |X       |X      |\n|                   |from the S-GW.                         |        |       |\n|APN AMBR           |The maximum aggregated uplink and      |X       |X      |\n|                   |downlink MBR values to be shared across|        |       |\n|                   |all Non-GBR bearers, which are         |        |       |\n|                   |established for this APN.              |        |       |\n|APN Rate Control   |The APN-Rate-Control limits the maximum|X       |       |\n|                   |number of uplink/downlink packets and  |        |       |\n|                   |the maximum number of additional       |        |       |\n|                   |exception report packets per a specific|        |       |\n|                   |time unit (e.g. minute, hour, day,     |        |       |\n|                   |week) for this APN. It includes an     |        |       |\n|                   |indication as to whether or not        |        |       |\n|                   |Exception reports may still be sent    |        |       |\n|                   |when the limit has been met.           |        |       |\n|For each PDN Connection within the APN:                                    |\n|NOTE: The following entries are repeated for each PDN connection within the|\n|APN.                                                                       |\n|IP Address(es)     |IPv4 address and/or IPv6 prefix.       |X       |X      |\n|PDN type           |IPv4, IPv6, IPv4v6, Non-IP or Ethernet.|X       |X      |\n|S-GW Address in Use|The IP address of the S-GW currently   |X       |X      |\n|(control plane)    |used for sending control plane         |        |       |\n|                   |signalling.                            |        |       |\n|S-GW TEID for S5/S8|S-GW Tunnel Endpoint Identifier for the|X       |X      |\n|(control plane)    |S5/S8 interface for the control plane. |        |       |\n|                   |(For GTP-based S5/S8 only).            |        |       |\n|S-GW Address in Use|The IP address of the S-GW currently   |X       |X      |\n|(user plane)       |used for sending user plane traffic.   |        |       |\n|                   |(For PMIP-based S5/S8 only).           |        |       |\n|S-GW GRE Key for   |Serving GW assigned GRE Key for the    |X       |X      |\n|downlink traffic   |S5/S8 interface for the user plane for |        |       |\n|(user plane)       |downlink traffic. (For PMIP-based S5/S8|        |       |\n|                   |only).                                 |        |       |\n|P-GW IP address for|P-GW IP address for the S5/S8 for the  |X       |X      |\n|S5/S8 (control     |control plane signalling.              |        |       |\n|plane)             |                                       |        |       |\n|P-GW TEID for S5/S8|P-GW Tunnel Endpoint Identifier for the|X       |X      |\n|(control plane)    |S5/S8 control plane interface. (For    |        |       |\n|                   |GTP-based S5/S8 only).                 |        |       |\n|P-GW Address in Use|The IP address of the P-GW currently   |X       |X      |\n|(user plane)       |used for sending user plane traffic.   |        |       |\n|                   |(For PMIP-based S5/S8 only).           |        |       |\n|P-GW GRE Key for   |PDN GW assigned GRE Key for the S5/S8  |X       |X      |\n|uplink traffic     |interface for the user plane for uplink|        |       |\n|(user plane)       |traffic. (For PMIP-based S5/S8 only).  |        |       |\n|MS Info Change     |The MME and/or SGSN serving the UE     |X       |X      |\n|Reporting support  |support(s) procedures for reporting    |        |       |\n|indication         |User Location Information and/or User  |        |       |\n|                   |CSG Information.                       |        |       |\n|MS Info Change     |Denotes whether the MME and/or the SGSN|X       |X      |\n|Reporting Action   |is/are requested to send changes in    |        |       |\n|                   |User Location Information change.      |        |       |\n|CSG Information    |Denotes whether the MME and/or the SGSN|X       |X      |\n|Reporting Action   |is/are requested to send changes in    |        |       |\n|                   |User CSG Information change.           |        |       |\n|                   |This field denotes separately whether  |        |       |\n|                   |the MME/SGSN are requested to send     |        |       |\n|                   |changes in User CSG Information for (a)|        |       |\n|                   |CSG cells, (b) hybrid cells in which   |        |       |\n|                   |the subscriber is a CSG member, and (c)|        |       |\n|                   |hybrid cells in which the subscriber is|        |       |\n|                   |not a CSG member, or any combination of|        |       |\n|                   |the above.                             |        |       |\n|Presence Reporting |Denotes whether the MME and/or the SGSN|X       |X      |\n|Area Action        |is/are requested to send changes of UE |        |       |\n|                   |presence in Presence Reporting         |        |       |\n|                   |Area.This field denotes separately the |        |       |\n|                   |Presence Reporting Area identifier and |        |       |\n|                   |the list of Presence Reporting Area    |        |       |\n|                   |elements.                              |        |       |\n|BCM                |The negotiated Bearer Control Mode for |        |X      |\n|                   |GERAN/UTRAN.                           |        |       |\n|Default Bearer     |Identifies the default bearer within   |X       |X      |\n|                   |the PDN connection by its EPS Bearer   |        |       |\n|                   |Id. The default bearer is the one which|        |       |\n|                   |is established first within the PDN    |        |       |\n|                   |connection. (For GTP based S5/S8 or for|        |       |\n|                   |PMIP based S5/S8 if multiple PDN       |        |       |\n|                   |connections to the same APN are        |        |       |\n|                   |supported).                            |        |       |\n|EPS PDN Charging   |The charging characteristics of this   |        |       |\n|Characteristics    |PDN connection e.g. normal, prepaid,   |        |       |\n|                   |flat-rate and/or hot billing.          |        |       |\n|Serving            |The Serving PLMN-Rate-Control limits   |X       |       |\n|PLMN-Rate-Control  |the maximum number of uplink/downlink  |        |       |\n|                   |messages per a specific time unit (e.g.|        |       |\n|                   |minute, hour, day, week) for a PDN     |        |       |\n|                   |connection.                            |        |       |\n|3GPP PS Data Off   |Current 3GPP PS Data Off status of the |        |       |\n|Status             |UE.                                    |        |       |\n|For each EPS Bearer within the PDN Connection:                             |\n|NOTE\u00c2\u00a01: The following entries defining the EPS Bearer specific parameters  |\n|are included within the set of parameters defining the PDN Connection.     |\n|NOTE\u00c2\u00a02: The following entries are stored only for GTP-based S5/S8.         |\n|EPS Bearer Id      |An EPS bearer identity uniquely        |X       |X      |\n|                   |identifies an EPS bearer for one UE    |        |       |\n|                   |accessing via E-UTRAN                  |        |       |\n|TFT                |Traffic Flow Template                  |X       |X      |\n|S-GW Address in Use|The IP address of the S-GW currently   |X       |X      |\n|(user plane)       |used for sending user plane traffic.   |        |       |\n|S-GW TEID for S5/S8|S-GW Tunnel Endpoint Identifier for the|X       |X      |\n|(user plane)       |S5/S8 interface for the user plane.    |        |       |\n|P-GW IP address for|P-GW IP address for user plane data    |X       |X      |\n|S5/S8 (user plane) |received from PDN GW.                  |        |       |\n|P-GW TEID for S5/S8|P-GW Tunnel Endpoint Identifier for the|X       |X      |\n|(user plane)       |GTP Based S5/S8 interface for user     |        |       |\n|                   |plane.                                 |        |       |\n|EPS Bearer QoS     |ARP, GBR, MBR, QCI.                    |X       |X      |\n|Charging Id        |Charging identifier, identifies        |X       |X      |\n|                   |charging records generated by S-GW and |        |       |\n|                   |PDN GW.                                |        |       |\n\n\n"}, {"key": "UE", "numbering": "5.7.5", "title_level": 2, "desc": "5.7.5  UE\n\nThe UE maintains the following context information. Table\u00c2\u00a05.7.5-1 shows the\ncontext fields. A GERAN or UTRAN capable UE maintains in addition the\ncontext information as described in a similar UE context table in\nTS\u00c2\u00a023.060\u00c2\u00a0[7].\n\n                          Table 5.7.5-1: UE context\n\n|Field              |Description                                          |\n|IMSI               |IMSI (International Mobile Subscriber Identity) is   |\n|                   |the subscriber's permanent identity.                 |\n|EMM State          |Mobility management state EMM-REGISTERED,            |\n|                   |EMM-DEREGISTERED.                                    |\n|GUTI               |Globally Unique Temporary Identity.                  |\n|ME Identity        |Mobile Equipment Identity \u00e2\u20ac\u201c (e.g. IMEI/IMEISV)       |\n|                   |Software Version Number.                             |\n|Tracking Area List |Current Tracking area list.                          |\n|last visited TAI   |A TAI which is contained in the TA list the UE       |\n|                   |registered to the network and which identifies the   |\n|                   |tracking area last visited by the UE.                |\n|Selected NAS       |Selected NAS security algorithm.                     |\n|Algorithm          |                                                     |\n|Selected AS        |Selected AS security algorithms.                     |\n|Algorithm          |                                                     |\n|eKSI               |Key Set Identifier for the main key KASME. Also      |\n|                   |indicates whether the UE is using security keys      |\n|                   |derived from UTRAN or E-UTRAN security association   |\n|KASME              |Main key for E-UTRAN key hierarchy based on CK, IK   |\n|                   |and Serving network identity.                        |\n|NAS Keys and COUNT |KNASint, KNASenc, and NAS COUNT parameter.           |\n|Temporary Identity |This parameter is used internally by the UE to       |\n|used in Next update|memorise which temporary ID it has to indicate in the|\n|(TIN)              |Attach Request and RAU/TAU Request as specified in   |\n|                   |clause 4.3.5.6.                                      |\n|UE Specific DRX    |Preferred E-UTRAN DRX cycle length                   |\n|Parameters         |                                                     |\n|Active Time value  |UE specific Active Time value allocated by MME for   |\n|for PSM            |power saving mode handling.                          |\n|Extended idle mode |Extended idle mode DRX parameters received from the  |\n|DRX parameters     |MME.                                                 |\n|Allowed CSG list   |The Allowed CSG list, which is under both user and   |\n|                   |operator control, indicates the list of CSG IDs and  |\n|                   |the associated PLMN where the UE is a member.        |\n|Operator CSG list  |The Operator CSG list, which is under exclusive      |\n|                   |Operator control, indicates the list of CSG IDs and  |\n|                   |the associated PLMN where the UE is a member.        |\n|Service Gap Time   |Used to set the Service Gap timer for Service Gap    |\n|                   |Control (see clause\u00c2\u00a04.3.17.9).                       |\n|For each active PDN connection:                                          |\n|APN in Use         |The APN currently used. This APN shall be composed of|\n|                   |the APN Network Identifier and the default APN       |\n|                   |Operator Identifier, as specified in TS\u00c2\u00a023.003\u00c2\u00a0[9],  |\n|                   |clause\u00c2\u00a09.1.2.                                        |\n|APN AMBR           |The maximum aggregated uplink and downlink MBR to be |\n|                   |shared across all Non-GBR bearers, which are         |\n|                   |established for this APN.                            |\n|Assigned PDN Type  |The PDN Type assigned by the network (IPv4, IPv6,    |\n|                   |IPv4v6, Non-IP or Ethernet).                         |\n|IP Address(es)     |IPv4 address and/or IPv6 prefix                      |\n|Header Compression |ROHC configuration and context(s) for IP header      |\n|Configuration      |compression for Control Plane CIoT EPS Optimisation. |\n|Default Bearer     |Identifies the default bearer within the PDN         |\n|                   |connection by its EPS Bearer Id. The default bearer  |\n|                   |is the one which is established first within the PDN |\n|                   |connection.                                          |\n|WLAN offloadability|Indicates whether the traffic associated with this   |\n|                   |PDN Connection is allowed to be offloaded to WLAN    |\n|                   |using the WLAN/3GPP Radio Interworking feature or if |\n|                   |it shall be kept on 3GPP access (see clause\u00c2\u00a04.3.23). |\n|                   |The indication may contain separate values per RAT   |\n|                   |(E-UTRA and UTRA).                                   |\n|APN Rate Control   |The APN-Rate-Control limits the maximum number of    |\n|                   |uplink packets and the maximum number of additional  |\n|                   |exception report packets per a specific time unit    |\n|                   |(e.g. minute, hour, day, week) for this APN. It      |\n|                   |includes an indication as to whether or not Exception|\n|                   |reports may still be sent when the limit has been    |\n|                   |met.                                                 |\n|Serving            |The Serving PLMN-Rate-Control limits the maximum     |\n|PLMN-Rate-Control  |number of NAS Data PDUs per deci hour sent uplink    |\n|                   |using the Control Plane CIoT EPS Optimisation for a  |\n|                   |PDN connection.                                      |\n|For each EPS Bearer within the PDN connection                            |\n|EPS Bearer ID      |An EPS bearer identity uniquely identifies an EPS    |\n|                   |bearer for one UE accessing via E-UTRAN.             |\n|TI                 |Transaction Identifier                               |\n|EPS bearer QoS     |GBR and MBR for GBR bearer.                          |\n|TFT                |Traffic Flow Template.                               |\n\n\n"}, {"key": "Handling of Wild Card APN", "numbering": "5.7.6", "title_level": 2, "desc": "5.7.6  Handling of Wild Card APN\n\nWhen the wild card APN is present in the subscription context, the UE is\nauthorized to connect to APNs which are not present in the subscription\ncontext.\n\nWhen a request is received for registering a PDN GW ID and there is no PDN\nsubscription context with this APN, the nodes (HSS/MME/ S4 SGSN) shall\nstore the PDN GW ID - APN relation for the UE.\n\nWhen a request is received for deregistering of PDN GW ID and there is no\nPDN subscription context with this APN, the nodes (HSS/MME/S4 SGSN) shall\ndelete the PDN GW ID - APN relation from the list of APN - PDN GW ID\nrelations.\n\n\n"}, {"key": "CSS", "numbering": "5.7.7", "title_level": 2, "desc": "5.7.7  CSS\n\nPlease refer to TS\u00c2\u00a023.008\u00c2\u00a0[28] for the content of the information storage\nfor the CSS.\n\n\n"}, {"key": "Charging", "numbering": "5.7A", "title_level": 1, "desc": "5.7A Charging\n\n\n"}, {"key": "General", "numbering": "5.7A.1", "title_level": 2, "desc": "5.7A.1 General\n\nAccounting functionality is provided by the Serving GW and the PDN GW. When\na Secondary RAT may be used, the Serving GW and PDN GW can be assisted by\nthe E-UTRAN (see clause\u00c2\u00a05.7A.4).\n\nThe Serving GW shall be able to collect and report for each UE accounting\ninformation, i.e. the amount of data transmitted in uplink and downlink\ndirection categorized with the QCI and ARP pair per UE per PDN connection.\nFor GTP-based S5/S8 the accounting information is collected and reported\nper bearer.\n\nThe Serving GW shall not collect UE accounting information for packets that\nare being processed for the sole purpose of indirect forwarding.\n\nThe Serving GW for inter-operator charging, and the PDN GW shall be able to\ninterface the OFCS according to charging principles and through reference\npoints specified in TS\u00c2\u00a032.240\u00c2\u00a0[51].\n\nThe PDN GW shall be able to provide charging functionality for each UE\naccording to TS\u00c2\u00a023.203\u00c2\u00a0[6]. The PDN GW data collection for charging and\nusage monitoring purposes can be temporarily paused as described in\nclause\u00c2\u00a05.3.6A.\n\nA PDN GW without a Gx interface shall be able to support flow based online\nand offline charging based on local configuration and interaction with the\nOnline and Offline Charging Systems.\n\nThe Online Charging System may provide a PRA identifier(s) to the PDN GW to\nsubscribe to notifications about changes of UE presence in Presence\nReporting Area as defined in the TS\u00c2\u00a023.203\u00c2\u00a0[6]. For UE-dedicated Presence\nReporting Areas the Online Charging System also provides the list(s) of the\nelements comprising each subscribed UE-dedicated Presence Reporting Area.\n\nThe PDN GW shall be able to collect and report, for each UE, accounting\ninformation, i.e. the amount of data received and transmitted in uplink and\ndownlink direction categorized with the QCI and ARP pair per UE per PDN\nconnection. For GTP-based S5/S8 the accounting information is collected and\nreported per bearer. The PDN GW data collection can be temporarily paused\nas described in clause\u00c2\u00a05.3.6A based on operator configuration in the PDN\nGW.\n\n  NOTE:  A consequence of pausing the PDN GW data collection is that PDN GW\n         accounting information may not correspond to the volume that\n         traversed the PDN GW and it is therefore not possible to verify\n         accounting information collected at the Serving GW for inter-\n         operator charging.\n\nThe Charging identifier(s) generated by the PDN GW per bearer for GTP-based\nS5/S8 and per PDN connection for PMIP-based S5/S8 and the PDN GW address\nfor control signalling enables the correlation of the reporting from a\nServing GW and a PDN GW. The Charging identifier is uniquely assigned\nwithin the PDN GW.\n\nThe PDN GW receives Charging Characteristics from the Serving GW through\nGTP-S5/S8, or through PMIP for PMIP-based S5/S8. The handling of the\nCharging Characteristics in the P-GW is defined in TS\u00c2\u00a032.251\u00c2\u00a0[44].\n\nTo enable CSG charging function for a subscriber consuming network services\nvia a CSG cell or a hybrid cell, User CSG Information is transferred to the\nPDN GW as indicated by CSG Information Reporting Action. User CSG\nInformation includes CSG ID, access mode and CSG membership indication. CSG\nmembership indication of whether the UE is a member of the CSG is included\nif the access mode is hybrid.\n\nThe valid CSG information shall be available in the serving GW and PDN GW\nin connected mode.\n\nThe PCRF shall, if deployed, provide User CSG Information reporting rules\nto the PDN GW at Attach and PDN Connectivity Request. PDN GW sets the CSG\nInformation Reporting Action IE according to the User CSG Information\nreporting rules and sends it to Serving GW and MME.\n\nTo enable the MME to signal the correct RAT Type (NB-IoT or WB-E-UTRAN) to\nthe SGW and PDN GW for accounting information generation purposes, the\neNodeB informs the MME of the RAT Type and TAC associated with each cell in\nthe S1 SETUP REQUEST and ENB CONFIGURATION UPDATE messages\n(TS\u00c2\u00a036.413\u00c2\u00a0[36]). If the eNodeB signals WB-EUTRAN and the UE is of Category\nM from the UE's radio capability, the MME reports RAT Type LTE-M to the\nSGW. See clause\u00c2\u00a05.11.5 for more details.\n\n\n"}, {"key": "Usage Data Reporting for Secondary RAT", "numbering": "5.7A.2", "title_level": 2, "desc": "5.7A.2 Usage Data Reporting for Secondary RAT\n\nWhen a Secondary RAT can be used in conjunction with E-UTRAN, the HPLMN or\nVPLMN operator may wish to record the data volume sent on the Secondary\nRAT.\n\nIn order to reduce the complexity of this procedure, and to align with\nexisting per EPS bearer accounting procedures, the following principles are\nused in this release:\n\n  a) The PLMN locally activates the Secondary RAT Usage Data Reporting by E-\n    UTRAN O&M. The activation can happen separately for Data Volume\n    Reporting of NR and Unlicensed Spectrum. If the PLMN uses this feature,\n    it should ensure that this functionality is supported by all eNodeBs\n    that support NR, Unlicensed Spectrum aggregation (if used to record\n    data volume sent over unlicensed spectrum) as a Secondary RAT.\n\n  b) The E-UTRAN reports uplink and downlink data volumes to the EPC for\n    the Secondary RAT on a per EPS bearer basis and per time interval.\n\n  NOTE\u00c2\u00a01:  Secondary RAT includes access type NR and usage data reporting\n         for Secondary RAT includes reporting of the combination of NR usage\n         as defined in TS\u00c2\u00a037.340\u00c2\u00a0[85].\n\n  c) At X2 handover and S1 handover, the source eNodeB reports the data\n    volumes to the EPC. The reported data volume excludes data forwarded to\n    the target RAN node.\n\n  d) At S1 Release, Connection Suspend, and EPS Bearer Deactivation the\n    eNodeB reports the data volumes to the EPC.\n\n  e) To assist \"partial CDR\" generation at the Serving GW and the PDN GW, E-\n    UTRAN O&M can instruct the E-UTRAN to also make periodic reports in\n    case no event has triggered a report before the period expires.\n\n  NOTE\u00c2\u00a02:  The timing of these periodic E-UTRAN reports is not expected to\n         align with the timing of partial CDR generation. Hence the\n         frequency of E-UTRAN reports might be greater than that of partial\n         CDR generation.\n\n  NOTE\u00c2\u00a03:  RAN needs to be able to partition the measurements in a report\n         to indicate usage that occurred before and after an absolute time.\n         An example of the absolute time is that RAN is configured to\n         partition data usage reports that occurred before and after\n         midnight.\n\n  f) As an option, the Serving Gateway sends the data volume reports on to\n    PDN GWs identified in bilateral roaming agreements.\n\n\n"}, {"key": "Secondary RAT Usage Data Reporting Procedure", "numbering": "5.7A.3", "title_level": 2, "desc": "5.7A.3 Secondary RAT Usage Data Reporting Procedure\n\nThe procedure in Figure 5.7A.3-1 may be used to report Secondary RAT usage\ndata from eNodeB to the MME. It is executed by the eNodeB to report the\nSecondary RAT usage data information which is then included in messages on\nS11 towards Serving GW and S5/S8 interface to the PGW (e.g. during I-RAT\nhandover procedures, S1 handover, X2 handover). This then further uses\nexisting EPC signaling of the procedures involved.\n\nThe procedure in Figure 5.7A.3-2 may be used to report the Secondary RAT\nusage data from MME to the Serving GW. Optionally, it is used to report the\nSecondary RAT usage data from Serving GW to the PDN GW when the reporting\nto PDN GW is activated.\n\nIf the Secondary RAT usage data is provided by an S1AP message from eNodeB\nto MME other than the one indicated in Figure 5.7A.3-1, the procedures in\nclause\u00c2\u00a05.7A.3-2 may be used to transfer the secondary RAT usage data to the\nServing GW and PDN GW (e.g. during S1 Release procedure).\n\nDuring IRAT handovers, the procedures 5.7A.3-1 to 5.7A.3-2 in its entirety\nis executed to provide reporting of Secondary RAT usage data to the Serving\nGW and to the PDN GW if PGW secondary RAT usage data reporting is active.\n\nHandover related signalling of IRAT procedures may be used to provide\nreporting of Secondary RAT usage data to the Serving GW instead of the\nsignaling of figure\u00c2\u00a05.7A.3-2, when PGW secondary RAT usage data reporting\nis not active.\n\n                                    [pic]\n\n      Figure 5.7A.3-1: RAN Secondary RAT usage data Reporting procedure\n\n  1. The eNB, if it supports Dual Connectivity with Secondary RAT (using NR\n    radio (see clause\u00c2\u00a04.3.2a on Support for Dual Connectivity), using\n    unlicensed spectrum aggregation in the form of LAA/LWA/LWIP (see\n    clause\u00c2\u00a04.3.30)) and it is configured to report Secondary RAT usage data\n    for the UE, depending on certain conditions documented in this\n    specification, it shall send a RAN usage data Report message to the MME\n    including the Secondary RAT usage data for the UE. The eNB will send\n    only one RAN usage report for a UE when the UE is subject to handover\n    by RAN. The RAN usage data report includes a handover flag to indicate\n    when the message is sent triggered by X2-handover.\n\n                                    [pic]\n\n      Figure 5.7A.3-2: GW Secondary RAT usage data Reporting procedure\n\nThe eNB, if it supports Dual Connectivity with Secondary RAT (using NR\nradio (see clause\u00c2\u00a04.3.2a on Support for Dual Connectivity), using\nunlicensed spectrum aggregation in the form of LAA/LWA/LWIP (see\nclause\u00c2\u00a04.3.30)) and it is configured to report Secondary RAT usage data for\nthe UE, it shall send include the Secondary RAT usage data for the UE to\nthe MME in certain messages depending on certain conditions documented\nelsewhere in this TS.\n\nSecondary RAT usage reporting from the eNB is provided using S1 signaling\nmessage which are either at the UE level (eg. Path Switch Request, etc), or\nat bearer level (eg. E-RAB modification indication, Deactivate bearer\nresponse, etc.) as captured in relevant clauses in this specification. In\ncase Secondary RAT usage report is provided in bearer level signaling\nmessage by the eNodeB, the Secondary RAT usage report is related only to\nthe specific bearer.\n\n  1. The MME forwards the Secondary RAT usage data to the SGW in a Change\n    Notification Request (Secondary RAT usage data) message. If the SGW is\n    requested to forward Secondary RAT usage data to the PGW, the MME\n    includes a flag causing the SGW to forward this to the PGW. Also, the\n    MME informs the Serving GW if the secondary RAT usage data shall not be\n    processed by the Serving GW (e.g. during Serving GW relocation when the\n    usage data is to be forwarded via the target Serving GW).\n\n  2. The Serving GW may, based on flags received in the previous message\n    and local configuration in the Serving GW, send the Change Notification\n    (Secondary RAT usage data) message to the PDN GW.\n\n  3. The PDN GW acknowledges receiving the Secondary RAT usage data for the\n    UE by a Change Notification Ack() message to the Serving GW.\n\n  4. The SGW acknowledges by sending a Change Notification ack() message\n    back to the MME.\n\n\n"}, {"key": "Secondary RAT Periodic Usage Data Reporting Procedure", "numbering": "5.7A.4", "title_level": 2, "desc": "5.7A.4 Secondary RAT Periodic Usage Data Reporting Procedure\n\nPeriodic reporting of the Secondary RAT usage data is an optional function.\nWhen eNodeB, as defined in bullet e) of clause\u00c2\u00a05.7A.2, is configured with a\n\"time interval for Secondary RAT usage data reporting\", the eNodeB shall\nsend a RAN Usage Data Report message for periodic reporting purposes to the\nMME only when this timer expires for a UE for which Secondary RAT usage\ndata reporting is ongoing. The timer runs from the last usage reporting for\nthe UE. The MME also indicates to SGW if secondary RAT usage data reporting\nto the PGW is active.\n\nThe procedures 5.7A.3-1 to 5.7A.3-2 in its entirety is executed to provide\nperiodic reporting of Secondary RAT usage data to the Serving GW and to the\nPDN GW when PGW secondary RAT usage data reporting is active. At use for\nperiodic usage data reporting, the procedure 5.7A.3-1 uses signalling from\neNB which does not include a handover flag.\n\n\n"}, {"key": "MBMS", "numbering": "5.8", "title_level": 1, "desc": "5.8  MBMS\n\nMBMS is a point-to-multipoint service in which data is transmitted from a\nsingle source entity to multiple recipients. Transmitting the same data to\nmultiple recipients allows network resources to be shared.\n\nSupport of MBMS for EPS is defined in TS\u00c2\u00a023.246\u00c2\u00a0[13].\n\n\n"}, {"key": "Interactions with other services", "numbering": "5.9", "title_level": 1, "desc": "5.9  Interactions with other services\n\n\n"}, {"key": "Location Reporting Procedure", "numbering": "5.9.1", "title_level": 2, "desc": "5.9.1  Location Reporting Procedure\n\nThis procedure is used by an MME to request the eNodeB to report where the\nUE is currently located when the target UE is in ECM-CONNECTED state. The\nneed for the eNodeB to continue reporting ceases when the UE transitions to\nECM-IDLE. This procedure may be used for services that require accurate\ncell identification (e.g. for emergency services, lawful intercept,\ncharging). When Dual Connectivity is activated, the report includes the\nCell IDs of both the Primary cell in the Master RAN node and the Primary\ncell in the Secondary RAN node.\n\n                                    [pic]\n\n                Figure 5.9.1-1: Location Reporting Procedure\n\n  1) The MME sends a Location Reporting Control message to the eNodeB. The\n    Location Reporting Control message shall identify the UE for which\n    reports are requested, the requested location information and may\n    contain information such as reporting type. Requested location\n    information is TAI+EGCI. Reporting type indicates whether the message\n    is intended to trigger a single stand-alone report about the current\n    Cell ID serving the UE or start the eNodeB to report whenever the UE\n    changes cell. In the latter case, when Dual Connectivity is in use the\n    Master RAN node shall also report to the MME whenever the primary cell\n    in the Secondary RAN node changes.\n\n  2) The eNodeB sends a Location Report message informing the MME about the\n    location of the UE which shall include the requested location\n    information. If Dual Connectivity is activated, then the Master RAN\n    node shall also include the Cell ID of the primary cell in the\n    secondary RAN node.\n\n  3) The MME can send a Cancel Location Reporting message to inform the\n    eNodeB that it should terminate location reporting for a given UE. This\n    message is needed only when the reporting was requested for a reporting\n    period.\n\n  NOTE:  Location reporting is transferred during X2 handover, although new\n         control signalling is not transferred during an active handover.\n\n\n"}, {"key": "Location Change Reporting Procedure", "numbering": "5.9.2", "title_level": 2, "desc": "5.9.2  Location Change Reporting Procedure\n\n\n"}, {"key": "General", "numbering": "5.9.2.1", "title_level": 3, "desc": "5.9.2.1  General\n\nThe PDN GW may request for each PDN connection independently whether the\nMME shall report changes of ECGI/eNodeB ID/TAI (by using the \"MS Info\nChange Reporting Action\" parameter) and/or the UE entering/leaving a\nPresence Reporting Area (by using the \"Presence Reporting Area Action\"\nparameter) and/or whether the MME shall report changes of user CSG\ninformation (by using \"CSG Information Reporting Action\" parameter) to the\nPDN GW.\n\nThis reporting (any combination of \"MS Info Change Reporting Action\" and/or\n\"Presence Reporting Area Action\" and/or \"CSG Information Reporting Action\")\nmay be controlled by the PDN GW at the following procedures:\n\n  -  Attach,\n\n  -  Tracking Area Update (when inducing a Modify Bearer procedure to the\n    PDN GW),\n\n  -  Inter-RAT Mobility to E-UTRAN (when inducing a Modify Bearer procedure\n    to the PDN GW),\n\n  -  Dedicated bearer activation,\n\n  -  PDN GW initiated bearer modification with bearer QoS update,\n\n  -  PDN GW initiated bearer modification without bearer QoS update,\n\n  -  UE requested PDN connectivity,\n\n  -  UE requested bearer resource modification.\n\nThe \"Presence Reporting Area Action\" and \"Presence Reporting Area\nInformation\" parameters apply to all procedures listed above but, within\nthis specification, their usage has only been described in the message\nflows related with the Attach and the UE requested PDN connectivity\nprocedures.\n\nThe reporting of UE entering/leaving a Presence Reporting Area is further\ndescribed in clause\u00c2\u00a05.9.2.2.\n\nThe PDN GW may also request the MME to stop any of the above mentioned\ntypes of reporting. The MME shall obey the last explicit instruction\nreceived from the PDN GW or source MME.\n\nDuring both mobility management and session management procedures, the MME\nshall indicate to the PDN GW the support of reporting location changes\n(using the MS Info Change Reporting support indication):\n\n  -  If ECGI/eNodeB ID/TAI information is permitted to be sent to the PDN\n    GW according to MME operator's policy,\n\n  -  If CSG information is permitted to be sent to the PDN GW according to\n    MME operator's policy.\n\nThe MME may be configured to report ECGI/eNodeB ID/TAI changes only when\none or more E-RAB(s) are established. Otherwise the MME shall report\nECGI/eNodeB ID/TAI changes as soon as detected.\n\nIf the level of support changes during a mobility management procedure then\nthe MME shall indicate the current level of support to the S-GW and shall\nin addition provide ECGI/eNodeB ID/TAI even if the PDN GW has not requested\nthis information. This could for example happen during MME change when the\nlevel of support indicated by the old MME is not the same as in the new\nMME.\n\n  NOTE\u00c2\u00a01:  The inclusion of ECGI/eNodeB ID/TAI will trigger a Modify Bearer\n         Request message from S-GW to the PDN GW and therefore this will\n         make sure that the new level of support reaches the PDN GW.\n\nAt change of Serving Node (MME/S4-SGSN), the old Serving Node provides the\nnew serving node with \"MS Info Change Reporting Action\" as previously\nrequested by the PDN GW. The new Serving Node takes the \"MS Info Change\nReporting Action\" immediately into account with the exception that, at\nmobility between a S4-SGSN and a MME, the new MME (respectively S4-SGSN)\ndoes not take into account the \"MS Info Change Reporting Action\" received\nfrom the S4-SGSN (respectively MME) but assumes that no location\ninformation change reporting is requested for the target RAT. At a change\nof RAT type between EUTRAN and UTRAN or between EUTRAN and GERAN, if\nlocation information change reporting is required in the target RAT, the\nPDN GW shall request \"MS Info Change Reporting Action\" from the new Serving\nNode (MME or S4-SGSN). Upon inter-RAT mobility, if the target MME/S4-SGSN\nsupports location information change reporting, the target MME/S4-SGSN\nshall include the User Location Information in the Create Session Request /\nModify Bearer Request, regardless of whether location Information change\nreporting had been requested in the previous RAT by the PDN GW.\n\nThe PDN GWPDN GW shall not request the MME to report location changes if it\nhas not received the indication for corresponding support from the MME.\n\n  NOTE\u00c2\u00a02:  For E-UTRAN access, homogeneous support of reporting changes of\n         UE presence in a Presence Reporting Area in a network is assumed:\n         When the PCRF configuration indicates that reporting changes of UE\n         presence in a Presence Reporting Area is supported for E-UTRAN,\n         this means it is supported by all the PDN GWPDN GW, all MME and all\n         the SGW including the MME and SGW working in network sharing mode.\n         If change of UE presence in Presence Reporting Area reporting is\n         not supported, the PCRF may instead activate location information\n         change reporting at cell, eNodeB or tracking area level.\n\nThe following procedure shall be used for location change reports to the\nPDN GWPDN GW where the report is not combined with other mobility\nmanagement or session management signalling. The procedure shall only apply\nwhen the MME has been explicitly requested to report location changes.\n\nThe following procedure can be used for MO Exception Data Counter reporting\nwhere the report is not combined with other mobility management or session\nmanagement signalling. The MME only includes the MO Exception data counter\nif the RRC establishment cause is set to \"MO exception data\" and the UE is\naccessing via the NB-IoT RAT. The MME maintains the MO Exception Data\nCounter for Serving PLMN Rate Control purposes (see clause\u00c2\u00a04.7.7.2). The\nMME may immediately send the MO Exception Data Counter to the Serving GW.\nAlternatively, in order to reduce signalling, the MME may send the MO\nException Data Counter to the Serving GW as described in TS\u00c2\u00a029.274\u00c2\u00a0[43].\nThe SGW and PDN GWPDN GW indicate each use of this RRC establishment cause\nby the related counter on its CDR.\n\n  NOTE\u00c2\u00a03:  Due to the increased signalling load, it is recommended that\n         ECGI/eNodeB ID/TAI or CSG reporting is only applied for a limited\n         number of subscribers.\n\nFigure 5.9.2.1-1 represents the ECGI change triggering a report of change\nin ECGI, and/or the User CSG information change triggering a report of\nchange in user CSG information. The figure also shows the reporting of a\nTAI change and/or when a UE enters or leaves a Presence Reporting Area.\n\n                                    [pic]\n\n Figure 5.9.2.1-1: Notification of the ECGI, TAI and/or user CSG information\n                                   changes\n\n  1a.  the MME has received an ECGI information Update from the eNodeB.\n\n  1b.  The MME detects that the user CSG information has changed by\n    comparing with the MME stored user CSG information, or\n\n  1c.  The MME detects that the TAI of the UE has changed, or\n\n  1d.  The MME detects that the UE has entered or left a Presence Reporting\n    Area defined for this UE.\n\n  NOTE\u00c2\u00a04:  It is possible that these changes are triggered at same time.\n\n  2. If the MME has been requested to report location changes to the PDN\n    GWPDN GW for the UE (under the conditions specified in clause\u00c2\u00a05.9.2),\n    the MME shall send the Change Notification message to the SGW\n    indicating the new ECGI, TAI and/or user CSG information. The MME\n    stores the notified user CSG information. If the MME has been requested\n    to report a change of UE presence in Presence Reporting Area (under the\n    conditions specified in clause\u00c2\u00a05.9.2), the MME shall send the Change\n    Notification message including the Presence Reporting Area Information\n    comprising the area identifier(s) and indication(s) on whether the UE\n    is inside or outside the area(s). If MME decides to reactivate one or\n    more of the inactive Presence Reporting Area(s), the Presence Reporting\n    Area Information in this message also comprises the reactivated PRA\n    identifier(s), and indication(s) on whether the UE is inside or outside\n    the reactivated area(s).\n\n  3. The SGW forwards the Change Notification message to the PDN GWPDN GW.\n    If dynamic PCC is deployed, and location changes need to be conveyed to\n    the PCRF, then the PDN GWPDN GW shall send this information to the PCRF\n    as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6]. If Presence Reporting Area Information has\n    been received, the PDN GWPDN GW shall forward the Presence Reporting\n    Area Information to the PCRF, to the OCS or to both as defined in\n    TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  4. The PDN GW sends the Change Notification Ack to the SGW.\n\n  5. The SGW forwards the Change Notification Ack to the MME.\n\n\n"}, {"key": "Reporting at Presence Reporting Area entering and leaving", "numbering": "5.9.2.2", "title_level": 3, "desc": "5.9.2.2  Reporting at Presence Reporting Area entering and leaving\n\nIn some use cases policy control/charging decisions, such as QoS\nmodification or charging rate change depend on whether the UE is located\ninside or outside a specific area of interest (Presence Reporting Area),\nand especially on whether the UE enters or leaves that specific area of\ninterest.\n\nA Presence Reporting Area can be:\n\n  -  Either a \"UE-dedicated Presence Reporting Area\", defined in the\n    subscriber profile and composed of a short list of TAs/RAs, or eNBs\n    and/or cells/SAs in a PLMN;\n\n  -  Or a \"Core Network predefined Presence Reporting Area\", predefined in\n    MME/SGSN and composed of a short list of TAs/RAs, or eNBs and/or\n    cells/SAs in a PLMN.\n\n  NOTE\u00c2\u00a01:  eNBs are identified via the Global eNB ID IE defined in\n         TS\u00c2\u00a036.413\u00c2\u00a0[36].\n\n  NOTE\u00c2\u00a02:  Change of UE presence in Presence Reporting Area reporting does\n         not apply to roaming.\n\nThe reporting of changes of UE presence in Presence Reporting Area is for a\nspecific UE and is triggered as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6]. The PDN GW may\nrequest to Start/Stop reporting of changes of UE presence for one or more\nPresence Reporting Area(s) by using the Presence Reporting Area Action\nparameter. For UE-dedicated Presence Reporting Areas, the reporting request\n(Start) shall contain the PRA identifier(s) and the list(s) of TAs/RAs, or\neNBs and/or cells/SAIs composing the Presence Reporting Area(s). For Core\nNetwork predefined Presence Reporting Areas, the reporting request (Start)\nshall contain the PRA identifier(s). The request to Stop a reporting\ncontains the PRA identifier(s).\n\nEach Core Network predefined Presence Reporting Area can be configured with\na priority level in the MME/S4-SGSN. In order to prevent overload, the\nMME/S4-SGSN may set the reporting for one or more of the received Presence\nReporting Area(s) to inactive under consideration of the priority\nconfigured for each of Core Network predefined Presence Reporting Area(s),\nwhile storing the reporting request for this Presence Reporting Area in the\nuser context.\n\nUpon reception of a request for change of UE presence in Presence Reporting\nArea reporting, the MME/S4-SGSN shall report to the PDN GW via the SGW the\nPresence Reporting Area Information comprising the PRA identifier(s) and\nindication(s) on whether the UE is inside or outside the Presence Reporting\nArea(s). If the UE is in ECM-IDLE state, the MME may either bring the UE\ninto ECM-CONNECTED state, or, report based on the UE's last known location\nand when the UE was there. One or more Presence Reporting Area may be set\nfor a given PDN connection at a time. The serving node if needed only sets\nthe reporting of UE presence in a Presence Reporting Area to inactive when\nreceiving the reporting request for this Presence Reporting Area. If the\nMME/S4-SGSN decides to set the reporting of UE presence in one or more of\nthe received Presence Reporting Area(s) to inactive, the MME/S4-SGSN shall\nalso report the inactive Presence Reporting Area(s).\n\nThe MME/S4-SGSN shall notify the PDN GW when the UE enters or leaves a\nPresence Reporting Area, and no notifications are sent for UE movements\ninside or outside a Presence Reporting Area. The report of the change of UE\npresence in Presence Reporting Area shall contain the Presence Reporting\nArea Information comprising the PRA identifier(s) and indication(s) on\nwhether the UE is inside or outside the area(s). A report shall be sent if\nthe UE presence is different to the last one reported.\n\nThe MME/S4-SGSN may be configured with a PRA identifier which refers to a\nSet of Core Network predefined Presence Reporting Areas. The PDN GW may\nrequest Start reporting for this Set of Presence Reporting Areas by only\nindicating this PRA identifier in the Presence Reporting Area Action. When\nthe Presence Reporting Area(s) to be reported belong to a set of Core\nNetwork predefined Presence Reporting Areas in which the MME/S4-SGSN is\nrequested to report on change of UE presence, the MME/S4-SGSN shall\nadditionally add to the report the PRA identifier of the Set of Core\nNetwork predefined Presence Reporting Areas.\n\nUpon change of serving EPC node (MME, S4-SGSN), the PRA identifier(s) and\nif provided by the PDN GW the list(s) of Presence Reporting Area elements\nare transferred for all PDN connections as part of MM Context information\nto the target serving node during the mobility procedure. If one or more\nPresence Reporting Area(s) was set to inactive, the target serving node may\ndecide to reactivate one or more of the inactive Presence Reporting\nArea(s). The target serving node indicates per PDN connection to the\ncorresponding PDN GW the PRA identifier(s) and whether the UE is inside or\noutside the Presence Reporting Area(s) as well as the inactive Presence\nReporting Area(s), if any.\n\n  NOTE\u00c2\u00a03:  The target serving node cannot set the Presence Reporting\n         Area(s) received from the source serving node to inactive.\n\n\n"}, {"key": "IMSI and APN information retrieval procedure", "numbering": "5.9.3", "title_level": 2, "desc": "5.9.3  IMSI and APN information retrieval procedure\n\nThis procedure is used by the RCAF to determine the UEs that are served by\na congested eNB or E-UTRAN cell and the APNs of the active PDN connections\nof these UEs. This information is used to determine the PCRFs serving these\nUEs and subsequently report RAN user-plane congestion information (RUCI) to\nthe PCRFs. The decision whether the RCAF requests MME to retrieve the list\nof UEs on eNB or E-UTRAN cell level is up to operator configuration.\n\n  NOTE\u00c2\u00a01:  The details of congestion reporting to the PCRF are specified in\n         TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\nThe RCAF determines the MMEs that are serving the congested eNB or E-UTRAN\ncell based on the Tracking Area Identities served by the congested eNB or E-\nUTRAN cell. For further details on the related DNS procedure see\nTS\u00c2\u00a029.303\u00c2\u00a0[61]. The following steps are applied to all MMEs serving the\ncongested eNB or E-UTRAN cell.\n\n  NOTE\u00c2\u00a02:  In network sharing scenarios the RCAF belongs to the RAN\n         operator. In this case it is up to inter-operator agreements and\n         operator configuration which sharing partner's MMEs the RCAF\n         queries IMSI and APN information from.\n\n                                    [pic]\n\n        Figure 5.9.3-1: IMSI and APN information retrieval procedure\n\n  1. The RCAF sends an IMSI/APN information request to the MME. The request\n    shall identify whether the request refers to an eNB or an E-UTRAN cell\n    and shall contain the related eNB ID or ECGI.\n\n  NOTE\u00c2\u00a03:  The eNB ID is defined in TS\u00c2\u00a036.413\u00c2\u00a0[36].\n\n  2. The MME sends the IMSI/APN information response to the RCAF. The\n    response shall contain the list of UEs (identified by the IMSIs) served\n    by the eNB or E-UTRAN cell and the list of APNs of the active PDN\n    connections of each IMSI.\n\n     If the RCAF requested the IMSI/APN information on E-UTRAN cell level,\n    then the MME first determines the list of UEs served by that E-UTRAN\n    cell. The MME may achieve this by querying the eNB that the E-UTRAN\n    cell belongs to for the exact ECGI for all UEs served by this eNB using\n    the Location Reporting procedure (clause\u00c2\u00a05.9.1).\n\n  NOTE\u00c2\u00a04: Applying the Location Reporting feature due to an E-UTRAN cell\n         level RCAF request can increase S1-MME interface signalling load.\n\n  NOTE\u00c2\u00a05:  In order for RCAF to maintain the list of impacted UEs\n         (identified by the IMSIs) (and related APN information) for a\n         congested cell, the RCAF needs to regularly receive IMSI/APN\n         information updates from the MME. The details of whether the RCAF\n         needs to query the MME regularly or whether the MME updates the\n         RCAF regularly without further explicit requests from the RCAF is\n         specified in Stage 3.\n\n\n"}, {"key": "Multiple-PDN support and PDN activation for UEs supporting \"Attach", "numbering": "5.10", "title_level": 1, "desc": "5.10 Multiple-PDN support and PDN activation for UEs supporting \"Attach\n         without PDN connectivity\"\n\n\n"}, {"key": "General", "numbering": "5.10.1", "title_level": 2, "desc": "5.10.1 General\n\nThe EPS shall support simultaneous exchange of traffic to multiple PDNs\nthrough the use of separate PDN GWs or a single PDN GW. The usage of\nmultiple PDNs is controlled by network policies and defined in the user\nsubscription EPS Optimisation.\n\nThe EPS shall support UE-initiated connectivity establishment in order to\nallow multiple PDN connections to one or more PDNs. It shall be possible\nfor a UE to initiate disconnection from any PDN.\n\nAll simultaneously active PDN connections of a UE that are associated with\nthe same APN shall be provided by the same PDN-GW.\n\nUE support for multiple PDN connections is optional.\n\nIf the Control Plane CIoT EPS Optimisation is supported:\n\n  -  a PDN connection of Non-IP PDN Type may also be served by an SCEF (see\n    TS\u00c2\u00a023.682\u00c2\u00a0[74]); multiple PDN connections of Non-IP PDN Type may be\n    served by the same or multiple SCEFs; and\n\n  -  the MME decides, based on APN Configuration information, whether a PDN\n    connection is served by an SCEF or a PDN GW.\n\n\n"}, {"key": "UE requested PDN connectivity", "numbering": "5.10.2", "title_level": 2, "desc": "5.10.2 UE requested PDN connectivity\n\nThe UE requested PDN connectivity procedure for an E-UTRAN is depicted in\nfigure 5.10.2-1. The procedure allows the UE to request for connectivity to\nan additional PDN over E-UTRAN including allocation of a default bearer, if\nthe UE already has active PDN connections over E-UTRAN. This procedure may\nalso be used when a UE has set \"Attach without PDN Connectivity is\nsupported\" in the Preferred Network behaviour at attach time and the\nnetwork has acknowledged its support to the UE. If so, the UE may remain\nattached without a Default PDN connection and, at any time, request a PDN\nconnection to be established. This procedure is also used to request for\nconnectivity to an additional PDN over E-UTRAN, if the UE is simultaneously\nconnected to E-UTRAN and a non-3GPP access and the UE already has active\nPDN connections over both accesses. The PDN connectivity procedure may\ntrigger one or multiple Dedicated Bearer Establishment procedures to\nestablish dedicated EPS bearer(s) for that UE.\n\nAn emergency attached or RLOS attached UE shall not initiate any PDN\nConnectivity Request procedure. A normal attached UE shall request a PDN\nconnection for emergency services when Emergency Service is required and an\nemergency PDN connection is not already active.\n\nThe UE supporting 15 EPS bearers as defined in clause\u00c2\u00a04.12 shall not\ninitiate a UE requested PDN connectivity procedure if it has already 8 EPS\nbearers established and the UE has not received an Indication for support\nof 15 EPS bearers per UE or has received cause #65 \"maximum number of EPS\nbearers reached\".\n\n                                    [pic]\n\n               Figure 5.10.2-1: UE requested PDN connectivity\n\n  NOTE\u00c2\u00a01:  For a PMIP-based S5/S8, procedure steps (A) are defined in\n         TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps 3, 4, 5 and 13a/b concern GTP based S5/S8.\n\n  NOTE\u00c2\u00a02:  The UE also uses this procedure to request re-establishment of\n         existing PDN connectivity upon handover from non-3GPP accesses.\n\n  NOTE\u00c2\u00a03:  The steps in (B) are executed only upon handover from non-3GPP\n         access or if Presence Reporting Area Information is received from\n         the MME.\n\n  NOTE\u00c2\u00a04:  When using the Control Plane CIoT EPS Optimisation, steps 7 and\n         8 are modified and 9 and 10 are skipped.\n\n  1. The UE initiates the UE Requested PDN procedure by the transmission of\n    a PDN Connectivity Request (APN, PDN Type, Protocol Configuration\n    Options, Request Type, Header Compression Configuration) message. If\n    the UE was in ECM-IDLE mode, this NAS message is preceded by the\n    Service Request procedure if any of the exiting PDN connections were\n    using the User Plane without CIoT EPS Optimisation, or, if the user\n    plane was used just with User Plane CIoT EPS Optimisations, a\n    Connection Resume Procedure is executed instead. PDN type indicates the\n    requested IP version (IPv4, IPv4v6, IPv6, Non-IP, Ethernet).\n\n     The MME verifies that the APN provided by UE is allowed by\n    subscription. If the APN provided by the UE is not allowed by\n    subscription, based on operator policy, the MME may reject the request\n    from the UE with an appropriate cause, or accept the request by\n    replacing the UE requested APN with a network supported APN. The MME\n    uses that network supported APN for the remainder of this procedure,\n    except that the MME provides to the UE the same APN that the UE\n    requested. If the UE did not provide an APN, the MME shall use the APN\n    from the default PDN subscription context, and, use this APN for the\n    remainder of this procedure.\n\n     Protocol Configuration Options (PCO) are used to transfer parameters\n    between the UE and the Network and are sent transparently through the\n    MME and the Serving GW. The Protocol Configuration Options may include\n    the Address Allocation Preference, which indicates that the UE prefers\n    to obtain an IPv4 address only after the default bearer activation by\n    means of DHCPv4. If the UE has UTRAN or GERAN capabilities, it shall\n    send the NRSU in the PCO to indicate the support of the network\n    requested bearer control in UTRAN/GERAN. The UE sends the ETFTU in the\n    PCO to indicate the support of the extended TFT filter format. The\n    Request Type indicates \"initial request\" if the UE requests new\n    additional PDN connectivity over the 3GPP access network for multiple\n    PDN connections, the Request Type indicates \"handover\" when the UE is\n    performing a handover from non-3GPP access and the UE has already\n    established connectivity with the PDN over the non-3GPP access.\n\n     The UE shall indicate Request Type \"Emergency\" when it requests a PDN\n    connection for emergency services.\n\n     If the message is being sent via a HeNB which has a collocated L-GW,\n    it includes the L-GW address in the Uplink NAS transport message to the\n    MME.\n\n     If a UE indicated Control Plane CIoT EPS Optimisation supported in\n    Preferred Network Behavior and supports header compression, it shall\n    include the Header Compression Configuration, unless \"Non-IP\" or\n    \"Ethernet\" PDN type is indicated. The Header Compression Configuration\n    includes the information necessary for the ROHC channel setup.\n    Optionally, the Header Compression Configuration may also include\n    additional header compression context setup parameters, if the UE\n    already has the application traffic information, e.g. the target server\n    IP address.\n\n     The UE shall include in the PCO the 3GPP PS Data Off UE Status, which\n    indicates whether the user has activated or deactivated 3GPP PS Data\n    Off.\n\n  2. If the MME receives a PDN Connectivity Request from an emergency\n    attached or RLOS attached UE or the PDN Connectivity Request is for\n    normal services and the mobility or access restrictions do not allow\n    the UE to access normal services the MME shall reject this request.\n\n     If the Request Type indicates \"Emergency\" and the MME is not\n    configured to support PDN connections for emergency services the MME\n    shall reject the PDN Connectivity Request with an appropriate reject\n    cause.\n\n     If the Request Type is not set to \"Emergency\", and the UE has\n    indicated support for Attach without PDN Connectivity, and the network\n    supports Attach without PDN Connectivity, and the PDN Connection\n    Restriction is set in the subscriber data, then the MME should reject\n    the PDN Connectivity Request with an appropriate cause value.\n\n     If the Request Type indicates \"Emergency\", the MME derives a PDN GW\n    from the MME Emergency Configuration Data or the MME selects a PDN GW\n    as described in clause\u00c2\u00a04.3.12.4 on PDN GW Selection Function (3GPP\n    accesses) according to the Emergency APN in the MME Emergency\n    Configuration Data. This selection shall provide a PDN GW from visited\n    PLMN only.\n\n     If the Request Type indicates \"Emergency\" and the MME is configured to\n    support PDN connections for emergency services, it uses the MME\n    Emergency Configuration Data for the bearer establishment in this step\n    and ignores any subscription data limitation.\n\n     If the Request Type indicates \"Handover\", the MME uses the PDN GW\n    stored in the Subscription Data retrieved by the MME during the Update\n    Location performed at attach. If the Request Type indicates \"initial\n    request\" the MME selects a PDN GW as described in clause\u00c2\u00a04.3.8.1 on PDN\n    GW Selection Function (3GPP accesses).\n\n     If the UE provided APN is authorized for LIPA according to the user\n    subscription, the MME shall use the CSG Subscription Data to authorize\n    the connection.\n\n     If the subscription context does not indicate that the APN is for a\n    PDN connection to an SCEF the MME allocates a Bearer Id, and sends a\n    Create Session Request (IMSI, MSISDN, MME TEID for control plane, RAT\n    type, LTE-M RAT type reporting to PGW flag, PDN GW address, PDN\n    Address, Default EPS Bearer QoS, PDN Type, subscribed APN-AMBR, APN,\n    EPS Bearer Id, Protocol Configuration Options, Handover Indication, ME\n    Identity, User Location Information (ECGI), UE Time Zone, User CSG\n    Information, MS Info Change Reporting support indication, Selection\n    Mode, Charging Characteristics, Trace Reference, Trace Type, Trigger\n    Id, OMC Identity, Maximum APN Restriction, Dual Address Bearer Flag)\n    message to the Serving GW. If Control Plane CIoT EPS Optimisation\n    applies, then the MME shall also indicate S11-U tunnelling of NAS user\n    data and send its own S11-U IP address and MME DL TEID for DL data\n    forwarding by the SGW.\n\n     If the MME determines the PDN connection shall only use the Control\n    Plane CIoT EPS Optimisation, the MME shall include a Control Plane Only\n    PDN Connection Indicator in Create Session Request.\n\n     For PDN type \"non-IP\", if the APN subscription data indicate a SCEF\n    connection needs to be used, then the MME allocates an EPS Bearer\n    Identity for the Default Bearer associated with the UE and established\n    connection to the SCEF address indicated in subscription data according\n    to TS\u00c2\u00a023.682\u00c2\u00a0[74] and the steps 2,3,4,5,6 are not executed. The rest of\n    the interactions with the UE apply as specified below.\n\n     The RAT type is provided in this message for the later PCC decision.\n    The RAT type shall enable NB-IoT, LTE-M and WB-E-UTRAN to be\n    differentiated by the PDN-GW The MSISDN is included if the MME has it\n    stored for that UE. Handover Indication is included if the Request Type\n    indicates \"handover\". Selection Mode indicates whether a subscribed APN\n    was selected, or a non-subscribed APN sent by the UE was selected. The\n    P-GW may use Selection Mode when deciding whether to accept or reject\n    the default bearer activation. For example, if an APN requires\n    subscription, the P-GW is configured to accept only the default bearer\n    activation that requests a subscribed APN as indicated by Selection\n    Mode. Charging Characteristics indicates which kind of charging the\n    bearer context is liable for.\n\n     The charging characteristics for the PS subscription and individually\n    subscribed APNs as well as the way of handling Charging Characteristics\n    and whether to send them or not to the P-GW is defined in\n    TS\u00c2\u00a032.251\u00c2\u00a0[44]. The MME shall include Trace Reference, Trace Type,\n    Trigger Id, and OMC Identity if S-GW and/or P-GW trace is activated.\n    The MME shall copy Trace Reference, Trace Type, and OMC Identity from\n    the trace information received from the HLR or OMC.\n\n     The Maximum APN Restriction denotes the most stringent restriction as\n    required by any already active bearer context. If there are no already\n    active bearer contexts, this value is set to the least restrictive type\n    (see clause\u00c2\u00a015.4 of TS\u00c2\u00a023.060\u00c2\u00a0[7]). If the P-GW receives the Maximum\n    APN Restriction, then the P-GW shall check if the Maximum APN\n    Restriction value does not conflict with the APN Restriction value\n    associated with this bearer context request. If there is no conflict\n    the request shall be allowed, otherwise the request shall be rejected\n    with sending an appropriate error cause to the UE.\n\n     If the PDN subscription context contains a subscribed IPv4 address\n    and/or IPv6 prefix, the MME indicates it in the PDN address. The MME\n    may change the requested PDN type according to the subscription data\n    for this APN as described in clause\u00c2\u00a05.3.1.1. The MME shall set the Dual\n    Address Bearer Flag when the PDN type is set to IPv4v6 and all SGSNs\n    which the UE may be handed over to are Release\u00c2\u00a08 or above supporting\n    dual addressing, which is determined based on node pre-configuration by\n    the operator.\n\n     If there is an APN Rate Control Status in the MME MM Context for the\n    UE, the MME forwards it to the SGW.\n\n  3. The Serving GW creates a new entry in its EPS Bearer table and sends a\n    Create Session Request (IMSI, MSISDN, Serving GW Address for the user\n    plane, Serving GW TEID of the user plane, Serving GW TEID of the\n    control plane, RAT type, Default EPS Bearer QoS, PDN Type, PDN Address,\n    subscribed APN-AMBR, APN, Bearer Id, Protocol Configuration Options,\n    Handover Indication, ME Identity, User Location Information (ECGI), UE\n    Time Zone, User CSG Information, MS Info Change Reporting support\n    indication, PDN Charging Pause Support indication, Selection Mode,\n    Charging Characteristics, Trace Reference, Trace Type, Trigger Id, OMC\n    Identity, Maximum APN Restriction, Dual Address Bearer Flag, APN Rate\n    Control Status) message to the PDN GW indicated in the PDN GW address\n    received in the previous step. After this step, the Serving GW buffers\n    any downlink packets it may receive from the PDN GW until receives the\n    message in step 13 below. The MSISDN is included if received from the\n    MME. If the Handover Indication is included, the Serving GW includes it\n    in the Create Session Request message.\n\n     If the Serving GW has received the Control Plane Only PDN Connection\n    Indicator in step\u00c2\u00a02, the Serving GW informs the PDN GW this information\n    in Create Session Request. The Serving GW and PDN GW shall indicate the\n    use of CP only on their CDRs.\n\n     P-GWs shall not perform any checks of Maximum APN Restriction if\n    Create Default Bearer Request includes emergency APN.\n\n     If the PDN GW detects that the 3GPP PS Data Off UE Status has changed,\n    the PDN GW shall indicate this event to the charging system for offline\n    and online charging.\n\n  4. If dynamic PCC is deployed and the Handover Indication is not present,\n    the PDN GW may employ an IP-CAN Session Establishment procedure as\n    defined in TS\u00c2\u00a023.203\u00c2\u00a0[6] with the PCRF to get the default PCC rules for\n    the UE. This may lead to the establishment of a number of dedicated\n    bearers following the procedures defined in clause 5.4.1 in association\n    with the establishment of the default bearer which is described in\n    Annex\u00c2\u00a0F.\n\n     The RAT type is provided to the PCRF by the PDN GW if received by the\n    previous message. If the PDN GW/PCEF is configured to activate\n    predefined PCC rules for the default bearer, the interaction with the\n    PCRF is not required (e.g. operator may configure to do this) at the\n    moment.\n\n     The ETFTU is provided to the PCRF by the PDN\u00c2\u00a0GW, if received in the\n    PCO from the UE and the PDN\u00c2\u00a0GW supports the extended TFT filter format.\n    If the PCRF decides that the PDN connection may use extended TFT\n    filters, it shall return the ETFTN indicator to the PDN\u00c2\u00a0GW for\n    inclusion in the protocol Configuration Options returned to the UE.\n\n     The PCRF may modify the APN-AMBR and the QoS parameters (QCI and ARP)\n    associated with the default bearer in the response to the PDN GW as\n    defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n     If the PCC is configured to support emergency services and dynamic PCC\n    is deployed, the PCRF, based on the Emergency APN, sets the ARP of the\n    PCC rules to a value that is reserved for emergency services and the\n    authorization of dynamic PCC rules as described in TS\u00c2\u00a023.203\u00c2\u00a0[6]. If\n    dynamic PCC is not deployed, the PDN GW is configured to set the ARP to\n    a value that is reserved for emergency services.\n\n     If dynamic PCC is deployed and the Handover Indication is present, the\n    PDN GW executes a PCEF-Initiated IP-CAN Session Modification procedure\n    with the PCRF as specified in TS\u00c2\u00a023.203\u00c2\u00a0[6] to report the new IP-CAN\n    type. Depending on the active PCC rules, the establishment of dedicated\n    bearer for the UE may be required. The establishment of those bearers\n    shall take place in combination with the default bearer activation as\n    described in Annex F. This procedure can continue without waiting for a\n    PCRF response. If changes to the active PCC rules are required, the\n    PCRF may provide them after the handover procedure is finished.\n\n     In both cases (Handover Indication is present or not), if dynamic PCC\n    is not deployed, the PDN GW may apply local QoS policy. This may lead\n    to the establishment of a number of dedicated bearers for the UE\n    following the procedures defined in clause\u00c2\u00a05.4.1 in combination with\n    the establishment of the default bearer, which is described in Annex\u00c2\u00a0F.\n\n     If the CSG information reporting triggers are received from the PCRF,\n    the PDN GW should set the CSG Information Reporting Action IE\n    accordingly.\n\n     If 3GPP PS Data Off status is received in the PCO from the UE and PDN\n    GW supports 3GPP PS Data Off, the PDN GW shall provide the 3GPP PS Data\n    Off status to the PCRF. If the PCRF supports 3GPP PS Data Off, it shall\n    return 3GPP PS Data Off support to the PDN GW for inclusion in the PCO\n    returned to the UE.\n\n     If the 3GPP PS Data Off UE Status indicates that 3GPP PS Data Off is\n    activated for the UE, the PDN GW shall enforce the PCC rules for\n    downlink traffic to be used when 3GPP PS Data Off is activated.\n\n     If received, the PDN GW may take the APN Rate Control Status into\n    account when encoding the APN Rate Control parameters in Protocol\n    Configuration Options and when enforcing the APN Rate Control as\n    described in clause\u00c2\u00a04.7.7.3.\n\n  5. The P-GW creates a new entry in its EPS bearer context table and\n    generates a Charging Id for the Default Bearer. The new entry allows\n    the P-GW to route user plane PDUs between the S-GW and the packet data\n    network, and to start charging. The way the P-GW handles Charging\n    Characteristics that it may have received is defined in TS\u00c2\u00a032.251\u00c2\u00a0[44].\n\n     The PDN GW returns a Create Session Response (PDN GW Address for the\n    user plane, PDN GW TEID of the user plane, PDN GW TEID of the control\n    plane, PDN Type, PDN Address, EPS Bearer Id, EPS Bearer QoS, Protocol\n    Configuration Options, Charging Id, Prohibit Payload Compression, APN\n    Restriction, Cause, MS Info Change Reporting Action (Start) (if the PDN\n    GW decides to receive UE's location information during the session),\n    CSG Information Reporting Action (Start) (if the PDN GW decides to\n    receive UE's User CSG information during the session), Presence\n    Reporting Area Action (if the PDN GW decides to receive notifications\n    about a change of UE presence in Presence Reporting Area), PDN Charging\n    Pause Enabled indication (if PDN GW has chosen to enable the function),\n    APN-AMBR, Delay Tolerant Connection) message to the Serving GW. The PDN\n    GW takes into account the received PDN type, the Dual Address Bearer\n    Flag and the policies of operator when the PDN GW selects the PDN type\n    to be used as follows. If the received PDN type is IPv4v6 and both IPv4\n    and IPv6 addressing are possible in the PDN but the Dual Address Bearer\n    Flag is not set, or only single IP version addressing for this APN is\n    possible in the PDN, the PDN GW selects a single IP version (either\n    IPv4 or IPv6). If the received PDN type is IPv4 or IPv6, the PDN GW\n    uses the PDN type if it is supported in the PDN, otherwise an\n    appropriate error cause will be returned. The PDN GW allocates a PDN\n    Address according to the selected PDN Type If the PDN GW has selected a\n    PDN type different from the received PDN Type, the PDN GW indicates\n    together with the PDN type IE a reason cause to the UE why the PDN type\n    has been modified, as described in clause\u00c2\u00a05.3.1.1. PDN Address may\n    contain an IPv4 address for IPv4 and/or an IPv6 prefix and an Interface\n    Identifier. If the PDN has been configured by the operator so that the\n    PDN addresses for the requested APN shall be allocated by usage of\n    DHCPv4 only, or if the PDN GW allows the UE to use DHCPv4 for address\n    allocation according to the Address Allocation Preference received from\n    the UE, the PDN Address shall be set to 0.0.0.0, indicating that the\n    IPv4 address shall be negotiated by the UE with after completion of the\n    Default Bearer Activation procedure. For external PDN addressing for\n    IPv6, the PDN GW obtains the IPv6 prefix from the external PDN using\n    either RADIUS or Diameter client function. In the PDN Address field of\n    the Create Session Response, the PDN GW includes the Interface\n    Identifier and IPv6 prefix. The PDN GW sends Router Advertisement to\n    the UE after default bearer establishment with the IPv6 prefix\n    information for all cases. If the PDN address is contained in the\n    Create Session Request, the PDN GW shall allocate the IPv4 address\n    and/or IP6 prefix contained in the PDN address to the UE. If Handover\n    Indication indicates \"Handover\", the PDN Address Information shall\n    contain the same IP address the UE obtained during PDN connectivity\n    establishment over the non-3GPP access. The PDN GW derives the BCM\n    based on the NRSU and operator policy. The PDN\u00c2\u00a0GW derives whether the\n    extended TFT filter format is to be used based on the ETFTU, ETFTN\n    received from the PCRF and operator policy. Protocol Configuration\n    Options contains the BCM, ETFTN as well as optional PDN parameters that\n    the P-GW may transfer to the UE. These optional PDN parameters may be\n    requested by the UE, or may be sent unsolicited by the P-GW. Protocol\n    Configuration Options are sent transparently through the MME.\n\n     If the PDN type is Non-IP or Ethernet, the PDN-GW uses the APN and\n    IMSI to determine what local actions to perform before answering the\n    Serving GW.\n\n     The PDN GW includes a Delay Tolerant Connection indication if the PDN\n    GW supports receiving a rejection cause from the SGW indicating that\n    the UE is temporarily not reachable due to power saving, and holding\n    mobile terminated procedures until the PDN GW receives a message\n    indicating that the UE is available for end to end signalling.\n\n     When the Handover Indication is present, the PDN GW does not yet send\n    downlink packets to the S-GW; the downlink path is to be switched at\n    step\u00c2\u00a013a.\n\n     If the PDN GW is an L-GW, it does not forward downlink packets to the\n    S-GW. The packets will only be forwarded to the HeNB at step\u00c2\u00a010 via the\n    direct user plane path for Local IP Access.\n\n     If the 3GPP PS Data Off UE Status was present in the Create Session\n    Request PCO, and if the network supports 3GPP PS Data Off, the PDN GW\n    shall include the 3GPP PS Data Off Support Indication in the Create\n    Session Response PCO.\n\n  6. The Serving GW returns a Create Session Response (PDN Type, PDN\n    Address, Serving GW address for User Plane, Serving GW TEID for User\n    Plane, Serving GW TEID for control plane, EPS Bearer Id, EPS Bearer\n    QoS, PDN GW address and TEID (GTP-based S5/S8) or GRE key (PMIP-based\n    S5/S8) at the PDN GW for uplink traffic, Protocol Configuration\n    Options, Prohibit Payload Compression, APN Restriction, Cause, MS Info\n    Change Reporting Action (Start), CSG Information Reporting Action\n    (Start), Presence Reporting Area Action, APN-AMBR, DTC) message to the\n    MME. The DL TFT for PMIP-based S5/S8 is obtained from interaction\n    between the Serving GW and the PCRF as described in clause 5.6.1 of\n    TS\u00c2\u00a023.402\u00c2\u00a0[2], when PCC is deployed; otherwise, the DL TFT IE is\n    wildcarded, matching any downlink traffic. If the UE indicates the\n    Request Type as \"Handover\", this message also serves as an indication\n    to the MME that the S5/S8 bearer setup and update has been successful.\n    At this step the GTP tunnel(s) over S5/S8 are established\n\n     If Control Plane CIoT EPS Optimisation applies, and if MME doesn't\n    include Control Plane Only PDN Connection Indicator in the Create\n    Session Request:\n\n    -  If separation of S11-U from S1-U is required, the Serving GW shall\n       include the Serving GW IP address and TEID for S11-U and additionally\n       the Serving GW IP address and TEID for S1-U in the Create Session\n       Response.\n\n    -  Otherwise if separation of S11-U from S1-U is not required, the\n       Serving GW includes the Serving GW IP address and TEID for S11-U in\n       Create Session Response.\n\n  7. If an APN Restriction is received, then the MME shall store this value\n    for the Bearer Context and the MME shall check this received value with\n    the stored value for the Maximum APN Restriction to ensure there are no\n    conflicts between values. If the consequence of this check results in\n    the PDN connectivity being rejected, the MME shall initiate a Bearer\n    Deactivation and return an appropriate error cause. If the PDN\n    Connectivity Request is accepted, the MME shall determine a (new) value\n    for the Maximum APN Restriction. If there is no previously stored value\n    for Maximum APN Restriction, then the Maximum APN Restriction shall be\n    set to the value of the received APN Restriction.\n\n     The P-GW shall ignore Maximum APN restriction if the request includes\n    the Emergency APN.\n\n     For emergency service MME shall not deactivate bearer(s), if present,\n    to maintain valid APN restriction combination.\n\n     If the MS Info Change Reporting Action (Start) and/or the CSG\n    Information Reporting Action (Start) are received for this bearer\n    context, then the MME shall store this for the bearer context and the\n    MME shall report to that P-GW via the S-GW whenever a UE's Location\n    Information and/or User CSG Information change occurs that meets the P-\n    GW request, as described in clause\u00c2\u00a015.1.1a of TS\u00c2\u00a023.060\u00c2\u00a0[7]. If\n    Presence Reporting Area Action is received for this bearer context, the\n    MME shall store this information for the bearer context and shall\n    report to that P-GW via the S-GW whenever a change of UE presence in a\n    Presence Reporting Area is detected, as described in clause\u00c2\u00a05.9.2.2.\n\n     The MME may need to modify the UE AMBR, which has been assigned to the\n    eNodeB, based on the subscribed UE-AMBR and the updated set of APN-\n    AMBRs in use. The principles to determine the UE-AMBR are described in\n    clause\u00c2\u00a04.7.3.\n\n     The MME sends PDN Connectivity Accept Session Management Request (APN,\n    PDN Type, PDN Address, EPS Bearer Id, Protocol Configuration Options,\n    Header Compression Configuration, Control Plane Only Indicator) message\n    to the UE. If the PDN connection uses the user plane over the radio,\n    this message is contained in an S1_MME control message Bearer Setup\n    Request (EPS Bearer QoS, UE-AMBR, PDN Connectivity Accept, S1-TEID) to\n    the eNodeB. However, if Control Plane CIoT EPS Optimisation applies to\n    the PDN connection, an S1-AP Downlink NAS transport message is used.\n    The S1-AP Initial Context Setup Request message includes the TEID at\n    the Serving GW used for user plane and the address of the Serving GW\n    for user plane. If the PDN type is set to \"Non-IP\" the MME includes it\n    in the S1-AP Initial Context Setup Request so that the eNodeB disables\n    header compression. If the PDN type is set to \"Ethernet\" the MME\n    includes it in the S1-AP Initial Context Setup Request so that any\n    eNodeB header compression functionality can act appropriately. In\n    addition, if the PDN connection is established for Local IP Access, the\n    corresponding S1 Initial Context Setup Request message includes a\n    Correlation ID for enabling the direct user plane path between the HeNB\n    and the L-GW. If the PDN connection is established for SIPTO at the\n    Local Network with L-GW function collocated with the (H)eNB, the\n    corresponding S1-AP Initial Context Setup Request includes a SIPTO\n    Correlation ID for enabling the direct user plane path between the\n    (H)eNB and the L-GW. LIPA and SIPTO do not apply to Control Plane CIoT\n    EPS Optimisation.\n\n  NOTE\u00c2\u00a05:  In this release of the 3GPP specification the Correlation ID and\n         SIPTO Correlation ID is set equal to the user plane PDN GW TEID\n         (GTP-based S5) or GRE key (PMIP-based S5) that the MME has received\n         in step\u00c2\u00a06.\n\n     In the PDN Connectivity Accept message, the MME does not include the\n    IPv6 prefix within the PDN Address. The MME includes the APN-AMBR and\n    the EPS Bearer QoS parameter QCI into the Session Management Request.\n    Furthermore, if the UE has UTRAN or GERAN capabilities and the network\n    supports mobility to UTRAN or GERAN, the MME uses the EPS bearer QoS\n    parameters to derive the corresponding PDP context parameters QoS\n    Negotiated (R99 QoS profile), Radio Priority, Packet Flow Id and TI and\n    includes them in the Session Management Request. If the UE indicated in\n    the UE Network Capability that it does not support BSS packet flow\n    procedures, then the MME shall not include the Packet Flow Id. MME will\n    not send the S1 Bearer Setup Request message until any outstanding S1\n    Bearer Setup Response message for the same UE has been received or\n    timed out. If the APN-AMBR has changed the MME may update the UE-AMBR\n    if appropriate. The MME may include an indication whether the traffic\n    of this PDN Connection is allowed to be offloaded to WLAN, as described\n    in clause\u00c2\u00a04.3.23. If the UE has indicated PDN type \"Non-IP\" or\n    \"Ethernet\", the MME and PDN GW shall not change PDN type.\n\n     If the MME or PDN GW has changed the PDN Type, an appropriate reason\n    cause shall be returned to the UE as described in clause\u00c2\u00a05.3.1.1.\n\n     If Control Plane CIoT EPS Optimisation applies for an IP PDN\n    connection, and the UE has sent in the PDN Connectivity Request the\n    Header Compression Configuration, the MME shall include the Header\n    Compression Configuration in the PDN Connectivity Accept message. The\n    MME also binds the uplink and downlink ROHC channels to support header\n    compression feedback signalling. If the UE has included ROHC context\n    setup parameters in Header Compression Configuration in the PDN\n    Connectivity Request, the MME may acknowledge ROHC context setup\n    parameters. If the ROHC context is not established during the PDN\n    connection establishment procedure, before using the compressed format\n    for sending the data, the UE and the MME need to establish the ROHC\n    context with ROHC IR packet based on Header Compression Configuration.\n\n     If the MME based on local policy determines the PDN connection shall\n    only use the Control Plane CIoT EPS Optimisation, the MME shall include\n    a Control Plane Only Indicator in the Session Management Request. For\n    PDN connections with an SCEF, the MME shall always include the Control\n    Plane Only Indicator. If there is an existing SGi PDN connection for\n    this UE for which the MME included a Control Plane Only Indicator, the\n    MME shall include it also for the additional SGi PDN connection. If the\n    MME did not include a Control Plane Only Indicator for any of the\n    existing SGi PDN connections of this UE, the MME shall not include it\n    for the additional SGi PDN connection. A UE receiving the Control Plane\n    Only Indicator, for a PDN connection shall only use the Control Plane\n    CIoT EPS Optimisation for this PDN connection.\n\n  NOTE\u00c2\u00a06:  The MME decision whether to include a Control Plane Only\n         Indicator to an SGi PDN connection for a UE that previously had no\n         SGi connections will impact other potential subsequent SGi PDN\n         connections for that UE.\n\n  8. If the eNodeB received an S1-AP Initial Context Setup Request, the\n    eNodeB sends RRC Connection Reconfiguration to the UE including the PDN\n    Connectivity Accept message.\n\n     If the eNodeB received an S1-AP Downlink NAS Transport message\n    containing the NAS PDN Connectivity Accept message, the eNode B sends a\n    RRC Direct Transfer message to the UE and the steps 9 and 10 are not\n    executed.\n\n     The UE shall store the QoS Negotiated, Radio Priority, Packet Flow Id\n    and TI, which it received in the Session Management Request IE, for use\n    when accessing via GERAN or UTRAN. The UE may provide EPS Bearer QoS\n    parameters to the application handling the traffic flow. The\n    application usage of the EPS Bearer QoS is implementation dependent.\n    The UE shall not reject the RRC Connection Reconfiguration on the basis\n    of the EPS Bearer QoS parameters contained in the Session Management\n    Request.\n\n     If the UE receives an IPv4 address set to 0.0.0.0, it may negotiate\n    the IPv4 address with DHCPv4 as specified in TS\u00c2\u00a029.061\u00c2\u00a0[38], If the UE\n    receives an IPv6 interface identifier, it may wait for the Router\n    Advertisement from the network with the IPv6 prefix information or it\n    may send a Router Solicitation if necessary.\n\n  NOTE\u00c2\u00a07:  The IP address allocation details are described in clause 5.3.1\n         on \"IP Address Allocation\".\n\n  9. The UE sends the RRC Connection Reconfiguration Complete to the\n    eNodeB.\n\n  10.  The eNodeB send an S1-AP Bearer Setup Response to the MME. The S1-AP\n    message includes the TEID of the eNodeB and the address of the eNodeB\n    used for downlink traffic on the S1_U reference point.\n\n     If the Correlation ID or SIPTO Correlation ID is included in the\n    Bearer Setup Request, the eNodeB shall use the included information to\n    establish a direct user plane path to the L-GW and forward uplink data\n    for Local IP Access or SIPTO at the Local Network with L-GW function\n    collocated with the (H)eNB accordingly.\n\n  11.  The UE NAS layer builds a PDN Connectivity Complete message\n    including EPS Bearer Identity. The UE then sends a Direct Transfer (PDN\n    Connectivity Complete) message to the eNodeB.\n\n  12.  The eNodeB sends an Uplink NAS Transport (PDN Connectivity Complete)\n    message to the MME.\n\n     After the PDN Connectivity Accept message and once the UE (if\n    applicable to the PDN type) has obtained a PDN Address Information, the\n    UE can then send uplink packets towards the eNodeB which may then be\n    tunnelled by the MME to the Serving GW and PDN GW, or transferred by\n    the MME to an SCEF (see TS\u00c2\u00a023.682\u00c2\u00a0[74]), as per subscription\n    information related to APN discussed above in step\u00c2\u00a02. If the UE\n    requested for a dual address PDN type (IPv4v6) to a given APN and was\n    granted a single address PDN type (IPv4 or IPv6) by the network with a\n    reason cause indicating that only single IP version per PDN connection\n    is allowed, the UE should request for the activation of a parallel PDN\n    connection to the same APN with a single address PDN type (IPv4 or\n    IPv6) other than the one already activated. If the UE receives no\n    reason cause in step 8 in response to a IPv4v6 PDN type and it receives\n    an IPv6 Interface Identifier apart from the IPv4 address or 0.0.0.0 in\n    the PDN Address field, it considers that the request for a dual address\n    PDN was successful. It can wait for the Router Advertisement from the\n    network with the IPv6 prefix information or it may send Router\n    Solicitation if necessary.\n\n  13.  Upon reception of the Bearer Setup Response message in step 10 and\n    the PDN Connectivity Complete message in step\u00c2\u00a012, the MME sends a\n    Modify Bearer Request (EPS Bearer Identity, eNodeB address, eNodeB\n    TEID, Handover Indication, Presence Reporting Area Information) message\n    to the Serving GW. If the Control Plane CIoT EPS Optimisation applies\n    and the PDN connection is not served via a SCEF type of connectivity,\n    steps 13 and 14 are executed only if the MME needs to report a change\n    of UE presence in Presence Reporting Area, otherwise, if the PDN\n    connection is served by SCEF, steps 13,14, 15, and 16 are not executed.\n    If Request Type indicates \"handover\", the Handover Indication is also\n    included. If the MME has been requested to report a change of UE\n    presence in Presence Reporting Area, the MME includes in this message\n    the Presence Reporting Area Information comprising the PRA\n    identifier(s) and indication(s) on whether the UE is inside or outside\n    the area(s). When receiving the request for reporting change of UE\n    presence in Presence Reporting Area, and the MME decides not to\n    activate reporting UE presence in one or more of the received Presence\n    Reporting Area(s), the MME reports also the inactive Presence Reporting\n    Area(s) in this message.\n\n  13a. If the Handover Indication is included in step\u00c2\u00a013, the Serving GW\n    sends a Modify Bearer Request (Handover Indication) message to the PDN\n    GW to prompt the PDN GW to tunnel packets from non 3GPP IP access to\n    3GPP access system and immediately start routing packets to the Serving\n    GW for the default and any dedicated EPS bearers established. If\n    Presence Reporting Area Information is included in step\u00c2\u00a013, the Serving\n    GW sends a Modify Bearer Request (Presence Reporting Area Information)\n    message to the PDN GW.\n\n  NOTE\u00c2\u00a08:  The PDN GW forwards the Presence Reporting Area Information to\n         the PCRF, to the OCS or to both as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  13b. The PDN GW acknowledges by sending Modify Bearer Response to the\n    Serving GW.\n\n  14.  The Serving GW acknowledges by sending Modify Bearer Response (EPS\n    Bearer Identity) to the MME. The Serving GW can then send its buffered\n    downlink packets.\n\n  15.  After the MME receives Modify Bearer Response in step 14, if Request\n    type does not indicate handover and an EPS bearer was established and\n    if the subscription data indicates that the user is allowed to perform\n    handover to non-3GPP accesses and if this is the first PDN connection\n    associated with this APN and if the MME selected a PDN GW that is\n    different from the PDN GW identity which was previously indicated by\n    the HSS in the PDN subscription context, the MME shall send a Notify\n    Request including the PDN GW address and the APN to the HSS for\n    mobility with non-3GPP accesses. The message shall include information\n    that identifies the PLMN in which the PDN\u00c2\u00a0GW is located.\n\n     For an unauthenticated or roaming UE, if the Request Type of the UE\n    requested connectivity procedure indicates \"Emergency\", the MME shall\n    not send any Notify Request to the HSS. For a non-roaming authenticated\n    UE, based on operator configuration (e.g. on whether Voice over WLAN is\n    supported or not by the operator), if the Request Type indicates\n    \"Emergency\", the MME may send a Notify Request to the HSS including the\n    \"PDN GW currently in use for emergency services\", which comprises the\n    PDN GW address and an indication that the PDN connection is for\n    emergency services. The HSS shall store it as part of the UE context\n    for emergency services.\n\n  16.  In the case of non-emergency services, the HSS stores the PDN GW\n    identity and the associated APN. In the case of emergency services, the\n    HSS stores the \"PDN GW currently in use for emergency services\". Then\n    the HSS sends a Notify Response to the MME.\n\n  NOTE\u00c2\u00a09:  For handover from non-3GPP access, the PDN GW initiates resource\n         allocation deactivation procedure in the trusted/untrusted non-3GPP\n         IP access as specified in TS\u00c2\u00a023.402\u00c2\u00a0[2].\n\n\n"}, {"key": "UE or MME requested PDN disconnection", "numbering": "5.10.3", "title_level": 2, "desc": "5.10.3 UE or MME requested PDN disconnection\n\nThe UE or MME requested PDN disconnection procedure for an E-UTRAN is\ndepicted in figure 5.10.3-1. The procedure allows the UE to request for\ndisconnection from one PDN. Bearers including the default bearer of this\nPDN shall be deleted during this procedure. The procedure also allows the\nMME to initiate the release of a PDN connection.\n\nThis procedure is also used as part of the SIPTO function when the MME\ndetermines that GW relocation is desirable. In this situation the MME\ndeactivates the PDN connection(s) relevant to SIPTO-allowed APN(s) using\nthe \"reactivation requested\" cause value, and the UE should then re-\nestablish those PDN connection(s).\n\n  NOTE\u00c2\u00a01:  The deactivation with reactivation requested does not work with\n         pre-Rel-9 LTE UEs.\n\nIt shall be possible to configure the MME to deactivate a PDN connection,\nfor PDN GW relocation due to SIPTO above RAN, only when UE is in ECM-IDLE\nmode or during a Tracking Area Update procedure without established RAB(s).\n\nThis procedure is not used to terminate the last PDN connection unless\n\"Attach without PDN Connectivity is supported\" in the Preferred Network\nbehaviour indicated by the UE at attach time is supported by the network\nand the UE at any time it requires the last PDN connection to be\ndisconnected. The UE uses the UE-initiated Detach procedure in\nclause\u00c2\u00a05.3.8.2 to disconnect the last PDN connection. The MME uses the MME-\ninitiated Detach procedure in clause\u00c2\u00a05.3.8.3 to release the last PDN\nconnection.\n\n                                    [pic]\n\n           Figure 5.10.3-1: UE or MME requested PDN disconnection\n\n  NOTE\u00c2\u00a02:  For a PMIP-based S5/S8, procedure steps (A) are defined in\n         TS\u00c2\u00a023.402\u00c2\u00a0[2]. Steps\u00c2\u00a03, 4 and 5 concern GTP based S5/S8.\n\n  NOTE\u00c2\u00a03:  If after step\u00c2\u00a06, the MME determines that PDN being disconnected\n         has no active bearers in the E-UTRAN, (e.g. because data is\n         transported using Control Plane CIoT EPS Optimisation) steps 7, 8.\n         10a and 10b are modified to only transfer the indicated ESM\n         signalling messages and steps 9a and 9b are skipped.\n\n  1. The procedure is triggered by either step\u00c2\u00a01a or step\u00c2\u00a01b.\n\n    1a.  The UE initiates the UE requested PDN disconnection procedure by\n       the transmission of a PDN Disconnection Request (LBI) message. The\n       LBI indicates the default bearer associated with the PDN connection\n       being disconnected. If the UE was in ECM-IDLE mode, this NAS message\n       is preceded by the Service Request procedure if any of the exiting\n       PDN connections were using the User Plane without CIoT EPS\n       Optimisation, or, if the user plane was used just with User Plane\n       CIoT EPS Optimisations, a Resume Procedure is executed instead.\n\n    1b.  The MME decides to release the PDN connection. This may be e.g.\n       due to change of subscription, lack of resources, due to SIPTO in\n       case the PDN connection serves a SIPTO-allowed APN or on receiving a\n       PDN GW Restart Notification from the Serving GW as specified in\n       TS\u00c2\u00a023.007\u00c2\u00a0[72]. If the UE is in ECM-IDLE state and the reason for\n       releasing PDN connection is \"reactivation requested\" e.g. due to\n       SIPTO, the MME initiates paging via Network Triggered Service Request\n       procedure in clause\u00c2\u00a05.3.4.3 from step\u00c2\u00a03a onwards in order to inform\n       UE of the request.\n\n  2. If the PLMN has configured secondary RAT usage reporting, the MME\n    shall perform step\u00c2\u00a07 through 10 before step\u00c2\u00a02 onwards. If the PDN\n    connection was served by a P-GW, the EPS Bearers in the Serving GW for\n    the particular PDN connection are deactivated by the MME by sending\n    Delete Session Request (Cause, LBI, User Location Information (ECGI),\n    Secondary RAT usage data) to the Serving GW. This message indicates\n    that all bearers belonging to that PDN connection shall be released. If\n    the UE Time Zone has changed, the MME includes the UE Time Zone IE in\n    this message. For PDN connection to the SCEF the MME indicates to the\n    SCEF the connection for the UE is no longer available according to\n    TS\u00c2\u00a023.682\u00c2\u00a0[74] and steps 2,3,4,5,6 are not executed. If the MME\n    received Secondary RAT usage data in step\u00c2\u00a09b, the MME shall include it\n    in this Delete Session Request message.\n\n  3. The Serving GW sends Delete Session Request (Cause, LBI, User Location\n    Information (ECGI), Secondary RAT usage data) to the PDN GW. The S-GW\n    also includes User Location Information IE and/or UE Time Zone IE if it\n    is present in step\u00c2\u00a02. The Serving GW also includes the Secondary RAT\n    usage data in this message if it was present in step\u00c2\u00a02 and if PDN GW\n    secondary RAT usage data reporting is active.\n\n  4. The PDN GW acknowledges with Delete Session Response (optionally, APN\n    Rate Control Status).\n\n  5. The PDN GW employs the PCEF-initiated IP-CAN Session Termination\n    procedure as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6] to indicate to the PCRF that the\n    IP-CAN session is released if PCRF is applied in the network. If\n    requested the PDN\u00c2\u00a0GW indicates User Location Information and/or UE Time\n    Zone Information to the PCRF as defined in TS\u00c2\u00a023.203\u00c2\u00a0[6].\n\n  6. The Serving GW acknowledges with Delete Session Response (optionally,\n    APN Rate Control Status).\n\n     If received, the MME stores the APN Rate Control Status in the MM\n    context.\n\n  7. If the UE is in ECM IDLE state and the PDN disconnection is decided by\n    the MME, the MME shall delete the corresponding contexts of the PDN\n    connection locally, steps\u00c2\u00a07 to 10b are skipped except if the MME has\n    decided to restore certain PDN connections as specified in\n    TS\u00c2\u00a023.007\u00c2\u00a0[72] or for other reasons e.g. SIPTO. The MME initiates the\n    deactivation of all Radio Bearers associated with the PDN connection to\n    the eNodeB by sending the Deactivate Bearer Request message to the\n    eNodeB. The MME shall re-calculate the UE-AMBR (see clause\u00c2\u00a04.7.3). This\n    S1-AP message carries the list of EPS bearers to be released, the new\n    UE-AMBR, and a NAS Deactivate EPS Bearer Context Request (LBI) message.\n    The MME builds a NAS message Deactivate EPS Bearer Context Request\n    including the EPS Bearer Identity, and includes it in the S1-AP\n    Deactivate Bearer Request message.\n\n     If the network wants to trigger GW relocation (e.g. for SIPTO), the\n    NAS message Deactivate EPS Bearer Context Request includes the request\n    for reactivation of the same PDN connection via the same APN by the UE.\n\n     If the MME released the PDN connection due to failed bearer set up\n    during handover, the UE and the MME deactivate the failed contexts\n    locally without peer-to peer ESM signalling.\n\n  NOTE\u00c2\u00a04:  If the UE is in ECM-IDLE state and the PDN disconnection is\n         decided by the MME, the EPS bearer state is synchronized between\n         the UE and the network at the next ECM-IDLE to ECM-CONNECTED\n         transition (e.g. Service Request or TAU procedure).\n\n  8. The eNodeB sends the RRC Connection Reconfiguration message including\n    the corresponding bearers to be released and the NAS Deactivate EPS\n    Bearer Context Request (LBI) message to the UE.\n\n  9a.  The UE releases all resources corresponding to the PDN connection\n    and acknowledges this by sending the RRC Connection Reconfiguration\n    Complete message to the eNodeB.\n\n  9b.  The eNodeB sends an acknowledgement of the deactivation to the MME.\n    If the PLMN has configured secondary RAT usage reporting and the eNodeB\n    has Secondary RAT usage data to report, the Secondary RAT usage data is\n    included.\n\n  10a. The UE NAS layer builds a Deactivate EPS Bearer Context Accept\n    message. The UE then sends a Direct Transfer (Deactivate EPS Bearer\n    Context Accept) message to the eNodeB.\n\n     If the Deactivate EPS Bearer Context Request message from the MME\n    indicated reactivation requested, the UE starts the UE initiated PDN\n    connection request procedure as specified in clause\u00c2\u00a05.10.2 by using the\n    same APN of the released PDN connection.\n\n  10b. The eNodeB sends an Uplink NAS Transport (Deactivate EPS Bearer\n    Context Accept) message to the MME.\n\nThe MME determines the Maximum APN Restriction for the remaining PDN\nconnections and stores this new value for the Maximum APN Restriction.\n\n\n"}, {"key": "MME triggered Serving GW relocation", "numbering": "5.10.4", "title_level": 2, "desc": "5.10.4 MME triggered Serving GW relocation\n\nThe MME triggered Serving GW relocation procedure for E-UTRAN is depicted\nin figure 5.10.4-1. The procedure allows the MME to trigger Serving GW\nrelocation due to events other than those described in the mobility\nscenarios (see clause\u00c2\u00a05.3.3.1 and clause\u00c2\u00a05.5.1). Such scenario exists\nduring the establishment of a SIPTO at local network PDN connection with\nstand-alone GW or during the establishment of a SIPTO above RAN PDN\nconnection.\n\n                                    [pic]\n\n            Figure 5.10.4-1: MME triggered Serving GW relocation\n\n  1. The Serving GW relocation procedure may be triggered by the MME due to\n    events that may benefit from a Serving GW relocation other than those\n    described in the mobility events scenarios.\n\n  2. If the MME determines that the Serving GW is to be relocated then it\n    selects a new Serving GW according to clause\u00c2\u00a04.3.8.2. The MME sends a\n    Create Session Request (bearer context(s) with PDN GW addresses and\n    TEIDs (for GTP-based S5/S8) or GRE keys (for PMIP-based S5/S8) at the\n    PDN GW(s) for uplink traffic, eNodeB address(es) and TEIDs for downlink\n    user plane for the existing EPS bearers, the Protocol Type over S5/S8,\n    Serving Network) message per PDN connection to the new Serving GW. The\n    new Serving GW allocates the S-GW addresses and TEIDs for the uplink\n    traffic on S1_U reference point (one TEID per bearer). The Protocol\n    Type over S5/S8 is provided to Serving GW which protocol should be used\n    over S5/S8 interface. If the PDN GW requested UE's location info, the\n    MME also includes the User Location Information IE in this message. If\n    the PDN GW requested UE's User CSG information (determined from the UE\n    context), the MME includes the User CSG Information IE in this message\n    if the User CSG Information has changed.\n\n  3. The new Serving GW assigns addresses and TEIDs (one per bearer) for\n    downlink traffic from the PDN GW. The Serving GW allocates DL TEIDs on\n    S5/S8. It sends a Modify Bearer Request (Serving GW addresses for user\n    plane and TEID(s), Serving Network) message per PDN connection to the\n    PDN GW(s). The S-GW also includes User Location Information IE and/or\n    UE Time Zone IE and/or User CSG Information IE if it is present in\n    step\u00c2\u00a02. The PDN GW updates its context field and returns a Modify\n    Bearer Response (Charging Id, MSISDN, etc.) message to the Serving GW.\n    The MSISDN is included if the PDN GW has it stored in its UE context.\n    The PDN GW starts sending downlink packets to the new GW using the\n    newly received address and TEIDs. These downlink packets will use the\n    new downlink path via the new Serving GW to the eNodeB. This step\u00c2\u00a0is\n    performed for all connected PDN-GWs for that specific UE.\n\n  4. The new Serving GW sends a Create Session Response (Serving GW\n    addresses and uplink TEID(s) for user plane) message back to the MME.\n    The MME starts a timer, to be used in step\u00c2\u00a06.\n\n  5. The MME sends a Bearer Modify Request (Serving GW addresses and uplink\n    TEID(s) for user plane, Secondary RAT usage data request) message to\n    eNodeB. The eNodeB starts using the new Serving GW address(es) and\n    TEID(s) for forwarding subsequent uplink packets and sends a Bearer\n    Modify Response message to the MME. If the PLMN has configured\n    secondary RAT usage reporting, the MME may request the eNodeB for\n    Secondary RAT usage data in the Bearer Modify request message. If the\n    eNodeB has Secondary RAT usage data, it provides it in the Bearer\n    Modify Response message.\n\n  5a.  If Secondary RAT usage data is included in the previous message and\n    if PDN GW Secondary RAT usage reporting is active, the MME uses the\n    Secondary RAT usage data reporting procedure as described in\n    clause\u00c2\u00a05.7A.3 figure 5.7A.3-2 to provide this information to the\n    Serving GW and PDN GW. The MME includes a flag that the Serving GW\n    shall not process this information and forward it to the PDN GW.\n\n  6. When the timer has expired after step\u00c2\u00a04, the MME releases the\n    bearer(s) in the old Serving GW by sending a Delete Session Request\n    message (Cause, Operation Indication, Secondary RAT usage data). The\n    operation Indication flag is not set, that indicates to the old Serving\n    GW that the old Serving GW shall not initiate a delete procedure\n    towards the PDN GW. The old Serving GW acknowledges with Delete Session\n    Response messages. The MME includes the Secondary RAT usage data if the\n    eNodeB had provided it to the MME in step\u00c2\u00a05.\n\nIf the Serving GW relocation procedure towards a new Serving GW fails,\nbased on operator policy, the MME should go back to the old Serving GW and\ndisconnects the affected PDN connections (e.g. SIPTO at local network) that\nare no longer allowed to remain connected.\n\n\n"}, {"key": "UE Capability Handling", "numbering": "5.11", "title_level": 1, "desc": "5.11 UE Capability Handling\n\n\n"}, {"key": "General", "numbering": "5.11.1", "title_level": 2, "desc": "5.11.1 General\n\nThe UE Capability information is made up of the UE Radio Capability\ninformation and the UE Core Network Capability information.\n\nThe UE Radio Capability for Paging Information is separate from both the UE\nRadio Capability information and the UE Core Network Capability\ninformation. The UE Radio Capability for Paging Information may be used to\nenhance the paging in the E-UTRAN.\n\n\n"}, {"key": "UE Radio Capability Handling", "numbering": "5.11.2", "title_level": 2, "desc": "5.11.2 UE Radio Capability Handling\n\nThe UE Radio Capability information contains information on RATs that the\nUE supports (e.g. power class, frequency bands, etc). Consequently, this\ninformation can be sufficiently large (e.g. >50 octets for a UE supporting\na small number of frequency bands; or multiple kilo bytes for a UE\nsupporting many frequency bands and a large multiplicity of combinations of\nthese frequency bands) that it is undesirable to send it across the radio\ninterface at every transition from ECM-IDLE to ECM-CONNECTED. To avoid this\nradio overhead, the MME stores the UE Capability information during ECM-\nIDLE state and the MME shall, if it is available, send its most up-to-date\nUE Radio Capability information to the E-UTRAN in the S1 interface INITIAL\nCONTEXT SETUP REQUEST message unless the UE is performing an Attach\nprocedure or a Tracking Area Update procedure for the \"first TAU following\nGERAN/UTRAN Attach\" or for a \"UE radio capability update\".\n\n  NOTE\u00c2\u00a01:  The UTRAN Radio Capabilities are excluded from the information\n         stored in the MME owing to issues with the handling of dynamic UMTS\n         security parameters.\n\nIf a UE supports both NB-IoT and WB-E-UTRAN, the UE handles the UE Radio\ncapability information as follows:\n\n  -  When the UE is camping on NB-IoT the UE provides only NB-IoT UE radio\n    capabilities to the network.\n\n  -  When the UE is camping on WB-E-UTRAN, the UE provides UE radio\n    capabilities including WB-E-UTRAN UE radio capabilities but not NB-IoT\n    UE radio capabilities to the network.\n\nIn order to handle the distinct UE radio capabilities, the MME stores a\nseparate NB-IoT specific UE Radio Capability information when the UE\nprovides the UE Radio Capability information while camping on NB-IoT.\n\nWhen the UE is camping on NB-IoT, the MME sends, if available, the NB-IoT\nspecific UE Radio Capability information to the E-UTRAN.\n\nWhen the UE is camping on WB-E-UTRAN, the MME sends, if available, UE radio\ncapabilities including WB-E-UTRAN UE radio capabilities but not NB-IoT\nradio capabilities.\n\nFor a UE that supports NR as a Secondary RAT, the UE's NR radio\ncapabilities are contained within the UE Radio Capability IE.\n\nIf the UE is performing an Attach procedure or a Tracking Area Update\nprocedure for the \"first TAU following GERAN/UTRAN Attach\" or for \"UE radio\ncapability update\", the MME shall delete (or mark as deleted) any UE Radio\nCapability information that it has stored, and, if the MME sends an S1\ninterface INITIAL CONTEXT SETUP REQUEST or UE RADIO CAPABILITY MATCH\nREQUEST message during that procedure, the MME shall not send any UE Radio\nCapability information to the E-UTRAN in that message. This triggers the E-\nUTRAN to request the UE Radio Capability from the UE and to upload it to\nthe MME in the S1 interface UE CAPABILITY INFO INDICATION message. The size\nof the UE Radio Capability information may be greater than can be carried\nin single RRC message but less than the maximum size of messages on the S1\ninterface. In this case, to obtain the information that it needs the RAN\nshould send multiple requests to the UE for different sub-sets of UE Radio\nCapability information (e.g. one request per RAT). Then the RAN shall\ncombine these subsets (excluding UTRAN and NB-IoT capabilities) into a\nsingle UE Radio Capability IE and upload it to the MME in the S1 interface\nUE CAPABILITY INFO INDICATION message.\n\nThe MME stores the UE Radio Capability information, and include it in\nfurther INITIAL CONTEXT SETUP REQUEST or UE RADIO CAPABILITY MATCH REQUEST\nmessages in other cases than Attach procedure, Tracking Area Update\nprocedure for the \"first TAU following GERAN/UTRAN Attach\" and \"UE radio\ncapability update\" procedure.\n\nIf the UE is performing a Service Request (or other) procedure and the MME\ndoes not have UE Radio Capability information available (or it is\navailable, but marked as \"deleted\"), then the MME sends an S1 interface\nINITIAL CONTEXT SETUP REQUEST message to the E-UTRAN without any UE Radio\nCapability information in it. This triggers the E-UTRAN to request the UE\nRadio Capability from the UE and upload it to the MME in the S1 interface\nUE CAPABILITY INFO INDICATION message.\n\n  NOTE\u00c2\u00a02:  This use of the INITIAL CONTEXT SETUP REQUEST message means that\n         for a signalling only procedure such as a periodic Tracking Area\n         Update, the UE Radio Capability would not be sent to the E-UTRAN.\n\n  NOTE\u00c2\u00a03:  If a \"first TAU following GERAN/UTRAN Attach\" Tracking Area\n         Update is performed during ECM-CONNECTED mode, e.g. after an inter\n         RAT handover, no INITIAL CONTEXT SETUP REQUEST is sent and the UE\n         Radio Capability information in the MME will remain deleted until\n         the next ECM-IDLE to ECM-CONNECTED transition (or later, e.g. if\n         the next activity from the UE is another Tracking Area Update).\n\nWhen the CIoT EPS Optimisations do not apply, if the MME has not stored the\nUE Radio Capability information, in order to obtain UE radio capability for\npaging information, the MME can trigger the retrieval of the UE Radio\nCapability information by indicating UE Radio Capability request in\nDOWNLINK NAS TRANSPORT message during Attach or TAU procedure.\n\nFor the CIoT EPS Optimisations, during the Attach procedure or the Tracking\nArea Update procedure, e.g. for the \"first TAU following GERAN/UTRAN\nAttach\", if the MME does not send an S1 interface INITIAL CONTEXT SETUP\nREQUEST to the E-UTRAN, the MME should obtain the UE Radio Capability\ninformation by sending either the DOWNLINK NAS TRANSPORT message indicating\nUE Radio Capability request or the CONNECTION ESTABLISHMENT INDICATION\nmessage without UE Radio Capability information included to the E-UTRAN.\nThis triggers the E-UTRAN to request the UE Radio Capability from the UE\nand upload it to the MME in the S1 interface UE CAPABILITY INFO INDICATION\nmessage, as specified in TS\u00c2\u00a036.300\u00c2\u00a0[5]. In subsequent ECM connections, if\nthe MME does not send an S1 interface INITIAL CONTEXT SETUP REQUEST to the\nE-UTRAN, the MME sends the UE Radio Capability to the E-UTRAN in the\nCONNECTION ESTABLISHMENT INDICATION message or DOWNLINK NAS TRANSPORT\nmessage.\n\nThe UE Radio Capability is not provided directly from one CN node to\nanother. It will be uploaded to the MME when the E-UTRAN requests the UE\nRadio Capability information from the UE.\n\nDuring handover via the MME (both intra RAT and inter RAT), the radio\ncapability information for the source and target 3GPP RATs (with the\npossible exception of UTRAN and E-UTRAN) are transferred in the \"source to\ntarget transparent container\". Information on additional 3GPP RATs is\noptionally transferred in the \"source to target transparent container\".\n\nAt handover, transfer of the radio capability information related to the\nsource and/or additional RATs is beneficial as it avoids the need for the\ntarget RAT to retrieve the information from the UE prior to a subsequent\ninter-RAT handover. However, there may be situations where the size of the\nUE Radio Capability may be too large for the information on all of the UE's\nRATs to be carried in a single message on one or more of the network\ninterfaces involved in the handover. Hence, the source RAN shall ensure\nthat the size of the UE Radio Capability information does not cause the\nsize of the \"source to target transparent container\" to exceed the limits\nthat can be handled by interfaces involved in the handover (e.g. Iu\ninterface (TS\u00c2\u00a025.413\u00c2\u00a0[22]) and, following SRVCC, E interface\n(TS\u00c2\u00a029.002\u00c2\u00a0[86])). This may result in some radio capability information\nbeing omitted from the \"source to target transparent container\" at inter-\nRAT handover. In this situation, the UE might be subject to an inter-RAT\nhandover to E-UTRAN via the MME which has the context stored for that UE,\nand, the MME may detect that the \"source to target transparent container\"\nis smaller than the UE Radio Capability stored in that UE's context. The\nMME may then add the full UE Radio Capability as a standalone Information\nElement in the S1-AP Handover Request message. As an implementation option,\nthe eNB may use this MME supplied information to avoid retrieving any\nmissing UE Radio Capability Information from the UE.\n\nIn the case that a source RAN node omits some radio capability information\nfrom the \"source to target transparent container\" at handover, the source\nRAN node shall ensure that any future target RAN node can detect that that\nradio capability information has been omitted.\n\nOwing to issues with dynamic UTRAN security parameters, special rules apply\nto the handling of the UTRAN radio capability information at inter-RAT\nhandover (see e.g. the HandoverPreparationInformation message description\nin TS\u00c2\u00a036.331\u00c2\u00a0[37] and the usage of the PS Handover Complete Ack message in\nTS\u00c2\u00a043.129\u00c2\u00a0[8] and TS\u00c2\u00a048.018\u00c2\u00a0[42])\n\nTo allow for the addition of future radio technologies, frequency bands,\nand other enhancements, the MME shall store the UE Radio Capability\nInformation as defined in TS\u00c2\u00a023.008\u00c2\u00a0[28].\n\nThe E-UTRAN stores the UE Radio Capability information, received in the S1\ninterface INITIAL CONTEXT SETUP REQUEST message or obtained from the UE,\nfor the duration of the RRC connection for that UE. Before any handover\nattempt from E-UTRAN to UTRAN, the E-UTRAN retrieves the UE's UTRAN Radio\nCapabilities from the UE.\n\nIf the UE's non-UTRAN UE Radio Capability information changes while in ECM-\nIDLE state (including cases of being in GERAN/UTRAN coverage), the UE shall\nperform a Tracking Area Update indicating \"UE radio capability update\" when\nit next returns to E-UTRAN coverage. When the UE is in ECM-IDLE with AS\ninformation stored (as defined in clause\u00c2\u00a04.11 for User Plane CIOT EPS\noptimisation), NAS shall trigger AS to establish a new RRC connection and\nnot resume the existing one in order to send Tracking Area Update\nindicating \"UE radio capability update\". As a result of this, the access\nstratum in the UE will discard the AS information and establish a new RRC\nconnection as defined in TS\u00c2\u00a036.331\u00c2\u00a0[37].\n\nThe MME may also request for Voice Support Match Information. If requested,\nthe eNB then derives and provides an indication to the MME whether the UE\nradio capabilities are compatible with the network configuration (e.g.\nwhether the UE supports the frequency bands that the network may rely upon\nfor providing \"full\" PS voice coverage or whether the UE supports the SRVCC\nconfiguration of the network e.g. E-UTRAN to GERAN) as defined in\nclause\u00c2\u00a05.3.14.\n\nThe Signalling of the UE Radio Access Capabilities can be optimised by\nmeans of the RACS feature defined in clause\u00c2\u00a05.11.3a.\n\n\n"}, {"key": "UE Core Network Capability", "numbering": "5.11.3", "title_level": 2, "desc": "5.11.3 UE Core Network Capability\n\nThe UE Core Network Capability is split into the UE Network Capability IE\n(mostly for E-UTRAN access related core network parameters) and the MS\nNetwork Capability IE (mostly for UTRAN/GERAN access related core network\nparameters) and contains non radio-related capabilities, e.g. the NAS\nsecurity algorithms etc. Both the UE Network Capability and the MS Network\nCapability are transferred between CN nodes at MME to MME, MME to SGSN,\nSGSN to SGSN, and SGSN to MME changes.\n\nIn order to ensure that the UE Core Network Capability information stored\nin the MME is up to date (e.g. to handle the situation when the USIM is\nmoved into a different device while out of coverage, and the old device did\nnot send the Detach message; and the cases of inter-RAT Tracking Area\nUpdate), the UE shall send the UE Core Network Capability information to\nthe MME during the Attach and non-periodic Tracking Area Update procedure\nwithin the NAS message.\n\nThe MME shall store always the latest UE Core Network Capability received\nfrom the UE. Any UE Core Network Capability that an MME receives from an\nold MME/SGSN is replaced when the UE provides the UE Core Network\nCapability with Attach and the Tracking Area Update signalling. The MME\nshall remove the stored MS Network Capability, if MS Network Capability is\nnot included in Attach or non-periodic Tracking Area Update signaling e.g.\nUE is only capable of E-UTRAN.\n\nIf the UE's UE Core Network Capability information changes (in either ECM-\nCONNECTED or in ECM-IDLE state (including cases of being in GERAN/UTRAN\ncoverage and having ISR activated)), the UE shall perform a Tracking Area\nUpdate ('type' different to 'periodic') when it next returns to E-UTRAN\ncoverage - see clause\u00c2\u00a05.3.3.0.\n\nIf the UE supports multiple user plane radio bearers on the NB-IoT RAT (see\nTS\u00c2\u00a036.306\u00c2\u00a0[82], TS\u00c2\u00a036.331\u00c2\u00a0[37]), then the UE shall indicate this in the UE\nNetwork Capability IE.\n\nIf the UE supports, the RACS feature defined in clause\u00c2\u00a05.11.3a, and in this\nspecification for the impact on the EPS procedures, then the UE shall\nindicate this in the UE Network Capability IE.\n\nIf the UE supports dual connectivity with NR (see clause\u00c2\u00a04.3.2a), then the\nUE shall indicate its support in a NAS indicator.\n\nIf the UE supports Service Gap Control (see clause\u00c2\u00a04.3.17.9), then the UE\nshall indicate this in the UE Network Capability IE.\n\nTo allow for the addition of future features, the MME shall store the UE\nNetwork Capability and the MS Network Capability even if either or both is\nlarger than specified in TS\u00c2\u00a024.008\u00c2\u00a0[47]/TS\u00c2\u00a024.301\u00c2\u00a0[46], up to a maximum\nsize of 32\u00c2\u00a0octets for each IE.\n\n\n"}, {"key": "UE Radio Capability Signalling optimization", "numbering": "5.11.3a", "title_level": 2, "desc": "5.11.3a  UE Radio Capability Signalling optimization\n\nWith the increase of the size of UE radio capabilities driven e.g. by\nadditional frequency bands and combinations thereof for E-UTRA and NR, an\nefficient approach to signal UE Radio Access Capability information over\nthe radio interface and other network interfaces is defined with RACS.\n\nRACS works by assigning an identifier to represent a set of UE radio\ncapabilities. This identifier is called UE Radio Capability ID. A UE Radio\nCapability ID can be either Manufacturer-assigned or PLMN-assigned, as\nspecified in clause\u00c2\u00a05.2.7. The UE Radio Capability ID is an alternative to\nthe signalling of the radio capabilities container over the radio\ninterface, within E-UTRAN, from E-UTRAN to NG-RAN, from MME to E-UTRAN and\nbetween CN nodes supporting RACS.\n\nThe UCMF (UE radio Capability Management Function) stores all UE Radio\nCapability ID mappings in a PLMN and is responsible for assigning every\nPLMN-assigned UE Radio Capability ID in this PLMN, see clause\u00c2\u00a04.4.13.\n\nIn order to be able to interpret the UE Radio Capability ID a network\nentity or node may store a local copy of the mapping between the UE Radio\nCapability ID and its corresponding UE Radio Access Capabilities\ninformation i.e. a dictionary entry. When no mapping is available between a\nUE Radio Capability ID and the corresponding UE Radio Capability\ninformation in a network entity or node, this network entity or node shall\nbe able to retrieve it and store it.\n\n  -  An MME which supports RACS will retrieve the UE Radio Capability ID.\n\n  -  An MME which supports RACS shall store such UE Radio Capability ID\n    mapping at least for all the UEs that it serves that have a UE Radio\n    Capability ID assigned.\n\n  -  The E-UTRAN performs local caching of the UE Radio Access Capabilities\n    for the UE Radio Capability IDs for the UEs it is serving, and\n    potentially for other UE Radio Capability IDs according to suitable\n    local policies.\n\n  -  When the E-UTRAN needs to retrieve the mapping of a UE Radio\n    Capability ID to the corresponding UE Radio Capability information, it\n    queries the MME using S1 signalling defined in TS\u00c2\u00a036.413\u00c2\u00a0[36].\n\n  -  When the MME retrieves the UE Radio Capability Information it provides\n    it to UCMF in order to obtain a mapping of a UE Radio Capability ID to\n    the corresponding UE Radio Capability information.\n\nA network may utilise the PLMN-assigned UE Radio Capability ID, without\ninvolving the UE, e.g. for use with legacy UEs.\n\nMutual detection of the support of the RACS feature happens between E-UTRAN\nnodes at X2 setup and between E-UTRAN and MME at S1 setup time. To allow\nfor a mix of RACS-supporting and non-RACS-supporting RAN nodes over the X2\ninterfaces, the UE Radio Capability ID should be included in the Path\nSwitch signalling between MME and E-UTRAN. In addition, RACS-supporting RAN\nnodes can be discovered across inter-CN node boundaries e.g. using the\nConfiguration Transfer procedure. The support of RACS by peer MMEs or AMFs\nis based on configuration in a PLMN or across PLMNs.\n\nA UE indicates its support for RACS to MME using UE Core Network Capability\nas defined in clause\u00c2\u00a05.11.3.\n\nA UE that supports RACS and is already assigned with an applicable UE Radio\nCapability ID in the PLMN, shall signal the UE Radio Capability ID in\nAttach procedure, as defined in clause\u00c2\u00a05.3.2, and Tracking Area Update\nprocedure, as defined in clause\u00c2\u00a05.3.3. If both PLMN-assigned and UE\nmanufacturer-assigned UE Radio Capability IDs are available in the UE and\napplicable in the PLMN, the UE shall signal the PLMN-assigned UE Radio\nCapability ID. The UE shall delete the PLMN-assigned UE Radio Capability\nID(s) for the related PLMN upon receiving an indication from this PLMN.\n\nThe serving MME stores the UE Radio Capability ID for a UE in the UE\ncontext and provides this UE Radio Capability ID to E-UTRAN as part of the\nUE context information using S1 signalling.\n\nThe UE stores the PLMN-assigned UE Radio Capability ID in non-volatile\nmemory when in EMM-DEREGISTERED state and can use it again when it\nregisters in the same PLMN.\n\n  NOTE\u00c2\u00a01:  It is assumed that UE does not need to store the access stratum\n         information (i.e. UE-EUTRA-Capability and UE-NR-Capability\n         specified in TS\u00c2\u00a036.331\u00c2\u00a0[37] and TS\u00c2\u00a038.331\u00c2\u00a0[89], respectively) that\n         was indicated by the UE to the network when the PLMN-assigned UE\n         Radio Capability ID was assigned by the network. However, it is\n         assumed that the UE does store the related UE configuration (e.g.\n         whether or not GERAN or UTRAN or MBMS is enabled/disabled).\n\nAt any given time at most one UE Radio Capability ID is stored in the UE\ncontext in CN and RAN.\n\nThe number of PLMN-specific UE Radio Capability IDs that the UE stores in\nnon-volatile memory is left up to UE implementation. However, to minimise\nthe load (e.g. from radio signalling) on the Uu interface and to provide\nsmoother inter-PLMN mobility (e.g. at land borders) the UE shall be able to\nstore at least the latest 16 PLMN-assigned UE Radio Capability IDs (along\nwith the PLMN that assigned them). This number is independent of the UE-\nmanufacturer-assigned UE Radio Capability ID(s) the UE may store.\n\nIt shall be possible for a UE to change, e.g. upon change in its usage\nsettings, the set of UE Radio Capabilities in time and signal the\nassociated UE Radio Capability ID, if available. The UE stores the mapping\nbetween the UE Radio Capability ID and the corresponding UE Radio\nCapability information for every UE Radio Capability ID it stores.\n\nThe E-UTRAN may apply RRC filtering of UE radio capabilities when it\nretrieves the UE Radio Capabilities information from the UE as defined in\nTS\u00c2\u00a036.331\u00c2\u00a0[37].\n\n  NOTE\u00c2\u00a02:  In a RACS supporting PLMN, the filter of UE Radio Capabilities\n         configured in E-UTRAN is preferably as wide in scope as possible\n         (e.g PLMN-wide). In this case, it corresponds e.g. to the super-set\n         of bands, band-combinations and RATs the PLMN deploys and not only\n         to the specific E-UTRAN node or region.\n\n  NOTE\u00c2\u00a03:  If the filter of UE Radio Capabilities configured in two E-UTRAN\n         nodes is different, during handover between these two nodes, it is\n         possible that the target E-UTRAN node might need to enquire the UE\n         for its UE Radio Capability information again and trigger re-\n         allocation of a PLMN-assigned UE Radio Capability ID leading to\n         extra signalling. Additionally, a narrow filter might reduce the\n         list of candidate target nodes.\n\nSupport for RACS in 5GS is defined in TS\u00c2\u00a023.501\u00c2\u00a0[83] and TS\u00c2\u00a023.502\u00c2\u00a0[84].\n\n\n"}, {"key": "UE Radio Capability for Paging Information", "numbering": "5.11.4", "title_level": 2, "desc": "5.11.4 UE Radio Capability for Paging Information\n\nThe aim of this procedure is to assist the E-UTRAN in optimising the radio\npaging procedures.\n\nAs specified in TS\u00c2\u00a036.413\u00c2\u00a0[36] , the eNB uploads the UE Radio Capability\nfor Paging Information to the MME in the S1 interface UE CAPABILITY INFO\nINDICATION message (in a separate IE from the UE Radio Capability). As\nspecified in TS\u00c2\u00a036.331\u00c2\u00a0[37], the UE Radio Capability for Paging Information\nmay contain UE Radio Paging Information provided by the UE to the eNB, and\nother information derived by the eNB (e.g. band support information) from\nthe UE Radio Capability information.\n\nTypically this is at the same time as the eNB uploads the UE Radio\nCapability information. The MME stores the UE Radio Capability for Paging\nInformation in the MME context. When it needs to page, the MME provides the\nUE Radio Capability for Paging Information to the eNB as part of the S1\npaging message. The eNB may use the UE Radio Capability for Paging\nInformation to enhance the paging towards the UE.\n\nIf the UE Radio Capability for Paging Information changes, the UE shall\nfollow the same procedures as if the UE Radio Capability changes.\n\nIn order to handle the situations of connected mode inter-MME change, the\nUE Radio Capability for Paging Information is sent to the target MME as\npart of the MM Context information. The UE Radio Capability for Paging\nInformation is only applicable for MMEs, i.e. it is not applicable for\nSGSNs. Therefore, it will not be included by MME during context transfers\ntowards SGSNs.\n\n\n"}, {"key": "UE Radio Capability for Category M Differentiation", "numbering": "5.11.5", "title_level": 2, "desc": "5.11.5 UE Radio Capability for Category M Differentiation\n\nThis functionality is used by the Core Network to be able to identify\ntraffic to/from Category M UEs for charging differentiation.\n\nThe eNB determines whether a UE is of Category M from the UE's radio\ncapability if UE signals one or more of the specific Category M. The eNB\nthen indicates to the MME whether the UE is Category M in the \"UE Radio\nCapability for Category M Differentiation\" information in S1-AP message(s)\nused to upload the UE Radio Capabilities to the MME.\n\nTypically this is at the same time as the eNB uploads the UE Radio\nCapability information. The MME stores the \"LTE-M Indication\" in the MME\ncontext.\n\nIf the UE context in MME contains the \"LTE-M Indication\" the MME indicates\nto the S-GW that the RAT type of the UE is LTE-M in every Create Session\nRequest message and every Modify Bearer Request message, so this is handled\nfor charging and PCC purposes. If the MME requests the SGW to pass LTE-M\nRAT type to the PDN GW, based on operator policy (e.g. based on roaming\nagreements or based on the need to pass the LTE-M RAT type information to\nPGW also), the MME informs the Serving GW that it is requested to relay the\nLTE-M RAT type to the PGW also. Otherwise, the Serving GW indicates WB-E-\nUTRAN RAT type to the PDN GW.\n\nIn order to handle the situations of inter-MME change, the LTE-M Indication\nis sent from the source MME to the target MME as part of the MM Context\ninformation. The UE Radio Capability for Category M Differentiation is only\napplicable for MMEs, i.e. it is not applicable for SGSNs. Therefore, it\nwill not be included during context transfers from and towards SGSNs.\n\n\n"}, {"key": "Warning message delivery", "numbering": "5.12", "title_level": 1, "desc": "5.12 Warning message delivery\n\n\n"}, {"key": "General", "numbering": "5.12.1", "title_level": 2, "desc": "5.12.1 General\n\nWarning message delivery is similar to Cell Broadcast Service defined in\nTS\u00c2\u00a023.041\u00c2\u00a0[48], it permits a number of unacknowledged Warning messages to\nbe broadcast to UEs within a particular area.\n\nThe maximum size of the Warning message for E-UTRAN is different from that\nof UTRAN/GERAN.\n\nWhen S1-flex is used, the eNodeB may receive duplicated Warning messages.\n\nFor details on the Warning system message delivery, see TS\u00c2\u00a023.041\u00c2\u00a0[48].\n\n\n"}, {"key": "Void", "numbering": "5.12.2", "title_level": 2, "desc": "5.12.2 Void\n\n\n\n\n"}, {"key": "Void", "numbering": "5.12.3", "title_level": 2, "desc": "5.12.3 Void\n\n\n\n\n"}, {"key": "Discontinuous Reception and UE Specific DRX Parameter handling", "numbering": "5.13", "title_level": 1, "desc": "5.13 Discontinuous Reception and UE Specific DRX Parameter handling\n\nDuring the Attach procedure in E-UTRAN, UTRAN and/or GERAN, the UE can\nsignal its UE Specific DRX Parameters to the Core Network (MME in the E-\nUTRAN case and SGSN in UTRAN/GERAN case).\n\nIn E-UTRAN and UTRAN, the UE may signal that it wishes to use the DRX cycle\nlength broadcast in the RAN's System Information. Alternatively, the UE can\npropose a DRX cycle length for use when not camped on an NB-IoT cell. The\nMME shall accept the value proposed by the UE.\n\nIn each S1 interface Page Request message, the MME shall send the E-UTRAN\nrelevant information from the UE Specific DRX Parameters (to help determine\nthe DRX cycle length) and information derived from the IMSI (which defines\nwhen the UE will be awake from its sleep mode). Details are specified in\nTS\u00c2\u00a036.304\u00c2\u00a0[34]. The UE Specific DRX parameter is not used by the E-UTRAN\nfor paging from NB-IoT cells (see TS\u00c2\u00a036.304\u00c2\u00a0[34]).\n\n  NOTE\u00c2\u00a01:  To ease backward compatibility with Pre-Release\u00c2\u00a08 SGSNs, the\n         UTRAN and E-UTRAN DRX cycle lengths are encoded in the same field\n         within the TS\u00c2\u00a024.008\u00c2\u00a0[47] DRX parameter information element.\n\nAt MME to MME, MME to SGSN and SGSN to MME mobility, the UE Specific DRX\nParameters are sent from the old CN node to the new CN node as part of the\nMM context information and should not be sent by the UE in the Tracking\nArea Update message.\n\n  NOTE\u00c2\u00a02:  it is assumed that all SGSNs are Release\u00c2\u00a099 or newer and hence\n         support storage of the Release\u00c2\u00a0'99 encoding of the TS\u00c2\u00a024.008\u00c2\u00a0[47]\n         DRX parameter information element.\n\nDuring Attach and Tracking Area Update procedures performed on NB-IoT\ncells, the normal EPS procedures apply, e.g. the UE can (but need not)\nprovide a UE Specific DRX parameter that applies on WB-E-UTRAN cells.\n\nIf a CN node receives UE Specific DRX Parameters in a dedicated message\nfrom the UE (e.g. in a Tracking Area Update or Attach message), then the CN\nnode updates any stored information with the information supplied by the UE\nand uses the UE provided information in preference to any information that\nmight be received from another CN node during the same procedure.\n\nIf the UE wishes to alter its GERAN or UTRAN/E-UTRAN UE Specific DRX\nParameters while in E-UTRAN, then it shall send a Tracking Area Update\nRequest message to the MME containing its new UE Specific DRX Parameters.\nIf ISR had been activated for the UE, then the UE shall deactivate ISR by\nsetting its TIN to \"GUTI\" so that the UE performs a Routing Area Update\nwhen it next enters GERAN/UTRAN coverage. When the UE performs that Routing\nArea Update, the SGSN will receive the updated DRX parameters within the MM\ncontext information sent by the MME and hence the UE should not include\nthem again in the Routing Area Update Request message.\n\nIf the UE wishes to alter its E-UTRAN/UTRAN or GERAN DRX Parameters while\nin GERAN or UTRAN coverage, then the UE shall send a Routing Area Update\nRequest message to the SGSN containing its new UE DRX Parameters. If ISR\nhas been activated, the UE shall deactivate ISR by setting its TIN to \"P-\nTMSI\" so that the UE performs a Tracking Area Update when it next returns\nto E-UTRAN coverage. When the UE performs that Tracking Area Update, the\nMME will receive the updated DRX parameters within the MM context\ninformation sent by the SGSN and hence the UE should not include them again\nin the Tracking Area Update message.\n\n\n"}, {"key": "Extended Idle mode Discontinuous Reception (DRX)", "numbering": "5.13a", "title_level": 1, "desc": "5.13a  Extended Idle mode Discontinuous Reception (DRX)\n\nThe extended idle mode DRX value range is described in TS\u00c2\u00a023.682\u00c2\u00a0[74].\n\nA UE and the core network may negotiate the use of extended idle mode DRX\nas described in TS\u00c2\u00a023.682\u00c2\u00a0[74]. The MME includes the extended idle mode DRX\ncycle length in paging message to assist the eNodeB in paging the UE\n\nFor extended idle mode DRX cycle length of 5.12s, the network should follow\nregular paging strategy as defined in clause\u00c2\u00a05.13\n\nFor extended idle mode DRX cycle length of 10.24s or longer, the following\napplies:\n\n     If the UE decides to request for extended idle mode DRX, the UE\n    includes an extended idle mode DRX parameters information element in\n    the attach request and/or TAU request message. The UE may also include\n    the UE specific DRX parameters for regular idle mode DRX according to\n    clause\u00c2\u00a05.13. The extended idle mode DRX parameters information element\n    includes the idle mode DRX length.\n\n     The MME decides whether to accept or reject the UE request for\n    enabling extended idle mode DRX as described in TS\u00c2\u00a023.682\u00c2\u00a0[74]. In case\n    the MME accepts the extended idle mode DRX, the MME based on operator\n    policies and, if available, the extended idle mode DRX cycle length\n    value in the subscription data from the HSS, may also provide different\n    values of the extended idle mode DRX parameters than what was requested\n    by the UE. The MME taking into account the RAT specific Subscribed\n    Paging Time Window, the UEs current RAT -NB-IOT or WB-E-UTRAN) and\n    local policy also assigns a Paging Time Window length to be used, and\n    provides this value to the UE during Attach/TAU procedures together\n    with the extended idle mode DRX cycle length in extended idle mode DRX\n    parameter. If the MME accepts the use of extended idle mode DRX, the UE\n    shall apply extended idle mode DRX based on the received extended idle\n    mode DRX length, the UEs current RAT -NB-IOT or WB-E-UTRAN) and RAT\n    specific Paging Time Window length. If the UE does not receive the\n    extended idle mode DRX parameters information element in the relevant\n    accept message because the SGSN/MME rejected its request or because the\n    request was received by SGSN/MME not supporting extended idle mode DRX,\n    the UE shall apply its regular discontinuous reception as defined in\n    clause\u00c2\u00a05.13.\n\n  NOTE:  The extended idle mode DRX cycle length requested by UE takes into\n         account requirements of applications running on the UE.\n         Subscription based determination of eDRX cycle length can be used\n         in those rare scenarios when applications on UE cannot be modified\n         to request appropriate extended idle mode DRX cycle length. The\n         network accepting extended DRX while providing an extended idle\n         mode DRX cycle length value longer than the one requested by the\n         UE, can adversely impact reachability requirements of applications\n         running on the UE.\n\n     When the UE has bearers for emergency bearer services, the UE and MME\n    follow regular discontinuous reception as defined in clause\u00c2\u00a05.13 and\n    shall not use the extended idle mode DRX. Extended idle mode DRX\n    parameters may be negotiated while the UE has bearers for emergency\n    bearer services.When the bearers for emergency bearer services are\n    released, the UE and MME shall reuse the negotiated extended idle mode\n    DRX parameters in the last TAU/Attach procedure.\n\n     The UE shall include the extended idle mode DRX parameters information\n    element in each TAU message if it still wants to use extended idle mode\n    DRX. At MME to MME, MME to SGSN and SGSN to MME mobility, the extended\n    idle mode DRX parameters are not sent from the old CN node to the new\n    CN node as part of the MM context information.\n\n     If extended idle mode DRX is enabled, the MME handles paging as\n    defined in TS\u00c2\u00a023.682\u00c2\u00a0[74].\n\nIf the MME is requested to monitor Reachability for Data and the UE is\nabout to become reachable for paging, the MME sends a Monitoring Report\nmessage to the address that was indicated in the related Monitoring Request\nas described in TS\u00c2\u00a023.682\u00c2\u00a0[74].\n\n\n"}, {"key": "Configuration Transfer procedure", "numbering": "5.14", "title_level": 1, "desc": "5.14 Configuration Transfer procedure\n\nThe purpose of the Configuration Transfer is to enable the transfer of\ninformation between two eNodeBs at any time via S1 interface and the Core\nNetwork. An example of application is to exchange the eNodeBs IP addresses\nin order to be able to use X2 interface between the eNodeBs for Self-\nOptimised Networks (SON), as specified in TS\u00c2\u00a036.413\u00c2\u00a0[36].\n\n\n"}, {"key": "Architecture Principles for Configuration Transfer", "numbering": "5.14.1", "title_level": 2, "desc": "5.14.1 Architecture Principles for Configuration Transfer\n\nConfiguration Transfer between two eNodeBs follows the principles used by\nRAN Information Management (RIM) procedures (see clause\u00c2\u00a05.15) between\nUTRAN, E-UTRAN and GERAN i.e. providing a generic mechanism for the\nexchange of arbitrary information between applications belonging to the RAN\nnodes. However Configuration Transfer is only used for intra- E-UTRAN\ninformation exchange whereas RIM procedures are designed for inter-RAT\ninformation exchange involving GERAN/UTRAN. Such a separate procedure\nallows avoiding impacts to other RAT access systems when transferred\ninformation is added or modified.\n\nThe information is transferred via the MME core network node(s). In order\nto make the information transparent for the Core Network, the information\nis included in an E-UTRAN transparent container that includes source and\ntarget eNodeB addresses, which allows the Core Network nodes to route the\nmessages. If the information is to be transferred between a source eNodeB\nand a target en-gNB via a target eNodeB for Dual Connectivity with E-UTRAN\nas Master RAN node and NR as Secondary RAN node as defined in\nTS\u00c2\u00a037.340\u00c2\u00a0[85], the source eNodeB indicates the target en-gNB and may\nindicate the connected target eNodeB as described in TS\u00c2\u00a036.300\u00c2\u00a0[5], and the\ntarget eNode B further transfers the E-UTRAN transparent container to the\nen-gNB transparently. The mechanism is depicted in figure\u00c2\u00a05.14 1. An\nexample for such transferred information is the SON information, as\nspecified in TS\u00c2\u00a036.413\u00c2\u00a0[36].\n\n                                    [pic]\n\n      Figure 5.14-1: inter E-UTRAN Configuration Transfer basic network\n                                architecture\n\nThe E-UTRAN transparent containers are transferred from the source E-UTRAN\nnode to the destination E-UTRAN node by use of Configuration Transfer\nmessages.\n\nAn ENB Configuration Transfer message is used from the eNodeB to the MME\nover S1 interface, a MME Configuration Transfer message is used from the\nMME to the eNodeB over S1 interface, and a Configuration Transfer Tunnel\nmessage is used to tunnel the E-UTRAN transparent container from a source\nMME to a target MME over the S10 interface.\n\nEach Configuration Transfer message carrying the E-UTRAN transparent\ncontainer is routed and relayed independently by the core network node(s).\nAny relation between messages is transparent for the MME, i.e. a\nrequest/response exchange between applications, for example SON\napplications, is routed and relayed as two independent messages by the MME.\nAn MME supporting the Configuration Transfer procedures provides\naddressing, routing and relaying functions.\n\n\n"}, {"key": "Addressing, routing and relaying", "numbering": "5.14.2", "title_level": 2, "desc": "5.14.2 Addressing, routing and relaying\n\n\n"}, {"key": "Addressing", "numbering": "5.14.2.1", "title_level": 3, "desc": "5.14.2.1 Addressing\n\nAll the Configuration Transfer messages contain the addresses of the source\nand destination RAN nodes. An eNodeB is addressed by the Target eNodeB\nIdentifier. For Dual Connectivity with E-UTRAN as Master RAN node and NR as\nSecondary RAN node as defined in TS\u00c2\u00a037.340\u00c2\u00a0[85], the destination RAN node\nincludes the candidate en-gNB Identifier and may include a target eNodeB\nIdentifier for the target eNodeB which is X2 connected to the candidate en-\ngNB and a TAI associated with the en-gNB.\n\n\n"}, {"key": "Routing", "numbering": "5.14.2.2", "title_level": 3, "desc": "5.14.2.2 Routing\n\nThe following description applies to all the Configuration Transfer\nmessages used for the exchange of the E-UTRAN transparent container.\n\nThe source RAN node sends a message to its MME including the source and\ndestination addresses. The MME uses the destination address to route the\nmessage encapsulated in a GTPv2 message to the correct MME via the S10\ninterface (see TS\u00c2\u00a029.274\u00c2\u00a0[43]).\n\nThe MME connected to the target eNodeB decides which RAN node to send the\nmessage to, based on the destination address. For Dual Connectivity with E-\nUTRAN as Master RAN node and NR as Secondary RAN node as defined in\nTS\u00c2\u00a037.340\u00c2\u00a0[85], target eNodeB decides which candidate en-gNB to send the\nmessage to, based on the destination address.\n\n\n"}, {"key": "Relaying", "numbering": "5.14.2.3", "title_level": 3, "desc": "5.14.2.3 Relaying\n\nThe MME performs relaying between GTPv2 messages as described in\nTS\u00c2\u00a029.274\u00c2\u00a0[43]. The MME performs relaying between S1 and S10 messages as\ndescribed in TS\u00c2\u00a036.413\u00c2\u00a0[36], TS\u00c2\u00a023.501\u00c2\u00a0[83] and TS\u00c2\u00a029.274\u00c2\u00a0[43]. The Target\neNodeB performs relaying between S1 and X2 message as described in\nTS\u00c2\u00a036.413\u00c2\u00a0[36] and TS\u00c2\u00a036.423\u00c2\u00a0[76].\n\n\n"}, {"key": "Applications using the Configuration Transfer procedures", "numbering": "5.14.2.4", "title_level": 3, "desc": "5.14.2.4 Applications using the Configuration Transfer procedures\n\nThe RAN node applications, which use the Configuration Transfer procedures,\nare fully transparent for the MME. These applications are described in RAN\nspecifications. An example of application is the transfer of information\nrequired for Self-Optimised Networks (SON).\n\n\n"}, {"key": "RAN Information Management (RIM) procedures", "numbering": "5.15", "title_level": 1, "desc": "5.15 RAN Information Management (RIM) procedures\n\n\n"}, {"key": "General", "numbering": "5.15.1", "title_level": 2, "desc": "5.15.1 General\n\nThe RAN Information Management (RIM) procedures provide a generic mechanism\nfor the exchange of arbitrary information between applications belonging to\nthe RAN nodes. The RAN information is transferred via the MME and SGSN core\nnetwork node(s). In order to make the RAN information transparent for the\nCore Network, the RAN information is included in a RIM container that shall\nnot be interpreted by the Core Network nodes.\n\nThe RIM procedures are optional both in the RAN and the CN nodes. For the\nGb interface the use of RIM procedures is negotiated at start/restart of\nthe Gb link. For the Iu interface there is no negotiation of using RIM\nprocedures or not at Iu link start/restart.\n\nThe RAN information is transferred in RIM containers from the source RAN\nnode to the destination RAN node by use of messages. Source and destination\nRAN nodes can be E-UTRAN, UTRAN or GERAN. Each message carrying the RIM\ncontainer is routed and relayed independently by the core network node(s).\nAny relation between messages is transparent for the MME/SGSN, i.e. a\nrequest/response exchange between RIM applications, for example, is routed\nand relayed as two independent messages by the MME/SGSN.\n\nThe interfaces which will be used are the Gb, the Iu, the S1, Gn and the S3\ninterfaces. The RAN information in the RIM container shall be transparent\nfor the Core Network. An MME or SGSN supporting the RIM procedures provides\naddressing, routing and relaying functions.\n\n\n"}, {"key": "Addressing, routing and relaying", "numbering": "5.15.2", "title_level": 2, "desc": "5.15.2 Addressing, routing and relaying\n\n\n"}, {"key": "Addressing", "numbering": "5.15.2.1", "title_level": 3, "desc": "5.15.2.1 Addressing\n\nAll the messages used for the exchange of RAN information contain the\naddresses of the source and destination RAN nodes. A BSS is addressed by\nRouting Area Identity (RAI) + Cell Identity (CI) of one of its cells. An\neNodeB is addressed by the Target eNodeB Identifier. An RNC is addressed by\nGlobal RNC-Id as defined in TS\u00c2\u00a023.003\u00c2\u00a0[9].\n\n\n"}, {"key": "Routing", "numbering": "5.15.2.2", "title_level": 3, "desc": "5.15.2.2 Routing\n\nThe following description applies to all the messages used for the exchange\nof RAN information.\n\nThe source RAN node sends a message to its MME or SGSN including the source\nand destination addresses. The SGSN/MME uses the destination address to\nroute the message encapsulated in a GTP message to the correct MME/SGSN via\nthe S3 or Gn interface.\n\nThe MME/SGSN connected to the destination RAN node decides which RAN node\nto send the message to based on the destination address.\n\n\n"}, {"key": "Relaying", "numbering": "5.15.2.3", "title_level": 3, "desc": "5.15.2.3 Relaying\n\nThe SGSN performs relaying between BSSGP messages, RANAP messages and GTP\nmessages as described in TS\u00c2\u00a048.018\u00c2\u00a0[42], TS\u00c2\u00a025.413\u00c2\u00a0[22], TS\u00c2\u00a029.060\u00c2\u00a0[14] and\nTS\u00c2\u00a029.274\u00c2\u00a0[43]. The MME performs relaying between S1 and S3/Gn messages as\ndescribed in TS\u00c2\u00a036.413\u00c2\u00a0[36] and TS\u00c2\u00a029.274\u00c2\u00a0[43] / TS\u00c2\u00a029.060\u00c2\u00a0[14].\n\n\n"}, {"key": "Applications using the RIM Procedures", "numbering": "5.15.3", "title_level": 2, "desc": "5.15.3 Applications using the RIM Procedures\n\nThe RAN node applications, which use the RIM procedures, are fully\ntransparent for the MME and SGSN. These applications are described in RAN\nspecifications. An example between E-UTRAN and GERAN is the Network\nAssisted Cell Change described in TS\u00c2\u00a048.018\u00c2\u00a0[42], TS\u00c2\u00a025.413\u00c2\u00a0[22] and\nTS\u00c2\u00a036.413\u00c2\u00a0[36]. An example between E-UTRAN and UTRAN is the exchange of SON\nrelated information described in TS\u00c2\u00a036.413\u00c2\u00a0[36]\n\n\n"}, {"key": "MME-initiated procedure on UE's CSG membership change", "numbering": "5.16", "title_level": 1, "desc": "5.16 MME-initiated procedure on UE's CSG membership change\n\nIf the UE is in ECM-CONNECTED state and connected via a CSG cell and the\nMME detects that the UE's CSG membership to that cell has expired, the MME\nshall send an S1AP UE CONTEXT MODIFICATION REQUEST message to the eNodeB\nwhich includes an indication that the CSG membership of the UE has expired.\nThe eNodeB receiving this indication may initiate a handover to another\ncell. If the UE is not handed over the eNodeB should initiate the S1\nrelease procedure with an appropriate cause. The MME initiates S1 release\nafter a configurable time if the UE is not handed over or released by the\nCSG cell. If the CSG membership expires for a UE with ongoing emergency\nbearer service, no indication that the CSG membership of the UE has expired\nis sent to the eNodeB and the MME shall deactivate all non-emergency PDN\nconnections.\n\nIf the UE is in ECM-CONNECTED state and connected via a hybrid cell and the\nMME detects that the UE's CSG membership to that cell has changed or\nexpired, and the CSG Information Reporting Action indicates User CSG\nInformation shall be reported to the P-GW then the MME shall modify the\nlast known CSG membership and send a Change Notification message to the\nServing GW with User CSG Information to indicate the CSG membership change.\nThe Serving GW shall send the Change Notification message with the User CSG\nInformation to the PDN GW. The MME shall also send the S1AP UE CONTEXT\nMODIFICATION REQUEST message to the eNodeB which includes an indication of\nwhether the UE is a CSG member. Based on this information the eNodeB may\nperform differentiated treatment for CSG and non-CSG members. MME shall\nrelease the impacted LIPA PDN connection if the LIPA CSG authorization data\nfor this CSG cell is no longer valid due to UE's CSG membership changed or\nexpired.\n\n\n"}, {"key": "Home eNodeB Multicast Packet Forwarding Function", "numbering": "5.17", "title_level": 1, "desc": "5.17 Home eNodeB Multicast Packet Forwarding Function\n\nA Home eNodeB L-GW should receive and process multicast group membership\nreport messages (e.g. according to RFC 3376\u00c2\u00a0[62] / RFC 3810\u00c2\u00a0[63]) sent\neither by the network accessed by LIPA or by the UE. Based upon these\nmessages, the L-GW should forward multicast IP datagrams sent by the UE to\nthe network accessed by LIPA, or from the network accessed by LIPA to the\nUE, as appropriate.\n\nThe UE may implement RFC3376\u00c2\u00a0[62] or RFC 3810\u00c2\u00a0[63] to report multicast\ngroups that the UE seeks to receive.\n\nTo make UPnP/DLNA service advertisements sent with an IP TTL=1 available to\nUEs that employ LIPA, a proxying function in the L-GW may be implemented,\ne.g. to retransmit UPnP service advertisements to UEs after changing the\nsource address. This proxying to the UE shall not be performed if the\nmulticast packet is transmitted with an IPv4 or IPv6 link-local source\naddress, RFC\u00c2\u00a03927\u00c2\u00a0[64], RFC\u00c2\u00a04291\u00c2\u00a0[65].\n\n\n"}, {"key": "HPLMN Notification with specific indication due to MME initiated", "numbering": "5.18", "title_level": 1, "desc": "5.18 HPLMN Notification with specific indication due to MME initiated\n         Bearer removal\n\nWhen initiating a Delete Session Request procedure, the MME shall add an\nappropriate cause code facilitating the operator of the P-GW to take\nappropriate action (e.g. Alarm, O&M action by operator's management\nnetwork) if needed.\n\n  NOTE:  This is for the HPLMN operator to be able to differentiate Delete\n         Session Request procedures due to a failure case (e.g. due to a QoS\n         parameter mismatch at Initial Attach) from Delete Session Request\n         procedures that are executed in cases not related to any failure\n         conditions (e.g. due to a Tracking Area Update). Action taken by\n         the HPLMN operator is outside the scope of 3GPP specification.\n\n\n"}, {"key": "Procedures to support Dedicated Core Networks", "numbering": "5.19", "title_level": 1, "desc": "5.19 Procedures to support Dedicated Core Networks\n\n\n"}, {"key": "NAS Message Redirection Procedure", "numbering": "5.19.1", "title_level": 2, "desc": "5.19.1 NAS Message Redirection Procedure\n\nWhen DCNs are used, these steps are used to reroute a NAS message (and\nthereby a UE) from one CN node to another CN node during Attach, TAU or RAU\nprocedure. These steps are also used by the MME/SGSN or HSS initiated\nDedicated Core Network Reselection procedure in clause\u00c2\u00a05.19.3.\n\n                                    [pic]\n\n             Figure 5.19.1-1: NAS Message Redirection Procedure\n\nThe procedure is started when a first new MME/SGSN decides to move the\nhandling of an Attach Request, TAU Request or RAU Request to another CN\nnode.\n\n  1. The first new MME/SGSN sends a Reroute NAS Message Request (original\n    RAN message, reroute parameters, Additional GUTI/P-TMSI, UE Usage Type,\n    and optionally the IMSI) to the RAN Node. The reroute parameter is a\n    MMEGI (for E-UTRAN) or Null-NRI/SGSN Group ID (for UTRAN/GERAN)\n    corresponding to the DCN that corresponds to the UE Usage Type. A UE\n    provided Additional GUTI/P-TMSI (if available) from the NAS Request\n    message is included. The MME/SGSN may determine the MMEGI or Null-\n    NRI/SGSN Group ID corresponding to the DCN using DNS procedures. The\n    original RAN message is the complete PDU received from the RAN which\n    contains the original NAS Request message and all RAN IEs. The UE Usage\n    Type shall be included, if available. For the condition to include the\n    IMSI, see step\u00c2\u00a06 in clause\u00c2\u00a05.19.2.\n\n  2. The RAN node's NNSF selects a new MME/SGSN based on the MMEGI or Null-\n    NRI/SGSN Group ID and possibly also based on an Additional GUTI/P-TMSI.\n    If Additional GUTI/P-TMSI identifies an MME/SGSN within the set of\n    valid nodes identified by MMEGI or Null-NRI/SGSN Group ID, it should be\n    the selected node. Otherwise a valid CN node corresponding to the MMEGI\n    or Null-NRI/SGSN Group ID will be selected. If no valid MME/SGSN is\n    available within the set of valid nodes identified by MMEGI or Null-\n    NRI/SGSN Group ID, the RAN node selects an MME/SGSN from the default\n    DCN or selects the MME/SGSN that sent the Reroute Request, based on\n    operator configuration. The MME/SGSN is selected from the network\n    corresponding to the selected CN operator.\n\n  3. Dependent on RAT, the eNodeB/RNC sends the Initial UE message to the\n    selected MME/SGSN or the BSC sends the UL-Unitdata message to the\n    selected SGSN. The initial UE message/UL-Unitdata message includes the\n    NAS Request message, the MMEGI or Null-NRI/SGSN Group ID, UE Usage Type\n    and the IMSI if received from the first SGSN/MME in step\u00c2\u00a01. The MMEGI\n    or Null-NRI/SGSN Group ID indicates that the message is a rerouted\n    message and the second new MME/SGSN shall not reroute the NAS message.\n    The UE Usage Type shall be included if received in the Reroute NAS\n    Message Request to be used by the second new MME/SGSN to select SGW and\n    PDN GW (see clauses 4.3.8.1 and 4.3.8.2).\n\n\n"}, {"key": "Attach, TAU and RAU procedure for Dedicated Core Network", "numbering": "5.19.2", "title_level": 2, "desc": "5.19.2 Attach, TAU and RAU procedure for Dedicated Core Network\n\nWhen DCNs are used, the Attach, TAU and RAU procedures in this\nclause\u00c2\u00a0apply.\n\n                                    [pic]\n\n  Figure 5.19.2-1: Attach,TAU and RAU procedure for Dedicated Core Network\n\n  1. Attach, TAU, or RAU procedure is initiated as specified in the\n    relevant clauses of this specification and TS\u00c2\u00a023.060\u00c2\u00a0[7]. The relevant\n    steps of the procedure as specified in the figure above are executed.\n    The following modifications apply:\n\n    -  In the RRC Connection Complete message transferring the NAS Request\n       message, the UE provides the DCN-ID, if available. If the UE has a\n       PLMN specific DCN-ID the UE shall provide this value and if no PLMN\n       specific DCN-ID exist the pre-provisioned default standardized DCN-ID\n       shall be provided, if pre-provisioned in the UE. The RAN node selects\n       a DCN and a serving MME/SGSN within the network of the selected core\n       network operator based on the DCN-ID and configuration in the RAN\n       node. The NAS Request message is sent to the selected node. The DCN-\n       ID is provided by the RAN to the MME/SGSN together with the NAS\n       Request message.\n\n    -  E-UTRAN Initial Attach Procedure (clause\u00c2\u00a05.3.2.1 (Figure 5.3.2.1-1))\n       and Combined GPRS/IMSI Attach procedure (TS\u00c2\u00a023.060\u00c2\u00a0[7] clause\u00c2\u00a06.5.3\n       (Figure 22)): In the Identification Response message, the old\n       MME/SGSN provides UE Usage Type parameter, if available.\n\n    -  Tracking area update procedure (clause\u00c2\u00a05.3.3.1 (Figure 5.3.3.1-1)\n       and 5.3.3.2 (Figure 5.3.3.2-1)): In the Context Response message, the\n       old MME/SGSN provides UE Usage Type parameter, if available.\n\n    -  Routing area update procedure (clause\u00c2\u00a05.3.3.3 (Figure 5.3.3.3-1) and\n       5.3.3.6 (Figure 5.3.3.6-1), TS\u00c2\u00a023.060\u00c2\u00a0[7] clauses\u00c2\u00a06.9.1.2.2 (Figure\n       33), 6.9.1.2.2a (Figure 33a), 6.9.1.3.2 (Figure 35), 6.9.2.1 (Figure\n       36), 6.9.2.1a (Figure 36a), 6.13.1.1.1 (Figure 52), 6.13.2.1.1\n       (Figure 54), 6.13.2.1.2 (Figure 54-2), 6.13.2.2.1 (Figure 55),\n       6.13.2.2.2 (Figure 55-2)): In the Context Response message, the old\n       MME/SGSN provides UE Usage Type parameter, if available.\n\n  2. If the (first) new MME/SGSN, i.e. the MME/SGSN that has not received\n    any MMEGI or Null-NRI/SGSN Group ID from RAN, does not have sufficient\n    information to determine whether it should serve the UE, it sends an\n    Authentication Information Request message to the HSS requesting UE\n    Usage Type by adding the parameter \"Send UE Usage Type\" flag in the\n    message. The MME/SGSN may also request one or more authentication\n    vectors in addition to the UE Usage Type. The (first) new MME/SGSN has\n    sufficient information in the following cases and may then skip this\n    step\u00c2\u00a0and step\u00c2\u00a03:\n\n    i. The (first) new MME/SGSN has received the UE Usage Type from the old\n       MME/SGSN in the Identification Response (for Attach) or Context\n       Response (for TAU/RAU) message or Forward Relocation Request (for\n       Handover).\n\n    ii.  Based on configuration in the (first) new MME/SGSN and UE context\n       information, the MME/SGSN is able to determine whether it should\n       serve the UE.\n\n     This step and redirection of NAS message (i.e. step\u00c2\u00a05 onwards) shall\n    not be performed for TAU/RAU procedure triggered in connected mode,\n    e.g. during handover.\n\n  3. The HSS, if supporting DCNs, provides the UE Usage Type in the\n    Authentication Information Answer message, if any is stored for the UE.\n    The UE Usage Type is returned by the HSS in addition to requested\n    authentication vectors.\n\n  4. If the (first) new MME/SGSN determines that it shall not reroute the\n    NAS message to another CN node, the MME/SGSN either continues from the\n    designated step\u00c2\u00a0as stated in the figure above or depending on operator\n    configuration rejects the NAS request message and the NAS procedure\n    ends in this step. The NAS message is rejected with parameters, e.g.\n    backoff timer, such that the UE does not immediately re-initiate the\n    NAS procedure.\n\n     The MME/SGSN sends the DCN-ID, if available, for the DCN to the UE in\n    the NAS Accept message. The UE updates its stored DCN-ID parameter for\n    the serving PLMN if DCN-ID for serving PLMN is changed.\n\n  5. If the (first) new MME/SGSN determines that it should reroute the NAS\n    request message to another CN node, the procedure is a TAU or RAU\n    procedure and UE context was received from the old MME/SGSN, the\n    (first) new MME sends a Context Acknowledge message with cause code\n    indicating that the procedure is not successful. The old MME/SGSN shall\n    continue as if Context Request was never received.\n\n  6. If the (first) new MME/SGSN determines that it should reroute the NAS\n    request message to another CN node, it uses the \"NAS Message\n    Redirection Procedure\" in clause\u00c2\u00a05.19.1. The NAS message is re-routed\n    to a (second) new MME/SGSN. If the IMSI was retrieved unencrypted from\n    the UE by the (first) new MME/SGSN in step\u00c2\u00a01, the (first) new MME/SGSN\n    shall include the IMSI in the Reroute Message Request.\n\n  7. The (second) new MME/SGSN, i.e. the MME/SGSN that receives the\n    rerouted NAS message from RAN with MMEGI or Null-NRI/SGSN Group ID,\n    performs NAS procedure as stated for E-UTRAN in this specification and\n    for GERAN/UTRAN in TS\u00c2\u00a023.060\u00c2\u00a0[7] from the steps shown in the figure\n    above. The following modifications apply:\n\n    -  E-UTRAN Initial Attach Procedure (clause\u00c2\u00a05.3.2.1 (Figure 5.3.2.1-1))\n       and Combined GPRS/IMSI Attach procedure (TS\u00c2\u00a023.060\u00c2\u00a0[7] Clause\u00c2\u00a06.5.3\n       (Figure 22)): In the Identification Response message, the old\n       MME/SGSN provides UE Usage Type parameter, if available.\n\n    -  Tracking area update procedure (clause\u00c2\u00a05.3.3.1 (Figure 5.3.3.1-1)\n       and 5.3.3.2 (Figure 5.3.3.2-1)): In the Context Response message, the\n       old MME/SGSN provides UE Usage Type parameter, if available.\n\n    -  In case the IMSI was received from the first (new) MME/SGSN as part\n       of the NAS Message Redirection Procedure, the second (new) MME/SGSN\n       does not have to retrieve the IMSI from the UE.\n\n    -  Routing area update procedure (clause\u00c2\u00a05.3.3.3 (Figure 5.3.3.3-1) and\n       5.3.3.6 (Figure 5.3.3.6-1), TS\u00c2\u00a023.060\u00c2\u00a0[7] clauses\u00c2\u00a0 6.9.1.2.2 (Figure\n       33), 6.9.1.2.2a (Figure 33a), 6.9.1.3.2 (Figure 35), 6.9.2.1 (Figure\n       36), 6.9.2.1a (Figure 36a), 6.13.1.1.1 (Figure 52), 6.13.2.1.1\n       (Figure 54), 6.13.2.1.2 (Figure 54-2), 6.13.2.2.1 (Figure 55),\n       6.13.2.2.2 (Figure 55-2)): In the Context Response message, the old\n       MME/SGSN provides UE Usage Type parameter, if available.\n\n    -  The MME/SGSN sends the DCN-ID, if available, for the new DCN to the\n       UE in the NAS Accept message. The UE updates its stored DCN-ID\n       parameter for the serving PLMN if DCN-ID for serving PLMN is changed.\n\n     In case network sharing and the Selected PLMN information is not\n       provided by the UE, the SGSN may also include the PLMN ID of selected\n       CN operator in the NAS Accept message.\n\n     The (second) new MME/SGSN shall not reroute the NAS message to another\n       CN node since the Initial UE message/UL-Unitdata message from RAN\n       includes MMEGI or Null-NRI/SGSN Group ID. The (second) new MME/SGSN\n       either completes the NAS procedure as stated above or depending on\n       operator configuration rejects the NAS request message and the NAS\n       procedure ends. When rejecting the NAS request, an appropriate cause\n       and backoff time should be included.\n\n     In the case of TAU or RAU procedure, the (second) new MME/SGSN may\n       check (e.g. based on the indication that the NAS message has been\n       rerouted and on local configuration) if the PDN GW (for one or more\n       PDN connection(s)) of the UE needs to be changed. If the PDN GW needs\n       to be changed, the (second) new MME/SGSN initiates Detach with\n       reattach required or PDN disconnection with reactivation required\n       procedure after the completion of the TAU or RAU procedure.\n\n\n"}, {"key": "Impacts to Handover Procedures", "numbering": "5.19.2a", "title_level": 2, "desc": "5.19.2a  Impacts to Handover Procedures\n\nWhen DCNs are used, the impacts to the handover procedures are captured as\nbelow.\n\n  -  Forward Relocation Request message: When MME changes during handover,\n    in the step where Forward Relocation Request message is sent from the\n    Source MME/SGSN to Target MME/SGSN, the source MME/SGSN also includes\n    the UE Usage Type, if available, in the message. This applies to the\n    following clauses and step:\n\n    -  5.5.1.2.2  S1-based handover, normal: Step 3\n\n    -  5.5.2.1.2  Preparation phase (E-UTRAN to UTRAN Iu mode Inter RAT\n       handover): Step 3\n\n    -  5.5.2.2.2  Preparation phase (UTRAN Iu mode to E-UTRAN Inter RAT\n       handover): Step 3\n\n    -  5.5.2.3.2  Preparation phase (E-UTRAN to GERAN A/Gb mode Inter RAT\n       handover): Step 3\n\n    -  5.5.2.4.2  Preparation phase (GERAN A/Gb mode to E-UTRAN Inter RAT\n       handover): Step 3\n\n  -  Selection of new SGW: In the step, subsequent to the Forward\n    Relocation Request message, in which the target MME/SGSN determines if\n    the Serving GW is to be relocated, if the target MME/SGSN supports DCN,\n    the target MME/SGWN also determines if the existing Serving GW supports\n    the DCN for the UE based on UE Usage Type of the UE, locally configured\n    operator's policies as well as UE related context information available\n    at the target network, e.g. information about roaming. This applies to\n    the following clauses and step:\n\n    -  5.5.1.2.2  S1-based handover, normal: Step 4\n\n    -  5.5.2.1.2  Preparation phase (E-UTRAN to UTRAN Iu mode Inter RAT\n       handover): Step 4\n\n    -  5.5.2.2.2  Preparation phase (UTRAN Iu mode to E-UTRAN Inter RAT\n       handover): Step 4\n\n    -  5.5.2.3.2  Preparation phase (E-UTRAN to GERAN A/Gb mode Inter RAT\n       handover): Step 4\n\n    -  5.5.2.4.2  Preparation phase (GERAN A/Gb mode to E-UTRAN Inter RAT\n       handover): Step 4\n\n  -  Handover from service area where DCN is not used to an area where DCN\n    is supported: When handover occurs from a service area where DCN is not\n    used to a service area where DCN is supported and the MME or SGSN\n    changes, the target MME or SGSN obtains the UE Usage Type information\n    from the HSS during the subsequent TAU or RAU procedure. If the target\n    MME/SGSN determines that the Serving GW does not support the UE Usage\n    Type, the target MME/SGSN triggers the Serving GW relocation as part of\n    the handover procedures described in clause\u00c2\u00a05.5. If the target MME or\n    SGSN does not serve the UE Usage type, the handover procedure should\n    complete successfully and then the target MME or SGSN may use the\n    procedure in clause\u00c2\u00a05.19.3 Step 5 onwards, to change the serving DCN of\n    the UE.\n\n\n"}, {"key": "MME/SGSN or HSS initiated Dedicated Core Network Reselection", "numbering": "5.19.3", "title_level": 2, "desc": ""}, {"key": "MME Pool Area", "desc": "An MME Pool Area is defined as an area within which a UE may\nbe served without need to change the serving MME. An MME Pool Area is\nserved by one or more MMEs (\"pool of MMEs\") in parallel. MME Pool Areas are\na collection of complete Tracking Areas. MME Pool Areas may overlap each\nother."}, {"key": "Serving GW Service Area", "desc": "A Serving GW Service Area is defined as an area\nwithin which a UE may be served without need to change the Serving GW. A\nServing GW Service Area is served by one or more Serving GWs in parallel.\nServing GW Service Areas are a collection of complete Tracking Areas.\nServing GW Service Areas may overlap each other."}, {"key": "PDN Connection", "desc": "The association between a PDN represented by an APN and a\nUE, represented by one IPv4 address and/or one IPv6 prefix (for IP PDN\nType) or by the UE Identity (for Non-IP and Ethernet PDN Types)."}, {"key": "Default Bearer", "desc": "The EPS bearer which is first established for a new PDN\nconnection and remains established throughout the lifetime of the PDN\nconnection."}, {"key": "Default APN", "desc": "A Default APN is defined as the APN which is marked as default\nin the subscription data and used during the Attach procedure and the UE\nrequested PDN connectivity procedure when no APN is provided by the UE."}, {"key": "eCall Only Mode", "desc": "A UE configuration option that allows the UE to attach at\nEPS and register in IMS to perform only eCall Over IMS, and an IMS call to\na non-emergency MSISDN or URI for test and/or terminal reconfiguration\nservices. For a short period following either such call, an incoming call\n(e.g. callback from a PSAP or HPLMN operator) or other incoming session\n(e.g. for USIM reconfiguration) is possible. At other times when the UE is\nconfigured in this mode, the UE is required to refrain from any signaling\nto a network. Use of eCall Only Mode is configured in the USIM for the UE."}, {"key": "PDN Connection to the SCEF", "desc": "The association between a UE, represented by\nthe UE Identity, and a PDN represented by an APN to external packet data\nnetwork via SCEF to allow transfer of Non-IP data. It includes\nestablishment and persistence of T6 connection between MME and SCEF (see\nTS\u00c2\u00a029.128\u00c2\u00a0[79])."}, {"key": "Emergency attached UE", "desc": "A UE which only has bearer(s) related to emergency\nbearer service."}, {"key": "  NOTE\u00c2\u00a01", "desc": "The above term is equivalent to the term \"attached for emergency\n         bearer services\" as specified in TS\u00c2\u00a024.301\u00c2\u00a0[46]."}, {"key": "LIPA PDN connection", "desc": "a PDN Connection for local access (e.g. for IP or\nEthernet access) for a UE connected to a HeNB."}, {"key": "en-gNB", "desc": "As defined in TS\u00c2\u00a037.340\u00c2\u00a0[85]."}, {"key": "SIPTO at local network PDN connection", "desc": "a PDN connection for SIPTO at local\nnetwork for a UE connected to a (H)eNB."}, {"key": "Correlation ID", "desc": "For a LIPA PDN connection, Correlation ID is a parameter\nthat enables direct user plane path between the HeNB and L-GW."}, {"key": "SIPTO Correlation ID", "desc": "For a SIPTO at local network PDN connection, SIPTO\nCorrelation ID is a parameter that enables direct user plane path between\nthe (H)eNB and L-GW when they are collocated."}, {"key": "Local Home Network", "desc": "A set of (H)eNBs and L-GWs in the standalone GW\narchitecture, where the (H)eNBs have IP connectivity for SIPTO at the Local\nNetwork via all the L-GWs."}, {"key": "Local Home Network ID", "desc": "An identifier that uniquely identifies a Local Home\nNetwork within a PLMN."}, {"key": "Presence Reporting Area", "desc": "An area defined within 3GPP Packet Domain for the\npurposes of reporting of UE presence within that area due to policy control\nand/or charging reasons. In case of E-UTRAN, a Presence Reporting Area may\nconsist in a set of neighbor or non-neighbor Tracking Areas, or eNBs and/or"}, {"key": "cells. There are two types of Presence Reporting Areas", "desc": "\"UE-dedicated\nPresence Reporting Areas\" and \"Core Network pre-configured Presence\nReporting Areas\" that apply to an MME pool."}, {"key": "RAN user plane congestion", "desc": "RAN user plane congestion occurs when the demand\nfor RAN resources exceeds the available RAN capacity to deliver the user\ndata for a prolonged period of time."}, {"key": "  NOTE\u00c2\u00a02", "desc": "Short-duration traffic bursts is a normal condition at any\n         traffic load level, and is not considered to be RAN user plane\n         congestion. Likewise, a high-level of utilization of RAN resources\n         (based on operator configuration) is considered a normal mode of\n         operation and might not be RAN user plane congestion."}, {"key": "IOPS-capable eNB", "desc": "an eNB that has the capability of IOPS mode operation,\nwhich provides local connectivity (e.g. for IP or Ethernet) and public\nsafety services to IOPS-enabled UEs via a Local EPC when the eNB has lost\nbackhaul to the Macro EPC or it has no backhaul to the Macro EPC."}, {"key": "IOPS network", "desc": "an IOPS network consists of one or more eNBs operating in\nIOPS mode and connected to a Local EPC."}, {"key": "Local EPC", "desc": "a Local EPC is an entity which provides functionality that eNBs\nin IOPS mode of operation use, instead of the Macro EPC, in order to\nsupport public safety services."}, {"key": "Macro EPC", "desc": "the EPC which serves an eNB when it is not in IOPS mode of\noperation."}, {"key": "Nomadic EPS", "desc": "a deployable system which has the capability to provide radio\naccess (via deployable IOPS-capable eNB(s)), local connectivity (e.g. for\nIP or Ethernet) and public safety services to IOPS-enabled UEs in the\nabsence of normal EPS"}, {"key": "IOPS-enabled UE", "desc": "is an UE that is configured to use networks operating in\nIOPS mode."}, {"key": "Cellular IoT", "desc": "Cellular network supporting low complexity and low throughput\ndevices for a network of Things. Cellular IoT supports IP, Ethernet and Non-\nIP traffic."}, {"key": "Narrowband-IoT", "desc": "a 3GPP Radio Access Technology that forms part of Cellular\nIoT. It allows access to network services via E-UTRA with a channel\nbandwidth limited to 180 kHz (corresponding to one PRB). Unless otherwise\nindicated in a clause, Narrowband-IoT is a subset of E-UTRAN."}, {"key": "LTE-M", "desc": "a 3GPP RAT type Identifier used in the Core Network only, which is a\nsub-type E-UTRAN RAT type, and defined to identify in the Core Network the\nE-UTRAN when used by a UE indicating Category M in its UE radio capability."}, {"key": "WB-E-UTRAN", "desc": "in the RAN, WB-E-UTRAN is the part of E-UTRAN that excludes NB-\nIoT. In the Core Network, the WB-E-UTRAN also excludes LTE-M."}, {"key": "DCN-ID", "desc": "DCN identity identifies a specific dedicated core network (DCN).\n\nFor the purposes of the present document, the following terms and"}, {"key": "definitions given in TS\u00c2\u00a023.167\u00c2\u00a0[81] apply", "desc": ""}, {"key": "eCall Over IMS", "desc": "See TS\u00c2\u00a023.167\u00c2\u00a0[81]."}, {"key": "RLOS attached UE", "desc": "A UE is attached only for accessing Restricted Local\nOperator Services (see TS\u00c2\u00a023.221\u00c2\u00a0[27])."}, {"key": "5GS", "desc": "5G System"}, {"key": "AF", "desc": "Application Function"}, {"key": "ARP", "desc": "Allocation and Retention Priority"}, {"key": "AMBR", "desc": "Aggregate Maximum Bit Rate"}, {"key": "CBC", "desc": "Cell Broadcast Centre"}, {"key": "CBE", "desc": "Cell Broadcast Entity"}, {"key": "CIoT", "desc": "Cellular IoT"}, {"key": "CSG", "desc": "Closed Subscriber Group"}, {"key": "CSG", "desc": "ID Closed Subscriber Group Identity"}, {"key": "C-SGN", "desc": "CIoT Serving Gateway Node"}, {"key": "CSS", "desc": "CSG Subscriber Server"}, {"key": "DCN", "desc": "Dedicated Core Network"}, {"key": "DeNB", "desc": "Donor eNode B"}, {"key": "DL", "desc": "TFT DownLink Traffic Flow Template"}, {"key": "DRX", "desc": "Discontinuous Reception"}, {"key": "ECGI", "desc": "E-UTRAN Cell Global Identifier"}, {"key": "ECM", "desc": "EPS Connection Management"}, {"key": "ECN", "desc": "Explicit Congestion Notification"}, {"key": "EMM", "desc": "EPS Mobility Management"}, {"key": "eNB", "desc": "evolved Node B"}, {"key": "EPC", "desc": "Evolved Packet Core"}, {"key": "EPS", "desc": "Evolved Packet System"}, {"key": "E-RAB", "desc": "E-UTRAN Radio Access Bearer"}, {"key": "E-UTRAN", "desc": "Evolved Universal Terrestrial Radio Access Network"}, {"key": "GBR", "desc": "Guaranteed Bit Rate"}, {"key": "GUMMEI", "desc": "Globally Unique MME Identifier"}, {"key": "GUTI", "desc": "Globally Unique Temporary Identity"}, {"key": "GW", "desc": "Gateway"}, {"key": "HeNB", "desc": "Home eNode B"}, {"key": "HeNB", "desc": "GW  Home eNode B Gateway"}, {"key": "HFN", "desc": "Hyper Frame Number"}, {"key": "IOPS", "desc": "Isolated E-UTRAN Operation for Public Safety"}, {"key": "IoT", "desc": "Internet of Things"}, {"key": "ISR", "desc": "Idle mode Signalling Reduction"}, {"key": "LAA", "desc": "Licensed Assisted Access"}, {"key": "LBI", "desc": "Linked EPS Bearer Id"}, {"key": "L-GW", "desc": "Local GateWay"}, {"key": "LIPA", "desc": "Local IP Access"}, {"key": "LWA", "desc": "LTE/WLAN Aggregation"}, {"key": "LWIP", "desc": "LTE/WLAN Radio Level Integration with IPsec Tunnel"}, {"key": "MBR", "desc": "Maximum Bit Rate"}, {"key": "MME", "desc": "Mobility Management Entity"}, {"key": "MMEC", "desc": "MME Code"}, {"key": "MTC", "desc": "Machine-Type Communications"}, {"key": "M-TMSI", "desc": "M-Temporary Mobile Subscriber Identity"}, {"key": "NB-IoT", "desc": "Narrowband IoT"}, {"key": "NR", "desc": "New Radio"}, {"key": "OCS", "desc": "Online Charging System"}, {"key": "OFCS", "desc": "Offline Charging System"}, {"key": "OMC-ID", "desc": "Operation and Maintenance Centre Identity"}, {"key": "P-GW", "desc": "PDN Gateway"}, {"key": "PCC", "desc": "Policy and Charging Control"}, {"key": "PCRF", "desc": "Policy and Charging Rules Function"}, {"key": "PRA", "desc": "Presence Reporting Area"}, {"key": "PDCP", "desc": "Packet Data Convergence Protocol"}, {"key": "PMIP", "desc": "Proxy Mobile IP"}, {"key": "PSAP", "desc": "Public Safety Answering Point"}, {"key": "PSM", "desc": "Power Saving Mode"}, {"key": "PTI", "desc": "Procedure Transaction Id"}, {"key": "QCI", "desc": "QoS Class Identifier"}, {"key": "RACS", "desc": "UE Radio Capability Signalling optimization"}, {"key": "RCAF", "desc": "RAN Congestion Awareness Function"}, {"key": "RFSP", "desc": "RAT/Frequency Selection Priority"}, {"key": "RLOS", "desc": "Restricted Local Operator Services"}, {"key": "RN", "desc": "Relay Node"}, {"key": "RUCI", "desc": "RAN User Plane Congestion Information"}, {"key": "S-GW", "desc": "Serving Gateway"}, {"key": "S-TMSI", "desc": "S-Temporary Mobile Subscriber Identity"}, {"key": "SDF", "desc": "Service Data Flow"}, {"key": "SIPTO", "desc": "Selected IP Traffic Offload"}, {"key": "TAC", "desc": "Tracking Area Code"}, {"key": "TAD", "desc": "Traffic Aggregate Description"}, {"key": "TAI", "desc": "Tracking Area Identity"}, {"key": "TAU", "desc": "Tracking Area Update"}, {"key": "TI", "desc": "Transaction Identifier"}, {"key": "TIN", "desc": "Temporary Identity used in Next update"}, {"key": "UCMF", "desc": "UE radio Capability Management Function"}, {"key": "URRP-MME", "desc": "UE Reachability Request Parameter for MME"}, {"key": "UL", "desc": "TFT UpLink Traffic Flow Template"}, {"key": "ULR-Flags", "desc": "Update Location Request Flags"}]