[{"key": "Scope", "numbering": "1", "title_level": 0, "desc": "         1  Scope\n\nThe present document specifies the Packet Forwarding Control Protocol\n(PFCP) used on the interface between the control plane and the user plane\nfunction.\n\nPFCP shall be used over:\n\n  -the Sxa, Sxb, Sxc and the combined Sxa/Sxb reference points specified in\n    3GPP\u00a0TS\u00a023.214\u00a0[2].\n\n  - the Sxa' and Sxb' reference points specified in 3GPP\u00a0TS\u00a033.107\u00a0[20]. In\n    the rest of this specification, no difference is made between Sxa and\n    Sxa', or between Sxb and Sxb'. The Sxa' and Sxb' reference points reuse\n    the protocol specified for the Sxa and Sxb reference points, but comply\n    in addition with the security requirements specified in clause 8 of\n    3GPP\u00a033.107\u00a0[20].\n\n     the N4 interface specified in 3GPP\u00a0TS\u00a023.501\u00a0[28] and\n    3GPP\u00a0TS\u00a023.502\u00a0[29].\n\nIn this specification the term CP function applies to control plane nodes\nsuch as SGW-C, PGW-C, TDF-C and SMF.\n\nIn this specification the term UP function applies to control plane nodes\nsuch as SGW-U, PGW-U, TDF-U and UPF.\n\nThe prefix PFCP in message and procedure names is used to indicate that\nmessages and procedures are common and used on Sx and N4 reference point. A\nPFCP session refers to both Sx and/or N4 sessions. PFCP association are\ndescribing procedures to establish associations between EPC nodes (SGW-\nC/PGW-C/TDF-C and SGW-U/PGW-U/TDF-U) and also between 5G nodes (SMF and\nUPF).\n\nIn the related stage 2 specifications the prefix Sx and N4 is used for\nthese common procedures realised by PFCP\n\nClauses, subclauses or paragraphs that only apply to EPC or 5GC are\nindicated by the label \"for EPC\" or \"for 5GC\".\n\n\n"}, {"key": "References", "numbering": "2", "title_level": 0, "desc": "2  References\n\nThe following documents contain provisions which, through reference in this\ntext, constitute provisions of the present document.\n\n  -  References are either specific (identified by date of publication,\n    edition number, version number, etc.) or non-specific.\n\n  -  For a specific reference, subsequent revisions do not apply.\n\n  -  For a non-specific reference, the latest version applies. In the case\n    of a reference to a 3GPP document (including a GSM document), a non-\n    specific reference implicitly refers to the latest version of that\n    document in the same Release as the present document.\n\n  [1]  3GPP\u00a0TR\u00a021.905: \"Vocabulary for 3GPP Specifications\".\n\n  [2]  3GPP\u00a0TS\u00a023.214: \"Architecture enhancements for control and user\n             plane separation of EPC nodes; Stage 2\".\n\n  [3]  3GPP\u00a0TS\u00a029.281: \"General Packet Radio System (GPRS) Tunnelling\n             Protocol User Plane (GTPv1-U)\".\n\n  [4]  IETF\u00a0RFC\u00a0768: \"User Datagram Protocol\".\n\n  [5]  IETF\u00a0RFC\u00a0791: \"Internet Protocol\".\n\n  [6]  IETF\u00a0RFC\u00a02460: \"Internet Protocol, Version 6 (IPv6) Specification\".\n\n  [7]  3GPP\u00a0TS\u00a023.203: \"Policy and charging control architecture; Stage 2\".\n\n  [8]  3GPP\u00a0TS\u00a029.212: \"Policy and Charging Control (PCC); Reference\n             points\".\n\n  [9]  3GPP\u00a0TS\u00a029.274: \"3GPP Evolved Packet System. Evolved GPRS Tunnelling\n             Protocol for EPS (GTPv2)\".\n\n  [10] 3GPP\u00a0TS\u00a036.413: \"Evolved Universal Terrestrial Radio Access Network\n             (E-UTRAN); S1 Application Protocol (S1AP)\".\n\n  [11] 3GPP\u00a0TS\u00a029.213: \"Policy and Charging Control signalling flows and\n             Quality of Service (QoS) parameter mapping\".\n\n  [12] IETF\u00a0RFC\u00a05905: \"Network Time Protocol Version 4: Protocol and\n             Algorithms Specification\".\n\n  [13] IETF\u00a0RFC\u00a02474: \"Definition of the Differentiated Services Field (DS\n             Field) in the IPv4 and IPv6 Headers\".\n\n  [14] 3GPP\u00a0TS\u00a023.401: \"General Packet Radio Service (GPRS) enhancements\n             for Evolved Universal Terrestrial Radio Access Network (E-\n             UTRAN) access\".\n\n  [15] 3GPP\u00a0TS\u00a022.153: \"Multimedia Priority Service\".\n\n  [16] IETF\u00a0RFC\u00a04006: \"Diameter Credit Control Application\".\n\n  [17] 3GPP\u00a0TS\u00a032.251: \"Telecommunication management; Charging management;\n             Packet Switched (PS) domain charging\".\n\n  [18] 3GPP\u00a0TS\u00a032.299: \"Telecommunication management; Charging management;\n             Diameter charging application\".\n\n  [19] 3GPP\u00a0TS\u00a023.060: \"General Packet Radio Service (GPRS); Service\n             description; Stage 2\".\n\n  [20] 3GPP\u00a0TS\u00a033.107: \"3G security; Lawful interception architecture and\n             functions\".\n\n  [21] 3GPP\u00a0TS\u00a029.251: \"Gw and Gwn reference points for sponsored data\n             connectivity\".\n\n  [22] IETF\u00a0RFC\u00a02474, \"Definition of the Differentiated Services Field (DS\n             Field) in the IPv4 and IPv6 Headers\".\n\n  [23] IETF\u00a0RFC\u00a07230: \"Hypertext Transfer Protocol (HTTP/1.1): Message\n             Syntax and Routing\".\n\n  [24] 3GPP\u00a0TS\u00a023.007: \"Restoration procedures\".\n\n  [25] 3GPP\u00a0TS\u00a029.303: \"Domain Name System Procedures; Stage 3\"\n\n  [26] IETF\u00a0RFC\u00a05905: \"Network Time Protocol Version 4: Protocol and\n             Algorithms Specification\".\n\n  [27] IETF\u00a0RFC\u00a01035: \"Domain Names - Implementation and Specification\".\n\n  [28] 3GPP\u00a0TS\u00a023.501:\"System Architecture for the 5G System\"\n\n  [29] 3GPP\u00a0TS\u00a023.502:\"Procedures for the 5G System\"\n\n  [30] IEEE\u00a0802.1Q: \"Virtual Bridged Local Area Networks\"\n\n  [31] IEEE\u00a0802.3: \"IEEE Standard for Ethernet\"\n\n  [32] IETF\u00a0RFC\u00a01027: \"Using ARP to Implement Transparent Subnet Gateways\".\n\n  [33] IETF\u00a0RFC\u00a04861: \"Neighbor Discovery for IP version 6 (IPv6)\". .\n\n  [34] 3GPP\u00a0TS\u00a038.415: \"NG-RAN; PDU Session User Plane Protocol\".\n\n\n"}, {"key": "Definitions, symbols and abbreviations", "numbering": "3", "title_level": 0, "desc": "3  Definitions, symbols and abbreviations\n\n\n"}, {"key": "Abbreviations", "numbering": "3.2", "title_level": 1, "desc": "3.2  Abbreviations\n\nFor the purposes of the present document, the abbreviations given in 3GPP\nTR\u00a021.905 [1] and the following apply. An abbreviation defined in the\npresent document takes precedence over the definition of the same\nabbreviation, if any, in 3GPP\u00a0TR\u00a021.905\u00a0[1].\n\n  ADC  Application Detection and Control\n  BAR  Buffering Action Rule\n  CP Control Plane\n  DDoS Distributed Denial of Service\n  DEI  Drop Eligible Indicator\n  DSCP Differentiated Services Code Point\n  eMPS enhanced Multimedia Priority Service\n  FAR  Forwarding Action Rule\n  F-SEID Fully Qualified SEID\n  F-TEID Fully Qualified TEID\n  IP Internet Protocol\n  IPv4 Internet Protocol version 4\n  IPv6 Internet Protocol version 6\n  LMISF  LI Mirror IMS State Function\n  NR New Radio\n  PCC  Policy and Charging Control\n  PCP  Priority Code Point\n  PCEF Policy and Charging Enforcement Function\n  PCRF Policy and Charging Rule Function\n  PDI  Packet Detection Information\n  PDR  Packet Detection Rule\n  PFCP Packet Forwarding Control Protocol\n  PFD  Packet Flow Description\n  PGW  PDN Gateway\n  PGW-C  PDN Gateway Control plane function\n  PGW-U  PDN Gateway User plane function\n  QER  QoS Enforcement Rule\n  S8HR S8 Home Routed\n  SDF  Service Data Flow\n  SEID Session Endpoint Identifier\n  SGW  Serving Gateway\n  SGW-C  Serving Gateway Control plane function\n  SGW-U  Serving Gateway User plane function\n  SX3LIF Split X3 LI Interworking Function\n  TDF  Traffic Detection Function\n  TDF-C  Traffic Detection Function Control plane function\n  TDF-U  Traffic Detection Function User plane function\n  ToS  Type of Service\n  TSSF Traffic Steering Support Function\n  UDP  User Datagram Protocol\n  UP User Plane\n  URR  Usage Reporting Rule\n  VID  VLAN Identifier\n\n"}, {"key": "Protocol Stack", "numbering": "4", "title_level": 0, "desc": "4  Protocol Stack\n\n  Editor's Note:  The subclauses under clause 4 need to be updated to cover\n         5GC N4 reference point requirements.\n\n\n"}, {"key": "Introduction", "numbering": "4.1", "title_level": 1, "desc": "4.1  Introduction\n\nThe protocol stack for the control plane over the Sxa, Sxb, Sxc and\ncombined Sxa/Sxb reference points shall be as depicted in Figure 4.1-1.\nSubclauses 4.2 and 4.3 further specify the related UDP and IP requirements.\n\n                                    [pic]\n\n\n\n  Figure 4.1-1: Control Plane stack over Sxa, Sxb, Sxc and combined Sxa/Sxb\n                                   and N4\n\nThe protocol stack for the user plane over the Sxa, Sxb and N4reference\npoints (see subclause 5.3) shall be as depicted in Figure 4.1-2.\n3GPP\u00a0TS\u00a029.281\u00a0[3] further specifies the related GTP-U, UDP and IP\nrequirements. Both IPv4 and IPv6 shall be supported.\n\n\n\n                                    [pic]\n\n    Figure 4.1-2: User Plane stack over Sxa, Sxb, combined Sxa/Sxb and N4\n\n\n"}, {"key": "UDP Header and Port Numbers", "numbering": "4.2", "title_level": 1, "desc": "4.2  UDP Header and Port Numbers\n\n\n"}, {"key": "General", "numbering": "4.2.1", "title_level": 2, "desc": "4.2.1  General\n\nA User Datagram Protocol (UDP) compliant with IETF\u00a0RFC\u00a0768\u00a0[4] shall be\nused.\n\n\n"}, {"key": "Request Message", "numbering": "4.2.2", "title_level": 2, "desc": "4.2.2  Request Message\n\nThe UDP Destination Port number for a Request message shall be 8805. It is\nthe registered port number for PFCP.\n\nThe UDP Source Port for a Request message is a locally allocated port\nnumber at the sending entity.\n\n  NOTE:  The locally allocated source port number can be reused for\n         multiple Request messages.\n\n\n"}, {"key": "Response Message", "numbering": "4.2.3", "title_level": 2, "desc": "4.2.3  Response Message\n\nThe UDP Destination Port value of a Response message shall be the value of\nthe UDP Source Port of the corresponding Request message.\n\nThe UDP Source Port of a Response message shall be the value from the UDP\nDestination Port of the corresponding message.\n\n\n"}, {"key": "IP Header and IP Addresses", "numbering": "4.3", "title_level": 1, "desc": "4.3  IP Header and IP Addresses\n\n\n"}, {"key": "General", "numbering": "4.3.1", "title_level": 2, "desc": "4.3.1  General\n\nIn this subclause, \"IP\" refers either to IPv4 as defined by\nIETF\u00a0RFC\u00a0791\u00a0[5] or IPv6 as defined by IETF\u00a0RFC\u00a02460\u00a0[6]. A PFCP entity\nshall support both IPv4 and IPv6.\n\n\n"}, {"key": "Request Message", "numbering": "4.3.2", "title_level": 2, "desc": "4.3.2  Request Message\n\nThe IP Destination Address of a Request message shall be an IP address of\nthe peer entity.\n\nDuring the establishment of an PFCP Session, the CP and the UP functions\nselect and communicate to each other the IP Destination Address at which\nthey expect to receive subsequent Request messages related to that PFCP\nSession. The CP and the UP functions may change this IP address\nsubsequently during an PFCP Session Modification procedure.\n\nThe IP Source Address of a Request message shall be an IP address of the\nsending entity.\n\n\n"}, {"key": "Response Message", "numbering": "4.3.3", "title_level": 2, "desc": ""}, {"key": "Layer", "numbering": "4.4", "title_level": 1, "desc": ""}, {"key": "Layer", "numbering": "4.5", "title_level": 1, "desc": "4.3.3  Response Message\n\nThe IP Destination Address of a Response message shall be copied from the\nIP Source Address of the corresponding Request message.\n\nThe IP Source Address of a Response message shall be copied from the IP\ndestination address of the corresponding Request message.\n\n\n4.4  Layer 2\n\nTypically Ethernet should be used as a Layer 2 protocol, but operators may\nuse any other technology.\n\n\n4.5  Layer 1\n\nOperators may use any appropriate Layer 1 technology.\n\n\n\n\n"}, {"key": "General description", "numbering": "5", "title_level": 0, "desc": "5  General description\n\n  Editor's Note:  The subclauses under clause 5 need to be updated to cover\n         5GC N4 reference point requirements.\n\n\n"}, {"key": "Introduction", "numbering": "5.1", "title_level": 1, "desc": "5.1  Introduction\n\nThe architecture reference model with Control and User Plane Separation of\nEPC nodes is described in subclause 4.2 of 3GPP\u00a0TS\u00a023.214\u00a0[2].\n\nThe architecture reference model with SMF and UPF of 5GC nodes is described\nin subclause 4.2 of 3GPP\u00a0TS\u00a023.501\u00a0[28].\n\nThis clause specifies the high level principles of the PFCP protocol and\ndescribe how 3GPP functionalities are realised on the Sxa, Sxb, Sxc and N4\nreference points, e.g. Packet Forwarding, Policy and Charging Control,\nLawful Interception.\n\n\n"}, {"key": "Packet Forwarding Model", "numbering": "5.2", "title_level": 1, "desc": "5.2  Packet Forwarding Model\n\n\n"}, {"key": "General", "numbering": "5.2.1", "title_level": 2, "desc": "5.2.1  General\n\nThe packet forwarding scenarios supported over the Sxa, Sxb and Sxc\nreference points are specified in 3GPP\u00a0TS\u00a023.214\u00a0[2].\n\nThe packet forwarding scenarios supported over the N4 reference point are\nspecified in 3GPP\u00a0TS\u00a023.501\u00a0[28] and 3GPP\u00a0TS\u00a023.502\u00a0[29].\n\nThe CP function controls the packet processing in the UP function by\nestablishing, modifying or deleting PFCP Session contexts and by\nprovisioning (i.e. adding, modifying or deleting) PDRs, FARs, QERs, URRs\nand/or BAR per PFCP session context, whereby an PFCP session context may\ncorrespond:\n\n  -  for EPC, to an individual PDN connection, a TDF session, or a\n    standalone session not tied to any PDN connection or TDF session used\n    e.g. for forwarding Radius, Diameter or DHCP signalling between the PGW-\n    C and the PDN.\n\n  -  for 5GC, to an individual PDU session or a standalone PFCP session not\n    tied to any PDU session.\n\nEach PDR shall contain a PDI, i.e. one or more match fields against which\nincoming packets are matched, and may be associated to the following rules\nproviding the set of instructions to apply to packets matching the PDI:\n\n  -  one FAR, which contains instructions related to the processing of the\n    packets as follows:\n\n    -  an Apply Action parameter, which indicates whether the UP function\n       shall forward, duplicate, drop or buffer the packet with or without\n       notifying the CP function about the arrival of a DL packet;\n\n    -  forwarding, buffering and/or duplicating parameters, which the UP\n       function shall use if the Apply Action parameter requests the packets\n       to be forwarded, buffered or duplicated respectively. These\n       parameters may remain configured in the FAR regardless of the Apply\n       Action parameter value, to minimize the changes to the FAR during the\n       transitions of the UE between the idle and connected modes. The\n       buffering parameters, when present, shall be provisioned in a BAR\n       created at the PFCP session level and referenced by the FAR.\n\n  NOTE 1:  Buffering refers here to the buffering of the packet in the UP\n         function. The UP function is instructed to forward DL packets to\n         the CP function when applying buffering in the CP function. See\n         subclause 5.3.1.\n\n  -  zero, one or more QERs, which contains instructions related to the QoS\n    enforcement of the traffic;\n\n  -  zero, one or more URRs, which contains instructions related to traffic\n    measurement and reporting.\n\nA FAR, a QER and a URR shall only be associated to one or multiple PDRs of\nthe same PFCP session context.\n\nThe QoS Enforcement Rule Correlation ID shall be assigned by the CP\nfunction to correlate QERs from multiple PFCP session contexts. For\ninstance, the enforcement of APN-AMBR in the PGW-U shall be achieved by\nsetting the same QoS Enforcement Rule Correlation ID to the QERs from\ndifferent PFCP sessions associated with all the PDRs corresponding to the\nnon-GBR bearers of all the UE's PDN connections to the same APN. The QERs\nthat are associated to the same QoS Enforcement Rule Correlation ID in\nmultiple PFCP sessions shall be provisioned, with the same QER contents, in\neach of these PFCP sessions. The QoS Enforcement Rule Correlation ID shall\nbe only used to enforce the APN-AMBR when the UE is in EPC, it may be\nprovided by the CP function over N4 to the UP function for a PDU session\nmay move to EPC in a later stage.\n\nThe following principles shall apply for the provisioning of PDRs in the UP\nfunction:\n\n  -  The CP function shall not provision more than one PDR with the same\n    match fields in the PDI (i.e. with the same set of match fields and\n    with the same value). The CP function may provision PDRs with the same\n    value for a subset of the match fields of the PDI but not all;\n\n  -  different PDRs of a same PFCP session may overlap, e.g. the CP\n    function may provision two PDRs which differ by having one match field\n    set to a specific value in one PDR and the same match field not\n    included in the other PDR (thus matching any possible value);\n\n  -  different PDRs of different PFCP sessions shall not overlap, i.e.\n    there shall be at least one PDR in each PFCP session which differs by\n    at least one different (and not wildcarded) match field in their PDI,\n    such that any incoming user plane packet may only match PDRs of a\n    single PFCP session;\n\n  NOTE 2:  It is allowed for instance to provision in a PGW-U a same uplink\n         PDR, matching any uplink traffic towards a particular application\n         server's IP address, in two different PFCP sessions of two\n         different UEs, as long as each PFCP session is also provisioned\n         with another uplink PDR set with the respective UE IP address\n         and/or uplink F-TEIDu, which allows the PGW-U to identify the PFCP\n         session to which the packet corresponds.\n\n  -  As an exception to the previous principle, the CP function may\n    provision a PDR with all match fields wildcarded (i.e. all match fields\n    omitted in the PDI) in a separate PFCP session, to control how the UP\n    function shall process packets unmatched by any PDRs of any other PFCP\n    session. The CP function may provision the UP function to send these\n    packets to the CP function or to drop them. The UP function shall grant\n    the lowest precedence to this PDR.\n\nOn receipt of a user plane packet, the UP function shall perform a lookup\nof the provisioned PDRs and:\n\n  -  identify first the PFCP session to which the packet corresponds; and\n\n  -  find the first PDR matching the incoming packet, among all the PDRs\n    provisioned for this PFCP session, starting with the PDRs with the\n    highest precedence and continuing then with PDRs in decreasing order of\n    precedence. Only the highest precedence PDR matching the packet shall\n    be selected, i.e. the UP function shall stop the PDRs lookup once a\n    matching PDR is found.\n\nA packet matches a PDR if all the match fields of the PDI of the PDR are\nmatching the corresponding packet header fields. If a match field is not\nincluded in the PDI, it shall be considered as matching all possible values\nin the header field of the packet. If the match field is present and does\nnot include a mask, the match field shall be considered as matching the\ncorresponding header field of the packet if it has the same value. If the\nmatch field is present and includes a mask (e.g. IP address with a prefix\nmask), the match field shall be considered as matching the corresponding\nheader field of the packet if it has the same value for the bits which are\nset in the mask.\nThe match fields of the PDI shall correspond to outer and/or inner packet\nheader fields, e.g. uplink bearer binding verification in the PGW-U may be\nachieved by configuring a PDR with the PDI containing the local GTP-U F-\nTEID (for outer IP packet matching) and the SDF filters of the data flows\nmapped to the bearer (for inner IP packet matching).\n\nThe UP function should drop packets unmatched by any PDRs.\n\nThe packet processing flow in the UP function is illustrated in Figure\n5.2.1-1.\n\n                                    [pic]\n\n          Figure 5.2.1-1: Packet processing flow in the UP function\n\nAt the deletion of an PFCP session, the UP function shall delete the PFCP\nsession context and all the associated non-preconfigured rules.\n\n  NOTE 3:  Deleting a QER in one PFCP session does not result in deleting\n         another QER in another PFCP session even when these two QERs have\n         the same QER ID and/or are associated with the same QER Correlation\n         ID.\n\nA UP Function controlled by multiple CP functions shall handle Rule IDs\nfrom the different CP functions independently from each other.\n\nRule ID used for PDR, FAR, BAR, QER or URR is uniquely identifying a rule\nof the corresponding rule type within a session.\n\n\n"}, {"key": "Packet Detection Rule Handling", "numbering": "5.2.1A", "title_level": 2, "desc": "5.2.1A Packet Detection Rule Handling\n\n\n"}, {"key": "General", "numbering": "5.2.1A.1", "title_level": 3, "desc": "5.2.1A.1 General\n\nWhen provisioning a PDR in the UP function, the CP function shall provide\nthe PDI with the following information:\n\n  -  the source interface of the incoming packets;\n\n  -  a combination of the parameters, that incoming packets are requested\n    to match, among: Local F-TEID, Network Instance, UE IP address, SDF\n    Filter(s) and/or Application ID. For 5GC, the PDI may additionally\n    contain one or more QFI(s) to detect traffic pertaining to specific QoS\n    flow(s), Ethernet Packet Filter(s) and/or Ethernet PDU Session\n    Information (see subclause 5.13.1).\n\nThe CP function may provision the parameters, that incoming packets are\nrequested to match, in the UP function by:\n\n  -  providing the parameters individually in each PDI of the PFCP session;\n    or\n\n  -  optionally, if the PDI Optimization feature is supported by the UP\n    function, by providing the parameters which may be common to multiple\n    PDIs of a same PFCP session in a Traffic Endpoint IE and by referencing\n    this Traffic Endpoint in the PDI(s) of the PFCP session. See subclause\n    5.2.1A.2. A Traffic Endpoint may include a Local F-TEID, Network\n    Instance, UE IP address and/or Ethernet PDU Session Information (see\n    subclause 5.13.1).\n\n  NOTE:  A Traffic Endpoint can correspond to a GTP-u endpoint, an SGi or\n         an N6 endpoint.\n\n\n"}, {"key": "PDI Optimization", "numbering": "5.2.1A.2", "title_level": 3, "desc": "5.2.1A.2 PDI Optimization\n\nPDI Optimization is an optional feature which may be supported by the CP\nand UP Functions. This feature allows the CP function to optimize the\nsignaling towards the UP function by creating the information that are\ncommon to multiple PDRs as a Traffic Endpoint with a Traffic Endpoint ID\nand then referring to this common information from multiple PDRs. The\nTraffic Endpoint ID shall be unique within an PFCP session. When a PDI\nrefers to a Traffic Endpoint, the parameters that are in the Traffic\nEndpoint shall not be once again provided in the PDI. The CP function may\nupdate the Traffic Endpoint at any time.\n\nIf a Traffic Endpoint is updated, all the PDRs that refer to this Traffic\nEndpoint in the UP function shall use the updated information.\n\nIf F-TEID allocation is performed in the UP function, the UP function shall\nallocate and store the F-TEID associated to the Traffic Endpoint. When the\nUP function provides the allocated F-TEID to the CP function in the PFCP\nSession Establishment response or PFCP Session Modification response\nmessage, the CP function shall update the Traffic Endpoint information\nstored in the CP function with the received F-TEID.\n\nThe CP function should use a Traffic Endpoint ID created in a different\nPFCP message only after getting the confirmation from the UP function of\nthe Traffic Endpoint ID creation.\n\nIf the CP function deletes a Traffic Endpoint, the UP Function shall delete\nall the PDRs that refer to this Traffic Endpoint.\n\n  NOTE 1:  The requirements specified in subclause 5.2.2.3.1 for reporting\n         usage reports to the CP function also apply if the deletion of the\n         Traffic Endpoint results in deleting the last PDR associated to a\n         URR.\n\n  NOTE2: For EPC, the Remove Traffic Endpoint IE can be used to delete a\n         bearer for which multiple PDRs exist (with the same Traffic\n         Endpoint ID).\n\n\n"}, {"key": "Bidirectional SDF Filters", "numbering": "5.2.1A.3", "title_level": 3, "desc": "5.2.1A.3 Bidirectional SDF Filters\n\nThe CP function may provision bidirectional SDF Filters in the UP function\n(see subclause 8.2.5), i.e. SDF Filters that may be associated to both\nuplink and downlink PDRs of a same Sx session, as follows:\n\n  -  when provisioning a bidirectional SDF Filter the first time for an Sx\n    session, the CP function shall provision the SDF filter definition\n    together with a SDF Filter ID uniquely identifying the SDF Filter among\n    all the SDF Filters provisioned for a given Sx Session;\n\n  -  the CP function may then provision a PDR for the same Sx session but\n    the opposite direction, by provisioning the SDF Filter ID in the SDF\n    filter ID field of the PDI, without provisioning again the SDF filter\n    definition;\n\n  -  the UP function shall apply any modification of a bidirectional SDF\n    Filter to all PDRs of the Sx session making use of this SDF Filter;\n\n  -  upon deletion of a PDR making use of a bidirectional SDF Filter, the\n    UP function shall still apply the SDF Filter for any other PDR making\n    use of the SDF Filter.\n\n\n"}, {"key": "Usage Reporting Rule Handling", "numbering": "5.2.2", "title_level": 2, "desc": "5.2.2  Usage Reporting Rule Handling\n\n\n"}, {"key": "General", "numbering": "5.2.2.1", "title_level": 3, "desc": "5.2.2.1  General\n\nThe CP function shall provision URR(s) for an PFCP session in an PFCP\nSession Establishment Request or an PFCP Session Modification Request to\nrequest the UP function to:\n\n  -  measure the network resources usage in terms of traffic data volume,\n    duration (i.e. time) and/or events, according to the provisioned\n    Measurement Method; and\n\n  -  send a usage report to the CP function, when the measurement reaches a\n    certain threshold, periodically or when detecting a certain event,\n    according to the provisioned Reporting Triggers.\n\n  NOTE:  The UP function sends a usage report without performing network\n         resources usage measurements when being requested to detect and\n         report the the start of an SDF or application traffic.\n\n\n"}, {"key": "Provisioning of Usage Reporting Rule in the UP function", "numbering": "5.2.2.2", "title_level": 3, "desc": "5.2.2.2  Provisioning of Usage Reporting Rule in the UP function\n\n\n"}, {"key": "General", "numbering": "5.2.2.2.1", "title_level": 4, "desc": "5.2.2.2.1   General\n\nWhen provisioning a URR, the CP function shall provide the reporting\ntrigger(s) in the Reporting Triggers IE of the URR which shall cause the UP\nfunction to generate and send a Usage Report for this URR to the CP\nfunction. When adding or removing reporting trigger(s) to or from the URR,\nthe CP function shall provide the new complete list of applicable reporting\ntriggers in the Reporting Triggers IE in the PFCP Session Modification\nRequest message.\n\nFor the volume-based measurement method, the CP function may provision:\n\n  -  the Volume Threshold IE, to request the UP function to generate a\n    usage report when the measured traffic reaches the threshold;\n\n  -  the Volume Quota IE, to request the UP function to stop forwarding\n    packets (or only allow forwarding of some limited user plane traffic,\n    based on operator policy in the UP function) and, if no Volume\n    Threshold is provisioned, to also generate a usage report, when the\n    measured traffic reaches the quota;\n\n  -  the Dropped DL Traffic Threshold IE, to request the UP function to\n    generate a usage report when the downlink traffic that is being dropped\n    reaches the threshold; and/or\n\n  NOTE 1:  The Dropped DL Traffic Threshold can be armed in a SGW-U for\n         triggering the PGW Pause of Charging feature (see\n         3GPP\u00a0TS\u00a023.401\u00a0[14]).\n\n  -  a Measurement Information with the 'Measurement Before QoS\n    Enforcement' flag set to 1, to request the UP function to measure the\n    traffic usage before any QoS enforcement.\n\nFor the time-based measurement method, the CP function may provision:\n\n  -  a Time Threshold IE, to request the UP function to generate a usage\n    report when the measured traffic reaches the threshold;\n\n  -  a Time Quota, to request the UP function to stop forwarding packets\n    (or only allow forwarding of some limited user plane traffic, based on\n    operator policy in the UP function) and, if no Time Threshold is\n    provisioned, to also generate a usage report, when the measured traffic\n    reaches the quota; and/or\n\n  -  an Inactivity Detection Time, to request the UP function to suspend\n    the time measurement when no packets are received during the\n    provisioned Inactivity Detection Time. The time measurement shall then\n    be resumed by the UP function when subsequent traffic is received. If\n    an Inactivity Detection Time value of zero is provided, or if no\n    Inactivity Detection Time has been provided by the CP function, the\n    time measurement shall be performed continuously from the point when\n    the first packet is received until the time-based usage measurement is\n    stopped. See Figure 5.2.2.2-1:\n\n                                    [pic]\n\n                    Figure 5.2.2.2-1: IDT based charging\n\n  NOTE 2:  The Inactivity Detection Time can be set to the Quota\n         Consumption Timer if received.\n\n  -  For EPC, a Time Quota Mechanism, including a Base Time Interval Type,\n    which is either Continuous Time Period (CTP) or Discrete Time Period\n    (DTP), and a Base Time Interval (BTI), to the UP function. See\n    subclause 6.5.7 in 3GPP\u00a0TS\u00a032.299[18].\n\n  -  For CTP (Continuous Time Period), the time measurement starts from the\n    time that traffic has occurred up to the first Base Time Interval (BTI)\n    which contains no traffic. The time measurement shall include the last\n    Base Time Interval, i.e. the one which contained no traffic. The time\n    measurement resumes by the UP function when subsequent traffic is\n    received. See Figure 5.2.2.2-2:\n\n                                    [pic]\n\n                    Figure 5.2.2.2-2: CTP based charging\n\n    -  For DTP (Descrete Time Period), the time measurement starts from the\n       time that traffic has occurred up to the Base Time Interval end. The\n       time measurement shall be resumed by the UP function when subsequent\n       traffic is received. See Figure 5.2.2.2-3:\n\n                                    [pic]\n\n                    Figure 5.2.2.2-3: DTP based charging\n\nWhen the time-based measurement method applies, and when the Envelope\nReporting is required for EPC, the CP function shall request the UP\nfunction to report the usage by setting the reporting trigger to Envelope\nClosure in addition to other Reporting Trigger(s), in the Reporting\nTriggers IE. The CP function may indicate the UP function to report for\njust time, time and volume, time and events, or time and volume and number\nof events by setting Measurement Method accordingly. The CP function may\nset the Reduced Application Detection Information flag in the Measurement\nInformation of the URR, when requesting the detection of start and stop of\nan application solely for the purpose of envelope reporting for EPC.\n\nThe CP function may provision a Volume Threshold, a Volume Quota, or both\n(and/or respectively a Time Threshold, a Time Quota, or both).\n\nWhen both a Volume (or Time) Threshold and a Volume (or Time) Quota are\nprovisioned, the UP function shall send a usage report only when reaching\nthe Volume (or Time) Threshold; when subsequently reaching the Volume (or\nTime) Quota, the UP function shall stop forwarding packets (or only allow\nforwarding of some limited user plane traffic, based on operator policy in\nthe UP function) without sending a new usage report to the CP function.\n\n  NOTE 3:  For online charging, the Volume Threshold (or Time Threshold)\n         can be set in a PGW-U or TDF-U to the value of the granted volume\n         (or time) quota minus the volume (or time) quota threshold, such as\n         to get a usage report from the UP function when the volume (or\n         time) based credit falls below the remaining quota thresholds\n         provided by the OCS.\n\n  NOTE 4:  The Volume Quota or Time Quota can be armed in a PGW-U or TDF-U\n         for online charging to enable the traffic to be forwarded up to an\n         intermediate or final quotas granted by the OCS. The CP function\n         can provision both a Volume (or Time) Threshold and a Volume (or\n         Time) Threshold to request the UP function to:\n         -  send a usage report when the consumed resources reach the volume\n         (or time) usage threshold provided by the OCS, and\n         -  to stop forwarding packets (or only allow forwarding of some\n         limited user plane traffic, based on operator policy in the UP\n         function), without sending a second usage report, when the granted\n         volume (or time) quota is exhausted.\n\n  For all the measurement methods (i.e. volume, time or event), the CP\n         function may also provision:\n\n  -  a Quota Holding Time, to request the UP function to send a usage\n    report and to also stop forwarding packets (or only allow forwarding of\n    some limited user plane traffic, based on operator policy in the UP\n    function) when no packets have been received for the duration indicated\n    in this parameter;\n\n  NOTE 5:  A Quota Holding Time can be armed in a PGW-U or TDF-U for online\n         charging to request the UP function to send a Usage Report when the\n         Quota Holding Time provided by the OCS (see 3GPP\u00a0TS\u00a032.299\u00a0[18])\n         expires. The UP function can be instructed in the same Usage\n         Reporting Rule with the Report Triggers \u2013 START to generate a new\n         Usage Report upon receiving any subsequent packets associated with\n         this URR.\n\n  -  a Monitoring Time, to request the UP function to measure the network\n    resources usage before and after the monitoring time in separate counts\n    and to re-apply the volume and time thresholds at the monitoring time.\n    The CP function may additionally provision a Subsequent Volume (or\n    Time) Threshold IE and/or a Subsequent Volume (or Time) Quota IE, for a\n    volume (or time) based measurement. When being provisioned with a\n    Monitoring Time, the UP function shall:\n\n    -  reset its usage thresholds at the monitoring time to the value\n       provided in the Subsequent Volume (or Time) Threshold IE, if\n       provisioned in the URR, or to the remaining value of the Volume (or\n       Time) threshold used before the monitoring time (i.e. excluding the\n       already accumulated volume or time usage);\n\n    -  shall indicate the usage up to the Monitoring time and usage after\n       the Monitoring time in the first usage report after the Monitoring\n       Time is reached;\n\n  -  a Measurement Period, indicating the period to generate periodic usage\n    reports to the CP function.\n\nIf the UP function indicated support of the Quota Action feature in the UP\nFunction Features IE, when the CP function provisions a Volume Quota or\nTime Quota in a URR, the CP function may also provision the \"FAR ID for\nQuota Action\" IE identifying the substitute FAR the UP function shall\napply, for the traffic associated to this URR, when exhausting any of these\nquotas. This FAR may require the UP function to drop the packets or\nredirect the traffic towards a redirect destination as specified in\nsubclause 5.4.7.\n\nThe CP function may request at any time the UP function to activate or\ndeactivate a network resources usage measurement and the sending of\ncorresponding Usage Reports, using the Inactive Measurement flag of the\nMeasurement Information IE of the URR.\n\n  NOTE 6:  This can be used in a PGW-U for the PGW Pause of Charging\n         procedure (see 3GPP\u00a0TS\u00a023.401\u00a0[14]).\n\n\n"}, {"key": "Credit pooling (for EPC)", "numbering": "5.2.2.2.2", "title_level": 4, "desc": "5.2.2.2.2   Credit pooling (for EPC)\n\nFor EPC, when the Credit Pool feature is supported and the CP function\n(e.g. PGW-C) is instructed to handle a Credit Pool for a given Gy Session,\nthe CP function shall create a URR for the Credit Pool, and in this URR,\nthe CP function:\n\n  -  shall include one Aggregated URR ID IE per URR sharing the credit\n    pool, including the URR ID of the URR sharing the credit pool and the\n    associated Multiplier to measure the abstract service units the\n    corresponding traffic consumes from the credit pool;\n\n  -  shall set the Time or Volume Threshold or Quota IE to the value\n    calculated as specified in   IETF\u00a0RFC\u00a04006\u00a0[16] according to the\n    Measurement Method.\n\n    NOTE 1:  The value can be calculated using the following formula:\n\n       S = Q1*M1 + Q2*M2 + ... + Qn*Mn,\n           where the S is the quota for the credit pool, Qn is the quota\n           and Mn is the multiplier for each Rating Group (RG) which are\n           provided via the Multiple Services Credit Control from the OCS.\n           A URRn is defined for each of RG.\n\n    NOTE 2:  When the Measurement Method is set to the combined\n           volume/duration, the Time and Volume  Threshold or Quota are\n           calculated indepentently.\n\n  -  may set the Reporting Trigger to reporting upon reaching a volume or\n    time threshold or quota;\n\n  -  may set the Measurement Method to the data volume, duration (i.e.\n    time), combined volume/duration according to the Measurement Method set\n    in the URRs in the Credit Pool.\n\n    NOTE 3:  The UP function is instructed to handle a Credit Pool when a G-\n           S-U-Pool-Reference AVP is included within a Multiple Services\n           Credit Control from the OCS. A Credit Pool is identified by the\n           G-S-U-Pool-Identifier AVP. See subclause 6.3.11, 6.4.3 and 6.4.4\n           of 3GPP\u00a0TS\u00a032.299\u00a0[18].\n\nIn addition, the CP function shall also include the Linked URR IE, set to\nthe Credit Pool URR ID, in all the URRs which are sharing the credit pool\n(i.e. which are associatied with RGs sharing the Credit Pool).\n\n\n"}, {"key": "Reporting of Usage Report to the CP function", "numbering": "5.2.2.3", "title_level": 3, "desc": "5.2.2.3  Reporting of Usage Report to the CP function\n\n\n"}, {"key": "General", "numbering": "5.2.2.3.1", "title_level": 4, "desc": "5.2.2.3.1   General\n\nWhen detecting that a provisioned reporting trigger occurs, the UP function\nshall generate a Usage Report for the related URR and send it to the CP\nfunction by initiating the PFCP Session Report procedure.\n\nWhen providing usage report information for a URR in a message, the UP\nfunction shall include the UR-SEQN (Usage Report Sequence Number)\nidentifying the order in which a Usage Report is generated for the given\nURR. The UR-SEQN (Usage Report Sequence Number) shall be incremented for\nevery Usage Report generated by the UP function for the URR. The UP\nfunction shall also indicate the trigger that causes the usage report to be\ngenerated in the Usage Report Trigger IE.\n\nUpon generating a usage report for a URR towards the CP function, the UP\nfunction shall:\n\n  -  reset its ongoing measurement counts for the related URR (i.e. the UP\n    function shall report in a usage report the network resources usage\n    measurement since the last usage report for that URR);\n\n  -  re-apply the threshold provisioned for the related URR, if the usage\n    report was triggered due to a threshold being reached; and\n\n  -  continue to apply all the provisioned URR(s) and perform the related\n    network resources usage measurement(s), until getting any further\n    instruction from the CP function.\n\nWhen receiving a new threshold or quota from the CP function for a\nmeasurement that is already ongoing in the UP function, the UP function\nshall consider its ongoing measurements counts for the related URR against\nthe new threshold or quota to determine when to send its next usage report\nto the CP function.\n\n  NOTE 1:  The UP function determines when to send its next usage report to\n         the CP function by deducting from the newly provisioned threshold\n         or quota the traffic it has forwarded since its last usage report.\n         As an example, if the UP function has forwarded 10 Mbytes of\n         traffic since it last usage report to the CP function and the CP\n         function provisions a new volume threshold or quota of 100 Mbytes,\n         the UP function sends its next usage report upon forwarding an\n         additional 90 Mbytes traffic.\n\n  NOTE 2:  When receiving a new threshold or quota from the CP function for\n         a measurement that is already ongoing in the UP function and if the\n         UP function has already generated the usage report but had not sent\n         it, the UP function can send the usage report before performing the\n         update of the URR.\n\nWhen reporting the network resources usage before and after a Monitoring\nTime, the UP function shall send two Usage Reports in the PFCP message\n(e.g. PFCP Session Report Request) for the same URR ID. Each Usage Report\nshall then include the Usage Information IE indicating whether the reported\nnetwork resource usage was consumed before or after the Monitoring Time.\nOmission of this IE in a Usage Report indicates that no monitoring time has\noccurred. The UP function shall send Usage Reports soon after the\noccurrence of the Monitoring Time.\n\n  NOTE 3:  The UP function needs to take care to smooth the signalling load\n         towards the CP function if Usage Reports need to be generated for a\n         large number of PFCP sessions after the occurrence of the\n         Monitoring Time.\n\nFor the volume-based measurement method, the UP function shall report the\ntraffic usage after any QoS enforcement. Additionally, if the CP function\nrequested to measure the traffic usage before QoS enforcement, the UP\nfunction shall also report corresponding measurements, when measurements\nneeds to be reported for the traffic usage after QoS enforcement, by\nsending two Usage Reports in the PFCP message (e.g. PFCP Session Report\nRequest) for the same URR ID. Each Usage Report shall then include the\nUsage Information IE indicating whether the reported network resource usage\ncorresponds to the traffic before or after QoS enforcement. Thresholds\nprovisioned in a URR shall apply to the traffic usage after any QoS\nenforcement.\n\nFor the volume-based measurement method, the UP function shall include all\nthe counters (Total, Uplink and Downlink) of the URR in the Volume\nMeasurement IE in the Usage Report IE.\n\nA usage report triggered only due to the Dropped DL Traffic Threshold shall\nnot contain any measurement information.\n\nWhen being instructed to remove a URR or the last PDR associated to a URR,\nor to deactivate a network resources usage measurement via the Inactive\nMeasurement flag of the Measurement Information IE of the URR, the UP\nfunction shall include a Usage Report in the PFCP Session Modification\nResponse or in an additional PFCP Session Report Request if there are non-\nnull measurements to report for the URR, and shall reset its ongoing\nmeasurements for the URR that is removed, dissociated from the last PDR or\ndeactivated.\n\n  NOTE 4:  Multiple usage reports can be required to be reported to the CP\n         function when deleting a PDR that is the last one to be associated\n         to multiple URRs.\n\nThe CP function may request the UP function, in an PFCP Session\nModification Request, to report its ongoing network resources measurement\nfor one or multiple URRs of the PFCP session. In this case, the UP function\nshall:\n\n  -  generate usage report(s) (based on the existing definition of any\n    URR(s) included in the PFCP Session Modification Request message before\n    any update) for the URR(s) being queried and for any associated linked\n    usage reports (see subclause 5.2.2.4) for which there are non-null\n    measurements to report,\n\n  -  include them in the PFCP Session Modification Response or in\n    additional PFCP Session Report Request messages, and\n\n  -  proceed as specified above upon generating a usage report for a URR\n    towards the CP function.\n\n  NOTE 5:  It is up to the CP function to request the UP function to\n         generate an immediate report (or not) as specified above when the\n         CP function modifies a URR or any other rules of the PFCP session.\n         As an exception, the UP function always generates an immediate\n         report when being instructed to remove a URR or deactivate a\n         network resource measurement via the Inactive Measurement flag of\n         the Measurement Information IE of the URR.\n\nWhen additional PFCP Session Report Request messages need to be sent, the\nUP function shall indicate, either in the PFCP Session Modification\nResponse or in one PFCP Session Report Request, how many usage reports will\nbe sent in PFCP Session Report Request messages. If this is indicated in\none PFCP Session Report Request, the PFCP Session Modification Response\nshall indicate that more reports will follow by setting the AURI flag of\nthe Additional Usage Reports Information IE. Besides, if the PFCP Session\nModification Request included the Query URR Reference IE, usage reports\nsent in response to the query in the PFCP Session Modification Response\nand/or additional PFCP Session Report Request messages shall include the\nQuery URR Reference IE set to the same value as received in the PFCP\nSession Modification Request.\n\nWhen the reporting trigger \"Envelope Closure\" is set in the corresponding\nUsage Reporting Rule, the UP function shall generate a usage report with\nthe measurement of the time and/or volume as instructed in the Measurement\nMethod:\n\n  -  when the Inactivity Detection Time (if included) is expired;\n\n  -  when detecting no usage for the first Base Time Interval if the Base\n    Time Interval Type in the Time Quota Mechanism is set to CTP; or\n\n  -  at the end of each of base time interval if the Base Time Interval\n    Type in the Time Quota Mechanism is set to DTP.\n\n  NOTE 6:  Events (e.g. application detection information) are reported\n         individually and independently from the usage report sent for\n         envelope closure.\n\nAt the PFCP session termination, the UP function shall indicate to the CP\nfunction, in the PFCP Session Deletion Response, the resources that have\nbeen consumed for each URR that was provisioned in the PFCP session since\nthe last usage report (respective to each URR).\n\nUpon receiving the Usage Report from the UP function, the CP function may\ninitiate PFCP Session Modification procedure as result of the communication\nwith the PCRF or OCS, as described in subclause\u00a05.3 of 3GPP\u00a0TS\u00a023.214\u00a0[2],\ne.g. by:\n\n  -  modifying the URR (e.g. changing the Volume/Time threshold,\n    Volume/Time quota, disabling the usage monitoring);\n\n  -  creating a new FAR (e.g. for redirect) and/or modifying the existing\n    FAR; or\n\n  -  modifying the QER (s) in the PFCP session.\n\n\n"}, {"key": "Credit pooling", "numbering": "5.2.2.3.2", "title_level": 4, "desc": "5.2.2.3.2   Credit pooling\n\nWhen a URR is received with at least one Aggregated URRs IE included, the\nUP function:\n\n  -  shall calculate the traffic usage of the URR by applying the\n    Multiplier(s) and aggregating the traffic usage from all URRs indicated\n    in the Aggregated URRs IE(s), as specified in IETF RFC 4006 [16];\n\n    NOTE 1:  The usage of this URR is calculated using the following\n           formula:\n\n     C1*M1 + C2*M2 + ... + Cn*Mn = U,\n           where U is the usage counted by this URR, Cn is the usage\n           counted by each aggregated URR (i.e. URR for each RG sharing the\n           credit pool), and Mn is the multiplier for each aggregrated URR.\n\n  -  shall generate a report when the counted usage exceeds the threshold;\n\n  -  shall generate a report if the threshold is not provided, and stop\n    packets forwarding (or only allow forwarding of some limited user plane\n    traffic, based on operator policy in the UP function) for all\n    Aggregated URRs when the counted usage exceeds the quota.\n\n  NOTE 2:  The handling of the aggregated URR(s), e.g. generating a Usage\n         Report upon the Reporting Trigger(s) is not impacted by handling of\n         this URR for the Credit Pool.\n\n\n"}, {"key": "Reporting of Linked Usage Reports to the CP function", "numbering": "5.2.2.4", "title_level": 3, "desc": "5.2.2.4  Reporting of Linked Usage Reports to the CP function\n\nThe CP function may instruct the UP function to generate a Usage Report for\na URR \"X\" when a Usage Report is generated for another URR \"Y\", by:\n\n  -  provisioning the URR \"X\" with the Reporting Triggers IE set to Linked\n    Usage Reporting; and\n\n  -  including in the URR \"X\" the Linked URR ID IE set to the URR ID of the\n    URR \"Y\".\n\n  NOTE 1:  This can be used by the CP function e.g. to request the UP\n         function to report a Usage Report for an SDF (i.e. URR \"X\") when\n         the UP function reports a Usage Report for a bearer (i.e. URR \"Y\").\n\n  NOTE 2:  This can be used by the CP function e.g. to request the UP\n         function to report a Usage Report for a RG (i.e. URR \"X\") when the\n         UP function reports a Usage Report for a credit pool to which this\n         RG pertain (i.e. URR \"Y\").\n\nWhen a usage report is to be generated for the URR \"Y\", including when an\nimmediate usage report is requested for the URR \"Y\" within an PFCP Session\nModification Request, the UP function shall also send a Usage Report for\nthe URR \"X\" with the accumulated usage information, and the Usage Report\nTrigger IE set to Linked Usage Reporting.\n\nThe URR \"Y\" may be linked to more URRs than just URR \"X\".\n\nA RG level URR may be linked to IP-CAN bearer level URR as well as IP-CAN\nSession level URR to enable the CP function to generate a CDR on the\ndifferent level. In such case, a URR \"X\" may link to more URRs than just\nURR \"Y\".\n\n\n"}, {"key": "Forwarding Action Rule Handling", "numbering": "5.2.3", "title_level": 2, "desc": "5.2.3  Forwarding Action Rule Handling\n\n\n"}, {"key": "General", "numbering": "5.2.3.1", "title_level": 3, "desc": "5.2.3.1  General\n\nThe CP function shall provision one and only one FAR for each PDR\nprovisioned in an PFCP session. The FAR provides instructions to the UP\nfunction on how to process the packets matching the PDR.\n\nBy setting the appropriate flag(s) in the Apply Action IE in the FAR (see\nsubclause 8.2.26), the CP function may request the UP function to:\n\n  -  drop the packets, by setting the DROP flag;\n\n  -  forward the packets, by setting the FORW flag and by provisioning the\n    Forwarding Parameters providing instructions on how to forward the\n    packets;\n\n  -  buffer downlink packets by setting the BUFF flag and by optionally\n    provisioning buffering parameters providing instructions on how to\n    buffer the packets;\n\n  -  notify the CP function about the arrival of a first DL packet being\n    buffered, by setting the NOCP flag;\n\n  -  duplicate the packets, by setting the DUPL flag and by provisioning\n    the Duplicating Parameters providing instructions on how to forward the\n    duplicated packets.\n\nThe CP function may request the UP function to duplicate packets that are\nto be dropped, forwarded or buffered.\n\nThe CP function may provision one or more FAR(s) per PFCP session.\nDifferent FARs of a same PFCP session may be provisioned with a different\nApply Action flags, e.g. to enable the forwarding of downlink data packets\nfor some PDRs while requesting to buffer downlink data packets for other\nPDRs.\n\n  NOTE 1:  This is necessary to establish or release a partial set of radio\n         access bearers in UTRAN.\n\nWhen instructed to buffer and notify the CP function about the arrival of a\nDL packet, the UP function shall notify the CP function, when it receives a\nfirst downlink packet for a given FAR, by sending an PFCP Session Report\nRequest including a Downlink Data Report IE identifying the PDR(s) for\nwhich downlink packets have been received.\n\n  NOTE 2:  Receipt of downlink packets on PDRs associated to different FARs\n         can result in sending multiple PFCP Session Report Request messages\n         for the same PFCP session.\n\nIf the UP function indicated support of Header Enrichment of UL traffic\n(see subclause 8.2.25), the CP function may provide the UP function with\nheader enrichment information for uplink traffic, by including one or more\nHeader Enrichment IE(s) in the FAR. In this case, the UP function should\nuse this information to enrich the header of the uplink traffic (e.g. HTTP\nheader enrichment).\n\n  NOTE 3:  It is not defined how to support SGi PtP tunnelling mechanisms\n         other than based on UDP/IP encapsulation (such as PMIPv6/GRE, L2TP,\n         GTP-C/U, see subclause 4.3.17.8.3.3.3 of 3GPP\u00a0TS\u00a023.401\u00a0[14]) for\n         Non-IP PDN connections.\n\nIf the UP function indicated support of PDI optimisation (see subclause\n8.2.25), the CP function may include in the forwarding parameters of the\nFAR the Linked Traffic Endpoint ID, if it is available, identifying the\ntraffic Endpoint allocated for this PFCP session to receive the traffic in\nthe reverse direction.\n\n  NOTE 4:  This information can enable an SGW-U or PGW-U to correlate the\n         UL and DL traffic (i.e. PDRs) sent over a same bearer.\n\nAssuming for instance an PFCP session provisioned in a PGW-U with:\n\n  -  an UL PDR 1 (for an S5/S8 bearer 1) with Source Interface \"Access\"\n    associated to an UL Traffic Endpoint ID \"1\" (comprising the IP address,\n    a local TEID and optionally a network instance),\n\n  -  a DL PDR 1 with Source Interface \"Core\", UE IP address and SDF 1,\n\nthe CP function sets the Linked Traffic Endpoint in the DL FAR 1\n(associated to DL PDR 1) to the UL Traffic Endpoint \"1\", which allows the\nPGW-U to correlate the uplink and downlink PDRs for the same bearer (i.e.\nthat UL PDR 1 associated to UL Traffic Endpoint \"1\", and DL PDR1 associated\nto DL FAR 1 with Linked Traffic Endpoint set to UL Traffic Endpoint \"1\",\nuse the same S5/S8 bearer).\n\n  NOTE 5:  The Linked Traffic Endpoint can possibly refer to a Traffic\n         Endpoint in the reverse direction requested to be created  in the\n         same PFCP request.\n\n\n"}, {"key": "Buffering Action Rule Handling", "numbering": "5.2.4", "title_level": 2, "desc": "5.2.4  Buffering Action Rule Handling\n\n\n"}, {"key": "General", "numbering": "5.2.4.1", "title_level": 3, "desc": "5.2.4.1  General\n\nA BAR provides instructions to control the buffering behaviour of the UP\nfunction for all the FARs of the PFCP session set with an Apply Action\nparameter requesting the packets to be buffered and associated to this BAR.\n\nThe CP function may create a BAR for an PFCP session and associate it to\nthe FAR(s) of the PFCP session in an PFCP Session Establishment Request or\nan PFCP Session Modification Request to request the UP function to apply a\nspecific buffering behaviour for packets requested to be buffered and\nassociated to this BAR.\n\nThe CP function may modify the following buffering instructions provided in\na BAR as follows:\n\n  -  the Downlink Data Notification Delay in an PFCP Session Modification\n    Request; or\n\n  -  the Downlink Data Notification Delay, DL Buffering Duration and/or DL\n    Buffering Suggested Packet Count in an PFCP Session Report Response\n    message.\n\n  NOTE:  The CP function needs to provision a (possibly empty) BAR and\n         associate it to the FARs of the PFCP session when establishing or\n         modifying the PFCP session to be able to modify the BAR in an PFCP\n         Session Report Response.\n\nIf the UP Function has indicated support of the feature UL/DL Buffering\nControl (UDBC), the CP function may provide the Suggested Buffering Packet\nCount IE in a BAR which is created during a PFCP Session Establishment\nprocedure or a PFCP Session Modification procedure, and the CP function may\nmodify it in a subsequent PFCP Session Modification Request, and/or a PFCP\nSession Report Response message. The same BAR may be associated with all\nthe FARs in a PFCP session to indicate that all Service Data Flows in the\nPFCP Session share the same buffer in the UP function for the PFCP Session.\n\nIn this release of the specification, at most one BAR may be created per\nPFCP session.\n\n\n"}, {"key": "Provisioning of Buffering Action Rule in the UP function", "numbering": "5.2.4.2", "title_level": 3, "desc": "5.2.4.2  Provisioning of Buffering Action Rule in the UP function\n\nThe CP function may provision the following buffering parameters in a BAR:\n\n  -  the Downlink Data Notification Delay IE, to request the UP function to\n    delay the sending of an PFCP Session Report Request, between receiving\n    a downlink data packet and notifying the CP function about it, if the\n    UP function indicated support of the Downlink Data Notification Delay\n    parameter (see subclause 8.2.28);\n\n  -  the DL Buffering Duration IE, to request the UP function to buffer the\n    downlink data packet for an extended duration without sending any\n    further notification to the CP function about the arrival of DL data\n    packets, if the UP function indicated support of the DL Buffering\n    Duration parameter (see subclause 8.2.25);\n\n  -  the DL Buffering Suggested Packet Count, to request the UP function to\n    buffer the suggested number of downlink data packets, when extended\n    buffering of downlink data packet is required in the UP function.\n\n  -  the Suggested Buffering Packet Count IE if the UP Function has\n    indicated support of the feature UDBC, to indicate the number of\n    packets (including both uplink or downlink) that the CP function\n    suggests to be buffered in the UP function, until it receives new\n    instructions from the CP function, e.g. when the new Quota is granted.\n\nThe UP function shall stop applying the DL Buffering Duration and DL\nBuffering Suggested Packet Count parameters and shall delete these\nparameters from the BAR (without explicit request from the CP function)\nwhen extended buffering of downlink data packets ends in the UP function.\n\n  NOTE:  The CP function will provide the DL Buffering Duration and DL\n         Buffering Suggested Packet Count parameters again when re-invoking\n         extended buffering of downlink data packets.\n\nThe UP function shall stop applying buffering when new instruction is\nreceived from the CP function. The buffered packets shall be either dropped\nor forwarded following the packet forwarding model specified in clause\n5.2.1 and taking into consideration that the buffered Packets have been\nalready processed earlier.\n\n\n"}, {"key": "QoS Enforcement Rule Handling", "numbering": "5.2.5", "title_level": 2, "desc": "5.2.5  QoS Enforcement Rule Handling\n\n\n"}, {"key": "General", "numbering": "5.2.5.1", "title_level": 3, "desc": "5.2.5.1  General\n\nThe CP function shall provision QER(s) for an PFCP session in an PFCP\nSession Establishment Request or an PFCP Session Modification Request to\nrequest the UP function to perform QoS enforcement of the user plane\ntraffic.\n\n\n"}, {"key": "Provisioning of QoS Enforcement Rule in the UP function", "numbering": "5.2.5.2", "title_level": 3, "desc": "5.2.5.2  Provisioning of QoS Enforcement Rule in the UP function\n\nThe CP function may request the UP function to perform the following QoS\nenforcement actions in a QER:\n\n  -  Gating Control, as specified in subclause 5.4.3;\n\n  -  QoS Control, i.e. MBR, GBR or Packet Rate enforcement, as specified in\n    subclause 5.4.4;\n\n  -  DL flow level marking for application detection, as specified in\n    subclause 5.4.5;\n\n  -  SCI (Service Class Indicator) marking for service identification for\n    improved radio utilisation for GERAN, as specified in subclause 5.4.12;\n\n  -  for 5GC reflective QoS for uplink traffic.\n\n\n"}, {"key": "Combined SGW/PGW Architecture", "numbering": "5.2.6", "title_level": 2, "desc": "5.2.6  Combined SGW/PGW Architecture\n\nThe usage of a combined SGW/PGW remains possible in a deployment with\nseparated control and user planes, see subclause\u00a04.2.2 of\n3GPP\u00a0TS\u00a023.214\u00a0[2]. This is enabled by supporting a combined Sxa/Sxb\ninterface with a common packet forwarding model, message and parameter\nstructure for non-combined and combined cases.\n\nThe following additional requirements shall apply to a combined Sxa/Sxb\ninterface between a combined SGW/PGW-C and a combined SGW/PGW-U:\n\n  -  all the functionalities specified for Sxa and Sxb shall be supported,\n    possibly concurrently, over a combined Sxa/Sxb association;\n\n  -  a single PFCP session may be setup to support both the functionalities\n    of an SGW-U and PGW-U;\n\n  -  the CP function may provision PDRs, QERs, URRs, FARs (possibly with a\n    buffering instruction) and BAR, possibly concurrently, for the same\n    PFCP session;\n\n  -  the CP function may provision concurrently parameters in a message or\n    for the PFCP session that are applicable to Sxa and Sxb.\n\n\n"}, {"key": "Data Forwarding between the CP and UP Functions", "numbering": "5.3", "title_level": 1, "desc": "5.3  Data Forwarding between the CP and UP Functions\n\n\n"}, {"key": "General", "numbering": "5.3.1", "title_level": 2, "desc": "5.3.1  General\n\n  Editor's Note:  5GC specific dataforwarding description to be added.\n\nForwarding of user plane data between the CP and UP functions may take\nplace as part of the following scenarios (see 3GPP\u00a0TS\u00a023.214\u00a0[2]).\n\n  Table 5.3.1-1: Data forwarding scenarios between the CP and UP functions\n\n|   |Scenario description          |Data forwarding      |Applicabl|\n|   |                              |direction            |e to     |\n|1  |Forwarding of user-plane      |UP to CP function    |PGW      |\n|   |packets between the UE and the|CP to UP function    |         |\n|   |CP function.                  |                     |         |\n|2  |Forwarding of packets between |UP to CP function    |PGW      |\n|   |the CP function and the       |CP to UP function    |         |\n|   |external PDN / Sgi.           |                     |         |\n|3  |Forwarding of packets subject |UP to CP function    |SGW      |\n|   |to buffering in the CP        |CP to UP function    |         |\n|   |function.                     |                     |         |\n|4  |Forwarding of End Marker      |CP to UP function    |SGW, PGW |\n|   |Packets constructed by the CP |                     |         |\n|   |function to a downstream node.|                     |         |\n\n\nUser plane packets shall be forwarded between the CP and UP functions by\nencapsulating the user plane packets using GTP-U encapsulation (see\n3GPP\u00a0TS\u00a029.281\u00a0[3]).\n\nFor forwarding data from the UP function to the CP function, the CP\nfunction shall provision PDR(s) per PFCP session context, with the PDI\nidentifying the user plane traffic to forward to the CP function and with a\nFAR set with the Destination Interface \"CP function side\" and set to\nperform GTP-U encapsulation and to forward the packets to a GTP-u F-TEID\nuniquely assigned in the CP function per PFCP session and PDR. The CP\nfunction shall then identify the PDN connection and the bearer to which the\nforwarded data belongs by the F-TEID in the header of the encapsulating GTP-\nU packet.\n\nFor forwarding data from the CP function to the UP function, the CP\nfunction shall provision one or more PDR(s) per PFCP session context, with\nthe PDI set with the Source Interface \"CP function side\" and identifying\nthe GTP-u F-TEID uniquely assigned in the UP function per PDR, and with a\nFAR set to perform GTP-U decapsulation and to forward the packets to the\nintended destination. URRs and QERs may also be configured.\n\nPFCP session contexts may correspond to individual PDN connections, TDF\nsessions, or standalone sessions not tied to any PDN connection or TDF\nsession used e.g. for forwarding RADIUS, Diameter or DHCP signalling\nbetween the PGW-C and the PDN or for forwarding End Marker packets from the\nPGW-C or SGW-C to a downstream SGW-U or eNodeB.\n\nThe CP function may establish one Sx-u tunnel per:\n\n  -  bearer of PDN connection e.g. for the data forwarding scenarios 1 and\n    3;\n\n  -  UP function or PDN e.g. for the data forwarding scenario 1, 2 and 4.\n\nRequirements for forwarding packets subject to buffering in the CP function\nbetween the UP and CP functions (scenario\u00a03) are further specified in\nsubclause 5.3.3.\n\nRequirements for sending End Marker packets (scenario 4) are further\nspecified in subclause 5.3.2.\n\n\n"}, {"key": "Sending of End Marker Packets", "numbering": "5.3.2", "title_level": 2, "desc": "5.3.2  Sending of End Marker Packets\n\n  Editor's Note:  Sending of End Marker Packets in 5GC is FFS.\n\nThe construction of End Marker packets may either be done in the CP\nfunction or UP function, based on network configuration, as specified in\nsubclause\u00a05.8 of 3GPP\u00a0TS\u00a023.214\u00a0[2]. The support of End Marker packets by\nthe UP function is optional.\n\nIf the UP function indicated support of End Marker packets constructed in\nthe UP function, the CP function shall request the UP function to construct\nand send End Marker packets by sending a Session Modification Request\nincluding FAR(s) with the new downstream F-TEID and with the SNDEM (Send\nEnd Marker Packets) flag set.\n\nFor End Marker packets constructed in the CP function, the CP function\nshall:\n\n  -  establish (once) one standalone PFCP session not tied to any PDN\n    connection, per the UP function, for forwarding End Marker packets, and\n    provision the UP function to perform one GTP-U decapsulation and to\n    forward the resulting packets without any further change towards the\n    destination IP address of these packets;\n\n  -  construct the GTP-U End Marker packets, with the destination IP\n    address and TEID set according to the old F-TEID value, and with a\n    source IP address set according to the UP function's F-TEID value (e.g.\n    S1 or Iu SGW F-TEID);\n\n  -  encapsulate the constructed GTP-U End Marker packets in GTP-U packets\n    according to the principles specified in subclause 5.3.1 for data\n    forwarding between the CP function and the UP function, and send them\n    towards the F-TEID assigned in the UP function for the above PFCP\n    session, after receipt of the PFCP Session Modification Response\n    indicating that the UP function has switched to a new F-TEID.\n\nUpon receipt of an PFCP Session Modification Request modifying the F-TEID\nin the Outer Header Creation of a FAR, the UP function shall send the\nResponse message only after having switched to the new F-TEID.\n\n\n"}, {"key": "Forwarding of Packets Subject to Buffering in the CP Function", "numbering": "5.3.3", "title_level": 2, "desc": "5.3.3  Forwarding of Packets Subject to Buffering in the CP Function\n\n\n"}, {"key": "General", "numbering": "5.3.3.1", "title_level": 3, "desc": "5.3.3.1  General\n\nThe following requirements shall apply to the data forwarding scenario 3 of\nTable 5.3.1-1 in addition to the requirements specified in subclause 5.3.1.\n\nThe CP function shall establish one Sx-u tunnel per bearer of a PDN\nconnection when applying the data forwarding scenario 3.\n\n  Editor's Note: Forwarding of Packets from the UPF to the SMF in 5GC is\n         FFS.\n\n\n"}, {"key": "Forwarding of Packets from the UP Function to the CP Function", "numbering": "5.3.3.2", "title_level": 3, "desc": "5.3.3.2  Forwarding of Packets from the UP Function to the CP Function\n\nRegardless of whether the downlink traffic received by the UP function\nconsists of T-PDUs (i.e. user data packet, see 3GPP\u00a0TS\u00a029.281\u00a0[3]) for a\ncombined SGW/PGW-U, or G-PDUs (i.e. T-PDU plus a GTP-U header) for a SGW-U,\nthe downlink traffic shall be forwarded from the UP function to the CP\nfunction as G-PDUs with the GTP-U header set to the IP address and TEID\nuniquely assigned in the CP function for the Sx-u tunnel corresponding to\nthe bearer of the PDN connection.\n\n  NOTE 1:  An SGW-U receiving G-PDUs from an S5/S8 bearer forwards the same\n         G-PDUs towards the SGW-C but with the IP address and TEID in the\n         GTP-U header changed to the SGW-C IP address and TEID of the\n         corresponding Sx-u tunnel.\n\nTo forward the user plane data to be buffered in the CP function from the\nUP function, the CP function shall provision:\n\n  -  a PDR per bearer of the PDN connection, matching the received downlink\n    user plane packets and for a (non-combined) SGW-U, with the field Outer\n    Header Removal Description in the Outer Header Removal IE set to \"0\" or\n    \"1\" for IPv4 or IPv6 respectively;\n\n  -  a FAR instructing the UP function to forward the received downlink\n    data to the CP function, with the field Outer Header Creation\n    Description in the Outer Header Creation set to \"0\" or \"1\".\n\n  NOTE 2:  The PDR can be provisioned in the UP function before applying\n         data forwarding to the CP function.\n\nG-PDUs sent from the UP function to the CP function over the Sx-u tunnel\nshall include any GTP-U extension header(s):\n\n  -  possibly received by the UP function over the S5/S8 bearers and stored\n    during the Outer Header Removal;\n\n  -  possibly created by the UP function as part of a QER rule.\n\n\n"}, {"key": "Forwarding of Packets from the CP Function to the UP Function", "numbering": "5.3.3.3", "title_level": 3, "desc": "5.3.3.3  Forwarding of Packets from the CP Function to the UP Function\n\nLikewise, when subsequently sending the downlink traffic buffered in the CP\nfunction back to the UP function, the downlink traffic shall be forwarded\nover Sx-u as G-PDUs with the GTP-U header set to the IP address and TEID\nuniquely assigned in the UP function for the Sx-u tunnel set up for the\ncorresponding bearer of the PDN connection.\n\nG-PDUs sent over Sx-u shall include GTP-U extension header(s) possibly\nreceived earlier from the UP function.\n\nTo forward the user plane data from the CP function to the UP function, the\nCP function shall provision:\n\n     a PDR per bearer of the PDN connection, with an IP address and TEID\n    uniquely assigned in the UP function for the Sx-u tunnel, and with the\n    field Outer Header Removal Description in the Outer Header Removal IE\n    set to \"0\" or \"1\";\n\n  -  a FAR enabling the UP function to forward the received downlink data\n    from the CP function towards the RAN, with the field Outer Header\n    Creation Description in the Outer Header Creation set to \"0\" or \"1\".\n\nG-PDUs sent from the UP function towards the RAN shall include GTP-U\nextension header(s) possibly received from the CP function.\n\n\n"}, {"key": "Data Forwarding between the CP and UP Functions with one PFCP-u", "numbering": "5.3.4", "title_level": 2, "desc": "5.3.4  Data Forwarding between the CP and UP Functions with one PFCP-u\n         Tunnel per UP Function or PDN\n\n\n"}, {"key": "General", "numbering": "5.3.4.1", "title_level": 3, "desc": "5.3.4.1  General\n\nThe following requirements shall apply to the data forwarding scenario 1\nand 2 of Table 5.3.1-1, when establishing one PFCP-u tunnel per UP function\nor PDN, in addition to the requirements specified in subclause 5.3.1.\n\n  Editor's Note: Data forwarding between CP and UP Functions with one N4-u\n         Tunnel per UP Function or PDN in 5GC is FFS.\n\n\n"}, {"key": "Forwarding of Packets from the UP Function to the CP Function", "numbering": "5.3.4.2", "title_level": 3, "desc": "5.3.4.2  Forwarding of Packets from the UP Function to the CP Function\n\nRegardless of whether the traffic received by the UP function consists of T-\nPDUs (i.e. user data packet, see 3GPP\u00a0TS\u00a029.281 [3]) from SGi or G-PDUs\n(i.e. T-PDU plus a GTP-U header) from the UE, the traffic shall be\nforwarded from the UP function to the CP function as G-PDUs with the GTP-U\nheader set to the IP address and TEID uniquely assigned in the CP function\nfor the PFCP-u tunnel corresponding to the UP function or PDN.\n\nTo forward the user plane data to from the UP function, the CP function\nshall provision:\n\n  -  a PDR per UP function or PDN, matching the received user plane packets\n    and for uplink traffic, optionally with the field Outer Header Removal\n    Description in the Outer Header Removal IE set to \"0\" or \"1\" for IPv4\n    or IPv6 respectively;\n\n  -  a FAR instructing the UP function to forward the received data to the\n    CP function, with the field Outer Header Creation Description in the\n    Outer Header Creation set to \"0\" or \"1\".\n\n  NOTE 2:  The PDR can be provisioned in the UP function before applying\n         data forwarding to the CP function e.g. immediately after the PFCP\n         Association Setup procedure.\n\n\n"}, {"key": "Forwarding of Packets from the CP Function to the UP Function", "numbering": "5.3.4.3", "title_level": 3, "desc": "5.3.4.3  Forwarding of Packets from the CP Function to the UP Function\n\nWhen sending user plane data from the CP function, the traffic shall be\nforwarded over PFCP-u as:\n\n  -  T-PDUs encapsulated in GTP-U with the GTP-U header set to the IP\n    address and TEID uniquely assigned in the UP function for the PFCP-u\n    tunnel set up for the UP function or PDN for traffic to be sent towards\n    SGi, or\n\n  -  G-PDUs encapsulated in GTP-U with the outer GTP-U header set to the IP\n    address and TEID uniquely assigned in the UP function for the PFCP-u\n    tunnel set up for the UP function and with the inner GTP-U header set\n    to the F-TEID assigned by the downstreams GTP-U peer (e.g. SGW) to the\n    bearer over which the data shall be sent.\n\nTo forward the user plane data from the CP function to the UP function, the\nCP function shall provision:\n\n     a PDR per UP function, with an IP address and TEID uniquely assigned\n    in the UP function for the PFCP-u tunnel, and with the field Outer\n    Header Removal Description in the Outer Header Removal IE set to \"0\" or\n    \"1\";\n\n  -  a FAR enabling the UP function to forward the received data from the\n    CP function.\n\n\n"}, {"key": "Policy and Charging Control", "numbering": "5.4", "title_level": 1, "desc": "5.4  Policy and Charging Control\n\n\n"}, {"key": "General", "numbering": "5.4.1", "title_level": 2, "desc": "5.4.1  General\n\nThis subclause describe how Policy and Charging Control requirements are\nsupported over the Sxa, Sxb and Sxc reference points.\n\n  Editor's Note: Policy and Charging Control requirements in 5GC is FFS.\n\n\n"}, {"key": "Service Detection and Bearer Binding", "numbering": "5.4.2", "title_level": 2, "desc": "5.4.2  Service Detection and Bearer Binding\n\nService detection refers to the process that identifies the packets\nbelonging to a service data flow or application. See subclauses\u00a06.2.2.2 and\n6.8.1 of 3GPP\u00a0TS\u00a023.203\u00a0[7].\n\nBearer binding is the procedure that associates service data flow(s) to an\nIP-CAN bearer deemed to transport the service data flow. UL bearer binding\nverification refers to the process of discarding uplink packets due to no\nmatching service data flow template for the uplink direction. See\nsubclauses\u00a06.1.1.4 and 6.2.2.2 of 3GPP\u00a0TS\u00a023.203\u00a0[7].\n\nService detection is controlled over the Sxa, Sxb and Sxc reference points\nby configuring Packet Detection Information in PDRs to match the intended\nservice data flows or application.\n\nThe mapping of DL traffic to bearers is achieved by configuring and\nassociating FARs to the downlink PDRs, with FARs set to forward the packets\nto the appropriate downstream bearers (S5/S8 or S1/S12/S4/Iu).\n\nUplink bearer binding verification is achieved by configuring Packet\nDetection Information in uplink PDRs containing the local F-TEID of the\nuplink bearer, the UE IP address (source IP address to match for the\nincoming packet), and the SDF filter(s) or the Application ID. As a result,\nuplink packets received on the uplink bearer but that do not match the SDF\nfilter(s) or Application detection filter associated to the uplink PDRs are\ndiscarded.\n\n    NOTE 1:  For PCC Rules that contain an application identifier (i.e.\n           that refer to an application detection filter), uplink traffic\n           can be received on other IP-CAN bearers than the one determined\n           by the binding mechanism. The detection of the uplink part of\n           the service data flow can be activated in parallel on other\n           bearers with non-GBR QCI (e.g. the default bearer) in addition\n           to the bearer where the PCC rule is bound to. See subclauses\n           6.1.1.1 and 6.2.2.2 of 3GPP\u00a0TS\u00a023.203\u00a0[7]. Therefore the uplink\n           PDRs for these bearers can be provisioned with the PDI\n           containing this service data flow and the local F-TEID of the\n           uplink bearer.\n\n    NOTE 2:  To avoid the PGW-U discarding packets due to no matching\n           service data flow template, the operator can apply open PCC\n           rules (with wildcarded SDF filters) to allow for the passage of\n           packets that do not match any other candidate SDF template.\n           Therefore an uplink PDR can be provisioned with the PDI\n           containing only the local F-TEID of the uplink bearer.\n\n    NOTE 3:  Uplink bearer binding does not apply to Non-IP PDN\n           connections.\n\n\n"}, {"key": "Gating Control", "numbering": "5.4.3", "title_level": 2, "desc": "5.4.3  Gating Control\n\nGating control refers to the process within the PGW-U and TDF-U of enabling\nor disabling the forwarding of IP packets, belonging to a service data flow\nor detected application's traffic, to pass through to the desired endpoint\n(see subclause 4.3.2 of 3GPP\u00a0TS\u00a023.203\u00a0[7]).\n\nThe PGW-C and TDF-C controls the gating in the PGW-U and TDF-U by creating\nPDR(s) for the service data flow(s) or application's traffic to be\ndetected, and by associating a QER, including the Gate Status IE, to the\nPDRs.\n\nThe Gate Status IE indicates whether the service data flow or detected\napplication traffic is allowed to be forwarded (the gate is open) or shall\nbe discarded (the gate is closed) in the uplink and/or in downlink\ndirections.\n\nThe PGW-U and TDF-U shall identify UL and DL flows by the Source Interface\nIE in the PDI of the PDRs or the Destination Interface IE in the FARs. The\nPGW-U and TDF-U shall apply UL and DL gating accordingly.\n\n\n"}, {"key": "QoS Control", "numbering": "5.4.4", "title_level": 2, "desc": "5.4.4  QoS Control\n\nQoS control refers to the authorization and enforcement of the maximum QoS\nthat is authorized:\n\n  -  at the session level (APN-AMBR, TDF session UL and DL bitrates, or UL\n    and DL Packet Rate of a PDN connection);\n\n  -  at the bearer level (GBR, MBR for GBR bearers);\n\n  -  at the QoS Flow level (for 5GC);\n\n  -  at the service data flow (SDF) or application level.\n\nSee subclause 4.3.3 of 3GPP\u00a0TS\u00a023.203\u00a0[7] subclause\u00a04.5.5 of\n3GPP\u00a0TS\u00a029.212\u00a0[8] and subclause\u00a04.7.7 of 3GPP\u00a0TS\u00a023.401\u00a0[14].\n\nThe CP function shall control the QoS enforcement in the UP function by:\n\n  -  creating the necessary PDR(s) to represent the service data flow,\n    application, QoS Flow (for 5GC), bearer or session, if not already\n    existing;\n\n  -  creating QERs for the QoS enforcement at session level,\n    SDF/application level;\n\n  -  creating QERs for the QoS enforcement of the aggregate of SDFs with\n    the same GBR QCI;\n\n  -  creating QERs for the QoS enforcement of the aggregate of SDFs with\n    the same GBR QFI (for 5GC);\n\n  -  associating the session level QER to all the PDRs defined for the\n    session;\n\n  -  associating the SDF or application QER to the PDRs associated to the\n    SDF or application;\n\n  -  associating the QER of the aggregate of SDFs to the PDRs associated to\n    SDFs or applications that share the QER.\n\nThe same QER may be associated to UL and DL PDRs. The UP function shall\nidentify the UL and DL flows by the Source Interface IE in the PDRs or the\nDestination Interface IE in the FARs. The UP function shall enforce the QoS\nfor the UL or DL flows accordingly.\n\nThe CP function shall map the precedence of a PCC rule to the precedence of\nthe PDRs associated to the corresponding service data flows.\n\n\n"}, {"key": "DL Flow Level Marking for Application Detection", "numbering": "5.4.5", "title_level": 2, "desc": "5.4.5  DL Flow Level Marking for Application Detection\n\nDL flow level marking is performed using DL DSCP marking. DL DSCP marking\nfor application indication refers to the process in the TDF of marking\ndetected downlink application traffic with a DSCP value received within an\ninstalled ADC rule matching this traffic. See Annex U of 3GPP\u00a0TS\u00a023.203\u00a0[7]\nand subclauses 4.5.2.7 and 4b.5.14 of 3GPP\u00a0TS\u00a029.212\u00a0[8].\n\nDL DSCP marking for application indication is controlled by the TDF-C by\nassociating a QER, including the ToS or Traffic Class within the DL Flow\nLevel Marking IE, to the PDR matching the DL traffic to be marked. The TDF-\nU performs the DL DSCP marking for the detected DL traffic and sends the\nmarked packet to the PGW-U.\n\nIf a tunnelling protocol is used between the TDF-U and the PGW-U, the DSCP\nvalue for service data flow detection shall be carried in the inner IP\nheader.\n\nThe TDF-C may stop the DL DSCP marking for the application during the PFCP\nsession by removing the related QER or removing the DL Flow Level Marking\nIE from the related QER, the TDF-U shall then stop such function\nconsequently.\n\nPolicy and charging control in the downlink direction by the PCEF for an\napplication detected by the TDF is performed by the PGW-C configuring a PDR\nwith a PDI containing an SDF Filter with the corresponding DSCP value.\n\n\n"}, {"key": "Usage Monitoring", "numbering": "5.4.6", "title_level": 2, "desc": "5.4.6  Usage Monitoring\n\nUsage Monitoring Control refers to the process of monitoring the user plane\ntraffic in the PGW-U or TDF-U for the accumulated usage of network\nresources per:\n\n  -  individual or group of service data flows;\n\n  -  individual or group of applications;\n\n  -  IP-CAN session, possibly excluding an individual SDF or a group of\n    service data flow(s), and/or\n\n  -  TDF session, possibly excluding an individual application or a group\n    of application(s).\n\nSee subclauses 4.4, 6.2.2.3 and 6.6 of 3GPP\u00a0TS\u00a023.203\u00a0[7] and subclauses\n4.5.16, 4.5.17, 4b.5.6, 4b.5.7 of 3GPP\u00a0TS\u00a029.212\u00a0[8].\n\nUsage Monitoring Control is supported over the Sxb and Sxc reference points\nby activating in the UP function the reporting of usage information towards\nthe CP function, as specified in subclauses 5.3 and 7.8.4 of\n3GPP\u00a0TS\u00a023.214\u00a0[2].\n\nThe CP function shall control the Usage Reporting in the UP function by:\n\n  -  creating the necessary PDR(s) to represent the service data flow,\n    application or session;\n\n  -  creating a URR for each Monitoring key; and\n\n  -  associating the URR to:\n\n    -  all the PDRs of the PFCP session, for usage monitoring at IP-CAN or\n       TDF session level, possibly excluding the PDRs matching the SDFs or\n       Applications excluded from the usage monitoring at session level; or\n\n    -  the PDR(s) of the PFCP session associated to the individual or group\n       of SDF(s) or Application(s), for usage monitoring at SDF or\n       application level.\n\n\n"}, {"key": "Traffic Redirection", "numbering": "5.4.7", "title_level": 2, "desc": "5.4.7  Traffic Redirection\n\nTraffic Redirection refers to the process of redirecting uplink application\ntraffic, in a PGW or TDF, towards a redirect destination, e.g. redirect\nsome HTTP flows to a service provisioning page. See subclause 6.1.13 of\n3GPP\u00a0TS\u00a023.203\u00a0[7] and subclauses 4.5.2.6 and 4b.5.1.4 of\n3GPP\u00a0TS\u00a029.212\u00a0[8].\n\nThe redirect destination may be provided by the PCRF or be preconfigured in\nthe CP function or in the UP function.\n\nThe traffic redirection may be enforced in the CP function or in the UP\nfunction. If the traffic that the UP function can support may be subject to\ntraffic redirection, traffic redirection enforcement in the UP function\nshall be supported by the UP function. The UP function reports to the CP\nfunction whether it supports traffic redirection enforcement in the UP\nfunction via the UP Function Features IE (see subclause 8.2.25).\n\n  NOTE:  A UP function that supports traffic not requiring traffic\n         redirection does not need to support traffic redirection\n         enforcement in the UP function. The CP function can select a UP\n         function supporting traffic redirection enforcement in the UP\n         function for users or services which may require traffic\n         redirection.\n\nTo enforce the traffic redirection in the CP function, the CP function\nshall instruct the UP function to forward the applicable user traffic to\nthe CP function, as specified in subclause 5.3.1.\n\nTo enforce the traffic redirection in the UP function, the CP function\nshall:\n\n  -  create the necessary PDR(s) to represent the traffic to be redirected,\n    if not already existing;\n\n  -  create a FAR with:\n\n    -  the Redirect Information IE including the redirect destination, if\n       the traffic needs to be redirected towards a redirect destination\n       provided by the CP function; a redirect destination provided by the\n       CP function shall prevail over a redirect destination preconfigured\n       in the UP function; or\n\n    -  the Forwarding Policy IE including the identifier of the forwarding\n       policy to apply, if the traffic needs to be redirected towards a\n       redirect destination preconfigured in the UP function;\n\n  -  associate the FAR to the above PDRs of the PFCP session.\n\n\n"}, {"key": "Traffic Steering", "numbering": "5.4.8", "title_level": 2, "desc": "5.4.8  Traffic Steering\n\nTraffic Steering refers to the process of applying a specific (S)Gi-LAN\ntraffic steering policy in the PCEF or TDF (or TSSF), for the purpose of\nsteering the subscriber's traffic to appropriate operator or 3rd party\nservice functions (e.g. NAT, antimalware, parental control, DDoS\nprotection) in the (S)Gi-LAN, per service data flows level or applications\nlevel.\n\nThe UP function shall set the TRST feature flag in the UP Function Features\nIE if it supports Traffic Steering (see subclause 8.2.25).\n\nTraffic Steering is supported over the Sxb and Sxc reference points by\ninstructing the UP function to apply a specific Forwarding Policy, that is\nlocally configured in the UP function and that can be used for the uplink,\nthe downlink or for both directions. A Forwarding Policy is identified by a\nForwarding Policy Identifier.\n\nWhen so instructed, the UP function shall perform the necessary actions to\nenforce the forwarding policy referenced by the CP function, e.g.\nperforming packet marking and routing the traffic towards the service\nfunctions within the (S)Gi-LAN.\n\nSee 3GPP\u00a0TS\u00a023.203\u00a0[7] and 3GPP\u00a0TS\u00a029.212\u00a0[8].\n\nThe CP function shall control Traffic Steering towards SGi-LAN in the UP\nfunction by:\n\n  -  creating the necessary PDRs to represent the service data flows or\n    applications to be steered towards SGi-LAN;\n\n  -  creating a FAR with the Forwarding Policy IE including the Forwarding\n    Policy Identifier set to the Traffic Steering Policy Identifier; and\n\n  -  associating the FAR to the above PDRs of the PFCP session.\n\nThe CP function shall control the processing of the traffic received from\nthe (S)Gi-LAN in the UP function as specified in the rest of this\nspecification for traffic received from any other interface, but with\nPDR(s) including a PDI with the Source Interface indicating \"SGi-LAN\". The\nUP function shall distinguish packets coming from (S)Gi-LAN based on local\nconfiguration.\n\n\n"}, {"key": "Provisioning of Predefined PCC/ADC Rules", "numbering": "5.4.9", "title_level": 2, "desc": "5.4.9  Provisioning of Predefined PCC/ADC Rules\n\n  Editor's Note: Provisioning of Predefined PCC/ADC Rules in 5GC is FFS.\n\nA Predefined PCC rule is preconfigured in the PCEF, e.g. a PGW. Predefined\nPCC rules can be activated or deactivated by the PCRF at any time. The\nPredefined PCC rules may be grouped allowing the PCRF to dynamically\nactivate a set of PCC rules.\n\nA predefined ADC rule is preconfigured in the TDF. In the case of solicited\nreporting, the Predefined ADC rules can be activated or deactivated by the\nPCRF at any time. Predefined ADC rules within the TDF may be grouped\nallowing the PCRF to dynamically activate a set of ADC rules.\n\nSee subclauses 4.3.1 and 4b.3.2 of 3GPP\u00a0TS\u00a029.212\u00a0[8].\n\nThe CP function may enforce an activated predefined PCC or ADC rule by the\nPCRF in the UP function by:\n\n  -  determining the service data filters or application IDs referred by\n    the activated predefined PCC or ADC rule(s) and the corresponding QoS\n    and charging control information respectively;\n\n  -  creating the necessary PDR(s) to identify the service data flow(s),\n    application(s) that the predefined PCC or ADC rule refer to, if not\n    already existing;\n\n  -  creating the necessary QER for the QoS enforcement at service data\n    flow or application level accordingly;\n\n  -  creating the necessary FAR if a new FAR needs to be created as result\n    of Bearer binding and QoS control for forwarding the detected service\n    data flow or application traffic, or to redirect or to apply traffic\n    steering control if included in the predefined PCC/ADC rule;\n\n  -  creating the necessary URR(s) for each monitoring key, charging key,\n    combination of Charging Key and Service ID, or combination of Charging\n    Key, Sponsor ID and Application Service Provider Id if included in the\n    predefined PCC or ADC rule;\n\nAnd then:\n\n  -  associating the created URR(s) to the newly created PDR(s);\n\n  -  associating the existing FAR or the new FAR to the newly created\n    PDR(s);\n\nOptionally, the traffic handling policies (i.e. predefined\nQER(s)/FAR(s)/URR(s)) may be configured in the UP function. The CP function\nmay activate these traffic handling policies by including the Activate\nPredefined Rules IE within:\n\n  -  the Create PDR IE in an PFCP Session Establishment Request; or\n\n  -  the Update PDR IE in an PFCP Session Modification Request.\n\nFor traffic matching PDR(s) associated with the activated predefined rules,\nthe UP function shall enforce the rules, e.g. for URR, the UP function\nshall generate Usage Report(s) and send it to the CP function and the CP\nfunction shall be able to handle the usage reports as described in\nsubclause\u00a05.2.2.\n\n  NOTE:  The URR IDs used in reports triggered by a predefined rule in UP\n         function are also pre-configured at the CP function.\n\nFor deactivating predefined rules which are activated in the UP function,\nthe CP function shall include the Deactivate Predefined Rules IE in the\nUpdate PDR IE in an PFCP Session Modification Request to inform the UP\nfunction to deactivate the corresponding predefined rules for the related\nPDR.\n\n\n"}, {"key": "Charging", "numbering": "5.4.10", "title_level": 2, "desc": "5.4.10 Charging\n\nThe charging requirements for online and offline charging in the PS domain\nspecified in 3GPP\u00a0TS\u00a032.251\u00a0[17] shall be preserved with a split SGW, PGW\nand TDF architecture.\n\nCharging is supported by the CP function by activating in the UP function\nthe measurement and reporting of the accumulated usage of network resources\nper:\n\n  -  IP-CAN bearer, for an SGW;\n\n  -  IP-CAN bearer, IP-CAN session and/or individual or group of service\n    data flows, for a PGW;\n\n  -  TDF session and/or individual or group of applications, for a TDF.\n\nSee subclauses 5.3 and 7.8.4 of 3GPP\u00a0TS\u00a023.214\u00a0[2].\n\nThe CP function shall control the usage measurement and reporting in the UP\nfunction by:\n\n  -  creating the necessary PDR(s) to represent the service data flow,\n    application, bearer or session, if not already existing;\n\n  -  creating URR(s) for each Charging Key, combination of Charging Key and\n    Service ID, or combination of Charging Key, Sponsor ID and Application\n    Service Provider Id;\n\n  -  associating the URR(s) to the relevant PDRs defined for the PFCP\n    session, for usage reporting at IP-CAN bearer, IP-CAN session, TDF\n    session, SDF or application level.\n\nFor online charging, the CP function shall provision the URR with the\nVolume (or Time) Quota, and with the Volume (or Time) Quota if a quota\nthreshold was received from the OCS, as specified in subclause 5.2.2.2.\nBesides, when the OCS provides a final quota and requests to redirect the\ntraffic towards a redirect destination when exhausing this quota, the CP\nfunction shall redirect the traffic towards a redirect destination as\nspecified in subclause 5.4.7 upon being notified that the final quota has\nbeen reached; to permit HTTP traffic redirection, the UP function should\nhave at least one HTTP packet, e.g. the UP function may store one packet\nwhen reaching the Volume (or Time) Quota. An example call flow is depicted\nin Annex\u00a0C.2.1.1.\n\nTo avoid the risk of signalling storms between the CP and UP functions at\ntimes of tariff change, the CP function may include the Monitoring Time IE\nin the URR and set it to the time of tariff change to request the UP\nfunction to report separately the resource usage before and after the time\nof tariff change (see e.g. subclause 6.3.7.1 of 3GPP\u00a0TS\u00a032.299\u00a0[18]).\n\n\n"}, {"key": "(Un)solicited Application Reporting", "numbering": "5.4.11", "title_level": 2, "desc": "5.4.11 (Un)solicited Application Reporting\n\n  Editor's Note: (Un)solicited Application Reporting in 5GC is FFS.\n\n (Un)solicited Application Reporting refers to the process of reporting the\nstart or stop of applications by the TDF or PCEF. See 3GPP\u00a0TS\u00a023.203\u00a0[3]\nand 3GPP\u00a0TS\u00a029.212\u00a0[8].\n\nThe CP function shall instruct the UP function to detect and report\napplications by:\n\n  -  creating the necessary PDR(s) to represent the applications to detect;\n\n  -  creating a URR with the Reporting Trigger IE set to detect the start\n    and/or stop of Traffic;\n\n  -  associating the URR to the PDR.\n\nFor unsolicited application reporting, an PFCP session which is not linked\nto any specific TDF session may be established and the PDI in the PDR(s)\ndoes not contain any UE IP address.\n\nWhen detecting the start or stop of an application, the UP function shall\nthen initiate the PFCP Session Report procedure and send a Usage Report\nwith the Usage Report Trigger set to 'Start of Traffic' or 'Stop of\nTraffic'. The UP function shall also include the following information in\nthe Usage Report:\n\n  -  when reporting the start of an application:\n\n    -  the Application ID;\n\n    -  the Flow Information including the Flow Description and the Flow\n       Direction, if the traffic flow information is deducible;\n\n    -  the Application-Instance-Identifier, if the traffic flow information\n       is deducible; and\n\n    -  if no UE IP address was provisioned in the PDI, the UE's IP address,\n       and the Network instance when multiple PDNs with overlapping IP\n       addresses are used in the UP function.\n\n  NOTE:  When the CP function instructs the UP function to perform\n         unsolicited application reporting, the PDI in the corresponding PDR\n         has no UE IP address.\n\n  -  when reporting the stop of an application:\n\n    -  the Application ID;\n\n    -  the Application-Instance-Identifier, if an Application Identifier\n       was provided when reporting the start of the application;\n\n    -  if no UE IP address was provisioned in the PDI, the UE's IP address,\n       and the Network instance when multiple PDNs with overlapping IP\n       addresses are used in the UP function.\n\nThe UP function shall only report the Application ID when detecting the\nstart or stop of an application and the Reduced Application Detection\nInformation flag is set in the Measurement Information of the URR, e.g. for\nenvelope reporting.\n\n\n"}, {"key": "Service Identification for Improved Radio Utilisation for GERAN", "numbering": "5.4.12", "title_level": 2, "desc": "5.4.12 Service Identification for Improved Radio Utilisation for GERAN\n\nService Identification for improved radio utilization for GERAN refers to\nthe process in the PGW of marking DL user plane traffic with a Service\nClass Indicator (SCI) value. See subclause 5.3.5.3 of 3GPP\u00a0TS\u00a023.060\u00a0[19].\n\nThis is controlled by the PGW-C by associating a QER, including the Service\nClass Indicator within the DL Flow Level Marking IE, to the PDR matching\nthe DL traffic to be marked. The PGW-U performs the SCI marking for the\ndetected DL traffic and sends the packet with the GTP-U Service Class\nIndicator Extension Header downstreams.\n\nThe PGW-C may stop the SCI marking during the PFCP session by removing the\nrelated QER or removing the DL Flow Level Marking IE from the related QER,\nthe PGW-U shall then stop such function consequently.\n\n\n"}, {"key": "Transport Level Marking", "numbering": "5.4.13", "title_level": 2, "desc": "5.4.13 Transport Level Marking\n\nFor EPC, transport level marking is performed on a per EPS bearer basis in\nthe SGW and PGW. Transport level marking refers to the process of marking\ntraffic with a DSCP value based on the locally configured mapping from the\nQCI and optionally ARP.\n\nFor 5GC, transport level marking is performed on a per QoS flow basis.\nTransport level marking refers to the process of marking traffic at the UPF\nwith a DSCP value based on the mapping from the 5QI and optionally ARP\nconfigured at the SMF.\n\nTransport level marking shall be controlled by the CP function by providing\nthe DSCP in the ToS or Traffic Class within the Transport Level Marking IE\nin the FAR that is associated to the PDR matching the traffic to be marked.\nThe UP function shall perform the transport level marking for the detected\ntraffic and sends the marked packet to the peer entity.\n\nThe CP function may change transport level marking by changing the\nTransport Level Marking IE in the related FAR.\n\n\n"}, {"key": "F-TEID Allocation and Release", "numbering": "5.5", "title_level": 1, "desc": "5.5  F-TEID Allocation and Release\n\n\n"}, {"key": "General", "numbering": "5.5.1", "title_level": 2, "desc": "5.5.1  General\n\nF-TEID shall be allocated either by the CP function or the UP function. The\nsupport of F-TEID allocation by the CP function is mandatory. The support\nof F-TEID allocation by the UP function is optional. See subclause 5.4 of\n3GPP\u00a0TS\u00a023.214\u00a0[2].\n\nThe UP function shall set the FTUP feature flag in the UP Function Features\nIE if it supports F-TEID allocation in the UP function (see\nsubclause\u00a08.2.25). If so, the CP function shall determine whether F-TEIDs\nare allocated by the CP function or the UP function based on network\nconfiguration. The same F-TEID allocation option shall be used by all the\nCP functions controlling a particular UP function. The UP function shall\nreject a request to establish a new PDR with a different F-TEID allocation\noption than the option used for already created PDRs (by the same or a\ndifferent CP function), with the cause \"Invalid F-TEID allocation option\".\n\n\n"}, {"key": "F-TEID allocation in the CP function", "numbering": "5.5.2", "title_level": 2, "desc": "5.5.2  F-TEID allocation in the CP function\n\nWhen performing F-TEID allocation in the CP function, the CP function shall\nassign the Local F-TEID IE of the PDR IE (see Table\u00a07.5.2.2-1) and provide\nthe assigned F-TEID value to the UP function.\n\n\n"}, {"key": "F-TEID allocation in the UP function", "numbering": "5.5.3", "title_level": 2, "desc": "5.5.3  F-TEID allocation in the UP function\n\nWhen performing F-TEID allocation in the UP function, the CP function shall\nrequest the UP function to allocate the F-TEID by setting the CHOOSE flag\nin the Local F-TEID IE of the PDR IE (see Table\u00a07.5.2.2-1). The Source\nInterface IE indicates for which interface the F-TEID is to be assigned.\n\nThe CP function may request the UP function to allocate the same F-TEID to\nseveral PDRs to be created within one single PFCP Session Establishment\nRequest or PFCP Session Modification Request by:\n\n  -  setting the CHOOSE flag in the Local F-TEID IE of each PDR to be\n    created with a new F-TEID, and\n\n  -  setting the CHOOSE ID field of the Local F-TEID IE, for each PDR to be\n    created with the same F-TEID, with the same CHOOSE ID value.\n\nor, if the UP function indicated support of the PDI optimization (see\nsubclause 8.2.25), by:\n\n  -  including the Local F-TEID IE only in the Create Traffic Endpoint IE\n    and by setting the CHOOSE flag in the Local F-TEID IE of this IE; and\n\n  -  including the Traffic Endpoint ID in all the PDRs to be created with\n    the same F-TEID.\n\nIf the PDR(s) is created successfully, the UP function shall return the F-\nTEID(s) it has assigned to the PDR(s) or to the Traffic Endpoint(s) in the\nPFCP Session Establishment Response or PFCP Session Modification Response.\n\nUpon receiving a request to remove a PDR or a Traffic Endpoint or to delete\nan PFCP session, the UP function shall free the F-TEID(s) that was assigned\nto the PDR, to the Traffic Endpoint or to the PFCP Session.\n\n\n"}, {"key": "PFCP Session Handling", "numbering": "5.6", "title_level": 1, "desc": "5.6  PFCP Session Handling\n\n\n"}, {"key": "General", "numbering": "5.6.1", "title_level": 2, "desc": "5.6.1  General\n\nThe following subclauses provide details on PFCP Sessions handling.\n\n\n"}, {"key": "Session Endpoint Identifier Handling", "numbering": "5.6.2", "title_level": 2, "desc": "5.6.2  Session Endpoint Identifier Handling\n\nThe SEID uniquely identifies an PFCP session at an IP address of a PFCP\nentity. The F-SEID is the Fully Qualified SEID and it contains the SEID and\nIP address. The PFCP endpoint locally assigns the SEID value the peer PFCP\nside has to use when transmitting message. The SEID values are exchanged\nbetween PFCP endpoints using PFCP messages. The PFCP entity communicates to\nthe peer PFCP entity the SEID value at which it expects to receive all\nsubsequent control plane messages related to that PFCP session via the \"F-\nSEID\" IE.\n\nThe PFCP session related messages shall share the same F-SEID for the PFCP\nsession. A F-SEID shall be released after the PFCP session is released.\n\n\n"}, {"key": "Modifying the Rules of an Existing PFCP Session", "numbering": "5.6.3", "title_level": 2, "desc": "5.6.3  Modifying the Rules of an Existing PFCP Session\n\nThe following principles shall apply, unless specified otherwise in the\nspecification.\n\nWhen modifying an existing PFCP session, the CP function shall only provide\nin the PFCP Request message the requested changes compared to what was\npreviously provisioned in the UP function for this PFCP session, i.e. the\nCP function shall:\n\n  -  include IEs which needs to be newly provisioned in the UP function;\n\n  -  include IEs which need to be provisioned with a modified value;\n\n  -  remove IEs which need to be removed from the set of parameters\n    previously provisioned in the UP function, as further specified below.\n\nThe CP function shall remove IEs which needs to be removed by either:\n\n  -  removing the entire Rule if no other parameter of that rule needs to\n    remain provisioned in the UP function, e.g. by including the Remove URR\n    IE in the PFCP Session Modification Request; or\n\n  -  updating the Rule including the IEs to be removed with a null length,\n    e.g. by including the Update URR IE in the PFCP Session Modification\n    Request with the IE(s) to be removed with a null length.\n\nThe CP function shall set a URR ID and/or QER ID with a length \"0\" in the\nUpdate PDR IE within PFCP Session Modification Request, to request the UP\nfunction to stop applying the URRs and/or QERs for this PDR.\n\nUpon receipt of an PFCP Request which modifies an existing PFCP session,\nthe UP function shall add, update or remove the parameters as instructed by\nthe CP function, as defined above, and shall keep unchanged the set of\nparameters previously provisioned in the UP function which are neither\nmodified nor removed.\n\n\n"}, {"key": "Support of Lawful Interception", "numbering": "5.7", "title_level": 1, "desc": "5.7  Support of Lawful Interception\n\n  Editor's Note: Lawful interception for 5GC is FFS.\n\nRequirements for support of Lawful Interception with a split SGW or PGW are\nspecified in subclauses\u00a012.9 and 20.4 of 3GPP\u00a0TS\u00a033.107\u00a0[20].\n\nUser plane packets shall be forwarded from the UP function to the SX3LIF\n(or LMISF for S8HR) by encapsulating the user plane packets using GTP-U\nencapsulation (see 3GPP\u00a0TS\u00a029.281\u00a0[3]).\n\nThe CP function shall instruct the UP function to duplicate the packets to\nbe intercepted and to forward them to the SX3LIF (or to the LMISF for S8HR)\nas specified in subclause 5.2.3.\n\nFor forwarding data from the UP function to the SX3LIF (or LMISF for S8HR),\nthe CP function shall set the DUPL flag in the Apply Action and set the\nDuplicating Parameters in the FAR, associated to the PDRs of the traffic to\nbe intercepted, with the Destination Interface \"LI Function\" and set to\nperform GTP-U encapsulation and to forward the packets to a GTP-u F-TEID\nuniquely assigned in the SX3LIF (or LMISF for S8HR) for the traffic to be\nintercepted. The SX3LIF (or LMISF for S8HR) shall then identify the\nintercepted traffic by the F-TEID in the header of the encapsulating GTP-U\npacket.\n\n\n"}, {"key": "PFCP Association", "numbering": "5.8", "title_level": 1, "desc": "5.8  PFCP Association\n\n\n"}, {"key": "General", "numbering": "5.8.1", "title_level": 2, "desc": "5.8.1  General\n\nAn PFCP Association shall be set up between the CP function and the UP\nfunction prior to establishing PFCP sessions on that UP function. Only one\nPFCP association shall be setup between a given pair of CP and UP\nfunctions.\n\nThe CP function and the UP function shall support the PFCP Association\nSetup procedure initiated by the CP function (see subclause 6.2.6.2). The\nCP function and the UP function may additionally support the PFCP\nAssociation Setup procedure initiated by the UP function (see subclause\n6.2.6.3).\n\nA CP function may have PFCP Associations set up with multiple UP functions.\nA UP function may have PFCP Associations set up with multiple CP functions.\n\n\n"}, {"key": "Behaviour with an Established PFCP Association", "numbering": "5.8.2", "title_level": 2, "desc": "5.8.2  Behaviour with an Established PFCP Association\n\nWhen an PFCP Association is established with a UP function, the CP\nfunction:\n\n  -  shall provision node related parameters (i.e. parameters that apply to\n    all PFCP sessions) in the UP function, if any, e.g. PFDs;\n\n  -  shall provision the UP function with the list of features (affecting\n    the UP function behaviour) the CP function supports, if any, e.g.\n    support of load and/or overload control;\n\n  -  shall check the responsiveness of the UP function using the Heartbeat\n    procedure as specified in subclause 6.2.2;\n\n  -  may establish PFCP sessions on that UP function;\n\n  -  shall refrain from attempting to establish new PFCP sessions on the UP\n    function, if the UP function has indicated it will shut down\n    gracefully.\n\nWhen an PFCP Association is established with a CP function, the UP\nfunction:\n\n  -  shall update the CP function with the list of features it supports;\n\n  -  shall update the CP function with its load and/or overload control\n    information, if load and/or overload control is supported by the CP and\n    UP functions;\n\n  -  may update the CP function with the set of its IP resources available\n    for use by the CP function, when F-TEID allocation is performed by the\n    CP function;\n\n  NOTE:  The CP function can be aware of the available IP resources in the\n         UP function e.g. based on the UP function reporting this\n         information over Sx using Sx node related messages, or by other\n         implementation specific means.\n\n  -  shall accept PFCP Session related messages from that CP function\n    (unless prevented by other reasons, e.g. overload);\n\n  -  shall check the responsiveness of the CP function using the Heartbeat\n    procedure as specified in subclause 6.2.2;\n\n  -  shall indicate to the CP function if it will shut down within a\n    graceful period and, when possible, if it fails and becomes out of\n    service.\n\n\n"}, {"key": "Behaviour without an Established PFCP Association", "numbering": "5.8.3", "title_level": 2, "desc": "5.8.3  Behaviour without an Established PFCP Association\n\nWhen an PFCP Association is not established with a UP function, the CP\nfunction:\n\n  -  shall reject any incoming PFCP Session related messages from that UP\n    function, with a cause indicating that no PFCP association exists with\n    the peer entity.\n\nWhen an PFCP Association is not yet established with a CP function, the UP\nfunction:\n\n  -  shall reject any incoming PFCP Session related messages from that CP\n    function, with a cause indicating that no PFCP association exists with\n    the peer entity.\n\n\n"}, {"key": "Usage of Vendor-specific IE", "numbering": "5.9", "title_level": 1, "desc": "5.9  Usage of Vendor-specific IE\n\nVendor-specific IEs are defined to cover requirements and features not\nspecified by 3GPP.\n\n  NOTE 1:  When a IE is intended to be used by more than one vendor, the\n         definition of the IE is encouraged to be specified by 3GPP to ease\n         implementation and interoperability.\n\n  NOTE 2:  The PFCP entities can use Vendor-specific IE(s) in the PFCP\n         message relevant to the PFCP Association Setup procedure to learn\n         which vendor specific enhancements are supported by the peer.\n\nIn a network with Vendor specific enhancements, unrecognized vendor\nspecific IEs shall be handled as unknown optional IEs.\n\n\n"}, {"key": "Error Indication Handling", "numbering": "5.10", "title_level": 1, "desc": "5.10 Error Indication Handling\n\nUpon receipt of a GTP-U Error Indication message, the UP function:\n\n  -  shall identify the related PFCP session for which the message is\n    received; and\n\n  -  shall initiate an PFCP Session Report procedure, towards the CP\n    function controlling this PFCP session, to send an Error Indication\n    Report including the remote F-TEID signalled in the GTP-U Peer Address\n    IE and the Tunnel Endpoint Identifier Data I IE of the GTP-U Error\n    Indication (see subclause 7.3.1 of 3GPP\u00a0TS\u00a029.281\u00a0[3]).\n\nUpon receipt of an Error Indication Report, the CP function shall then\nidentify the bearer for which the Error Indication Report is received using\nthe remote F-TEID included in the report and proceed as specified in\nsubclauses 21.7 and 21.8 of 3GPP\u00a0TS\u00a023.007\u00a0[24], i.e.:\n\n  -  modify the PFCP session to instruct the UP function to buffer DL\n    packets;\n\n  -  modify the PFCP session to delete the PDR and FAR, when having to\n    delete a bearer; or\n\n  -  delete the PFCP session, when having to delete the PDN connection.\n\n  Editor's Note:  Restoration procedures for 5GC are FFS.\n\n\n"}, {"key": "User plane inactivity detection and reporting", "numbering": "5.11", "title_level": 1, "desc": "5.11 User plane inactivity detection and reporting\n\nSubclause 5.4.4.1 of 3GPP\u00a0TS\u00a023.401\u00a0[14] requires the PGW to initiate the\nrelease of an inactive emergency PDN connection.\n\nSubclause 4.3.7 and 4.3.2.2.2 of 3GPP\u00a0TS\u00a023.502\u00a0[29] requires the SMF to be\nable to initiate the deactivation of the UP connection of an existing PDU\nsession without user plane activity for a given inactivity period, except\nfor the H-SMF for the home routed roaming scenario.\n\nThe CP function may request the UP function to detect and report when no\nuser plane packets are received for an PFCP session, by provisioning the\nUser Plane Inactivity Timer IE in the PFCP Session Establishment Request or\nPFCP Session Modification Request.\n\nUpon being provisioned with this IE, the UP function shall monitor the user\nplane activity of the PFCP session, and report any user plane inactivity\nexceeding the duration indicated by this IE by sending an PFCP Session\nReport Request with the Report Type set to UPIR (User Plane Inactivity\nReport). The UP function shall then continue to process any further user\nplane packets as instructed by the rules provisioned for the PFCP session,\nuntil receiving any new instruction from the CP function.\n\n\n"}, {"key": "Suspend and Resume Notification procedures", "numbering": "5.12", "title_level": 1, "desc": ""}, {"key": "Ethernet traffic (for GC)", "numbering": "5.13", "title_level": 1, "desc": "5.12 Suspend and Resume Notification procedures\n\nUpon receipt of a Suspend Notification message, the PGW-C should request\nthe PGW-U to discard packets received for the suspended PDN connection by:\n\n  -  setting the DROP flag in the Apply Action IE of the FARs of the\n    corresponding PFCP session, or\n\n  -  setting the gate fields in the Gate Status IE of QERs to the value\n    CLOSED.\n\nUpon being requested to resume the PDN connection, the PGW-C should re-\nallow the PGW-U to forward the packets for the PDN connection (unless not\npermitted for other reasons) by:\n\n  -  setting the FORW flag in the Apply Action IE of the FARs of the\n    corresponding PFCP session or\n\n  -  setting the gate fields in the Gate Status IE of QERs to the value\n    OPEN.\n\n\n5.13 Ethernet traffic (for 5GC)\n\n\n"}, {"key": "General", "numbering": "5.13.1", "title_level": 2, "desc": ""}, {"key": "ARP or IPv Neighbour Advertisement Proxying in SMF", "numbering": "5.13.2", "title_level": 2, "desc": ""}, {"key": "ARP or IPv Neighbour Advertisement Proxying in UPF", "numbering": "5.13.3", "title_level": 2, "desc": "5.13.1 General\n\nAn SMF and UPF may support Ethernet PDU sessions, as specified in subclause\n5.6.10.2 of 3GPP\u00a0TS\u00a023.501[28].\n\nFor a PFCP session set up for an Ethernet PDU session, the SMF shall:\n\n  -  include the PDN Type IE set to \"Ethernet\" in the PFCP Session\n    Establishment Request;\n\n  -  provision PDR(s), for uplink and/or downlink traffic, with Ethernet\n    Packet Filter(s), based on at least any combination of:\n\n    -  Source/destination MAC address;\n\n    -  Ethertype as defined in IEEE\u00a0802.3\u00a0[31];\n\n    -  Customer-VLAN tag (C-TAG) and/or Service-VLAN tag (S-TAG) VID fields\n       as defined in IEEE\u00a0802.1Q\u00a0[30];\n\n    -  Customer-VLAN tag (C-TAG) and/or Service-VLAN tag (S-TAG) PCP/DEI\n       fields as defined in IEEE\u00a0802.1Q\u00a0[30];\n\n    -  IP Packet Filter Set, in case Ethertype indicates IPv4/IPv6 payload.\n       ;\n\n    -  Ethernet PDU Session Information, only possible for a DL PDR, that\n       identifies all (DL) Ethernet packets matching the PDU session as\n       follows, based on the N6 Ethernet configuration in the UPF for the\n       associated Network Instance (see subclause 5.6.10.2 of\n       3GPP\u00a0TS\u00a023.501\u00a0[28]):\n\n       -  DL traffic based on the MAC address(es) used by the UE for the UL\n         traffic, for configurations where more than one PDU Session to the\n         same DNN (e.g. for more than one UE) corresponds to the same N6\n         interface;\n\n       -  DL traffic from the N6 interface associated to the PDU session,\n         for configurations where there is a one-to-one relationship between\n         a PDU Session and a N6 interface (in which case the UPF does not\n         need to be aware of MAC addresses used by the UE in order to route\n         down-link traffic).\n\n  NOTE 1:  For instance, the SMF can provision a DL PDR with just an\n         \"Ethernet PDU Session Information\", in a Traffic Endpoint ID or in\n         a PDI, or Ethernet Packet Filters in a PDI, or both an \"Ethernet\n         PDU Session Information\" in a Traffic Endpoint ID and Ethernet\n         Packet Filters in a PDI.\n\nThe SMF may also request a UPF, acting as a PDU session anchor, to:\n\n  -  redirect ARP or IPv6 Neighbour Solicitation traffic to the SMF as\n    specified in subclause 5.13.2, or to perform ARP proxying or IPv6\n    Neighbour Advertisement proxying as specified in subclause 5.13.3;\n\n  -  report the MAC (Ethernet) addresses used as source address of frames\n    sent UL by the UE, as specified in subclause 5.13.5.\n\nFor a PFCP session set up for an Ethernet PDU session, the UPF shall:\n\n  -  detect Ethernet traffic, based on Ethernet Packet Filter(s)\n    provisioned in PDR(s) by the SMF, and process the Ethernet traffic as\n    instructed in the FAR, QER(s) and URR(s) associated to the PDR(s);\n\n  -  forward ARP or IPv6 Neighbour Solicitation messages to the SMF, as\n    specified in subclause 5.13.2, if so required by the SMF.\n\n  -  perform ARP proxying or IPv6 Neighbour Advertisement proxying, as\n    specified in subclause 5.13.3, if so required by the SMF;\n\n  NOTE 2:  Ethernet Preamble and Start of Frame delimiter are not sent over\n         5GS.\n\n  NOTE 3:  How the UPF/SMF builds the ARP or the IPv6 Neighbour cache is\n         not specified in this release and is implementation specific.\n\n\n5.13.2 ARP or IPv6 Neighbour Advertisement Proxying in SMF\n\nIf the SMF requests the UPF to forward all ARP or IPv6 Neighbour\nSolicitation traffic to the SMF to do the ARP or IPv6 Neighbour\nAdvertisement proxying for Ethernet PDU sessions, the SMF shall provision a\nPDR in the UPF with:\n\n  -  an Ethernet Packet Filter containing EtherType 2054 (hexadecimal\n    0x0806) and associate the PDR with a FAR, for forwarding ARP traffic to\n    the SMF;\n\n  -  an Ethernet Packet Filter containing EtherType 34525 (hexadecimal\n    0x86DD), a SDF Filter containing a Flow Description identifying IPv6\n    Next Header type as 58 and ICMP Field Type as 135 and associate the PDR\n    with a FAR, for forwarding ARP traffic to the SMF.\n\nIn this case, the user plane packets shall be forwarded between the CP and\nUP functions by encapsulating the user plane packets using GTP-U\nencapsulation (see subclause 5.3.1).\n\nThe SMF shall perform ARP proxying as specified in IETF\u00a0RFC\u00a01027\u00a0[32]\nand/or IPv6 Neighbour Advertisement Proxying as specified in\nIETF\u00a0RFC\u00a04861\u00a0[33] in this case.\n\n\n5.13.3 ARP or IPv6 Neighbour Advertisement Proxying in UPF\n\nIf the SMF requests the UPF to do ARP or IPv6 Neighbour Advertisement\nproxying for an Ethernet PDU session, the SMF shall provision a PDR in the\nUPF with:\n\n  -  an Ethernet Packet Filter containing EtherType 2054 (hexadecimal\n    0x0806) and associate the PDR with a FAR that has the ARP bit in\n    Proxying IE of the Forwarding Parameters IE set to 1; or\n\n  -  an Ethernet Packet Filter containing EtherType 34525 (hexadecimal\n    0x86DD), a SDF Filter containing a Flow Description identifying IPv6\n    Next Header type as 58 and ICMP Field Type as 135 and associate the PDR\n    with a FAR that has the INS bit in Proxying IE of the Forwarding\n    Parameters IE set to 1.\n\nThe UPF shall perform ARP proxying as specified in IETF\u00a0RFC\u00a01027\u00a0[32]\nand/or IPv6 Neighbour Advertisement Proxying as specified in\nIETF\u00a0RFC\u00a04861\u00a0[33] in this case.\n\n\n"}, {"key": "Bidirectional Ethernet Filters", "numbering": "5.13.4", "title_level": 2, "desc": "5.13.4 Bidirectional Ethernet Filters\n\nThe CP function may provision bidirectional Ethernet Filters in the UP\nfunction (see subclause 7.5.2.2-x), i.e. Ethernet filters that may be\nassociated to both uplink and downlink PDRs of a same PFCP session, as\nfollows:\n\n  -  when provisioning a bidirectional Ethernet Filter the first time for\n    an PFCP session, the CP function shall set the BIDE (Bidirectional\n    Ethernet Filter) flag in the Ethernet Filter Properties IE and\n    provision the Ethernet filter definition together with a Ethernet\n    Filter ID uniquely identifying the Ethernet Filter among all the\n    Ethernet Filters provisioned for a given PFCP session; the source and\n    destination MAC addresses information, in a bidirectional Ethernet\n    filter, shall be set as for downlink Ethernet flows;\n\n  -  the CP function may then provision a PDR for the same PFCP session but\n    the opposite direction, by provisioning the Ethernet Filter ID in the\n    Ethernet filter ID field of the PDI, without provisioning again the\n    Ethernet Filter Properties and Ethernet filter definition.;\n\n  -  when being provisioned with a bidirectional Ethernet Filter in a PDR,\n    the UP function shall apply the Ethernet filter according to the\n    direction of the PDR (as derived from the Source Interface IE in the\n    PDI of the PDR or the Destination Interface IE in the FAR), i.e. the UP\n    function shall apply the Ethernet filter parameters provisioned for the\n    Ethernet filter ID, but with swapping the source and destination MAC\n    addresses, and the source and destination IP addresses if any, if the\n    PDR is set for uplink Ethernet flows;\n\n  -  the UP function shall apply any modification of a bidirectional\n    Ethernet Filter to all PDRs of the PFCP session making use of this\n    Ethernet Filter;\n\n  -  upon deletion of a PDR making use of a bidirectional Ethernet Filter,\n    the UP function shall still apply the Ethernet Filter for any other PDR\n    making use of the Ethernet Filter.\n\n\n"}, {"key": "Reporting of UE MAC addresses to the SMF", "numbering": "5.13.5", "title_level": 2, "desc": "5.13.5 Reporting of UE MAC addresses to the SMF\n\nIn a PFCP Session Establishment Request or a PFCP Session Modification\nRequest, the SMF may request the UPF to start or stop (in a PFCP Sesssion\nModification Request only) reporting the UE MAC addresses, i.e. the\ndifferent MAC (Ethernet) addresses used as source address of frames sent UL\nby the UE in a PDU Session, by:\n\n  -  creating a URR requesting the UPF to report Ethernet traffic\n    information (i.e. with the Reporting Trigger set to 'MAC Addresses\n    Reporting'); and\n\n  -  associating the URR to the PDR provisioned for the UL traffic of the\n    PDU session.\n\nThe SMF may additionally request the UPF to detect and report when no user\nplane packets are received for an UE MAC address, by provisioning the\nEthernet Inactivity Timer IE in the URR.\n\nWhen being requested to start reporting the UE MAC addresses, the UPF\nshall:\n\n  -  report immediately any UE MAC addresses known to be associated to the\n    PDU session (e.g. if the request to start monitoring of traffic is\n    received after the PFCP session establishment and if the UPF monitors\n    the UE MAC addresses for the routing of DL traffic);\n\n  -  report new UE MAC addresses that are detected subsequently;\n\n  -  report UE MAC addresses that are removed subsequently from the PDU\n    session, based on the detection of absence of traffic during the\n    Ethernet Inactivity Timer, if this timer is provisioned in the URR.\n\n  NOTE:  Numerous UE MAC addresses can be used by a same PDU session. The\n         UP function can defer a bit the reporting of newly detected or\n         removed UE MAC addresses to allow the reporting of multiple UE MAC\n         addresses in a same usage report. Details are implementation\n         specific.\n\n\n"}, {"key": "Procedures", "numbering": "6", "title_level": 0, "desc": "6  Procedures\n\n  Editor's Note:  The subclauses under clause 6 need to be updated to cover\n         5GC N4 reference point requirements.\n\n\n"}, {"key": "Introduction", "numbering": "6.1", "title_level": 1, "desc": "6.1  Introduction\n\nThe following subclauses specify the procedures supported over the Sxa, Sxb\nand Sxc reference points.\n\n\n"}, {"key": "PFCP Node Related Procedures", "numbering": "6.2", "title_level": 1, "desc": "6.2  PFCP Node Related Procedures\n\n\n"}, {"key": "General", "numbering": "6.2.1", "title_level": 2, "desc": "6.2.1  General\n\nThe following subclauses specify the node related procedures over the Sxa,\nSxb, Sxc and N4 reference points. The behaviour of the CP function und UP\nfunction when sending and receiving a node related message is described.\n\n\n"}, {"key": "Heartbeat Procedure", "numbering": "6.2.2", "title_level": 2, "desc": "6.2.2  Heartbeat Procedure\n\n\n"}, {"key": "General", "numbering": "6.2.2.1", "title_level": 3, "desc": "6.2.2.1  General\n\nTwo messages are specified for PFCP heartbeat procedure: Heartbeat Request\nand Heartbeat Response. The use of these messages is further specified in\nclause 19A of 3GPP\u00a0TS\u00a023.007\u00a0[24].\n\n  Editor's Note:  Restoration procedures for 5GC are FFS.\n\n\n"}, {"key": "Heartbeat Request", "numbering": "6.2.2.2", "title_level": 3, "desc": "6.2.2.2  Heartbeat Request\n\nThe CP function or the UP function may send an Heartbeat Request on a path\nto the peer node to find out if it is alive. Heartbeat Request messages may\nbe sent for each peer with which an PFCP control association is\nestablished.\n\nFor each peer with which an PFCP control association is established, a CP\nfunction or UP function shall be prepared to receive an Heartbeat Request\nat any time and it shall reply with an Heartbeat Response.\n\n\n"}, {"key": "Heartbeat Response", "numbering": "6.2.2.3", "title_level": 3, "desc": "6.2.2.3  Heartbeat Response\n\nThe message shall be sent as a response to a received Heartbeat Request.\n\n\n"}, {"key": "Load Control Procedure", "numbering": "6.2.3", "title_level": 2, "desc": "6.2.3  Load Control Procedure\n\n\n"}, {"key": "General", "numbering": "6.2.3.1", "title_level": 3, "desc": "6.2.3.1  General\n\nLoad Control is an optional feature defined over the Sxa, Sxb, Sxc and N4\nreference points.\n\nLoad control enables the UP function to send its load information to the CP\nfunction to adaptively balance the PFCP session load across the UP\nfunctions according to their effective load. The load information reflects\nthe operating status of the resources of the UP function.\n\nLoad control allows for better balancing of the PFCP session load, so as to\nattempt to prevent overload in the first place (preventive action). Load\ncontrol does not trigger overload mitigation actions even if the UP\nfunction reports a high load.\n\nLoad control and overload control may be supported and activated\nindependently in the network, based on operator's policy.\n\n\n"}, {"key": "Principles", "numbering": "6.2.3.2", "title_level": 3, "desc": "6.2.3.2  Principles\n\nThe UP function may signal its Load Control Information to reflect the\noperating status of its resources, at the node level, allowing the\nreceiving CP function to use this information to augment the UP function\nselection procedures.\n\nThe Load Control Information is piggybacked in PFCP request or response\nmessages such that the exchange of Load Control Information does not\ntrigger extra signalling.\n\n  NOTE:  The inclusion of Load Control Information in existing messages\n         means that the frequency of transmission of load control\n         information increases as the session load increases, allowing for\n         faster feedback and thus better regulation of the load.\n\nThe calculation of the Load Control Information is implementation dependent\nand its calculation and transfer shall not add significant additional load\nto the node itself and to its corresponding peer nodes.\n\n\n"}, {"key": "Load Control Information", "numbering": "6.2.3.3", "title_level": 3, "desc": "6.2.3.3  Load Control Information\n\n\n"}, {"key": "General Description", "numbering": "6.2.3.3.1", "title_level": 4, "desc": "6.2.3.3.1   General Description\n\nA PFCP message may contain one instance of the Load Control Information\n(LCI) IE.\n\nWhen providing load control information in a message for the first time or\nsubsequently, the UP function shall always include the full set of load\ncontrol information, i.e. all the node level instance of the Load Control\nInformation, even if only a subset of the load control information has\nchanged. The Load Control Sequence Number shall be incremented whenever the\nload control information is changed (see subclause 6.2.3.3.2.1).\n\nLoad Control Information shall be linked to the Node ID (i.e. FQDN or the\nIP address used during the UP function selection) of the UP function\nproviding the Information.\n\nThe receiver shall overwrite any stored load control information of a peer\nwith the newly received load control information from the same peer node if\nthe new load control information is more recent than the old information as\nindicated by the Load Control Sequence Number, e.g. if the receiver has\nstored an instance of the load control information for a peer node, it\noverwrites this instance with the new instance received in a message from\nthe same peer node.\n\nThe receiver shall consider all the parameters received in the same\ninstance of the LCI IE in conjunction while using this information for UP\nfunction selection.\n\nThe parameters are further defined in subclause\u00a06.2.3.3.2.\n\nLoad control information may be extended with new parameters in future\nversions of the specification. Any new parameter will have to be\ncategorized as:\n\n  -  Non-critical optional parameters: the support of these parameters is\n    not critical for the receiver. The receiver can successfully and\n    correctly comprehend the load control information instance, containing\n    one or more of these parameters, by using the other parameters and\n    ignoring the non-critical optional parameter.\n\n  -  Critical optional parameters: the support of these parameters is\n    critical for the receiver to correctly comprehend the instance of the\n    load control information containing one or more of these parameters.\n\nThe sender may include one or more non-critical optional parameters within\nany instance of the LCI IE without having the knowledge of the receiver's\ncapability to support the same. However, the sender shall only include one\nor more critical optional parameter in an instance of the LCI IE towards a\nreceiver if the corresponding receiver is known to support those\nparameters. The sender may be aware of this either via signalling methods\nor by configuration (this will have to be defined when introducing any such\nnew parameter in future).\n\n\n"}, {"key": "Parameters", "numbering": "6.2.3.3.2", "title_level": 4, "desc": "6.2.3.3.2   Parameters\n\n\n"}, {"key": "Load Control Sequence Number", "numbering": "6.2.3.3.2.1", "title_level": 5, "desc": "6.2.3.3.2.1 Load Control Sequence Number\n\nThe Load Control Sequence number contains a value that indicates the\nsequence number associated with the LCI IE. This sequence number shall be\nused to differentiate any two LCI IEs generated at two different instances\nby the same UP function. The Load Control Sequence Number shall be\nsupported (if load control is supported) and shall always be present in the\nLCI IE.\n\nThe UP function generating this information shall increment the Load\nControl Sequence Number whenever modifying some information in the Load\nControl Information IE. The Load Control Sequence Number shall not be\nincremented otherwise. The UP function may use the time, represented in an\nunsigned integer format, of the generation of the Load Control Information\nto populate the Load Control Sequence Number.\n\nThis parameter shall be used by the receiver of the Load Control\nInformation IE to properly collate out-of-order load control information,\ne.g. due to PFCP retransmissions. This parameter shall also be used by the\nreceiver of the LCI IE to determine whether the newly received load control\ninformation has changed compared to load control information previously\nreceived from the same node earlier.\n\n  NOTE:  The PFCP sequence number cannot be used for collating out-of-order\n         load control information as e.g. load control information may be\n         sent in both PFCP requests and responses, using independent PFCP\n         sequence numbering.\n\nIf the receiving entity has already received and stored load control\ninformation from the peer UP function, the receiving CP function shall\nupdate its load control information only if the Load Control Sequence\nNumber received in the new load control information is higher than the\nstored value of the Load Control Sequence Number associated with the peer\nUP function. However due to roll-over of the Load Control Sequence Number\nor restart of the node, the Load Control Sequence Number may be reset to an\nappropriate base value by the peer UP function, hence the receiving entity\nshall be prepared to receive (and process) a Load Control Sequence Number\nparameter whose value is less than the previous value.\n\n\n"}, {"key": "Load Metric", "numbering": "6.2.3.3.2.2", "title_level": 5, "desc": "6.2.3.3.2.2 Load Metric\n\nThe Load Metric parameter shall indicate the current load level of the\noriginating node. The computation of the Load Metric is left to\nimplementation. The node may consider various aspects, such as the used\ncapacity of the UP function, the load in the node (e.g. memory/CPU usage in\nrelationship to the total memory/CPU available, etc.).\n\nThe Load Metric represents the current load level of the sending node as a\npercentage within the range of 0 to100, where 0 means no or 0% load and 100\nmeans maximum or 100% load reached (i.e. no further load is desirable).\n\nThe Load Metric shall be supported (if load control is supported). The Load\nMetric shall always be included in the Load Control Information.\n\nConsidering the processing requirement of the receiver of the Load Control\nInformation (e.g. handling of the new information, tuning the node\nselection algorithm to take the new information into account), the sender\nshould refrain from advertising every small variation (e.g. with the\ngranularity of 1 or 2), in the Load Metric which does not result in useful\nimprovement in node selection logic at the receiver. During the typical\noperating condition of the sender, a larger variation in the Load Metric,\ne.g. 5 or more units, should be considered as reasonable enough for\nadvertising the new Load Control Information and thus justifying the\nprocessing requirement (to handle the new information) of the receiver.\n\n  NOTE:  The range of the Load Metric, i.e. 0 to 100, does not mandate the\n         sender to collect its own load information at every\n         increment/decrement and hence to advertise the change of Load\n         Metric with a granularity of 1%. Based on various implementation\n         specific criteria, such as: the architecture, session and\n         signalling capacity, the current load and so on, the sender is free\n         to define its own logic and periodicity with which its own load\n         information is collected.\n\n\n"}, {"key": "Frequency of Inclusion", "numbering": "6.2.3.3.3", "title_level": 4, "desc": "6.2.3.3.3   Frequency of Inclusion\n\nHow often the sender includes the load control information is\nimplementation specific. The sender shall ensure that new/updated load\ncontrol information is propagated to the target CP functions within an\nacceptable delay, such that the purpose of the information (i.e. effective\nload balancing) is achieved. The sender may include the LCI IE e.g. as\nfollows:\n\n  -  the sender may include Load Control Information towards a peer only\n    when the new/changed value has not already been provided to that peer;\n\n  -  the sender may include the Load Control Information in each and every\n    message (extended with LCI IE) towards the peer;\n\n  -  the sender may include Load Control Information periodically, i.e.\n    include the information during a first period then cease to do so\n    during a second period.\n\nThe sender may also implement a combination of one or more of the above\napproaches. Besides, the sender may also decide to include the Load Control\nInformation only in a subset of the applicable PFCP messages.\n\nThe receiver shall be prepared to receive the load control information in\nany of the PFCP messages extended with an LCI IE and upon such reception,\nshall be able act upon the received load control information.\n\n\n"}, {"key": "Overload Control Procedure", "numbering": "6.2.4", "title_level": 2, "desc": "6.2.4  Overload Control Procedure\n\n\n"}, {"key": "General", "numbering": "6.2.4.1", "title_level": 3, "desc": "6.2.4.1  General\n\nOverload Control is an optional feature defined over the Sxa, Sxb, Sxc and\nN4 reference points.\n\nOverload control enables a UP function becoming or being overloaded to\ngracefully reduce its incoming signalling load by instructing its peer CP\nfunctions to reduce sending traffic according to its available signalling\ncapacity to successfully process the traffic. A UP function is in overload\nwhen it operates over its signalling capacity which results in diminished\nperformance (including impacts to handling of incoming and outgoing\ntraffic).\n\nOverload control aims at shedding the incoming traffic as close to the\ntraffic source as possible generally when an overload has occurred\n(reactive action), so to avoid spreading the problem inside the network and\nto avoid using resources of intermediate nodes in the network for\nsignalling that would anyhow be discarded by the overloaded node.\n\nLoad control and overload control may be supported and activated\nindependently in the network, based on operator's policy.\n\n\n"}, {"key": "Principles", "numbering": "6.2.4.2", "title_level": 3, "desc": "6.2.4.2  Principles\n\nWhen a UP function determines that the offered incoming signalling traffic\nis growing (or is about to grow) beyond its nominal capacity, the UP\nfunction may signal its overload, at node level granularity, to its peer CP\nfunctions by including Overload Control Information in PFCP signalling\nwhich provides guidance to the receiving CP functions to decide actions\nwhich lead to signalling traffic mitigation towards the sender of the\ninformation. This helps in preventing severe overload and hence potential\nbreakdown of the UP function.\n\nThe Overload Control Information is piggybacked in PFCP request or response\nmessages such that the exchange of Overload Control Information does not\ntrigger extra signalling.\n\n  NOTE:  The inclusion of Overload Control Information in existing messages\n         means that the frequency of transmission of overload control\n         information increases as the signalling load increases, thus\n         allowing for faster feedback and better regulation.\n\nThe calculation of the Overload Control Information is implementation\ndependent and its calculation and transfer shall not add significant\nadditional load to the node itself and to its corresponding peer nodes. The\ncalculation of Overload Control Information should not severely impact the\nresource utilization of the UP function, especially considering the\noverload situation.\n\nThe overload control feature should continue to allow for preferential\ntreatment of priority users (eMPS) and emergency services.\n\nThe overload mitigation actions based on the reception of the overload\nrelated information received from the UP function will not be standardized.\n\n\n"}, {"key": "Overload Control Information", "numbering": "6.2.4.3", "title_level": 3, "desc": "6.2.4.3  Overload Control Information\n\n\n"}, {"key": "General Description", "numbering": "6.2.4.3.1", "title_level": 4, "desc": "6.2.4.3.1   General Description\n\nA PFCP message may contain one instance of the Overload Control Information\n(OCI) IE.\n\nWhen providing overload control information in a message for the first time\nor subsequently, the UP function shall always include the full set of\noverload control information, i.e. all the node level instance of the\nOverload Control Information, even if only a subset of the overload control\ninformation has changed. The Overload Control Sequence Number shall be\nincremented whenever the Overload control information is changed (see\nsubclause 6.2.4.3.2.1).\n\nThe receiver shall overwrite any stored overload control information of a\npeer with the newly received overload control information from the same\npeer node if the new overload control information is more recent than the\nold information as indicated by the Overload Control Sequence Number, e.g.\nif the receiver has stored an instance of the Overload control information\nfor a peer node, it overwrites this instance with the new instance received\nin a message from the same peer node.\n\nThe receiver shall consider all the parameters received in the same\ninstance of the OCI IE in conjunction while applying the overload\nmitigation action.\n\nThe parameters are further defined in subclause\u00a06.2.4.3.2.\n\nOverload control information may be extended with new parameters in future\nversions of the specification. Any new parameter will have to be\ncategorized as:\n\n  -  Non-critical optional parameters: the support of these parameters is\n    not critical for the receiver. The receiver can successfully and\n    correctly comprehend the Overload control information instance,\n    containing one or more of these parameters, by using the other\n    parameters and ignoring the non-critical optional parameter.\n\n  -  Critical optional parameters: the support of these parameters is\n    critical for the receiver to correctly comprehend the instance of the\n    Overload control information containing one or more of these\n    parameters.\n\nThe sender may include one or more non-critical optional parameters within\nany instance of the OCI IE without having the knowledge of the receiver's\ncapability to support the same. However, the sender shall only include one\nor more critical optional parameter in an instance of the OCI IE towards a\nreceiver if the corresponding receiver is known to support those\nparameters. The sender may be aware of this either via signalling methods\nor by configuration (this will have to be defined when introducing any such\nnew parameter in future).\n\nThe Overload Control Information shall be associated by default to the PFCP\nentity corresponding to the peer node's IP address of the PFCP session,\nover which the OCI IE is received, i.e. to the IP address received within\nthe \"UP F-SEID\" IE.\n\nAlternatively, the UP function may send Overload Control Information which\nis associated with the Node ID of the UP function (i.e. FQDN or the IP\naddress used during the UP function selection). In that case, the UP\nfunction shall provide an explicit indication that the OCI IE included in\nthe message belongs to the Node ID.\n\n\n"}, {"key": "Parameters", "numbering": "6.2.4.3.2", "title_level": 4, "desc": "6.2.4.3.2   Parameters\n\n\n"}, {"key": "Overload Control Sequence Number", "numbering": "6.2.4.3.2.1", "title_level": 5, "desc": "6.2.4.3.2.1 Overload Control Sequence Number\n\nThe PFCP protocol requires retransmitted messages to have the same contents\nas the original message. Due to PFCP retransmissions, the overload control\ninformation received by a CP function at a given time may be less recent\nthan the overload control information already received from the same UP\nfunction. The Overload Control Sequence Number aids in sequencing the\noverload control information received from an overloaded UP function. The\nOverload Control Sequence Number contains a value that indicates the\nsequence number associated with the Overload Control Information IE. This\nsequence number shall be used to differentiate between two OCI IEs\ngenerated at two different instants, by the same UP function.\n\nThe Overload Control Sequence Number parameter shall be supported (when\nsupporting the overload control feature) and shall always be present in the\nOverload Control Information IE.\n\nThe UP function generating this information shall increment the Overload\nControl Sequence Number whenever modifying some information in the OCI IE.\nThe Overload Control Sequence Number shall not be incremented otherwise.\nThe UP function may use the time, represented in an unsigned integer\nformat, of the generation of the overload control information, to populate\nthe Overload Control Sequence Number.\n\nThis parameter shall be used by the receiver of the OCI IE to properly\ncollate out-of-order OCI IEs, e.g. due to PFCP retransmissions. This\nparameter shall also be used by the receiver of the OCI IE to determine\nwhether the newly received overload control information has changed\ncompared to the overload control information previously received from the\nsame UP function. If the newly received overload control information has\nthe same Overload Control Sequence Number as the previously received\noverload control information from the same UP function, then the receiver\nmay simply discard the newly received overload control information whilst\ncontinuing to apply the overload abatement procedures, as per the previous\nvalue.\n\n  NOTE 1:  The timer corresponding to the Period of Validity (see subclause\n         6.2.4.3.2.2) is not restarted if the newly received overload\n         control information has the same Overload Control Sequence Number\n         as the previously received overload control information. If the\n         overload condition persists and the overloaded UP function needs to\n         extend the duration during which the overload information applies,\n         the sender needs to provide a new overload control information with\n         an incremented Overload Control Sequence Number (even if the\n         parameters within the overload control information have not\n         changed).\n\n  NOTE 2:  The PFCP Sequence Number cannot be used for collating out-of-\n         order overload information as e.g. overload control information may\n         be sent in both PFCP requests and responses, using independent PFCP\n         sequence numbering.\n\nIf the receiving CP function already received and stored overload control\ninformation, which is still valid, from the overloaded UP function, the\nreceiving entity shall update its overload control information, only if the\nOverload-Sequence-Number received in the new overload control information\nis larger than the value of the Overload Control Sequence Number associated\nwith the stored information. However due to roll-over of the Overload\nControl Sequence Number or restart of the UP function, the Overload Control\nSequence Number may be reset to an appropriate base value by the peer UP\nfunction, hence the receiving entity shall be prepared to receive (and\nprocess) an Overload Control Sequence Number parameter whose value is less\nthan the previous value.\n\n\n"}, {"key": "Period of Validity", "numbering": "6.2.4.3.2.2", "title_level": 5, "desc": "6.2.4.3.2.2 Period of Validity\n\nThe Period of Validity indicates the length of time during which the\noverload condition specified by the OCI IE is to be considered as valid\n(unless overridden by subsequent new overload control information).\n\nAn overload condition shall be considered as valid from the time the OCI IE\nis received until the period of validity expires or until another OCI IE\nwith a new set of information (identified using the Overload Control\nSequence Number) is received from the same UP function (at which point the\nnewly received overload control information shall prevail). The timer\ncorresponding to the period of validity shall be restarted each time an OCI\nIE with a new set of information (identified using the Overload Control\nSequence Number) is received. When this timer expires, the last received\noverload control information shall be considered outdated and obsolete,\ni.e. any associated overload condition shall be considered to have ceased.\n\nThe Period of Validity parameter shall be supported (when supporting\noverload control).\n\nThe Period of Validity parameter achieves the following:\n\n  -  it avoids the need for the overloaded UP function to include the\n    Overload Control Information IE in every PFCP messages it signals to\n    its peer CP functions when the overload state does not change; thus it\n    minimizes the processing required at the overloaded UP function and its\n    peer CP functions upon sending/receiving PFCP signalling;\n\n  -  it allows to reset the overload condition after some time in the peer\n    CP functions having received an overload indication from the overloaded\n    UP function, e.g. if no signalling traffic takes place between these\n    PFCP entities for some time due to overload mitigation actions. This\n    also removes the need for the overloaded UP function to remember the\n    list of CP functions to which it has sent a non-null overload reduction\n    metric and to which it would subsequently need to signal when the\n    overload condition ceases, if the Period of Validity parameter was not\n    defined.\n\n\n"}, {"key": "Overload Reduction Metric", "numbering": "6.2.4.3.2.3", "title_level": 5, "desc": "6.2.4.3.2.3 Overload Reduction Metric\n\nThe Overload Reduction Metric shall have a value in the range of 0 to 100\n(inclusive) which indicates the percentage of traffic reduction the sender\nof the overload control information requests the receiver to apply. An\nOverload Reduction Metric of \"0\" always indicates that the UP function is\nnot in overload (that is, no overload abatement procedures need to be\napplied) for the indicated scope.\n\nConsidering the processing requirement of the receiver of the Overload\nControl Information, e.g. to perform overload control based on the updated\nOverload Reduction Metric, the sender should refrain from advertising every\nsmall variation, e.g. with the granularity of 1 or 2, in the Overload\nReduction Metric which does not result in useful improvement for mitigating\nthe overload situation. During the typical operating condition of the\nsender, a larger variation in the Overload Reduction Metric, e.g. 5 or more\nunits, should be considered as reasonable enough for advertising a new\nOverload Reduction Metric Information and thus justifying the processing\nrequirement (to handle the new information) of the receiver.\n\n  NOTE:  The range of Overload Reduction Metric, i.e. 0 to 100, does not\n         mandate the sender to collect its own overload information at every\n         increment/decrement and hence to advertise the change of Overload\n         Reduction Metric with a granularity of 1%. Based on various\n         implementation specific criteria, such as the architecture, session\n         and signalling capacity, the current load/overload situation and so\n         on, the sender is free to define its own logic and periodicity with\n         which its own overload control information is collected.\n\nThe computation of the exact value for this parameter is left as an\nimplementation choice at the sending UP function.\n\nThe Overload Reduction Metric shall be supported (when supporting overload\ncontrol) and shall always be present in the OCI IE.\n\nThe inclusion of the OCI IE signals an overload situation is occuring,\nunless the Overload Reduction Metric is set to 0, which signals that the\noverload condition has ceased. Conversely, the absence of the OCI IE in a\nmessage does not mean that the overload has abated.\n\n\n"}, {"key": "Frequency of Inclusion", "numbering": "6.2.4.3.3", "title_level": 4, "desc": "6.2.4.3.3   Frequency of Inclusion\n\nHow often or when the sender includes the overload control information is\nimplementation specific. The sender shall ensure that new/updated overload\ncontrol information is propagated to the target receivers with an\nacceptable delay, such that the purpose of the information, (i.e. the\neffective overload control protection) is achieved. The following are some\nof the potential approaches the sender may implement for including the OCI\nIE:\n\n  -  the sender may include OCI IE towards a receiver only when the\n    new/changed value has not already been provided to the given receiver;\n\n  -  the sender may include the OCI IE in a subset of the messages towards\n    the receiver;\n\n  -  the sender may include the OCI IE periodically, i.e. include the\n    information during a first period then cease to do so during a second\n    period.\n\nThe sender may also implement a combination of one or more of the above\napproaches. Besides, the sender may also include the OCI IE only in a\nsubset of the applicable PFCP messages.\n\nThe receiver shall be prepared to receive the overload control information\nreceived in any of the PFCP messages extended with an OCI IE and upon such\nreception, shall be able act upon the received information.\n\n\n"}, {"key": "Message Throttling", "numbering": "6.2.4.4", "title_level": 3, "desc": "6.2.4.4  Message Throttling\n\n\n"}, {"key": "General", "numbering": "6.2.4.4.1", "title_level": 4, "desc": "6.2.4.4.1   General\n\nAs part of the overload mitigation, a CP function shall reduce the total\nnumber of messages, which would have been sent otherwise, towards the\noverloaded peer based on the information received within the Overload\nControl Information. This shall be achieved by discarding a fraction of the\nmessages in proportion to the overload level of the target peer. This is\ncalled \"message throttling\".\n\nMessage throttling shall only apply to Request messages. Response messages\nshould not be throttled since that would result in the retransmission of\nthe corresponding request message by the sender.\n\nA CP function supporting PFCP overload control shall support and use the\n\"Loss\" algorithm as specified in this clause, for message throttling.\n\n\n"}, {"key": "Throttling algorithm \u2013 \"Loss\"", "numbering": "6.2.4.4.2", "title_level": 4, "desc": "6.2.4.4.2   Throttling algorithm \u2013 \"Loss\"\n\n\n"}, {"key": "Description", "numbering": "6.2.4.4.2.1", "title_level": 5, "desc": "6.2.4.4.2.1 Description\n\nAn overloaded UP function shall ask its peers to reduce the number of\nrequests they would ordinarily send by signalling Overload Control\nInformation including the requested traffic reduction, as a percentage,\nwithin the \"Overload-Reduction-Metric\", as specified in subclause\n6.2.4.3.2.\n\nThe recipients of the \"Overload-Reduction-Metric\" shall reduce the number\nof requests sent by that percentage, either by redirecting them to an\nalternate destination if possible (e.g. the PFCP Session Establishment\nRequest message may be redirected to an alternate UP function), or by\nfailing the request and treating it as if it was rejected by the\ndestination UP function.\n\nFor example, if a sender requests another peer to reduce the traffic it is\nsending by 10%, then that peer shall throttle 10% of the traffic that would\nhave otherwise been sent to this UP function.\n\nThe overloaded UP function should periodically adjust the requested traffic\nreduction based e.g. on the traffic reduction factor that is currently in\nuse, the current system utilization (i.e. the overload level) and the\ndesired system utilization (i.e. the target load level), and/or the rate of\nthe current overall received traffic.\n\nAnnex\u00a0A.1 provides an (informative) example of a possible implementation of\nthe \"Loss\" algorithm, amongst other possible methods.\n\n  NOTE 1:  This algorithm does not guarantee that the future traffic\n         towards the overloaded UP function will be less than the past\n         traffic but it ensures that the total traffic sent towards the\n         overloaded UP function is less than what would have been sent\n         without any throttling in place. If after requesting a certain\n         reduction in traffic, the overloaded UP function receives more\n         traffic than in the past, whilst still in overload, leading to the\n         worsening rather than an improvement in the overload level, then\n         the overloaded UP function can request for more reduction in\n         traffic. Thus, by periodically adjusting the requested traffic\n         reduction, the overloaded node can ensure that it receives,\n         approximately, the amount of traffic which it can handle.\n\n  NOTE 2:  Since the reduction is requested as a percentage, and not as an\n         absolute amount, this algorithm achieves a good useful throughput\n         towards the overloaded node when the traffic conditions vary at the\n         source nodes (depending upon the events generated towards these\n         source nodes by other entities in the network), as a potential\n         increase of traffic from some source nodes can possibly be\n         compensated by a potential decrease of traffic from other source\n         nodes.\n\n\n"}, {"key": "Message Prioritization", "numbering": "6.2.4.5", "title_level": 3, "desc": "6.2.4.5  Message Prioritization\n\n\n"}, {"key": "Description", "numbering": "6.2.4.5.1", "title_level": 4, "desc": "6.2.4.5.1   Description\n\nWhen performing message throttling:\n\n  -  PFCP requests related to priority traffic (i.e. eMPS as described in\n    3GPP\u00a0TS\u00a022.153\u00a0[15]) and emergency have the highest priority. Depending\n    on regional/national requirements and network operator policy, these\n    PFCP requests shall be the last to be throttled, when applying traffic\n    reduction, and the priority traffic shall be exempted from throttling\n    due to PFCP overload control up to the point where the requested\n    traffic reduction cannot be achieved without throttling the priority\n    traffic;\n\n  -  for other types of sessions, messages throttling should consider the\n    relative priority of the messages so that the messages which are\n    considered as low priority are considered for throttling before the\n    other messages. The relative priority of the messages may be derived\n    from the relative priority of the procedure for which the message is\n    being sent or may be derived from the session parameters such as APN,\n    QCI, ARP and/or Low Access Priority Indicator (LAPI).\n\n  NOTE:  A random throttling mechanism, i.e. discarding the messages\n         without any special consideration, could result in an overall poor\n         congestion mitigation mechanism and bad user experience.\n\nAn overloaded node may also apply these message prioritization schemes when\nhandling incoming initial messages during an overloaded condition, as part\nof a self-protection mechanism.\n\n\n"}, {"key": "Based on the Message Priority Signalled in the PFCP Message", "numbering": "6.2.4.5.2", "title_level": 4, "desc": "6.2.4.5.2   Based on the Message Priority Signalled in the PFCP Message\n\nMessage prioritization may be performed by an overloaded node, when\nhandling incoming messages during an overloaded condition, based on the\nrelative PFCP message priority signalled in the PFCP header (see\nsubclause\u00a07.2.2.3).\n\nA PFCP entity shall determine whether to set and use the message priority\nin PFCP signalling, based on operator policy. The requirements specified in\nthis subclause shall apply if message priority in PFCP signalling is used.\n\nA sending PFCP entity shall determine the relative message priority to\nsignal in the message according to the principles specified in\nsubclause\u00a06.2.4.5.1. If the message affects multiple bearers, the relative\nmessage priority should be determined considering the highest priority ARP\namong all the bearers.\n\nA PFCP entity should set the same message priority in a Response message as\nreceived in the corresponding Request message.\n\nFor incoming PFCP messages that do not have a message priority in the PFCP\nheader, the receiving PFCP entity:\n\n  -  shall apply a default priority, if the incoming message is a Request\n    message;\n\n  -  should apply the message priority sent in the Request message, if the\n    incoming message is a Response message.\n\nThis feature should be supported homogenously across the CP functions and\nUP functions in the network, otherwise an overloaded node will process\nRequest messages received from the non-supporting nodes according to the\ndefault priority while Request messages received from supporting nodes will\nbe processed according to the message priority signalled in the PFCP\nmessage.\n\n\n"}, {"key": "PFCP PFD Management Procedure", "numbering": "6.2.5", "title_level": 2, "desc": "6.2.5  PFCP PFD Management Procedure\n\n\n"}, {"key": "General", "numbering": "6.2.5.1", "title_level": 3, "desc": "6.2.5.1  General\n\nThe PFCP PFD Management procedure may be used by the CP function and UP\nfunction to provision PFDs to the UP function, for one or more Application\nIdentifiers, as specified in subclauses\u00a05.11.4 and 6.5.2 of\n3GPP\u00a0TS\u00a023.214\u00a0[2].\n\nSupport of this procedure is optional for the CP function and the UP\nfunction. The UP function shall set the PFDM feature flag in the UP\nFunction Features IE if it supports the PFD Management procedure (see\nsubclause\u00a08.2.25).\n\nThe UP function shall store the PFDs provisioned per Application\nIdentifier. These PFDs shall apply to all the PFCP session established in\nthe UP function, for all the controlling CP functions, i.e. the scope of a\nPFD is not limited to the PFCP sessions established by the CP function\nwhich provisioned the PFD.\n\n\n"}, {"key": "CP Function Behaviour", "numbering": "6.2.5.2", "title_level": 3, "desc": "6.2.5.2  CP Function Behaviour\n\nThe CP function initiates the PFCP PFD Management procedure to provision\nPFDs in the UP function, for one or more Application Identifier(s).\n\nThe CP function:\n\n  -  shall send the PFCP PFD Management Request message, including the full\n    set of PFD IDs and PFD contents to be provisioned in the UP function\n    per Application Identifier.\n\nWhen the CP function receives an PFCP PFD Management Response with cause\nsuccess, the CP function shall consider that the PFDs have been provisioned\nas requested.\n\n\n"}, {"key": "UP Function Behaviour", "numbering": "6.2.5.3", "title_level": 3, "desc": "6.2.5.3  UP Function Behaviour\n\nWhen the UP function receives an PFCP PFD Management Request message, it\nshall:\n\n  -  if no Application ID's PFDs IE is present in the request (i.e. empty\n    message),\n\n    -  delete all the PFDs received and stored earlier for all Application\n       Identifier(s);\n\n  -  if at least one Application ID's PFDs IE is present in the request,\n\n    -  delete all the PFDs received and stored earlier for the indicated\n       Application Identifier(s);\n\n    -  store all the PFDs received in the request for the indicated\n       Application Identifier(s);\n\n  -  send an PFCP PFD Management Response with the cause \"success\", if the\n    above operations were performed successfully.\n\n\n"}, {"key": "PFCP Association Setup Procedure", "numbering": "6.2.6", "title_level": 2, "desc": "6.2.6  PFCP Association Setup Procedure\n\n\n"}, {"key": "General", "numbering": "6.2.6.1", "title_level": 3, "desc": "6.2.6.1  General\n\nThe PFCP Association Setup procedure shall be used to setup an PFCP\nassociation between the CP function and the UP function, to enable the CP\nfunction to use the resources of the UP function subsequently, i.e.\nestablish PFCP Sessions.\n\nThe setup of an PFCP association may be initiated by the CP function (see\nsubclause 6.2.6.2) or the UP function (see subclause 6.2.6.3).\n\nThe CP function and the UP function shall support the PFCP Association\nSetup initiated by the CP function. The CP function and the UP function may\nadditionally support the PFCP Association Setup initiated by the UP\nfunction.\n\n\n"}, {"key": "PFCP Association Setup Initiated by the CP Function", "numbering": "6.2.6.2", "title_level": 3, "desc": "6.2.6.2  PFCP Association Setup Initiated by the CP Function\n\n\n"}, {"key": "CP Function Behaviour", "numbering": "6.2.6.2.1", "title_level": 4, "desc": "6.2.6.2.1   CP Function Behaviour\n\nThe CP function initiates the PFCP Association Setup procedure to request\nto setup an PFCP association towards a UP function prior to establishing a\nfirst PFCP session on this UP function.\n\nThe CP function:\n\n  -  shall send the PFCP Association Setup Request with the Node ID of the\n    CP function;\n\n  -  shall include the list of optional features the CP function supports\n    which may affect the UP function behaviour, if any.\n\nThe CP function shall only initiate PFCP Session related signalling\nprocedures toward a UP function after it receives the PFCP Association\nSetup Response with a successful cause from this UP function.\n\nThe CP function shall determine whether the UP function supports Sxa, Sxb,\nSxc and/or combined Sxa/Sxb by local configuration or optionally via DNS if\ndeployed.\n\n\n"}, {"key": "UP Function behaviour", "numbering": "6.2.6.2.2", "title_level": 4, "desc": "6.2.6.2.2   UP Function behaviour\n\nWhen receiving an PFCP Association Setup Request, the UP function:\n\n  -  if the request is accepted:\n\n    -  shall store the Node ID of the CP function as the identifier of the\n       PFCP association;\n\n    -  shall send an PFCP Association Setup Response with a successful\n       cause, including all supported optional features in the UP function\n       and optionally including the available user plane resources, e.g. IP\n       address(es) or F-TEID range;\n\n  -  shall send an PFCP Version Not Supported Response if the PFCP header\n    of the request indicates a PFCP protocol version that is not supported\n    by the UP function;\n\n  -  otherwise, shall send an PFCP Association Setup Response with an\n    appropriate error cause if the request is rejected.\n\n\n"}, {"key": "PFCP Association Setup Initiated by the UP Function", "numbering": "6.2.6.3", "title_level": 3, "desc": "6.2.6.3  PFCP Association Setup Initiated by the UP Function\n\n\n"}, {"key": "UP Function Behaviour", "numbering": "6.2.6.3.1", "title_level": 4, "desc": "6.2.6.3.1   UP Function Behaviour\n\nThe UP function initiates the PFCP Association Setup procedure to request\nto setup an PFCP association towards a CP function. The UP function is\nconfigured with a set of CP functions to which it shall establish an PFCP\nassociation.\n\nThe UP function shall send the PFCP Association Setup Request including:\n\n  -  the Node ID of the UP function;\n\n  -  all supported optional features in the UP function and optionally\n    including the available user plane resources, e.g. IP address(es) or F-\n    TEID range.\n\n\n"}, {"key": "CP Function Behaviour", "numbering": "6.2.6.3.2", "title_level": 4, "desc": "6.2.6.3.2   CP Function Behaviour\n\nWhen receiving an PFCP Association Setup Request, the CP function:\n\n  -  if the request is accepted:\n\n    -  shall store the Node ID of the UP function as the identifier of the\n       PFCP association;\n\n    -  shall include the list of optional features the CP function supports\n       which may affect the UP function behaviour, if any;\n\n  -  shall send an PFCP Version Not Supported Response if the PFCP header\n    of the request indicates a PFCP protocol version that is not supported\n    by the CP function;\n\n  -  otherwise, shall send an PFCP Association Setup Response with an\n    appropriate error cause if the request is rejected.\n\nThe CP function shall only initiate PFCP Session related signalling\nprocedures toward a UP function after it has sent the PFCP Association\nSetup Response with a successful cause to the UP function.\n\nThe CP function shall determine the UP function supports Sxa, Sxb, Sxc\nand/or combined Sxa/Sxb by local configuration or optionally via DNS if\ndeployed.\n\n\n"}, {"key": "PFCP Association Update Procedure", "numbering": "6.2.7", "title_level": 2, "desc": "6.2.7  PFCP Association Update Procedure\n\n\n"}, {"key": "General", "numbering": "6.2.7.1", "title_level": 3, "desc": "6.2.7.1  General\n\nThe PFCP Association Update procedure shall be used to modify an existing\nPFCP association between the CP function and the UP function. It may be\ninitiated by the UP function or by the CP function to update the supported\nfeatures or available resources of the UP function.\n\n\n"}, {"key": "PFCP Association Update Procedure Initiated by the CP Function", "numbering": "6.2.7.2", "title_level": 3, "desc": "6.2.7.2  PFCP Association Update Procedure Initiated by the CP Function\n\n\n"}, {"key": "CP Function Behaviour", "numbering": "6.2.7.2.1", "title_level": 4, "desc": "6.2.7.2.1   CP Function Behaviour\n\nThe CP function initiates the PFCP Association Update procedure to report\nchanges to the PFCP association to the UP function, e.g. to update the\nsupported features.\n\n\n"}, {"key": "UP Function Behaviour", "numbering": "6.2.7.2.2", "title_level": 4, "desc": "6.2.7.2.2   UP Function Behaviour\n\nWhen receiving an PFCP Association Update Request, the UP function:\n\n  -  shall update the list of optional features of the CP function, when\n    received;\n\n  -  shall send an PFCP Association Update Response with an appropriate\n    error cause if the Node ID is not known by the UP Function;\n\n  -  shall return an PFCP Association Update Response with a successful\n    cause value, if the PFCP Association Update Request is handled\n    successfully.\n\n\n"}, {"key": "PFCP Association Update Procedure Initiated by UP Function", "numbering": "6.2.7.3", "title_level": 3, "desc": "6.2.7.3  PFCP Association Update Procedure Initiated by UP Function\n\n\n"}, {"key": "UP Function Behaviour", "numbering": "6.2.7.3.1", "title_level": 4, "desc": "6.2.7.3.1   UP Function Behaviour\n\nThe UP function initiates the PFCP Association Update procedure to report\nchanges to the PFCP association to the CP function, e.g. change of optional\nfeatures, change of the available user plane resources, an indication to\nrequest to release the PFCP association.\n\nThe UP function may send an PFCP Association Update Request to request the\nCP function to perform the release of the PFCP association, optionally\nproviding a Graceful Release Period. After reception of the PFCP\nAssociation Update Response, the UP function shall consider that the PFCP\nassociation is still setup until receiving an PFCP Association Release\nRequest.\n\n\n"}, {"key": "CP Function Behaviour", "numbering": "6.2.7.3.2", "title_level": 4, "desc": "6.2.7.3.2   CP Function Behaviour\n\nWhen receiving an PFCP Association Update Request, the CP function:\n\n  -  shall update the list of optional features of the UP function, when\n    received;\n\n  -  shall send an PFCP Association Update Response with an appropriate\n    error cause if the Node ID is not known by the CP Function;\n\n  -  shall return an PFCP Association Update Response with a successful\n    cause value if the PFCP Association Update Request is handled\n    successfully.\n\nIf the UP function has requested to release the PFCP association in the\nPFCP Association Update Request, the CP function should initiate an PFCP\nAssociation Release Request to release the PFCP association, as soon as\npossible if no Graceful Release Period was included in the request or\nbefore the expiry of the Graceful Release Period.\n\nIf the UP function has included User Plane IP Resource Information IE in\nthe PFCP Association Update Request message, the CP function shall use it\nto overwrite the User Plane IP Resource Information previously received\nfrom the UP function.\n\n\n"}, {"key": "PFCP Association Release Procedure", "numbering": "6.2.8", "title_level": 2, "desc": "6.2.8  PFCP Association Release Procedure\n\n\n"}, {"key": "General", "numbering": "6.2.8.1", "title_level": 3, "desc": "6.2.8.1  General\n\nThe PFCP Association Release procedure shall be used to terminate the PFCP\nassociation between the CP Function and the UP Function due to e.g. OAM\nreasons. The PFCP Association Release Request may be initiated by the CP\nfunction.\n\n\n"}, {"key": "CP Function Behaviour", "numbering": "6.2.8.2", "title_level": 3, "desc": "6.2.8.2  CP Function Behaviour\n\nIf the CP function initiates the PFCP Association Release procedure to\nrelease an existing PFCP association, the CP function:\n\n  -  shall delete locally all the PFCP sessions related to that PFCP\n    association when receiving the PFCP Association Release Response with\n    the cause value success.\n\n\n"}, {"key": "UP Function behaviour", "numbering": "6.2.8.3", "title_level": 3, "desc": "6.2.8.3  UP Function behaviour\n\nWhen the UP function receives an PFCP Association Release Request, the UP\nfunction:\n\n  -  shall delete all the PFCP sessions related to that PFCP association\n    locally;\n\n  -  shall delete the PFCP association and any related information (e.g.\n    Node ID of the CP function);\n\n  -  shall send an PFCP Association Release Response with a successful\n    cause.\n\n  NOTE:  The UP function always accepts an PFCP Association Release\n         Request.\n\n\n"}, {"key": "PFCP Node Report Procedure", "numbering": "6.2.9", "title_level": 2, "desc": "6.2.9  PFCP Node Report Procedure\n\n\n"}, {"key": "General", "numbering": "6.2.9.1", "title_level": 3, "desc": "6.2.9.1  General\n\nThe PFCP Node Report procedure shall be used by the UP function to report\ninformation to the CP function which is not related to a specific PFCP\nsession, e.g. to report a user plane path failure affecting all the PFCP\nsessions towards a remote GTP-U peer.\n\n\n"}, {"key": "UP Function Behaviour", "numbering": "6.2.9.2", "title_level": 3, "desc": "6.2.9.2  UP Function Behaviour\n\nThe UP function shall initiate the PFCP Node Report procedure to report\ninformation to the CP function. The UP function:\n\n  -  shall send the PFCP Node Report Request message, including the\n    information to be reported.\n\nWhen the UP function receives an PFCP Node Report Response with the cause\nsuccess, the UP function shall consider the information successfully\ndelivered to the CP function.\n\n\n"}, {"key": "CP Function behaviour", "numbering": "6.2.9.3", "title_level": 3, "desc": "6.2.9.3  CP Function behaviour\n\nWhen the CP function receives an PFCP Node Report Request message, it\nshall:\n\n  -  process the information being reported as appropriate and send an PFCP\n    Node Report Response with the cause \"success\";\n\n  -  otherwise return an appropriate error cause value.\n\n\n"}, {"key": "PFCP Session Related Procedures", "numbering": "6.3", "title_level": 1, "desc": "6.3  PFCP Session Related Procedures\n\n\n"}, {"key": "General", "numbering": "6.3.1", "title_level": 2, "desc": "6.3.1  General\n\nThe following subclauses describe the session related procedures over the\nSxa, Sxb and Sxc reference points. The behaviour of the CP function and UP\nfunction when sending and receiving session related messages is described.\n\n\n"}, {"key": "PFCP Session Establishment Procedure", "numbering": "6.3.2", "title_level": 2, "desc": "6.3.2  PFCP Session Establishment Procedure\n\n\n"}, {"key": "General", "numbering": "6.3.2.1", "title_level": 3, "desc": "6.3.2.1  General\n\nThe PFCP Session Establishment procedure shall be used to setup an PFCP\nsession between CP function and UP function and configure Rules in the UP\nfunction so that the UP function can handle incoming packets.\n\n\n"}, {"key": "CP Function Behaviour", "numbering": "6.3.2.2", "title_level": 3, "desc": "6.3.2.2  CP Function Behaviour\n\nThe CP function initiates the PFCP Session Establishment procedure to\ncreate a PFCP session for a PDN connection, or IP-CAN session or TDF\nsession or for applying a certain IP packets treatment which is not\nassociated with any PDN connection or TDF session.\n\nThe CP function:\n\n  -  shall send the PFCP Session Establishment Request message with a new\n    PFCP F-SEID together with Rules to be created;\n\n  -  may assign a local F-TEID for the access side and/or core side and\n    provide it in the PDI, if F-TEID allocation is performed in the CP\n    function.\n\nWhen the CP function receives an PFCP Session Establishment Response with\ncause success, the CP function shall continue with the procedure which\ntriggered the PFCP Session Establishment procedure.\n\n\n"}, {"key": "UP Function Behaviour", "numbering": "6.3.2.3", "title_level": 3, "desc": "6.3.2.3  UP Function Behaviour\n\nWhen the UP function receives an PFCP Session Establishment Request message\nit shall:\n\n  -  store and apply the rules received in the request and send an PFCP\n    Session Establishment Response with cause \"success\", if all rules in\n    the PFCP Session Establishment Request are stored and applied;\n\n  -  Otherwise, if at least one rule failed to be stored or applied, return\n    an appropriate error cause value with the Rule ID of the Rule causing\n    the first error, discard all the received rules and not create any PFCP\n    session context.\n\n\n"}, {"key": "PFCP Session Modification Procedure", "numbering": "6.3.3", "title_level": 2, "desc": "6.3.3  PFCP Session Modification Procedure\n\n\n"}, {"key": "General", "numbering": "6.3.3.1", "title_level": 3, "desc": "6.3.3.1  General\n\nThe PFCP Session Modification procedure shall be used to modify an existing\nPFCP session, e.g. to configure a new rule, to modify an existing rule, to\ndelete an existing rule.\n\n\n"}, {"key": "CP Function behaviour", "numbering": "6.3.3.2", "title_level": 3, "desc": "6.3.3.2  CP Function behaviour\n\nThe CP function initiates the PFCP Session Modification procedure to modify\nan existing PFCP session, e.g. triggered by an modification of PDN\nconnection, IP CAN session or TDF session.\n\nThe CP function shall:\n\n  -  include a complete PDI if the PDI in the existing PDR is to be\n    updated;\n\n  -  remove locally the reference to a rule in the PDRs when the related\n    Rule is deleted;\n\n  -  provide all the new, updated or deleted Rules. The Updated Rules shall\n    contain only the information which are changed, added and/or deleted.\n\nThe CP function shall not include multiple updates in a PFCP Modification\nRequest message, e.g. Create PDR, Update PDR and Remove PDR, for the same\nrule identified by the Rule ID.\n\nWhen the CP function receives an PFCP Session Modification Response with\nthe cause \"success\" it shall continue with the procedure which has\ninitiated the PFCP Session Modification procedure.\n\n\n"}, {"key": "UP Function Behaviour", "numbering": "6.3.3.3", "title_level": 3, "desc": "6.3.3.3  UP Function Behaviour\n\nWhen the UP function receives a PFCP Session Modification Request it shall:\n\n  -  send the PFCP Session Modification Response message with a rejection\n    cause value set to \"Session context not found\" if the F-SEID included\n    in the PFCP Session Modification Request message is unknown;\n\n  -  reject a modification request which would relate to a rule not\n    existing in the UP function;\n\n  -  discard any updates on the PFCP session context included in the PFCP\n    Session Modification Request message if the request is rejected and\n    send an PFCP Session Modification Response with an appropriate error\n    cause together with additional information e.g. indicating the first\n    Rule ID of the Rule causing the error. In this case, the UP function\n    shall continue with the existing PFCP session context for the PFCP\n    session as if the PFCP Session Modification Request had not been\n    received;\n\n  -  remove all rules identified by a Rule ID to be removed and remove the\n    Rule ID from the PDR(s) from where they are referenced;\n\n  -  send the PFCP Session Modification Response with an acceptance cause\n    value if all the requested modifications are accepted and performed\n    successfully.\n\n\n"}, {"key": "PFCP Session Deletion Procedure", "numbering": "6.3.4", "title_level": 2, "desc": "6.3.4  PFCP Session Deletion Procedure\n\n\n"}, {"key": "General", "numbering": "6.3.4.1", "title_level": 3, "desc": "6.3.4.1  General\n\nThe PFCP Session Deletion procedure shall be used to delete an existing\nPFCP session between the CP function and the UP function.\n\n\n"}, {"key": "CP Function Behaviour", "numbering": "6.3.4.2", "title_level": 3, "desc": "6.3.4.2  CP Function Behaviour\n\nThe CP function initiates an PFCP Session Deletion procedure towards the UP\nfunction to delete an existing PFCP session e.g. when the corresponding PDN\nis deleted.\n\nThe CP shall:\n\n  -  send an PFCP Session Deletion Request with the F-SEID identifying the\n    PFCP session.\n\nWhen the CP function receives PFCP Session Deletion Response with cause\nsuccess, the CP function shall continue with the procedure which triggers\nthe PFCP Session Deletion procedure.\n\n\n"}, {"key": "UP Function Behaviour", "numbering": "6.3.4.3", "title_level": 3, "desc": "6.3.4.3  UP Function Behaviour\n\nWhen the UP function receives a PFCP Session Deletion Request it shall:\n\n  -  send the PFCP Session Deletion Response message with a rejection cause\n    set to \"Session context not found\" if the F-SEID include in the PFCP\n    Session Deletion Request message is unknown;\n\n  -  send the PFCP Session Deletion Response message with an acceptance\n    cause if the PFCP session and associated rules are deleted\n    successfully, and include any pending Usage Report(s) in the message.\n\n\n"}, {"key": "PFCP Session Report Procedure", "numbering": "6.3.5", "title_level": 2, "desc": "6.3.5  PFCP Session Report Procedure\n\n\n"}, {"key": "General", "numbering": "6.3.5.1", "title_level": 3, "desc": "6.3.5.1  General\n\nThe PFCP Session Report procedure shall be used by the UP function to\nreport information related to the PFCP session to the CP function.\n\n\n"}, {"key": "UP Function Behaviour", "numbering": "6.3.5.2", "title_level": 3, "desc": "6.3.5.2  UP Function Behaviour\n\nThe UP function shall initiate the PFCP Session Report procedure to report\ninformation related to an PFCP session to the CP function. The UP function:\n\n  -  shall send the PFCP Session Report Request message, identifying the\n    PFCP session for which the report is sent and including the information\n    to be reported.\n\nWhen the UP function receives an PFCP Session Report Response with the\ncause success, the UP function shall consider the information to be\nsuccessfully delivered to the CP function.\n\n\n"}, {"key": "CP Function Behaviour", "numbering": "6.3.5.3", "title_level": 3, "desc": "6.3.5.3  CP Function Behaviour\n\nWhen the CP function receives an PFCP Session Report Request message, it\nshall:\n\n  -  send the PFCP Session Report Response message with a rejection cause\n    set to \"Session context not found\" if the F-SEID included in the PFCP\n    Session Report Request message is unknown;\n\n  -  process the information being reported as appropriate and send an PFCP\n    Session Report Response with the cause \"success\";\n\n  -  otherwise return an appropriate error cause value.\n\n\n"}, {"key": "Reliable Delivery of PFCP Messages", "numbering": "6.4", "title_level": 1, "desc": "6.4  Reliable Delivery of PFCP Messages\n\nReliable delivery of PFCP messages is accomplished by retransmission of\nthese messages as specified in this subclause.\n\nA PFCP entity shall maintain, for each triplet of local IP address, local\nUDP port and remote peer's IP address, a sending queue with Request\nmessages to be sent to that peer. Each message shall be sent with a\nSequence Number and be held until a corresponding Response is received or\nuntil the PFCP entity ceases retransmission of that message. The Sequence\nNumber shall be unique for each outstanding Request message sourced from\nthe same IP/UDP endpoint. A PFCP entity may have several outstanding\nRequests waiting for replies.\n\nWhen sending a Request message, the sending PFCP entity shall start a timer\nT1. The sending entity shall consider that the Request message has been\nlost if a corresponding Response message has not been received before the\nT1 timer expires. If so, the sending entity shall retransmit the Request\nmessage, if the total number of retry attempts is less than N1 times. The\nsetting of the T1 timer and N1 counter is implementation specific.\n\nA retransmitted PFCP message shall have the same message content, including\nthe same PFCP header, UDP ports, source and destination IP addresses as the\noriginally transmitted message.\n\nA Request and its Response message shall have the same Sequence Number\nvalue, i.e. the Sequence Number in the PFCP header of the Response message\nshall be copied from the respective Request message. A Request and its\nResponse messages are matched based on the Sequence Number and the IP\naddress and UDP port.\n\nNot counting retransmissions, a Request message shall be answered with a\nsingle Response message. Duplicated Response messages shall be discarded by\nthe receiver. A received Response message not matching an outstanding\nRequest message waiting for a reply should be discarded.\n\nThe PFCP entity should inform the upper layer when detecting an\nunsuccessful transfer of a Request message to enable the controlling upper\nentity to take any appropriate measure.\n\n\n"}, {"key": "Messages and Message Formats", "numbering": "7", "title_level": 0, "desc": "7  Messages and Message Formats\n\n\n"}, {"key": "Transmission Order and Bit Definitions", "numbering": "7.1", "title_level": 1, "desc": "7.1  Transmission Order and Bit Definitions\n\nPFCP messages shall be transmitted in network octet order starting with\noctet 1 with the most significant bit sent first.\n\nThe most significant bit of an octet in a PFCP message is bit 8. If a field\nin a PFCP message spans over several octets, the most significant bit is\nbit 8 of the octet with the lowest number, unless specified otherwise.\n\n\n"}, {"key": "Message Format", "numbering": "7.2", "title_level": 1, "desc": "7.2  Message Format\n\n\n"}, {"key": "General", "numbering": "7.2.1", "title_level": 2, "desc": "7.2.1  General\n\nThe format of a PFCP message is depicted in Figure 7.2.1-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |m+1 to n|Zero or more Information Element(s) |    |\n| |        |                                    |    |\n\n\n                     Figure 7.2.1-1: PFCP Message Format\n\nA PFCP message shall contain the PFCP message header and may contain\nsubsequent information element(s) dependent on the type of message.\n\n\n"}, {"key": "Message Header", "numbering": "7.2.2", "title_level": 2, "desc": "7.2.2  Message Header\n\n\n"}, {"key": "General Format", "numbering": "7.2.2.1", "title_level": 3, "desc": "7.2.2.1  General Format\n\nPFCP messages use a variable length header. The message header length shall\nbe a multiple of 4 octets. Figure 7.2.2.1-1 illustrates the format of the\nPFCP Header.\n\n\n\n|       |  |Bits                                 |\n|Octets |  |8   |7   |6   |5   |4   |3   |2   |1   |\n|1      |  |Version      |Spar|Spar|Spar|MP  |S   |\n|       |  |             |e   |e   |e   |    |    |\n|2      |  |Message Type                         |\n|3      |  |Message Length (1st Octet)           |\n|4      |  |Message Length (2nd Octet)           |\n|m to   |  |If S flag is set to 1, then SEID     |\n|k(m+7) |  |shall be placed into octets 5-12.    |\n|       |  |Otherwise, SEID field is not present |\n|       |  |at all.                              |\n|n to   |  |Sequence Number                      |\n|(n+2)  |  |                                     |\n|(n+3)  |  |Spare                                |\n\n\n               Figure 7.2.2.1-1: General format of PFCP Header\n\nWhere:\n\n  -  if S = 0, SEID field is not present, k = 0, m = 0 and n = 5;\n\n  -  if S = 1, SEID field is present, k = 1, m = 5 and n = 13.\n\nThe usage of the PFCP header is defined in subclause 7.2.2.4.\n\nOctet 1 bits shall be encoded as follows:\n\n  -  Bit 1 represents the SEID flag (T).\n\n  -  Bit 2 represents the \"MP\" flag (see subclause 7.2.2.4.1).\n\n  -  Bit 3 to 5 are spare, the sender shall set them to \"0\" and the\n    receiving entity shall ignore them.\n\n  -  Bits 6-8 represent the Version field.\n\n\n"}, {"key": "PFCP Header for Node Related Messages", "numbering": "7.2.2.2", "title_level": 3, "desc": "7.2.2.2  PFCP Header for Node Related Messages\n\nThe PFCP message header for the node related messages shall not contain the\nSEID field, but shall contain the Sequence Number field, followed by one\nspare octet as depicted in figure 7.2.2.2-1. The spare bits shall be set to\nzero by the sender and ignored by the receiver. For the Version Not\nSupported Response message, the Sequence Number may be set to any number\nand shall be ignored by the receiver.\n\n\n\n|       |  |Bits                                 |\n|Octets |  |8   |7   |6   |5   |4   |3   |2   |1   |\n|1      |  |Version      |Spar|Spar|Spar|MP=0|S=0 |\n|       |  |             |e   |e   |e   |    |    |\n|2      |  |Message Type                         |\n|3      |  |Message Length (1st Octet)           |\n|4      |  |Message Length (2nd Octet)           |\n|5      |  |Sequence Number (1st Octet)          |\n|6      |  |Sequence Number (2nd Octet)          |\n|7      |  |Sequence Number (3rd Octet)          |\n|8      |  |Spare                                |\n\n\n       Figure 7.2.2.2-1: PFCP Message Header for node related messages\n\n\n"}, {"key": "PFCP Header for Session Related Messages", "numbering": "7.2.2.3", "title_level": 3, "desc": "7.2.2.3  PFCP Header for Session Related Messages\n\nFor The PFCP message header, for session related messages, shall contain\nthe SEID and Sequence Number fields followed by one spare octet. The PFCP\nheader is depicted in figure\u00a07.2.2.3-1. The spare bits shall be set to zero\nby the sender and ignored by the receiver.\n\n\n\n|       |  |Bits                                 |\n|Octets |  |8   |7   |6   |5   |4   |3   |2   |1   |\n|1      |  |Version      |Spar|Spar|Spar|MP  |S=1 |\n|       |  |             |e   |e   |e   |    |    |\n|2      |  |Message Type                         |\n|3      |  |Message Length (1st Octet)           |\n|4      |  |Message Length (2nd Octet)           |\n|5      |  |Session Endpoint Identifier (1st     |\n|       |  |Octet)                               |\n|6      |  |Session Endpoint Identifier (2nd     |\n|       |  |Octet)                               |\n|7      |  |Session Endpoint Identifier (3rd     |\n|       |  |Octet)                               |\n|8      |  |Session Endpoint Identifier (4th     |\n|       |  |Octet)                               |\n|9      |  |Session Endpoint Identifier (5th     |\n|       |  |Octet)                               |\n|10     |  |Session Endpoint Identifier (6th     |\n|       |  |Octet)                               |\n|11     |  |Session Endpoint Identifier (7th     |\n|       |  |Octet)                               |\n|12     |  |Session Endpoint Identifier (8th     |\n|       |  |Octet)                               |\n|13     |  |Sequence Number (1st Octet)          |\n|14     |  |Sequence Number (2nd Octet)          |\n|15     |  |Sequence Number (3rd Octet)          |\n|16     |  |Message Priority  |Spare             |\n\n\n     Figure 7.2.2.3-1: PFCP message Header for session related messages\n\n\n"}, {"key": "Usage of the PFCP Header", "numbering": "7.2.2.4", "title_level": 3, "desc": "7.2.2.4  Usage of the PFCP Header\n\n\n"}, {"key": "General", "numbering": "7.2.2.4.1", "title_level": 4, "desc": ""}, {"key": "Conditions for Sending SEID= in PFCP Header", "numbering": "7.2.2.4.2", "title_level": 4, "desc": "7.2.2.4.1   General\n\nThe format of the PFCP header is specified in subclause 7.2.2.\n\nThe usage of the PFCP header shall be as defined below.\n\nThe first octet of the header shall be used is the following way:\n\n  -  Bit 1 represents the \"S\" flag, which indicates if SEID field is\n    present in the PFCP header or not. If the \"S\" flag is set to 0, then\n    the SEID field shall not be present in the PFCP header. If the \"S\" flag\n    is set to 1, then the SEID field shall immediately follow the Length\n    field, in octets 5 to 12. Apart from the node related messages , in all\n    PFCP messages the value of the \"S\" flag shall be set to \"1\".\n\n  -  Bit 2 represents the \"MP\" flag. If the \"MP\" flag is set to \"1\", then\n    bits 8 to 5 of octet 16 shall indicate the message priority.\n\n  -  Bit 3 is a spare bit. The sending entity shall set it to \"0\" and the\n    receiving entity shall ignore it.\n\n  -  Bit 4 is a spare bit. The sending entity shall set it to \"0\" and the\n    receiving entity shall ignore it.\n\n  -  Bit 5 is a spare bit. The sending entity shall set it to \"0\" and the\n    receiving entity shall ignore it.\n\n  -  Bits 6 to 8, which represent the PFCP version, shall be set to decimal\n    1 (\"001\").\n\nThe usage of the fields in octets 2 - n of the header shall be as specified\nbelow.\n\n  -  Octet 2 represents the Message type field, which shall be set to the\n    unique value for each type of control plane message. Message type\n    values are specified in Table 7.3-1 \"Message types\".\n\n  -  Octets 3 to 4 represent the Message Length field. This field shall\n    indicate the length of the message in octets excluding the mandatory\n    part of the PFCP header (the first 4 octets). The SEID (if present) and\n    the Sequence Number shall be included in the length count. The format\n    of the Length field of information elements is specified in subclause\n    8.2 \"Information Element Format\".\n\n  -  When S=1, Octets 5 to 12 represent the Session Endpoint Identifier\n    (SEID) field. This field shall unambiguously identify a session\n    endpoint in the receiving Packet Forward Control entity. The Session\n    Endpoint Identifier is set by the sending entity in the PFCP header of\n    all control plane messages to the SEID value provided by the\n    corresponding receiving entity (CP or UP function). If a peer's SEID is\n    not available the SEID field shall be present in a PFCP header, but its\n    value shall be set to \"0\", \"Conditions for sending SEID=0 in PFCP\n    header\".\n\n  NOTE:  The SEID in the PFCP header of a message is set to the SEID value\n         provided by the corresponding receiving entity regardless of\n         whether the source IP address of the request message and the IP\n         Destination Address provided by the receiving entity for subsequent\n         request messages are the same or not.\n\n  -  Octets 13 to 15 represent PFCP Sequence Number field.\n\n\n7.2.2.4.2   Conditions for Sending SEID=0 in PFCP Header\n\nIf a peer's SEID is not available, the SEID field shall still be present in\nthe header and its value shall be set to \"0\" in the following messages:\n\n  -  PFCP Session Establishment Request message on Sxa/Sxb/Sxc;\n\n  -  If a node receives a message for which it has no session, i.e. if SEID\n    in the PFCP header is not known, it shall respond with \"Session context\n    not found\" cause in the corresponding response message to the sender,\n    the SEID used in the PFCP header in the response message shall be then\n    set to \"0\";\n\n  -  If a node receives a request message containing protocol error, e.g.\n    Mandatory IE missing, which requires the receiver to reject the message\n    as specified in clause 7.6, it shall reject the request message. For\n    the response message, the node should look up the remote peer\u2019s SEID\n    and accordingly set SEID in the PFCP header and the message cause code.\n    As an implementation option, the node may not look up the remote peer\u2019s\n    SEID and set the PFCP header SEID to \"0\" in the response message.\n    However in this case, the cause value shall not be set to \"Session not\n    found\".\n\n\n"}, {"key": "Information Elements", "numbering": "7.2.3", "title_level": 2, "desc": "7.2.3  Information Elements\n\n\n"}, {"key": "General", "numbering": "7.2.3.1", "title_level": 3, "desc": "7.2.3.1  General\n\nThe format of PFCP Information Elements are defined in subclause 8.2.\n\n\n"}, {"key": "Presence Requirements of Information Elements", "numbering": "7.2.3.2", "title_level": 3, "desc": "7.2.3.2  Presence Requirements of Information Elements\n\nIEs within PFCP messages shall be specified with one of the following\npresence requirement:\n\n  -  Mandatory: this means that the IE shall be included by the sending\n    entity, and that the receiver diagnoses a \"Mandatory IE missing\" error\n    when detecting that the IE is not present. A response including a\n    \"Mandatory IE missing\" cause, shall include the type of the missing IE.\n\n  -  Conditional: this means that:\n\n    -  the IE shall be included by sending entity if the conditions\n       specified are met;\n\n    -  the receiver shall check the conditions as specified in the\n       corresponding message type description, based on the parameter\n       combination in the message and/or on the state of the receiving node,\n       to infer if a conditional IE shall be expected. Only if a receiver\n       has sufficient information, if a conditional IE, which is necessary\n       for the receiving entity to complete the procedure, is missing, then\n       the receiver shall abort the procedure.\n\n  -  Conditional-Optional: this means that:\n\n    -  the IE shall be included by a sending entity complying with the\n       version of the specification, if the conditions specified in the\n       relevant protocol specification are met. An entity, which is at an\n       earlier version of the protocol and therefore is not up-to-date,\n       cannot send this IE;\n\n    -  the receiver need not check the presence of the IE in the message.\n       If the receiver checks the presence of the Conditional-Optional IE,\n       then the IE's absence shall not trigger any of the error handling\n       procedures. The handling of an absence or erroneous such IEs shall be\n       treated as Optional IEs as specified in subclause 7.6.\n\n  -  Optional: this means that:\n\n    -  the IE shall be included as a service option. Therefore, the IE may\n       be included or not in a message. The handling of an absent optional\n       IE, or an erroneous optional IE is specified in subclause 7.6.\n\nFor conditional IEs, the clause describing the PFCP message explicitly\ndefines the conditions under which the inclusion of each IE becomes\nmandatory or optional for that particular message. These conditions shall\nbe defined so that the presence of a conditional IE only becomes mandatory\nif it is critical for the receiving entity. The definition might reference\nother protocol specifications for final terms used as part of the\ncondition.\n\nFor grouped IEs, the presence requirement of the embedded IE shall follow\nthe rules:\n\n  -  If the grouped IE is Mandatory within a given message: the presence\n    requirements of individual embedded IEs are as stated within the\n    Mandatory grouped IE for the given message;\n\n  -  if the grouped IE is Conditional within a given message: if the\n    embedded IE in the grouped IE is Mandatory or Conditional, this\n    embedded IE is viewed as Conditional IE by the receiver. If the\n    embedded IE in the grouped IE is Conditional-Optional, this embedded IE\n    is viewed as Optional IE by the receiver. If the embedded IE in the\n    grouped IE is Optional, this embedded IE is viewed as Optional IE by\n    the receiver;\n\n  -  if the grouped IE is Conditional-Optional within a given message: if\n    the embedded IE in the grouped IE is Mandatory or Conditional, this\n    embedded IE is viewed as Conditional-Optional IE by the receiver. If\n    the embedded IE in the grouped IE is Conditional-Optional, this\n    embedded IE is viewed as Optional IE by the receiver. If the embedded\n    IE in the grouped IE is Optional, this embedded IE is viewed as\n    Optional IE by the receiver;\n\n  -  if the grouped IE is Optional within a given message: all embedded IEs\n    in the grouped IE are viewed as Optional IEs by the receiver.\n\nIn all of the above cases, appropriate error handling as described in\nsubclause 7.6 shall be applied for protocol errors of the embedded IEs.\n\nOnly the Cause IE at message level shall be included in the response if the\nCause contains a value that indicates that the request is not accepted,\nregardless of whether there are other mandatory or conditional IEs defined\nfor a given response message. The following are exceptions:\n\n  -  the Node ID and Offending IE shall be included as per the requirements\n    specified for the corresponding response message;\n\n  -  the Load Control Information, Overload Control Information and the\n    Failed Rule ID IEs may be included in an PFCP session related message.\n\n\n\nIf the Cause IE at Grouped IE level contains a value that indicates that\nthe Grouped IE is not handled correctly, the other IEs in this Grouped IE,\nother than the Cause IE, may not be included.\n\n\n"}, {"key": "Grouped Information Elements", "numbering": "7.2.3.3", "title_level": 3, "desc": "7.2.3.3  Grouped Information Elements\n\nA Grouped IE is an IE which may contain other IEs.\n\nGrouped IEs have a length value in the TLV encoding, which includes the\nadded length of all the embedded IEs. Overall coding of a grouped IE with 4\noctets long IE header is defined in subclause 8.2. Each IE within a grouped\nIE also shall also contain 4 octets long IE header.\n\nGrouped IEs are not marked by any flag or limited to a specific range of IE\ntype values. The clause describing an IE in this specification shall\nexplicitly state if it is a Grouped IE.\n\n  NOTE:  Each entry into each Grouped IE creates a new scope level. Exit\n         from the grouped IE closes the scope level. The PFCP message level\n         is the top most scope.\n\nIf more than one grouped IEs of the same type, but for a different purpose\nare sent with a message, these IEs shall have different IE types.\n\nIf more than one grouped IEs of the same type and for the same purpose are\nsent with a message, these IEs shall have exactly the same IE type to\nrepresent a list.\n\n\n"}, {"key": "Information Element Type", "numbering": "7.2.3.4", "title_level": 3, "desc": "7.2.3.4  Information Element Type\n\nAn IE in a PFCP message or Grouped IE is identified by its IE Type and\ndescribed by a specific row in the corresponding tables in clause 7.\n\nIf several IEs with the same Type are included in a PFCP message or Grouped\nIE, they represent a list for the corresponding IE name.\n\nAn IE Type value uniquely identifies a specific IE.\n\nOne IE type value is specified for Vendor Specific IEs.\n\n\n"}, {"key": "Message Types", "numbering": "7.3", "title_level": 1, "desc": "7.3  Message Types\n\nThe PFCP message types to be used over the Sxa, Sxb, Sxc and N4 reference\npoints are defined in Table 7.3-1.\n\n                         Table 7.3-1: Message Types\n\n|Message Type |Message                                   |Applicability|\n|value        |                                          |             |\n|(Decimal)    |                                          |             |\n|             |                                          |Sx|Sx|Sx|N4|\n|             |                                          |a |b |c |  |\n|0            |Reserved                                  |  |  |  |  |\n|             |PFCP Node related messages                |  |  |  |  |\n|1            |PFCP Heartbeat Request                    |X |X |X |X |\n|2            |PFCP Heartbeat Response                   |X |X |X |X |\n|3            |PFCP PFD Management Request               |- |X |X |X |\n|4            |PFCP PFD Management Response              |- |X |X |X |\n|5            |PFCP Association Setup Request            |X |X |X |X |\n|6            |PFCP Association Setup Response           |X |X |X |X |\n|7            |PFCP Association Update Request           |X |X |X |X |\n|8            |PFCP Association Update Response          |X |X |X |X |\n|9            |PFCP Association Release Request          |X |X |X |X |\n|10           |PFCP Association Release Response         |X |X |X |X |\n|11           |PFCP Version Not Supported Response       |X |X |X |X |\n|12           |PFCP Node Report Request                  |X |X |X |X |\n|13           |PFCP Node Report Response                 |X |X |X |X |\n|14           |PFCP Session Set Deletion Request         |X |X |- |  |\n|15           |PFCP Session Set Deletion Response        |X |X |- |  |\n|16 to 49     |For future use                            |  |  |  |  |\n|             |PFCP Session related messages             |  |  |  |  |\n|50           |PFCP Session Establishment Request        |X |X |X |X |\n|51           |PFCP Session Establishment Response       |X |X |X |X |\n|52           |PFCP Session Modification Request         |X |X |X |X |\n|53           |PFCP Session Modification Response        |X |X |X |X |\n|54           |PFCP Session Deletion Request             |X |X |X |X |\n|55           |PFCP Session Deletion Response            |X |X |X |X |\n|56           |PFCP Session Report Request               |X |X |X |X |\n|57           |PFCP Session Report Response              |X |X |X |X |\n|58 to 99     |For future use                            |  |  |  |  |\n|             |Other messages                            |  |  |  |  |\n|100 to 255   |For future use                            |  |  |  |  |\n\n\n\n"}, {"key": "PFCP Node Related Messages", "numbering": "7.4", "title_level": 1, "desc": "7.4  PFCP Node Related Messages\n\n\n"}, {"key": "General", "numbering": "7.4.1", "title_level": 2, "desc": "7.4.1  General\n\nThis subclause specifies the node related messages used over the Sxa, Sxb,\nSxc and N4 reference points.\n\n\n"}, {"key": "Heartbeat Messages", "numbering": "7.4.2", "title_level": 2, "desc": "7.4.2  Heartbeat Messages\n\n\n"}, {"key": "Heartbeat Request", "numbering": "7.4.2.1", "title_level": 3, "desc": "7.4.2.1  Heartbeat Request\n\n         Table 7.4.2.1-1: Information Elements in Heartbeat Request\n\n|Information  |P |Condition / Comment                 |IE Type    |\n|elements     |  |                                    |           |\n|Recovery Time|M |This IE shall contain the time stamp|Recovery   |\n|Stamp        |  |when the node was started see clause|Time Stamp |\n|             |  |19A of 3GPP\u00a0TS\u00a023.007\u00a0[24].         |           |\n\n\n\n"}, {"key": "Heartbeat Response", "numbering": "7.4.2.2", "title_level": 3, "desc": "7.4.2.2  Heartbeat Response\n\n         Table 7.4.2.2-1: Information Elements in Heartbeat Response\n\n|Information  |P |Condition / Comment                 |IE Type    |\n|elements     |  |                                    |           |\n|Recovery Time|M |This IE shall contain the time stamp|Recovery   |\n|Stamp        |  |when the node was started see clause|Time Stamp |\n|             |  |19A of 3GPP\u00a0TS\u00a023.007\u00a0[24].         |           |\n\n\n\n"}, {"key": "PFCP PFD Management", "numbering": "7.4.3", "title_level": 2, "desc": "7.4.3  PFCP PFD Management\n\n\n"}, {"key": "PFCP PFD Management Request", "numbering": "7.4.3.1", "title_level": 3, "desc": ""}, {"key": "PFCP PFD Management Response", "numbering": "7.4.3.2", "title_level": 3, "desc": ""}, {"key": "PFCP Association messages", "numbering": "7.4.4", "title_level": 2, "desc": ""}, {"key": "PFCP Association Setup Request", "numbering": "7.4.4.1", "title_level": 3, "desc": "7.4.3.1  PFCP PFD Management Request\n\n    Table 7.4.3.1-1: Information Elements in PFCP PFD Management Request\n\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Application|C |This IE shall contain an Application|- |X |X |X |Applicatio|\n|ID's PFDs  |  |Identifier and the associated PFDs  |  |  |  |  |n ID's    |\n|           |  |to be provisioned in the UP         |  |  |  |  |PFDs      |\n|           |  |function.                           |  |  |  |  |          |\n|           |  |Several IEs with the same IE type   |  |  |  |  |          |\n|           |  |may be present to provision PFDs for|  |  |  |  |          |\n|           |  |multiple Application IDs.           |  |  |  |  |          |\n|           |  |The UP function shall delete all the|  |  |  |  |          |\n|           |  |PFDs received and stored earlier for|  |  |  |  |          |\n|           |  |all the Application IDs if this IE  |  |  |  |  |          |\n|           |  |is absent in the message.           |  |  |  |  |          |\n\n\n                   Table 7.4.3.1-2: Application ID's PFDs\n\n|Octet 1 and|  |Application ID's PFDs IE Type = 58 (decimal)              |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|PFD        |C |This IE shall be present if the PFD |- |X |X |X |PFD       |\n|           |  |needs to be provisioned in the UP   |  |  |  |  |          |\n|           |  |function.                           |  |  |  |  |          |\n|           |  |When present, it shall describe the |  |  |  |  |          |\n|           |  |PFD to be provisioned in the UP     |  |  |  |  |          |\n|           |  |function.                           |  |  |  |  |          |\n|           |  |Several IEs with the same IE type   |  |  |  |  |          |\n|           |  |may be present to provision multiple|  |  |  |  |          |\n|           |  |PFDs for this Application ID.       |  |  |  |  |          |\n|           |  |                                    |  |  |  |  |          |\n|           |  |When this IE is absent, the UP      |  |  |  |  |          |\n|           |  |function shall delete all the PFDs  |  |  |  |  |          |\n|           |  |received and stored earlier in the  |  |  |  |  |          |\n|           |  |UP function for this Application ID.|  |  |  |  |          |\n\n\n                            Table 7.4.3.1-3: PFD\n\n|Octet 1 and|  |PFD IE Type = 59 (decimal)                                |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sxa        |Sxb       |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Cause      |M |This IE shall indicate the          |- |X |X |X |Cause     |\n|           |  |acceptance or the rejection of the  |  |  |  |  |          |\n|           |  |corresponding request message.      |  |  |  |  |          |\n|Offending IE |C |This IE shall be        |-                     |\n|             |  |included if the         |                      |\n|             |  |rejection is due to an  |                      |\n|             |  |conditional or mandatory|                      |\n|             |  |IE missing or faulty.   |                      |\n|Node ID      |M |This IE shall contain   |Node ID               |\n|             |  |the unique identifier of|                      |\n|             |  |the sending Node.       |                      |\n|Recovery Time|M |This IE shall contain   |Recovery Time Stamp   |\n|Stamp        |  |the time stamp when the |                      |\n|             |  |node was started, see   |                      |\n|             |  |clause 19A of           |                      |\n|             |  |3GPP\u00a0TS\u00a023.007\u00a0[24].    |                      |\n|UP Function  |C |This IE shall be present|UP Function Features  |\n|Features     |  |if the UP function sends|                      |\n|             |  |this message and the UP |                      |\n|             |  |function supports at    |                      |\n|             |  |least one UP feature    |                      |\n|             |  |defined in this IE.     |                      |\n|             |  |When present, this IE   |                      |\n|             |  |shall indicate the      |                      |\n|             |  |features the UP function|                      |\n|             |  |supports.               |                      |\n|CP Function  |C |This IE shall be present|CP Function Features  |\n|Features     |  |if the CP function sends|                      |\n|             |  |this message and the CP |                      |\n|             |  |function supports at    |                      |\n|             |  |least one CP feature    |                      |\n|             |  |defined in this IE.     |                      |\n|             |  |When present, this IE   |                      |\n|             |  |shall indicate the      |                      |\n|             |  |features the CP function|                      |\n|             |  |supports.               |                      |\n|User Plane IP|O |This IE may be present  |User Plane IP Resource|\n|Resource     |  |if the UP function sends|Information           |\n|Information  |  |this message.           |                      |\n|             |  |                        |                      |\n|             |  |When present, this IE   |                      |\n|             |  |shall contain an IPv4   |                      |\n|             |  |and/or an IPv6 address, |                      |\n|             |  |together with a TEID    |                      |\n|             |  |range that the CP       |                      |\n|             |  |function shall use to   |                      |\n|             |  |allocate GTP-U F-TEID in|                      |\n|             |  |the UP function.        |                      |\n|             |  |Several IEs with the    |                      |\n|             |  |same IE type may be     |                      |\n|             |  |present to represent    |                      |\n|             |  |multiple User Plane IP  |                      |\n|             |  |Resources.              |                      |\n\n\n\n"}, {"key": "PFCP Association Setup Response", "numbering": "7.4.4.2", "title_level": 3, "desc": "7.4.4.2  PFCP Association Setup Response\n\n Table 7.4.4.2-1: Information Elements in a PFCP Association Setup Response\n\n|Information  |P |Condition / Comment     |IE Type               |\n|elements     |  |                        |                      |\n|Node ID      |M |This IE shall contain   |Node ID               |\n|             |  |the unique identifier of|                      |\n|             |  |the sending Node.       |                      |\n|Cause        |M |This IE shall indicate  |Cause                 |\n|             |  |the acceptance or the   |                      |\n|             |  |rejection of the        |                      |\n|             |  |corresponding request   |                      |\n|             |  |message.                |                      |\n|Recovery Time|M |This IE shall contain   |Recovery Time Stamp   |\n|Stamp        |  |the time stamp when the |                      |\n|             |  |node was started, see   |                      |\n|             |  |clause 19A of           |                      |\n|             |  |3GPP\u00a0TS\u00a023.007\u00a0[24].    |                      |\n|UP Function  |C |This IE shall be present|UP Function Features  |\n|Features     |  |if the UP function sends|                      |\n|             |  |this message and the UP |                      |\n|             |  |function supports at    |                      |\n|             |  |least one UP feature    |                      |\n|             |  |defined in this IE.     |                      |\n|             |  |When present, this IE   |                      |\n|             |  |shall indicate the      |                      |\n|             |  |features the UP function|                      |\n|             |  |supports.               |                      |\n|CP Function  |C |This IE shall be present|CP Function Features  |\n|Features     |  |if the CP function sends|                      |\n|             |  |this message and the CP |                      |\n|             |  |function supports at    |                      |\n|             |  |least one CP feature    |                      |\n|             |  |defined in this IE.     |                      |\n|             |  |When present, this IE   |                      |\n|             |  |indicates the features  |                      |\n|             |  |the CP function         |                      |\n|             |  |supports.               |                      |\n|User Plane IP|O |This IE may be present  |User Plane IP Resource|\n|Resource     |  |if the UP function sends|Information           |\n|Information  |  |this message.           |                      |\n|             |  |                        |                      |\n|             |  |When present, this IE   |                      |\n|             |  |shall contain an IPv4   |                      |\n|             |  |and/or an IPv6 address, |                      |\n|             |  |together with a TEID    |                      |\n|             |  |range that the CP       |                      |\n|             |  |function shall use to   |                      |\n|             |  |allocate GTP-U F-TEID in|                      |\n|             |  |the UP function.        |                      |\n|             |  |Several IEs with the    |                      |\n|             |  |same IE type may be     |                      |\n|             |  |present to represent    |                      |\n|             |  |multiple User Plane IP  |                      |\n|             |  |Resources.              |                      |\n\n\n\n"}, {"key": "PFCP Association Update Request", "numbering": "7.4.4.3", "title_level": 3, "desc": "7.4.4.3  PFCP Association Update Request\n\n Table 7.4.4.3-1: Information Elements in a PFCP Association Update Request\n\n|Information  |P |Condition / Comment     |IE Type               |\n|elements     |  |                        |                      |\n|Node ID      |M |This IE shall contain   |Node ID               |\n|             |  |the unique identifier of|                      |\n|             |  |the sending Node.       |                      |\n|UP Function  |O |If present, this IE     |UP Function Features  |\n|Features     |  |shall indicate the      |                      |\n|             |  |supported Features when |                      |\n|             |  |the sending node is the |                      |\n|             |  |UP function.            |                      |\n|CP Function  |O |If present, this IE     |CP Function Features  |\n|Features     |  |shall indicate the      |                      |\n|             |  |supported Features when |                      |\n|             |  |the sending node is the |                      |\n|             |  |CP function.            |                      |\n|PFCP         |C |This IE shall be present|PFCP Association      |\n|Association  |  |if the UP function      |Release Request       |\n|Release      |  |requests the CP function|                      |\n|Request      |  |to release the PFCP     |                      |\n|             |  |association.            |                      |\n|Graceful     |C |This IE shall be present|Graceful Release      |\n|Release      |  |if the UP function      |Period                |\n|Period       |  |requests a graceful     |                      |\n|             |  |release of the PFCP     |                      |\n|             |  |association.            |                      |\n|User Plane IP|O |This IE may be present  |User Plane IP Resource|\n|Resource     |  |if the UP function sends|Information           |\n|Information  |  |this message.           |                      |\n|             |  |                        |                      |\n|             |  |When present, this IE   |                      |\n|             |  |shall contain an IPv4   |                      |\n|             |  |and/or an IPv6 address, |                      |\n|             |  |together with a TEID    |                      |\n|             |  |range that the CP       |                      |\n|             |  |function shall use to   |                      |\n|             |  |allocate GTP-U F-TEID in|                      |\n|             |  |the UP function.        |                      |\n|             |  |                        |                      |\n|             |  |Several IEs with the    |                      |\n|             |  |same IE type may be     |                      |\n|             |  |present to represent    |                      |\n|             |  |multiple User Plane IP  |                      |\n|             |  |Resources.              |                      |\n\n\n\n"}, {"key": "PFCP Association Update Response", "numbering": "7.4.4.4", "title_level": 3, "desc": "7.4.4.4  PFCP Association Update Response\n\n Table 7.4.4.4-1: Information Elements in a PFCP Association Update Response\n\n|Information  |P |Condition / Comment     |IE-Type               |\n|elements     |  |                        |                      |\n|Node ID      |M |This IE shall contain   |Node ID               |\n|             |  |the unique identifier of|                      |\n|             |  |the sending Node.       |                      |\n|Cause        |M |This IE shall indicate  |Cause                 |\n|             |  |the acceptance or the   |                      |\n|             |  |rejection of the        |                      |\n|             |  |corresponding request   |                      |\n|             |  |message.                |                      |\n|UP Function  |O |If present, this IE     |UP Function Features  |\n|Features     |  |shall indicate the      |                      |\n|             |  |supported Features when |                      |\n|             |  |the sending node is the |                      |\n|             |  |UP function.            |                      |\n|CP Function  |O |If present, this IE     |CP Function Features  |\n|Features     |  |shall indicate the      |                      |\n|             |  |supported Features when |                      |\n|             |  |the sending node is the |                      |\n|             |  |CP function.            |                      |\n\n\n\n"}, {"key": "PFCP Association Release Request", "numbering": "7.4.4.5", "title_level": 3, "desc": "7.4.4.5  PFCP Association Release Request\n\n Table 7.4.4.5-1: Information Elements in a PFCP Association Release Request\n\n|Information  |P |Condition / Comment     |IE Type               |\n|elements     |  |                        |                      |\n|Node ID      |M |This IE shall contain   |Node ID               |\n|             |  |the unique identifier of|                      |\n|             |  |the sending Node.       |                      |\n\n\n\n"}, {"key": "PFCP Association Release Response", "numbering": "7.4.4.6", "title_level": 3, "desc": "7.4.4.6  PFCP Association Release Response\n\n     Table 7.4.4.6-1: Information Elements in a PFCP Association Release\n                                  Response\n\n|Information  |P |Condition / Comment     |IE type               |\n|elements     |  |                        |                      |\n|Node ID      |M |This IE shall contain   |Node ID               |\n|             |  |the unique identifier of|                      |\n|             |  |the sending Node.       |                      |\n|Cause        |M |This IE shall indicate  |Cause                 |\n|             |  |the acceptance or the   |                      |\n|             |  |rejection of the        |                      |\n|             |  |corresponding request   |                      |\n|             |  |message.                |                      |\n\n\n\n"}, {"key": "PFCP Version Not Supported Response", "numbering": "7.4.4.7", "title_level": 3, "desc": "7.4.4.7  PFCP Version Not Supported Response\n\nThis message shall only contain the PFCP header. The PFCP protocol version\nin the PFCP header shall indicate the highest PFCP Version that the sending\nentity supports.\n\n  NOTE:  The PFCP Version Not Supported Response message can be received by\n         a PFCP entity when sending the very first message to a PFCP peer\n         only supporting earlier version(s) of the protocol.\n\n\n"}, {"key": "PFCP Node Report Procedure", "numbering": "7.4.5", "title_level": 2, "desc": "7.4.5  PFCP Node Report Procedure\n\n\n"}, {"key": "PFCP Node Report Request", "numbering": "7.4.5.1", "title_level": 3, "desc": "7.4.5.1  PFCP Node Report Request\n\n\n"}, {"key": "General", "numbering": "7.4.5.1.1", "title_level": 4, "desc": ""}, {"key": "User Plane Path Failure Report IE within PFCP Node Report", "numbering": "7.4.5.1.2", "title_level": 4, "desc": ""}, {"key": "PFCP Node Report Response", "numbering": "7.4.5.2", "title_level": 3, "desc": ""}, {"key": "General", "numbering": "7.4.5.2.1", "title_level": 4, "desc": ""}, {"key": "PFCP Session Set Deletion", "numbering": "7.4.6", "title_level": 2, "desc": ""}, {"key": "PFCP Session Set Deletion Request", "numbering": "7.4.6.1", "title_level": 3, "desc": ""}, {"key": "PFCP Session Set Deletion Response", "numbering": "7.4.6.2", "title_level": 3, "desc": ""}, {"key": "PFCP Session Related Messages", "numbering": "7.5", "title_level": 1, "desc": ""}, {"key": "General", "numbering": "7.5.1", "title_level": 2, "desc": ""}, {"key": "PFCP Session Establishment Request", "numbering": "7.5.2", "title_level": 2, "desc": ""}, {"key": "General", "numbering": "7.5.2.1", "title_level": 3, "desc": "7.4.5.1.1   General\n\nThe PFCP Node Report Request shall be sent over the Sxa, Sxb, Sxc and N4\ninterface by the UP function to report information to the CP function that\nis not specific to an PFCP session.\n\n     Table 7.4.5.1.1-1: Information Elements in PFCP Node Report Request\n\n|Information|P |Condition / Comment                |Appl.      |IE Type   |\n|elements   |  |                                   |           |          |\n|           |  |  |Sxa                                                    |\n|Octets 3   |  |  |Length = n                                             |\n|and 4      |  |  |                                                       |\n|Information|P |Condition / Comment                |Appl.      |IE Type   |\n|elements   |  |                                   |           |          |\n|           |  |                                   |Sxa        |Sxb       |\n|           |  |                                    |Sxa        |Sxb       |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Node ID    |M |This IE shall contain the node      |X |X |- |  |Node ID   |\n|           |  |identity of the originating node of |  |  |  |  |          |\n|           |  |the message.                        |  |  |  |  |          |\n|SGW-C      |C |This IE shall be included according |X |X |- |  |FQ-CSID   |\n|FQ-CSID    |  |to the requirements in clause 23 of |  |  |  |  |          |\n|           |  |3GPP TS 23.007 [24].                |  |  |  |  |          |\n|SGW-U      |C |This IE shall be included according |X          |-         |\n|FQ-CSID    |  |to the requirements in clause 23 of |           |          |\n|           |  |3GPP TS 23.007 [24].                |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Node ID    |M |This IE shall contain the unique    |X |X |- |  |Node ID   |\n|           |  |identifier of the sending node.     |  |  |  |  |          |\n|Cause      |M |This IE shall indicate the          |X          |X         |\n|           |  |acceptance or the rejection of the  |           |          |\n|           |  |corresponding request message.      |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Node ID    |M |This IE shall contain the unique    |X |X |X |X |Node ID   |\n|           |  |identifier of the sending Node.     |  |  |  |  |          |\n|CP F-SEID  |M |This IE shall contain the unique    |X |X |X |X |F-SEID    |\n|           |  |identifier allocated by the CP      |  |  |  |  |          |\n|           |  |function identifying the session.   |  |  |  |  |          |\n|Create PDR |M |This IE shall be present for at     |X |X |X |X |Create PDR|\n|           |  |least one PDR to be associated to   |  |  |  |  |          |\n|           |  |the PFCP session.                   |  |  |  |  |          |\n|           |  |                                    |  |  |  |  |          |\n|           |  |Several IEs with the same IE type   |  |  |  |  |          |\n|           |  |may be present to represent multiple|  |  |  |  |          |\n|           |  |PDRs.                               |  |  |  |  |          |\n|           |  |See Table 7.5.2.2-1.                |  |  |  |  |          |\n|Create FAR |M |This IE shall be present for at     |X |X |X |X |Create FAR|\n|           |  |least one FAR to be associated to   |  |  |  |  |          |\n|           |  |the PFCP session.                   |  |  |  |  |          |\n|           |  |                                    |  |  |  |  |          |\n|           |  |Several IEs with the same IE type   |  |  |  |  |          |\n|           |  |may be present to represent multiple|  |  |  |  |          |\n|           |  |FARs.                               |  |  |  |  |          |\n|           |  |See Table 7.5.2.3-1.                |  |  |  |  |          |\n|Create URR |C |This IE shall be present if a       |X |X |X |X |Create URR|\n|           |  |measurement action shall be applied |  |  |  |  |          |\n|           |  |to packets matching one or more     |  |  |  |  |          |\n|           |  |PDR(s) of this PFCP session.        |  |  |  |  |          |\n|           |  |Several IEs within the same IE type |  |  |  |  |          |\n|           |  |may be present to represent multiple|  |  |  |  |          |\n|           |  |URRs.                               |  |  |  |  |          |\n|           |  |See Table 7.5.2.4-1.                |  |  |  |  |          |\n|Create QER |C |This IE shall be present if a QoS   |- |X |X |X |Create QER|\n|           |  |enforcement action shall be applied |  |  |  |  |          |\n|           |  |to packets matching one or more     |  |  |  |  |          |\n|           |  |PDR(s) of this PFCP session.        |  |  |  |  |          |\n|           |  |Several IEs within the same IE type |  |  |  |  |          |\n|           |  |may be present to represent multiple|  |  |  |  |          |\n|           |  |QERs.                               |  |  |  |  |          |\n|           |  |See Table 7.5.2.5-1.                |  |  |  |  |          |\n|Create BAR |O |When present, this IE shall contain |X |- |- |X |Create BAR|\n|           |  |the buffering instructions to be    |  |  |  |  |          |\n|           |  |applied by the UP function to any   |  |  |  |  |          |\n|           |  |FAR of this PFCP session set with   |  |  |  |  |          |\n|           |  |the Apply Action requesting the     |  |  |  |  |          |\n|           |  |packets to be buffered and with a   |  |  |  |  |          |\n|           |  |BAR ID IE referring to this BAR. See|  |  |  |  |          |\n|           |  |table 7.5.2.6-1.                    |  |  |  |  |          |\n|Create     |C |This IE may be present if the UP    |X |X |X |X |Create    |\n|Traffic    |  |function has indicated support of   |  |  |  |  |Traffic   |\n|Endpoint   |  |PDI optimization.                   |  |  |  |  |Endpoint  |\n|           |  |Several IEs within the same IE type |  |  |  |  |          |\n|           |  |may be present to represent multiple|  |  |  |  |          |\n|           |  |Traffic Endpoints.                  |  |  |  |  |          |\n|           |  |See Table 7.5.2.7-1.                |  |  |  |  |          |\n|SGW-C      |C |This IE shall be included according |X |X |- |  |FQ-CSID   |\n|FQ-CSID    |  |to the requirements in clause\u00a023 of |  |  |  |  |          |\n|           |  |3GPP\u00a0TS 23.007\u00a0[24].                |  |  |  |  |          |\n|MME FQ-CSID|C |This IE shall be included when      |X |X |- |- |FQ-CSID   |\n|           |  |received on the S11 interface or on |  |  |  |  |          |\n|           |  |S5/S8 interface according to the    |  |  |  |  |          |\n|           |  |requirements in clause\u00a023 of        |  |  |  |  |          |\n|           |  |3GPP\u00a0TS\u00a023.007\u00a0[24].                |  |  |  |  |          |\n|PGW-C      |C |This IE shall be included according |X |X |- |- |FQ-CSID   |\n|FQ-CSID    |  |to the requirements in clause\u00a023 of |  |  |  |  |          |\n|           |  |3GPP\u00a0TS\u00a023.007\u00a0[24].                |  |  |  |  |          |\n|ePDG       |C |This IE shall be included according |- |X |- |- |FQ-CSID   |\n|FQ-CSID    |  |to the requirements in clause 23 of |  |  |  |  |          |\n|           |  |3GPP\u00a0TS\u00a023.007\u00a0[24].                |  |  |  |  |          |\n|TWAN       |C |This IE shall be included according |- |X |- |- |FQ-CSID   |\n|FQ-CSID    |  |to the requirements in clause\u00a023 of |  |  |  |  |          |\n|           |  |3GPP\u00a0TS\u00a023.007\u00a0[24].                |  |  |  |  |          |\n|User Plane |O |This IE may be present to request   |- |X |X |X |User Plane|\n|Inactivity |  |the UP function to send a User Plane|  |  |  |  |Inactivity|\n|Timer      |  |Inactivity Report when no user plane|  |  |  |  |Timer     |\n|           |  |packets are received for this PFCP  |  |  |  |  |          |\n|           |  |session for a duration exceeding the|  |  |  |  |          |\n|           |  |User Plane Inactivity Timer.        |  |  |  |  |          |\n|           |  |When present, it shall contain the  |  |  |  |  |          |\n|           |  |duration of the inactivity period   |  |  |  |  |          |\n|           |  |after which a User Plane Inactivity |  |  |  |  |          |\n|           |  |Report shall be generated.          |  |  |  |  |          |\n|User ID    |O |This IE may be present, based on    |X |X |X |X |User ID   |\n|           |  |operator policy. It shall only be   |  |  |  |  |          |\n|           |  |sent if the UP function is in a     |  |  |  |  |          |\n|           |  |trusted environment.                |  |  |  |  |          |\n|           |  |See NOTE.                           |  |  |  |  |          |\n|NOTE: This can be used for troubleshooting problems in the UP function   |\n|affecting a subscriber.                                                  |\n\n\n  Editor's Note: Restoration procedures are FFS on N4.\n\n\n\n\n"}, {"key": "Create PDR IE within PFCP Session Establishment Request", "numbering": "7.5.2.2", "title_level": 3, "desc": "7.5.2.2  Create PDR IE within PFCP Session Establishment Request\n\nThe Create PDR grouped IE shall be encoded as shown in Figure 7.5.2.2-1.\n\n  Table 7.5.2.2-1: Create PDR IE within PFCP Session Establishment Request\n\n|Octet 1 and|  |Create PDR IE Type = 1(decimal)                           |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|PDI        |M |This IE shall contain the PDI       |X |X |X |X |PDI       |\n|           |  |against which incoming packets will |  |  |  |  |          |\n|           |  |be matched.                         |  |  |  |  |          |\n|           |  |See Table 7.5.2.2-2.                |  |  |  |  |          |\n|Outer      |C |This IE shall be present if the UP  |X |X |- |X |Outer     |\n|Header     |  |function is required to remove one  |  |  |  |  |Header    |\n|Removal    |  |or more outer header(s) from the    |  |  |  |  |Removal   |\n|           |  |packets matching this PDR.          |  |  |  |  |          |\n|FAR ID     |C |This IE shall be present if the     |X |X |X |X |FAR ID    |\n|           |  |Activate Predefined Rules IE is not |  |  |  |  |          |\n|           |  |included or if it is included but it|  |  |  |  |          |\n|           |  |does not result in activating a     |  |  |  |  |          |\n|           |  |predefined FAR.                     |  |  |  |  |          |\n|           |  |When present this IE shall contain  |  |  |  |  |          |\n|           |  |the FAR ID to be associated to the  |  |  |  |  |          |\n|           |  |PDR.                                |  |  |  |  |          |\n|URR ID     |C |This IE shall be present if a       |X |X |X |X |URR ID    |\n|           |  |measurement action shall be applied |  |  |  |  |          |\n|           |  |to packets matching this PDR.       |  |  |  |  |          |\n|           |  |When present, this IE shall contain |  |  |  |  |          |\n|           |  |the URR IDs to be associated to the |  |  |  |  |          |\n|           |  |PDR.                                |  |  |  |  |          |\n|           |  |Several IEs within the same IE type |  |  |  |  |          |\n|           |  |may be present to represent a list  |  |  |  |  |          |\n|           |  |of URRs to be associated to the PDR.|  |  |  |  |          |\n|QER ID     |C |This IE shall be present if a QoS   |- |X |X |X |QER ID    |\n|           |  |enforcement action shall be applied |  |  |  |  |          |\n|           |  |to packets matching this PDR.       |  |  |  |  |          |\n|           |  |When present, this IE shall contain |  |  |  |  |          |\n|           |  |the QER IDs to be associated to the |  |  |  |  |          |\n|           |  |PDR. Several IEs within the same IE |  |  |  |  |          |\n|           |  |type may be present to represent a  |  |  |  |  |          |\n|           |  |list of QERs to be associated to the|  |  |  |  |          |\n|           |  |PDR.                                |  |  |  |  |          |\n|Activate   |C |This IE shall be present if Predefined Rule(s) shall be   |\n|Predefined |  |activated for this PDR. When present this IE shall contain|\n|Rules      |  |one Predefined Rules name.                                |\n|           |  |Several IEs with the same IE type may be present to       |\n|           |  |represent multiple \"Activate Predefined Rules\" names.     |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Local      |O |This IE shall not be present if     |X |X |- |X |F-TEID    |\n|F-TEID     |  |Traffic Endpoint ID is present.     |  |  |  |  |          |\n|           |  |If present, this IE shall identify  |  |  |  |  |          |\n|           |  |the local F-TEID to match for an    |  |  |  |  |          |\n|           |  |incoming packet.                    |  |  |  |  |          |\n|           |  |The CP function shall set the CHOOSE|  |  |  |  |          |\n|           |  |(CH) bit to 1 if the UP function    |  |  |  |  |          |\n|           |  |supports the allocation of F-TEID   |  |  |  |  |          |\n|           |  |and the CP function requests the UP |  |  |  |  |          |\n|           |  |function to assign a local F-TEID to|  |  |  |  |          |\n|           |  |the PDR.                            |  |  |  |  |          |\n|Network    |O |This IE shall not be present if     |X |X |X |X |Network   |\n|Instance   |  |Traffic Endpoint ID is present.     |  |  |  |  |Instance  |\n|           |  |If present, this IE shall identify  |  |  |  |  |          |\n|           |  |the Network instance to match for   |  |  |  |  |          |\n|           |  |the incoming packet. See NOTE 1,    |  |  |  |  |          |\n|           |  |NOTE2.                              |  |  |  |  |          |\n|UE IP      |O |This IE shall not be present if     |- |X |X |X |UE IP     |\n|address    |  |Traffic Endpoint ID is present.     |  |  |  |  |address   |\n|           |  |If present, this IE shall identify  |  |  |  |  |          |\n|           |  |the source or destination IP address|  |  |  |  |          |\n|           |  |to match for the incoming packet.   |  |  |  |  |          |\n|Traffic    |C |This IE may be present if the UP    |X |X |X |X |Traffic   |\n|Endpoint ID|  |function has indicated the support  |  |  |  |  |Endpoint  |\n|           |  |of PDI optimization.                |  |  |  |  |ID        |\n|           |  |If present, this IE shall uniquely  |  |  |  |  |          |\n|           |  |identify the Traffic Endpoint for   |  |  |  |  |          |\n|           |  |that PFCP session.                  |  |  |  |  |          |\n|Application|O |If present, this IE shall identify  |- |X |X |X |Applicatio|\n|ID         |  |the Application ID to match for the |  |  |  |  |n ID      |\n|           |  |incoming packet.                    |  |  |  |  |          |\n|Ethernet   |O |This IE may be present to identify  |- |- |- |X |Ethernet  |\n|PDU Session|  |all the (DL) Ethernet packets       |  |  |  |  |PDU       |\n|Information|  |matching an Ethernet PDU session    |  |  |  |  |Session   |\n|           |  |(see subclause 5.13.1).             |  |  |  |  |Informatio|\n|           |  |                                    |  |  |  |  |n         |\n|Ethernet   |O |If present, this IE shall identify  |- |- |- |X |Ethernet  |\n|Packet     |  |the Ethernet PDU to match for the   |  |  |  |  |Packet    |\n|Filter     |  |incoming packet.                    |  |  |  |  |Filter    |\n|           |  |Several IEs with the same IE type   |  |  |  |  |          |\n|           |  |may be present to represent a list  |  |  |  |  |          |\n|           |  |of Ethernet Packet Filters.         |  |  |  |  |          |\n|           |  |The full set of applicable Ethernet |  |  |  |  |          |\n|           |  |Packet filters, if any, shall be    |  |  |  |  |          |\n|           |  |provided during the creation or the |  |  |  |  |          |\n|           |  |modification of the PDI.            |  |  |  |  |          |\n|QFI        |O |If present, this IE shall identify  |- |- |- |X |QFI       |\n|           |  |the QoS Flow Identifier to match for|  |  |  |  |          |\n|           |  |the incoming packet.                |  |  |  |  |          |\n|           |  |Several IEs with the same IE type   |  |  |  |  |          |\n|           |  |may be present to provision a list  |  |  |  |  |          |\n|           |  |of QFIs. When present, the full set |  |  |  |  |          |\n|           |  |of applicable QFIs shall be provided|  |  |  |  |          |\n|           |  |during the creation or the          |  |  |  |  |          |\n|           |  |modification of the PDI.            |  |  |  |  |          |\n|NOTE 1: The Network Instance parameter is needed e.g. in the following   |\n|cases:                                                                   |\n|- PGW/TDF UP function supports multiple PDNs with overlapping IP         |\n|addresses;                                                               |\n|- SGW UP function is connected to PGWs in different IP domains (S5/S8);  |\n|- PGW UP function is connected to SGWs in different IP domains (S5/S8);  |\n|- SGW UP function is connected to eNodeBs in different IP domains;       |\n|- UPF is connected to 5G-ANs in different IP domains.                    |\n|NOTE 2:  When a Local F-TEID is provisioned in the PDI, the Network      |\n|Instance shall relate to the IP address of the F-TEID. Otherwise, the    |\n|Network Instance shall relate to the UE IP address.                      |\n|NOTE 3: SDF Filter IE(s) shall not be present if Ethernet Packet Filter  |\n|IE(s) is present.                                                        |\n\n\n       Table 7.5.2.2-3: Ethernet Packet Filter IE within PFCP Session\n                            Establishment Request\n\n|Octet 1 and|  |Ethernet Packet Filter IE Type = 132 (decimal)            |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Ethernet   |C |This shall be present if            |- |- |- |X |Ethernet  |\n|Filter ID  |  |Bidirectional Ethernet filter is    |  |  |  |  |Filter ID |\n|           |  |required. This IE shall uniquely    |  |  |  |  |          |\n|           |  |identify an Ethernet Filter among   |  |  |  |  |          |\n|           |  |all the Ethernet Filters provisioned|  |  |  |  |          |\n|           |  |for a given PFCP session.           |  |  |  |  |          |\n|Ethernet   |C |This IE shall be present when       |- |- |- |X |Ethernet  |\n|Filter     |  |provisioning a bidirectional        |  |  |  |  |Filter    |\n|Properties |  |Ethernet Filter the first time (see |  |  |  |  |Properties|\n|           |  |subclause 5.x.4).                   |  |  |  |  |          |\n|MAC address|O |If present, this IE shall identify  |- |- |- |X |MAC       |\n|           |  |the MAC address.                    |  |  |  |  |address   |\n|           |  |This IE may be present up to 16     |  |  |  |  |          |\n|           |  |times.                              |  |  |  |  |          |\n|Ethertype  |O |If present, this IE shall identify  |- |- |- |X |Ethertype |\n|           |  |the Ethertype.                      |  |  |  |  |          |\n|C-TAG      |O |If present, this IE shall identify  |- |- |- |X |C-TAG     |\n|           |  |the Customer-VLAN tag.              |  |  |  |  |          |\n|S-TAG      |O |If present, this IE shall identify  |- |- |- |X |S-TAG     |\n|           |  |the Service-VLAN tag.               |  |  |  |  |          |\n|SDF Filter |O |If packet filtering is required, for|- |- |- |X |SDF Filter|\n|           |  |Ethernet frames with Ethertype      |  |  |  |  |          |\n|           |  |indicating IPv4 or IPv6 payload,    |  |  |  |  |          |\n|           |  |this IE shall describe the IP Packet|  |  |  |  |          |\n|           |  |Filter Set.                         |  |  |  |  |          |\n|           |  |Several IEs with the same IE type   |  |  |  |  |          |\n|           |  |may be present to represent a list  |  |  |  |  |          |\n|           |  |of SDF filters.                     |  |  |  |  |          |\n\n\n\n"}, {"key": "Create FAR IE within PFCP Session Establishment Request", "numbering": "7.5.2.3", "title_level": 3, "desc": "7.5.2.3  Create FAR IE within PFCP Session Establishment Request\n\nThe Create FAR grouped IE shall be encoded as shown in Figure 7.5.2.3-1.\n\n  Table 7.5.2.3-1: Create FAR IE within PFCP Session Establishment Request\n\n|Octet 1 and|  |Create FAR IE Type = 3 (decimal)                          |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Forwarding |C |This IE shall be present when the   |X |X |X |X |Forwarding|\n|Parameters |  |Apply-Action requests the packets to|  |  |  |  |Parameters|\n|           |  |be forwarded. It may be present     |  |  |  |  |          |\n|           |  |otherwise.                          |  |  |  |  |          |\n|           |  |                                    |  |  |  |  |          |\n|           |  |When present, this IE shall contain |  |  |  |  |          |\n|           |  |the forwarding instructions to be   |  |  |  |  |          |\n|           |  |applied by the UP function when the |  |  |  |  |          |\n|           |  |Apply-Action requests the packets to|  |  |  |  |          |\n|           |  |be forwarded.                       |  |  |  |  |          |\n|           |  |See table 7.5.2.3-2.                |  |  |  |  |          |\n|Duplicating|C |This IE shall be present when the   |X |X |- |X |Duplicatin|\n|Parameters |  |Apply-Action requests the packets to|  |  |  |  |g         |\n|           |  |be duplicated. It may be present    |  |  |  |  |Parameters|\n|           |  |otherwise.                          |  |  |  |  |          |\n|           |  |                                    |  |  |  |  |          |\n|           |  |When present, this IE shall contain |  |  |  |  |          |\n|           |  |the forwarding instructions to be   |  |  |  |  |          |\n|           |  |applied by the UP function for the  |  |  |  |  |          |\n|           |  |traffic to be duplicated, when the  |  |  |  |  |          |\n|           |  |Apply-Action requests the packets to|  |  |  |  |          |\n|           |  |be duplicated.                      |  |  |  |  |          |\n|           |  |                                    |  |  |  |  |          |\n|           |  |Several IEs with the same IE type   |  |  |  |  |          |\n|           |  |may be present to represent to      |  |  |  |  |          |\n|           |  |duplicate the packets to different  |  |  |  |  |          |\n|           |  |destinations. See NOTE 1.           |  |  |  |  |          |\n|           |  |                                    |  |  |  |  |          |\n|           |  |See table 7.5.2.3-3.                |  |  |  |  |          |\n|BAR ID     |O |When present, this IE shall contain |X |- |- |X |BAR ID    |\n|           |  |the BAR ID of the BAR defining the  |  |  |  |  |          |\n|           |  |buffering instructions to be applied|  |  |  |  |          |\n|           |  |by the UP function when the Apply   |  |  |  |  |          |\n|           |  |Action requests the packets to be   |  |  |  |  |          |\n|           |  |buffered. See table 7.5.2.6-1.      |  |  |  |  |          |\n|NOTE 1: The same user plane packets may be required, according to        |\n|operator's policy and configuration, to be duplicated to different       |\n|SX3LIFs.                                                                 |\n\n\n  Editor's Note: Regarding duplication of parameters for interception is\n         FFS on N4, needs confirmation from SA3.\n\n\n\n              Table 7.5.2.3-2: Forwarding Parameters IE in FAR\n\n|Octet 1 and|  |Forwarding Parameters IE Type = 4 (decimal)               |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Network    |O |When present, this IE shall identify|X |X |X |X |Network   |\n|Instance   |  |the Network instance towards which  |  |  |  |  |Instance  |\n|           |  |to send the outgoing packet. See    |  |  |  |  |          |\n|           |  |NOTE 1.                             |  |  |  |  |          |\n|Redirect   |C |This IE shall be present if the UP  |- |X |X |X |Redirect  |\n|Information|  |function is required to enforce     |  |  |  |  |Informatio|\n|           |  |traffic redirection towards a       |  |  |  |  |n         |\n|           |  |redirect destination provided by the|  |  |  |  |          |\n|           |  |CP function.                        |  |  |  |  |          |\n|Outer      |C |This IE shall be present if the UP  |X |X |- |X |Outer     |\n|Header     |  |function is required to add one or  |  |  |  |  |Header    |\n|Creation   |  |more outer header(s) to the outgoing|  |  |  |  |Creation  |\n|           |  |packet. If present, it shall contain|  |  |  |  |          |\n|           |  |the F-TEID of the remote GTP-U peer |  |  |  |  |          |\n|           |  |when adding a GTP-U/UDP/IP header,  |  |  |  |  |          |\n|           |  |or the Destination IP address and   |  |  |  |  |          |\n|           |  |Port Number when adding a UDP/IP    |  |  |  |  |          |\n|           |  |header.                             |  |  |  |  |          |\n|Transport  |C |This IE shall be present if the UP  |X |X |- |X |Transport |\n|Level      |  |function is required to mark the IP |  |  |  |  |Level     |\n|Marking    |  |header with the DSCP marking as     |  |  |  |  |Marking   |\n|           |  |defined by IETF\u00a0RFC\u00a02474\u00a0[22]. When |  |  |  |  |          |\n|           |  |present, it shall contain the value |  |  |  |  |          |\n|           |  |of the DSCP in the TOS/Traffic Class|  |  |  |  |          |\n|           |  |field set based on the QCI, and     |  |  |  |  |          |\n|           |  |optionally the ARP priority level,  |  |  |  |  |          |\n|           |  |of the associated EPS bearer, as    |  |  |  |  |          |\n|           |  |described in sub-clause 4.7.3 of    |  |  |  |  |          |\n|           |  |3GPP\u00a0TS\u00a023.214\u00a0[2].                 |  |  |  |  |          |\n|Forwarding |C |This IE shall be present if a       |- |X |X |X |Forwarding|\n|Policy     |  |specific forwarding policy is       |  |  |  |  |Policy    |\n|           |  |required to be applied to the       |  |  |  |  |          |\n|           |  |packets. It shall be present if the |  |  |  |  |          |\n|           |  |Destination Interface IE is set to  |  |  |  |  |          |\n|           |  |SGi-LAN. It may be present if the   |  |  |  |  |          |\n|           |  |Destination Interface is set to     |  |  |  |  |          |\n|           |  |Core.                               |  |  |  |  |          |\n|           |  |When present, it shall contain an   |  |  |  |  |          |\n|           |  |Identifier of the Forwarding Policy |  |  |  |  |          |\n|           |  |locally configured in the UP        |  |  |  |  |          |\n|           |  |function.                           |  |  |  |  |          |\n|Header     |O |This IE may be present if the UP    |- |X |X |X |Header    |\n|Enrichment |  |function indicated support of Header|  |  |  |  |Enrichment|\n|           |  |Enrichment of UL traffic. When      |  |  |  |  |          |\n|           |  |present, it shall contain           |  |  |  |  |          |\n|           |  |information for header enrichment.  |  |  |  |  |          |\n|Linked     |C |This IE may be present, if it is    |X |X |- |X |Traffic   |\n|Traffic    |  |available and the UP function       |  |  |  |  |Endpoint  |\n|Endpoint ID|  |indicated support of the PDI        |  |  |  |  |ID        |\n|           |  |optimisation feature, (see subclause|  |  |  |  |          |\n|           |  |8.2.25). When present, it shall     |  |  |  |  |          |\n|           |  |\u00a0identify the Traffic Endpoint ID   |  |  |  |  |          |\n|           |  |allocated for this PFCP session to  |  |  |  |  |          |\n|           |  |receive the traffic in the reverse  |  |  |  |  |          |\n|           |  |direction (see subclause 5.2.3.1).  |  |  |  |  |          |\n|Proxying   |C |This IE shall be present if proxying|- |- |- |X |Proxying  |\n|           |  |is to be performed by the UP        |  |  |  |  |          |\n|           |  |function.                           |  |  |  |  |          |\n|           |  |                                    |  |  |  |  |          |\n|           |  |When present, this IE shall contain |  |  |  |  |          |\n|           |  |the information that the UPF shall  |  |  |  |  |          |\n|           |  |perfom ARP proxying as specified in |  |  |  |  |          |\n|           |  |IETF\u00a0RFC\u00a01027\u00a0[32] and / or IPv6    |  |  |  |  |          |\n|           |  |Neighbour Solicitation Proxying as  |  |  |  |  |          |\n|           |  |specified in IETF\u00a0RFC\u00a04861\u00a0[33]     |  |  |  |  |          |\n|           |  |functionality for the Ethernet PDUs.|  |  |  |  |          |\n|NOTE 1: The Network Instance parameter is needed e.g. in the following   |\n|cases:                                                                   |\n|- PGW/TDF UP function supports multiple PDNs with overlapping IP         |\n|addresses;                                                               |\n|- SGW UP function is connected to PGWs in different IP domains (S5/S8);  |\n|- PGW UP function is connected to SGWs in different IP domains (S5/S8);  |\n|- SGW UP function is connected to eNodeBs in different IP domains;       |\n|- UPF is connected to 5G-ANs in different IP domains.                    |\n\n\n  Editor's Note: PCC dependencies are FFS on N4.\n\n\n\n              Table 7.5.2.3-3: Duplicating Parameters IE in FAR\n\n|Octet 1 and|  |Duplicating Parameters IE Type = 5 (decimal)              |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Outer      |C |This IE shall be present if the UP  |X |X |- |X |Outer     |\n|Header     |  |function is required to add one or  |  |  |  |  |Header    |\n|Creation   |  |more outer header(s) to the outgoing|  |  |  |  |Creation  |\n|           |  |packet. If present, it shall contain|  |  |  |  |          |\n|           |  |the F-TEID of the remote GTP-U peer.|  |  |  |  |          |\n|Transport  |C |This IE shall be present if the UP  |X |X |- |X |Transport |\n|Level      |  |function is required to mark the IP |  |  |  |  |Level     |\n|marking    |  |header with the DSCP marking as     |  |  |  |  |Marking   |\n|           |  |defined by IETF\u00a0RFC\u00a02474\u00a0[22]. When |  |  |  |  |          |\n|           |  |present, it shall contain the value |  |  |  |  |          |\n|           |  |of the DSCP in the TOS/Traffic Class|  |  |  |  |          |\n|           |  |field.                              |  |  |  |  |          |\n|Forwarding |C |This IE shall be present if a       |X |X |- |X |Forwarding|\n|Policy     |  |specific forwarding policy is       |  |  |  |  |Policy    |\n|           |  |required to be applied to the       |  |  |  |  |          |\n|           |  |packets. When present, it shall     |  |  |  |  |          |\n|           |  |contain an Identifier of the        |  |  |  |  |          |\n|           |  |Forwarding Policy locally configured|  |  |  |  |          |\n|           |  |in the UP function.                 |  |  |  |  |          |\n\n\n  Editor's Note: Interception is FFS on N4, needs confirmation from SA3LI.\n\n\n\n\n"}, {"key": "Create URR IE within PFCP Session Establishment Request", "numbering": "7.5.2.4", "title_level": 3, "desc": ""}, {"key": "Create QER IE within PFCP Session Establishment Request", "numbering": "7.5.2.5", "title_level": 3, "desc": "7.5.2.4  Create URR IE within PFCP Session Establishment Request\n\nThe Create URR grouped IE shall be encoded as shown in Figure 7.5.2.4-1.\n\n  Table 7.5.2.4-1: Create URR IE within PFCP Session Establishment Request\n\n|Octet 1 and|  |Create URR IE Type = 6 (decimal)                          |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Reporting  |M |This IE shall indicate the          |X |X |X |X |Reporting |\n|Triggers   |  |trigger(s) for reporting network    |  |  |  |  |Triggers  |\n|           |  |resources usage to the CP function, |  |  |  |  |          |\n|           |  |e.g. periodic reporting or reporting|  |  |  |  |          |\n|           |  |upon reaching a threshold, or       |  |  |  |  |          |\n|           |  |envelope closure.                   |  |  |  |  |          |\n|Measurement|C |This IE shall be present if periodic|X |X |X |X |Measuremen|\n|Period     |  |reporting is required. When present,|  |  |  |  |t Period  |\n|           |  |it shall indicate the period for    |  |  |  |  |          |\n|           |  |generating and reporting usage      |  |  |  |  |          |\n|           |  |reports.                            |  |  |  |  |          |\n|Volume     |C |This IE shall be present if         |X |X |X |X |Volume    |\n|Threshold  |  |volume-based measurement is used and|  |  |  |  |Threshold |\n|           |  |reporting is required upon reaching |  |  |  |  |          |\n|           |  |a volume threshold. When present, it|  |  |  |  |          |\n|           |  |shall indicate the traffic volume   |  |  |  |  |          |\n|           |  |value after which the UP function   |  |  |  |  |          |\n|           |  |shall report network resources usage|  |  |  |  |          |\n|           |  |to the CP function for this URR.    |  |  |  |  |          |\n|Volume     |C |This IE shall be present if         |- |X |X |X |Volume    |\n|Quota      |  |volume-based measurement is used and|  |  |  |  |Quota     |\n|           |  |the CP function needs to provision a|  |  |  |  |          |\n|           |  |Volume Quota in the UP function (see|  |  |  |  |          |\n|           |  |subclause 5.2.2.2)                  |  |  |  |  |          |\n|           |  |When present, it shall indicate the |  |  |  |  |          |\n|           |  |Volume Quota value.                 |  |  |  |  |          |\n|Time       |C |This IE shall be present if         |X |X |X |X |Time      |\n|Threshold  |  |time-based measurement is used and  |  |  |  |  |Threshold |\n|           |  |reporting is required upon reaching |  |  |  |  |          |\n|           |  |a time threshold. When present, it  |  |  |  |  |          |\n|           |  |shall indicate the time usage after |  |  |  |  |          |\n|           |  |which the UP function shall report  |  |  |  |  |          |\n|           |  |network resources usage to the CP   |  |  |  |  |          |\n|           |  |function for this URR.              |  |  |  |  |          |\n|Time Quota |C |This IE shall be present if         |- |X |X |X |Time Quota|\n|           |  |time-based measurement is used and  |  |  |  |  |          |\n|           |  |the CP function needs to provision a|  |  |  |  |          |\n|           |  |Time Quota in the UP function (see  |  |  |  |  |          |\n|           |  |subclause 5.2.2.2)                  |  |  |  |  |          |\n|           |  |When present, it shall indicate the |  |  |  |  |          |\n|           |  |Time Quota value                    |  |  |  |  |          |\n|Quota      |C |This IE shall be present, for a     |- |X |X |X |Quota     |\n|Holding    |  |time, volume or event-based         |  |  |  |  |Holding   |\n|Time       |  |measurement, if reporting is        |  |  |  |  |Time      |\n|           |  |required and packets are no longer  |  |  |  |  |          |\n|           |  |permitted to pass on when no packets|  |  |  |  |          |\n|           |  |are received during a given         |  |  |  |  |          |\n|           |  |inactivity period.                  |  |  |  |  |          |\n|           |  |When present, it shall contain the  |  |  |  |  |          |\n|           |  |duration of the inactivity period.  |  |  |  |  |          |\n|Dropped DL |C |This IE shall be present if         |X |- |- |  |Dropped DL|\n|Traffic    |  |reporting is required when the DL   |  |  |  |  |Traffic   |\n|Threshold  |  |traffic being dropped exceeds a     |  |  |  |  |Threshold |\n|           |  |threshold.                          |  |  |  |  |          |\n|           |  |When present, it shall contain the  |  |  |  |  |          |\n|           |  |threshold of the DL traffic being   |  |  |  |  |          |\n|           |  |dropped.                            |  |  |  |  |          |\n|Monitoring |O |When present, this IE shall contain |- |X |X |X |Monitoring|\n|Time       |  |the time at which the UP function   |  |  |  |  |Time      |\n|           |  |shall re-apply the volume or time   |  |  |  |  |          |\n|           |  |threshold.                          |  |  |  |  |          |\n|Subsequent |O |This IE may be present if the       |- |X |X |X |Subsequent|\n|Volume     |  |Monitoring Time IE is present and   |  |  |  |  |Volume    |\n|Threshold  |  |volume-based measurement is used.   |  |  |  |  |Threshold |\n|           |  |When present, it shall indicate the |  |  |  |  |          |\n|           |  |traffic volume value after which the|  |  |  |  |          |\n|           |  |UP function shall report network    |  |  |  |  |          |\n|           |  |resources usage to the CP function  |  |  |  |  |          |\n|           |  |for this URR for the period after   |  |  |  |  |          |\n|           |  |the Monitoring Time.                |  |  |  |  |          |\n|Subsequent |O |This IE may be present if the       |- |X |X |X |Subsequent|\n|Time       |  |Monitoring Time IE is present and   |  |  |  |  |Time      |\n|Threshold  |  |time-based measurement is used.     |  |  |  |  |Threshold |\n|           |  |When present, it shall indicate the |  |  |  |  |          |\n|           |  |time usage after which the UP       |  |  |  |  |          |\n|           |  |function shall report network       |  |  |  |  |          |\n|           |  |resources usage to the CP function  |  |  |  |  |          |\n|           |  |for this URR for the period after   |  |  |  |  |          |\n|           |  |the Monitoring Time.                |  |  |  |  |          |\n|Subsequent |O |This IE may be present if Monitoring|- |X |X |X |Subsequent|\n|Volume     |  |Time IE is present and volume-based |  |  |  |  |Volume    |\n|Quota      |  |measurement is used (see subclause  |  |  |  |  |Quota     |\n|           |  |5.2.2.2).                           |  |  |  |  |          |\n|           |  |When present, it shall indicate the |  |  |  |  |          |\n|           |  |Volume Quota value which the UP     |  |  |  |  |          |\n|           |  |function shall use for this URR for |  |  |  |  |          |\n|           |  |the period after the Monitoring     |  |  |  |  |          |\n|           |  |Time.                               |  |  |  |  |          |\n|Linked URR |C |This IE shall be present if linked  |- |X |X |X |Linked URR|\n|ID         |  |usage reporting is required. When   |  |  |  |  |ID        |\n|           |  |present, this IE shall contain the  |  |  |  |  |          |\n|           |  |linked URR ID which is related with |  |  |  |  |          |\n|           |  |this URR (see subclause 5.2.2.4).   |  |  |  |  |          |\n|           |  |Several IEs with the same IE type   |  |  |  |  |          |\n|           |  |may be present to represent multiple|  |  |  |  |          |\n|           |  |linked URRs which are related with  |  |  |  |  |          |\n|           |  |this URR.                           |  |  |  |  |          |\n|Measurement|C |This IE shall be included if any of |  |  |  |  |Measuremen|\n|Information|  |the following flag is set to 1.     |  |  |  |  |t         |\n|           |  |Applicable flags are:               |  |  |  |  |Informatio|\n|           |  |- Measurement Before QoS Enforcement|- |X |X |X |n         |\n|           |  |Flag: this flag shall be set to 1 if|  |  |  |  |          |\n|           |  |the traffic usage before any QoS    |  |  |  |  |          |\n|           |  |Enforcement is requested to be      |  |  |  |  |          |\n|           |  |measured.                           |  |  |  |  |          |\n|           |  |- Inactive Measurement Flag: this   |- |X |- |X |          |\n|           |  |flag shall be set to 1 if the       |  |  |  |  |          |\n|           |  |measurement shall be paused         |  |  |  |  |          |\n|           |  |(inactive). The measurement shall be|  |  |  |  |          |\n|           |  |performed (active) if the bit is set|  |  |  |  |          |\n|           |  |to 0 or if the Measurement          |  |  |  |  |          |\n|           |  |Information IE is not present in the|  |  |  |  |          |\n|           |  |Create URR IE.                      |  |  |  |  |          |\n|           |  |- Reduced Application Detection     |  |  |  |  |          |\n|           |  |Information Flag: this flag may be  |  |  |  |  |          |\n|           |  |set to 1, if the Reporting Triggers |  |  |  |  |          |\n|           |  |request to report the start or stop |  |  |  |  |          |\n|           |  |of application, to request the UP   |  |  |  |  |          |\n|           |  |function to only report the         |  |  |  |  |          |\n|           |  |Application ID in the Application   |  |  |  |  |          |\n|           |  |Detection Information, e.g. for     |  |  |  |  |          |\n|           |  |envelope reporting.                 |  |  |  |  |          |\n|Time Quota |C |This IE shall be present if         |- |X |- |- |Time Quota|\n|Mechanism  |  |time-based measurement based on CTP |  |  |  |  |Mechanism |\n|           |  |or DTP is used.                     |  |  |  |  |          |\n|Aggregated |C |This IE shall be included if the URR|- |X |- |  |Aggregated|\n|URRs       |  |is used to support a Credit Pool.   |  |  |  |  |URRs      |\n|           |  |                                    |  |  |  |  |          |\n|           |  |Several IEs with the same IE type   |  |  |  |  |          |\n|           |  |may be present to provide multiple  |  |  |  |  |          |\n|           |  |aggregated URRs.                    |  |  |  |  |          |\n|FAR ID for |C |This IE may be present if the Volume|- |X |X |X |FAR ID    |\n|Quota      |  |Quota IE and/or the Time Quota IE is|  |  |  |  |          |\n|Action     |  |provisioned in the URR and the UP   |  |  |  |  |          |\n|           |  |Function indicated support of the   |  |  |  |  |          |\n|           |  |Quota Action feature.               |  |  |  |  |          |\n|           |  |When present, it shall contain the  |  |  |  |  |          |\n|           |  |identifier of the substitute FAR the|  |  |  |  |          |\n|           |  |UP function shall apply, for the    |  |  |  |  |          |\n|           |  |traffic associated to this URR, when|  |  |  |  |          |\n|           |  |exhausting any of these quotas. See |  |  |  |  |          |\n|           |  |NOTE 1.                             |  |  |  |  |          |\n|Ethernet Inactivity Timer                                                |\n\n\n  Editor's Note:  In 5GC Pause of charging support is FFS (Dropped down\n         link packets).\n\n\n\n                      Table 7.5.2.4-2: Aggregated URRs\n\n|Octet 1 and|  |Aggregated URRs = 118 (decimal)                           |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Gate Status|M |This IE shall indicate whether the  |- |X |X |X |Gate      |\n|           |  |packets are allowed to be forwarded |  |  |  |  |Status    |\n|           |  |(the gate is open) or shall be      |  |  |  |  |          |\n|           |  |discarded (the gate is closed) in   |  |  |  |  |          |\n|           |  |the uplink and/or downlink          |  |  |  |  |          |\n|           |  |directions.                         |  |  |  |  |          |\n|Maximum    |C |This IE shall be present if an MBR  |- |X |X |X |MBR       |\n|Bitrate    |  |enforcement action shall be applied |  |  |  |  |          |\n|           |  |to packets matching this PDR. When  |  |  |  |  |          |\n|           |  |present, this IE shall indicate the |  |  |  |  |          |\n|           |  |uplink and/or downlink maximum bit  |  |  |  |  |          |\n|           |  |rate to be enforced for packets     |  |  |  |  |          |\n|           |  |matching the PDR.                   |  |  |  |  |          |\n|           |  |                                    |  |  |  |  |          |\n|           |  |This IE may be set to the value of: |  |  |  |  |          |\n|           |  |- the APN-AMBR, for a QER that is   |  |  |  |  |          |\n|           |  |referenced by all the PDRs of the   |  |  |  |  |          |\n|           |  |non-GBR bearers of a PDN connection;|  |  |  |  |          |\n|           |  |                                    |  |  |  |  |          |\n|           |  |- the TDF session MBR, for a QER    |  |  |  |  |          |\n|           |  |that is referenced by all the PDRs  |  |  |  |  |          |\n|           |  |of a TDF session;                   |  |  |  |  |          |\n|           |  |- the bearer MBR, for a QER that is |  |  |  |  |          |\n|           |  |referenced by all the PDRs of a     |  |  |  |  |          |\n|           |  |bearer;                             |  |  |  |  |          |\n|           |  |- the QoS Flow MBR, for a QER that  |  |  |  |  |          |\n|           |  |is referenced by all the PDRs of a  |  |  |  |  |          |\n|           |  |QoS Flow (for 5GC);                 |  |  |  |  |          |\n|           |  |- the SDF MBR, for a QER that is    |  |  |  |  |          |\n|           |  |referenced by all the PDRs of a SDF.|  |  |  |  |          |\n|Guaranteed |C |This IE shall be present if a GBR   |- |X |X |X |GBR       |\n|Bitrate    |  |has been authorized to packets      |  |  |  |  |          |\n|           |  |matching this PDR. When present,    |  |  |  |  |          |\n|           |  |this IE shall indicate the          |  |  |  |  |          |\n|           |  |authorized uplink and/or downlink   |  |  |  |  |          |\n|           |  |guaranteed bit rate.                |  |  |  |  |          |\n|           |  |                                    |  |  |  |  |          |\n|           |  |This IE may be set to the value of: |  |  |  |  |          |\n|           |  |- the aggregate GBR, for a QER that |  |  |  |  |          |\n|           |  |is referenced by all the PDRs of a  |  |  |  |  |          |\n|           |  |GBR bearer;                         |  |  |  |  |          |\n|           |  |- the QoS Flow GBR, for a QER that  |  |  |  |  |          |\n|           |  |is referenced by all the PDRs of a  |  |  |  |  |          |\n|           |  |QoS Flow (for 5GC);                 |  |  |  |  |          |\n|           |  |- the SDF GBR, for a QER that is    |  |  |  |  |          |\n|           |  |referenced by all the PDRs of a SDF.|  |  |  |  |          |\n|Packet Rate|C |This IE shall be present if a Packet|- |X |- |  |Packet    |\n|           |  |Rate enforcement action (in terms of|  |  |  |  |Rate      |\n|           |  |number of packets per time interval)|  |  |  |  |          |\n|           |  |shall be applied to packets matching|  |  |  |  |          |\n|           |  |this PDR.                           |  |  |  |  |          |\n|           |  |When present, this IE shall indicate|  |  |  |  |          |\n|           |  |the uplink and/or downlink maximum  |  |  |  |  |          |\n|           |  |packet rate to be enforced for      |  |  |  |  |          |\n|           |  |packets matching the PDR.           |  |  |  |  |          |\n|           |  |This IE may be set to the value of: |  |  |  |  |          |\n|           |  |- downlink packet rate for Serving  |  |  |  |  |          |\n|           |  |PLMN Rate Control, for a QER that is|  |  |  |  |          |\n|           |  |referenced by all PDRs of the UE    |  |  |  |  |          |\n|           |  |belonging to the PDN connection     |  |  |  |  |          |\n|           |  |using CIoT EPS Optimizations as     |  |  |  |  |          |\n|           |  |described in 3GPP\u00a0TS\u00a023.401\u00a0[2])    |  |  |  |  |          |\n|           |  |- uplink and/or downlink packet rate|  |  |  |  |          |\n|           |  |for APN Rate Control, for a QER that|  |  |  |  |          |\n|           |  |is referenced by all the PDRs of the|  |  |  |  |          |\n|           |  |UE belonging to PDN connections to  |  |  |  |  |          |\n|           |  |the same APN using CIoT EPS         |  |  |  |  |          |\n|           |  |Optimizations as described in       |  |  |  |  |          |\n|           |  |3GPP\u00a0TS\u00a023.401\u00a0[2]).                |  |  |  |  |          |\n|DL Flow    |C |This IE shall be set if the UP      |- |X |X |- |DL Flow   |\n|Level      |  |function is required to mark the    |  |  |  |  |Level     |\n|Marking    |  |packets for QoS purposes:           |  |  |  |  |Marking   |\n|           |  |                                    |  |  |  |  |          |\n|           |  |- by the TDF-C, for DL flow level   |  |  |  |  |          |\n|           |  |marking for application indication  |  |  |  |  |          |\n|           |  |(see subclause 5.4.5);              |  |  |  |  |          |\n|           |  |-  by the PGW-C, for setting the    |  |  |  |  |          |\n|           |  |GTP-U Service Class Indicator       |  |  |  |  |          |\n|           |  |extension header for service        |  |  |  |  |          |\n|           |  |indication towards GERAN (see       |  |  |  |  |          |\n|           |  |subclause 5.4.12).                  |  |  |  |  |          |\n|QoS flow   |C |This IE shall be present if the QoS |- |- |- |X |QFI       |\n|identifier |  |flow identifier shall be included by|  |  |  |  |          |\n|           |  |the UPF.                            |  |  |  |  |          |\n|Reflective |C |This IE shall be present if the UP  |- |- |- |X |RQI       |\n|QoS        |  |function is required to set         |  |  |  |  |          |\n|           |  |Reflective QoS Identifier to request|  |  |  |  |          |\n|           |  |reflective QoS for uplink traffic.  |  |  |  |  |          |\n\n\n\n"}, {"key": "Create BAR IE within PFCP Session Establishment Request", "numbering": "7.5.2.6", "title_level": 3, "desc": "7.5.2.6  Create BAR IE within PFCP Session Establishment Request\n\nThe Create BAR grouped IE shall be encoded as shown in Figure 7.5.2.6-1.\n\n  Table 7.5.2.6-1: Create BAR IE within PFCP Session Establishment Request\n\n|Octet 1 and|  |Create BAR IE Type = 85 (decimal)                         |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Suggested  |C |This IE may be present if the UP    |  |X |X |X |Suggested |\n|Buffering  |  |Function indicated support of the   |  |  |  |  |Buffering |\n|Packets    |  |the feature UDBC.                   |  |  |  |  |Packets   |\n|Count      |  |                                    |  |  |  |  |Count     |\n|           |  |When present, it shall contain the  |  |  |  |  |          |\n|           |  |number of packets that are suggested|  |  |  |  |          |\n|           |  |to be buffered when the Apply Action|  |  |  |  |          |\n|           |  |parameter requests to buffer the    |  |  |  |  |          |\n|           |  |packets. The packets that exceed the|  |  |  |  |          |\n|           |  |limit shall be discarded.           |  |  |  |  |          |\n\n\n  Editor's Note; Downlink Data Notification Delay is under discussion in\n         stage 2.\n\n\n"}, {"key": "Create Traffic Endpoint IE within Sx Session Establishment Request", "numbering": "7.5.2.7", "title_level": 3, "desc": "7.5.2.7  Create Traffic Endpoint IE within Sx Session Establishment Request\n\nThe Create Traffic Endpoint grouped IE shall be encoded as shown in Figure\n7.5.2.7-1.\n\n       Table 7.5.2.7-1: Create Traffic Endpoint IE within PFCP Session\n                            Establishment Request\n\n|Octet 1 and|Create Traffic Endpoint IE Type = 127(decimal)               |\n|2          |                                                             |\n|Octets 3   |Length = n                                                   |\n|and 4      |                                                             |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Traffic    |M |This IE shall uniquely identify the |X |X |X |X |Traffic   |\n|Endpoint ID|  |Traffic Endpoint for that Sx        |  |  |  |  |Endpoint  |\n|           |  |session.                            |  |  |  |  |ID        |\n|Local      |O |If present, this IE shall identify  |X |X |- |X |F-TEID    |\n|F-TEID     |  |the local F-TEID to match for an    |  |  |  |  |          |\n|           |  |incoming packet.                    |  |  |  |  |          |\n|           |  |The CP function shall set the CHOOSE|  |  |  |  |          |\n|           |  |(CH) bit to 1 if the UP function    |  |  |  |  |          |\n|           |  |supports the allocation of F-TEID   |  |  |  |  |          |\n|           |  |and the CP function requests the UP |  |  |  |  |          |\n|           |  |function to assign a local F-TEID to|  |  |  |  |          |\n|           |  |the Traffic Endpoint.               |  |  |  |  |          |\n|Network    |O |If present, this IE shall identify  |X |X |X |X |Network   |\n|Instance   |  |the Network instance to match for   |  |  |  |  |Instance  |\n|           |  |the incoming packet. See NOTE 1,    |  |  |  |  |          |\n|           |  |NOTE2.                              |  |  |  |  |          |\n|UE IP      |O |If present, this IE shall identify  |- |X |X |X |UE IP     |\n|address    |  |the source or destination IP address|  |  |  |  |address   |\n|           |  |to match for the incoming packet.   |  |  |  |  |          |\n|Ethernet   |O |This IE may be present to identify  |- |- |- |X |Ethernet  |\n|PDU Session|  |all the (DL) Ethernet packets       |  |  |  |  |PDU       |\n|Information|  |matching an Ethernet PDU session    |  |  |  |  |Session   |\n|           |  |(see subclause 5.13.1).             |  |  |  |  |Informatio|\n|           |  |                                    |  |  |  |  |n         |\n|NOTE 1: The Network Instance parameter is needed e.g. in the following   |\n|cases:                                                                   |\n|- PGW/TDF UP function supports multiple PDNs with overlapping IP         |\n|addresses;                                                               |\n|- SGW UP function is connected to PGWs in different IP domains (S5/S8);  |\n|- PGW UP function is connected to SGWs in different IP domains (S5/S8);  |\n|- SGW UP function is connected to eNodeBs in different IP domains;       |\n|- UPF is connected to 5G-ANs in different IP domains.                    |\n|NOTE 2:  When a Local F-TEID is provisioned in the Traffic Endpoint, the |\n|Network Instance shall relate to the IP address of the F-TEID. Otherwise,|\n|the Network Instance shall relate to the UE IP address.                  |\n\n\n\n"}, {"key": "PFCP Session Establishment Response", "numbering": "7.5.3", "title_level": 2, "desc": "7.5.3  PFCP Session Establishment Response\n\n\n"}, {"key": "General", "numbering": "7.5.3.1", "title_level": 3, "desc": ""}, {"key": "Created PDR IE within PFCP Session Establishment Response", "numbering": "7.5.3.2", "title_level": 3, "desc": "7.5.3.1  General\n\nThe PFCP Session Establishment Response shall be sent over the Sxa, Sxb,\nSxc and N4 interface by the UP function to the CP function as a reply to\nthe PFCP Session Establishment Request.\n\n    Table 7.5.3.1-1: Information Elements in a PFCP Session Establishment\n                                  Response\n\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Node ID    |M |This IE shall contain the unique    |X |X |X |X |Node ID   |\n|           |  |identifier of the sending Node.     |  |  |  |  |          |\n|Cause      |M |This IE shall indicate the          |X |X |X |X |Cause     |\n|           |  |acceptance or the rejection of the  |  |  |  |  |          |\n|           |  |corresponding request message.      |  |  |  |  |          |\n|Offending  |C |This IE shall be included if the    |X |X |X |X |Offending |\n|IE         |  |rejection is due to a conditional or|  |  |  |  |IE        |\n|           |  |mandatory IE missing or faulty.     |  |  |  |  |          |\n|Created PDR|C |This IE shall be present if the cause is set to \"success\" |\n|           |  |and the UP function was requested to allocate the local   |\n|           |  |F-TEID for the PDR.                                       |\n|           |  |When present, this IE shall contain the PDR information   |\n|           |  |associated to the PFCP session. There may be several      |\n|           |  |instances of this IE.                                     |\n|           |  |See table 7.5.3.2-1.                                      |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Local      |C |If the UP function allocates the    |X |X |- |X |F-TEID    |\n|F-TEID     |  |F-TEID, this IE shall be present and|  |  |  |  |          |\n|           |  |shall contain the local F-TEID to be|  |  |  |  |          |\n|           |  |used for this PDR.                  |  |  |  |  |          |\n\n\n\n"}, {"key": "Load Control Information IE within PFCP Session Establishment", "numbering": "7.5.3.3", "title_level": 3, "desc": "7.5.3.3  Load Control Information IE within PFCP Session Establishment\n           Response\n\nThe Load Control Information grouped IE shall be encoded as shown in Figure\n7.5.3.3-1.\n\n      Table 7.5.3.3-1: Load Control Information IE within PFCP Session\n                           Establishment Response\n\n|Octet 1 and|  |Load Control Information IE Type = 51 (decimal)           |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Load Metric|M |See subclause 6.2.3.3.2 for the     |X |X |X |X |Metric    |\n|           |  |description and use of this         |  |  |  |  |          |\n|           |  |parameter.                          |  |  |  |  |          |\n\n\n\n"}, {"key": "Overload Control Information IE within PFCP Session Establishment", "numbering": "7.5.3.4", "title_level": 3, "desc": "7.5.3.4  Overload Control Information IE within PFCP Session Establishment\n           Response\n\nThe Overload Control grouped IE shall be encoded as shown in Figure 7.5.3.4-\n1.\n\n    Table 7.5.3.4-1: Overload Control Information IE within PFCP Session\n                           Establishment Response\n\n|Octet 1 and|  |Overload Control Information IE Type = 54 (decimal)       |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Overload   |M |See subclause 6.2.4.3.2 for the     |X |X |X |X |Metric    |\n|Reduction  |  |description and use of this         |  |  |  |  |          |\n|Metric     |  |parameter.                          |  |  |  |  |          |\n|Period of  |M |See subclause 6.2.4.3.2 for the     |X |X |X |X |Timer     |\n|Validity   |  |description and use of this         |  |  |  |  |          |\n|           |  |parameter.                          |  |  |  |  |          |\n|Overload   |C |This IE shall be included if any of |X |X |X |X |OCI Flags |\n|Control    |  |flag in this IE is set.             |  |  |  |  |          |\n|Information|  |                                    |  |  |  |  |          |\n|Flags      |  |                                    |  |  |  |  |          |\n\n\n\n"}, {"key": "Created Traffic Endpoint IE within Sx Session Establishment", "numbering": "7.5.3.5", "title_level": 3, "desc": "7.5.3.5  Created Traffic Endpoint IE within Sx Session Establishment\n           Response\n\nThe Created Traffic Endpoint grouped IE shall be encoded as shown in Figure\n7.5.3.5-1.\n\n       Table 7.5.3.5-1: Created Traffic Endpoint IE within Sx Session\n                           Establishment Response\n\n|Octet 1 and|  |Created Traffic Endpoint IE Type = 128 (decimal)          |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Local      |C |If the UP function allocates the    |X |X |- |X |F-TEID    |\n|F-TEID     |  |F-TEID, this IE shall be present and|  |  |  |  |          |\n|           |  |shall contain the local F-TEID to be|  |  |  |  |          |\n|           |  |used for this Traffic Endpoint.     |  |  |  |  |          |\n\n\n\n"}, {"key": "PFCP Session Modification Request", "numbering": "7.5.4", "title_level": 2, "desc": "7.5.4  PFCP Session Modification Request\n\n\n"}, {"key": "General", "numbering": "7.5.4.1", "title_level": 3, "desc": "7.5.4.1  General\n\nThe PFCP Session Modification Request is used over the Sxa, Sxb, Sxc and N4\ninterface by the CP function to request the UP function to modify the PFCP\nsession.\n\n    Table 7.5.4.1-1: Information Elements in a PFCP Session Modification\n                                   Request\n\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|CP F-SEID  |C |This IE shall be present if the CP  |X |X |X |X |F-SEID    |\n|           |  |function decides to change its      |  |  |  |  |          |\n|           |  |F-SEID for the PFCP session. The UP |  |  |  |  |          |\n|           |  |function shall use the new CP F-SEID|  |  |  |  |          |\n|           |  |for subsequent PFCP Session related |  |  |  |  |          |\n|           |  |messages for this PFCP Session. See |  |  |  |  |          |\n|           |  |Note 2.                             |  |  |  |  |          |\n|Remove PDR                                                               |\n\n\n\n"}, {"key": "Update PDR IE within PFCP Session Modification Request", "numbering": "7.5.4.2", "title_level": 3, "desc": "7.5.4.2  Update PDR IE within PFCP Session Modification Request\n\nThe Update PDR grouped IE shall be encoded as shown in Figure 7.5.4.2-1.\n\n   Table 7.5.4.2-1: Update PDR IE within PFCP Session Modification Request\n\n|Octet 1 and|  |Update PDR IE Type = 9 (decimal)                          |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Outer      |C |This IE shall be present if it needs|X |X |- |X |Outer     |\n|Header     |  |to be changed.                      |  |  |  |  |Header    |\n|Removal    |  |                                    |  |  |  |  |Removal   |\n|Precedence |C |This IE shall be present if there is|- |X |X |X |Precedence|\n|           |  |a change in the PDR's precedence to |  |  |  |  |          |\n|           |  |be applied by the UP function among |  |  |  |  |          |\n|           |  |all PDRs of the PFCP session, when  |  |  |  |  |          |\n|           |  |looking for a PDR matching an       |  |  |  |  |          |\n|           |  |incoming packet.                    |  |  |  |  |          |\n|PDI        |C |This IE shall be present if there is|X |X |X |X |PDI       |\n|           |  |a change within the PDI against     |  |  |  |  |          |\n|           |  |which incoming packets will be      |  |  |  |  |          |\n|           |  |matched. When present, this IE shall|  |  |  |  |          |\n|           |  |replace the PDI previously stored in|  |  |  |  |          |\n|           |  |the UP function for this PDR. See   |  |  |  |  |          |\n|           |  |Table 7.5.2.2-2.                    |  |  |  |  |          |\n|FAR ID     |C |This IE shall be present if it needs|X |X |X |X |FAR ID    |\n|           |  |to be changed                       |  |  |  |  |          |\n|URR ID     |C |This IE shall be present if a       |X |X |X |X |URR ID    |\n|           |  |measurement action shall be applied |  |  |  |  |          |\n|           |  |or no longer applied to packets     |  |  |  |  |          |\n|           |  |matching this PDR.                  |  |  |  |  |          |\n|           |  |When present, this IE shall contain |  |  |  |  |          |\n|           |  |the list of all the URR IDs to be   |  |  |  |  |          |\n|           |  |associated to the PDR.              |  |  |  |  |          |\n|QER ID     |C |This IE shall be present if a QoS   |- |X |X |X |QER ID    |\n|           |  |enforcement action shall be applied |  |  |  |  |          |\n|           |  |or no longer applied to packets     |  |  |  |  |          |\n|           |  |matching this PDR.                  |  |  |  |  |          |\n|           |  |When present, this IE shall contain |  |  |  |  |          |\n|           |  |the list of all the QER IDs to be   |  |  |  |  |          |\n|           |  |associated to the PDR.              |  |  |  |  |          |\n|Activate Predefined Rules                                                |\n\n\n\n"}, {"key": "Update FAR IE within PFCP Session Modification Request", "numbering": "7.5.4.3", "title_level": 3, "desc": "7.5.4.3  Update FAR IE within PFCP Session Modification Request\n\nThe Update FAR grouped IE shall be encoded as shown in Figure 7.5.4.3-1.\n\n   Table 7.5.4.3-1: Update FAR IE within PFCP Session Modification Request\n\n|Octet 1 and|  |Update FAR IE Type = 10 (decimal)                         |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Apply      |C |This IE shall be present if it is   |X |X |X |X |Apply     |\n|Action     |  |changed.                            |  |  |  |  |Action    |\n|Update     |C |This IE shall be present if it is   |X |X |X |X |Update    |\n|Forwarding |  |changed.See table 7.5.4.3-2.        |  |  |  |  |Forwarding|\n|parameters |  |                                    |  |  |  |  |Parameters|\n|Update     |C |This IE shall be present if it is   |X |X |- |X |Update    |\n|Duplicating|  |changed. See table 7.5.4.3-3.       |  |  |  |  |Duplicatin|\n|Parameters |  |Several IEs with the same IE type   |  |  |  |  |g         |\n|           |  |may be present to request to        |  |  |  |  |Parameters|\n|           |  |duplicate the packets to different  |  |  |  |  |          |\n|           |  |destinations.                       |  |  |  |  |          |\n|BAR ID     |C |This IE shall be present if the BAR |X |- |- |X |BAR ID    |\n|           |  |ID associated to the FAR needs to be|  |  |  |  |          |\n|           |  |modified. See Table 7.5.4.11-1.     |  |  |  |  |          |\n|NOTE: The IEs which do not need to be modified shall not be included in  |\n|the Update FAR IE. The UP function shall continue to behave according to |\n|the values previously received for IEs not present in the Update FAR IE. |\n\n\n  Editor's Note: Interception (e.g. Update Duplicating Parameters) needs\n         final confirmation form SA3LI.\n\n\n\n           Table 7.5.4.3-2: Update Forwarding Parameters IE in FAR\n\n|Octet 1 and|  |Update Forwarding Parameters IE Type = 11 (decimal)       |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Network    |C |This IE shall only be provided if it|X |X |X |X |Network   |\n|instance   |  |is changed.                         |  |  |  |  |Instance  |\n|Redirect   |C |This IE shall be present if the     |- |X |X |X |Redirect  |\n|Information|  |instructions regarding the          |  |  |  |  |Informatio|\n|           |  |redirection of traffic by the UP    |  |  |  |  |n         |\n|           |  |function need to be modified.       |  |  |  |  |          |\n|Outer      |C |This IE shall only be provided if it|X |X |- |X |Outer     |\n|Header     |  |is changed                          |  |  |  |  |Header    |\n|Creation   |  |                                    |  |  |  |  |Creation  |\n|Transport  |C |This IE shall only be provided if it|X |X |- |X |Transport |\n|Level      |  |is changed                          |  |  |  |  |Level     |\n|Marking    |  |                                    |  |  |  |  |Marking   |\n|Forwarding |C |This IE shall only be provided if it|- |X |X |X |Forwarding|\n|Policy     |  |is changed                          |  |  |  |  |Policy    |\n|Header     |C |This IE shall only be provided if it|- |X |X |X |Header    |\n|Enrichment |  |is changed                          |  |  |  |  |Enrichment|\n|PFCPSMReq-F|C |This IE shall be included if at     |X |X |- |X |PFCPSMReq-|\n|lags       |  |least one of the flags is set to 1. |  |  |  |  |Flags     |\n|           |  |- SNDEM (Send End Marker Packets):  |  |  |  |  |          |\n|           |  |this IE shall be present if the CP  |  |  |  |  |          |\n|           |  |function modifies the F-TEID of the |  |  |  |  |          |\n|           |  |downstream node in the Outer Header |  |  |  |  |          |\n|           |  |Creation IE and the CP function     |  |  |  |  |          |\n|           |  |requests the UP function to         |  |  |  |  |          |\n|           |  |construct and send GTP-U End Marker |  |  |  |  |          |\n|           |  |messages towards the old F-TEID of  |  |  |  |  |          |\n|           |  |the downstream node.                |  |  |  |  |          |\n|Linked     |C |This IE may be present, if it is    |X |X |- |X |Traffic   |\n|Traffic    |  |changed and the UP function         |  |  |  |  |Endpoint  |\n|Endpoint ID|  |indicated support of the PDI        |  |  |  |  |ID        |\n|           |  |optimization feature, (see subclause|  |  |  |  |          |\n|           |  |8.2.25). When present, it shall     |  |  |  |  |          |\n|           |  |identify the Traffic Endpoint ID    |  |  |  |  |          |\n|           |  |allocated for this PFCP session to  |  |  |  |  |          |\n|           |  |receive the traffic in the reverse  |  |  |  |  |          |\n|           |  |direction (see subclause 5.2.3.1).  |  |  |  |  |          |\n\n\n          Table 7.5.4.3-3: Update Duplicating Parameters IE in FAR\n\n|Octet 1 and|  |Update Duplicating Parameters IE Type = 105 (decimal)     |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Outer      |C |This IE shall only be provided if it|X |X |- |X |Outer     |\n|Header     |  |is changed.                         |  |  |  |  |Header    |\n|Creation   |  |                                    |  |  |  |  |Creation  |\n|Transport  |C |This IE shall only be provided if it|X |X |- |X |Transport |\n|Level      |  |is changed.                         |  |  |  |  |Level     |\n|Marking    |  |                                    |  |  |  |  |Marking   |\n|Forwarding |C |This IE shall only be provided if it|- |X |- |X |Forwarding|\n|Policy     |  |is changed.                         |  |  |  |  |Policy    |\n\n\n  Editor's Note: Interception (e.g. Update Duplicating Parameters) needs\n         final confirmation form SA3LI.\n\n\n\n\n"}, {"key": "Update URR IE within PFCP Session Modification Request", "numbering": "7.5.4.4", "title_level": 3, "desc": "7.5.4.4  Update URR IE within PFCP Session Modification Request\n\nThe Update URR grouped IE shall be encoded as shown in Figure 7.5.4.4-1.\n\n   Table 7.5.4.4-1: Update URR IE within PFCP Session Modification Request\n\n|Octet 1 and|  |Update URR IE Type = 13 (decimal)                         |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Measurement Method                                                       |\n\n\n\n"}, {"key": "Update QER IE within PFCP Session Modification Request", "numbering": "7.5.4.5", "title_level": 3, "desc": "7.5.4.5  Update QER IE within PFCP Session Modification Request\n\nThe Update QER grouped IE shall be encoded as shown in Figure 7.5.4.5-1.\n\n   Table 7.5.4.5-1: Update QER IE within PFCP Session Modification Request\n\n|Octet 1 and|  |Update QER IE Type = 14 (decimal)                         |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|QER        |C |This IE shall be present if the QER |- |X |- |X |QER       |\n|Correlation|  |correlation ID in this QER needs to |  |  |  |  |Correlatio|\n|ID         |  |be modified.                        |  |  |  |  |n ID      |\n|           |  |See NOTE 1.                         |  |  |  |  |          |\n|Reflective |C |This IE shall be present if it needs|- |- |- |X |RQI       |\n|QoS        |  |to be modified.                     |  |  |  |  |          |\n|NOTE 1: The IEs which do not need to be modified shall not be included in|\n|the Update QER IE. The UP function shall continue to behave according to |\n|the values previously received for IEs not present in the Update QER IE. |\n\n\n\n"}, {"key": "Remove PDR IE within PFCP Session Modification Request", "numbering": "7.5.4.6", "title_level": 3, "desc": "7.5.4.6  Remove PDR IE within PFCP Session Modification Request\n\nThe Remove PDR grouped IE shall be encoded as shown in Figure 7.5.4.6-1.\n\n   Table 7.5.4.6-1: Remove PDR IE within PFCP Session Modification Request\n\n|Octet 1 and|  |Remove PDR IE Type = 15 (decimal)                         |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n\n\n\n"}, {"key": "Remove FAR IE within PFCP Session Modification Request", "numbering": "7.5.4.7", "title_level": 3, "desc": "7.5.4.7  Remove FAR IE within PFCP Session Modification Request\n\nThe Remove FAR grouped IE shall be encoded as shown in Figure 7.5.4.7-1.\n\n   Table 7.5.4.7-1: Remove FAR IE within PFCP Session Modification Request\n\n|Octet 1 and|  |Remove FAR IE Type = 16 (decimal)                         |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n\n\n\n"}, {"key": "Remove URR IE within PFCP Session Modification Request", "numbering": "7.5.4.8", "title_level": 3, "desc": "7.5.4.8  Remove URR IE within PFCP Session Modification Request\n\nThe Remove URR grouped IE shall be encoded as shown in Figure 7.5.4.7-1.\n\n   Table 7.5.4.8-1: Remove URR IE within PFCP Session Modification Request\n\n|Octet 1 and|  |Remove URR IE Type = 17 (decimal)                         |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n\n\n\n"}, {"key": "Remove QER IE PFCP Session Modification Request", "numbering": "7.5.4.9", "title_level": 3, "desc": "7.5.4.9  Remove QER IE PFCP Session Modification Request\n\nThe Remove QER grouped IE shall be encoded as shown in Figure 7.5.4.9-1.\n\n      Table 7.5.4.9-1: Remove QER IE PFCP Session Modification Request\n\n|Octet 1 and|  |Remove QER IE Type = 18 (decimal)                         |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n\n\n\n"}, {"key": "Query URR IE within PFCP Session Modification Request", "numbering": "7.5.4.10", "title_level": 3, "desc": "7.5.4.10 Query URR IE within PFCP Session Modification Request\n\nThe Query URR grouped IE shall be encoded as shown in Figure 7.5.4.10-1.\n\n   Table 7.5.4.10-1: Query URR IE within PFCP Session Modification Request\n\n|Octet 1 and|  |Query URR IE Type = 77 (decimal)                          |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n\n\n\n"}, {"key": "Update BAR IE within PFCP Session Modification Request", "numbering": "7.5.4.11", "title_level": 3, "desc": "7.5.4.11 Update BAR IE within PFCP Session Modification Request\n\nThe Update BAR grouped IE shall be encoded as shown in Figure 7.5.4.11-1.\n\n  Table 7.5.4.11-1: Update BAR IE within PFCP Session Modification Request\n\n|Octet 1 and|  |Update BAR IE Type = 86 (decimal)                         |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Downlink   |C |This IE shall be present if the UP  |X |- |- |X |Downlink  |\n|Data       |  |function indicated support of the   |  |  |  |  |Data      |\n|Notificatio|  |Downlink Data Notification Delay    |  |  |  |  |Notificati|\n|n Delay    |  |parameter (see subclause 8.2.28) and|  |  |  |  |on Delay  |\n|           |  |the Downlink Data Notification Delay|  |  |  |  |          |\n|           |  |needs to be modified.               |  |  |  |  |          |\n|           |  |When present, it shall contain the  |  |  |  |  |          |\n|           |  |delay the UP function shall apply   |  |  |  |  |          |\n|           |  |between receiving a downlink data   |  |  |  |  |          |\n|           |  |packet and notifying the CP function|  |  |  |  |          |\n|           |  |about it, when the Apply Action     |  |  |  |  |          |\n|           |  |parameter requests to buffer the    |  |  |  |  |          |\n|           |  |packets and notify the CP function. |  |  |  |  |          |\n|Suggested  |C |This IE may be present if the UP    |  |X |X |X |Suggested |\n|Buffering  |  |Function indicated support of the   |  |  |  |  |Buffering |\n|Packets    |  |the feature UDBC.                   |  |  |  |  |Packets   |\n|Count      |  |                                    |  |  |  |  |Count     |\n|           |  |When present, it shall contain the  |  |  |  |  |          |\n|           |  |number of packets that are suggested|  |  |  |  |          |\n|           |  |to be buffered when the Apply Action|  |  |  |  |          |\n|           |  |parameter requests to buffer the    |  |  |  |  |          |\n|           |  |packets. The packets that exceed the|  |  |  |  |          |\n|           |  |limit shall be discarded.           |  |  |  |  |          |\n\n\n\n"}, {"key": "Remove BAR IE within PFCP Session Modification Request", "numbering": "7.5.4.12", "title_level": 3, "desc": "7.5.4.12 Remove BAR IE within PFCP Session Modification Request\n\nThe Remove BAR grouped IE shall be encoded as shown in Figure 7.5.4.12-1.\n\n  Table 7.5.4.12-1: Remove BAR IE within PFCP Session Modification Request\n\n|Octet 1 and|  |Remove BAR IE Type = 87 (decimal)                         |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n\n\n\n"}, {"key": "Update Traffic Endpoint IE within Sx Session Modification Request", "numbering": "7.5.4.13", "title_level": 3, "desc": "7.5.4.13 Update Traffic Endpoint IE within Sx Session Modification Request\n\nThe Update Traffic Endpoint grouped IE shall be encoded as shown in Figure\n7.5.4.13-1.\n\n Table 7.5.4.13-1: Update Traffic Endpoint IE within Sx Session Modification\n                                   Request\n\n|Octet 1 and|Update Traffic Endpoint Type = 129 (decimal)                 |\n|2          |                                                             |\n|Octets 3   |Length = n                                                   |\n|and 4      |                                                             |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Traffic    |M |This IE shall uniquely identify the |X |X |X |X |Traffic   |\n|Endpoint ID|  |Traffic Endpoint to be modified for |  |  |  |  |Endpoint  |\n|           |  |that Sx session.                    |  |  |  |  |ID        |\n|Local      |C |This IE shall be present if it needs|X |- |- |X |F-TEID    |\n|F-TEID     |  |to be changed.                      |  |  |  |  |          |\n|           |  |The CP function shall set the CHOOSE|  |  |  |  |          |\n|           |  |(CH) bit to 1 if the UP function    |  |  |  |  |          |\n|           |  |supports the allocation of F-TEID   |  |  |  |  |          |\n|           |  |and the CP function requests the UP |  |  |  |  |          |\n|           |  |function to assign a local F-TEID to|  |  |  |  |          |\n|           |  |the PDR.                            |  |  |  |  |          |\n|           |  |See NOTE.                           |  |  |  |  |          |\n|Network    |O |If present, this IE shall identify  |X |X |X |X |Network   |\n|Instance   |  |the Network instance to match for   |  |  |  |  |Instance  |\n|           |  |the incoming packet. See NOTE.      |  |  |  |  |          |\n|UE IP      |C |This IE shall be present if it needs|- |X |X |X |UE IP     |\n|address    |  |to be changed.                      |  |  |  |  |address   |\n|           |  |See NOTE.                           |  |  |  |  |          |\n|NOTE: The IEs which do not need to be modified shall not be included in  |\n|the Update Traffic Endpoint IE. The UP function shall continue to behave |\n|according to the values previously received for IEs not present in the   |\n|Update Traffic Endpoint IE. F-TEID may be changed if the SGW-C has       |\n|received the \"Change F-TEID support Indication\" over the S11/S4 interface|\n|(for an IDLE state UE initiated TAU/RAU procedure to allow the SGW       |\n|changing the GTP-U F-TEID).                                              |\n\n\n\n"}, {"key": "Remove Traffic Endpoint IE within Sx Session Modification Request", "numbering": "7.5.4.14", "title_level": 3, "desc": "7.5.4.14 Remove Traffic Endpoint IE within Sx Session Modification Request\n\nThe Remove Traffic Endpoint grouped IE shall be encoded as shown in Figure\n7.5.4.14-1.\n\n Table 7.5.4.14-1: Remove Traffic Endpoint IE within Sx Session Modification\n                                   Request\n\n|Octet 1 and|  |Remove Traffic Endpoint IE Type = 130 (decimal)           |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n\n\n\n"}, {"key": "PFCP Session Modification Response", "numbering": "7.5.5", "title_level": 2, "desc": "7.5.5  PFCP Session Modification Response\n\n\n"}, {"key": "General", "numbering": "7.5.5.1", "title_level": 3, "desc": ""}, {"key": "Usage Report IE within PFCP Session Modification Response", "numbering": "7.5.5.2", "title_level": 3, "desc": "7.5.5.1  General\n\nThe PFCP Session Modification Response shall be sent over the Sxa, Sxb, Sxc\nand N4 interface by the UP function to the CP function as a reply to the\nPFCP Session Modification Request.\n\n    Table 7.5.5.1-1: Information Elements in a PFCP Session Modification\n                                  Response\n\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Cause      |M |This IE shall indicate the          |X |X |X |X |Cause     |\n|           |  |acceptance or the rejection of the  |  |  |  |  |          |\n|           |  |corresponding request message.      |  |  |  |  |          |\n|Offending  |C |This IE shall be included if the rejection is due to a    |\n|IE         |  |conditional or mandatory IE missing or faulty.            |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|UR-SEQN    |M |This IE shall uniquely identify the |X |X |X |X |UR-SEQN   |\n|           |  |Usage Report for the URR (see       |  |  |  |  |          |\n|           |  |subclause 5.2.2.3).                 |  |  |  |  |          |\n|Usage      |M |This IE shall identify the trigger  |X |X |X |X |Usage     |\n|Report     |  |for this report.                    |  |  |  |  |Report    |\n|Trigger    |  |                                    |  |  |  |  |Trigger   |\n|Start Time |C |This IE shall be present, except if |X |X |X |X |Start Time|\n|           |  |the Usage Report Trigger indicates  |  |  |  |  |          |\n|           |  |'Start of Traffic', 'Stop of        |  |  |  |  |          |\n|           |  |Traffic' or 'MAC Addresses          |  |  |  |  |          |\n|           |  |Reporting'.                         |  |  |  |  |          |\n|           |  |When present, this IE shall provide |  |  |  |  |          |\n|           |  |the timestamp when the collection of|  |  |  |  |          |\n|           |  |the information in this report was  |  |  |  |  |          |\n|           |  |started.                            |  |  |  |  |          |\n|End Time   |C |This IE shall be present, except if |X |X |X |X |End Time  |\n|           |  |the Usage Report Trigger indicates  |  |  |  |  |          |\n|           |  |'Start of Traffic', 'Stop of        |  |  |  |  |          |\n|           |  |Traffic' or 'MAC Addresses          |  |  |  |  |          |\n|           |  |Reporting'.                         |  |  |  |  |          |\n|           |  |When present, this IE shall provide |  |  |  |  |          |\n|           |  |the timestamp when the collection of|  |  |  |  |          |\n|           |  |the information in this report was  |  |  |  |  |          |\n|           |  |generated.                          |  |  |  |  |          |\n|Volume     |C |This IE shall be present if a volume|X |X |X |X |Volume    |\n|Measurement|  |measurement needs to be reported.   |  |  |  |  |Measuremen|\n|           |  |                                    |  |  |  |  |t         |\n|Duration   |C |This IE shall be present if a       |X |X |X |X |Duration  |\n|Measurement|  |duration measurement needs to be    |  |  |  |  |Measuremen|\n|           |  |reported.                           |  |  |  |  |t         |\n|Time of    |C |This IE shall be present if         |X |X |X |X |Time of   |\n|First      |  |available for this URR.             |  |  |  |  |First     |\n|Packet     |  |                                    |  |  |  |  |Packet    |\n|Time of    |C |This IE shall be present if         |X |X |X |X |Time of   |\n|Last Packet|  |available for this URR.             |  |  |  |  |Last      |\n|           |  |                                    |  |  |  |  |Packet    |\n|Usage      |C |This IE shall be present if the UP  |X |X |X |X |Usage     |\n|Information|  |function reports Usage Reports      |  |  |  |  |Informatio|\n|           |  |before and after a Monitoring Time  |  |  |  |  |n         |\n|           |  |or before and after QoS enforcement.|  |  |  |  |          |\n|           |  |When present, it shall indicate     |  |  |  |  |          |\n|           |  |whether the usage is reported for   |  |  |  |  |          |\n|           |  |the period before or after that     |  |  |  |  |          |\n|           |  |time, or before or after QoS        |  |  |  |  |          |\n|           |  |enforcement.                        |  |  |  |  |          |\n|Query URR  |C |This IE shall be present if this    |X |X |X |X |Query URR |\n|Reference  |  |usage report is sent as a result of |  |  |  |  |Reference |\n|           |  |a query URR received in an PFCP     |  |  |  |  |          |\n|           |  |Session Modification Request and the|  |  |  |  |          |\n|           |  |Query URR Reference IE was present  |  |  |  |  |          |\n|           |  |in the PFCP Session Modification    |  |  |  |  |          |\n|           |  |Request.                            |  |  |  |  |          |\n|           |  |When present, it shall be set to the|  |  |  |  |          |\n|           |  |Query URR Reference value received  |  |  |  |  |          |\n|           |  |in the PFCP Session Modification    |  |  |  |  |          |\n|           |  |Request.                            |  |  |  |  |          |\n|Ethernet   |C | This IE shall be present if        |- |- |- |X |Ethernet  |\n|Traffic    |  |Ethernet Traffic Information needs  |  |  |  |  |Traffic   |\n|Information|  |to be reported.                     |  |  |  |  |Informatio|\n|           |  |                                    |  |  |  |  |n         |\n\n\n\n"}, {"key": "PFCP Session Deletion Request", "numbering": "7.5.6", "title_level": 2, "desc": ""}, {"key": "PFCP Session Deletion Response", "numbering": "7.5.7", "title_level": 2, "desc": ""}, {"key": "General", "numbering": "7.5.7.1", "title_level": 3, "desc": ""}, {"key": "Usage Report IE within PFCP Session Deletion Response", "numbering": "7.5.7.2", "title_level": 3, "desc": "7.5.6  PFCP Session Deletion Request\n\nThe PFCP Session Deletion Request shall be sent over the Sxa, Sxb, Sxc and\nN4 interface by the CP function to request the UP function to delete the\nPFCP session.\n\n   Table 7.5.6-1: Information Elements in a PFCP Session Deletion Request\n\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|           |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Cause      |M |This IE shall indicate the acceptance or the rejection of |\n|           |  |the corresponding request message.                        |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|UR-SEQN    |M |This IE shall uniquely identify the |X |X |X |X |UR-SEQN   |\n|           |  |Usage Report for the URR (see       |  |  |  |  |          |\n|           |  |subclause 5.2.2.3).                 |  |  |  |  |          |\n|Usage      |M |This IE shall identify the trigger  |X |X |X |X |Usage     |\n|Report     |  |for this report.                    |  |  |  |  |Report    |\n|Trigger    |  |                                    |  |  |  |  |Trigger   |\n|Start Time |C |This IE shall be present, except if |X |X |X |X |Start Time|\n|           |  |the Usage Report Trigger indicates  |  |  |  |  |          |\n|           |  |'Start of Traffic', 'Stop of        |  |  |  |  |          |\n|           |  |Traffic' or 'MAC Addresses          |  |  |  |  |          |\n|           |  |Reporting'.                         |  |  |  |  |          |\n|           |  |When present, this IE shall provide |  |  |  |  |          |\n|           |  |the timestamp when the collection of|  |  |  |  |          |\n|           |  |the information in this report was  |  |  |  |  |          |\n|           |  |started.                            |  |  |  |  |          |\n|End Time   |C |This IE shall be present, except if |X |X |X |X |End Time  |\n|           |  |the Usage Report Trigger indicates  |  |  |  |  |          |\n|           |  |'Start of Traffic', 'Stop of        |  |  |  |  |          |\n|           |  |Traffic' or 'MAC Addresses          |  |  |  |  |          |\n|           |  |Reporting'.                         |  |  |  |  |          |\n|           |  |When present, this IE shall provide |  |  |  |  |          |\n|           |  |the timestamp when the collection of|  |  |  |  |          |\n|           |  |the information in this report was  |  |  |  |  |          |\n|           |  |generated.                          |  |  |  |  |          |\n|Volume     |C |This IE shall be present if a volume|X |X |X |X |Volume    |\n|Measurement|  |needs to be reported.               |  |  |  |  |Measuremen|\n|           |  |                                    |  |  |  |  |t         |\n|Duration   |C |This IE shall be present if a       |X |X |X |X |Duration  |\n|Measurement|  |duration measurement needs to be    |  |  |  |  |Measuremen|\n|           |  |reported.                           |  |  |  |  |t         |\n|Time of    |C |This IE shall be present if         |X |X |X |X |Time of   |\n|First      |  |available for this URR.             |  |  |  |  |First     |\n|Packet     |  |                                    |  |  |  |  |Packet    |\n|Time of    |C |This IE shall be present if         |X |X |X |X |Time of   |\n|Last Packet|  |available for this URR.             |  |  |  |  |Last      |\n|           |  |                                    |  |  |  |  |Packet    |\n|Usage      |C |This IE shall be present if the UP  |X |X |X |X |Usage     |\n|Information|  |function reports Usage Reports      |  |  |  |  |Informatio|\n|           |  |before and after a Monitoring Time, |  |  |  |  |n         |\n|           |  |or before and after QoS enforcement.|  |  |  |  |          |\n|           |  |When present, it shall indicate     |  |  |  |  |          |\n|           |  |whether the usage is reported for   |  |  |  |  |          |\n|           |  |the period before or after that     |  |  |  |  |          |\n|           |  |time, or before or after QoS        |  |  |  |  |          |\n|           |  |enforcement.                        |  |  |  |  |          |\n|Ethernet   |C | This IE shall be present if        |- |- |- |X |Ethernet  |\n|Traffic    |  |Ethernet Traffic Information needs  |  |  |  |  |Traffic   |\n|Information|  |to be reported. See Table 7.5.8.3-3.|  |  |  |  |Informatio|\n|           |  |                                    |  |  |  |  |n         |\n\n\n\n"}, {"key": "PFCP Session Report Request", "numbering": "7.5.8", "title_level": 2, "desc": "7.5.8  PFCP Session Report Request\n\n\n"}, {"key": "General", "numbering": "7.5.8.1", "title_level": 3, "desc": ""}, {"key": "Downlink Data Report IE within PFCP Session Report Request", "numbering": "7.5.8.2", "title_level": 3, "desc": "7.5.8.1  General\n\nThe PFCP Session Report Request shall be sent over the Sxa, Sxb, Sxc and N4\ninterface by the UP function to report information related to an PFCP\nsession to the CP function.\n\n    Table 7.5.8-1: Information Elements in a PFCP Session Report Request\n\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Report Type|M |This IE shall indicate the type of the report.            |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Downlink   |C |This IE shall be included for an    |X |- |- |X |Downlink  |\n|Data       |  |PFCP session with an IP PDN type, if|  |  |  |  |Data      |\n|Service    |  |the UP function supports the Paging |  |  |  |  |Service   |\n|Information|  |Policy Differentiation feature (see |  |  |  |  |Informatio|\n|           |  |subclause 4.9 of                    |  |  |  |  |n         |\n|           |  |3GPP\u00a0TS\u00a023.401\u00a0[14]).               |  |  |  |  |          |\n|           |  |When present, for each PDR and for  |  |  |  |  |          |\n|           |  |each packet that triggers a Downlink|  |  |  |  |          |\n|           |  |Data Notification, the UP function  |  |  |  |  |          |\n|           |  |shall copy, into the Paging Policy  |  |  |  |  |          |\n|           |  |Indication value within this IE, the|  |  |  |  |          |\n|           |  |value of the DSCP in TOS (IPv4) or  |  |  |  |  |          |\n|           |  |TC (IPv6) information received in   |  |  |  |  |          |\n|           |  |the IP payload of the GTP-U packet  |  |  |  |  |          |\n|           |  |from the PGW (see                   |  |  |  |  |          |\n|           |  |IETF\u00a0RFC\u00a02474\u00a0[13]).                |  |  |  |  |          |\n|           |  |                                    |  |  |  |  |          |\n|           |  |One IE with this type shall be      |  |  |  |  |          |\n|           |  |included per PDR ID reported in the |  |  |  |  |          |\n|           |  |message. When multiple PDR ID IEs   |  |  |  |  |          |\n|           |  |are present in the message, the     |  |  |  |  |          |\n|           |  |Downlink Data Service Information   |  |  |  |  |          |\n|           |  |IEs shall be reported according to  |  |  |  |  |          |\n|           |  |the order of the PDR ID IEs.        |  |  |  |  |          |\n\n\n\n"}, {"key": "Usage Report IE within PFCP Session Report Request", "numbering": "7.5.8.3", "title_level": 3, "desc": ""}, {"key": "Error Indication Report IE within PFCP Session Report Request", "numbering": "7.5.8.4", "title_level": 3, "desc": "7.5.8.3  Usage Report IE within PFCP Session Report Request\n\nThe Usage Report grouped IE shall be encoded as shown in Figure 7.5.8.3-1.\n\n     Table 7.5.8.3-1: Usage Report IE within PFCP Session Report Request\n\n|Octet 1 and|  |Usage Report IE Type = 80 (decimal)                       |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|UR-SEQN    |M |This IE shall uniquely identify the |X |X |X |X |UR-SEQN   |\n|           |  |Usage Report for the URR (see       |  |  |  |  |          |\n|           |  |subclause 5.2.2.3).                 |  |  |  |  |          |\n|Usage      |M |This IE shall identify the trigger  |X |X |X |X |Usage     |\n|Report     |  |for this report.                    |  |  |  |  |Report    |\n|Trigger    |  |                                    |  |  |  |  |Trigger   |\n|Start Time |C |This IE shall be present, except if |X |X |X |X |Start Time|\n|           |  |the Usage Report Trigger indicates  |  |  |  |  |          |\n|           |  |'Start of Traffic', 'Stop of        |  |  |  |  |          |\n|           |  |Traffic' or 'MAC Addresses          |  |  |  |  |          |\n|           |  |Reporting'.                         |  |  |  |  |          |\n|           |  |When present, this IE shall provide |  |  |  |  |          |\n|           |  |the timestamp when the collection of|  |  |  |  |          |\n|           |  |the information in this report was  |  |  |  |  |          |\n|           |  |started.                            |  |  |  |  |          |\n|End Time   |C |This IE shall be present, except if |X |X |X |X |End Time  |\n|           |  |the Usage Report Trigger indicates  |  |  |  |  |          |\n|           |  |'Start of Traffic', 'Stop of        |  |  |  |  |          |\n|           |  |Traffic' or ' MAC Addresses         |  |  |  |  |          |\n|           |  |Reporting'.                         |  |  |  |  |          |\n|           |  |When present, this IE shall provide |  |  |  |  |          |\n|           |  |the timestamp when the collection of|  |  |  |  |          |\n|           |  |the information in this report was  |  |  |  |  |          |\n|           |  |generated.                          |  |  |  |  |          |\n|Volume     |C |This IE shall be present if a volume|X |X |X |X |Volume    |\n|Measurement|  |measurement needs to be reported.   |  |  |  |  |Measuremen|\n|           |  |                                    |  |  |  |  |t         |\n|Duration   |C |This IE shall be present if a       |X |X |X |X |Duration  |\n|Measurement|  |duration measurement needs to be    |  |  |  |  |Measuremen|\n|           |  |reported.                           |  |  |  |  |t         |\n|Application|C |This IE shall be present if         |- |X |X |X |Applicatio|\n|Detection  |  |application detection information   |  |  |  |  |n         |\n|Information|  |needs to be reported.               |  |  |  |  |Detection |\n|           |  |                                    |  |  |  |  |Informatio|\n|           |  |                                    |  |  |  |  |n         |\n|UE IP      |C |This IE shall be present if the     |- |- |X |X |UE IP     |\n|address    |  |start or stop of an application has |  |  |  |  |address   |\n|           |  |been detected and no UE IP address  |  |  |  |  |          |\n|           |  |was provisioned in the PDI. See NOTE|  |  |  |  |          |\n|           |  |1.                                  |  |  |  |  |          |\n|Network    |C |This IE shall be present if the     |- |- |X |X |Network   |\n|Instance   |  |start or stop of an application has |  |  |  |  |Instance  |\n|           |  |been detected, no UE IP address was |  |  |  |  |          |\n|           |  |provisioned in the PDI and multiple |  |  |  |  |          |\n|           |  |PDNs with overlapping IP addresses  |  |  |  |  |          |\n|           |  |are used in the UP function. See    |  |  |  |  |          |\n|           |  |NOTE 1.                             |  |  |  |  |          |\n|Time of    |C |This IE shall be present if         |X |X |X |X |Time of   |\n|First      |  |available for this URR.             |  |  |  |  |First     |\n|Packet     |  |                                    |  |  |  |  |Packet    |\n|Time of    |C |This IE shall be present if         |X |X |X |X |Time of   |\n|Last Packet|  |available for this URR.             |  |  |  |  |Last      |\n|           |  |                                    |  |  |  |  |Packet    |\n|Usage      |C |This IE shall be present if the UP  |X |X |X |X |Usage     |\n|Information|  |function reports Usage Reports      |  |  |  |  |Informatio|\n|           |  |before and after a Monitoring Time, |  |  |  |  |n         |\n|           |  |or before and after QoS enforcement.|  |  |  |  |          |\n|           |  |When present, it shall indicate     |  |  |  |  |          |\n|           |  |whether the usage is reported for   |  |  |  |  |          |\n|           |  |the period before or after that     |  |  |  |  |          |\n|           |  |time, or before or after QoS        |  |  |  |  |          |\n|           |  |enforcement.                        |  |  |  |  |          |\n|Query URR  |C |This IE shall be present if this    |X |X |X |X |Query URR |\n|Reference  |  |usage report is sent as a result of |  |  |  |  |Reference |\n|           |  |a query URR received in an PFCP     |  |  |  |  |          |\n|           |  |Session Modification Request and the|  |  |  |  |          |\n|           |  |Query URR Reference IE was present  |  |  |  |  |          |\n|           |  |in the PFCP Session Modification    |  |  |  |  |          |\n|           |  |Request.                            |  |  |  |  |          |\n|           |  |When present, it shall be set to the|  |  |  |  |          |\n|           |  |Query URR Reference value received  |  |  |  |  |          |\n|           |  |in the PFCP Session Modification    |  |  |  |  |          |\n|           |  |Request.                            |  |  |  |  |          |\n|Ethernet   |C | This IE shall be present if        |- |- |- |X |Ethernet  |\n|Traffic    |  |Ethernet Traffic Information needs  |  |  |  |  |Traffic   |\n|Information|  |to be reported. See Table 7.5.8.3-3.|  |  |  |  |Informatio|\n|           |  |                                    |  |  |  |  |n         |\n|NOTE 1: This is the case for unsolicited application reporting by the    |\n|TDF. The Network instance is required when the UE IP address cannot be   |\n|used to determine the corresponding PDN connection.                      |\n\n\n  Table 7.5.8.3-2: Application Detection Information IE within Usage Report\n                                     IE\n\n|Octet 1 and|  |Application Detection Information IE Type = 68 (decimal)  |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Flow       |C |When present, this IE shall contain |- |X |X |X |Flow      |\n|Information|  |the flow information for the        |  |  |  |  |Informatio|\n|           |  |detected application. It shall be   |  |  |  |  |n         |\n|           |  |present, when reporting the start of|  |  |  |  |          |\n|           |  |an application, if the Reduced      |  |  |  |  |          |\n|           |  |Application Detection Information   |  |  |  |  |          |\n|           |  |flag was not set in the Measurement |  |  |  |  |          |\n|           |  |Information and if the flow         |  |  |  |  |          |\n|           |  |information for the detected        |  |  |  |  |          |\n|           |  |application is deducible.           |  |  |  |  |          |\n\n\n   Table 7.5.8.3-3: Ethernet Traffic Information IE within Usage Report IE\n\n|Octet 1 and|  |Ethernet Traffic Information IE Type = xx (decimal)       |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n\n\n\n"}, {"key": "PFCP Session Report Response", "numbering": "7.5.9", "title_level": 2, "desc": "7.5.9  PFCP Session Report Response\n\n\n"}, {"key": "General", "numbering": "7.5.9.1", "title_level": 3, "desc": "7.5.9.1  General\n\nThe PFCP Session Report Response shall be sent over the Sxa, Sxb, Sxc and\nN4 interface by the CP function to the UP function as a reply to the PFCP\nSession Report Request.\n\n   Table 7.5.9.1-1: Information Elements in a PFCP Session Report Response\n\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Cause                                                                    |\n\n\n\n"}, {"key": "Update BAR IE within PFCP Session Report Response", "numbering": "7.5.9.2", "title_level": 3, "desc": "7.5.9.2  Update BAR IE within PFCP Session Report Response\n\nThe Update BAR grouped IE shall be encoded as shown in Figure 7.5.9.2-1.\n\n       Table 7.5.9.2-1: Update BAR IE in PFCP Session Report Response\n\n|Octet 1 and|  |Update BAR IE Type = 12 (decimal)                         |\n|2          |  |                                                          |\n|Octets 3   |  |Length = n                                                |\n|and 4      |  |                                                          |\n|Information|P |Condition / Comment                 |Appl.      |IE Type   |\n|elements   |  |                                    |           |          |\n|           |  |                                    |Sx|Sx|Sx|N4|          |\n|           |  |                                    |a |b |c |  |          |\n|Downlink Data Notification Delay                                         |\n\n\n\n"}, {"key": "Error Handling", "numbering": "7.6", "title_level": 1, "desc": "7.6  Error Handling\n\n\n"}, {"key": "Protocol Errors", "numbering": "7.6.1", "title_level": 2, "desc": "7.6.1  Protocol Errors\n\nA protocol error is defined as a message or an Information Element received\nfrom a peer entity with an unknown type, or if it is unexpected, or if it\nhas an erroneous content.\n\nThe term silently discarded is used in the following subclauses to mean\nthat the receiving PFCP entity's implementation shall discard such a\nmessage without further processing or that the receiving PFCP entity\ndiscards such an IE and continues processing the message. The conditions\nfor the receiving PFCP entity to silently discard an IE are specified in\nthe subsequent subclauses.\n\nThe handling of unknown, unexpected or erroneous PFCP messages and IEs\nshall provide for the forward compatibility of PFCP. Therefore, the sending\nPFCP entity shall be able to safely include in a message a new conditional-\noptional or an optional IE. Such an IE may also have a new type value. Any\nlegacy receiving PFCP entity shall, however, silently discard such an IE\nand continue processing the message.\n\nIf a protocol error is detected by the receiving PFCP entity, it should log\nthe event including the erroneous message and may include the error in a\nstatistical counter.\n\nFor Response messages containing a rejection Cause value, see subclause\n7.2.3.2.\n\nThe receiving PFCP entity shall apply the error handling specified in the\nsubsequent subclauses.\n\nIf the received erroneous message is a reply to an outstanding PFCP\nmessage, the PFCP transaction layer shall stop retransmissions and notify\nthe PFCP application layer of the error even if the reply is silently\ndiscarded.\n\n\n"}, {"key": "Different PFCP Versions", "numbering": "7.6.2", "title_level": 2, "desc": "7.6.2  Different PFCP Versions\n\nIf a PFCP entity receives a message of an unsupported PFCP version, it\nshall return an PFCP Version Not Supported Response message and silently\ndiscard the received message.\n\n\n"}, {"key": "PFCP Message of Invalid Length", "numbering": "7.6.3", "title_level": 2, "desc": "7.6.3  PFCP Message of Invalid Length\n\nIf a PFCP entity receives a message, which is too short to contain the\nrespective PFCP header, the PFCP-PDU shall be silently discarded.\n\nIf a PFCP entity receives a Request message within an IP/UDP packet of a\nlength that is inconsistent with the value specified in the Length field of\nthe PFCP header, then the receiving PFCP entity should log the error and\nshall send the Response message with Cause IE value set to \"Invalid\nLength\".\n\nIf a PFCP entity receives a Response message within an IP/UDP packet of a\nlength that is inconsistent with the value specified in the Length field of\nthe PFCP header, then the receiving PFCP entity should log the error and\nshall silently discard the message.\n\n\n"}, {"key": "Unknown PFCP Message", "numbering": "7.6.4", "title_level": 2, "desc": "7.6.4  Unknown PFCP Message\n\nIf a PFCP entity receives a message with an unknown Message Type value, it\nshall silently discard the message.\n\n\n"}, {"key": "Unexpected PFCP Message", "numbering": "7.6.5", "title_level": 2, "desc": "7.6.5  Unexpected PFCP Message\n\nIf a PFCP entity receives an unexpected request message, for example a\nknown message that is sent over an interface for which the message is not\ndefined, or a message that is sent over an interface for which the message\nis defined, but the direction is incorrect, then the PFCP entity shall\nsilently discard the message and shall log an error.\n\nIf a PFCP entity receives an unexpected response message which is not a\nrequest message, for example a message for which there is no corresponding\noutstanding request, it shall discard the message and may log an error.\n\n\n"}, {"key": "Missing Information Elements", "numbering": "7.6.6", "title_level": 2, "desc": "7.6.6  Missing Information Elements\n\nA PFCP entity shall check if all mandatory IEs are present in the received\nRequest message. Apart from Echo Request message, if one or more mandatory\ninformation elements are missing in the received Request message, the PFCP\nentity should log the error and shall send a Response message with Cause IE\nvalue set to \"Mandatory IE missing\" with the type of the missing mandatory\nIE.\n\nIf a PFCP entity receives a Response message with Cause IE value set to\n\"Mandatory IE missing\", it shall notify its upper layer.\n\nA PFCP entity shall check if all mandatory IEs are present in the received\nResponse message without a rejection Cause value. If one or more mandatory\ninformation elements are missing, the PFCP entity shall notify the upper\nlayer and should log the error.\n\nA PFCP entity shall check if conditional information elements are present\nin the received Request message, if possible (i.e. if the receiving entity\nhas sufficient information available to check if the respective conditions\nwere met). If one or more conditional information elements are missing, a\nPFCP entity should log the error and shall send a Response message with\nCause IE value set to \"Conditional IE missing\" together with the type of\nthe missing conditional IE.\n\nA PFCP entity shall check if conditional information elements are present\nin the received Response message without a rejection Cause value, if\npossible (i.e. if the receiving entity has sufficient information available\nto check if the respective conditions were met). If one or more conditional\ninformation elements are missing, a PFCP entity shall notify the upper\nlayer and should log the error.\n\nFor Response messages containing a rejection Cause value, see subclause\n7.2.3.2.\n\nAbsence of an optional information element shall not trigger any error\nhandling.\n\n\n"}, {"key": "Invalid Length Information Element", "numbering": "7.6.7", "title_level": 2, "desc": "7.6.7  Invalid Length Information Element\n\nAn information element has an invalid length when the actual length of the\nIE is different from the value of the Length field in the IE header. Here,\nthe actual length of the IE means the length of the content field of the\nreceived IE.\n\nIf a PFCP message contains more than one information elements and one or\nmore of them have invalid length, the receiving PFCP entity can detect\nwhich of the IEs have invalid length only in the following cases:\n\n  -  If the Length value in the IE header is greater than the overall\n    length of the message;\n\n  -  If the invalid length IE is the last one in the message.\n\nApart from Echo Request message, if a receiving PFCP entity detects\ninformation element with invalid length in a Request message, it shall send\nan appropriate error response with Cause IE value set to \"Invalid length\"\ntogether with the type of the offending IE.\n\n\n"}, {"key": "Semantically incorrect Information Element", "numbering": "7.6.8", "title_level": 2, "desc": "7.6.8  Semantically incorrect Information Element\n\nApart from Echo Request message, the receiver of a PFCP signalling message\nRequest including a mandatory or a verifiable conditional information\nelement with a semantically invalid Value shall discard the request, should\nlog the error, and shall send a response with Cause IE value set to\n\"Mandatory IE incorrect\" together with a type and instance of the offending\nIE.\n\nThe receiver of a PFCP signalling message Response including a mandatory or\na verifiable conditional information element with a semantically invalid\nValue shall notify the upper layer that a message with this sequence number\nhas been received and should log the error.\n\nIf a PFCP entity receives an information element with a value which is\nshown as reserved, it shall treat that information element as invalid and\nshould log the error. If the invalid IE is received in a Request, and it is\na mandatory IE or a verifiable conditional IE, the PFCP entity shall send a\nresponse with Cause set to \"Mandatory IE incorrect\" together with a type\nand instance of the offending IE.\n\nThe principle is: the use of reserved values invokes error handling; the\nuse of spare values can be silently discarded and for IEs with spare values\nused, processing shall be continued ignoring the spare values.\n\nThe receiver of a PFCP signalling message including an optional information\nelement with a Value that is not in the range defined for this information\nelement value shall discard this IE, but shall treat the rest of the\nmessage as if this IE was absent and continue processing. The receiver\nshall not check the content of an information element field that is defined\nas \"spare\".\n\nAll semantically incorrect optional information elements in a PFCP\nsignalling message shall be treated as not present in the message.\n\n\n"}, {"key": "Unknown or unexpected Information Element", "numbering": "7.6.9", "title_level": 2, "desc": "7.6.9  Unknown or unexpected Information Element\n\nThe receiver of a PFCP message including an unexpected information element\nwith a known Type value that is not defined for this message shall discard\nthe IE and log an error. The receiver shall process the message.\n\n  NOTE:  An Information Element in an encoded PFCP message or grouped IE is\n         identified by the IE Type.\n\n\n"}, {"key": "Repeated Information Elements", "numbering": "7.6.10", "title_level": 2, "desc": "7.6.10 Repeated Information Elements\n\nAn Information Element is repeated if there is more than one IE with the\nsame IE Type in the scope of the PFCP message (or in the scope of the\ngrouped IE). Such an IE is a member in a list.\n\nIf an information element is repeated in a PFCP signalling message in which\nrepetition of the information element is not specified, only the contents\nof the information element appearing first shall be handled and all\nsubsequent repetitions of the information element shall be ignored. When\nthe number of repetitions of information elements is specified, only the\ncontents of specified repeated information elements shall be handled and\nall subsequent repetitions of the information element shall be ignored.\n\n\n"}, {"key": "Information Elements", "numbering": "8", "title_level": 0, "desc": "8  Information Elements\n\n  Editor's Note:  The subclauses under clause 8 need to be updated to cover\n         5GC N4 reference point requirements.\n\n\n"}, {"key": "Information Elements Format", "numbering": "8.1", "title_level": 1, "desc": "8.1  Information Elements Format\n\n\n"}, {"key": "Information Element Format", "numbering": "8.1.1", "title_level": 2, "desc": "8.1.1  Information Element Format\n\nFigure 8.1.1-1 depicts the format of an Information Element.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |p to    |Enterprise ID                       |    |\n| |(p+1)   |                                    |    |\n| |k to    |IE specific data or content of a    |    |\n| |(n+4)   |grouped IE                          |    |\n\n\n                 Figure 8.1.1-1: Information Element Format\n\n  NOTE 1:  If the Bit 8 of Octet 1 is not set, this indicates that the IE\n         is defined by 3GPP and the Enterprise ID is absent. If Bit 8 of\n         Octet 1 is set, this indicates that the IE is defined by a vendor\n         and the Enterprise ID is present identified by the Enterprise ID.\n\nAn IE has the following mandatory fields:\n\n  -  Type: this field indicates the type of the Information Element. IE\n    type values within the range of 0 to 32767 are reserved for IE defined\n    by 3GPP and are listed in subclause 8.1.2 IE type values within the\n    range of 32768 to 65535 are used for vendor-specific IE and the value\n    allocation is controlled by the vendor.\n\n  -  Length: this field contains the length of the IE excluding the first\n    four octets, which are common for all IEs (Type and Length) and is\n    denoted \"n\" in Figure 8.1.1-1 and in Figure 8.1.1-2. Bit 8 of the\n    lowest numbered octet is the most significant bit and bit 1 of the\n    highest numbered octet is the least significant bit.\n\nAn IE has the following optional fields:\n\n  -  Enterprise ID: if the IE type value is within the range of 32768 to\n    65535, this field shall contain the IANA-assigned \"SMI Network\n    Management Private Enterprise Codes\" value of the vendor defining the\n    IE. The Enterprise ID set to \"10415\" (IANA-assigned \"SMI Network\n    Management Private Enterprise Codes\") shall not be used for the vendor\n    specific IEs.\n\nFor illustration, Figure 8.1.1-2 depicts the format of a Information\nElement (IE) defined by 3GPP and is specified in this specification. For\nIE's defined by 3GPP, the IE type shall be within the range of 0 to 32767.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to    |IE specific data or content of a    |    |\n| |(n+4)   |grouped IE                          |    |\n\n\n           Figure 8.1.1-2: 3GPP defined Information Element Format\n\n  NOTE 2:  Bit 8 of Octet 1 is not set. This indicates that the Information\n         Element type value has been allocated by 3GPP.\n\nFor illustration, Figure 8.1.1-3 depicts the format of a vendor-specific\nInformation Element, which content is not specified and the IE type value\nshall be within the range of 32768 to 65535.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 6  |Enterprise ID                       |    |\n| |7 to    |IE specific data or content of a    |    |\n| |(n+4)   |grouped IE                          |    |\n\n\n         Figure 8.1.1-3: Vendor-Specific Information Element Format\n\n  NOTE 3:  Bit 8 of Octet 1 is set. This indicates that the IE type value\n         has been allocated by the vendor identified by the Enterprise ID.\n         The content of this IE is vendor specific and therefore out of\n         scope of this specification.\n\n\n"}, {"key": "Information Element Types", "numbering": "8.1.2", "title_level": 2, "desc": "8.1.2  Information Element Types\n\nA PFCP message may contain several IEs. In order to have forward compatible\ntype definitions for the PFCP IEs, all of them shall be TLV (Type, Length,\nValue) coded. PFCP IE type values are specified in the Table 8.1.2-1. The\nlast column of this table indicates whether the IE is:\n\n  -  Fixed Length: the IE has a fixed set of fields, and a fixed number of\n    octets;\n\n  -  Variable Length: the IE has a fixed set of fields, and has a variable\n    number of octets.\n    For example, the last octets may be numbered similar to \"5 to (n+4)\".\n    In this example, if the value of the length field, n, is 0, then the\n    last field is not present;\n\n  -  Extendable: the IE has a variable number of fields, and has a variable\n    number of octets.\n    The last fields are typically specified with the statement: \"These\n    octet(s) is/are present only if explicitly specified\". The legacy\n    receiving entity shall ignore the unknown octets.\n\nAn IE of any of the above types may have a null length as specified in\nsubclause 5.6.3. This shall not be considered as an error by the receiving\nPFCP entity.\n\nIn order to improve the efficiency of troubleshooting, it is recommended\nthat the IEs should be arranged in the signalling messages as well as in\nthe grouped IEs, according to the order the IEs are listed in the message\ndefinition table or grouped IE definition table in section 7. However the\nreceiving entity shall be prepared to handle the messages with IEs in any\norder.\n\nWithin IEs, certain fields may be described as spare. These bits shall be\ntransmitted with the value set to 0. To allow for future features, the\nreceiver shall not evaluate these bits.\n\n                  Table 8.1.2-1: Information Element Types\n\n|IE Type|Information elements          |Comment /         |Number of Fixed   |\n|value  |                              |Reference         |Octets            |\n|(Decima|                              |                  |                  |\n|l)     |                              |                  |                  |\n|0      |Reserved                      |                  |                  |\n|1      |Create PDR                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.2.2-1         |                  |\n|2      |PDI                           |Extendable / Table|Not Applicable    |\n|       |                              |7.5.2.2-2         |                  |\n|3      |Create FAR                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.2.3-1         |                  |\n|4      |Forwarding Parameters         |Extendable / Table|Not Applicable    |\n|       |                              |7.5.2.3-2         |                  |\n|5      |Duplicating Parameters        |Extendable / Table|Not Applicable    |\n|       |                              |7.5.2.3-3         |                  |\n|6      |Create URR                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.2.4-1         |                  |\n|7      |Create QER                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.2.5-1         |                  |\n|8      |Created PDR                   |Extendable / Table|Not Applicable    |\n|       |                              |7.5.3.2-1         |                  |\n|9      |Update PDR                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.2-1         |                  |\n|10     |Update FAR                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.3-1         |                  |\n|11     |Update Forwarding Parameters  |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.3-2         |                  |\n|12     |Update BAR (PFCP Session      |Extendable / Table|Not Applicable    |\n|       |Report Response)              |7.5.9.2-1         |                  |\n|13     |Update URR                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.4           |                  |\n|14     |Update QER                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.5           |                  |\n|15     |Remove PDR                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.6           |                  |\n|16     |Remove FAR                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.7           |                  |\n|17     |Remove URR                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.8           |                  |\n|18     |Remove QER                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.9           |                  |\n|19     |Cause                         |Fixed / Subclause |1                 |\n|       |                              |8.2.1             |                  |\n|20     |Source Interface              |Extendable /      |1                 |\n|       |                              |Subclause 8.2.2   |                  |\n|21     |F-TEID                        |Extendable /      |q-4               |\n|       |                              |Subclause 8.2.3   |                  |\n|22     |Network Instance              |Variable Length / |Not Applicable    |\n|       |                              |Subclause 8.2.4   |                  |\n|23     |SDF Filter                    |Extendable /      |v+2-4             |\n|       |                              |Subclause 8.2.5   |                  |\n|24     |Application ID                |Variable Length / |Not Applicable    |\n|       |                              |Subclause 8.2.6   |                  |\n|25     |Gate Status                   |Extendable /      |1                 |\n|       |                              |Subclause 8.2.7   |                  |\n|26     |MBR                           |Extendable /      |10                |\n|       |                              |Subclause 8.2.8   |                  |\n|27     |GBR                           |Extendable /      |10                |\n|       |                              |Subclause 8.2.9   |                  |\n|28     |QER Correlation ID            |Extendable /      |4                 |\n|       |                              |Subclause 8.2.10  |                  |\n|29     |Precedence                    |Extendable /      |4                 |\n|       |                              |Subclause 8.2.11  |                  |\n|30     |Transport Level Marking       |Extendable /      |2                 |\n|       |                              |Subclause 8.2.12  |                  |\n|31     |Volume Threshold              |Extendable        |q+7-4             |\n|       |                              |/Subclause 8.2.13 |                  |\n|32     |Time Threshold                |Extendable        |4                 |\n|       |                              |/Subclause 8.2.14 |                  |\n|33     |Monitoring Time               |Extendable        |4                 |\n|       |                              |/Subclause 8.2.15 |                  |\n|34     |Subsequent Volume Threshold   |Extendable        |q+7-4             |\n|       |                              |/Subclause 8.2.16 |                  |\n|35     |Subsequent Time Threshold     |Extendable        |4                 |\n|       |                              |/Subclause 8.2.17 |                  |\n|36     |Inactivity Detection Time     |Extendable        |4                 |\n|       |                              |/Subclause 8.2.18 |                  |\n|37     |Reporting Triggers            |Extendable        |2                 |\n|       |                              |/Subclause 8.2.19 |                  |\n|38     |Redirect Information          |Extendable        |8+a-4             |\n|       |                              |/Subclause 8.2.20 |                  |\n|39     |Report Type                   |Extendable /      |1                 |\n|       |                              |Subclause 8.2.21  |                  |\n|40     |Offending IE                  |Fixed / Subclause |2                 |\n|       |                              |8.2.22            |                  |\n|41     |Forwarding Policy             |Extendable /      |k-4               |\n|       |                              |Subclause 8.2.23  |                  |\n|42     |Destination Interface         |Extendable /      |1                 |\n|       |                              |Subclause 8.2.24  |                  |\n|43     |UP Function Features          |Extendable /      |1                 |\n|       |                              |Subclause 8.2.25  |                  |\n|44     |Apply Action                  |Extendable /      |1                 |\n|       |                              |Subclause 8.2.26  |                  |\n|45     |Downlink Data Service         |Extendable /      |1                 |\n|       |Information                   |Subclause 8.2.27  |                  |\n|46     |Downlink Data Notification    |Extendable /      |1                 |\n|       |Delay                         |Subclause 8.2.28  |                  |\n|47     |DL Buffering Duration         |Extendable /      |1                 |\n|       |                              |Subclause 8.2.29  |                  |\n|48     |DL Buffering Suggested Packet |Variable /        |Not Applicable    |\n|       |Count                         |Subclause 8.2.30  |                  |\n|49     |PFCPSMReq-Flags               |Extendable /      |1                 |\n|       |                              |Subclause 8.2.31  |                  |\n|50     |PFCPSRRsp-Flags               |Extendable /      |1                 |\n|       |                              |Subclause 8.2.32  |                  |\n|51     |Load Control Information      |Extendable / Table|Not Applicable    |\n|       |                              |7.5.3.3-1         |                  |\n|52     |Sequence Number               |Fixed Length /    |4                 |\n|       |                              |Subclause 8.2.33  |                  |\n|53     |Metric                        |Fixed Length /    |1                 |\n|       |                              |Subclause 8.2.34  |                  |\n|54     |Overload Control Information  |Extendable / Table|Not Applicable    |\n|       |                              |7.5.3.4-1         |                  |\n|55     |Timer                         |Extendable /      |1                 |\n|       |                              |Subclause 8.2 35  |                  |\n|56     |Packet Detection Rule ID      |Extendable /      |2                 |\n|       |                              |Subclause 8.2 36  |                  |\n|57     |F-SEID                        |Extendable /      |p+15-4            |\n|       |                              |Subclause 8.2 37  |                  |\n|58     |Application ID's PFDs         |Extendable / Table|Not Applicable    |\n|       |                              |7.4.3.1-2         |                  |\n|59     |PFD context                   |Extendable / Table|Not Applicable    |\n|       |                              |7.4.3.1-3         |                  |\n|60     |Node ID                       |Extendable /      |o-4               |\n|       |                              |Subclause 8.2.38  |                  |\n|61     |PFD contents                  |Extendable /      |v-4               |\n|       |                              |Subclause 8.2.39  |                  |\n|62     |Measurement Method            |Extendable /      |1                 |\n|       |                              |Subclause 8.2.40  |                  |\n|63     |Usage Report Trigger          |Extendable /      |1                 |\n|       |                              |Subclause 8.2.41  |                  |\n|64     |Measurement Period            |Extendable /      |4                 |\n|       |                              |Subclause 8.2.42  |                  |\n|65     |FQ-CSID                       |Extendable /      |(q+1)-4           |\n|       |                              |Subclause 8.2.43  |                  |\n|66     |Volume Measurement            |Extendable /      |q+7-4             |\n|       |                              |Subclause 8.2.44  |                  |\n|67     |Duration Measurement          |Extendable /      |4                 |\n|       |                              |Subclause 8.2.45  |                  |\n|68     |Application Detection         |Extendable / Table|Not Applicable    |\n|       |Information                   |7.5.8.3-2         |                  |\n|69     |Time of First Packet          |Extendable /      |4                 |\n|       |                              |Subclause 8.2.46  |                  |\n|70     |Time of Last Packet           |Extendable /      |4                 |\n|       |                              |Subclause 8.2.47  |                  |\n|71     |Quota Holding Time            |Extendable /      |4                 |\n|       |                              |Subclause 8.2.48  |                  |\n|72     |Dropped DL Traffic Threshold  |Extendable /      |m+7-4             |\n|       |                              |Subclause 8.2.49  |                  |\n|73     |Volume Quota                  |Extendable /      |q+7-4             |\n|       |                              |Subclause 8.2.50  |                  |\n|74     |Time Quota                    |Extendable /      |4                 |\n|       |                              |Subclause 8.2.51  |                  |\n|75     |Start Time                    |Extendable /      |4                 |\n|       |                              |Subclause 8.2.52  |                  |\n|76     |End Time                      |Extendable /      |4                 |\n|       |                              |Subclause 8.2.53  |                  |\n|77     |Query URR                     |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.10-1        |                  |\n|78     |Usage Report (in Session      |Extendable / Table|Not Applicable    |\n|       |Modification Response)        |7.5.5.2-1         |                  |\n|79     |Usage Report (Session Deletion|Extendable / Table|Not Applicable    |\n|       |Response)                     |7.5.7.2-1         |                  |\n|80     |Usage Report (Session Report  |Extendable / Table|Not Applicable    |\n|       |Request)                      |7.5.8.3-1         |                  |\n|81     |URR ID                        |Extendable /      |4                 |\n|       |                              |Subclause 8.2.54  |                  |\n|82     |Linked URR ID                 |Extendable /      |4                 |\n|       |                              |Subclause 8.2.55  |                  |\n|83     |Downlink Data Report          |Extendable / Table|Not Applicable    |\n|       |                              |7.5.8.2-1         |                  |\n|84     |Outer Header Creation         |Extendable /      |r+1-4             |\n|       |                              |Subclause 8.2.56  |                  |\n|85     |Create BAR                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.2.6-1         |                  |\n|86     |Update BAR (Session           |Extendable / Table|Not Applicable    |\n|       |Modification Request)         |7.5.4.11-1        |                  |\n|87     |Remove BAR                    |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.12-1        |                  |\n|88     |BAR ID                        |Extendable /      |1                 |\n|       |                              |Subclause 8.2.57  |                  |\n|89     |CP Function Features          |Extendable /      |1                 |\n|       |                              |Subclause 8.2.58  |                  |\n|90     |Usage Information             |Extendable /      |1                 |\n|       |                              |Subclause 8.2.59  |                  |\n|91     |Application Instance ID       |Variable Length / |Not Applicable    |\n|       |                              |Subclause 8.2.60  |                  |\n|92     |Flow Information              |Extendable /      |m-4               |\n|       |                              |Subclause 8.2.61  |                  |\n|93     |UE IP Address                 |Extendable /      |p+15-1            |\n|       |                              |Subclause 8.2.62  |                  |\n|94     |Packet Rate                   |Extendable /      |p+2-4             |\n|       |                              |Subclause 8.2.63  |                  |\n|95     |Outer Header Removal          |Extendable /      |1                 |\n|       |                              |Subclause 8.2.64  |                  |\n|96     |Recovery Time Stamp           |Extendable /      |4                 |\n|       |                              |Subclause 8.2.65  |                  |\n|97     |DL Flow Level Marking         |Extendable /      |p+1-4             |\n|       |                              |Subclause 8.2.66  |                  |\n|98     |Header Enrichment             |Extendable /      |q-4               |\n|       |                              |Subclause 8.2.67  |                  |\n|99     |Error Indication Report       |Extendable / Table|Not Applicable    |\n|       |                              |7.5.8.4-1         |                  |\n|100    |Measurement Information       |Extendable /      |1                 |\n|       |                              |Subclause 8.2.68  |                  |\n|101    |Node Report Type              |Extendable /      |1                 |\n|       |                              |Subclause 8.2.69  |                  |\n|102    |User Plane Path Failure Report|Extendable / Table|Not Applicable    |\n|       |                              |7.4.5.1.2-1       |                  |\n|103    |Remote GTP-U Peer             |Extendable /      |p+15-4            |\n|       |                              |Subclause 8.2.70  |                  |\n|104    |UR-SEQN                       |Fixed Length /    |4                 |\n|       |                              |Subclause 8.2.71  |                  |\n|105    |Update Duplicating Parameters |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.3-3         |                  |\n|106    |Activate Predefined Rules     |Variable Length / |Not Applicable    |\n|       |                              |Subclause 8.2.72  |                  |\n|107    |Deactivate Predefined Rules   |Variable Length / |Not Applicable    |\n|       |                              |Subclause 8.2.73  |                  |\n|108    |FAR ID                        |Extendable /      |4                 |\n|       |                              |Subclause 8.2.74  |                  |\n|109    |QER ID                        |Extendable /      |4                 |\n|       |                              |Subclause 8.2.75  |                  |\n|110    |OCI Flags                     |Extendable /      |1                 |\n|       |                              |Subclause 8.2.76  |                  |\n|111    |PFCP Association Release      |Extendable /      |1                 |\n|       |Request                       |Subclause 8.2.77  |                  |\n|112    |Graceful Release Period       |Extendable /      |1                 |\n|       |                              |Subclause 8.2.78  |                  |\n|113    |PDN Type                      |Extendable /      |1                 |\n|       |                              |Subclause 8.2.79  |                  |\n|114    |Failed Rule ID                |Extendable /      |p-4               |\n|       |                              |Subclause 8.2.80  |                  |\n|115    |Time Quota Mechanism          |Extendable /      |5                 |\n|       |                              |Subclause 8.2.81  |                  |\n|116    |User Plane IP Resource        |Extendable /      |l+1-4             |\n|       |Information                   |Subclause 8.2.82  |                  |\n|117    |User Plane Inactivity Timer   |Extendable        |4                 |\n|       |                              |/Subclause 8.2.83 |                  |\n|118    |Aggregated URRs               |Extendable / Table|Not Applicable    |\n|       |                              |7.5.2.4-2         |                  |\n|119    |Multiplier                    |Fixed / Subclause |12                |\n|       |                              |8.2.84            |                  |\n|120    |Aggregated URR ID             |Fixed / Subclause |4                 |\n|       |                              |8.2.85            |                  |\n|121    |Subsequent Volume Quota       |Extendable /      |q+7-4             |\n|       |                              |Subclause 8.2.86  |                  |\n|122    |Subsequent Time Quota         |Extendable /      |4                 |\n|       |                              |Subclause 8.2.87  |                  |\n|123    |RQI                           |Extendable /      |1                 |\n|       |                              |Subclause 8.2.88  |                  |\n|124    |QFI                           |Extendable /      |m-4               |\n|       |                              |Subclause 8.2.89  |                  |\n|125    |Query URR Reference           |Extendable /      |4                 |\n|       |                              |Subclause 8.2.90  |                  |\n|126    |Additional Usage Reports      |Extendable /      |2                 |\n|       |Information                   |Subclause 8.2.91  |                  |\n|127    |Create Traffic Endpoint       |Extendable / Table|Not Applicable    |\n|       |                              |7.5.2.7           |                  |\n|128    |Created Traffic Endpoint      |Extendable / Table|Not Applicable    |\n|       |                              |7.5.3.5           |                  |\n|129    |Update Traffic Endpoint       |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.13          |                  |\n|130    |Remove Traffic Endpoint       |Extendable / Table|Not Applicable    |\n|       |                              |7.5.4.14          |                  |\n|131    |Traffic Endpoint ID           |Extendable /      |1                 |\n|       |                              |Subclause 8.2.92  |                  |\n|132    |Ethernet Packet Filter        |Extendable / Table|Not Applicable    |\n|       |                              |7.5.2.2-3         |                  |\n|133    |MAC address                   |Extendable /      |s-1-4             |\n|       |                              |Subclause 8.2.93  |                  |\n|134    |C-TAG                         |Extendable /      |3                 |\n|       |                              |Subclause 8.2.94  |                  |\n|135    |S-TAG                         |Extendable /      |3                 |\n|       |                              |Subclause 8.2.95  |                  |\n|136    |Ethertype                     |Extendable /      |2                 |\n|       |                              |Subclause 8.2.96  |                  |\n|137    |Proxying                      |Extendable /      |1                 |\n|       |                              |Subclause 8.2.97  |                  |\n|138    |Ethernet Filter ID            |Extendable /      |4                 |\n|       |                              |Subclause 8.2.98  |                  |\n|139    |Ethernet Filter Properties    |Extendable /      |1                 |\n|       |                              |Subclause 8.2.99  |                  |\n|140    |Suggested Buffering Packets   |Extendable /      |                  |\n|       |Count                         |Subclause 8.2.100 |                  |\n|141    |User ID                       |Extendable /      |d-1-4             |\n|       |                              |Subclause 8.2.101 |                  |\n|142    |Ethernet PDU Session          |Extendable /      |1                 |\n|       |Information                   |Subclause 8.2.102 |                  |\n|143    |Ethernet Traffic Information  |Extendable / Table|Not Applicable    |\n|       |                              |7.5.8.3-3         |                  |\n|144    |MAC Addresses Detected        |Extendable /      |7                 |\n|       |                              |Subclause 8.2.103 |                  |\n|145    |MAC Addresses Removed         |Extendable /      |7                 |\n|       |                              |Subclause 8.2.104 |                  |\n|146    |Ethernet Inactivity Timer     |Extendable /      |4                 |\n|       |                              |Subclause 8.2.105 |                  |\n|147 to |Spare. For future use.        |                  |                  |\n|65535  |                              |                  |                  |\n\n\n\n"}, {"key": "Information Elements", "numbering": "8.2", "title_level": 1, "desc": "8.2  Information Elements\n\n\n"}, {"key": "Cause", "numbering": "8.2.1", "title_level": 2, "desc": "8.2.1  Cause\n\nCause IE is coded as depicted in Figure 8.2.1-1.\n\n\n\n|.|        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Cause value                         |    |\n\n\n                            Figure 8.2.1-1: Cause\n\nThe Cause value shall be included in a response message. In a response\nmessage, the Cause value indicates the acceptance or the rejection of the\ncorresponding request message. The Cause value indicates the explicit\nreason for the rejection.\n\n                         Table 8.2.1-1: Cause values\n\n|Message|Cause |Meaning           |Description                       |\n|Type   |value |                  |                                  |\n|       |(decim|                  |                                  |\n|       |al)   |                  |                                  |\n|       |0     |Reserved.         |Shall not be sent and if received |\n|       |      |                  |the Cause shall be treated as an  |\n|       |      |                  |invalid IE                        |\n|Accepta|1     |Request accepted  |\"Request accepted (success)\" is   |\n|nce in |      |(success)         |returned when the PFCP entity has |\n|a      |      |                  |accepted a request.               |\n|respons|      |                  |                                  |\n|e      |      |                  |                                  |\n|       |2-63  |Spare.            |This value range shall be used by |\n|       |      |                  |Cause values in an acceptance     |\n|       |      |                  |response message. See NOTE 1.     |\n|Rejecti|64    |Request rejected  |This cause shall be returned to   |\n|on in a|      |(reason not       |report an unspecified rejection   |\n|respons|      |specified)        |cause                             |\n|e      |      |                  |                                  |\n|       |65    |Session context   |This cause shall be returned, if  |\n|       |      |not found         |the F-SEID included in a PFCP     |\n|       |      |                  |Session Modification/Deletion     |\n|       |      |                  |Request message is unknown.       |\n|       |66    |Mandatory IE      |This cause shall be returned when |\n|       |      |missing           |the PFCP entity detects that a    |\n|       |      |                  |mandatory IE is missing in a      |\n|       |      |                  |request message                   |\n|       |67    |Conditional IE    |This cause shall be returned when |\n|       |      |missing           |the PFCP entity detects that a    |\n|       |      |                  |Conditional IE is missing in a    |\n|       |      |                  |request message.                  |\n|       |68    |Invalid length    |This cause shall be returned when |\n|       |      |                  |the PFCP entity detects that an IE|\n|       |      |                  |with an invalid length in a       |\n|       |      |                  |request message                   |\n|       |69    |Mandatory IE      |This cause shall be returned when |\n|       |      |incorrect         |the PFCP entity detects that a    |\n|       |      |                  |Mandatory IE is incorrect in a    |\n|       |      |                  |request message, e.g. the         |\n|       |      |                  |Mandatory IE is malformated or it |\n|       |      |                  |carries an invalid or unexpected  |\n|       |      |                  |value.                            |\n|       |70    |Invalid Forwarding|This cause shall be used by the UP|\n|       |      |Policy            |function in the PFCP Session      |\n|       |      |                  |Establishment Response or PFCP    |\n|       |      |                  |Session Modification Response     |\n|       |      |                  |message if the CP function        |\n|       |      |                  |attempted to provision a FAR with |\n|       |      |                  |a Forwarding Policy Identifier for|\n|       |      |                  |which no Forwarding Policy is     |\n|       |      |                  |locally configured in the UP      |\n|       |      |                  |function.                         |\n|       |71    |Invalid F-TEID    |This cause shall be used by the UP|\n|       |      |allocation option |function in the PFCP Session      |\n|       |      |                  |Establishment Response or PFCP    |\n|       |      |                  |Session Modification Response     |\n|       |      |                  |message if the CP function        |\n|       |      |                  |attempted to provision a PDR with |\n|       |      |                  |a F-TEID allocation option which  |\n|       |      |                  |is incompatible with the F-TEID   |\n|       |      |                  |allocation option used for already|\n|       |      |                  |created PDRs (by the same or a    |\n|       |      |                  |different CP function).           |\n|       |72    |No established    |This cause shall be used by the CP|\n|       |      |PFCP Association  |function or the UP function if    |\n|       |      |                  |they receive an PFCP Session      |\n|       |      |                  |related message from a peer with  |\n|       |      |                  |which there is no established PFCP|\n|       |      |                  |Association.                      |\n|       |73    |Rule              |This cause shall be used by the UP|\n|       |      |creation/modificat|function if a received Rule failed|\n|       |      |ion Failure       |to be stored and  be applied in   |\n|       |      |                  |the UP function.                  |\n|       |74    |PFCP entity in    |This cause shall be returned when |\n|       |      |congestion        |a PFPC entity has detected node   |\n|       |      |                  |level congestion and performs     |\n|       |      |                  |overload control, which does not  |\n|       |      |                  |allow the request to be processed.|\n|       |75    |No resources      |This cause shall be returned to   |\n|       |      |available         |indicate a temporary              |\n|       |      |                  |unavailability of resources to    |\n|       |      |                  |process the received request.     |\n|       |76    |Service not       |This cause shall be returned when |\n|       |      |supported         |a PFCP entity receives a message  |\n|       |      |                  |requesting a feature or service   |\n|       |      |                  |that is not supported.            |\n|       |77    |System failure    |This cause shall be returned to   |\n|       |      |                  |indicate a system error condition.|\n|       |78 to |Spare for future  |This value range shall be used by |\n|       |255   |use in a response |Cause values in a rejection       |\n|       |      |message. See NOTE |response message. See NOTE 2.     |\n|       |      |2.                |                                  |\n|NOTE 1: This value is or may be used in future version of the       |\n|specification. If the receiver cannot comprehend the value, it shall|\n|be interpreted as an unspecified acceptance cause.                  |\n|Unspecified/unrecognized acceptance cause shall be treated in the   |\n|same ways as the cause value 1 \" Request accepted (success)\".       |\n|NOTE 2: This value is or may be used in a future version of the     |\n|specification. If the receiver cannot comprehend the value, it shall|\n|be interpreted as an unspecified rejection cause.                   |\n|Unspecified/unrecognized rejection cause shall be treated in the    |\n|same ways as the cause value 32 \"Request rejected (reason not       |\n|specified)\".                                                        |\n\n\n\n"}, {"key": "Source Interface", "numbering": "8.2.2", "title_level": 2, "desc": "8.2.2  Source Interface\n\nThe Source Interface IE type shall be encoded as shown in Figure 8.2.2-1.\nIt indicates the type of the interface from which an incoming packet is\nreceived.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare            |Interface value  |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                      Figure 8.2.2-1: Source Interface\n\nThe Interface value shall be encoded as a 4 bits binary integer as\nspecified in in Table 8.2.2-1.\n\n                       Table 8.2.2-1: Interface value\n\n|Interface value        |Values (Decimal)       |\n|Access                 |0                      |\n|Core                   |1                      |\n|SGi-LAN                |2                      |\n|CP-function            |3                      |\n|Spare                  |4 to 15                |\n|NOTE 1: The \"Access\" and \"Core\" values denote an|\n|uplink and downlink traffic direction           |\n|respectively.                                   |\n|NOTE 2: For indirect data forwarding, the Source|\n|Interface in the PDR and the Destination        |\n|Interface in the FAR shall both be set to       |\n|\"Access\", in the forwarding SGW(s). The         |\n|Interface value does not infer any traffic      |\n|direction, in PDRs and FARs set up for indirect |\n|data forwarding, i.e. with both the Source and  |\n|Destination Interfaces set to Access.           |\n\n\n\n"}, {"key": "F-TEID", "numbering": "8.2.3", "title_level": 2, "desc": "8.2.3  F-TEID\n\nThe F-TEID IE type shall be encoded as shown in Figure 8.2.3-1. It\nindicates an F-TEID.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare            |CHID|CH  |V6  |V4  |    |\n| |6 to 9  |TEID                                |    |\n| |m to    |IPv4 address                        |    |\n| |(m+3)   |                                    |    |\n| |p to    |IPv6 address                        |    |\n| |(p+15)  |                                    |    |\n| |q       |CHOOSE ID                           |    |\n| |k to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                           Figure 8.2.3-1: F-TEID\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 V4: If this bit is set to \"1\" and the CH bit is not set, then\n    the IPv4 address field shall be present, otherwise the IPv4 address\n    field shall not be present.\n\n  -  Bit 2 \u2013 V6: If this bit is set to \"1\" and the CH bit is not set, then\n    the IPv6 address field shall be present, otherwise the IPv6 address\n    field shall not be present.\n\n  -  Bit 3 \u2013 CH (CHOOSE): If this bit is set to \"1\", then the TEID, IPv4\n    address and IPv6 address fields shall not be present and the UP\n    function shall assign an F-TEID with an IP4 or an IPv6 address if the\n    V4 or V6 bit is set respectively. This bit shall only be set by the CP\n    function.\n\n  -  Bit 4 \u2013 CHID (CHOOSE ID): If this bit is set to \"1\", then the UP\n    function shall assign the same F-TEID to the PDRs requested to be\n    created in a PFCP Session Establishment Request or PFCP Session\n    Modification Request with the same CHOOSE ID value. This bit may only\n    be set to \"1\" if the CH bit it set to \"1\". This bit shall only be set\n    by the CP function.\n\n  -  Bit 5 to 8: Spare, for future use and set to 0.\n\nAt least one of the V4 and V6 flags shall be set to \"1\", and both may be\nset to \"1\".\n\nOctet 6 to 9 (TEID) shall be present and shall contain a GTP-U TEID, if the\nCH bit in octet 5 is not set. When the TEID is present, if both IPv4 and\nIPv6 addresses are present in the F-TEID IE, then the TEID value shall be\nshared by both addresses.\n\nOctets \"m to (m+3)\" and/or \"p to (p+15)\" (IPv4 address / IPv6 address\nfields), if present, it shall contain the respective IP address values.\n\nOctet q shall be present and shall contain a binary integer value if the\nCHID bit in octet 5 is set to \"1\".\n\n\n"}, {"key": "Network Instance", "numbering": "8.2.4", "title_level": 2, "desc": "8.2.4  Network Instance\n\nThe Network Instance IE type shall be encoded as shown in Figure 8.2.4-1.\nIt indicates a Network instance.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to    |Network Instance                    |    |\n| |(n+4)   |                                    |    |\n\n\n                      Figure 8.2.4-1: Network Instance\n\nThe Network instance field shall be encoded as an OctetString and shall\ncontain an identifier which uniquely identifies a particular Network\ninstance (e.g. PDN instance) in the UP function. It may be encoded as a\nDomain Name or an Access Point Name (APN) as per subclause 9.1 of\n3GPP\u00a0TS\u00a023.003\u00a0[2]. In the latter case, the PDN Instance field may contain\nthe APN Network Identifier only or the full APN with both the APN Network\nIdentifier and the APN Operator Identifier as specified in\n3GPP\u00a0TS\u00a023.003\u00a0[2] subclauses 9.1.1 and 9.1.2.\n\n  NOTE:  The APN field is not encoded as a dotted string as commonly used\n         in documentation.\n\n\n"}, {"key": "SDF Filter", "numbering": "8.2.5", "title_level": 2, "desc": "8.2.5  SDF Filter\n\nThe SDF Filter IE type shall be encoded as shown in Figure 8.2.5-1. It\ncontains an SDF Filter, i.e. a single IP flow packet filter.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                               |BID |\n| |m to    |Length of Flow Description          |    |\n| |(m+1)   |                                    |    |\n| |(m+2) to|Flow Description                    |    |\n| |p       |                                    |    |\n| |s to    |ToS Traffic Class                   |    |\n| |(s+1)   |                                    |    |\n| |t to    |Security Parameter Index            |    |\n| |(t+3)   |                                    |    |\n| |v to    |Flow Label                          |    |\n| |(v+2)   |                                    |    |\n| |w to    |SDF Filter ID                       |    |\n| |(w+3)   |                                    |    |\n| |x to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                         Figure 8.2.5-1: SDF Filter\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 FD (Flow Description): If this bit is set to \"1\", then the\n    Length of Flow Description and the Flow Description fields shall be\n    present, otherwise they shall not be present.\n\n  -  Bit 2 \u2013 TTC (ToS Traffic Class): If this bit is set to \"1\", then the\n    ToS Traffic Class field shall be present, otherwise the ToS Traffic\n    Class field shall not be present.\n\n  -  Bit 3 \u2013 SPI (Security Parameter Index): If this bit is set to \"1\",\n    then the Security Parameter Index field shall be present, otherwise the\n    Security Parameter Index field shall not be present.\n\n  -  Bit 4 \u2013 FL (Flow Label): If this bit is set to \"1\", then the Flow\n    Label field shall be present, otherwise the Flow Label field shall not\n    be present.\n\n  -  Bit 5 \u2013 BID (Bidirectional SDF Filter): If this bit is set to \"1\",\n    then the SDF Filter ID shall be present, otherwise the SDF Filter ID\n    shall not be present.\n\n  -  Bit 6 to 8: Spare, for future use and set to 0.\n\nThe Flow Description field, when present, shall be encoded as an\nOctetString as specified in subclause\u00a05.4.2 of 3GPP\u00a0TS\u00a029.212\u00a0[8].\n\nThe ToS Traffic Class field, when present, shall be encoded as an\nOctetString on two octets as specified in subclause\u00a05.3.15 of\n3GPP\u00a0TS\u00a029.212\u00a0[8].\n\nThe Security Parameter Index field, when present, shall be encoded as an\nOctetString on four octets and shall contain the IPsec security parameter\nindex (which is a 32-bit field), as specified in subclause\u00a05.3.51 of\n3GPP\u00a0TS\u00a029.212\u00a0[8].\n\nThe Flow Label field, when present, shall be encoded as an OctetString on 3\noctets as specified in subclause 5.3.52 of 3GPP\u00a0TS\u00a029.212\u00a0[8] and shall\ncontain an IPv6 flow label (which is a 20-bit field). The bits 8 to 5 of\nthe octet \"v\" shall be spare and set to zero, and the remaining 20 bits\nshall contain the IPv6 flow label.\n\nAn SDF Filter may:\n\n  -  be a pattern for matching the IP 5 tuple (source IP address or IPv6\n    network prefix, destination IP address or IPv6 network prefix, source\n    port number, destination port number, protocol ID of the protocol above\n    IP). In the pattern:\n\n    -  a value left unspecified in a filter matches any value of the\n       corresponding information in a packet;\n\n    -  an IP address may be combined with a prefix mask;\n\n    -  port numbers may be specified as port ranges;\n\n    -  the pattern can be extended by the Type of Service (TOS) (IPv4) /\n       Traffic class (IPv6) and Mask;\n\n  -  consist of the destination IP address and optional mask, protocol ID\n    of the protocol above IP, the Type of Service (TOS) (IPv4) / Traffic\n    class (IPv6) and Mask and the IPsec Security Parameter Index (SPI);\n\n  -  consist of the destination IP address and optional mask, the Type of\n    Service (TOS) (IPv4) / Traffic class (IPv6) and Mask and the Flow Label\n    (IPv6).\n\n  NOTE 1:  The details about the IPsec Security Parameter Index (SPI), the\n         Type of Service (TOS) (IPv4) / Traffic class (IPv6) and Mask and\n         the Flow Label (IPv6) are defined in 3GPP\u00a0TS\u00a023.060\u00a0[19]\n         clause\u00a015.3.\n\n  -  extend the packet inspection beyond the possibilities described above\n    and look further into the packet. Such service data flow filters need\n    to be predefined in the PGW-U, as specified in subclause\u00a05.11 of\n    3GPP\u00a0TS\u00a023.214\u00a0[2].\n\n  NOTE 2:  Such filters may be used to support filtering with respect to a\n         service data flow based on the transport and application protocols\n         used above IP, e.g. for HTTP and WAP. Filtering for further\n         application protocols and services can also be supported.\n\nThe SDF Filter ID, when present, shall be encoded as an Unsigned32 binary\ninteger value. It shall uniquely identify an SDF Filter among all the SDF\nFilters provisioned for a given Sx Session. The source/destination IP\naddress and port information, in a bidirectional SDF Filter, shall be set\nas for downlink IP flows. The SDF filter for the opposite direction has the\nsame parameters, but having the source and destination address/port\nparameters swapped. When being provisioned with a bidirectional SDF filter\nin a PDR, the UP function shall apply the SDF filter according to the\ndirection of the PDR (as derived from the Source Interface IE in the PDI of\nthe PDR or the Destination Interface IE in the FAR).\n\n\n"}, {"key": "Application ID", "numbering": "8.2.6", "title_level": 2, "desc": "8.2.6  Application ID\n\nThe Application ID IE type shall be encoded as shown in Figure 8.2.6-1. It\ncontains an Application Identifier referencing an application detection\nfilter in the UP function (e.g. its value may represent an application such\nas a list of URLs).\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to    |Application Identifier              |    |\n| |(n+4)   |                                    |    |\n\n\n                       Figure 8.2.6-1: Application ID\n\nThe Application Identifier shall be encoded as an OctetString (see\n3GPP\u00a0TS\u00a029.212\u00a0[8]).\n\n\n"}, {"key": "Gate Status", "numbering": "8.2.7", "title_level": 2, "desc": "8.2.7  Gate Status\n\nThe Gate Status IE shall be encoded as shown in Figure 8.2.7-1. It\nindicates whether the service data flow or application's traffic is allowed\nto be forwarded (gate is open) or shall be discarded (gate is closed) in\nuplink and/or in downlink direction.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare            |UL Gate |DL Gate |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                         Figure 8.2.7-1: Gate Status\n\n                           Table 8.2.7-1: UL Gate\n\n|UL Gate                                             |Value      |\n|                                                    |(Decimal)  |\n|OPEN                                                |0          |\n|CLOSED                                              |1          |\n|For future use. Shall not be sent. If received,     |2, 3       |\n|shall be interpreted as the value \"1\".              |           |\n\n\n                           Table 8.2.7-2: DL Gate\n\n|DL Gate                                             |Value      |\n|                                                    |(Decimal)  |\n|OPEN                                                |0          |\n|CLOSED                                              |1          |\n|For future use. Shall not be sent. If received,     |2, 3       |\n|shall be interpreted as the value \"1\".              |           |\n\n\n\n"}, {"key": "MBR", "numbering": "8.2.8", "title_level": 2, "desc": "8.2.8  MBR\n\nThe MBR IE type shall be encoded as shown in Figure 8.2.8-1. It indicates\nthe maximum bit rate allowed for the uplink and/or downlink directions.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 9  |UL MBR                              |    |\n| |10 to 14|DL MBR                              |    |\n| |15 to   |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                             Figure 8.2.8-1: MBR\n\nThe UL/DL MBR fields shall be encoded as kilobits per second (1 kbps = 1000\nbps) in binary value. The UL/DL MBR fields may require converting values in\nbits per second to kilobits per second when the UL/DL MBR values are\nreceived from an interface other than GTPv2 interface. If such conversions\nresult in fractions, then the value of UL/DL MBR fields shall be rounded\nupwards. The range of UL/DL MBR is specified in 3GPP\u00a0TS\u00a036.413\u00a0[10].\n\n  NOTE:  The encoding is aligned on the encoding specified in\n         3GPP\u00a0TS\u00a029.274\u00a0[9].\n\n\n"}, {"key": "GBR", "numbering": "8.2.9", "title_level": 2, "desc": "8.2.9  GBR\n\nThe GBR IE type shall be encoded as shown in Figure 8.2.9-1. It indicates\nthe guaranteed bit rate authorized for the uplink and/or downlink\ndirections.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 9  |UL GBR                              |    |\n| |10 to 14|DL GBR                              |    |\n| |15 to   |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                             Figure 8.2.9-1: GBR\n\nThe UL/DL GBR fields shall be encoded as kilobits per second (1 kbps = 1000\nbps) in binary value. The UL/DL GBR fields may require converting values in\nbits per second to kilobits per second when the UL/DL GBR values are\nreceived from an interface other than GTPv2 interface. If such conversions\nresult in fractions, then the value of UL/DL GBR fields shall be rounded\nupwards. The range of UL/DL GBR is specified in 3GPP\u00a0TS\u00a036.413\u00a0[10].\n\n  NOTE:  The encoding is aligned on the encoding specified in\n         3GPP\u00a0TS\u00a029.274\u00a0[9].\n\n\n"}, {"key": "QER Correlation ID", "numbering": "8.2.10", "title_level": 2, "desc": "8.2.10 QER Correlation ID\n\nThe QER Correlation ID IE type shall be encoded as shown in Figure 8.2.10-\n1. It contains a QoS Enforcement Rule Correlation ID to correlate QERs from\ndifferent PFCP sessions. The QER Correlation ID shall be dynamically\nassigned by the CP function and provisioned by the CP function in different\nPFCP sessions to correlate QERs used in these PFCP sessions.\n\n  NOTE:  A QER Correlation ID is not a Rule ID. It is only a correlation\n         number to correlate QERs from different PFCP sessions.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |QER Correlation ID value            |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                     Figure 8.2.10-1: QER Correlation ID\n\nThe QER Correlation ID value shall be encoded as an Unsigned32 binary\ninteger value.\n\n\n\n\n"}, {"key": "Precedence", "numbering": "8.2.11", "title_level": 2, "desc": "8.2.11 Precedence\n\nThe Precedence IE type shall be encoded as shown in Figure 8.2.11-1. It\ndefines the relative precedence of a PDR among all the PDRs provisioned\nwithin an PFCP session, when looking for a PDR matching an incoming packet.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Precedence value                    |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                         Figure 8.2.11-1: Precedence\n\n      The Precedence value shall be encoded as an Unsigned32 binary integer\n      value. The lower precedence values indicate higher precedence of the\n      PDR, and the higher precedence values indicate lower precedence of the\n      PDR when matching a packet.\n\n\n"}, {"key": "Transport Level Marking", "numbering": "8.2.12", "title_level": 2, "desc": "8.2.12 Transport Level Marking\n\nThe Transport Level Marking IE type shall be encoded as shown in Figure\n8.2.12-1. It indicates the DSCP to be used for UL/DL transport level\nmarking.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 6  |ToS/Traffic Class                   |    |\n| |7 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                  Figure 8.2.12-1: Transport Level Marking\n\nThe ToS/Traffic Class shall be encoded on two octets as an OctetString. The\nfirst octet shall contain the IPv4 Type-of-Service or the IPv6 Traffic-\nClass field and the second octet shall contain the ToS/Traffic Class mask\nfield. See subclause 5.3.15 of 3GPP\u00a0TS\u00a029.212\u00a0[8].\n\n\n"}, {"key": "Volume Threshold", "numbering": "8.2.13", "title_level": 2, "desc": "8.2.13 Volume Threshold\n\nThe Volume Threshold IE contains the traffic volume thresholds to be\nmonitored by the UP function. It shall be encoded as shown in Figure 8.2.13-\n1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                 |DLVO|ULVO|TOVO|    |\n| |        |                      |L   |L   |L   |    |\n| |m to    |Total Volume                        |    |\n| |(m+7)   |                                    |    |\n| |p to    |Uplink Volume                       |    |\n| |(p+7)   |                                    |    |\n| |q to    |Downlink Volume                     |    |\n| |(q+7)   |                                    |    |\n| |s to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                      Figure 8.2.13-1: Volume Threshold\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 TOVOL: If this bit is set to \"1\", then the Total Volume field\n    shall be present, otherwise the Total Volume field shall not be\n    present.\n\n  -  Bit 2 \u2013 ULVOL: If this bit is set to \"1\", then the Uplink Volume field\n    shall be present, otherwise the Uplink Volume field shall not be\n    present.\n\n  -  Bit 3 \u2013 DLVOL: If this bit is set to \"1\", then the Downlink Volume\n    field shall be present, otherwise the Downlink Volume field shall not\n    be present.\n\n  -  Bit 4 to 8: Spare, for future use and set to 0.\n\nAt least one bit shall be set to 1. Several bits may be set to 1.\n\nThe Total Volume, Uplink Volume and Downlink Volume fields shall be encoded\nas an Unsigned64 binary integer value. They shall contain the total, uplink\nor downlink number of octets respectively.\n\n\n"}, {"key": "Time Threshold", "numbering": "8.2.14", "title_level": 2, "desc": "8.2.14 Time Threshold\n\nThe Time Threshold IE contains the traffic duration threshold to be\nmonitored by the UP function. It shall be encoded as shown in Figure 8.2.14-\n1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Time Threshold                      |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                       Figure 8.2.14-1: Time Threshold\n\nThe Time Threshold field shall be encoded as an Unsigned32 binary integer\nvalue. It shall contain the duration in seconds.\n\n\n"}, {"key": "Monitoring Time", "numbering": "8.2.15", "title_level": 2, "desc": "8.2.15 Monitoring Time\n\nThe Monitoring Time IE indicates the time at which the UP function is\nexpected to reapply the thresholds. It shall be encoded as shown in Figure\n8.2.15-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Monitoring Time                     |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                      Figure 8.2.15-1: Monitoring Time\n\nThe Monitoring Time field shall indicate the monitoring time in UTC time.\nOctets 5 to 8 shall be encoded in the same format as the first four octets\nof the 64-bit timestamp format as defined in section 6 of\nIETF\u00a0RFC\u00a05905\u00a0[12].\n\n  NOTE:  The encoding is defined as the time in seconds relative to\n         00:00:00 on 1 January 1900.\n\n\n"}, {"key": "Subsequent Volume Threshold", "numbering": "8.2.16", "title_level": 2, "desc": "8.2.16 Subsequent Volume Threshold\n\nThe Subsequent Volume Threshold IE contains the subsequent traffic volume\nthresholds to be monitored by the UP function after the Monitoring Time. It\nshall be encoded as shown in Figure 8.2.16-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                 |DLVO|ULVO|TOVO|    |\n| |        |                      |L   |L   |L   |    |\n| |m to    |Total Volume                        |    |\n| |(m+7)   |                                    |    |\n| |p to    |Uplink Volume                       |    |\n| |(p+7)   |                                    |    |\n| |q to    |Downlink Volume                     |    |\n| |(q+7)   |                                    |    |\n| |s to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                Figure 8.2.16-1: Subsequent Volume Threshold\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 TOVOL: If this bit is set to \"1\", then the Total Volume field\n    shall be present, otherwise the Total Volume field shall not be\n    present.\n\n  -  Bit 2 \u2013 ULVOL: If this bit is set to \"1\", then the Uplink Volume field\n    shall be present, otherwise the Uplink Volume field shall not be\n    present.\n\n  -  Bit 3 \u2013 DLVOL: If this bit is set to \"1\", then the Downlink Volume\n    field shall be present, otherwise the Downlink Volume field shall not\n    be present.\n\n  -  Bit 4 to 8: Spare, for future use and set to 0.\n\nAt least one bit shall be set to 1. Several bits may be set to 1.\n\nThe Total Volume, Uplink Volume and Downlink Volume fields shall be encoded\nas an Unsigned64 binary integer value. They shall contain the total, uplink\nor downlink number of octets respectively.\n\n\n"}, {"key": "Subsequent Time Threshold", "numbering": "8.2.17", "title_level": 2, "desc": "8.2.17 Subsequent Time Threshold\n\nThe Subsequent Time Threshold IE contains the subsequent traffic duration\nthreshold to be monitored by the UP function after the Monitoring Time. It\nshall be encoded as shown in Figure 8.2.17-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Subsequent Time Threshold           |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                 Figure 8.2.17-1: Subsequent Time Threshold\n\nThe Subsequent Time Threshold field shall be encoded as an Unsigned32\nbinary integer value. It shall contain the duration in seconds.\n\n\n"}, {"key": "Inactivity Detection Time", "numbering": "8.2.18", "title_level": 2, "desc": "8.2.18 Inactivity Detection Time\n\nThe Inactivity Detection Time IE contains the inactivity time period, in\nseconds, to be monitored by the UP function. It shall be encoded as shown\nin Figure 8.2.18-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Inactivity Detection Time           |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                 Figure 8.2.18-1: Inactivity Detection Time\n\nThe Inactivity Detection Time field shall be encoded as an Unsigned32\nbinary integer value.\n\n\n"}, {"key": "Reporting Triggers", "numbering": "8.2.19", "title_level": 2, "desc": "8.2.19 Reporting Triggers\n\nThe Reporting Triggers IE shall be encoded as shown in Figure 8.2.19-1. It\nindicates the reporting trigger(s) for the UP function to send a report to\nthe CP function.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |LIUSA                               |DROT|\n| |        |                                    |H   |\n\n\n                     Figure 8.2.19-1: Reporting Triggers\n\nOctet 5 shall be encoded as follows:\n\n  -  Bit 1 \u2013 PERIO (Periodic Reporting): when set to 1, this indicates a\n    request for periodic reporting.\n\n  -  Bit 2 \u2013 VOLTH (Volume Threshold): when set to 1, this indicates a\n    request for reporting when the data volume usage reaches a volume\n    threshold\n\n  -  Bit 3 \u2013 TIMTH (Time Threshold): when set to 1, this indicates a\n    request for reporting when the time usage reaches a time threshold.\n\n  -  Bit 4 \u2013 QUHTI (Quota Holding Time): when set to 1, this indicates a\n    request for reporting when no packets have been received for a period\n    exceeding the Quota Holding Time.\n\n  -  Bit 5 \u2013 START (Start of Traffic): when set to 1, this indicates a\n    request for reporting when detecting the start of an SDF or Application\n    traffic.\n\n  -  Bit 6 \u2013 STOPT (Stop of Traffic): when set to 1, this indicates a\n    request for reporting when detecting the stop of an SDF or Application\n    Traffic.\n\n  -  Bit 7 - DROTH (Dropped DL Traffic Threshold): when set to 1, this\n    indicates a request for reporting when the DL traffic being dropped\n    reaches a threshold.\n\n  -  Bit 8: - LIUSA (Linked Usage Reporting): when set to 1, this indicates\n    a request for linked usage reporting, i.e. a request for reporting a\n    usage report for a URR when a usage report is reported for a linked URR\n    (see subclause 5.2.2.4).\n\nOctet 6 shall be encoded as follows:\n\n  -  Bit 1 \u2013VOLQU (Volume Quota): when set to 1, this indicates a request\n    for reporting when a Volume Quota is exhausted.\n\n  -  Bit 2 \u2013 TIMQU (Time Quota): when set to 1, this indicates a request\n    for reporting when a Time Quota is exhausted.\n\n  -  Bit 3 \u2013 ENVCL (Envelope Closure): when set to 1, this indicates a\n    request for reporting when conditions for closure of envelope is met\n    (see subclause 5.2.2.3).\n\n  -  Bit 4 \u2013 MACAR (MAC Addresses Reporting): when set to 1, this indicates\n    a request for reporting the MAC (Ethernet) addresses used as source\n    address of frames sent UL by the UE.\n\n  -  Bits 5 to 8: Spare, for future use and set to 0.\n\nAt least one bit shall be set to 1. Several bits may be set to 1.\n\n\n"}, {"key": "Redirect Information", "numbering": "8.2.20", "title_level": 2, "desc": "8.2.20 Redirect Information\n\n Redirect Information is coded as depicted in Figure 8.2.20-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3-4     |Length = n                          |    |\n| |5       |Spare            |Redirect Address |    |\n| |        |                 |Type             |    |\n| |6-7     |Redirect Server Address Length=a    |    |\n| |8-(8+a) |Redirect Server Address             |    |\n| |(8+a+1) |These octet(s) is/are present only  |    |\n| |to (n+4)|if explicitly specified             |    |\n\n\n                    Figure 8.2.20-1: Redirect Information\n\n  Redirect Address Type indicates the type of the Redirect Address. It\n    shall be encoded as defined in Table 8.2.20-1.\n\n                    Table 8.2.20-1: Redirect Address Type\n\n|Redirect Address Type        |Value      |\n|                             |(Decimal)  |\n|IPv4 address                 |0          |\n|IPv6 address                 |1          |\n|URL                          |2          |\n|SIP URI                      |3          |\n|Spare, for future use.       |4 to 15    |\n\n\n The Redirect Server Address Length shall indicate the length of the\n Redirect Server Address.\n\n The Redirect Server Address shall be encoded in UTF8String format and\n shall contain the address of the redirect server (e.g. HTTP redirect\n server, SIP server) with which the end user is to be connected, as\n specified in subclauses 8.38 and 8.39 of IETF\u00a0RFC\u00a04006\u00a0[16].\n\n\n"}, {"key": "Report Type", "numbering": "8.2.21", "title_level": 2, "desc": "8.2.21 Report Type\n\nThe Report Type IE shall be encoded as shown in Figure 8.2.21-1. It\nindicates the type of the report the UP function sends to the CP function.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare             |UPIR|ERI|USAR|DLDR|    |\n| |        |                  |    |R  |    |    |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                        Figure 8.2.21-1: Report Type\n\nOctet 5 shall be encoded as follows:\n\n  -  Bit 1 \u2013 DLDR (Downlink Data Report): when set to 1, this indicates\n    Downlink Data Report\n\n  -  Bit 2 \u2013 USAR (Usage Report): when set to 1, this indicates a Usage\n    Report\n\n  -  Bit 3 \u2013 ERIR (Error Indication Report): when set to 1, this indicates\n    an Error Indication Report.\n\n  -  Bit 4 \u2013 UPIR (User Plane Inactivity Report): when set to 1, this\n    indicates a User Plane Inactivity Report.\n\n  -  Bit 5 to 8 \u2013 Spare, for future use and set to 0.\n\n  At least one bit shall be set to 1. Several bits may be set to 1.\n\n\n"}, {"key": "Offending IE", "numbering": "8.2.22", "title_level": 2, "desc": "8.2.22 Offending IE\n\nOffending IE IE is coded as depicted in Figure 8.2.22-1.\n\n\n\n|.|        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = 2                          |    |\n| |5 to 6  |Type of the offending IE            |    |\n\n\n                        Figure 8.2.22-1: Offending IE\n\nThe offending IE shall contain a mandatory IE type, if the rejection is due\nto a conditional or mandatory IE is faulty or missing.\n\n\n"}, {"key": "Forwarding Policy", "numbering": "8.2.23", "title_level": 2, "desc": "8.2.23 Forwarding Policy\n\nThe Forwarding Policy IE type shall be encoded as shown in Figure 8.2.23-1.\nIt indicates a specific forwarding policy to apply to packets.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Forwarding Policy Identifier Length |    |\n| |j to k  |Forwarding Policy Identifier        |    |\n| |m to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                     Figure 8.2.23-1: Forwarding Policy\n\nThe Forwarding Policy Identifier Length shall indicate the length of the\nForwarding Policy Identifier.\n\nThe Forwarding Policy Identifier shall be encoded as an Octet String\ncontaining a reference to a pre-configured Forwarding Policy in the UP\nfunction, with a maximum length of 255 octets.\n\n\n"}, {"key": "Destination Interface", "numbering": "8.2.24", "title_level": 2, "desc": "8.2.24 Destination Interface\n\nThe Destination Interface IE type shall be encoded as shown in Figure\n8.2.24-1. It indicates the type of the interface towards which an outgoing\npacket is sent.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare            |Interface value  |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                   Figure 8.2.24-1: Destination Interface\n\nThe Interface value shall be encoded as a 4 bits binary integer as\nspecified in Table 8.2.24-1.\n\n                       Table 8.2.24-1: Interface value\n\n|Interface value        |Values (Decimal)       |\n|Access (see NOTE 1)    |0                      |\n|Core (see NOTE 1)      |1                      |\n|SGi-LAN                |2                      |\n|CP- Function           |3                      |\n|LI Function (see NOTE  |4                      |\n|2)                     |                       |\n|Spare                  |5 to 15                |\n|NOTE 1: The \"Access\" and \"Core\" values denote a |\n|downlink and uplink traffic direction           |\n|respectively.                                   |\n|NOTE 2:  LI Function may denote an SX3LIF or an |\n|LMISF. See subclause 5.7.                       |\n|NOTE 3: For indirect data forwarding, the Source|\n|Interface in the PDR and the Destination        |\n|Interface in the FAR shall both be set to       |\n|\"Access\", in the forwarding SGW(s). The         |\n|Interface value does not infer any traffic      |\n|direction, in PDRs and FARs set up for indirect |\n|data forwarding, i.e. with both the Source and  |\n|Destination Interfaces set to Access.           |\n\n\n\n"}, {"key": "UP Function Features", "numbering": "8.2.25", "title_level": 2, "desc": "8.2.25 UP Function Features\n\nThe UP Function Features IE indicates the features supported by the UP\nfunction. It is coded as depicted in Figure 8.2.25-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 6  |Supported-Features                  |    |\n| |7 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                    Figure 8.2.25-1: UP Function Features\n\nThe UP Function Features IE takes the form of a bitmask where each bit set\nindicates that the corresponding feature is supported. Spare bits shall be\nignored by the receiver. The same bitmask is defined for all PFCP\ninterfaces.\n\nThe following table specifies the features defined on PFCP interfaces and\nthe interfaces on which they apply.\n\n                    Table 8.2.25-1: UP Function Features\n\n|Feature Octet|Featur|Interface          |Description                       |\n|/ Bit        |e     |                   |                                  |\n|5/1          |BUCP  |Sxa                |Downlink Data Buffering in CP     |\n|             |      |                   |function is supported by the UP   |\n|             |      |                   |function.                         |\n|5/2          |DDND  |Sxa                |The buffering parameter 'Downlink |\n|             |      |                   |Data Notification Delay' is       |\n|             |      |                   |supported by the UP function.     |\n|5/3          |DLBD  |Sxa                |The buffering parameter 'DL       |\n|             |      |                   |Buffering Duration' is supported  |\n|             |      |                   |by the UP function.               |\n|5/4          |TRST  |Sxb, Sxc           |Traffic Steering is supported by  |\n|             |      |                   |the UP function.                  |\n|5/5          |FTUP  |Sxa, Sxb           |F-TEID allocation / release in the|\n|             |      |                   |UP function is supported by the UP|\n|             |      |                   |function.                         |\n|5/6          |PFDM  |Sxb, Sxc           |The PFD Management procedure is   |\n|             |      |                   |supported by the UP function.     |\n|5/7          |HEEU  |Sxb, Sxc           |Header Enrichment of Uplink       |\n|             |      |                   |traffic is supported by the UP    |\n|             |      |                   |function.                         |\n|5/8          |TREU  |Sxb, Sxc           |Traffic Redirection Enforcement in|\n|             |      |                   |the UP function is supported by   |\n|             |      |                   |the UP function.                  |\n|6/1          |EMPU  |Sxa, Sxb           |Sending of End Marker packets     |\n|             |      |                   |supported by the UP function.     |\n|6/2          |PDIU  |Sxa, Sxb, Sxc, N4  |Support of PDI optimised          |\n|             |      |                   |signalling in UP function (see    |\n|             |      |                   |subclause 5.2.1A.2).              |\n|6/3          |UDBC  |Sxb, Sxc, N4       |Support of UL/DL Buffering Control|\n|6/4          |QUOAC |Sxb, Sxc, N4       |The UP function supports being    |\n|             |      |                   |provisioned with the Quota Action |\n|             |      |                   |to apply when reaching quotas.    |\n|Feature Octet / Bit: The octet and bit number within the                  |\n|Supported-Features IE, e.g. \"5 / 1\".                                      |\n|Feature: A short name that can be used to refer to the octet / bit and to |\n|the feature.                                                              |\n|Interface: A list of applicable interfaces to the feature.                |\n|Description: A clear textual description of the feature.                  |\n\n\n\n"}, {"key": "Apply Action", "numbering": "8.2.26", "title_level": 2, "desc": "8.2.26 Apply Action\n\nThe Apply Action IE indicates the action(s) the UP function is required to\napply to packets. It is coded as shown in Figure 8.2.26-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                               |Spar|\n| |        |                                    |e   |\n\n\n                        Figure 8.2.26-1: Apply-Action\n\nThe octet 5 shall be encoded as follows:\n\n  -  Bit 1 \u2013 DROP (Drop): when set to 1, this indicates a request to drop\n    the packets.\n\n  -  Bit 2 \u2013 FORW (Forward): when set to 1, this indicates a request to\n    forward the packets.\n\n  -  Bit 3 \u2013 BUFF (Buffer): when set to 1, this indicates a request to\n    buffer the packets.\n\n  -  Bit 4 \u2013 NOCP (Notify the CP function): when set to 1, this indicates a\n    request to notify the CP function about the arrival of a first downlink\n    packet being buffered.\n\n  -  Bit 5 \u2013 DUPL (Duplicate): when set to 1, this indicates a request to\n    duplicate the packets.\n\n  -  Bit 6 to 8 \u2013 Spare, for future use and set to 0.\n\nOne and only one of the DROP, FORW and BUFF flags shall be set to 1.\n\nThe NOCP flag may only be set if the BUFF flag is set.\n\nThe DUPL flag may be set with any of the DROP, FORW, BUFF and NOCP flags.\n\n\n"}, {"key": "Downlink Data Service Information", "numbering": "8.2.27", "title_level": 2, "desc": "8.2.27 Downlink Data Service Information\n\nThe Downlink Data Service Information IE is used to carry downlink data\nservice information. It is coded as shown in Figure 8.2.27-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                          |PPI |    |\n| |m       |Spare   |Paging Policy Indication   |    |\n| |        |        |value                      |    |\n| |p to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n             Figure 8.2.27-1: Downlink Data Service Information\n\nThe PPI flag in octet 5 indicates whether the Paging Policy Indication\nvalue in octet 'm' shall be present. If PPI is set to '1', then the Paging\nPolicy Indication value shall be present. If PPI is set to '0', then octet\n'm' shall not be present.\n\nThe Paging Policy Indication value, in octet 'm', shall be encoded as the\nDSCP in TOS (IPv4) or TC (IPv6) information received in the IP payload of\nthe GTP-U packet from the PGW (see IETF\u00a0RFC\u00a02474\u00a0[13]).\n\n\n"}, {"key": "Downlink Data Notification Delay", "numbering": "8.2.28", "title_level": 2, "desc": "8.2.28 Downlink Data Notification Delay\n\nThe Downlink Data Notification Delay IE indicates the delay the UP function\nshall apply between receiving a downlink data packet and notifying the CP\nfunction about the arrival of the packet. It is coded as depicted in Figure\n8.2.28-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Delay Value in integer multiples of |    |\n| |        |50 millisecs, or zero               |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n              Figure 8.2.28-1: Downlink Data Notification Delay\n\nDelay Value shall be set to zero in order to clear a previously set delay\ncondition.\n\n\n"}, {"key": "DL Buffering Duration", "numbering": "8.2.29", "title_level": 2, "desc": "8.2.29 DL Buffering Duration\n\nThe DL Buffering Duration IE indicates the duration during which the UP\nfunction is requested to buffer the downlink data packets. It is coded as\nshown in figure 8.2.29-1 and table 8.2.29.1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Timer unit   |Timer value           |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                   Figure 8.2.29-1: DL Buffering Duration\n\n                    Table 8.2.29.1: DL Buffering Duration\n\n|Timer value                                         |\n|Bits 5 to 1 represent the binary coded timer value. |\n|                                                    |\n|Timer unit                                          |\n|Bits 6 to 8 defines the timer value unit as follows:|\n|Bits                                                |\n|8 7 6                                               |\n|0 0 0  value is incremented in multiples of 2       |\n|seconds                                             |\n|0 0 1  value is incremented in multiples of 1 minute|\n|                                                    |\n|0 1 0  value is incremented in multiples of 10      |\n|minutes                                             |\n|0 1 1  value is incremented in multiples of 1 hour  |\n|1 0 0  value is incremented in multiples of 10 hours|\n|1 1 1  value indicates that the timer is infinite   |\n|                                                    |\n|Other values shall be interpreted as multiples of 1 |\n|minute in this version of the protocol.             |\n|                                                    |\n|Timer unit and Timer value both set to all \"zeros\"  |\n|shall be interpreted as an indication that the timer|\n|is stopped.                                         |\n\n\n\n"}, {"key": "DL Buffering Suggested Packet Count", "numbering": "8.2.30", "title_level": 2, "desc": "8.2.30 DL Buffering Suggested Packet Count\n\nThe DL Buffering Suggested Packet Count IE indicates the maximum number of\ndownlink data packets suggested to be buffered in the UP function for this\nPFCP session. It is coded as depicted in Figure 8.2.30-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to n+4|Packet Count Value                  |    |\n\n\n            Figure 8.2.30-1: DL Buffering Suggested Packet Count\n\nThe Packet Count value is encoded with the number of octets defined in the\nLength field, e.g. when n=2, the range of the Packet Count value is from 0\nto 65535.\n\nThe length shall be set to 1 or 2 octets.\n\n\n"}, {"key": "PFCPSMReq-Flags", "numbering": "8.2.31", "title_level": 2, "desc": "8.2.31 PFCPSMReq-Flags\n\nThe PFCPSMReq-Flags IE indicates flags applicable to the PFCP Session\nModification Request message. It is coded as depicted in Figure 8.2.31-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                               |Spar|\n| |        |                                    |e   |\n\n\n                      Figure 8.2.31-1: PFCPSMReq-Flags\n\nThe following bits within Octet 5 shall indicate:\n\n  -  Bit 1 \u2013 DROBU (Drop Buffered Packets): if this bit is set to 1, it\n    indicates that the UP function shall drop all the packets currently\n    buffered for the PFCP session, if any, prior to further applying the\n    action specified in the Apply Action value of the FARs.\n\n  -  Bit 2 \u2013 SNDEM (Send End Marker Packets): if this bit is set to 1, it\n    indicates that the UP function shall construct and send End Marker\n    packets towards the old F-TEID of the downstream node when switching to\n    the new F-TEID.\n\n  -  Bit 3 \u2013 QAURR (Query All URRs): if this bit is set to 1, it indicates\n    that the UP function shall return immediate usage report(s) for all the\n    URRs previously provisioned for this PFCP session.\n\n  -  Bit 4 to 8 \u2013 Spare, for future use, shall be set to 0 by the sender\n    and discarded by the receiver.\n\n\n"}, {"key": "PFCPSRRsp-Flags", "numbering": "8.2.32", "title_level": 2, "desc": "8.2.32 PFCPSRRsp-Flags\n\nThe PFCPSRRsp-Flags IE indicates flags applicable to the PFCP Session\nReport Response message. It is coded as depicted in Figure 8.2.32-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                               |Spar|\n| |        |                                    |e   |\n\n\n                      Figure 8.2.32-1: PFCPSRRsp-Flags\n\nThe following bits within Octet 5 shall indicate:\n\n  -  Bit 1 \u2013 DROBU (Drop Buffered Packets): if this bit is set to 1, it\n    indicates that the UP function shall drop all the packets currently\n    buffered for the PFCP session, if any, prior to further applying the\n    action specified in the Apply Action value of the FARs.\n\n  -  Bit 2 to 8 \u2013 Spare, for future use, shall be set to 0 by the sender\n    and discarded by the receiver.\n\n\n"}, {"key": "Sequence Number", "numbering": "8.2.33", "title_level": 2, "desc": "8.2.33 Sequence Number\n\nThe Sequence Number IE shall be encoded as shown in Figure 8.2.33-1. It\ncontains an Unsigned32 binary integer value.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Sequence Number                     |    |\n\n\n                      Figure 8.2.33-1: Sequence Number\n\n\n"}, {"key": "Metric", "numbering": "8.2.34", "title_level": 2, "desc": "8.2.34 Metric\n\nThe Metric IE shall be encoded as shown in Figure 8.2.34-1. It indicates a\npercentage and may take binary coded integer values from and including 0 up\nto and including 100. Other values shall be considered as 0.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Metric                              |    |\n\n\n                           Figure 8.2.34-1: Metric\n\n\n"}, {"key": "Timer", "numbering": "8.2.35", "title_level": 2, "desc": "8.2.35 Timer\n\nThe purpose of the Timer IE is to specify specific timer values. The Timer\nIE shall be encoded as shown in Figure 8.2.35-1 and table 8.2.35.1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Timer unit   |Timer value           |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                           Figure 8.2.35-1: Timer\n\n                  Table 8.2.35.1: Timer information element\n\n|Timer value                                         |\n|Bits 5 to 1 represent the binary coded timer value. |\n|                                                    |\n|Timer unit                                          |\n|Bits 6 to 8 defines the timer value unit for the    |\n|timer as follows:                                   |\n|Bits                                                |\n|8 7 6                                               |\n|0 0 0  value is incremented in multiples of 2       |\n|seconds                                             |\n|0 0 1  value is incremented in multiples of 1 minute|\n|                                                    |\n|0 1 0  value is incremented in multiples of 10      |\n|minutes                                             |\n|0 1 1  value is incremented in multiples of 1 hour  |\n|1 0 0  value is incremented in multiples of 10 hours|\n|1 1 1  value indicates that the timer is infinite   |\n|                                                    |\n|Other values shall be interpreted as multiples of 1 |\n|minute in this version of the protocol.             |\n|                                                    |\n|Timer unit and Timer value both set to all \"zeros\"  |\n|shall be interpreted as an indication that the timer|\n|is stopped.                                         |\n\n\n\n"}, {"key": "Packet Detection Rule ID (PDR ID)", "numbering": "8.2.36", "title_level": 2, "desc": "8.2.36 Packet Detection Rule ID (PDR ID)\n\nThe PDR ID IE is coded as depicted in Figure 8.2.36-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 6  |Rule ID                             |    |\n| |7to     |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                           Figure 8.2.36-1: PDR ID\n\nOctets 5 to 6 contain the Rule ID and shall be encoded as an integer.\n\n\n"}, {"key": "F-SEID", "numbering": "8.2.37", "title_level": 2, "desc": "8.2.37 F-SEID\n\nF-SEID is coded as depicted in Figure 8.2.37-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                               |Spar|\n| |        |                                    |e   |\n| |m to    |IPv4 address                        |    |\n| |(m+3)   |                                    |    |\n| |p to    |IPv6 address                        |    |\n| |(p+15)  |                                    |    |\n| |k to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                           Figure 8.2.37-1: F-SEID\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 V6: If this bit is set to \"1\", then IPv6 address field shall\n    be present in the F-SEID, otherwise the IPv6 address field is not\n    present at all.\n\n  -  Bit 2 \u2013 V4: If this bit is set to \"1\", then IPv4 address field shall\n    be present in the F-SEID, otherwise the IPv4 address field is not\n    present at all.\n\n  -  Bit 3 to 8 are spare and reserved for future use.\n\nAt least one of V4 and V6 shall be set to \"1\", and both may be set to \"1\".\n\nOctets \"m to (m+3)\" and/or \"p to (p+15)\" (IPv4 address / IPv6 address\nfields), if present, contain respective address values.\n\n\n"}, {"key": "Node ID", "numbering": "8.2.38", "title_level": 2, "desc": "8.2.38 Node ID\n\nThe Node ID IE shall contain an FQDN or an IPv4/IPv6 address. It shall be\nencoded as shown in Figure 8.2.38-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare            |Node ID Type     |    |\n| |6 to o  |Node ID value                       |    |\n| |m to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                          Figure 8.2.38-1: Node ID\n\nNode ID Type indicates the type of the Node ID value. It shall be encoded\nas a 4 bits binary integer as specified in Table 8.2.38-2.\n\n                        Table 8.2.38-2: Node ID Type\n\n|Node ID Type|Node ID Type                 |\n|Value       |                             |\n|(Decimal)   |                             |\n|0           |IPv4 address                 |\n|1           |IPv6 address                 |\n|2           |FQDN                         |\n|3 to 15     |Spare, for future use.       |\n\n\n\nIf the Node ID is an IPv4 address, the Node ID value length shall be 4\nOctet.\n\nIf the Node ID is an IPv6 address, the Node ID value length shall be 16\nOctet.\n\nIf the Node ID is an FQDN, the Node ID value encoding shall be identical to\nthe encoding of a FQDN within a DNS message of section 3.1 of\nIETF\u00a0RFC\u00a01035\u00a0[27] but excluding the trailing zero byte.\n\n  NOTE 1:  The FQDN field in the IE is not encoded as a dotted string as\n         commonly used in DNS master zone files.\n\n\n"}, {"key": "PFD Contents", "numbering": "8.2.39", "title_level": 2, "desc": "8.2.39 PFD Contents\n\nThe PFD Contents IE type shall be encoded as shown in Figure 8.2.39-1. It\ncontains the description of a PFD.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare            |CP  |DN  |URL |FD  |    |\n| |6       |Spare                               |    |\n| |m to    |Length of Flow Description          |    |\n| |(m+1)   |                                    |    |\n| |(m+2) to|Flow Description                    |    |\n| |p       |                                    |    |\n| |q to    |Length of URL                       |    |\n| |(q+1)   |                                    |    |\n| |(q+2) to|URL                                 |    |\n| |r       |                                    |    |\n| |s to    |Length of Domain Name               |    |\n| |(s+1)   |                                    |    |\n| |(s+2) to|Domain Name                         |    |\n| |t       |                                    |    |\n| |u to    |Length of Custom PFD Content        |    |\n| |(u+1)   |                                    |    |\n| |(u+2) to|Custom PFD Content                  |    |\n| |v       |                                    |    |\n| |w to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                        Figure 8.2.39-1: PFD Contents\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 FD (Flow Description): If this bit is set to \"1\", then the\n    Length of Flow Description and the Flow Description fields shall be\n    present, otherwise they shall not be present.\n\n  -  Bit 2 \u2013 URL (URL): If this bit is set to \"1\", then the Length of URL\n    and the URL fields shall be present, otherwise they shall not be\n    present.\n\n  -  Bit 3 \u2013 DN (Domain Name): If this bit is set to \"1\", then the Length\n    of Domain Name and the Domain Name fields shall be present, otherwise\n    they shall not be present.\n\n  -  Bit 4 \u2013 CP (Custom PFD Content): If this bit is set to \"1\", then the\n    Length of Custom PFD Content and the Custom PFD Content fields shall be\n    present, otherwise they shall not be present.\n\n  -  Bit 5 to 8: Spare, for future use and set to 0.\n\nThe Flow Description field, when present, shall be encoded as an\nOctetString as specified in subclause 6.4.3.7 of 3GPP\u00a0TS\u00a029.251\u00a0[21].\n\nThe Domain Name field, when present, shall be encoded as an OctetString as\nspecified in subclause 6.4.3.9 of 3GPP\u00a0TS\u00a029.251\u00a0[21].\n\nThe URL field, when present, shall be encoded as an OctetString as\nspecified in subclause 6.4.3.8 of 3GPP\u00a0TS\u00a029.251\u00a0[21].\n\n\n"}, {"key": "Measurement Method", "numbering": "8.2.40", "title_level": 2, "desc": "8.2.40 Measurement Method\n\nThe Measurement Method IE shall be encoded as shown in Figure 8.2.40-1. It\nindicates the method for measuring the usage of network resources.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                               |Spar|\n| |        |                                    |e   |\n\n\n                     Figure 8.2.40-1: Measurement Method\n\nOctet 5 shall be encoded as follows:\n\n  -  Bit 1 \u2013 DURAT (Duration): when set to 1, this indicates a request for\n    measuring the duration of the traffic.\n\n  -  Bit 2 \u2013 VOLUM (Volume): when set to 1, this indicates a request for\n    measuring the volume of the traffic.\n\n  -  Bit 3 \u2013 EVENT (Event): when set to 1, this indicates a request for\n    measuring the events.\n\n  -  Bit 4 to 8: Spare, for future use and set to 0.\n\nAt least one bit shall be set to 1. Several bits may be set to 1.\n\n\n"}, {"key": "Usage Report Trigger", "numbering": "8.2.41", "title_level": 2, "desc": "8.2.41 Usage Report Trigger\n\nThe Usage Report Trigger IE shall be encoded as shown in Figure 8.2.41-1.\nIt indicates the trigger of the usage report.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |IMMER                               |DROT|\n| |        |                                    |H   |\n\n\n                    Figure 8.2.41-1: Usage Report Trigger\n\nOctet 5 shall be encoded as follows:\n\n  -  Bit 1 \u2013 PERIO (Periodic Reporting): when set to 1, this indicates a\n    periodic report.\n\n  -  Bit 2 \u2013 VOLTH (Volume Threshold): when set to 1, this indicates that\n    the data volume usage reaches a volume threshold.\n\n  -  Bit 3 \u2013 TIMTH (Time Threshold): when set to 1, this indicates that the\n    time usage reaches a volume threshold.\n\n  -  Bit 4 \u2013 QUHTI (Quota Holding Time): when set to 1, this indicates that\n    no packets have been received for a period exceeding the Quota Holding\n    Time.\n\n  -  Bit 5 \u2013 START (Start of Traffic): when set to 1, this indicates that\n    the start of traffic is detected.\n\n  -  Bit 6 \u2013 STOPT (Stop of Traffic): when set to 1, this indicates that\n    the stop of traffic is detected.\n\n  -  Bit 7 - DROTH (Dropped DL Traffic Threshold): when set to 1, this\n    indicates that the DL traffic being dropped reaches a threshold.\n\n  -  Bit 8 \u2013 IMMER (Immediate Report): when set to 1, this indicates an\n    immediate report reported on CP function demand.\n\nOctet 6 shall be encoded as follows:\n\n  -  Bit 1 \u2013 VOLQU (Volume Quota): when set to 1, this indicates that the\n    Volume Quota has been exhausted.\n\n  -  Bit 2 \u2013 TIMQU (Time Quota): when set to 1, this indicates that the\n    Time Quota has been exhausted.\n\n  -  Bit 3 - LIUSA (Linked Usage Reporting): when set to 1, this indicates\n    a linked usage report, i.e. a usage report being reported for a URR due\n    to a usage report being also reported for a linked URR (see subclause\n    5.2.2.4).\n\n  -  Bit 4 \u2013 TERMR (Termination Report): when set to 1, this indicates a\n    usage report being reported (in a PFCP Session Deletion Response) for a\n    URR due to the termination of the PFCP session, or a usage report being\n    reported (in a PFCP Session Modification Response) for a URR due to the\n    removal of the URR.\n\n  -  Bit 5 \u2013 MONIT (Monitoring Time): when set to 1, this indicates a usage\n    report being reported for a URR due to the Monitoring Time being\n    reached.\n\n  -  Bit 6 \u2013 ENVCL (Envelope Closure): when set to 1, this indicates the\n    usage report is generated for closure of an envelope (see subclause\n    5.2.2.3).\n\n  -  Bit 7 \u2013 MACAR (MAC Addresses Reporting): when set to 1, this indicates\n    a usage report to report MAC (Ethernet) addresses used as source\n    address of frames sent UL by the UE.\n\n  -  Bits 8: Spare, for future use and set to 0.\n\n  At least one bit shall be set to 1. Several bits may be set to 1.\n\n\n"}, {"key": "Measurement Period", "numbering": "8.2.42", "title_level": 2, "desc": "8.2.42 Measurement Period\n\nThe Measurement Period IE contains the period, in seconds, for generating\nperiodic usage reports. It shall be encoded as shown in Figure 8.2.42-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Measurement Period                  |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                     Figure 8.2.42-1: Measurement Period\n\nThe Measurement Period field shall be encoded as an Unsigned32 binary\ninteger value.\n\n\n"}, {"key": "Fully qualified PDN Connection Set Identifier (FQ-CSID)", "numbering": "8.2.43", "title_level": 2, "desc": "8.2.43  Fully qualified PDN Connection Set Identifier (FQ-CSID)\n\nA fully qualified PDN Connection Set Identifier (FQ-CSID) identifies a set\nof PDN connections belonging to an arbitrary number of UEs on a SGW-C, PGW-\nC, SGW-U and PGW-U. The FQ-CSID is used on Sxa and Sxb interfaces.\n\nThe size of CSID is two octets. The FQ-CSID is coded as follows:\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |FQ-CSID Node-ID  |Number of CSIDs= |    |\n| |        |Type             |m                |    |\n| |6 to p  |Node-Address                        |    |\n| |(p+1) to|First PDN Connection Set Identifier |    |\n| |(p+2)   |(CSID)                              |    |\n| |(p+3) to|Second PDN Connection Set Identifier|    |\n| |(p+4)   |(CSID)                              |    |\n| |...     |...                                 |    |\n| |q to q+1|m-th PDN Connection Set Identifier  |    |\n| |        |(CSID)                              |    |\n| |(q+2) to|These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                          Figure 8.2.43-1: FQ-CSID\n\nWhere FQ-CSID Node-ID Type values are:\n\n  0  indicates that Node-Address is a global unicast IPv4 address and p =\n    9.\n\n  1  indicates that Node-Address is a global unicast IPv6 address and p =\n    21.\n\n  2  indicates that Node-Address is a 4 octets long field with a 32 bit\n    value stored in network order, and p= 9. The coding of the field is\n    specified below:\n\n  -  Most significant 20 bits are the binary encoded value of (MCC * 1000 +\n    MNC).\n\n  -  Least significant 12 bits is a 12 bit integer assigned by an operator\n    to an MME, SGW-C, SGW-U, PGW-C or PGW-U. Other values of Node-Address\n    Type are reserved.\n\nValues of Number of CSID other than 1 are only employed in the PFCP Session\nDelete Request.\n\nThe node that creates the FQ-CSID (i.e. SGW-C for SGW-C FQ-CSID, SGW-U for\nSGW-U FQ-CSID, PGW-C for PGW-C FQ-CSID and PGW-U for PGW-U FQ-CSID) needs\nto ensure that the Node-ID is globally unique and the CSID value is unique\nwithin that node.\n\n\n"}, {"key": "Volume Measurement", "numbering": "8.2.44", "title_level": 2, "desc": "8.2.44 Volume Measurement\n\nThe Volume Measurement IE contains the measured traffic volumes. It shall\nbe encoded as shown in Figure 8.2.44-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                 |DLVO|ULVO|TOVO|    |\n| |        |                      |L   |L   |L   |    |\n| |m to    |Total Volume                        |    |\n| |(m+7)   |                                    |    |\n| |p to    |Uplink Volume                       |    |\n| |(p+7)   |                                    |    |\n| |q to    |Downlink Volume                     |    |\n| |(q+7)   |                                    |    |\n| |s to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                     Figure 8.2.44-1: Volume Measurement\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 TOVOL: If this bit is set to \"1\", then the Total Volume field\n    shall be present, otherwise the Total Volume field shall not be\n    present.\n\n  -  Bit 2 \u2013 ULVOL: If this bit is set to \"1\", then the Uplink Volume field\n    shall be present, otherwise the Uplink Volume field shall not be\n    present.\n\n  -  Bit 3 \u2013 DLVOL: If this bit is set to \"1\", then the Downlink Volume\n    field shall be present, otherwise the Downlink Volume field shall not\n    be present.\n\n  -  Bit 4 to bit 8: Spare, for future use and set to 0.\n\nAt least one bit shall be set to 1. Several bits may be set to 1.\n\nThe Total Volume, Uplink Volume and Downlink Volume fields shall be encoded\nas an Unsigned64 binary integer value. They shall contain the total, uplink\nor downlink number of octets respectively.\n\n\n"}, {"key": "Duration Measurement", "numbering": "8.2.45", "title_level": 2, "desc": "8.2.45 Duration Measurement\n\nThe Duration Measurement IE type shall be encoded as shown in Figure 8.2.45-\n1. It contains the used time in seconds.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Duration value                      |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                    Figure 8.2.45-1: Duration Measurement\n\nThe Duration value shall be encoded as an Unsigned32 binary integer value.\n\n\n"}, {"key": "Time of First Packet", "numbering": "8.2.46", "title_level": 2, "desc": "8.2.46 Time of First Packet\n\nThe Time of First Packet IE indicates the time stamp for the first IP\npacket transmitted for a given usage report. It shall be encoded as shown\nin Figure 8.2.46-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Time of First Packet                |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                    Figure 8.2.46-1: Time of First Packet\n\nThe Time of First Packet field shall contain a UTC time. Octets 5 to 8\nshall be encoded in the same format as the first four octets of the 64-bit\ntimestamp format as defined in section 6 of IETF\u00a0RFC\u00a05905\u00a0[12].\n\n  NOTE:  The encoding is defined as the time in seconds relative to\n         00:00:00 on 1 January 1900.\n\n\n"}, {"key": "Time of Last Packet", "numbering": "8.2.47", "title_level": 2, "desc": "8.2.47 Time of Last Packet\n\nThe Time of Last Packet IE indicates the time stamp for the last IP packet\ntransmitted for a given usage report. It shall be encoded as shown in\nFigure 8.2.47-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Time of Last Packet                 |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                    Figure 8.2.47-1: Time of Last Packet\n\nThe Time of Last Packet field shall contain a UTC time. Octets 5 to 8 shall\nbe encoded in the same format as the first four octets of the 64-bit\ntimestamp format as defined in section 6 of IETF\u00a0RFC\u00a05905\u00a0[12].\n\n  NOTE:  The encoding is defined as the time in seconds relative to\n         00:00:00 on 1 January 1900.\n\n\n"}, {"key": "Quota Holding Time", "numbering": "8.2.48", "title_level": 2, "desc": "8.2.48 Quota Holding Time\n\nThe Quota Holding Time IE type shall be encoded as shown in Figure 8.2.48-\n1. It contains the quota holding time in seconds.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Quota Holding Time value            |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                     Figure 8.2.48-1: Quota Holding Time\n\nThe Quota Holding Time value shall be encoded as an Unsigned32 binary\ninteger value.\n\n\n"}, {"key": "Dropped DL Traffic Threshold", "numbering": "8.2.49", "title_level": 2, "desc": "8.2.49 Dropped DL Traffic Threshold\n\nThe Dropped DL Traffic Threshold IE type shall be encoded as shown in\nFigure 8.2.49-1. It contains the dropped DL traffic volume thresholds to be\nmonitored by the UP function.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                          |DLPA|    |\n| |m to    |Downlink Packets                    |    |\n| |(m+7)   |                                    |    |\n| |s to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                Figure 8.2.49-1: Dropped DL Traffic Threshold\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 DLPA: If this bit is set to \"1\", then the Downlink Packets\n    field shall be present, otherwise the Downlink Packets field shall not\n    be present.\n\n  -  Bit 2 to 8: Spare, for future use and set to 0.\n\nThe Downlink Packets fields shall be encoded as an Unsigned64 binary\ninteger value. It shall contain a number of downlink packets.\n\n\n"}, {"key": "Volume Quota", "numbering": "8.2.50", "title_level": 2, "desc": "8.2.50 Volume Quota\n\nThe Volume Quota IE type shall be encoded as shown in Figure 8.2.50-1. It\ncontains the volume quota to be monitored by the UP function.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                 |DLVO|ULVO|TOVO|    |\n| |        |                      |L   |L   |L   |    |\n| |m to    |Total Volume                        |    |\n| |(m+7)   |                                    |    |\n| |p to    |Uplink Volume                       |    |\n| |(p+7)   |                                    |    |\n| |q to    |Downlink Volume                     |    |\n| |(q+7)   |                                    |    |\n| |S to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                        Figure 8.2.50-1: Volume Quota\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 TOVOL: If this bit is set to \"1\", then the Total Volume field\n    shall be present, otherwise the Total Volume field shall not be\n    present.\n\n  -  Bit 2 \u2013 ULVOL: If this bit is set to \"1\", then the Uplink Volume field\n    shall be present, otherwise the Uplink Volume field shall not be\n    present.\n\n  -  Bit 3 \u2013 DLVOL: If this bit is set to \"1\", then the Downlink Volume\n    field shall be present, otherwise the Downlink Volume field shall not\n    be present.\n\n  -  Bit 4 to bit 8: Spare, for future use and set to 0.\n\nAt least one bit shall be set to 1. Several bits may be set to 1.\n\nThe Total Volume, Uplink Volume and Downlink Volume fields shall be encoded\nas an Unsigned64 binary integer value. They shall contain the total, uplink\nor downlink number of octets respectively.\n\n\n"}, {"key": "Time Quota", "numbering": "8.2.51", "title_level": 2, "desc": "8.2.51 Time Quota\n\nThe Time Quota IE type shall be encoded as shown in Figure 8.2.51-1. It\ncontains the time quota to be monitored by the UP function.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Time Quota value                    |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                         Figure 8.2.51-1: Time Quota\n\nThe Time Quota value shall be encoded as an Unsigned32 binary integer\nvalue. It contains a duration in seconds.\n\n\n"}, {"key": "Start Time", "numbering": "8.2.52", "title_level": 2, "desc": "8.2.52 Start Time\n\nThe Start Time IE indicates the time at which the UP function started to\ncollect the charging information. It shall be encoded as shown in Figure\n8.2.52-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Start Time                          |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                         Figure 8.2.52-1: Start Time\n\nThe Start Time field shall contain a UTC time. Octets 5 to 8 shall be\nencoded in the same format as the first four octets of the 64-bit timestamp\nformat as defined in section 6 of IETF\u00a0RFC\u00a05905\u00a0[12].\n\n  NOTE:  The encoding is defined as the time in seconds relative to\n         00:00:00 on 1 January 1900.\n\n\n"}, {"key": "End Time", "numbering": "8.2.53", "title_level": 2, "desc": "8.2.53 End Time\n\nThe End Time IE indicates the time at which the UP function ended to\ncollect the charging information. It shall be encoded as shown in Figure\n8.2.53-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |End Time                            |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                          Figure 8.2.53-1: End Time\n\nThe End Time field shall contain a UTC time. Octets 5 to 8 shall be encoded\nin the same format as the first four octets of the 64-bit timestamp format\nas defined in section 6 of IETF\u00a0RFC\u00a05905\u00a0[12].\n\n  NOTE:  The encoding is defined as the time in seconds relative to\n         00:00:00 on 1 January 1900.\n\n\n"}, {"key": "URR ID", "numbering": "8.2.54", "title_level": 2, "desc": "8.2.54 URR ID\n\nThe URR ID IE type shall be encoded as shown in Figure 8.2.54-1. It\ncontains a Usage Reporting Rule ID.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |URR ID value                        |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                           Figure 8.2.54-1: URR ID\n\nThe URR ID value shall be encoded as an Unsigned32 binary integer value.\n\nThe bit 8 of octet 5 is used to indicate if the Rule ID is dynamically\nallocated by the CP function or predefined in the UP function. If set to 0,\nit indicates that the Rule is dynamically provisioned by the CP Function.\nIf set to 1, it indicates that the Rule is predefined in the UP Function.\n\n\n"}, {"key": "Linked URR ID IE", "numbering": "8.2.55", "title_level": 2, "desc": "8.2.55 Linked URR ID IE\n\nThe Linked URR ID IE type shall be encoded as shown in Figure 8.2.55-1. It\ncontains the URR ID of a linked URR.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Linked URR ID value                 |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                       Figure 8.2.55-1: Linked URR ID\n\nThe Linked URR ID value shall be encoded as an Unsigned32 binary integer\nvalue.\n\n\n"}, {"key": "Outer Header Creation", "numbering": "8.2.56", "title_level": 2, "desc": "8.2.56 Outer Header Creation\n\nThe Outer Header Creation IE type shall be encoded as shown in Figure\n8.2.56-1. It contains the instructions to create an Outer Header.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 6  |Outer Header Creation Description   |    |\n| |m to    |TEID                                |    |\n| |(m+3)   |                                    |    |\n| |p to    |IPv4 Address                        |    |\n| |(p+3)   |                                    |    |\n| |q to    |IPv6 Address                        |    |\n| |(q+15)  |                                    |    |\n| |r to    |Port Number                         |    |\n| |(r+1)   |                                    |    |\n| |s to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                   Figure 8.2.56-1: Outer Header Creation\n\nThe Outer Header Creation Description field, when present, shall be encoded\nas specified in Table 8.2.56-1. It takes the form of a bitmask where each\nbit indicates the outer header to be created in the outgoing packet. Spare\nbits shall be ignored by the receiver.\n\n              Table 8.2.56-1: Outer Header Creation Description\n\n|Octet / Bit    |Outer Header to be created in the outgoing packet          |\n|5/1            |GTP-U/UDP/IPv4 (see NOTE 1)                                |\n|5/2            |GTP-U/UDP/IPv6 (see NOTE 1)                                |\n|5/3            |UDP/IPv4 (see NOTE 2)                                      |\n|5/4            |UDP/IPv6 (see NOTE 2)                                      |\n|NOTE 1: The SGW-U shall also create GTP-U extension header(s) if any has  |\n|been stored for this packet, during a previous outer header removal (see  |\n|subclause 8.2.64).                                                        |\n|NOTE 2: This value may apply to UL packets sent by a PGW-U for non-IP PDN |\n|connections with SGi tunnelling based on UDP/IP encapsulation (see        |\n|subclause 4.3.17.8.3.3.2 of 3GPP\u00a0TS\u00a023.401\u00a0[14]).                         |\n\n\nAt least one bit of the Outer Header Creation Description field shall be\nset to 1. Bits 5/1 and 5/2 may both be set to 1 if an F-TEID with both an\nIPv4 and IPv6 addresses has been assigned by the GTP-U peer. In this case,\nthe UP function shall send the outgoing packet towards the IPv4 or IPv6\naddress.\n\nThe TEID field shall be present if the Outer Header Creation Description\nrequests the creation of a GTP-U header. Otherwise it shall not be present.\nWhen present, it shall contain the destination GTP-U TEID to set in the GTP-\nU header of the outgoing packet.\n\nThe IPv4 Address field shall be present if the Outer Header Creation\nDescription requests the creation of a IPv4 header. Otherwise it shall not\nbe present. When present, it shall contain the destination IPv4 address to\nset in the IPv4 header of the outgoing packet.\n\nThe IPv6 Address field shall be present if the Outer Header Creation\nDescription requests the creation of a IPv6 header. Otherwise it shall not\nbe present. When present, it shall contain the destination IPv6 address to\nset in the IPv6 header of the outgoing packet.\n\nThe Port Number field shall be present if the Outer Header Creation\nDescription requests the creation of a UDP/IP header (i.e. it is set to the\nvalue 4). Otherwise it shall not be present. When present, it shall contain\nthe destination Port Number to set in the UDP header of the outgoing\npacket.\n\n\n"}, {"key": "BAR ID", "numbering": "8.2.57", "title_level": 2, "desc": "8.2.57 BAR ID\n\nThe BAR ID IE type shall be encoded as shown in Figure 8.2.57-1. It\ncontains a Buffering Action Rule ID.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |BAR ID value                        |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                           Figure 8.2.57-1: BAR ID\n\nThe BAR ID value shall be encoded as a binary integer value.\n\n\n"}, {"key": "CP Function Features", "numbering": "8.2.58", "title_level": 2, "desc": "8.2.58 CP Function Features\n\nThe CP Function Features IE indicates the features supported by the CP\nfunction. Only features having an impact on the (system-wide) UP function\nbehaviour are signalled in this IE. It is coded as depicted in Figure\n8.2.58-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Supported-Features                  |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                    Figure 8.2.58-1: CP Function Features\n\nThe CP Function Features IE takes the form of a bitmask where each bit set\nindicates that the corresponding feature is supported. Spare bits shall be\nignored by the receiver. The same bitmask is defined for all PFCP\ninterfaces.\n\nThe following table specifies the features defined on PFCP interfaces and\nthe interfaces on which they apply.\n\n                    Table 8.2.58-1: CP Function Features\n\n|Feature Octet|Featur|Interface          |Description                       |\n|/ Bit        |e     |                   |                                  |\n|5/1          |LOAD  |Sxa, Sxb, Sxc, N4  |Load Control is supported by the  |\n|             |      |                   |CP function.                      |\n|5/2          |OVRL  |Sxa, Sxb, Sxc, N4  |Overload Control is supported by  |\n|             |      |                   |the CP function.                  |\n|Feature Octet / Bit: The octet and bit number within the                  |\n|Supported-Features IE, e.g. \"5 / 1\".                                      |\n|Feature: A short name that can be used to refer to the octet / bit and to |\n|the feature.                                                              |\n|Interface: A list of applicable interfaces to the feature.                |\n|Description: A clear textual description of the feature.                  |\n\n\n\n"}, {"key": "Usage Information", "numbering": "8.2.59", "title_level": 2, "desc": "8.2.59 Usage Information\n\nThe Usage Information IE shall be encoded as shown in Figure 8.2.59-1. It\nprovides additional information on the Usage Report.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare             |UBE|UAE|AFT |BEF |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                     Figure 8.2.59-1: Usage Information\n\nOctet 5 shall be encoded as follows:\n\n  -  Bit 1 \u2013 BEF (Before): when set to 1, this indicates usage before a\n    monitoring time.\n\n  -  Bit 2 \u2013 AFT (After): when set to 1, this indicates a usage after a\n    monitoring time.\n\n  -  Bit 3 \u2013 UAE (Usage After Enforcement): when set to 1, this indicates a\n    usage after QoS enforcement.\n\n  -  Bit 4 \u2013 UBE (Usage Before Enforcement): when set to 1, this indicates\n    a usage before QoS enforcement.\n\n  -  Bits 5 to 8: Spare, for future use and set to 0.\n\n\n"}, {"key": "Application Instance ID", "numbering": "8.2.60", "title_level": 2, "desc": "8.2.60 Application Instance ID\n\nThe Application Instance ID IE type shall be encoded as shown in Figure\n8.2.60-1. It contains an Application Instance Identifier referencing an\napplication instance for which the start or stop of traffic is reported to\nthe CP function.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to    |Application Instance Identifier     |    |\n| |(n+4)   |                                    |    |\n\n\n                  Figure 8.2.60-1: Application Instance ID\n\nThe Application Instance Identifier shall be encoded as an OctetString (see\n3GPP\u00a0TS\u00a029.212\u00a0[8]).\n\n\n"}, {"key": "Flow Information", "numbering": "8.2.61", "title_level": 2, "desc": "8.2.61 Flow Information\n\nThe Flow Information IE type shall be encoded as shown in Figure 8.2.61-1.\nIt contains the description of a flow information.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                 |Flow         |    |\n| |        |                      |Direction    |    |\n| |6 to 7  |Length of Flow Description          |    |\n| |8 to m  |Flow Description                    |    |\n| |p to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                      Figure 8.2.61-1: Flow Information\n\nThe Flow Direction field, when present, shall be encoded as defined in\nTable 8.2.61-1.\n\n                       Table 8.2.61-1: Flow Direction\n\n|Flow Direction                                      |Value      |\n|                                                    |(Decimal)  |\n|Unspecified                                         |0          |\n|Downlink (traffic to the UE)                        |1          |\n|Uplink (traffic from the UE)                        |2          |\n|Bidirectional                                       |3          |\n|For future use. Shall not be sent. If received,     |4 to 7     |\n|shall be interpreted as the value \"0\".              |           |\n\n\nThe Flow Description field, when present, shall be encoded as an\nOctetString as specified in subclause 5.4.2 of 3GPP\u00a0TS\u00a029.212\u00a0[8].\n\n\n"}, {"key": "UE IP Address", "numbering": "8.2.62", "title_level": 2, "desc": "8.2.62 UE IP Address\n\nThe UE IP Address IE type shall be encoded as shown in Figure 8.2.62-1. It\ncontains a source or destination IP address.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                 |S/D |V4  |V6  |    |\n| |m to    |IPv4 address                        |    |\n| |(m+3)   |                                    |    |\n| |p to    |IPv6 address                        |    |\n| |(p+15)  |                                    |    |\n| |k to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                       Figure 8.2.62-1: UE IP Address\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 V6: If this bit is set to \"1\", then the IPv6 address field\n    shall be present in the UE IP Address, otherwise the IPv6 address field\n    shall not be present.\n\n  -  Bit 2 \u2013 V4: If this bit is set to \"1\", then the IPv4 address field\n    shall be present in the UE IP Address, otherwise the IPv4 address field\n    shall not be present.\n\n  -  Bit 3 \u2013 S/D: This bit is only applicable to the UE IP Address IE in\n    the PDI IE. It shall be set to \"0\" and ignored by the receiver in IEs\n    other than PDI IE. In the PDI IE, if this bit is set to \"0\", this\n    indicates a Source IP address; if this bit is set to \"1\", this\n    indicates a Destination IP address.\n\n  -  Bit 4 to 8 Spare, for future use and set to 0.\n\nOctets \"m to (m+3)\" or \"p to (p+15)\" (IPv4 address / IPv6 address fields),\nif present, shall contain the address value.\n\n\n"}, {"key": "Packet Rate", "numbering": "8.2.63", "title_level": 2, "desc": "8.2.63 Packet Rate\n\nThe Packet Rate IE contains the packet rate thresholds to be enforced by\nthe UP function. It shall be encoded as shown in Figure 8.2.63-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                      |DLPR|ULPR|    |\n| |m       |Spare                 |Uplink Time  |    |\n| |        |                      |Unit         |    |\n| |(m+1) to|Maximum Uplink Packet Rate          |    |\n| |(m+2)   |                                    |    |\n| |p       |Spare                 |Downlink Time|    |\n| |        |                      |Unit         |    |\n| |(p+1) to|Maximum Downlink Packet Rate        |    |\n| |(p+2)   |                                    |    |\n| |q to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                        Figure 8.2.63-1: Packet Rate\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 ULPR (Uplink Packet Rate): If this bit is set to \"1\", then\n    octets m to (m+2) shall be present, otherwise these octets shall not be\n    present.\n\n  -  Bit 2 \u2013 DLPR (Downlink Packet Rate): If this bit is set to \"1\", then\n    octets p to (p+2) shall be present, otherwise these octets shall not be\n    present.\n\n  -  Bit 3 to 8: Spare, for future use and set to 0.\n\nAt least one bit in Octet 5 shall be set to 1. Several bits may be set to\n1.\n\nWhen present, octets m to (m+2) indicate the maximum number of uplink\npackets allowed to be sent within the uplink time unit.\n\nWhen present, octets p to (p+2) indicate the maximum number of downlink\npackets allowed to be sent within the downlink time unit.\n\n                  Table 8.2.63.1: Uplink/Downlink Time Unit\n\n|Uplink/Downlink Time unit                           |\n|Bits 1 to 3 define the time unit as follows:        |\n|Bits                                                |\n|3 2 1                                               |\n|0 0 0  minute                                       |\n|0 0 1  6 minutes                                    |\n|0 1 0  hour                                         |\n|0 1 1  day                                          |\n|1 0 0  week                                         |\n|                                                    |\n|Other values shall be interpreted as 000 in this    |\n|version of the protocol.                            |\n\n\nThe Maximum Uplink/Downlink Packet Rate shall be encoded as an Unsigned16\nbinary integer value. They shall indicate the maximum number of\nuplink/downlink packets allowed to be sent in the indicated uplink/downlink\ntime unit respectively.\n\n\n"}, {"key": "Outer Header Removal", "numbering": "8.2.64", "title_level": 2, "desc": "8.2.64 Outer Header Removal\n\nThe Outer Header Removal IE type shall be encoded as shown in Figure 8.2.64-\n1. It contains the instructions to remove an Outer Header.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Outer Header Removal Description    |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                    Figure 8.2.64-1: Outer Header Removal\n\nThe Outer Header Removal Description field, when present, shall be encoded\nas specified in Table 8.2.64-1.\n\n              Table 8.2.64-1: Outer Header Removal Description\n\n|Outer Header to be removed from the incoming packet |Value      |\n|                                                    |(Decimal)  |\n|GTP-U/UDP/IPv4 (see NOTE 1)                         |0          |\n|GTP-U/UDP/IPv6 (see NOTE 1)                         |1          |\n|UDP/IPv4 (See NOTE 3)                               |2          |\n|UDP/IPv6 (See NOTE 3)                               |3          |\n|For future use. Shall not be sent. If received,     |4 to 255   |\n|shall be interpreted as the value \"1\".              |           |\n|NOTE 1: The SGW-U shall store GTP-U extension header(s) required|\n|to be forwarded for this packet (as required by the             |\n|comprehension rules of Figure 5.2.1-2 of 3GPP TS 29.281 [3]).   |\n|NOTE 3: This value may apply to DL packets received by a PGW-U  |\n|for non-IP PDN connections with SGi tunnelling based on UDP/IP  |\n|encapsulation (see subclause 4.3.17.8.3.3.2 of                  |\n|3GPP\u00a0TS\u00a023.401\u00a0[14]).                                           |\n\n\n\n"}, {"key": "Recovery Time Stamp", "numbering": "8.2.65", "title_level": 2, "desc": "8.2.65 Recovery Time Stamp\n\nThe Recovery Time Stamp IE is coded as shown in Figure 8.2.65-1. It\nindicates the UTC time when the node started. Octets 5 to 8 are encoded in\nthe same format as the first four octets of the 64-bit timestamp format as\ndefined in section 6 of IETF\u00a0RFC\u00a05905\u00a0[26].\n\n  NOTE:  The encoding is defined as the time in seconds relative to\n         00:00:00 on 1 January 1900.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Recovery Time Stamp value           |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                    Figure 8.2.65-1: Recovery Time Stamp\n\n\n"}, {"key": "DL Flow Level Marking", "numbering": "8.2.66", "title_level": 2, "desc": "8.2.66 DL Flow Level Marking\n\nThe DL Flow Level Marking IE type shall be encoded as shown in Figure\n8.2.66-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                      |SCI |TTC |    |\n| |m to    |ToS/Traffic Class                   |    |\n| |(m+1)   |                                    |    |\n| |p to    |Service Class Indicator             |    |\n| |(p+1)   |                                    |    |\n| |q to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                   Figure 8.2.66-1: DL Flow Level Marking\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 TTC (ToS/Traffic Class): If this bit is set to \"1\", then the\n    ToS/Traffic Class field shall be present, otherwise the ToS/Traffic\n    Class field shall not be present.\n\n  -  Bit 2 \u2013 SCI (Service Class Indicator): If this bit is set to \"1\", then\n    the Service Class Indicator field shall be present, otherwise the\n    Service Class Indicator field shall not be present.\n\n  -  Bit 3 to 8: Spare, for future use and set to 0.\n\nThe ToS/Traffic Class field, when present, shall be encoded on two octets\nas an OctetString. The first octet shall contain the IPv4 Type-of-Service\nor the IPv6 Traffic-Class field and the second octet shall contain the\nToS/Traffic Class mask field. See subclause 5.3.15 of 3GPP\u00a0TS\u00a029.212\u00a0[8].\n\nOctets p and (p+1) of the Service Class Indicator field, when present,\nshall be encoded respectively as octets 2 and 3 of the Service Class\nIndicator Extension Header specified in Figure 5.2.2.3-1 of\n3GPP\u00a0TS\u00a029.281\u00a0[3].\n\n\n"}, {"key": "Header Enrichment", "numbering": "8.2.67", "title_level": 2, "desc": "8.2.67 Header Enrichment\n\nThe Header Enrichment IE type shall be encoded as shown in Figure 8.2.67-1.\nIt contains information for header enrichment.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare        |Header Type           |    |\n| |6       |Length of Header Field Name         |    |\n| |7 to m  |Header Field Name                   |    |\n| |p       |Length of Header Field Value        |    |\n| |(p+1) to|Header Field Value                  |    |\n| |q       |                                    |    |\n| |s to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                     Figure 8.2.67-1: Header Enrichment\n\nHeader Type indicates the type of the Header. It shall be encoded as\ndefined in Table 8.2.67-1.\n\n                         Table 8.2.67-1: Header Type\n\n|Header Type                  |Value      |\n|                             |(Decimal)  |\n|HTTP                         |0          |\n|Spare, for future use.       |1 to 31    |\n\n\nLength of Header Field Name indicates the length of the Header Field Name.\n\nHeader Field Name shall be encoded as an OctetString.\n\nLength of Header Field Value indicates the length of the Header Field\nValue.\n\nHeader Field Value shall be encoded as an OctetString.\n\nFor a HTTP Header Type, the contents of the Header Field Name and Header\nField Value shall comply with the HTTP header field format (see subclause\n3.2 of IETF\u00a0RFC\u00a07230\u00a0[23]).\n\n\n"}, {"key": "Measurement Information", "numbering": "8.2.68", "title_level": 2, "desc": "8.2.68 Measurement Information\n\nThe Measurement Information IE shall be encoded as shown in Figure 8.2.68-\n1. It provides information on the requested measurement information.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                 |RADI|INA|MBQE|    |\n| |        |                      |    |M  |    |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                  Figure 8.2.68-1: Measurement Information\n\nOctet 5 shall be encoded as follows:\n\n  -  Bit 1 \u2013 MBQE (Measurement Before QoS Enforcement): when set to 1, this\n    indicates a request to measure the traffic usage before QoS\n    enforcement.\n\n  -  Bit 2 \u2013 INAM (Inactive Measurement): when set to 1, this indicates\n    that the measurement shall be paused (inactive).\n\n  -  Bit 3 \u2013 RADI (Reduced Application Detection Information): when set to\n    1, this indicates that the Application Detection Information reported\n    to the CP function, upon detecting the start or stop of an application,\n    shall only contain the Application ID.\n\n  -  Bits 4 to 8: Spare, for future use and set to 0.\n\n\n"}, {"key": "Node Report Type", "numbering": "8.2.69", "title_level": 2, "desc": "8.2.69 Node Report Type\n\nThe Node Report Type IE shall be encoded as shown in Figure 8.2.69-1. It\nindicates the type of the node report the UP function sends to the CP\nfunction.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                          |UPFR|    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                      Figure 8.2.69-1: Node Report Type\n\nOctet 5 shall be encoded as follows:\n\n  -  Bit 1 \u2013 UPFR (User Plane Path Failure Report): when set to 1, this\n    indicates a User Plane Path Failure Report.\n\n  -  Bit 2 to 8 \u2013 Spare, for future use and set to 0.\n\n  At least one bit shall be set to 1. Several bits may be set to 1.\n\n\n"}, {"key": "Remote GTP-U Peer", "numbering": "8.2.70", "title_level": 2, "desc": "8.2.70 Remote GTP-U Peer\n\nThe Remote GTP-U Peer IE shall be encoded as depicted in Figure 8.2.70-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                      |V4  |V6  |    |\n| |m to    |IPv4 address                        |    |\n| |(m+3)   |                                    |    |\n| |p to    |IPv6 address                        |    |\n| |(p+15)  |                                    |    |\n| |k to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                     Figure 8.2.70-1: Remote GTP-U Peer\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 V6: If this bit is set to \"1\", then the IPv6 address field\n    shall be present, otherwise the IPv6 address field shall not be\n    present.\n\n  -  Bit 2 \u2013 V4: If this bit is set to \"1\", then the IPv4 address field\n    shall be present, otherwise the IPv4 address field shall not be\n    present.\n\n  -  Bit 3 to 8 - Spare, for future use and set to 0.\n\nEither the V4 or the V6 bit shall be set to \"1\".\n\nOctets \"m to (m+3)\" and/or \"p to (p+15)\" (IPv4 address / IPv6 address\nfields), if present, shall contain the respective address values.\n\n\n"}, {"key": "UR-SEQN", "numbering": "8.2.71", "title_level": 2, "desc": "8.2.71 UR-SEQN\n\nThe UR-SEQN (Usage Report Sequence Number) IE identifies the order in which\na usage report is generated for a given URR. It shall be encoded as shown\nin Figure 8.2.71-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |UR-SEQN                             |    |\n\n\n                          Figure 8.2.71-1: UR-SEQN\n\nThe UR-SEQN value shall be encoded as an Unsigned32 binary integer value.\n\n\n"}, {"key": "Activate Predefined Rules", "numbering": "8.2.72", "title_level": 2, "desc": "8.2.72 Activate Predefined Rules\n\nThe Activate Predefined Rules IE type shall be coded as shown in Figure\n8.2.72-1. It shall indicate a Predefined Rules Name, referring to one or\nmore predefined rules which need to be activated in the UP function.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to    |Predefined Rules Name               |    |\n| |(n+4)   |                                    |    |\n\n\n                 Figure 8.2.72-1: Activate Predefined Rules\n\nThe Predefined Rules Name field shall be encoded as an OctetString.\n\n\n"}, {"key": "Deactivate Predefined Rules", "numbering": "8.2.73", "title_level": 2, "desc": "8.2.73 Deactivate Predefined Rules\n\nThe Deactivate Predefined Rules IE type shall be coded as shown in Figure\n8.2.73-1. It shall indicate a Predefined Rules Name, referring to one or\nmore predefined rules which need to be deactivated in the UP function.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to    |Predefined Rules Name               |    |\n| |(n+4)   |                                    |    |\n\n\n                Figure 8.2.73-1: Deactivate Predefined Rules\n\nThe Predefined Rules Name field shall be encoded as an OctetString.\n\n\n"}, {"key": "FAR ID", "numbering": "8.2.74", "title_level": 2, "desc": "8.2.74 FAR ID\n\nThe FAR ID IE type shall be encoded as shown in Figure 8.2.74-1. It shall\ncontain a Forwarding Action Rule ID.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |FAR ID value                        |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                           Figure 8.2.74-1: FAR ID\n\nThe FAR ID value shall be encoded as an Unsigned32 binary integer value.\n\nThe bit 8 of octet 5 is used to indicate if the Rule ID is dynamically\nallocated by the CP function or predefined in the UP function. If set to 0,\nit indicates that the Rule is dynamically provisioned by the CP Function.\nIf set to 1, it indicates that the Rule is predefined in the UP Function.\n\n\n"}, {"key": "QER ID", "numbering": "8.2.75", "title_level": 2, "desc": "8.2.75 QER ID\n\nThe QER ID IE type shall be encoded as shown in Figure 8.2.75-1. It shall\ncontain a QoS Enforcement Rule ID.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |QER ID value                        |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                           Figure 8.2.75-1: QER ID\n\nThe QER ID value shall be encoded as an Unsigned32 binary integer value.\n\nThe bit 8 of octet 5 is used to indicate if the Rule ID is dynamically\nallocated by the CP function or predefined in the UP function. If set to 0,\nit indicates that the Rule is dynamically provisioned by the CP Function.\nIf set to 1, it indicates that the Rule is predefined in the UP Function.\n\n\n"}, {"key": "OCI Flags", "numbering": "8.2.76", "title_level": 2, "desc": "8.2.76 OCI Flags\n\nThe OCI Flags IE shall contain the flags for overload control related\ninformation. It shall be encoded as shown in Figure 8.2.76-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                          |AOCI|    |\n| |s to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                         Figure 8.2.76-1: OCI Flags\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 AOCI: Associate OCI with Node ID: The UP function shall set\n    this flag to 1 if it has included the \"Overload Control Information\"\n    and if this information is to be associated with the Node ID (i.e. FQDN\n    or the IP address used during the UP function selection) of the serving\n    UP function. This flag shall be set to 1 by the UP function, if the\n    \"Overload Control Information\" is included in the PFCP Session\n    Establishment Response and the Cause IE is set to a rejection cause\n    value.\n\n  -  Bit 2 to 8: Spare, for future use and set to 0.\n\n\n"}, {"key": "PFCP Association Release Request", "numbering": "8.2.77", "title_level": 2, "desc": "8.2.77 PFCP Association Release Request\n\nThe PFCP Association Release Request IE shall be encoded as shown in Figure\n8.2.77-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                          |SARR|    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n              Figure 8.2.77-1: PFCP Association Release Request\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 SARR (PFCP Association Release Request): If this bit is set to\n    \"1\", then the UP function requests the release of the PFCP association.\n\n  -  Bit 2 to 8: Spare, for future use and set to 0.\n\n\n"}, {"key": "Graceful Release Period", "numbering": "8.2.78", "title_level": 2, "desc": "8.2.78 Graceful Release Period\n\nThe purpose of the Graceful Release Period IE is to specify a specific time\nfor a graceful release. The Graceful Release Period IE shall be encoded as\nshown in Figure 8.2.78-1 and table 8.2.78.1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Timer unit   |Timer value           |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                  Figure 8.2.78-1: Graceful Release Period\n\n         Table 8.2.78.1: Graceful Release Period information element\n\n|Timer value                                         |\n|Bits 5 to 1 represent the binary coded timer value. |\n|                                                    |\n|Timer unit                                          |\n|Bits 6 to 8 defines the timer value unit for the    |\n|timer as follows:                                   |\n|Bits                                                |\n|8 7 6                                               |\n|0 0 0  value is incremented in multiples of 2       |\n|seconds                                             |\n|0 0 1  value is incremented in multiples of 1 minute|\n|                                                    |\n|0 1 0  value is incremented in multiples of 10      |\n|minutes                                             |\n|0 1 1  value is incremented in multiples of 1 hour  |\n|1 0 0  value is incremented in multiples of 10 hours|\n|1 1 1  value indicates that the timer is infinite   |\n|                                                    |\n|Other values shall be interpreted as multiples of 1 |\n|minute in this version of the protocol.             |\n|                                                    |\n|Timer unit and Timer value both set to all \"zeros\"  |\n|shall be interpreted as an indication that the timer|\n|is stopped.                                         |\n\n\n\n"}, {"key": "PDN Type", "numbering": "8.2.79", "title_level": 2, "desc": "8.2.79 PDN Type\n\nThe PDN Type IE shall be encoded as shown in Figure 8.2.79-1. It indicates\nthe type of a PDN connection (IP, Ethernet or Unstructured).\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                 |PDN Type     |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                          Figure 8.2.79-1: PDN Type\n\n                          Table 8.2.79-1: PDN Type\n\n|PDN Type                                            |Value      |\n|                                                    |(Decimal)  |\n|IPv4                                                |1          |\n|IPv6                                                |2          |\n|IPv4v6                                              |3          |\n|Non-IP                                              |4          |\n|Ethernet                                            |5          |\n|For future use. Shall not be sent.                  |0, 6, 7    |\n\n\n\n"}, {"key": "Failed Rule ID", "numbering": "8.2.80", "title_level": 2, "desc": "8.2.80 Failed Rule ID\n\nThe Failed Rule ID IE type shall be encoded as shown in Figure 8.2.80-1. It\nshall identify the Rule which failed to be created or modified.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare        |Rule ID Type          |    |\n| |6 to p  |Rule ID value                       |    |\n| |(p+1) to|These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                       Figure 8.2.80-1: Failed Rule ID\n\nThe Rule ID Type shall be encoded as a 5 bits binary integer value as\nspecified in Table 8.2.80-1.\n\n                        Table 8.2.80-1: Rule ID Type\n\n|Rule ID Type                               |Value      |\n|                                           |(Decimal)  |\n|PDR                                        |0          |\n|FAR                                        |1          |\n|QER                                        |2          |\n|URR                                        |3          |\n|BAR                                        |4          |\n|For future use. Shall not be sent. If      |5 to 31    |\n|received, shall be interpreted as the value|           |\n|\"1\".                                       |           |\n\n\nThe length and the value of the Rule ID value field shall be set as\nspecified for the PDR ID, FAR ID, QER ID, URR ID and BAR ID IE types\nrespectively.\n\n\n"}, {"key": "Time Quota Mechanism", "numbering": "8.2.81", "title_level": 2, "desc": "8.2.81 Time Quota Mechanism\n\nThe Time Quota Mechanism type shall be encoded as shown in Figure 8.2.81-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                      |BTIT    |    |\n| |m to    |Base Time Interval                  |    |\n| |(m+3)   |                                    |    |\n| |w to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                    Figure 8.2.81-1: Time Quota Mechanism\n\nBTIT (Base Time Interval Type) indicates the type of the interval to be\nprovided in the Base Time Interval field.\n\n                   Table 8.2.81-1: Base Time Interval Type\n\n|Base Time Interval Type      |Value      |\n|                             |(Decimal)  |\n|CTP                          |0          |\n|DTP                          |1          |\n|Spare, for future use.       |2 to 3     |\n\n\nThe Base Time Interval, shall be encoded as Unsigned32 as specified in\nsubclause\u00a07.2.29 of 3GPP\u00a0TS\u00a032.299\u00a0[18].\n\n\n"}, {"key": "User Plane IP Resource Information", "numbering": "8.2.82", "title_level": 2, "desc": "8.2.82 User Plane IP Resource Information\n\nThe User Plane IP Resource Information IE type shall be encoded as shown in\nFigure 8.2.82-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                               |ASSO|\n| |        |                                    |SI  |\n| |m to    |IPv4 address                        |    |\n| |(m+3)   |                                    |    |\n| |p to    |IPv6 address                        |    |\n| |(p+15)  |                                    |    |\n| |k to l  |Network Instance                    |    |\n| |r       |Spare            |Source Interface |    |\n| |s to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n             Figure 8.2.82-1: User Plane IP Resource Information\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 V4: If this bit is set to \"1\", then the IPv4 address field\n    shall be present, otherwise the IPv4 address field shall not be\n    present.\n\n  -  Bit 2 \u2013 V6: If this bit is set to \"1\", then the IPv6 address field\n    shall be present, otherwise the IPv6 address field shall not be\n    present.\n\n  -  Bit 3-5 \u2013 TEID Range Indication (TEIDRI): the value of this field\n    indicates the number of bits in the most significant octet of a TEID\n    that are used to partition the TEID range, e.g. if this field is set to\n    \"4\", then the first 4 bits in the TEID are used to partition the TEID\n    range.\n\n  -  Bit 6 \u2013 Associated Network Instance (ASSONI): if this bit is set to\n    \"1\", then the Network Instance field shall be present, otherwise the\n    Network Instance field shall not be present.\n\n  -  Bit 7 \u2013 Associated Source Interface (ASSOSI): if this bit is set to\n    \"1\", then the Source Interface field shall be present, otherwise the\n    Source Interface field shall not be present.\n\n  -  Bit 8: Spare, for future use and set to 0.\n\nAt least one of the V4 and V6 flags shall be set to \"1\", and both may be\nset to \"1\".\n\nIf both the ASSONI and ASSOSI flags are set to \"0\", this shall indicate\nthat the User Plane IP Resource Information provided can be used by CP\nfunction for any Network Instance and any Source Interface of GTP-U user\nplane in the UP function.\n\nOctet 6 (TEID Range) shall be present if the TEID Range Indication is not\nset to zero and shall contain a value of the bits which are used to\npartition the TEID range. E.g. if the TEID Range Indication is set to \"4\",\nthen Octet 6 shall be one of values between 0 and 15. When TEID Range\nIndication is set to zero, the Octet 6 shall not be present, the TEID is\nnot partitioned, i.e. all TEID values are available for use by the CP\nfunction.\n\nOctets \"m to (m+3)\" and/or \"p to (p+15)\" (IPv4 address / IPv6 address\nfields), if present, shall contain the respective IP address values.\n\nOctets \"k to l\", if present, shall contain a Network Instance value as\nencoded in octet \"5 to n+4\" of the Figure 8.2.4-1 in subclause 8.2.4,\nidentifying a Network Instance with which the IP address or TEID Range is\nassociated.\n\nOctet r, if present, shall contain a Source Interface value as encoded in\noctet 5 of the Figure 8.2.2-1 in subclause 8.2.2, identifying the Source\nInterface with which the IP address or TEID Range is associated.\n\n\n\n\n"}, {"key": "User Plane Inactivity Timer", "numbering": "8.2.83", "title_level": 2, "desc": "8.2.83 User Plane Inactivity Timer\n\nThe User Plane Inactivity Timer IE contains the inactivity time period, in\nseconds, to be monitored by the UP function. It shall be encoded as shown\nin Figure 8.2.83-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |User Plane Inactivity Timer         |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                Figure 8.2.83-1: User Plane Inactivity Timer\n\nThe User Plane Inactivity Timer field shall be encoded as an Unsigned32\nbinary integer value. The timer value \"0\" shall be interpreted as an\nindication that user plane inactivity detection and reporting is stopped.\n\n\n"}, {"key": "Multiplier", "numbering": "8.2.84", "title_level": 2, "desc": "8.2.84 Multiplier\n\nThe Multiplier IE type shall be encoded as shown in Figure 8.2.84-1. It\ncontains a Multiplier (see IETF\u00a0RFC\u00a04006\u00a0[16]) to measure the abstract\nservice units the traffic of an aggregated URR consumes from the credit\npool.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = 12                         |    |\n| |5 to 12 |Value-Digits                        |    |\n| |12 to 15|Exponent                            |    |\n\n\n                         Figure 8.2.84-1: Multiplier\n\nThe Value-Digit value and Exponent value shall be encoded as binary integer\nvalue, and set the value as in Value-Digit AVP and Exponent AVP as\nspecified in 3GPP\u00a0TS\u00a032.299 [18].\n\n\n"}, {"key": "Aggregated URR ID IE", "numbering": "8.2.85", "title_level": 2, "desc": "8.2.85 Aggregated URR ID IE\n\nThe Aggregated URR ID IE type shall be encoded as shown in Figure 8.2.85-1.\nIt contains a URR ID.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = 4                          |    |\n| |5 to 8  |URR ID value                        |    |\n\n\n                      Figure 8.2.y-1: Aggregated URR ID\n\nEach URR ID value shall be encoded as an Unsigned32 binary integer value.\n\n\n"}, {"key": "Subsequent Volume Quota", "numbering": "8.2.86", "title_level": 2, "desc": "8.2.86 Subsequent Volume Quota\n\nThe Subsequent Volume Quota IE type shall be encoded as shown in Figure\n8.2.86-1. It contains the volume quota to be monitored by the UP function\nafter the Monitoring Time.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                 |DLVO|ULVO|TOVO|    |\n| |        |                      |L   |L   |L   |    |\n| |m to    |Total Volume                        |    |\n| |(m+7)   |                                    |    |\n| |p to    |Uplink Volume                       |    |\n| |(p+7)   |                                    |    |\n| |q to    |Downlink Volume                     |    |\n| |(q+7)   |                                    |    |\n| |S to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                  Figure 8.2.86-1: Subsequent Volume Quota\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 TOVOL: If this bit is set to \"1\", then the Total Volume field\n    shall be present, otherwise the Total Volume field shall not be\n    present.\n\n  -  Bit 2 \u2013 ULVOL: If this bit is set to \"1\", then the Uplink Volume field\n    shall be present, otherwise the Uplink Volume field shall not be\n    present.\n\n  -  Bit 3 \u2013 DLVOL: If this bit is set to \"1\", then the Downlink Volume\n    field shall be present, otherwise the Downlink Volume field shall not\n    be present.\n\n  -  Bit 4 to bit 8: Spare, for future use and set to 0.\n\nAt least one bit shall be set to 1. Several bits may be set to 1.\n\nThe Total Volume, Uplink Volume and Downlink Volume fields shall be encoded\nas an Unsigned64 binary integer value. They shall contain the total, uplink\nor downlink number of octets respectively.\n\n\n"}, {"key": "Subsequent Time Quota", "numbering": "8.2.87", "title_level": 2, "desc": "8.2.87 Subsequent Time Quota\n\nThe Subsequent Time Quota IE type shall be encoded as shown in Figure\n8.2.87-1. It contains the time quota to be monitored by the UP function\nafter the Monitoring Time.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Time Quota value                    |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                   Figure 8.2.87-1: Subsequent Time Quota\n\nThe Time Quota value shall be encoded as an Unsigned32 binary integer\nvalue. It contains a duration in seconds.\n\n\n"}, {"key": "RQI", "numbering": "8.2.88", "title_level": 2, "desc": "8.2.88 RQI\n\nThe RQI IE shall be encoded as shown in Figure 8.2.88-1. It indicates if\nReflective QoS applies for the UL.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                          |RQI |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                            Figure 8.2.88-1: RQI\n\nThe value of RQI flag shall be set as specified in clause 5.5.3.4 of\n3GPP\u00a0TS\u00a038.415\u00a0[34].\n\n\n"}, {"key": "QFI", "numbering": "8.2.89", "title_level": 2, "desc": "8.2.89 QFI\n\nThe QFI IE type shall be encoded as shown in Figure 8.2.89-1. It contains\nan QoS flow identifier identifying a QoS flow in a 5G system filter.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to (m)|QFI value                           |    |\n| |p to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                            Figure 8.2.89-1: QFI\n\n\n The QFI value shall be encoded as binary integer value, as specified in\n         clause 5.5.3.3 of 3GPP\u00a0TS\u00a038.415\u00a0[34].8.2.90 Query URR Reference\n\nThe Query URR Reference IE type shall be encoded as shown in Figure 8.2.90-\n1. It shall contain the reference of a query request for URR(s).\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Query URR Reference value           |    |\n| |9 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                    Figure 8.2.90-1: Query URR Reference\n\nThe Query URR Reference value shall be encoded as an Unsigned32 binary\ninteger value.\n\n\n"}, {"key": "Additional Usage Reports Information", "numbering": "8.2.91", "title_level": 2, "desc": "8.2.91 Additional Usage Reports Information\n\nThe Number of Additional Usage Reports IE type shall be encoded as shown in\nFigure 8.2.91-1. It shall either indicate that additional usage reports\nwill follow, or contain the number of usage reports which need to be sent\nin additional PFCP Session Report Request messages, in response to a PFCP\nSession Modification Request querying URR(s).\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |AURI|Number of Additional Usage     |    |\n| |        |    |Reports value                  |    |\n| |6       |Number of Additional Usage Reports  |    |\n| |        |value                               |    |\n| |7 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n            Figure 8.2.y-1: Additional Usage Reports Information\n\nThe Number of Additional Usage Reports value shall be encoded as an\nunsigned binary integer value on 15 bits. Bit 7 of Octet 5 is the most\nsignificant bit and bit 1 of Octet 6 is the least significant bit.\n\nThe bit 8 of octet 5 shall encode the AURI (Additional Usage Reports\nIndication) flag:\n\n  -  when set to 1, it indicates that additional usage reports will follow.\n    In this case, the Number of Additional Usage Reports value shall be set\n    to 0 by the sender and ignored by the receiver;\n\n  -  when set to 0, the Number of Additional Usage Reports value shall be\n    set to the total number of additional usage reports to be sent in PFCP\n    Session Report Request messages.\n\n\n"}, {"key": "Traffic Endpoint ID", "numbering": "8.2.92", "title_level": 2, "desc": "8.2.92 Traffic Endpoint ID\n\nThe Traffic Endpoint ID IE type shall be encoded as shown in Figure 8.2.92-\n1. It shall contain a Traffic Endpoint ID.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Traffic Endpoint ID value           |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                    Figure 8.2.92-1: Traffic Endpoint ID\n\nThe Traffic Endpoint ID value shall be encoded as a binary integer value\nwithin the range of 0 to 255.\n\n\n"}, {"key": "MAC address", "numbering": "8.2.93", "title_level": 2, "desc": "8.2.93 MAC address\n\nThe MAC address IE shall be encoded as shown in Figure 8.2.93-1. It shall\ncontain a MAC address value.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |spare             |UDE|USO|DES|SOU|    |\n| |        |                  |S  |U  |T  |R  |    |\n| |m to    |Source MAC address value            |    |\n| |(m+5)   |                                    |    |\n| |n to    |Destination MAC address value       |    |\n| |(n+5)   |                                    |    |\n| |o to    |Upper Source MAC address value      |    |\n| |(o+5)   |                                    |    |\n| |p to    |Upper Destination MAC address value |    |\n| |(p+5)   |                                    |    |\n| |s to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                        Figure 8.2.93-1: MAC address\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 SOUR (Source): If this bit is set to \"1\", then the source MAC\n    address value is provided.\n\n  -  Bit 2 \u2013 DEST (Destination): If this bit is set to \"1\", then the\n    destination MAC address value is provided.\n\n  -  Bit 3 \u2013 USOU (Source): If this bit is set to \"1\", then the source MAC\n    address value contains the lower value and Upper Source MAC address\n    value contains the upper value of an MAC address range.\n\n  -  Bit 4 \u2013 UDES (Destination): If this bit is set to \"1\", then the\n    destination MAC address value contains the lower value and Upper\n    Destination MAC address value contains the upper value of an MAC\n    address range.- Bit 5 to 8: Spare, for future use and set to 0.\n\nOctets \"m to (m+5)\" or \"n to (n+5)\" and \"o to (o+5)\" or \"p to (p+5)\", if\npresent, shall contain a MAC address value (12-digit\u00a0hexadecimal numbers).\n\n\n"}, {"key": "C-TAG (Customer-VLAN tag)", "numbering": "8.2.94", "title_level": 2, "desc": "8.2.94 C-TAG (Customer-VLAN tag)\n\nThe C-TAG IE shall be encoded as shown in Figure 8.2.94-1. It shall contain\nthe Customer-VLAN tag (C-TAG) as defined in IEEE\u00a0802.1Q\u00a0[30].\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                  |VID|DEI|PCP|    |\n| |6       |C-VID value       |DEI|PCP value   |    |\n| |        |                  |Fla|            |    |\n| |        |                  |g  |            |    |\n| |7       |C-VID Value                         |    |\n| |8 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                 Figure 8.2.94-1: C-TAG (Customer-VLAN tag)\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 PCP: If this bit is set to \"1\", then PCP Value field shall\n    used by the receiver, otherwise the PCP Value field shall be ignored.\n\n  -  Bit 2 \u2013 DEI: If this bit is set to \"1\", then DEI flag field shall used\n    by the receiver, otherwise the DEI flag field shall be ignored.\n\n  -  Bit 3 \u2013 VID: If this bit is set to \"1\", then C-VID value field shall\n    used by the receiver, otherwise the VID Value field shall be ignored.\n\n  -  Bit 4 to 8 \u2013 spare and reserved for future use.\n\nThe PCP value, DEI flag and C-VID Value shall follow the encoded as\nspecified in IEEE\u00a0802.1Q\u00a0[30] tag format.\n\n\n"}, {"key": "S-TAG (Service-VLAN tag)", "numbering": "8.2.95", "title_level": 2, "desc": "8.2.95 S-TAG (Service-VLAN tag)\n\nThe S-TAG IE type shall be encoded as shown in Figure 8.2.95-1. It shall\ncontain Service-VLAN tag (S-TAG) as defined in IEEE\u00a0802.1Q\u00a0[30]\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                  |VID|DEI|PCP|    |\n| |6       |S-VID value       |DEI|PCP value   |    |\n| |        |                  |Fla|            |    |\n| |        |                  |g  |            |    |\n| |7       |S-VID value                         |    |\n| |8 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                  Figure 8.2.95-1: S-TAG (Service-VLAN tag)\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 PCP: If this bit is set to \"1\", then PCP Value field shall\n    used by the receiver, otherwise the PCP Value field shall be ignored.\n\n  -  Bit 2 \u2013 DEI: If this bit is set to \"1\", then DEI flag field shall used\n    by the receiver, otherwise the DEI flag field shall be ignored.\n\n  -  Bit 3 \u2013 VID: If this bit is set to \"1\", then VID value field shall\n    used by the receiver, otherwise the VID Value field shall be ignored.\n\n  -  Bit 4 to 8 \u2013 spare and reserved for future use.\n\nThe PCP value, DEI flag and V-VID Value shall follow the encoded as\nspecified in IEEE\u00a0802.1Q\u00a0[30] tag format.\n\n\n"}, {"key": "Ethertype", "numbering": "8.2.96", "title_level": 2, "desc": "8.2.96 Ethertype\n\nThe Ethertype IE type shall be encoded as shown in Figure 8.2.96-1. It\ncontains an Ethertype as defined in IEEE\u00a0802.3\u00a0[31].\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 6  |Ethertype                           |    |\n| |7 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                         Figure 8.2.u-1: Ethernetype\n\n\n"}, {"key": "Proxying", "numbering": "8.2.97", "title_level": 2, "desc": "8.2.97 Proxying\n\nThe Proxying IE shall be encoded as shown in Figure 8.2.97-1. It specifies\nif proxying as specified in IETF\u00a0RFC\u00a01027\u00a0[32] and / or IPv6 Neighbour\nSolicitation Proxying as specified in IETF\u00a0RFC\u00a04861\u00a0[33] functionality for\nthe Ethernet PDUs is performed in UPF.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                      |INS|ARP|    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                          Figure 8.2.97-1: Proxying\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 ARP: If this bit is set to \"1\", then ARP proxying is performed\n    in UPF.\n\n  -  Bit 2 \u2013 INS: If this bit is set to \"1\", then IPv6 Neighbour\n    Solicitation proxying is performed in UPF.\n\n  -  Bit 3 to 8 \u2013 spare and reserved for future use.\n\n\n"}, {"key": "Ethernet Filter ID", "numbering": "8.2.98", "title_level": 2, "desc": "8.2.98 Ethernet Filter ID\n\nThe Ethernet Filter ID IE type shall be encoded as shown in Figure 8.2.98-\n1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5 to 8  |Ethernet Filter ID value            |    |\n| |10 to   |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                     Figure 8.2.98-1: Ethernet Filter ID\n\n\n\nThe Ethernet Filter ID value shall be encoded as an Unsigned32 binary\ninteger value.\n\n\n"}, {"key": "Ethernet Filter Properties", "numbering": "8.2.99", "title_level": 2, "desc": "8.2.99 Ethernet Filter Properties\n\nThe Ethernet Filter Properties IE type shall be encoded as shown in Figure\n8.2.99-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                          |BIDE|    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                 Figure 8.2.99-1: Ethernet Filter Properties\n\n\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 BIDE (Bidirectional Ethernet Filter): If this bit is set to\n    \"1\", then the Ethernet Filter identified by the Ethernet Filter ID is\n    bidirectional.\n\n  -  Bit 2 to 8 \u2013 spare and reserved for future use.\n\n\n"}, {"key": "Suggested Buffering Packets Count", "numbering": "8.2.100", "title_level": 2, "desc": "8.2.100  Suggested Buffering Packets Count\n\nThe Suggested Buffering Packets Count IE indicates the number of packets\n(including both UL and DL packets) that are suggested to be buffered by the\nUP function while waiting for the new instruction from the CP function. It\nis coded as depicted in Figure 8.2.100-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Packet count value                  |    |\n| |6 to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n             Figure 8.2.100-1: Suggested Buffering Packets Count\n\nThe Packet Count value is encoded in octet 5 and the range of the Packet\nCount value is from 0 to 255.\n\n\n"}, {"key": "User ID", "numbering": "8.2.101", "title_level": 2, "desc": "8.2.101  User ID\n\nThe User ID IE type shall be encoded as shown in Figure 8.2.101-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                      |IMEI|IMSI|    |\n| |        |                           |F   |F   |    |\n| |6       |Length of IMSI                      |    |\n| |7 to a  |IMSI                                |    |\n| |b       |Length of IMEI                      |    |\n| |(b+1) to|IMEI                                |    |\n| |c       |                                    |    |\n| |d to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                          Figure 8.2.101-1: User ID\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 IMSIF: If this bit is set to \"1\", then the Length of IMSI and\n    IMSI fields shall be present, otherwise these fields shall not be\n    present.\n\n  -  Bit 2 \u2013 IMEIF: If this bit is set to \"1\", then the Length of IMEI and\n    IMEI fields shall be present, otherwise these fields shall not be\n    present.\n\n  -  Bit 3 to 8: Spare, for future use and set to 0.\n\nThe coding of IMSI field, from octets 7 to 'a' shall be encoded as the\noctets 5 to n+4 of the IMSI IE type specified in subclause 8.3 of\n3GPP\u00a0TS\u00a029.274\u00a0[9].\n\nThe coding of IMEI field, in octets 'b+1' to 'c' shall be encoded as the\noctets 5 to n+4 of the MEI IE type specified in subclause 8.10 of\n3GPP\u00a0TS\u00a029.274\u00a0[9].\n\n\n"}, {"key": "Ethernet PDU Session Information", "numbering": "8.2.102", "title_level": 2, "desc": "8.2.102  Ethernet PDU Session Information\n\nEthernet PDU Session Indication is coded as depicted in Figure 8.2.102-1.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Spare                          |ETHI|    |\n| |k to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n             Figure 8.2.102-1: Ethernet PDU Session Information\n\nThe following flags are coded within Octet 5:\n\n  -  Bit 1 \u2013 ETHI (Ethernet Indication):  This bit shall be set to 1. This\n    refers to all the DL traffic matching the Ethernet PDU session (see\n    subclause 5.13.1).\n\n  -  Bit 2 to 8 are spare and reserved for future use.\n\n\n"}, {"key": "MAC Addresses Detected", "numbering": "8.2.103", "title_level": 2, "desc": "8.2.103  MAC Addresses Detected\n\nThe MAC Addresses Detected IE shall be encoded as shown in Figure 8.2.103-\n1. It shall contain a list of MAC address values.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Number of MAC addresses (k)         |    |\n| |6 to 11 |MAC address value 1                 |    |\n| |o to    |MAC address value 2                 |    |\n| |(o+5)   |                                    |    |\n| |p to    |\u2026                                   |    |\n| |(p+5)   |                                    |    |\n| |q to    |MAC address value k                 |    |\n| |(q+5)   |                                    |    |\n| |s to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                  Figure 8.2.103-1: MAC addresses Detected\n\n\n\nOctet 5 shall encode the number of 48-bit MAC addresses.\n\nMAC address values shall be encoded as 12-digit\u00a0hexadecimal numbers.\n\n\n"}, {"key": "MAC Addresses Removed", "numbering": "8.2.104", "title_level": 2, "desc": "8.2.104  MAC Addresses Removed\n\nThe MAC Addresses Removed IE shall be encoded as shown in Figure 8.2.104-1.\nIt shall contain a list of MAC address values.\n\n\n\n| |        |Bits                                |    |\n| |Octets  |8                                   |7   |\n| |3 to 4  |Length = n                          |    |\n| |5       |Number of MAC addresses (k)         |    |\n| |6 to 11 |MAC address value 1                 |    |\n| |o to    |MAC address value 2                 |    |\n| |(o+5)   |                                    |    |\n| |p to    |\u2026                                   |    |\n| |(p+5)   |                                    |    |\n| |q to    |MAC address value k                 |    |\n| |(q+5)   |                                    |    |\n| |s to    |These octet(s) is/are present only  |    |\n| |(n+4)   |if explicitly specified             |    |\n\n\n                   Figure 8.2.104-1: MAC addresses Removed\n\n\n\nOctet 5 shall encode the number of 48-bit MAC addresses.\n\nMAC address values shall be encoded as 12-digit\u00a0hexadecimal numbers.\n\n\n"}, {"key": "Match Field", "desc": "a field of the Packet Detection Information of a Packet\nDetection Rule against which a packet is attempted to be matched."}, {"key": "Matching", "desc": "comparing the set of header fields of a packet to the match\nfields of the Packet Detection Information of a Packet Detection Rule."}]