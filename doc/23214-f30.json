[{"key": "Scope", "numbering": "1", "title_level": 0, "desc": "         1  Scope\n\nThe present document specifies the overall stage\u00a02 level functionality for\ncontrol and user plane separation of EPC's SGW, PGW and TDF. This enables a\nflexible placement of the separated control plane and user plane functions\nfor supporting diverse deployment scenarios (e.g. central or distributed\nuser plane function) without affecting the overall functionality provided\nby these EPC entities.\n\n\n"}, {"key": "References", "numbering": "2", "title_level": 0, "desc": "2  References\n\nThe following documents contain provisions which, through reference in this\ntext, constitute provisions of the present document.\n\n  -  References are either specific (identified by date of publication,\n    edition number, version number, etc.) or non-specific.\n\n  -  For a specific reference, subsequent revisions do not apply.\n\n  -  For a non-specific reference, the latest version applies. In the case\n    of a reference to a 3GPP document (including a GSM document), a non-\n    specific reference implicitly refers to the latest version of that\n    document in the same Release as the present document.\n\n  [1]  3GPP\u00a0TR\u00a021.905: \"Vocabulary for 3GPP Specifications\".\n\n  [2]  3GPP\u00a0TS\u00a023.401: \"General Packet Radio Service (GPRS) enhancements\n             for Evolved Universal Terrestrial Radio Access Network (E-\n             UTRAN) access\".\n\n  [3]  3GPP\u00a0TS\u00a023.203: \"Policy and charging control architecture\".\n\n  [4]  3GPP\u00a0TS\u00a023.402: \"Architecture enhancements for non-3GPP accesses\".\n\n  [5]  3GPP\u00a0TS\u00a023.060: \"General Packet Radio Service (GPRS); Service\n             description; Stage 2\".\n\n  [6]  3GPP\u00a0TS\u00a029.060: \"GPRS Tunnelling Protocol (GTP) across the Gn and Gp\n             interface\".\n\n  [7]  3GPP\u00a0TS\u00a029.274: \"3GPP Evolved Packet System (EPS); Evolved General\n             Packet Radio Service (GPRS) Tunnelling Protocol for Control\n             plane (GTPv2-C); Stage 3\".\n\n  [8]  3GPP\u00a0TS\u00a032.251: \"Telecommunication management; Charging management;\n             Packet Switched (PS) domain charging\".\n\n  [9]  3GPP\u00a0TS\u00a032.240: \"Charging architecture and principles\".\n\n  [10] 3GPP\u00a0TS\u00a033.107: \"3G security; Lawful interception architecture and\n             functions\".\n\n  [11] 3GPP\u00a0TS\u00a029.212: \"Policy and Charging Control (PCC); Reference\n             points\".\n\n  [12] 3GPP\u00a0TS\u00a029.244: \"Interface between the Control Plane and the User\n             Plane of EPC Nodes; Stage 3\".\n\n\n"}, {"key": "Definitions and abbreviations", "numbering": "3", "title_level": 0, "desc": "3  Definitions and abbreviations\n\n\n"}, {"key": "Architecture model and concepts", "numbering": "4", "title_level": 0, "desc": "4  Architecture model and concepts\n\n\n"}, {"key": "General concepts", "numbering": "4.1", "title_level": 1, "desc": "4.1  General concepts\n\nThe architecture and functionality for control and user plane separation of\nSGW, PGW and TDF is based on the following concepts:\n\n  -  Interworking with networks not applying control and user plane\n    separation is possible (i.e. in case of roaming scenarios);\n\n  -  Split network entities can interwork with network entities that are\n    not split within the same network;\n\n  -  Split network entities have no requirement to update UE, and Radio\n    Access Network;\n\n  -  The SGW/PGW selection function of the MME/ePDG/TWAN described in\n    TS\u00a023.401\u00a0[2] and TS\u00a023.402\u00a0[4] is used for the selection of the\n    respective CP function;\n\n  -  The configuration based mechanism (in PGW or PCRF) described in\n    TS\u00a023.203\u00a0[3] is used for the selection of the CP function of the TDF;\n\n  -  A CP function can interface with one or more UP functions (e.g. to\n    enable independent scalability of CP functions and UP functions).\n\n\n"}, {"key": "Architecture reference model", "numbering": "4.2", "title_level": 1, "desc": "4.2  Architecture reference model\n\n\n"}, {"key": "Non-roaming and roaming architectures", "numbering": "4.2.1", "title_level": 2, "desc": "4.2.1  Non-roaming and roaming architectures\n\nThis clause defines the complementary aspects of the architecture reference\nmodels specified in TS\u00a023.401\u00a0[2] clause\u00a04.2 and TS\u00a023.402\u00a0[4] clauses\n4.2.2 and 4.2.3 for GTP-based interfaces when SGW, PGW and TDF control and\nuser planes are separated.\n\nFor S2a, S2b, S5 and S8 reference points, this architecture reference model\nis only supported with GTP-based interfaces. PMIP-based interfaces and S2c\ninterface are not supported.\n\nFigure 4.2.1-1 shows the architecture reference model in the case of\nseparation between control plane and user plane. This architecture\nreference model covers non-roaming as well as home routed and local\nbreakout roaming scenarios.\n\n                                    [pic]\n\n Figure 4.2.1-1: Architecture reference model with separation of user plane\n           and control plane for non-roaming and roaming scenarios\n\n  NOTE 1:  The -C or -U suffix appended to S2a, S2b, S5 and S8 existing\n         reference points only indicate the control plane and user plane\n         components of those interfaces.\n\n  NOTE 2:  The architecture in figure 4.2.1-1 only depicts the case when\n         the CP and UP functions of all SGW, PGW and TDF nodes are split.\n         However, the other cases when the CP and UP function of only one of\n         these nodes is split while the CP and UP function of the other\n         interfacing node is not split, e.g. PGW's control plane and user\n         plane is split while SGW's control plane and user plane is not\n         split, are also supported. The split architecture of a node does\n         not put any architectural requirements on the peer nodes with which\n         it interfaces.\n\n  NOTE 3:  TDF is an optional functional entity.\n\n  NOTE 4:  Additional interfaces/reference points are documented in\n         TS\u00a023.401\u00a0[2], TS\u00a023.402\u00a0[4], TS\u00a023.060\u00a0[5] and TS\u00a023.203\u00a0[3].\n\n  NOTE 5:  For a roaming architecture with local breakout, the Gx interface\n         is defined between the PGW-C and PCRF in the visited network.\n\n  NOTE\u00a06:  S11-U is the interface between MME and SGW-U, supporting CP CIoT\n         EPS Optimisation (see TS\u00a023.401\u00a0[2]).\n\n\n"}, {"key": "Combined SGW/PGW architecture", "numbering": "4.2.2", "title_level": 2, "desc": "4.2.2  Combined SGW/PGW architecture\n\nThe usage of a combined SGW/PGW documented in TS\u00a023.401\u00a0[2] remains\npossible in a deployment with separated control and user planes. This is\nenabled by supporting an Sx interface with a common parameter structure for\nnon-combined and combined cases. Figure 4.2.2-1 shows the architecture\nreference model for a combined SGW/PGW in the case of separation between\ncontrol plane and user plane.\n\n                                    [pic]\n\n Figure 4.2.2-1: Architecture reference model with separation of user plane\n                  and control plane for a combined SGW/PGW\n\n  NOTE\u00a01:  The combined Sxa/Sxb shown in figure 4.2.2-1 only covers the\n         functionality of Sxa and Sxb.\n\n  NOTE\u00a02:  S11-U is the interface between MME and combined SGW/PGW-U,\n         supporting CP CIoT EPS Optimisation (see TS\u00a023.401\u00a0[2]).\n\n\n"}, {"key": "Reference points", "numbering": "4.2.3", "title_level": 2, "desc": "4.2.3  Reference points\n\nThis clause defines the complementary reference points of the architecture\nreference models specified in TS\u00a023.401\u00a0[2] clause\u00a04.2 and TS\u00a023.402\u00a0[4]\nclauses 4.2.2 and 4.2.3 for GTP-based interfaces when SGW, PGW and TDF\ncontrol and user planes are separated.\n\nThe reference points added to the reference points defined in\nTS\u00a023.401\u00a0[2], TS\u00a023.402\u00a0[4] and TS\u00a023.203\u00a0[3] are the following ones:\n\n  Sxa: Reference point between SGW-C and SGW-U.\n\n  Sxb: Reference point between PGW-C and PGW-U.\n\n  Sxc: Reference point between TDF-C and TDF-U.\n\n\n"}, {"key": "High level functions", "numbering": "4.3", "title_level": 1, "desc": "4.3  High level functions\n\n\n"}, {"key": "General", "numbering": "4.3.1", "title_level": 2, "desc": "4.3.1  General\n\nThis clause\u00a0documents the existing functionality of SGW, PGW and TDF as\ndescribed in TS\u00a023.401\u00a0[2], TS\u00a023.402\u00a0[4] and TS\u00a023.203\u00a0[3].\n\n          Table\u00a04.3.1-1: Existing functionality of SGW, PGW and TDF\n\n|Main          |Sub-functionality         |SGW       |PGW       |TDF      |\n|functionality |                          |          |          |         |\n|A. Session    |1. Resource management for|X         |X         |         |\n|management    |bearer resources          |          |          |         |\n|(default &    |                          |          |          |         |\n|dedicated     |                          |          |          |         |\n|bearer        |                          |          |          |         |\n|establishment,|                          |          |          |         |\n|bearer        |                          |          |          |         |\n|modification, |                          |          |          |         |\n|bearer        |                          |          |          |         |\n|deactivation) |                          |          |          |         |\n|              |2. IP address and TEID    |X         |X         |         |\n|              |assignment for GTP-U      |          |          |         |\n|              |3. Packet forwarding      |X         |X         |         |\n|              |4. Transport level packet |X         |X         |         |\n|              |marking                   |          |          |         |\n|B. UE IP      |1. IP address allocation  |          |X         |         |\n|address       |from local pool           |          |          |         |\n|management    |                          |          |          |         |\n|              |2. DHCPv4 / DHCPv6 client |          |X         |         |\n|              |3. DHCPv4 / DHCPv6 server |          |X         |         |\n|              |4. Router advertisement,  |          |X         |         |\n|              |router solicitation,      |          |          |         |\n|              |neighbour advertisement,  |          |          |         |\n|              |neighbour solicitation (as|          |          |         |\n|              |in RFC 4861)              |          |          |         |\n|C. Support for|1. Forwarding of \"end     |X         |          |         |\n|UE mobility   |marker\" (as long as user  |          |          |         |\n|              |plane to source eNB       |          |          |         |\n|              |exists)                   |          |          |         |\n|              |2. Sending of \"end marker\"|X         |X         |         |\n|              |after switching the path  |          |          |         |\n|              |to target node            |          |          |         |\n|              |3. Forwarding of buffered |X         |          |         |\n|              |packet                    |          |          |         |\n|              |4. Change of target GTP-U |X         |X         |         |\n|              |endpoint within 3GPP      |          |          |         |\n|              |accesses                  |          |          |         |\n|              |5. Change of target GTP-U |          |X         |         |\n|              |endpoint between 3GPP and |          |          |         |\n|              |non-3GPP access           |          |          |         |\n|D. S1-Release |1. ECM-IDLE mode DL packet|X         |          |         |\n|/ Buffering / |buffering; Triggering of  |          |          |         |\n|Downlink Data |Downlink Data Notification|          |          |         |\n|Notification  |message generation per    |          |          |         |\n|              |bearer (multiple, if DL   |          |          |         |\n|              |packet received on higher |          |          |         |\n|              |ARP than previous DDN);   |          |          |         |\n|              |Inclusion of DSCP of      |          |          |         |\n|              |packet in DDN message for |          |          |         |\n|              |Paging Policy             |          |          |         |\n|              |Differentiation           |          |          |         |\n|              |2. Delay Downlink Data    |X         |          |         |\n|              |Notification Request (if  |          |          |         |\n|              |terminating side replies  |          |          |         |\n|              |to uplink data after UE   |          |          |         |\n|              |service request before SGW|          |          |         |\n|              |gets updated)             |          |          |         |\n|              |3. Extended buffering of  |X         |          |         |\n|              |downlink data when the UE |          |          |         |\n|              |is in a power saving state|          |          |         |\n|              |and not reachable (high   |          |          |         |\n|              |latency communication);   |          |          |         |\n|              |dropping of downlink data |          |          |         |\n|              |(if MME has requested SGW |          |          |         |\n|              |to throttle downlink low  |          |          |         |\n|              |priority traffic and if   |          |          |         |\n|              |the downlink data packet  |          |          |         |\n|              |is received on such a     |          |          |         |\n|              |bearer (see               |          |          |         |\n|              |clause\u00a04.3.7.4.1a).       |          |          |         |\n|              |4. PGW pause of charging  |X         |X         |         |\n|              |procedure based on        |          |          |         |\n|              |operator                  |          |          |         |\n|              |policy/configuration the  |          |          |         |\n|              |SGW (failed paging,       |          |          |         |\n|              |abnormal radio link       |          |          |         |\n|              |release, number/fraction  |          |          |         |\n|              |of packets/bytes dropped  |          |          |         |\n|              |at SGW)                   |          |          |         |\n|E. Bearer/APN |1. UL/DL APN-AMBR         |          |X         |X        |\n|policing      |enforcement               |          |          |         |\n|              |2. UL/DL bearer MBR       |          |X         |         |\n|              |enforcement (for GBR      |          |          |         |\n|              |bearer)                   |          |          |         |\n|              |3. UL/DL bearer MBR       |          |X         |         |\n|              |enforcement (for nonGBR   |          |          |         |\n|              |bearer on Gn/Gp interface)|          |          |         |\n|F. PCC related|1. Service detection (DPI,|          |X         |X        |\n|functions     |IP-5-tuple)               |          |          |         |\n|              |2. Bearer binding (bearer |          |X         |         |\n|              |QoS & TFT)                |          |          |         |\n|              |3. UL bearer binding      |          |X         |         |\n|              |verification and mapping  |          |          |         |\n|              |of DL traffic to bearers  |          |          |         |\n|              |4. UL and DL service level|          |X         |X        |\n|              |gating                    |          |          |         |\n|              |5. UL and DL service level|          |X         |X        |\n|              |MBR enforcement           |          |          |         |\n|              |6. UL and DL service level|          |X         |X        |\n|              |charging (online &        |          |          |         |\n|              |offline, per charging key)|          |          |         |\n|              |7. Usage monitoring       |          |X         |X        |\n|              |8. Event reporting        |          |X         |X        |\n|              |(including application    |          |          |         |\n|              |detection)                |          |          |         |\n|              |9. Request for forwarding |          |          |X        |\n|              |of event reporting        |          |          |         |\n|              |10. Redirection           |          |X         |X        |\n|              |11. FMSS handling         |          |X         |X        |\n|              |12. PCC support for NBIFOM|          |X         |         |\n|              |13. DL DSCP marking for   |          |          |X        |\n|              |application indication    |          |          |         |\n|              |14. Predefined PCC/ADC    |          |X         |X        |\n|              |rules activation and      |          |          |         |\n|              |deactivation              |          |          |         |\n|              |15. PCC support for SDCI  |          |X         |X        |\n|G. NBIFOM     |Non-PCC aspects of NBIFOM |X         |X         |         |\n|H.            |1. Accounting per UE and  |X         |X         |         |\n|Inter-operator|bearer                    |          |          |         |\n|accounting    |                          |          |          |         |\n|(counting of  |                          |          |          |         |\n|volume and    |                          |          |          |         |\n|time)         |                          |          |          |         |\n|              |2. Interfacing OFCS       |X         |X         |X        |\n|              |through reference points  |          |          |         |\n|              |specified in TS\u00a032.240\u00a0[9]|          |          |         |\n|I.            |Exchange of load/overload |X         |X         |         |\n|Load/overload |control information and   |          |          |         |\n|control       |actions during peer node  |          |          |         |\n|functions     |overload                  |          |          |         |\n|J. Lawful     |Interfacing LI functions  |X         |X         |         |\n|interception  |through reference points  |          |          |         |\n|              |specified in              |          |          |         |\n|              |TS\u00a033.107\u00a0[10] and        |          |          |         |\n|              |performing LI             |          |          |         |\n|              |functionality             |          |          |         |\n|K. Packet     |                          |          |X         |         |\n|screening     |                          |          |          |         |\n|function      |                          |          |          |         |\n|L. Restoration|                          |X         |X         |X        |\n|and recovery  |                          |          |          |         |\n|M. RADIUS /   |                          |          |X         |         |\n|Diameter on   |                          |          |          |         |\n|SGi           |                          |          |          |         |\n|N. OAM        |                          |X         |X         |X        |\n|interfaces    |                          |          |          |         |\n|O. GTP bearer |Generation of echo        |X         |X         |         |\n|and path      |request, handling of echo |          |          |         |\n|management    |response, echo request    |          |          |         |\n|              |timeout and Error         |          |          |         |\n|              |Indication message        |          |          |         |\n\n\n\n"}, {"key": "Functional split of SGW, PGW and TDF", "numbering": "4.3.2", "title_level": 2, "desc": "4.3.2  Functional split of SGW, PGW and TDF\n\n\n"}, {"key": "Functional split of SGW", "numbering": "4.3.2.1", "title_level": 3, "desc": "4.3.2.1  Functional split of SGW\n\nThe following table describes the functionality of the SGW-C and the SGW-U.\n\nAll functionality performed by the SGW-U is controlled from the SGW-C and\nthus even if it is marked below as a SGW-U functionality only, there will\nbe corresponding control functionality in the SGW-C.\n\n  NOTE:  Functionality not marked for SGW-U is either only provided by SGW-\n         C or does not require any specific SGW-U behaviour.\n\nFor interfaces not listed in the table below, Figure 4.2.1-1 describes\nwhether they are terminated in SGW- C or SGW-U.\n\n                   Table\u00a04.3.2-1: Functional split of SGW\n\n|Main          |Sub-functionality         |SGW-C |SGW-U |Comments           |\n|functionality |                          |      |      |                   |\n|A. Session    |1. Resource management for|X     |X     |See clause\u00a05.10    |\n|management    |bearer resources          |      |      |                   |\n|(default &    |                          |      |      |                   |\n|dedicated     |                          |      |      |                   |\n|bearer        |                          |      |      |                   |\n|establishment,|                          |      |      |                   |\n|bearer        |                          |      |      |                   |\n|modification, |                          |      |      |                   |\n|bearer        |                          |      |      |                   |\n|deactivation) |                          |      |      |                   |\n|              |2. IP address and TEID    |X     |X     |See clause\u00a05.4     |\n|              |assignment for GTP-U      |      |      |                   |\n|              |3. Packet forwarding      |      |X     |                   |\n|              |4. Transport level packet |      |X     |                   |\n|              |marking                   |      |      |                   |\n|C. Support for|1. Forwarding of \"end     |      |X     |                   |\n|UE mobility   |marker\" (as long as user  |      |      |                   |\n|              |plane to source eNB       |      |      |                   |\n|              |exists)                   |      |      |                   |\n|              |2. Sending of \"end marker\"|X     |X     |See clause\u00a05.8     |\n|              |after switching the path  |      |      |                   |\n|              |to target node            |      |      |                   |\n|              |3. Forwarding of buffered |X     |X     |See clause\u00a05.9     |\n|              |packet                    |      |      |                   |\n|              |4. Change of target GTP-U |X     |      |                   |\n|              |endpoint within 3GPP      |      |      |                   |\n|              |accesses                  |      |      |                   |\n|              |5. Change of target GTP-U |      |      |N/A                |\n|              |endpoint between 3GPP and |      |      |                   |\n|              |non-3GPP access           |      |      |                   |\n|D. S1-Release |1. ECM-IDLE mode DL packet|X     |X     |See clause\u00a05.9     |\n|/ Buffering / |buffering; Triggering of  |      |      |                   |\n|Downlink Data |Downlink Data Notification|      |      |                   |\n|Notification  |message generation per    |      |      |                   |\n|              |bearer (multiple, if DL   |      |      |                   |\n|              |packet received on higher |      |      |                   |\n|              |ARP than previous DDN);   |      |      |                   |\n|              |Inclusion of DSCP of      |      |      |                   |\n|              |packet in DDN message for |      |      |                   |\n|              |Paging Policy             |      |      |                   |\n|              |Differentiation           |      |      |                   |\n|              |2. Delay Downlink Data    |X     |      |                   |\n|              |Notification Request (if  |      |      |                   |\n|              |terminating side replies  |      |      |                   |\n|              |to uplink data after UE   |      |      |                   |\n|              |service request before SGW|      |      |                   |\n|              |gets updated)             |      |      |                   |\n|              |3. Extended buffering of  |X     |X     |See clause\u00a05.9     |\n|              |downlink data when the UE |      |      |                   |\n|              |is in a power saving state|      |      |                   |\n|              |and not reachable (high   |      |      |                   |\n|              |latency communication);   |      |      |                   |\n|              |dropping of downlink data |      |      |                   |\n|              |(if MME has requested SGW |      |      |                   |\n|              |to throttle downlink low  |      |      |                   |\n|              |priority traffic and if   |      |      |                   |\n|              |the downlink data packet  |      |      |                   |\n|              |is received on such a     |      |      |                   |\n|              |bearer (see               |      |      |                   |\n|              |clause\u00a04.3.7.4.1a).       |      |      |                   |\n|              |4. PGW pause of charging  |X     |      |See clause\u00a05.3.4   |\n|              |procedure based on        |      |      |                   |\n|              |operator                  |      |      |                   |\n|              |policy/configuration the  |      |      |                   |\n|              |SGW (failed paging,       |      |      |                   |\n|              |abnormal radio link       |      |      |                   |\n|              |release, number/fraction  |      |      |                   |\n|              |of packets/bytes dropped  |      |      |                   |\n|              |at SGW)                   |      |      |                   |\n|G. NBIFOM     |Non-PCC aspects of NBIFOM |X     |      |                   |\n|H.            |1. Accounting per UE and  |      |X     |See clause\u00a05.3     |\n|Inter-operator|bearer                    |      |      |                   |\n|accounting    |                          |      |      |                   |\n|(counting of  |                          |      |      |                   |\n|volume and    |                          |      |      |                   |\n|time)         |                          |      |      |                   |\n|              |2. Interfacing OFCS       |X     |      |See clause\u00a05.3     |\n|              |through reference points  |      |      |                   |\n|              |specified in TS\u00a032.240\u00a0[9]|      |      |                   |\n|I.            |Exchange of load/overload |      |      |As defined in      |\n|Load/overload |control information and   |      |      |CT\u00a0WG4             |\n|control       |actions during peer node  |      |      |TS\u00a029.244\u00a0[12]     |\n|functions     |overload                  |      |      |                   |\n|J. Lawful     |Interfacing LI functions  |X     |X     |As defined in      |\n|interception  |through reference points  |      |      |SA\u00a0WG3-LI          |\n|              |specified in              |      |      |TS\u00a033.107\u00a0[10]     |\n|              |TS\u00a033.107\u00a0[10] and        |      |      |                   |\n|              |performing LI             |      |      |                   |\n|              |functionality             |      |      |                   |\n|L. Restoration|                          |      |      |As defined in      |\n|and recovery  |                          |      |      |CT\u00a0WG4             |\n|              |                          |      |      |TS\u00a029.244\u00a0[12]     |\n|N. OAM        |                          |      |      |As defined in      |\n|interfaces    |                          |      |      |SA\u00a0WG5 TS xx.xxx   |\n|O. GTP bearer |Generation of echo        |      |      |As defined in      |\n|and path      |request, handling of echo |      |      |CT\u00a0WG4             |\n|management    |response, echo request    |      |      |TS\u00a029.244\u00a0[12]     |\n|              |timeout and Error         |      |      |                   |\n|              |Indication message        |      |      |                   |\n\n\n\n"}, {"key": "Functional split of PGW", "numbering": "4.3.2.2", "title_level": 3, "desc": "4.3.2.2  Functional split of PGW\n\nThe following table describes the functionality of the PGW-C and the PGW-U.\n\nAll functionality performed by the PGW-U is controlled from the PGW-C and\nthus even if it is marked below as a PGW-U functionality only there will be\ncorresponding control functionality in the PGW-C.\n\n  NOTE:  Functionality not marked for PGW-U is either only provided by PGW-\n         C or does not require any specific PGW-U behaviour.\n\nFor interfaces not listed in the table below, Figure 4.2.1-1 describes\nwhether they are terminated in the PGW-C or the PGW-U.\n\n                   Table\u00a04.3.2-2: Functional split of PGW\n\n|Main          |Sub-functionality         |PGW-C  |PGW-U  |Comments         |\n|functionality |                          |       |       |                 |\n|A. Session    |1. Resource management for|X      |X      |See clause\u00a05.10  |\n|management    |bearer resources          |       |       |                 |\n|(default &    |                          |       |       |                 |\n|dedicated     |                          |       |       |                 |\n|bearer        |                          |       |       |                 |\n|establishment,|                          |       |       |                 |\n|bearer        |                          |       |       |                 |\n|modification, |                          |       |       |                 |\n|bearer        |                          |       |       |                 |\n|deactivation) |                          |       |       |                 |\n|              |2. IP address and TEID    |X      |X      |See clause\u00a05.4   |\n|              |assignment for GTP-U      |       |       |                 |\n|              |3. Packet forwarding      |       |X      |                 |\n|              |4. Transport level packet |       |X      |                 |\n|              |marking                   |       |       |                 |\n|B. UE IP      |1. IP address allocation  |X      |       |See clause\u00a05.5   |\n|address       |from local pool           |       |       |                 |\n|management    |                          |       |       |                 |\n|              |2. DHCPv4 / DHCPv6 client |X      |       |See clause\u00a05.5   |\n|              |3. DHCPv4 / DHCPv6 server |X      |       |See clause\u00a05.5   |\n|              |4. Router advertisement,  |X      |       |See clause\u00a05.5   |\n|              |router solicitation,      |       |       |                 |\n|              |neighbour advertisement,  |       |       |                 |\n|              |neighbour solicitation (as|       |       |                 |\n|              |in RFC 4861)              |       |       |                 |\n|C. Support for|1. Forwarding of \"end     |       |       |N/A              |\n|UE mobility   |marker\" (as long as user  |       |       |                 |\n|              |plane to source eNB       |       |       |                 |\n|              |exists)                   |       |       |                 |\n|              |2. Sending of \"end marker\"|X      |X      |See clause\u00a05.8   |\n|              |after switching the path  |       |       |                 |\n|              |to target node            |       |       |                 |\n|              |3. Forwarding of buffered |       |       |N/A              |\n|              |packet                    |       |       |                 |\n|              |4. Change of target GTP-U |X      |       |                 |\n|              |endpoint within 3GPP      |       |       |                 |\n|              |accesses                  |       |       |                 |\n|              |5. Change of target GTP-U |X      |       |                 |\n|              |endpoint between 3GPP and |       |       |                 |\n|              |non-3GPP access           |       |       |                 |\n|D. S1-Release |1. ECM-IDLE mode DL packet|       |       |N/A              |\n|/ Buffering / |buffering; Triggering of  |       |       |                 |\n|Downlink Data |Downlink Data Notification|       |       |                 |\n|Notification  |message generation per    |       |       |                 |\n|              |bearer (multiple, if DL   |       |       |                 |\n|              |packet received on higher |       |       |                 |\n|              |ARP than previous DDN);   |       |       |                 |\n|              |Inclusion of DSCP of      |       |       |                 |\n|              |packet in DDN message for |       |       |                 |\n|              |Paging Policy             |       |       |                 |\n|              |Differentiation           |       |       |                 |\n|              |2. Delay Downlink Data    |       |       |N/A              |\n|              |Notification Request (if  |       |       |                 |\n|              |terminating side replies  |       |       |                 |\n|              |to uplink data after UE   |       |       |                 |\n|              |service request before SGW|       |       |                 |\n|              |gets updated)             |       |       |                 |\n|              |3. Extended buffering of  |       |       |N/A              |\n|              |downlink data when the UE |       |       |                 |\n|              |is in a power saving state|       |       |                 |\n|              |and not reachable (high   |       |       |                 |\n|              |latency communication);   |       |       |                 |\n|              |dropping of downlink data |       |       |                 |\n|              |(if MME has requested SGW |       |       |                 |\n|              |to throttle downlink low  |       |       |                 |\n|              |priority traffic and if   |       |       |                 |\n|              |the downlink data packet  |       |       |                 |\n|              |is received on such a     |       |       |                 |\n|              |bearer (see 4.3.7.4.1a).  |       |       |                 |\n|              |4. PGW pause of charging  |X      |       |See clause\u00a05.3.4 |\n|              |procedure based on        |       |       |                 |\n|              |operator                  |       |       |                 |\n|              |policy/configuration the  |       |       |                 |\n|              |SGW (failed paging,       |       |       |                 |\n|              |abnormal radio link       |       |       |                 |\n|              |release, number/fraction  |       |       |                 |\n|              |of packets/bytes dropped  |       |       |                 |\n|              |at SGW)                   |       |       |                 |\n|E. Bearer/APN |1. UL/DL APN-AMBR         |       |X      |                 |\n|policing      |enforcement               |       |       |                 |\n|              |2. UL/DL bearer MBR       |       |X      |                 |\n|              |enforcement (for GBR      |       |       |                 |\n|              |bearer)                   |       |       |                 |\n|              |3. UL/DL bearer MBR       |       |X      |                 |\n|              |enforcement (for nonGBR   |       |       |                 |\n|              |bearer on Gn/Gp interface)|       |       |                 |\n|F. PCC related|1. Service detection (DPI,|       |X      |                 |\n|functions     |IP-5-tuple)               |       |       |                 |\n|              |2. Bearer binding (bearer |X      |       |                 |\n|              |QoS & TFT)                |       |       |                 |\n|              |3. UL bearer binding      |       |X      |See clause\u00a05.2   |\n|              |verification and mapping  |       |       |                 |\n|              |of DL traffic to bearers  |       |       |                 |\n|              |4. UL and DL service level|       |X      |                 |\n|              |gating                    |       |       |                 |\n|              |5. UL and DL service level|       |X      |                 |\n|              |MBR enforcement           |       |       |                 |\n|              |6. UL and DL service level|X      |X      |See clause\u00a05.3   |\n|              |charging (online &        |       |       |                 |\n|              |offline, per charging key)|       |       |                 |\n|              |7. Usage monitoring       |X      |X      |See clause\u00a05.3   |\n|              |8. Event reporting        |X      |X      |Note: User-plane |\n|              |(including application    |       |       |related events   |\n|              |detection)                |       |       |such as          |\n|              |                          |       |       |application      |\n|              |                          |       |       |detection        |\n|              |                          |       |       |reporting        |\n|              |                          |       |       |supported in UP  |\n|              |                          |       |       |function, while  |\n|              |                          |       |       |control-plane    |\n|              |                          |       |       |related events   |\n|              |                          |       |       |such as RAT      |\n|              |                          |       |       |change etc.      |\n|              |                          |       |       |supported only in|\n|              |                          |       |       |CP function.     |\n|              |9. Request for forwarding |       |       |N/A              |\n|              |of event reporting        |       |       |                 |\n|              |10. Redirection           |X      |X      |See clause\u00a05.11.3|\n|              |11. FMSS handling         |       |X      |                 |\n|              |12. PCC support for NBIFOM|X      |       |                 |\n|              |13. DL DSCP marking for   |       |       |N/A              |\n|              |application indication    |       |       |                 |\n|              |14. Predefined PCC/ADC    |X      |X      |See clause\u00a05.11.1|\n|              |rules activation and      |       |       |                 |\n|              |deactivation              |       |       |                 |\n|              |15. PCC support for SDCI  |X      |X      |See clause\u00a05.11.4|\n|G. NBIFOM     |Non-PCC aspects of NBIFOM |X      |       |                 |\n|H.            |1. Accounting per UE and  |       |X      |See clause\u00a05.3   |\n|Inter-operator|bearer                    |       |       |                 |\n|accounting    |                          |       |       |                 |\n|(counting of  |                          |       |       |                 |\n|volume and    |                          |       |       |                 |\n|time)         |                          |       |       |                 |\n|              |2. Interfacing OFCS       |X      |       |See clause\u00a05.3   |\n|              |through reference points  |       |       |                 |\n|              |specified in TS\u00a032.240\u00a0[9]|       |       |                 |\n|I.            |Exchange of load/overload |       |       |As defined in    |\n|Load/overload |control information and   |       |       |CT\u00a0WG4           |\n|control       |actions during peer node  |       |       |TS\u00a029.244\u00a0[12]   |\n|functions     |overload                  |       |       |                 |\n|J. Lawful     |Interfacing LI functions  |X      |X      |As defined in    |\n|interception  |through reference points  |       |       |SA\u00a0WG3-LI        |\n|              |specified in              |       |       |TS\u00a033.107\u00a0[10]   |\n|              |TS\u00a033.107\u00a0[10] and        |       |       |                 |\n|              |performing LI             |       |       |                 |\n|              |functionality             |       |       |                 |\n|K. Packet     |                          |       |X      |                 |\n|screening     |                          |       |       |                 |\n|function      |                          |       |       |                 |\n|L. Restoration|                          |       |       |As defined in    |\n|and recovery  |                          |       |       |CT\u00a0WG4           |\n|              |                          |       |       |TS\u00a029.244\u00a0[12]   |\n|M. RADIUS /   |                          |X      |X      |See clause\u00a05.5   |\n|Diameter on   |                          |       |       |                 |\n|SGi           |                          |       |       |                 |\n|N. OAM        |                          |       |       |As defined in    |\n|interfaces    |                          |       |       |SA\u00a0WG5 TS xx.xxx |\n|O. GTP bearer |Generation of echo        |       |       |As defined in    |\n|and path      |request, handling of echo |       |       |CT\u00a0WG4           |\n|management    |response, echo request    |       |       |TS\u00a029.244\u00a0[12]   |\n|              |timeout and Error         |       |       |                 |\n|              |Indication message        |       |       |                 |\n\n\n\n"}, {"key": "Functional split of TDF", "numbering": "4.3.2.3", "title_level": 3, "desc": "4.3.2.3  Functional split of TDF\n\nThe following table describes the functionality of the TDF-C and the TDF-U.\n\nAll functionality performed by the TDF-U is controlled from the TDF-C and\nthus even if it is marked below as a TDF-U functionality only there will be\ncorresponding control functionality in the TDF-C.\n\nFor interfaces not listed in the table below, Figure 4.2.1-1 describes\nwhether they are terminated in the TDF-C or TDF-U.\n\n                   Table\u00a04.3.2-3: Functional split of TDF\n\n|Main          |Sub-functionality         |TDF-C |TDF-U  |Comments         |\n|functionality |                          |      |       |                 |\n|E. Bearer/APN |1. UL/DL APN-AMBR         |      |X      |Not identical to |\n|policing      |enforcement               |      |       |APN-AMBR         |\n|              |                          |      |       |enforcement as it|\n|              |                          |      |       |a) covers every  |\n|              |                          |      |       |flow in TDF      |\n|              |                          |      |       |session and b)   |\n|              |                          |      |       |does not cover   |\n|              |                          |      |       |other TDF        |\n|              |                          |      |       |sessions of the  |\n|              |                          |      |       |UE to the same   |\n|              |                          |      |       |APN              |\n|              |2. UL/DL bearer MBR       |      |       |N/A              |\n|              |enforcement (for GBR      |      |       |                 |\n|              |bearer)                   |      |       |                 |\n|              |3. UL/DL bearer MBR       |      |       |N/A              |\n|              |enforcement (for nonGBR   |      |       |                 |\n|              |bearer on Gn/Gp interface)|      |       |                 |\n|F. PCC related|1. Service detection (DPI,|      |X      |                 |\n|functions     |IP-5-tuple)               |      |       |                 |\n|              |2. Bearer binding (bearer |      |       |N/A              |\n|              |QoS & TFT)                |      |       |                 |\n|              |3. UL bearer binding      |      |       |N/A              |\n|              |verification and mapping  |      |       |                 |\n|              |of DL traffic to bearers  |      |       |                 |\n|              |4. UL and DL service level|      |X      |                 |\n|              |gating                    |      |       |                 |\n|              |5. UL and DL service level|      |X      |                 |\n|              |MBR enforcement           |      |       |                 |\n|              |6. UL and DL service level|X     |X      |See clause\u00a05.3   |\n|              |charging (online &        |      |       |                 |\n|              |offline, per charging key)|      |       |                 |\n|              |7. Usage monitoring       |X     |X      |See clause\u00a05.3   |\n|              |8. Event reporting        |X     |X      |Note: User-plane |\n|              |(including application    |      |       |related events   |\n|              |detection)                |      |       |such as          |\n|              |                          |      |       |application      |\n|              |                          |      |       |detection        |\n|              |                          |      |       |reporting        |\n|              |                          |      |       |supported in UP  |\n|              |                          |      |       |function, while  |\n|              |                          |      |       |control-plane    |\n|              |                          |      |       |related events   |\n|              |                          |      |       |such as RAT      |\n|              |                          |      |       |change etc.      |\n|              |                          |      |       |supported only in|\n|              |                          |      |       |CP function.     |\n|              |9. Request for forwarding |X     |       |                 |\n|              |of event reporting        |      |       |                 |\n|              |10. Redirection           |X     |X      |See clause\u00a05.11.3|\n|              |11. FMSS handling         |      |X      |                 |\n|              |12. PCC support for NBIFOM|      |       |N/A              |\n|              |13. DL DSCP marking for   |      |X      |                 |\n|              |application indication    |      |       |                 |\n|              |14. Predefined PCC/ADC    |X     |X      |See clause\u00a05.11.1|\n|              |rules activation and      |      |       |                 |\n|              |deactivation              |      |       |                 |\n|              |15. PCC support for SDCI  |X     |X      |See clause\u00a05.11.4|\n|H.            |1. Accounting per UE and  |      |       |N/A              |\n|Inter-operator|bearer                    |      |       |                 |\n|accounting    |                          |      |       |                 |\n|(counting of  |                          |      |       |                 |\n|volume and    |                          |      |       |                 |\n|time)         |                          |      |       |                 |\n|              |2. Interfacing OFCS       |X     |       |See clause\u00a05.3   |\n|              |through reference points  |      |       |                 |\n|              |specified in TS\u00a032.240\u00a0[9]|      |       |                 |\n|I.            |Exchange of load/overload |      |       |As defined in    |\n|Load/overload |control information and   |      |       |CT\u00a0WG4           |\n|control       |actions during peer node  |      |       |TS\u00a029.244\u00a0[12]   |\n|functions     |overload                  |      |       |                 |\n|L. Restoration|                          |      |       |As defined in    |\n|and recovery  |                          |      |       |CT\u00a0WG4           |\n|              |                          |      |       |TS\u00a029.244\u00a0[12]   |\n|N. OAM        |                          |      |       |As defined in    |\n|interfaces    |                          |      |       |SA\u00a0WG5 TS xx.xxx |\n\n\n\n"}, {"key": "User Plane Function selection", "numbering": "4.3.3", "title_level": 2, "desc": "4.3.3  User Plane Function selection\n\nThe CP function of a functional entity performs selection of its respective\nUP function considering parameters such as UE's location information,\ncapability of the UP function and features required for an UE.\nAdditionally, the selection of UP function shall consider UP function\ndeployment scenarios such as centrally located UP function and distributed\nUP functions located close to or at the RAN site. The selection of UP\nfunction shall also allow deployment of UP functions with different\ncapabilities, e.g. UP functions supporting no or a subset of optional\nfunctionalities.\n\nFor standalone CP functions:\n\n  -  SGW's CP function shall select SGW's UP function;\n\n  -  PGW's CP function shall select PGW's UP function;\n\n  -  TDF's CP function shall select TDF's UP function.\n\nCombined SGW/PGW's CP function should select either combined SGW/PGW UP\nfunction or standalone SGW UP and PGW UP functions.\n\nFor details, refer to clause\u00a05.12.\n\n\n"}, {"key": "SGW-C Partitioning", "numbering": "4.3.4", "title_level": 2, "desc": "4.3.4  SGW-C Partitioning\n\nIf the SGW-U service area is smaller than the SGW-C service area, the SGW-C\ncan be partitioned into multiple SGW-C partitions. Each of the SGW-C\npartition is aligned with the corresponding SGW-U service area. The MME\ntreats the SGW-C partition as legacy SGW.\n\n  NOTE\u00a01:  There is only one Sxa reference point between one SGW-C and one\n         SGW-U.\n\n  NOTE\u00a02:  This ensures that the TAI List allocated by the MME will only\n         contain TAs that have connectivity to the SGW-U function serving\n         the UE in case the MME uses the service area of the SGW-C partition\n         when constructing the TAI List (and it cannot be assured that there\n         is \"full mesh\" IP connectivity between the eNBs and the SGW-U\n         function outside the SGW-U Service Area).\n\n  NOTE\u00a03:  If more than one SGW-U is selected to serve a given UE, these\n         SGW-Us need to cover an area including at least the service area of\n         the SGW-C.\n\n\n"}, {"key": "Network elements", "numbering": "4.4", "title_level": 1, "desc": "4.4  Network elements\n\n\n"}, {"key": "General", "numbering": "4.4.1", "title_level": 2, "desc": "4.4.1  General\n\nSGW-C and SGW-U jointly provide functionality equivalent to the\nfunctionality provided by SGW as defined by the TS\u00a023.401\u00a0[2].\n\nPGW-C and PGW-U jointly provide functionality equivalent to the\nfunctionality provided by PGW as defined by the TS\u00a023.401\u00a0[2] and\nTS\u00a023.402\u00a0[4], and the PCEF as defined by the TS\u00a023.203\u00a0[3].\n\nTDF-C and TDF-U jointly provide functionality equivalent to the\nfunctionality provided by TDF as defined by the TS\u00a023.203\u00a0[3].\n\nThe clause\u00a04.3.2 defines how the functional control and user plane split is\ndone and which functionality SGW-C, SGW-U, PGW-C, PGW-U, TDF-C, TDF-U\ncorrespondingly support.\n\n\n"}, {"key": "SGW control plane function", "numbering": "4.4.2", "title_level": 2, "desc": "4.4.2  SGW control plane function\n\nThe SGW control plane function (SGW-C) provides the functionality of the\nSGW as defined by TS\u00a023.401\u00a0[2] except for the functions that are performed\nby the SGW-U as described in table 4.3.2-1.\n\nIn addition, the SGW-C is responsible for selecting the SGW-U (as described\nin clause\u00a04.3.3) and for controlling the SGW-U with respect to the\nfunctions described in table 4.3.2-1.\n\n\n"}, {"key": "SGW user plane function", "numbering": "4.4.3", "title_level": 2, "desc": "4.4.3  SGW user plane function\n\nThe SGW user plane function (SGW-U) provides the functionality described in\nthis TS. The functions that are performed by the SGW-U are listed in table\n4.3.2-1 together with a reference to a detailed functional description in\nclause\u00a05 for some of them. The control parameters relevant for the SGW-U\nare described in clause\u00a07.\n\n  NOTE:  The standard allows certain functionalities to be supported in\n         both SGW-C and SGW-U. For details refer to clause\u00a05.\n\n\n"}, {"key": "PGW control plane function", "numbering": "4.4.4", "title_level": 2, "desc": "4.4.4  PGW control plane function\n\nThe PGW control plane function (PGW-C) provides the functionality of the\nPGW as defined by TS\u00a023.401\u00a0[2] and TS\u00a023.402\u00a0[4], and the PCEF as defined\nby the TS\u00a023.203\u00a0[3] except for the functions that are performed by the PGW-\nU as described in table 4.3.2-2.\n\nIn addition, the PGW-C is responsible for selecting the PGW-U (as described\nin clause\u00a04.3.3) and for controlling the PGW-U with respect to the\nfunctions described in table 4.3.2-2.\n\n\n"}, {"key": "PGW user plane function", "numbering": "4.4.5", "title_level": 2, "desc": "4.4.5  PGW user plane function\n\nThe PGW user plane function (PGW-U) provides the functionality described in\nthis TS. The functions that are performed by the PGW-U are listed in table\n4.3.2-2 together with a reference to a detailed functional description in\nclause\u00a05 for some of them. The control parameters relevant for the PGW-U\nare described in clause\u00a07.\n\n  NOTE:  The standard allows certain functionalities to be supported in\n         both PGW-C and PGW-U. For details refer to clause\u00a05.\n\n\n"}, {"key": "TDF control plane function", "numbering": "4.4.6", "title_level": 2, "desc": "4.4.6  TDF control plane function\n\nThe TDF control plane function (TDF -C) provides the functionality of the\nTDF as defined by TS\u00a023.203\u00a0[3] except for the functions that are performed\nby the TDF -U as described in table 4.3.2-3.\n\nIn addition, the TDF -C is responsible for selecting the TDF -U (as\ndescribed in clause\u00a04.3.3) and for controlling the TDF -U with respect to\nthe functions described in table 4.3.2-3.\n\n\n"}, {"key": "TDF user plane function", "numbering": "4.4.7", "title_level": 2, "desc": "4.4.7  TDF user plane function\n\nThe TDF user plane function (TDF -U) provides the functionality described\nin this TS. The functions that are performed by the TDF -U are listed in\ntable 4.3.2-3 together with a reference to a detailed functional\ndescription in clause\u00a05 for some of them. The control parameters relevant\nfor the TDF-U are described in clause\u00a07.\n\n  NOTE:  The standard allows certain functionalities to be supported in\n         both TDF-C and TDF-U. For details refer to clause\u00a05.\n\n\n"}, {"key": "Functional description", "numbering": "5", "title_level": 0, "desc": "5  Functional description\n\n\n"}, {"key": "General", "numbering": "5.1", "title_level": 1, "desc": "5.1  General\n\nThis clause\u00a0contains detailed functional descriptions for some of the\nfunctions provided by the UP function of SGW, PGW and TDF (whether a\nfunction has to be supported by a functional entity is defined in\nclause\u00a04.3.2). It is documented how the respective CP function instructs\nit's corresponding UP function and which control parameters are used.\n\n\n"}, {"key": "Traffic detection", "numbering": "5.2", "title_level": 1, "desc": "5.2  Traffic detection\n\n\n"}, {"key": "General", "numbering": "5.2.1", "title_level": 2, "desc": "5.2.1  General\n\nThis clause\u00a0describes the detection process at the UP function that\nidentifies the packets belonging to a bearer, service data flow or IP-\nCAN/TDF session.\n\nThe CP function is responsible for instructing the UP function about how to\ndetect user data traffic belonging to a Packet Detection Rule (PDR). The\nother parameters provided within a PDR describe how the UP function shall\ntreat a packet that matches the detection information.\n\n\n"}, {"key": "Traffic detection information", "numbering": "5.2.2", "title_level": 2, "desc": "5.2.2  Traffic detection information\n\nThe CP function controls the traffic detection at the UP function by\nproviding detection information for every PDR. Detection information is a\ncombination of:\n\n  -  UE IP address;\n\n  -  F-TEIDu;\n\n  -  SDF filters as defined in TS\u00a023.203\u00a0[3];\n\n  -  Application ID (referring to an application detection filter) as\n    defined in TS\u00a023.203\u00a0[3].\n\nThe following Table 5.2.2-1 lists the possible combinations of the traffic\ndetection information for the different UP functions and usage scenarios.\n\n   Table 5.2.2-1: Detection information for the different UP functions and\n                               usage scenarios\n\n|Usage |UP     |Detection          |Detection          |Description          |\n|scenar|functio|information for UL |information for DL |                     |\n|io    |n      |                   |                   |                     |\n|1     |SGW-U  |Local F-TEIDu      |Local F-TEIDu (core|Detection of traffic |\n|      |       |(access side)      |side)              |belonging to a bearer|\n|2     |PGW-U  |Local F-TEIDu      |UE IP address as   |Detection of traffic |\n|      |       |(access side) +    |destination +      |belonging to a       |\n|      |       |uplink SDF         |downlink SDF       |service data flow +  |\n|      |       |filter(s)/applicati|filter(s)/applicati|UL bearer binding    |\n|      |       |on ID              |on ID              |verification (based  |\n|      |       |(NOTE 2)           |                   |on F-TEIDu in UL     |\n|      |       |                   |                   |filter)              |\n|3     |PGW-U  |Local F-TEID       |UE IP address as   |Usage scenario 2 +   |\n|      |       |(access side) + UE |destination +      |Packet screening     |\n|      |       |IP address as      |downlink SDF       |(based on UE IP as   |\n|      |       |source + uplink SDF|filter(s)/applicati|source in UL filter) |\n|      |       |filter(s)/applicati|on ID              |                     |\n|      |       |on ID              |                   |                     |\n|      |       |(NOTE 2)           |                   |                     |\n|4     |PGW-U  |Local F-TEID       |-                  |Detection of         |\n|      |       |(access side)      |                   |remaining traffic,   |\n|      |       |(NOTE 1)           |                   |e.g. with wrong UE IP|\n|      |       |                   |                   |address or on wrong  |\n|      |       |                   |                   |bearer, for          |\n|      |       |                   |                   |measurement and      |\n|      |       |                   |                   |discarding.          |\n|5     |PGW-U  |-                  |UE IP address as   |Detection of         |\n|      |       |                   |destination        |remaining traffic,   |\n|      |       |                   |(NOTE 1)           |e.g. not matching any|\n|      |       |                   |                   |other detection      |\n|      |       |                   |                   |information, for     |\n|      |       |                   |                   |discarding.          |\n|6     |PGW-U  |-                  |Downlink SDF       |Detection of RADIUS, |\n|      |       |                   |filter(s)/applicati|Diameter and DHCP    |\n|      |       |                   |on ID              |signalling traffic on|\n|      |       |                   |(NOTE 2)           |SGi.                 |\n|7     |TDF-U  |UE IP address as   |UE IP address as   |Detection of traffic |\n|      |       |source + uplink SDF|destination +      |belonging to a       |\n|      |       |filter(s)/applicati|downlink SDF       |service data flow    |\n|      |       |on ID              |filter(s)/applicati|                     |\n|      |       |                   |on ID              |                     |\n|8     |TDF-U  |UE IP address as   |UE IP address as   |Detecting of         |\n|      |       |source             |destination        |remaining traffic    |\n|      |       |(NOTE 1)           |(NOTE 1)           |(i.e. not matching   |\n|      |       |                   |                   |any other PDR)       |\n|      |       |                   |                   |belonging to a TDF   |\n|      |       |                   |                   |session              |\n|NOTE 1: A PDR with such detection information should have the lowest        |\n|precedence amongst all the PDRs installed for this Sx session.              |\n|NOTE 2: The detection of traffic related to UE IP address allocation as well|\n|as RADIUS, Diameter and DHCP signalling traffic on SGi can be accomplished  |\n|using SDF filter(s) or an application ID (referring to an application       |\n|detection filter).                                                          |\n\n\n\n"}, {"key": "Charging and usage monitoring handling", "numbering": "5.3", "title_level": 1, "desc": "5.3  Charging and usage monitoring handling\n\n\n"}, {"key": "General", "numbering": "5.3.1", "title_level": 2, "desc": "5.3.1  General\n\nIf functional split of SGW into SGW-C and SGW-U is supported, the overall\nfunctionality of offline charging support as defined by TS\u00a023.401\u00a0[2] and\nTS\u00a032.251\u00a0[8] shall be preserved.\n\nIf functional split of PGW into PGW-C and PGW-U is supported, the overall\nfunctionality of online and offline charging as defined by TS\u00a032.251\u00a0[8],\nand of usage monitoring control as defined by TS\u00a023.401\u00a0[2], TS\u00a023.203\u00a0[3]\nshall be preserved.\n\nIf functional split of TDF into TDF-C and TDF-U is supported, the overall\nfunctionality of online and offline charging as defined by TS\u00a032.251\u00a0[8],\nand of usage monitoring control as defined by TS\u00a023.203\u00a0[3] shall be\npreserved.\n\nThe following principles shall apply in case of a functional split:\n\n  -  The Gx, Sd, Gy, Gyn, Gz, Gzn interfaces as well as the interface\n    between SGW and OFCS shall be terminated in the CP function (SGW-C/PGW-\n    C/TDF-C). This implies that the CP function shall support those\n    interfaces towards OCS/OFCS and PCRF, based on information received at\n    the corresponding CP function as well as gathered user-plane related\n    information received from the UP function as further described below.\n\n  -  There is no impact on PCRF, OCS and OFCS compared to non-split\n    architecture.\n\n  -  All bearer/traffic flow level, session level and subscriber related\n    information remains at the CP function, and only usage information is\n    requested from UP function.\n\n\n"}, {"key": "Activation of usage reporting in UP function", "numbering": "5.3.2", "title_level": 2, "desc": "5.3.2  Activation of usage reporting in UP function\n\nTriggered by the PCC/ADC rules received from the PCRF or preconfigured\ninformation available at PGW-C/TDF-C/SGW-C, as well as from the OCS for\nonline charging via Credit-Control session mechanisms, the CP function (PGW-\nC/TDF-C/SGW-C) shall provide Usage Reporting Rules to the UP function (PGW-\nU/TDF-U/SGW-U) for controlling how usage reporting is performed.\n\nThe CP function shall request the report of the relevant usage information\nfor Usage Monitoring, based on Monitoring Keys and triggers which are\nspecified in TS\u00a023.203\u00a0[3] and TS\u00a029.212\u00a0[11]. Each Usage Reporting Rule\nrequested for usage monitoring control contains a list of \"traffic flows\"\nfor PGW-U and TDF-U whose traffic is to be accounted under this rule. The\nCP function shall use Monitoring-key either preconfigured or received from\nthe PCRF within the PCC/ADC Rule in order to generate this list and also\nshall keep the mapping between them. This list may overlap across multiple\nUsage-Report-Rules, i.e. multiple different Usage Reporting Rules may\ncontain the same \"traffic flows\".\n\nThe CP function shall request the report of the relevant usage information\nfor offline and online charging, based on Rating Groups and triggers which\nare specified in TS\u00a032.251\u00a0[8]. Each Usage Reporting Rule requested for\noffline or online charging contains a list of \"traffic flows\" for PGW-U and\nTDF-U whose traffic is to be accounted under this rule. The CP function\nshall use Rating Group or Sponsor Identity either preconfigured or provided\nby PCRF and/or OCS as defined in TS\u00a032.251\u00a0[8] and the PCC/ADC rule in\norder to generate this list and also shall keep the mapping between them.\nThis list may overlap across multiple Usage-Report-Rules, i.e. multiple\ndifferent Usage Reporting Rules may contain the same \"traffic flows\".\n\nThe CP function shall also provide reporting trigger events to the UP\nfunction for when to report usage information. The reporting trigger events\n(e.g. triggers, threshold information etc.) shall be supported for the\nsession (IP-CAN/TDF) level reporting as well as on Rule level basis as\ndetermined by the CP function. The triggers may be provided as a volume,\ntime or event to cater for the different charging/usage monitoring models\nsupported by the TS\u00a023.203\u00a0[3] for usage monitoring and by TS\u00a032.251\u00a0[8]\nfor offline and online charging. The CP function shall decide on the\nthresholds value(s) based on allowance received from PCRF, OCS or based on\nlocal configuration.\n\nIn some cases, the same Usage Reporting Rule can be used for different\npurposes (for both usage monitoring and charging), e.g. in case the same\nset of traffic flows, measurement method, trigger event, threshold, etc.\napply. Similarly a reported measurement can be used for different purposes\nby the CP function.\n\n\n"}, {"key": "Reporting of usage information towards CP function", "numbering": "5.3.3", "title_level": 2, "desc": "5.3.3  Reporting of usage information towards CP function\n\nThe UP function shall support reporting of usage information to the CP\nfunction. The UP function shall be capable to support reporting based on\ndifferent triggers, including:\n\n  -  Periodic reporting with period defined by the CP function.\n\n  -  Usage thresholds provided by the CP function.\n\n  -  Report on demand received from the CP function.\n\nThe CP function shall make sure that the multiple granularity levels\nrequired by the reporting keys in the Usage Reporting rules satisfy the\nfollowing aggregation levels without requiring a knowledge of the\ngranularity levels by the UP function:\n\n  -  Session level reporting (IP-CAN/TDF session);\n\n  -  Bearer (for charging)/traffic flow (for both charging and usage\n    monitoring) level reporting as defined by the reporting keys in the\n    Usage Reporting Rule (see the description above).\n\nBased on the mapping between Monitoring-key and PCC/ADC rule stored at the\nCP function, the CP function shall combine the reported information with\nsession and subscriber related information which is available at the CP\nfunction, for Usage Monitoring reporting over the corresponding Gx, Sd\ninterfaces.\n\nBased on the mapping between Rating Group or Sponsor Identity and PCC/ADC\nrule stored at the CP function, the CP function shall combine the reported\ninformation with session and subscriber related information which is\navailable at the CP function, for offline and online charging reporting\nover the corresponding Gy, Gyn, Gz, Gzn interfaces.\n\nThis functionality is specified in TS\u00a032.240\u00a0[9].\n\nThe usage information shall be collected in the UP function and reported to\nthe CP function as defined in 5.3.3, based on Monitoring Keys and triggers\nwhich are specified in TS\u00a023.203\u00a0[3] and TS\u00a029.212\u00a0[11].\n\n\n"}, {"key": "PGW Pause of Charging", "numbering": "5.3.4", "title_level": 2, "desc": "5.3.4  PGW Pause of Charging\n\nWhen the UE moves to ECM-IDLE state and the SGW-C decides to activate\nbuffering in SGW-U for the session, it shall also instruct the SGW-U to\nmeasure the number of packets/bytes that are buffered or discarded in SGW-U\nand the criteria for reporting within the Usage Reporting Rule.\n\nOnce the trigger of reporting is met, the SGW-U shall inform the SGW-C by\nreporting usage information.\n\nThe SGW-C can then inform the PGW-C as described in TS\u00a023.401\u00a0[2].\n\nWhen the PGW-C determines to stop the charging and usage monitoring actions\nfor the PDN connection, it shall indicate the PGW-U to stop collecting the\nusage information.\n\nPGW-C sends an Sx session modification request message to the PGW-U and\nmodifies all the Usage Reporting Rules within the PDN connection to\nindicate the usage collection shall be stopped. When PGW-C determines to\ncontinue the charging action for the PDN connection, it sends an Sx session\nmodification request message to the PGW-U and modifies all the Usage\nReporting Rules within the PDN connection to indicate the usage collection\nshall be resumed.\n\n  NOTE:  The support for PGW pause of charging is optional as described in\n         TS\u00a023.401\u00a0[2], and used only if both the SGW-C and the PGW-C\n         support this feature.\n\n\n"}, {"key": "GTP-U IP address and TEIDu allocation", "numbering": "5.4", "title_level": 1, "desc": "5.4  GTP-U IP address and TEIDu allocation\n\n\n"}, {"key": "General", "numbering": "5.4.1", "title_level": 2, "desc": "5.4.1  General\n\nAllocation and release of F-TEIDu is performed by SGW and PGW when a bearer\nneeds to be established or released. If functional split into SGW-C/PGW-C\nand SGW-U/PGW-U is supported, F-TEIDu allocation and release can either be\ndone in the CP function or in the UP function, as described in clauses\n5.4.2 and 5.4.3 below.\n\nThe support of F-TEIDu allocation by the CP function is mandatory, and the\nsupport of F-TEIDu allocation by the UP function is optional. The UP\nfunction shall support F-TEIDu allocation by the CP function. The CP\nfunction optionally supports F-TEIDu allocation by the UP function.\n\nWhether F-TEIDu allocation/release is performed by CP function or UP\nfunction is determined by network configuration of the CP functions. When\nboth F-TEIDu allocation in CP function and F-TEIDu allocation in UP\nfunction coexist in the same network, the same F-TEIDu allocation option\nshall be used by all the CP functions controlling a particular UP function.\n\n\n"}, {"key": "F-TEIDu allocation / release in the CP function", "numbering": "5.4.2", "title_level": 2, "desc": "5.4.2  F-TEIDu allocation / release in the CP function\n\nIf the network is configured to perform allocation/release of F-TEIDu in\nthe SGW-C, the SGW-C shall manage the SGW F-TEIDu space, including ensuring\nthat the allocated F-TEIDu(s) are unique as described in TS\u00a029.060\u00a0[6]. The\nSGW-C shall allocate F-TEIDu(s) for the applicable SGW-U reference points\nwhen a bearer is activated and release the F-TEIDu(s) when a bearer is\ndeactivated. In case of bearer activation, the SGW-C shall provide the\nallocated F-TEIDu(s) to SGW-U. The SGW-C shall also provide the F-TEIDu(s)\nto other network entities as described in TS\u00a023.401\u00a0[2] in order to\ncomplete the bearer establishment. In case of bearer deactivation, the SGW-\nC shall notify the SGW-U about the release of the F-TEIDu(s).\n\nIf network is configured to perform allocation/release of F-TEIDu in the\nPGW-C, the PGW-C shall manage the PGW F-TEIDu space, including ensuring\nthat the allocated F-TEIDu(s) are unique as described in TS\u00a029.060\u00a0[6]. The\nPGW-C shall allocate F-TEIDu(s) for the applicable PGW-U reference points\nwhen a bearer is activated and release the F-TEIDu(s) when a bearer is\ndeactivated. In case of bearer activation, the PGW-C shall provide the\nallocated F-TEIDu(s) to PGW-U. The PGW-C shall also provide the F-TEIDu(s)\nto other network entities as described in TS\u00a023.401\u00a0[2] and TS\u00a023.402\u00a0[4]\nin order to complete the bearer establishment. In case of bearer\ndeactivation, the PGW-C shall notify the PGW-U about the release of the F-\nTEIDu(s).\n\n\n"}, {"key": "F-TEIDu allocation / release in the UP function", "numbering": "5.4.3", "title_level": 2, "desc": "5.4.3  F-TEIDu allocation / release in the UP function\n\nIf the network is configured to perform allocation/release of F-TEIDu in\nthe SGW-U, the SGW-U shall manage the SGW F-TEIDu space, including ensuring\nthat the allocated F-TEIDu(s) are unique as described in TS\u00a029.060\u00a0[6]. In\ncase of bearer activation, the SGW-C shall request SGW-U to allocate F-\nTEIDu(s) for the applicable SGW-U reference points and provide them to the\nSGW-C. The SGW-C shall provide the F-TEIDu(s) to other network entities as\ndescribed in TS\u00a023.401\u00a0[2] in order to complete the bearer establishment.\nIn case of bearer deactivation, the SGW-C shall request SGW-U to release F-\nTEIDu(s) for the bearer.\n\nIf the network is configured to perform allocation/release of F-TEIDu in\nthe PGW-U, the PGW-U shall manage the PGW F-TEIDu space, including ensuring\nthat the allocated F-TEIDu(s) are unique as described in TS\u00a029.060\u00a0[6]. In\ncase of bearer activation, the PGW-C shall request PGW-U to allocate F-\nTEIDu(s) for the applicable PGW-U reference points and provide them to the\nPGW-C. The PGW-C shall provide the F-TEIDu(s) to other network entities as\ndescribed in TS\u00a023.401\u00a0[2] and TS\u00a023.402\u00a0[4] in order to complete the\nbearer establishment. In case of bearer deactivation, the PGW-C shall\nrequest PGW-U to release F-TEIDu(s) for the bearer.\n\n\n"}, {"key": "UE IP address management (allocation, renewal and release)", "numbering": "5.5", "title_level": 1, "desc": "5.5  UE IP address management (allocation, renewal and release)\n\nThe UE IP address management includes allocation and release of the UE IP\naddress as well as renewal of the allocated IP address, where applicable.\n\nThe UE IP address management shall be performed by the PGW-C. As part of\nthis functionality, various UE IP address management mechanisms as defined\nin 3GPP\u00a0TS\u00a023.401\u00a0[2] clause\u00a05.3.1 are supported by the PGW-C. The PGW-C\nshall process the UE IP address management related messages, maintain the\ncorresponding state information and provide the response messages to the\nUE. In case the UE IP address is obtained from the external PDN,\nadditionally, the PGW-C shall also send the allocation, renewal and release\nrelated request messages to the external PDN and maintain the corresponding\nstate information. The PGW-U shall support forwarding of the UE IP address\nmanagement related messages to the PGW-C, when they are received via the\nuser plane signalling from the UE or from the external PDN.\n\nWhen PGW-C performs IPv4 address allocation via default bearer activation\nand release via PDN connection release (3GPP\u00a0TS\u00a023.401\u00a0[2]\nclause\u00a05.3.1.2.1), no special functionality is required from the PGW-U.\n\nFor the other UE IP address management mechanisms, the UE sends the IP\naddress management related request messages via the user plane signalling.\nHence the PGW-U is required to forward these request messages to the PGW-C\nfor processing. Once these request messages are processed by the PGW-C, the\nPGW-C sends response messages to the UE via the user plane signalling.\nHence the PGW-C is required to forward these response messages to the PGW-U\nso that it can be relayed it to the UE. Correspondingly, following\nfunctionality is required to be supported by the PGW-C and PGW-U:\n\n  -  For IPv6 default prefix management via IPv6 stateless address\n    autoconfiguration (3GPP\u00a0TS\u00a023.401\u00a0[2] clause\u00a05.3.1.2.2): PGW-C shall\n    configure PGW-U to forward Router Solicitation and Neighbor\n    Solicitation messages from the UE to the PGW-C. The PGW-C shall forward\n    Router Advertisement and Neighbor Advertisement messages to the PGW-U\n    for relaying them to the UE.\n\n  -  For IPv6 parameter configuration via stateless DHCPv6\n    (3GPP\u00a0TS\u00a023.401\u00a0[2] clause\u00a05.3.1.2.3): PGW-C shall configure PGW-U to\n    forward all the DHCPv6 messages from the UE to the PGW-C. The PGW-C\n    shall forward the DHCPv6 response messages to the PGW-U for relaying\n    them to the UE.\n\n  -  For IPv4 address management and parameter configuration DHCPv4\n    (3GPP\u00a0TS\u00a023.401\u00a0[2] clause\u00a05.3.1.2.4): PGW-C shall configure PGW-U to\n    forward all the DHCPv4 messages from the UE to the PGW-C. The PGW-C\n    shall forward the DHCPv4 response messages to PGW-U for relaying them\n    to the UE.\n\n  -  For IPv6 prefix management via IPv6 prefix delegation\n    (3GPP\u00a0TS\u00a023.401\u00a0[2] clause\u00a05.3.1.2.6): PGW-C shall configure PGW-U to\n    forward all the DHCPv6 messages from the UE to the PGW-C. The PGW-C\n    shall forward the DHCPv6 response messages to PGW-U for relaying them\n    to the UE.\n\nIn addition to the above, when the UE IP address is obtained from the\nexternal PDN, following functionality is required to be supported by the\nPGW-C and PGW-U:\n\n  -  For UE IP address from AAA server in the external PDN: If the AAA\n    server in the external PDN is reachable only via the PGW-U the PGW-C\n    shall configure the PGW-U to forward all the Diameter or RADIUS\n    messages from the AAA server in the external PDN to the PGW-C. And the\n    PGW-C shall forward the Diameter or RADIUS messages to the PGW-U for\n    relaying them to the AAA server in the external PDN.\n\n  -  For UE IP address from DHCPv4/v6 server in the external PDN: If the\n    DHCPv4/v6 server in the external PDN is reachable only via the PGW-U\n    the PGW-C shall configure the PGW-U to forward all the DHCPv4/v6\n    messages from the DHCPv4/v6 server in the external PDN to the PGW-C.\n    And the PGW-C shall forward the DHCPv4/v6 messages to the PGW-U for\n    relaying them to the DHCPv4/v6 server in the external PDN.\n\n  NOTE:  If the AAA server or the DHCPv4/v6 server in the external PDN is\n         reachable directly, then the PGW-C communicates with it directly,\n         without involving the PGW-U.\n\n\n"}, {"key": "Control of user plane forwarding", "numbering": "5.6", "title_level": 1, "desc": "5.6  Control of user plane forwarding\n\n\n"}, {"key": "General", "numbering": "5.6.1", "title_level": 2, "desc": "5.6.1  General\n\nOne of the main tasks of the Sx interface is to enable the CP function to\ninstruct the UP function about how to forward user data traffic. There are\nseveral different user plane forwarding scenarios supported. Some scenarios\nare applicable to SGW only or PGW only, while other scenarios are\napplicable to SGW and PGW or PGW and TDF. A non-exhaustive list of\nforwarding scenarios is provided in Table 5.6.2-1 below.\n\nThe CP function shall be able to provide the UP with instructions for at\nleast the following behaviors: forward, forward with end marker. The CP\nfunction shall also be able to request multiple sets of forwarding\ninstructions to be performed in sequence, e.g. forward to the DL side and\nforward to the CP function for the purpose of duplication.\n\n\n"}, {"key": "Control of user plane forwarding", "numbering": "5.6.2", "title_level": 2, "desc": "5.6.2  Control of user plane forwarding\n\nThe CP function controls user-plane packet forwarding for traffic detected\nby a PDR by providing FAR(s) with instructions to the UP function,\nincluding:\n\n  -  Forwarding operation information;\n\n  -  Forwarding target information.\n\nThe details of the forwarding target and operation will depend on the\nscenario and is described in Table 5.6.2-1 below. The following forwarding\nfunctionality is required by the UP function (more than one forwarding\nscenario can be active for the same traffic):\n\n  -  Apply GTP-U bearer related handling, i.e. encapsulation, de-\n    capsulation or both. (This covers scenario 1 in the table below).\n\n  -  Forward the traffic to the CP function (This covers scenario 2, 3, 4\n    in the table below).\n\n  -  Apply locally configured policy for traffic steering. (This covers\n    scenario 5 in the table below).\n\nFurther details on the forwarding related information are provided in\nclause\u00a07.5.\n\n        Table 5.6.2-1: Forwarding information for different scenarios\n\n|   |Scenario description          |Forwarding target and       |Applicable  |\n|   |                              |operation                   |to          |\n|1  |Forwarding of user-plane      |GTP-U encapsulation         |SGW, PGW    |\n|   |between UE and PDN, including |information (F-TEID)        |            |\n|   |mapping onto GTP-U tunnels and|                            |            |\n|   |mapping between GTP-U tunnels |                            |            |\n|2  |Forwarding of user-plane      |Information that the CP     |PGW         |\n|   |packets from UE and CP        |function is source/target   |            |\n|   |function (e.g. RS/RA,         |(CP function IP address)    |            |\n|   |DHCPv4/v6, traffic subject to |                            |            |\n|   |HTTP redirect etc)            |                            |            |\n|3  |Forwarding of packets from the|Information that the CP     |PGW         |\n|   |external PDN / SGi and the CP |function is source/target   |            |\n|   |function (e.g. for RADIUS,    |(CP function IP address)    |            |\n|   |Diameter and DHCP signalling, |                            |            |\n|   |traffic subject to HTTP       |                            |            |\n|   |redirect etc)                 |                            |            |\n|4  |Forwarding of packets subject |Information that the CP     |SGW         |\n|   |to buffering in CP function   |function is source/target   |            |\n|   |                              |(CP function IP address)    |            |\n|5  |Forwarding of packets between |Reference to a predefined   |PGW, TDF    |\n|   |the UP function and the       |traffic steering            |            |\n|   |SGi-LAN for Flexible Mobile   |configuration (e.g.         |            |\n|   |Service Chaining              |Traffic-Steering Policy     |            |\n|   |                              |identifier)                 |            |\n\n\n\n"}, {"key": "Format of forwarded user plane data", "numbering": "5.6.3", "title_level": 2, "desc": "5.6.3  Format of forwarded user plane data\n\nFor forwarding between the CP function and UP function the user plane\npacket is forwarded via an Sx-u tunnel by encapsulating the user-plane\npacket using GTP-U protocol that allows the receiving entity to identify\nwhich PDN Connection and which bearer the traffic belongs to. In the\ndirection from the CP function to UP function for forwarding towards the UE\nor PDN, the UP encapsulation protocol also shall contain information that\nallows the UP function to identify whether the UE or PDN is targeted.\n\n  NOTE:  The Sx-u tunnel may be established per bearer of a PDN connection,\n         or per PDN or per UP function. The details of Sx-u tunnel are\n         defined in TS\u00a029.244\u00a0[12].\n\n\n"}, {"key": "UE's permanent identifier usage", "numbering": "5.7", "title_level": 1, "desc": "5.7  UE's permanent identifier usage\n\nFor the scenarios requiring UE's permanent identity at the UP function,\ne.g. UP function performing http header enrichment in a trusted\nenvironment, the UE's permanent identity may be provided from the CP\nfunction to the UP function in a container, instead of in an Sx parameter.\n\n  NOTE:  In an untrusted environment in which the UE's permanent identity\n         cannot be provided, due to e.g. to fulfil the privacy requirements,\n         the session identifier is used between the CP function and UP\n         function for correlating UE's session related events.\n\n\n"}, {"key": "Functionality of sending of \"end marker\"", "numbering": "5.8", "title_level": 1, "desc": "5.8  Functionality of sending of \"end marker\"\n\nSending of \"end marker\" is a functionality which involve SGW-C and SGW-U,\nand PGW-C and PGW-U. As part of the functionality, constructing of end\nmarker packets can either be done in the CP function or in the UP function,\nas described in clauses 5.8.1 and 5.8.2. Whether constructing of end marker\npackets is performed by CP function or UP function is determined by network\nconfiguration.\n\n\n"}, {"key": "UP function constructing the \"end marker\" packets", "numbering": "5.8.1", "title_level": 2, "desc": "5.8.1  UP function constructing the \"end marker\" packets\n\nIn case of eNodeB relocation during handover procedure without SGW-U\nchange, SGW-C shall indicate the SGW-U to switch the S1 path(s) by sending\nan Sx session modification request message with the new F-TEID-u of eNodeB\nand in addition, provide an indication to the SGW-U to send the end marker\npacket(s) on the old path.\n\nOn receiving this indication, the SGW-U shall construct end marker\npacket(s) and send it for each S1 GTP-U tunnel towards the source eNodeB\nafter sending the last PDU on the old path.\n\nIn case of SGW-U relocation during handover procedure, PGW-C shall indicate\nthe PGW-U to switch the S5/S8 path(s) by sending an Sx session modification\nrequest message (bearer ID, new F-TEID of SGW-U) and in addition, provide\nan indication to the PGW-U to send the end marker packet(s) on the old\npath.\n\nOn receiving this indication, the PGW-U shall construct end marker\npacket(s) and send it for each S5/S8 GTP-U tunnel towards the source SGW-U\nafter sending the last PDU on the old path.\n\nOn receiving the end marker packet(s) on S5/S8 GTP-U tunnel, SGW-U shall\nforward the end marker packet(s) and send it for each S1 GTP-U tunnel\ntowards the source eNodeB.\n\n\n"}, {"key": "CP function constructing the \"end marker\" packets", "numbering": "5.8.2", "title_level": 2, "desc": "5.8.2  CP function constructing the \"end marker\" packets\n\nIn case of eNodeB relocation during handover procedure without SGW-U\nchange, SGW-C shall indicate the SGW-U to switch the S1 path(s) by sending\nan Sx session modification request message (bearer ID, new F-TEID of\neNodeB). After sending the last PDU on the old path, SGW-U shall replace\nthe old F-TEID with the new one and responds with an Sx session\nmodification response message to acknowledge the success of path switch.\n\nWhen the path switch is finished, SGW-C constructs the end marker packet(s)\nand sends it to the SGW-U. SGW-U then forwards the packet(s) to the source\neNodeB.\n\nIn case of SGW-U relocation during handover procedure, PGW-C shall indicate\nthe PGW-U to switch the S5/S8 path(s) by sending an Sx session modification\nrequest message (bearer ID, new F-TEID of SGW-U). After sending the last\nPDU on the old S5/S8 path, PGW-U shall replace the old F-TEID with the new\none and responds with an Sx session modification response message to\nacknowledge the success of path switch.\n\nWhen the path switch is finished, PGW-C constructs the end marker packet(s)\nand sends it to PGW-U. PGW-U then forwards the packet(s) to the source SGW-\nU.\n\n\n"}, {"key": "Idle state packet SGW buffering function", "numbering": "5.9", "title_level": 1, "desc": "5.9  Idle state packet SGW buffering function\n\n\n"}, {"key": "General", "numbering": "5.9.1", "title_level": 2, "desc": "5.9.1  General\n\nBuffering of the UE's data packets for the UE in idle or power saving mode\ncan be performed in SGW-U or SGW-C.\n\nThe support of buffering in the SGW-U is mandatory and the SGW-C shall\nsupport buffering by the SGW-U.\n\nThe support of buffering in the SGW-C is optional and the SGW-U optionally\nsupports buffering by the SGW-C. An exception is that in a dedicated core\nnetwork serving UEs which may enter power saving mode or apply eDRX, e.g.\nNB-IoT UEs, the SGW-C shall support buffering capability.\n\nWhen buffering is supported in both SGW-C and SGW-U, the SGW-C decides on a\nper UE session basis (e.g. based on local configuration and other\ninformation such as UE capability) to perform buffering in either the SGW-C\nor the SGW-U.\n\n\n"}, {"key": "Buffering in CP function", "numbering": "5.9.2", "title_level": 2, "desc": "5.9.2  Buffering in CP function\n\nWhen the UE moves to ECM-IDLE state, if the SGW-C supports buffering\ncapability and decides to activate buffering, the SGW-C shall inform the\nSGW-U to stop sending data packets to eNodeB and start forwarding the\ndownlink data packets towards the SGW-C.\n\nWhen the UE transition to the ECM-CONNECTED state, the SGW-C shall update\nthe SGW-U via Sxa interface with the F-TEIDu of the eNodeB. If there are\nbuffered packets available and their buffering duration has not expired,\nthe SGW-C shall forward those packets to the SGW-U outside of the control\nplane signalling (see clause\u00a05.6.3 \"Format of forwarded user plane data\")\nto relay them to the UE. These packets are then forwarded by the SGW-U to\nthe eNodeB.\n\n\n"}, {"key": "Buffering in UP function", "numbering": "5.9.3", "title_level": 2, "desc": "5.9.3  Buffering in UP function\n\n\n"}, {"key": "General", "numbering": "5.9.3.1", "title_level": 3, "desc": "5.9.3.1  General\n\nThe SGW-C shall be able to provide the SGW-U with instructions for at least\nthe following behaviors: buffer without reporting the arrival of first\ndownlink packet, buffer with reporting the arrival of first downlink\npacket, drop packets.\n\nWhen the UE moves to ECM-IDLE state, if the SGW-C does not support\nbuffering capability, or if the SGW-C supports buffering capability and\ndecides to activate buffering in SGW-U for the session, the SGW-C shall\ninform the SGW-U, via an Sx session modification. The SGW-C decides whether\nbuffering timers are handled by the SGW-U or by the SGW-C. The activation\nof buffering implicitly stops sending data to the eNodeB/RNC/SGSN.\n\nAfter starting the buffering, when the first downlink packet arrives on any\nbearer, SGW-U shall inform the SGW-C. SGW-U sends an Sx reporting message\nto the SGW-C unless specified otherwise and identifies the S5/S8 bearer on\nwhich the downlink packet was received.\n\nOn receiving this reporting message, the SGW-C decides whether to send a\nDownlink Data Notification message to the MME as defined in TS\u00a023.401\u00a0[2].\n\nAt the UE transition to ECM-CONNECTED state, the SGW-C shall update the SGW-\nU via Sxa interface with the F-TEIDu of the eNodeB/RNC/SGSN. The buffered\ndata packets, if any, are then forwarded to the eNodeB/RNC/SGSN by the SGW-\nU.\n\nIn case of SGW-U relocation, buffered data packets are transferred from the\nold SGW-U to the new SGW-U.\n\n\n"}, {"key": "Delay Downlink Packet Notification", "numbering": "5.9.3.2", "title_level": 3, "desc": "5.9.3.2  Delay Downlink Packet Notification\n\nAccording to clause\u00a05.3.4.2 of TS\u00a023.401\u00a0[2], the MME/SGSN may inform the\nSGW that for all UEs served by the MME/SGSN, the Downlink Packet Data\nNotification shall be delayed for a period D.\n\nIf the parameter D is handled by the SGW-U, the SGW-C shall include the\nparameter D in the Sx session establishment for new Sx sessions, in the Sx\nsession modification for Sx sessions which are not in buffering state (when\ntransitioning these sessions to the buffering state), and in the next Sx\nreport ack message for Sx sessions already in buffering state. The SGW-U\nshall then delay the sending of subsequent Sx reporting upon next DL data\narrival.\n\nIf the parameter D is handled by the SGW-C, there is no special handling\ncompared to clause\u00a05.9.3.1. When the SGW-U reports the arrival of a DL data\npacket, the SGW-C shall delay the sending of the Downlink Data Notification\nto the MME by parameter D delay.\n\n\n"}, {"key": "Extended buffering", "numbering": "5.9.3.3", "title_level": 3, "desc": "5.9.3.3  Extended buffering\n\nAccording to clauses 5.3.4.3 and 5.7.3 of TS\u00a023.401\u00a0[2], the MME/SGSN\ninvoking extended buffering indicates it to the Serving GW in the Downlink\nData Notification Ack message, includes a DL Buffering Duration time and\noptionally a DL Buffering Suggested Packet Count.\n\nIf the MME/SGSN included the DL Suggested Packet Count, the SGW-C shall\ninclude the DL Suggested Packet Count in the Sx reporting Ack message.\n\nIf the DL Data Buffer Expiration Time is handled by the SGW-U, the SGW-C\nincludes it in the Sx reporting Ack message and requests the SGW-U to\nbuffer DL data packets. When the SGW-U receives the DL Data Buffer\nExpiration Time, the SGW-U buffers the DL data packets without reporting\nthe arrival of the first DL data packet until the DL Data Buffer Expiration\nTime expires. When the DL Data Buffer Expiration Time expires, the SGW-U\nshall discard the buffered DL packets and shall restart buffering DL data\npackets with reporting the arrival of the first DL data packet.\n\nIf the DL Data Buffer Expiration Time is handled by the SGW-C, the SGW-C\nrequests the SGW-U to buffer the DL data packets without reporting the\narrival of the first DL data packet. When the DL Data Buffer Expiration\nTime expires, the SGW-C requests the SGW-U to drop the buffered data\npackets and to start buffering the DL data packets with reporting of the\narrival of the first DL data packet, via an Sx Session Modification.\n\nIf the DL Suggested Packet Count was included in the request from the SGW-\nC, the SGW-U buffers the DL data packets up to the number of packets\nindicated by the DL Suggested Packet Count.\n\n\n"}, {"key": "Throttling", "numbering": "5.9.3.4", "title_level": 3, "desc": "5.9.3.4  Throttling\n\nAccording to clause\u00a04.3.7.4.1a of TS\u00a023.401\u00a0[2], the MME/SGSN can request\nthe SGWs to selectively reduce the number of Downlink Data Notification\nrequests it sends for downlink non-priority traffic received for UEs in\nidle mode according to a throttling factor and for a throttling delay\nspecified in the Downlink Data Notification Ack message.\n\nThrottling mechanism by which the MME uses Downlink Data Notification\nAcknowledgement messages DL low priority traffic Throttling parameters, is\nhandled by the SGW-C as follows:\n\n  -  On receiving Downlink Data Notification Acknowledgement from the\n    MME/SGSN, the SGW-C determines which bearers are subject to the\n    throttling of Downlink Data Notification requests on the basis of the\n    bearer's ARP priority level and the operator policy.\n\n  -  Upon receipt of an Sx report notifying the arrival of DL data packets\n    on those bearers, the SGW-C decides whether or not to send a DDN to MME\n    based on the requested throttling factor. The SGW-C may indicate in the\n    Sx Report Ack whether SGW-U shall discard the buffered packet and may\n    also indicate whether SGW-U shall notify when additional DL packets\n    arrive.\n\n  -  The throttling delay timer and throttling factor are handled by the\n    SGW-C and not provided to SGW-U.\n\n\n"}, {"key": "Bearer and APN policing", "numbering": "5.10", "title_level": 1, "desc": "5.10 Bearer and APN policing\n\nARP is used for admission control (i.e. retention and pre-emption of the\nbearer). The value of ARP is not required to be provided to the UP\nfunction.\n\nFor every bearer, SGW-C/PGW-C shall use the QCI and optionally, the ARP\npriority level, to determine the transport level packet marking and provide\nthe transport level packet marking to the SGW-U/PGW-U.\n\nPGW-C shall provide the APN-AMBR value together with a QoS Enforcement Rule\ncorrelation ID (as described in clause\u00a07.6) to PGW-U so that the PGW-U can\nenforce the APN-AMBR across all IP-CAN sessions of the UE to the same APN\nat the PGW-U.\n\nSGW-C/PGW-C shall provide the GBR and MBR value for each GBR bearer of the\nPDN connection to the SGW-U/PGW-U. When the Gn/Gp interface is used by the\nPGW-U, PGW-C shall also provide the MBR value to the PGW-U for each non-GBR\nbearer of the PDN connection on the Gn/Gp interface.\n\nTDF-C shall provide the TDF session MBR value to TDF-U to be applied to the\nTDF session of the UE.\n\n\n"}, {"key": "PCC/ADC related functions", "numbering": "5.11", "title_level": 1, "desc": "5.11 PCC/ADC related functions\n\n\n"}, {"key": "Activation/Deactivation of predefined PCC/ADC rules", "numbering": "5.11.1", "title_level": 2, "desc": "5.11.1 Activation/Deactivation of predefined PCC/ADC rules\n\nA predefined PCC/ADC rule is configured in the CP function.\n\nThe traffic detection filters required in the UP function can be configured\neither in the CP function and provided to the UP function, as service data\nflow filter(s), or be configured in the UP function, as the application\ndetection filter identified by an application identifier. For the latter\ncase, the application identifier has to be configured in the CP function\nand the UP function.\n\nThe traffic steering policy information can be only configured in the UP\nfunction, together with traffic steering policy identifier(s), while the CP\nfunction has to be configured with the traffic steering policy\nidentifier(s).\n\nPolicies for traffic handling in the UP function, which are referred by\nsome identifiers corresponding to the parameters of a PCC/ADC rule, can be\nconfigured in the UP function. These traffic handling policies are\nconfigured as predefined QER(s), FAR(s) and URR(s).\n\nWhen a predefined PCC/ADC rule is activated/deactivated by the PCRF, PGW-\nC/TDF-C shall decide what information has to be provided to the PGW-U/TDF-U\nto enforce the rule based on where the traffic detection filters (i.e.\nservice data flow filter(s) or application detection filter), traffic\nsteering policy information and the policies used for the traffic handling\nin the UP function are configured and where they are enforced:\n\n  -  If the predefined PCC/ADC rule contains an application identifier for\n    which corresponding application detection filters are configured in the\n    UP function, the PGW-C/TDF-C shall provide a corresponding application\n    identifier to the UP function;\n\n  -  If the predefined PCC/ADC rule contains traffic steering policy\n    identifier(s), the PGW-C/TDF-C shall provide a corresponding traffic\n    steering policy identifier(s) to the UP function;\n\n  -  If the predefined PCC/ADC rule contains service data flow filter(s),\n    the PGW-C/TDF-C shall provide them to the PGW-U/TDF-U;\n\n  -  If the predefined PCC/ADC rule contains some parameters for which\n    corresponding policies for traffic handling in the UP function are\n    configured in the UP function, the PGW-C/TDF-C shall activate those\n    traffic handling policies via their rule ID(s).\n\nThe CP function shall maintain the mapping between a PCC/ADC rule received\nover Gx/Sd and the flow level PDR rule(s) used on Sx.\n\n\n"}, {"key": "Enforcement of dynamic PCC/ADC rules", "numbering": "5.11.2", "title_level": 2, "desc": "5.11.2 Enforcement of dynamic PCC/ADC rules\n\nThe application detection filters required in the UP function can be\nconfigured either in the CP function and provided to the UP function as the\nservice data flow filter, or be configured in the UP function identified by\nan application identifier.\n\nWhen receiving a dynamic PCC/ADC rule from the PCRF which contains an\napplication identifier and/or parameters for traffic handling in the UP\nfunction:\n\n  -  if the application detection filter is configured in the PGW-C/TDF-C,\n    the PGW-C/TDF-C shall provide it in the service data flow filter to the\n    UP function, as well as parameters for traffic handling in the UP\n    function received from the dynamic PCC/ADC rule;\n\n  -  otherwise, the application detection filters is configured in UP\n    function, the PGW-C/TDF-C shall provide to PGW-U/TDF-U with the\n    application identifier and the parameters for traffic handling in the\n    UP function as required based on the dynamic PCC/ADC rule.\n\nThe CP function shall maintain the mapping between a PCC/ADC rule received\nover Gx/Sd and the flow level PDR(s) used on Sx.\n\n\n"}, {"key": "Redirection", "numbering": "5.11.3", "title_level": 2, "desc": "5.11.3 Redirection\n\nThe uplink application's traffic redirection may be enforced either in the\nPGW-C/TDF-C (as specified in 5.4.2 Control of user plane forwarding) or\ndirectly in the UP function. The redirect destination may be provided in\nthe dynamic PCC/ADC rule or be preconfigured, either in the CP function or\nin the UP function.\n\nWhen receiving redirect information (redirection enabled/disabled and\nredirect destination) within a dynamic PCC/ADC rule or being\nactivated/deactivated by the PCRF for the predefined redirection policies,\nPGW-C/TDF-C shall decide whether to provide and what information to be\nprovided to the UP function based on where the redirection is enforced and\nwhere the redirect destination is acquired/preconfigured. When redirection\nis enforced in the UP function and the redirect destination is acquired\nfrom the dynamic PCC/ACD rule or is configured in the CP function, CP\nfunction shall provide the redirect destination to the UP function. When\nredirection is enforced in the CP function, CP function shall instruct the\nUP function to forward applicable user plane traffic to the CP function.\n\n\n"}, {"key": "Support of SDCI", "numbering": "5.11.4", "title_level": 2, "desc": "5.11.4 Support of SDCI\n\nPFDF shall provide PFD(s) to the PGW-C/TDF-C on the request of PGW-C/TDF-C\n(pull mode) or on the request of PFD management from SCEF (push mode), as\ndescribed in TS\u00a023.203\u00a0[3]. The PGW-C/TDF-C shall provide the PFD(s) to the\nPGW-U/TDF-U, on which the Application ID corresponding to the PFD(s) is\nactive.\n\nThe PGW-C/TDF-C supports the procedures for Gw/Gwn as specified in\nTS\u00a023.203\u00a0[3], for management of PFDs. PFD(s) is cached in the PGW-C/TDF-C,\nand the PGW-C/TDF-C maintains a caching timer associated to the PFD(s).\nWhen the caching timer expires and there's no active PCC/ADC rule that\nrefers to the corresponding application identifier, the PGW-C/TDF-C informs\nthe PGW-U/TDF-U to remove the PFD(s) identified by the application\nidentifier using the PFD management message.\n\nWhen a PDR is provided for an Application ID corresponding to the PFD(s)\nthat are not already provided to the PGW-U/TDF-U, the PGW-C/TDF-C shall\nprovide the PFD(s) to the PGW-U/TDF-U (if there are no PFD(s) cached, the\nPGW-C/TDF-C retrieves them from the PFDF as specified in TS\u00a023.203\u00a0[3]).\nWhen any update of the PFD(s) is received from PFDF by PGW-C/TDF-C (using\n\"push\" or \"pull\" mode), and there are still active PDRs in PGW-U/TDF-U for\nthe Application ID, the PGW-C/TDF-C shall provision the updated PFD set\ncorresponding to the Application ID to the PGW-U/TDF-U using the PFD\nmanagement message.\n\n  NOTE\u00a01:  PGW-C/TDF-C should assure not to overload Sx signalling while\n         managing PFD(s) to the UP function, e.g. forwarding the PFD(s) to\n         the right UP function where the PFD(s) is enforced.\n\nWhen the PGW-U/TDF-U receives the updated PFD(s) from either the same or\ndifferent PGW-C/TDF-C for the same application identifier, the latest\nreceived PFD(s) shall overwrite any existing PFD(s) stored in the UP\nfunction.\n\n  NOTE\u00a02:  For the case a single UP function is controlled by multiple CP\n         functions, the conflict of PFD(s) corresponding to the same\n         application identifier provided by different CP functions should be\n         avoided by operator enforcing a well-planned PFDF and CP/UP\n         function deployment.\n\n\n"}, {"key": "User Plane function selection", "numbering": "5.12", "title_level": 1, "desc": "5.12 User Plane function selection\n\n\n"}, {"key": "General", "numbering": "5.12.1", "title_level": 2, "desc": "5.12.1 General\n\nThe selection of the UP function (SGW-U, PGW-U, TDF-U, combined SGW/PGW-U)\nis performed by its respective CP function (SGW-C, PGW-C, TDF-C, combined\nSGW/PGW-C).\n\nThe UP function's capabilities shall be signalled during the initial\nconnection establishment between the CP function and the UP function.\n\nThe CP function shall be made dynamically aware on the UP function load and\nrelative static capacity for which it has an established Sx session as\nspecified in the clauses below.\n\nThe exact set of parameters used for the selection mechanism is deployment\nspecific and controlled by the operator configuration, e.g. UE capabilities\nsuch as the UE support for dual connectivity with NR, and, the UE's\nlocation information may be used for selecting UP function in some\ndeployments while may not be used in other deployments.\n\n\n"}, {"key": "Selection of PGW-U", "numbering": "5.12.2", "title_level": 2, "desc": "5.12.2 Selection of PGW-U\n\nFor PGW-U selection, the PGW-C shall be able to consider the following\nparameters:\n\n  -  the PGW-U's dynamic load, at the node level (the PGW-C may then derive\n    the load at the APN level);\n\n  -  the PGW-U's relative static capacity (among PGW-Us supporting the same\n    APN);\n\n  -  the PGW-U location configured in the PGW-C and the UE location\n    information provided by the MME/SGSN in order to select the appropriate\n    PGW-U, e.g. for SIPTO above RAN service;\n\n  -  the capability of the UP function and the functionality required for\n    the particular UE session: An appropriate UP function can be selected\n    by matching the functionality and features required for an UE (which\n    can be derived from the information received over S11/S4/S5/S8 (e.g.\n    APN, mapped UE Usage Type, UE location information, UE capabilities\n    (e.g. UE support for dual connectivity with NR)) or from the PCRF (e.g.\n    need to perform DPI)) with the capabilities of the UP function so as to\n    fulfil the service for the UE, e.g. if L7 based traffic detection is\n    needed then an UP function supporting corresponding functionality needs\n    to be selected.\n\n  -  to enable APN-AMBR enforcement, whether a PDN connection already\n    exists for the same UE and APN, in which case the same PGW-U shall be\n    selected;\n\nThe criteria for PGW-U selection may include load balancing between PGW-Us.\n\nThe PGW-C may support the Sx Load Control feature.\n\nIn order to allow the PGW-C to select a PGW-U according to above\nparameters:\n\n  -  the SGW-C shall provide the relevant UE's capabilities when available\n    (e.g. UE support for dual connectivity with NR) over the S5/S8\n    interface.\n\n  -  the SGW-C may provide the mapped UE Usage Type over the S5 interface.\n\n\n"}, {"key": "Selection of SGW-U", "numbering": "5.12.3", "title_level": 2, "desc": "5.12.3 Selection of SGW-U\n\nFor SGW-U selection, the SGW-C shall be able to consider the following\nparameters:\n\n  -  the SGW-U location (e.g. SGW Service Area) and the UE location\n    information, provided by the MME/SGSN in order to select a UP function\n    close to the UE's point of attachment;\n\n  -  the SGW-U's dynamic load;\n\n  -  the SGW-U's relative static capacity (versus other SGW-Us);\n\n  -  the capability of the UP function and the functionality required for\n    the particular UE session: An appropriate UP function can be selected\n    by matching the functionalities and features required for an UE (which\n    can be derived from the information received over S11/S4 (e.g.\n    individual CIoT capabilities, UE Usage Type, the APN (for selection of\n    combined SGW/PGW), UE capabilities (e.g. UE support for dual\n    connectivity with NR)) with the capabilities of the UP function so as\n    to fulfil the service requirement for the UE then a UP function\n    supporting corresponding functionality needs to be selected.\n\nThe criteria for SGW-U selection may include load balancing between SGW-Us.\n\nThe SGW-C may support the Sx Load Control feature.\n\nIn order to allow the SGW-C to select a SGW-U according to the above\nparameters:\n\n  -  the MME/SGSN shall provide the location of the UE (i.e. ECGI, eNB or\n    TAI for E-UTRAN, and RAI or RNC-ID for UTRAN), the APN (for selection\n    of a combined SGW/PGW), relevant UE capabilities when available (e.g.\n    UE support for dual connectivity with NR) and may provide the mapped UE\n    Usage Type in the Create Session Request over the S11/S4 interface;\n\n  NOTE:  MME sets the UE support for dual connectivity with NR indication\n         when the UE indicates support for NR and there is no Access\n         Restriction for NR for the UE (see TS\u00a023.401\u00a0[2] clause\u00a04.3.2a).\n\n\n"}, {"key": "Selection of a combined SGW/PGW-U", "numbering": "5.12.4", "title_level": 2, "desc": "5.12.4 Selection of a combined SGW/PGW-U\n\nA combined SGW/PGW-C selects the SGW-U and PGW-U as defined respectively in\nclauses 5.12.3 and 5.12.4, with the following addition:\n\n  -  The SGW-C determines that it is a combined SGW/PGW-C entity the same\n    way as in the non-split case;\n\n  -  The combined SGW/PGW-C may optimize UP function selection by selecting\n    the best couple of SGW-U and PGW-U for the requested APN, among all\n    candidate couples of (SGW-U, PGW-U), instead of selecting independently\n    the SGW-U first and then the PGW-U (which may result in selecting non-\n    co-located SGW-U and PGW-U).\n\n\n"}, {"key": "Selection of TDF-U", "numbering": "5.12.5", "title_level": 2, "desc": "5.12.5 Selection of TDF-U\n\n\n"}, {"key": "Solicited application reporting mode", "numbering": "5.12.5.1", "title_level": 3, "desc": "5.12.5.1 Solicited application reporting mode\n\nTDF-C shall select TDF-U at PDN connection establishment (TDF session\nestablishment).\n\nThe selection may be based on the following parameters:\n\n  -  the TDF-U's dynamic load;\n\n  -  the TDF-U's relative static capacity;\n\n  -  the capability of the UP function and the functionalities and the\n    capabilities required for the particular UE session: An appropriate UP\n    function can be selected by matching the functionalities and features\n    required for the UE from the PCRF.\n\nThe criteria for TDF-U selection includes load balancing between TDF-Us.\n\nThe TDF-C may support the Sx Load Control feature.\n\n\n"}, {"key": "Unsolicited application reporting mode", "numbering": "5.12.5.2", "title_level": 3, "desc": "5.12.5.2 Unsolicited application reporting mode\n\nThe selection of TDF-U for the unsolicited application reporting is\nperformed by TDF-C during the Sx management procedure, using the\ninformation configured in TDF-C.\n\n  NOTE:  TDF-C provides the instructions for application detection and\n         reporting to the TDF-U during the Sx session management procedure.\n         TDF-U shall communicate with the TDF-C (using the same Sx session)\n         when application reporting is necessary, based on instructions\n         provided by TDF-C.\n\n\n"}, {"key": "Information flows", "numbering": "6", "title_level": 0, "desc": "6  Information flows\n\n  Editor's note:  This clause will document the Sx information flows and\n         their usage for the various existing procedures.\n\n\n"}, {"key": "General", "numbering": "6.1", "title_level": 1, "desc": "6.1  General\n\nThis clause\u00a0defines the procedures that are used for the interaction\nbetween SGW-C and SGW-U, PGW-C and PGW-U, TDF-C and TDF-U, and documents\nhow these procedures shall be embedded into existing procedures of\nTS\u00a023.401\u00a0[2], TS\u00a023.402\u00a0[4], TS\u00a023.060\u00a0[5] and TS\u00a023.203\u00a0[3].\n\n  NOTE:  TS\u00a023.401\u00a0[2], TS\u00a023.402\u00a0[4], TS\u00a023.060\u00a0[5] and TS\u00a023.203\u00a0[3] do\n         not reflect control and user plane separation of SGW, PGW or TDF\n         and thus the procedures in these specifications do not show the\n         interaction between the respective CP function and UP function. In\n         case of any discrepancies, the procedures defined in TS\u00a023.401\u00a0[2],\n         TS\u00a023.402\u00a0[4], TS\u00a023.060\u00a0[5] and TS\u00a023.203\u00a0[3] apply.\n\n\n"}, {"key": "Sx Session Management Procedures", "numbering": "6.2", "title_level": 1, "desc": "6.2  Sx Session Management Procedures\n\n\n"}, {"key": "General", "numbering": "6.2.1", "title_level": 2, "desc": "6.2.1  General\n\nSx session management procedures are used to control the functionality of\nthe UP function, which involve SGW, PGW or TDF. The CP function can create,\nupdate and remove the Sx session context (i.e. the parameters related to a\nPDN connection, IP-CAN session, TDF session or TDF in unsolicited reporting\nmode) in the UP function.\n\nThe following Sx session management procedures exist: Sx session\nestablishment procedure, Sx session modification procedure and Sx session\ntermination procedure. All of them are initiated by the CP function.\n\n\n"}, {"key": "Sx Session Establishment Procedure", "numbering": "6.2.2", "title_level": 2, "desc": "6.2.2  Sx Session Establishment Procedure\n\nThe Sx session establishment procedure is used to create the initial Sx\nsession context for a PDN connection, IP-CAN session, TDF session or TDF in\nunsolicited reporting mode at the UP function. The CP function assigns a\nnew Session ID and provids it to the UP function. The Session ID is stored\nby both entities and used to identify the Sx session context during their\ninteraction. The CP function stores also the relation between the Session\nID and PDN connection, IP-CAN session, TDF session or TDF in unsolicited\nreporting mode and can then correlate events reported by the UP function to\nthem.\n\nDuring PDN connection establishment, the Sx session establishment procedure\nis executed between SGW-C and SGW-U as well as PGW-C and PGW-U. The Sx\nsession context comprises the parameters for the default as well as every\ndedicated bearer of the PDN connection. In addition, the Sx session context\nfor the PGW-U comprises IP-CAN session related parameters.\n\nDuring SGW-U relocation, the Sx session establishment procedure is executed\nbetween SGW-C and the target SGW-U. The Sx session context comprises the\nparameters for the default as well as every dedicated bearer of the PDN\nconnection.\n\nDuring TDF session establishment, the Sx session establishment procedure is\nexecuted between TDF-C and TDF-U. The Sx session context comprises TDF\nsession related parameters.\n\nFor a TDF in unsolicited reporting mode, the Sx session establishment\nprocedure is executed between TDF-C and the TDF-U selected during Sx\nmanagement procedure. The Sx session context comprises the instructions for\napplication detection and reporting in unsolicited reporting mode.\n\n                                    [pic]\n\n              Figure 6.2.2-1 Sx session establishment procedure\n\n  NOTE:  In case of a TDF in unsolicited reporting mode, the procedure is\n         triggered by TDF configuration and step\u00a01 and 4 do not apply.\n\n  1. CP function receives the trigger to establish a new PDN connection or\n    TDF session from a peer CP function, an MME or a PCRF.\n\n  2. The CP function sends an Sx session establishment request message to\n    the UP function that contains the structured control information which\n    defines how the UP function needs to behave.\n\n  3. The UP function responds with an Sx session establishment response\n    message containing any information that the UP function has to provide\n    to the CP function in response to the control information received.\n\n  4. The CP function interacts with the network entity which triggered this\n    procedure (e.g. a peer CP function, an MME or a PCRF).\n\n\n"}, {"key": "Sx Session Modification Procedure", "numbering": "6.2.3", "title_level": 2, "desc": "6.2.3  Sx Session Modification Procedure\n\nThe Sx session modification procedure is used to update the Sx session\ncontext of an existing PDN connection, IP-CAN session, TDF session or TDF\nin unsolicited reporting mode at the UP function.\n\nThe Sx session modification procedure is executed between SGW-C and SGW-U\nwhenever PDN connection related parameters have to be modified, as well as\nbetween PGW-C and PGW-U whenever PDN connection or IP-CAN session related\nparameters have to be modified.\n\nThe Sx session modification procedure is executed between TDF-C and TDF-U\nwhenever TDF session related parameters have to be modified.\n\nFor a TDF in unsolicited reporting mode, the Sx session modification\nprocedure is executed between TDF-C and TDF-U whenever instructions for\napplication detection and reporting have to be modified.\n\n                                    [pic]\n\n              Figure 6.2.3-1 Sx session modification procedure\n\n  NOTE:  In case of a TDF in unsolicited reporting mode, the procedure is\n         triggered by TDF configuration and step\u00a01 and 4 do not apply.\n\n  1. CP function receives the trigger to modify the existing PDN connection\n    or TDF session from a peer CP function, an MME or a PCRF.\n\n  2. The CP function sends an Sx session modification request message to\n    the UP function that contains the update for the structured control\n    information which defines how the UP function needs to behave.\n\n  3. The UP function identifies the Sx session context to be modified by\n    the Session ID. Then, the UP function updates the parameters of this Sx\n    session context according to the list of parameters sent by the CP\n    function. The UP function responds with an Sx session modification\n    response message containing any information that the UP function has to\n    provide to the CP function in response to the control information\n    received.\n\n  4. The CP function interacts with the network entity which triggered this\n    procedure (e.g. a peer CP function, an MME or a PCRF).\n\n\n"}, {"key": "Sx Session Termination Procedure", "numbering": "6.2.4", "title_level": 2, "desc": "6.2.4  Sx Session Termination Procedure\n\nThe Sx session termination procedure is used to remove the Sx session\ncontext of an existing PDN connection, IP-CAN session, TDF session or TDF\nin unsolicited reporting mode at the UP function.\n\n                                    [pic]\n\n               Figure 6.2.4-1 Sx session termination procedure\n\n  NOTE:  In case of a TDF in unsolicited reporting mode, the procedure is\n         triggered by TDF configuration and step\u00a01 and 4 do not apply.\n\n  1. CP function receives the trigger to terminate the existing PDN\n    connection or TDF session from a peer CP function, an MME or a PCRF.\n\n  2. The CP function sends an Sx session termination request message to the\n    UP function.\n\n  3. The UP function identifies the Sx session context to be terminated by\n    the Session ID and removes the whole session context. The UP function\n    responds with an Sx session termination response message containing any\n    information that the UP function has to provide to the CP function.\n\n  4. The CP function interacts with the network entity which triggered this\n    procedure (e.g. a peer CP function, an MME or a PCRF).\n\n\n"}, {"key": "Updates to procedures in other specifications", "numbering": "6.3", "title_level": 1, "desc": ""}, {"key": "Updates to procedures specified in TS\u00a0.", "numbering": "6.3.1", "title_level": 3, "desc": "6.3  Updates to procedures in other specifications\n\n\n6.3.1  Updates to procedures specified in TS\u00a023.401\n\n\n6.3.1.1  Procedures with PDN connection establishment\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  E-UTRAN initial attach (TS\u00a023.401\u00a0[2] clause\u00a05.3.2.1)\n\n  -  UE requested PDN connectivity (TS\u00a023.401\u00a0[2] clause\u00a05.10.2)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The new SGW-C selects a new SGW-U and creates an Sx session.\n\n  -  The new PGW-C selects a new PGW-U and creates an Sx session.\n\n  -  The old SGW-C releases the existing Sx session from the old SGW-U.\n\n  -  The old PGW-C releases the existing Sx session from the old PGW-U.\n\n  -  The SGW-C modifies the SGW-U to update with the F-TEIDu of the eNodeB\n    and the PGW-U.\n\n                                    [pic]\n\n     Figure 6.3.1.1-1: Interaction between CP and UP function during PDN\n                          connection establishment\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2a.  The SGW-C may send an Sx Session Termination Request to the SGW-U to\n    release the Sx session.\n\n  2b.  The SGW-U sends an Sx Session Termination Response to the SGW-C\n    confirming the release of the Sx session.\n\n  3a.  The PGW-C may send an Sx Session Termination Request to the PGW-U to\n    release the Sx session.\n\n  3b.  The PGW-U sends an Sx Session Termination Response to the PGW-C\n    confirming the release of the Sx session.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  5a.  The SGW-C may send an Sx Session Termination Request to the SGW-U to\n    release the Sx session.\n\n  5b.  The SGW-U sends an Sx Session Termination Response to the SGW-C\n    confirming the release of the Sx session.\n\n  6a.  The PGW-C may send an Sx Session Termination Request to the PGW-U to\n    release the Sx session.\n\n  6b.  The PGW-U sends an Sx Session Termination Response to the PGW-C\n    confirming the release of the Sx session.\n\n  7. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  8a.  The SGW-C shall select new SGW-U as specified in clause\u00a05.12. If the\n    network is configured to perform F-TEIDu allocation in the CP function\n    then SGW-C allocates F-TEIDu for the default bearer. Then the SGW-C\n    sends an Sx Session Establishment Request to the selected SGW-U for\n    creating an Sx session for the UE. The F-TEIDu for the default bearer\n    shall be included if the SGW-C has allocated the same.\n\n  8b.  If the network is configured to perform F-TEIDu allocation in the UP\n    function, the SGW-U allocates F-TEIDu for the bearer. The SGW-U sends\n    an Sx Session Establishment Response to the SGW-C confirming the\n    successful creation of the Sx session. It shall include the F-TEIDu for\n    the bearer if it has allocated the same.\n\n  9. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  10a. The PGW-C shall select new PGW-U as specified in clause\u00a05.12. If the\n    network is configured to perform F-TEIDu allocation in the CP function\n    then PGW-C allocates F-TEIDu for the default bearer. Then the PGW-C\n    sends an Sx Session Establishment Request to the selected PGW-U for\n    creating an Sx session for the UE. The PGW-C shall include the F-TEIDu\n    of the default bearer received from the SGW. The F-TEIDu for the\n    default bearer shall be included if the PGW-C has allocated the same.\n\n  10b. If the network is configured to perform F-TEIDu allocation in the UP\n    function, the PGW-U allocates F-TEIDu for the bearer. The PGW-U sends\n    an Sx Session Establishment Response to the PGW-C confirming the\n    successful creation of the Sx session. It shall include the F-TEIDu for\n    the bearer if it has allocated the same.\n\n  11.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  12a. The SGW-C sends Session Modification Request to the SGW-U. The SGW-C\n    shall include the F-TEIDu of the default bearer received from the PGW.\n\n  12b. The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the success of the Sx session modification.\n\n  13.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  14a. The SGW-C sends an Sx Session Modification Request to the SGW-U. The\n    SGW-C shall include the F-TEIDu of the default bearer received from the\n    eNodeB.\n\n  14b. The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the success of the Sx session modification.\n\n  15.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  16a. If the Handover Indication is included in step\u00a015, the PGW-C updates\n    the old PGW-U session corresponding to the non-3GPP access by sending\n    \"Sx session modification request\" message to the PGW-U (session ID) and\n    instructs the PGW-U to start routing the downlink packets to the\n    SGW/SGW-U.\n\n  16b. The PGW-U sends \"Sx session modification response\" message to the\n    PGW-C.\n\n  17.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n"}, {"key": "Procedures with SGW change", "numbering": "6.3.1.2", "title_level": 3, "desc": "6.3.1.2  Procedures with SGW change\n\n\n"}, {"key": "General", "numbering": "6.3.1.2.1", "title_level": 4, "desc": ""}, {"key": "Type", "numbering": "6.3.1.2.2", "title_level": 4, "desc": ""}, {"key": "Type", "numbering": "6.3.1.2.3", "title_level": 4, "desc": "6.3.1.2.1   General\n\nThis clause covers the following two types of procedures involving SGW\nchange:\n\n  -  Type 1: Procedures in which only Create Session Request message is\n    sent from MME/SGSN to SGW-C during SGW change.\n\n  -  Type 2: Procedures in which Create Session Request message followed by\n    Modify Bearer Request message are sent from MME/SGSN to SGW-C during\n    SGW change.\n\n\n6.3.1.2.2   Type 1\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  Tracking Area Update procedure with Serving GW change (TS\u00a023.401\u00a0[2]\n    clause\u00a05.3.3.1)\n\n  -  Routing Area Update with MME interaction and with SGW change\n    (TS\u00a023.401\u00a0[2] clause\u00a05.3.3.6)\n\n  -  X2-based handover with Serving GW relocation (TS\u00a023.401\u00a0[2]\n    clause\u00a05.5.1.1.3)\n\n  -  MME triggered Serving GW relocation (TS\u00a023.401\u00a0[2] clause\u00a05.10.4)\n\n  Editor's Note: \"Tracking Area Update procedure with Serving GW change and\n         data forwarding\" (TS\u00a023.401\u00a0[2] clause 5.3.3.1A) is FFS.\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The new SGW-C selects a new SGW-U and creates an Sx session\n\n  -  The PGW-C modifies the PGW-U to update with the F-TEIDu(s) of the new\n    SGW-U\n\n  -  The old SGW-C releases the existing Sx session from the old SGW-U\n\n                                    [pic]\n\n      Figure 6.3.1.2.2-1: Interaction between CP and UP function during\n                     procedures with SGW change (Type 1)\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. The new SGW-C shall select new SGW-U as specified in clause\u00a05.12. If\n    the network is configured to perform F-TEIDu allocation in the CP\n    function then SGW-C allocates an F-TEIDu for each and every bearer.\n    Then the new SGW-C sends Sx Session Establishment Request to the\n    selected SGW-U for creating an Sx session for the UE. Additionally, an\n    F-TEIDu for each and every bearer shall be included if the SGW-C has\n    allocated the same.\n\n  3. If the network is configured to perform F-TEIDu allocation in the UP\n    function, the SGW-U allocates an F-TEIDu for each and every bearer\n    received. The new SGW-U sends Sx Session Establishment Response to the\n    new SGW-C confirming the successful creation of the Sx session. It\n    shall include the F-TEIDu for each and every bearer if it has allocated\n    the same.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  5. The PGW-C sends an Sx Session Modification Request to the PGW-U. The\n    PGW-C shall include the F-TEIDu(s) of the new SGW-U. Additionally,\n    based on the interaction with the PCRF, the PGW-C may also update other\n    Sx parameters for the PDN connection.\n\n  6. The PGW-U sends Sx Session Modification Response to the PGW-C\n    confirming the success of the Sx session modification.\n\n  7. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  8. The old SGW-C sends Sx Session Release Request to the old SGW-U to\n    release the Sx session.\n\n  9. The old SGW-U sends Sx Session Release Response to the old SGW-C\n    confirming the release of the Sx session.\n\n  10.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n6.3.1.2.3   Type 2\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  S1-based handover, normal (TS\u00a023.401\u00a0[2] clause\u00a05.5.1.2.2)\n\n  -  E-UTRAN to UTRAN Iu mode Inter RAT handover (TS\u00a023.401\u00a0[2]\n    clause\u00a05.5.2.1)\n\n  -  UTRAN Iu mode to E-UTRAN Inter RAT handover (TS\u00a023.401\u00a0[2]\n    clause\u00a05.5.2.2)\n\n  -  E-UTRAN to GERAN A/Gb mode Inter RAT handover (TS\u00a023.401\u00a0[2]\n    clause\u00a05.5.2.3)\n\n  -  GERAN A/Gb mode to E-UTRAN Inter RAT handover (TS\u00a023.401\u00a0[2]\n    clause\u00a05.5.2.4)\n\n  Editor's Note: Most of the above procedures involve establishment and\n         release of indirect data forwarding tunnel at the source and the\n         target SGW. It is FFS if this needs to be supported in the CP and\n         UP split architecture.\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The new SGW-C selects a new SGW-U and creates an Sx session.\n\n  -  The SGW-C modifies the Sx session at SGW-U to update the F-TEIDu(s) of\n    the eNB.\n\n  -  The PGW-C modifies the PGW-U to update with the F-TEIDu(s) of the new\n    SGW-U.\n\n  -  The old SGW-C releases the existing Sx session from the old SGW-U.\n\n                                    [pic]\n\n      Figure 6.3.1.2.3-1: Interaction between CP and UP function during\n                     procedures with SGW change (Type 2)\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. The new SGW-C shall select new SGW-U as specified in clause\u00a05.12. If\n    the network is configured to perform F-TEIDu allocation in the CP\n    function then SGW-C allocates F-TEIDu for each and every bearer. Then\n    the new SGW-C sends an Sx Session Establishment Request to the selected\n    SGW-U for creating an Sx session for the UE. Additionally, F-TEIDu for\n    each and every bearer shall be included if the SGW-C has allocated the\n    same. The Usage Monitoring Rules may also be included in case of home-\n    routed roaming scenario and if the inter-operator charging is required.\n\n  3. If the network is configured to perform F-TEIDu allocation in the UP\n    function, the SGW-U allocates F-TEIDu for each and every bearer\n    received. The new SGW-U sends an Sx Session Establishment Response to\n    the new SGW-C confirming the successful creation of the Sx session. It\n    shall include the F-TEIDu for each and every bearer if it has allocated\n    the same.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  5. The SGW-C sends an Sx Session Modification Request to the SGW-U. It\n    shall include the F-TEIDu of the eNB.\n\n  6. The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the successful modification of the Sx session.\n\n  7. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  8. The PGW-C sends an Sx Session Modification Request to the PGW-U. The\n    PGW-C shall include the F-TEIDu of the new SGW-U. Additionally, based\n    on the interaction with the PCRF, the PGW-C may also update other Sx\n    parameters for the PDN connection.\n\n  9. The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the success of the Sx session modification.\n\n  10.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  11.  The old SGW-C sends an Sx Session Release Request to the old SGW-U\n    to release the Sx session.\n\n  12.  The old SGW-U sends an Sx Session Release Response to the old SGW-C\n    confirming the release of the Sx session.\n\n  13.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n"}, {"key": "Procedures with eNB F-TEIDu update", "numbering": "6.3.1.3", "title_level": 3, "desc": "6.3.1.3  Procedures with eNB F-TEIDu update\n\nIn this clause, interactions between the CP and UP function during the\nfollowing procedures are considered:\n\n  -  UE triggered Service Request (TS\u00a023.401\u00a0[2] clause\u00a05.3.4.1).\n\n  -  Connection Resume procedure (TS\u00a023.401\u00a0[2] clause\u00a05.3.5A).\n\n  -  E-UTRAN initiated E-RAB modification procedure (TS\u00a023.401\u00a0[2]\n    clause\u00a05.4.7).\n\n  -  X2-based handover without Serving GW relocation (TS\u00a023.401\u00a0[2]\n    clause\u00a05.5.1.1.2).\n\n  -  S1-based handover without Serving GW change (TS\u00a023.401\u00a0[2]\n    clause\u00a05.5.1.2.2).\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The SGW-C modifies the Sx session at SGW-U to update the F-TEIDu(s) of\n    the eNB.\n\n  -  Based on the interaction with the PCRF, the PGW-C may modify the PGW-U\n    to update other Sx parameters.\n\n                                    [pic]\n\n Figure 6.3.1.3-1: Interaction between CP and UP function during procedures\n                           with eNB F-TEIDu update\n\n  1. Procedure as listed in this step is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. The SGW-C sends an Sx Session Modification Request to the SGW-U. It\n    shall include the new F-TEIDu of the eNB. Additionally, for the\n    following procedures extra steps may apply:\n\n    -  UE triggered Service Request: If the buffering of the data packets\n       in the idle mode is performed in the SGW-C and if those buffered\n       packets are still valid (e.g. data packets for which the buffering\n       duration hasn't expired yet), then SGW-C shall also provide those\n       data packets to the SGW-U (as specified in clause\u00a05.12) so that it\n       can be sent to the eNB.\n\n  3. The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the successful modification of the Sx session.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  5. Based on the interaction with the PCRF, the PGW-C may update other Sx\n    parameters for the PDN connection. Correspondingly, the PGW-C sends an\n    Sx Session Modification Request to the PGW-U.\n\n  6. The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the success of the Sx session modification.\n\n  7. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n"}, {"key": "Procedures with release of eNB F-TEIDu", "numbering": "6.3.1.4", "title_level": 3, "desc": "6.3.1.4  Procedures with release of eNB F-TEIDu\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  Connection Suspend procedure (TS\u00a023.401\u00a0[2] clause\u00a05.3.4A)\n\n  -  S1 release procedure (TS\u00a023.401\u00a0[2] clause\u00a05.3.5)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The SGW-C modifies the SGW-U to release the eNB F-TEIDu. Additionally,\n    the SGW-C configures the SGW-U so that the downlink data packets can be\n    buffered either in the SGW-C or in the SGW-U.\n\n                                    [pic]\n\n Figure 6.3.1.4-1: Interaction between CP and UP function during procedures\n                         with release of eNB F-TEIDu\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. The SGW-C sends an Sx Session Modification Request to the SGW-U. It\n    shall indicate the SGW-U to release the eNB F-TEIDu. Additionally, the\n    SGW-C decides if the buffering of the downlink data packets shall be\n    done in CP or the UP function, as specified in clause\u00a05.9) and\n    correspondingly informs the SGW-U for as follows:\n\n    -  If the downlink data packets are to be buffered in the SGW-C, the\n       SGW-C shall configure the SGW-U to forward the downlink data packets\n       for all the bearers of the UE to the SGW-C, as specified in\n       clause\u00a05.6.\n\n    -  If the downlink data packets are to be buffered in the SGW-U, the\n       SGW-C shall indicate the same to SGW-U. Additionally, the following\n       applies:\n\n       -  if the Paging Policy Differentiation feature (as specified in\n         3GPP\u00a0TS\u00a023.401\u00a0[2] clause\u00a04.9) is supported by the SGW-C and SGW-U\n         and based on operator's policy if it is required to be activated\n         for this UE, the SGW-C shall include an indication to provide the\n         DSCP in TOS (IPv4) / TC (IPv6) value from the IP header of the\n         first downlink data packet of each bearer.\n\n       -  if the PDN GW Pause Charging procedure (as specified in\n         3GPP\u00a0TS\u00a023.401\u00a0[2] clause\u00a05.3.6A) is supported by the SGW-C and SGW-\n         U and based on operator's policy if it is required to be activated\n         for this UE, the SGW-C may provide the number/fraction of\n         packets/bytes drop threshold value. When this threshold is reached,\n         the SGW-U is required to provide an indication to the SGW-C.\n\n  3. The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the successful modification of the Sx session.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n"}, {"key": "Procedures when downlink data is buffered in the UP function", "numbering": "6.3.1.5", "title_level": 3, "desc": "6.3.1.5  Procedures when downlink data is buffered in the UP function\n\nThis clause defines interactions between the CP and UP function when then\nUE is in idle mode and buffering of the downlink data is performed in the\nUP function, during the following procedures:\n\n  -  Network Triggered Service Request (TS\u00a023.401\u00a0[2] clause\u00a05.3.4.3)\n\n  -  PDN GW Pause of Charging procedure (TS\u00a023.401\u00a0[2] clause\u00a05.3.6A)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The SGW-U notifies the SGW-C that the first downlink data packet was\n    received for a bearer.\n\n  NOTE:  A bearer is identified in the SGW-U as a combination of PDR(s) and\n         FAR(s).\n\n  -  The SGW-U notifies the SGW-C that the drop threshold was reached.\n\n                                    [pic]\n\n    Figure 6.3.1.5-1: Interaction between CP and UP when downlink data is\n                         buffered in the UP function\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. When the downlink data is received, the SGW-U starts buffering it.\n\n     On arrival of the first downlink data packet for a bearer, the SGW-U\n    shall send an Sx report message (first packet indication) to the SGW-C.\n    If the Paging Policy Differentiation feature (as specified in\n    3GPP\u00a0TS\u00a023.401\u00a0[2] clause\u00a04.9) is supported by the SGW-U and if it is\n    activated by the SGW-C for this Sx session, the SGW-U shall also\n    include the DSCP in TOS (IPv4) / TC (IPv6) value from the IP header of\n    the downlink data packet.\n\n     If the SGW-C has provided the number/fraction of packets/bytes drop\n    threshold value during the procedure with release of eNB F-TEIDu\n    (clause\u00a06.3.1.4), the SGW-U shall monitor that threshold. Once the\n    threshold is reached the SGW-U shall send an Sx report message (drop\n    threshold reached) to the SGW-C.\n\n  3. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  4. The SGW-C sends an Sx report Ack message to the SGW-U. Additionally,\n    for the following procedures the following applies:\n\n    -  Network Triggered Service Request: If DL Buffering Duration time and\n       DL Buffering Suggested Packet Counts were received from the MME/SGSN\n       (refer to step\u00a0no. 2 of TS\u00a023.401\u00a0[2] clause\u00a05.3.4.3) by the SGW-C\n       then SGW-C shall include the same in the Sx report Ack message.\n\n  5. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n"}, {"key": "Procedures with release of PDN connection", "numbering": "6.3.1.6", "title_level": 3, "desc": "6.3.1.6  Procedures with release of PDN connection\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  UE-initiated Detach procedure for E-UTRAN (TS\u00a023.401\u00a0[2]\n    clause\u00a05.3.8.2.1)\n\n  -  UE-initiated Detach procedure for GERAN/UTRAN with ISR activated\n    (TS\u00a023.401\u00a0[2] clause\u00a05.3.8.2.2)\n\n  -  MME-initiated Detach procedure (TS\u00a023.401\u00a0[2] clause\u00a05.3.8.3)\n\n  -  SGSN-initiated Detach procedure with ISR activated (TS\u00a023.401\u00a0[2]\n    clause\u00a05.3.8.3A)\n\n  -  HSS-initiated Detach procedure (TS\u00a023.401\u00a0[2] clause\u00a05.3.8.4)\n\n  -  UE or MME requested PDN disconnection (TS\u00a023.401\u00a0[2] clause\u00a05.10.3)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The SGW-C terminates the Sx session at the SGW-U.\n\n  -  The PGW-C terminates the Sx session at the PGW-U.\n\n                                    [pic]\n\n Figure 6.3.1.6-1: Interaction between CP and UP function during release of\n                               PDN connection\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. The SGW-C sends an Sx Session Modification Request to the SGW-U. SGW-C\n    shall indicate SGW-U to stop counting for the affected bearers. SGW-C\n    shall also indicate the SGW-U to discard downlink packets received from\n    PGW-U for the affected bearers, and discard uplink packets received\n    from eNodeB for the affected bearers.\n\n  3. The SGW-U sends an Sx Session Modification Response to the SGW-C.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  5. The PGW-C sends an Sx Session Termination Request to the PGW-U.\n\n  6. The PGW-U sends an Sx Session Termination Response to the PGW-C\n    confirming the successful termination of the Sx session. Additionally,\n    if the usage reporting is configured by the PGW-C (as specified in\n    clause\u00a05.3.2) the PGW-U shall provide the usage report(s) for the PDN\n    connection (as specified in clause\u00a05.3.3) to the PGW-C.\n\n  7. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  8. The SGW-C sends an Sx Session Termination Request to the SGW-U.\n\n  9. The SGW-U sends an Sx Session Termination Response to the SGW-C\n    confirming the successful termination of the Sx session. Additionally,\n    if the usage reporting is configured by the SGW-C (as specified in\n    clause\u00a05.3.2) the SGW-U shall provide the usage report(s) for the PDN\n    connection (as specified in clause\u00a05.3.3) to the SGW-C.\n\n\n"}, {"key": "Procedures with modification of bearer", "numbering": "6.3.1.7", "title_level": 3, "desc": ""}, {"key": "Updates to procedures specified in TS\u00a0.", "numbering": "6.3.2", "title_level": 3, "desc": "6.3.1.7  Procedures with modification of bearer\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  Dedicated bearer activation (TS\u00a023.401\u00a0[2] clause\u00a05.4.1)\n\n  -  PDN GW initiated bearer modification with bearer QoS update\n    (TS\u00a023.401\u00a0[2] clause\u00a05.4.2.1)\n\n  -  PDN GW initiated bearer modification without bearer QoS update\n    (TS\u00a023.401\u00a0[2] clause\u00a05.4.3)\n\n  -  PDN GW initiated bearer deactivation (TS\u00a023.401\u00a0[2] clause\u00a05.4.4.1)\n\n  -  HSS Initiated Subscribed QoS Modification (TS 23.401\u00a0[2]\n    clause\u00a05.4.2.2)\n\n  -  MME Initiated Dedicated Bearer Deactivation (TS\u00a023.401\u00a0[2]\n    clause\u00a05.4.4.2)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The PGW-C modifies the Sx session at the PGW-U.\n\n  -  The SGW-C modifies the Sx session at the SGW-U.\n\n                                    [pic]\n\n       Figure 6.3.1.7-1: Interaction between CP and UP function during\n                           modification of bearer\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. The PGW-C sends an Sx Session Modification Request to the PGW-U. For\n    \"Dedicated bearer activation\", PGW-C may indicate PGW-U to allocate F-\n    TEID for the dedicate bearer. For \"PGW/MME initiated bearer\n    deactivation procedure\", PGW-C shall indicate PGW-U to stop counting\n    and stop fowarding packets for the affected bearers.\n\n  3. The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the successful modification of the Sx session.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  5. The SGW-C sends an Sx Session Modification Request to the SGW-U. For\n    \"Dedicated bearer activation\", SGW-C may indicate SGW-U to allocate F-\n    TEID for the dedicate bearer. For \"PGW/MME initiated bearer\n    deactivation procedure\", SGW-C shall indicate SGW-U to stop counting\n    and stop fowarding packets for the affected bearers.\n\n  6. The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the successful modification of the Sx session.\n\n  7. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  8. The SGW-C sends an Sx Session Modification Request to the SGW-U. For\n    dedicated bearer activation procedure, the SGW-C shall include the F-\n    TEIDu of the activated bearer received from the eNodeB. For PDN GW/HSS\n    initiated bearer modification with bearer QoS update procedure, SGW-C\n    provides updated QoS parameters to SGW-U. For PDN GW/MME initiated\n    bearer deactivation procedure, SGW-C shall indicate SGW-U to remove the\n    PDR for the affected bearers.\n\n     If the default bearer belonging to a PDN connection is deactivated,\n    the SGW-C sends an Sx Session Termination Request to the SGW-U.\n\n  9. The SGW-U sends an Sx Session Modification Response or an Sx Session\n    Termination Response to the SGW-C confirming the successful\n    modification or termination of the Sx session.\n\n  10.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  11.  The PGW-C sends an Sx Session Modification Request to the PGW-U. For\n    dedicated bearer activation procedure, the PGW-C shall include the F-\n    TEIDu of the activated bearer received from the SGW. For PDN GW/HSS\n    initiated bearer modification with bearer QoS update procedure, PGW-C\n    provides updated QoS parameters to PGW-U. For \"PDN GW initiated bearer\n    modification without bearer QoS update\" procedure, PGW-C provides\n    updated TFT to PGW-U. For PDN GW/MME initiated bearer deactivation\n    procedure, PGW-C shall indicate PGW-U to remove the PDR for the\n    affected bearers.\n\n     If the default bearer belonging to a PDN connection is deactivated,\n    the PGW-C sends an Sx Session Termination Request to the PGW-U.\n\n  12.  The PGW-U sends an Sx Session Modification Response or an Sx Session\n    Termination Response to the PGW-C confirming the successful\n    modification or termination of the Sx session.\n\n  13.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n6.3.2  Updates to procedures specified in TS\u00a023.203\n\n\n"}, {"key": "IP-CAN session establishment", "numbering": "6.3.2.1", "title_level": 3, "desc": "6.3.2.1  IP-CAN session establishment\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  IP-CAN session establishment (TS\u00a023.203\u00a0[3] clause\u00a07.2)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The new TDF-C selects a new TDF-U and creates Sx session.\n\n  -  The TDF-C modifies the TDF-U to update Sx parameters.\n\n                                    [pic]\n\n    Figure 6.3.2.1-1: Interaction between CP and UP function with IP-CAN\n                            session establishment\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. For the solicited application reporting, the PCRF requests the TDF to\n    establish the relevant session towards PCRF and provides ADC Rules to\n    the TDF. The TDF-C selects a new TDF-U as specified in clause\u00a05.12 and\n    sends an Sx Session Establishment Request to the TDF-U to establish the\n    Sx session.\n\n  3. The TDF-U sends an Sx Session Establishment Response to the TDF-C\n    confirming the successful creation of the Sx session.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n"}, {"key": "IP-CAN session termination", "numbering": "6.3.2.2", "title_level": 3, "desc": "6.3.2.2  IP-CAN session termination\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  IP-CAN session termination (TS\u00a023.203\u00a0[3] clause\u00a07.3).\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The TDF-C releases the existing Sx session from the TDF-U\n\n                                    [pic]\n\n    Figure 6.3.2.2-1: Interaction between CP and UP function with IP-CAN\n                             session termination\n\n  1. Procedure as listed in this step is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. If there is an active Sd session between TDF and PCRF, TDF-C sends an\n    Sx Session Termination Request to the TDF-U to release the Sx session.\n\n  3. The TDF-U sends an Sx Session Termination Response to the TDF-C\n    confirming the release of the Sx session\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n"}, {"key": "IP-CAN session modification", "numbering": "6.3.2.3", "title_level": 3, "desc": "6.3.2.3  IP-CAN session modification\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  IP-CAN session modification (3GPP\u00a0TS\u00a023.203\u00a0[3] clause 7.4)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The TDF-C modifies the TDF-U to update Sx parameters.\n\n  -  The PGW-C modifies the PGW-U to update Sx parameters.\n\n                                    [pic]\n\n Figure 6.3.2.3: Interaction between CP and UP function with IP-CAN session\n                                modification\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. For the TDF solicited application reporting, and PCRF provides new ADC\n    decisions to the TDF, TDF-C sends an Sx Session Modification Request to\n    the TDF-U to update Sx parameters.\n\n  3. The TDF-U sends an Sx Session Modification Response to the TDF-C\n    confirming update of Sx session\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  5. PCRF provides the updated PCC rules, and PGW-C may send an Sx Session\n    Modification Request to the PGW-U to update Sx parameters.\n\n  6. The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the update of Sx session.\n\n  7. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  NOTE:  If PCEF determines to trigger the procedures defined in\n         TS\u00a023.401\u00a0[2], e.g. modify bearer request, steps\u00a05 and 6 are\n         combined with the Sx Session Modification in the corresponding call\n         flows described in clause\u00a06.3.1.7.\n\n\n"}, {"key": "Management of PFDs", "numbering": "6.3.2.4", "title_level": 3, "desc": ""}, {"key": "Updates to procedures specified in TS\u00a0.", "numbering": "6.3.3", "title_level": 3, "desc": ""}, {"key": "Procedures with GTP based Sb establishment", "numbering": "6.3.3.1", "title_level": 3, "desc": ""}, {"key": "Procedures with GTP based Sa establishment", "numbering": "6.3.3.2", "title_level": 3, "desc": ""}, {"key": "Procedures with GTP based Sb release", "numbering": "6.3.3.3", "title_level": 3, "desc": ""}, {"key": "Procedures with GTP based Sa release", "numbering": "6.3.3.4", "title_level": 3, "desc": "6.3.2.4  Management of PFDs\n\nThis clause\u00a0defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  Procedures for management of PFDs (TS\u00a023.203\u00a0[3] clause\u00a07.12).\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The PGW-C/TDF-C provision/update/remove the PFD (s) to the PGW-U/TDF-\n    U.\n\n                                    [pic]\n\n      Figure 6.3.2.4-1: Interaction between CP and UP function with PFD\n                                 management\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. When there's any change to the PFD (s) due to pull mode or push mode\n    procedure, the PGW-C/TDF-C sends PFD management request to the PGW-\n    U/TDF-U to provision/update/remove the PFD (s).\n\n  3. PGW-U/TDF-U acknowledges by responding with PFD management response\n    message.\n\n\n6.3.3  Updates to procedures specified in TS\u00a023.402\n\n\n6.3.3.1  Procedures with GTP based S2b establishment\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  GTP based S2b for roaming, non-roaming and LBO (3GPP\u00a0TS\u00a023.402\u00a0[4]\n    clause\u00a07.2.4).\n\n  -  Emergency services over GTP based S2b (3GPP\u00a0TS\u00a023.402\u00a0[4]\n    clause\u00a07.2.5).\n\n  -  UE-initiated connectivity to additional PDN from Un-trusted Non-3GPP\n    IP Access with GTP (3GPP\u00a0TS\u00a023.402\u00a0[4] clause\u00a07.6.3).\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The new PGW-C selects a new PGW-U and creates an Sx session.\n\n                                    [pic]\n\n Figure 6.3.3.1-1: Interaction between CP and UP function with GTP based S2b\n                                establishment\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. The PGW-C shall select new PGW-U as specified in clause\u00a05.12. If the\n    network is configured to perform F-TEIDu allocation in the CP function\n    then PGW-C allocates F-TEIDu for the default bearer. Then the PGW-C\n    sends an Sx Session Establishment Request to the selected PGW-U for\n    creating an Sx session for the UE. The F-TEIDu for the default bearer\n    shall be included if the PGW-C has allocated the same.\n\n  3. If the network is configured to perform F-TEIDu allocation in the UP\n    function, the PGW-U allocates F-TEIDu for the bearer. The PGW-U sends\n    an Sx Session Establishment Response to the PGW-C confirming the\n    successful creation of the Sx session. It shall include the F-TEIDu for\n    the bearer if it has allocated the same.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n6.3.3.2  Procedures with GTP based S2a establishment\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  UE-Initiated Connectivity to PDN in WLAN on GTP S2a (TS\u00a023.402\u00a0[4]\n    clause\u00a016.8.1)\n\n  -  WLAN on GTP S2a for roaming, LBO and non-roaming scenarios\n    (TS\u00a023.402\u00a0[4] clause\u00a016.2.1)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The new PGW-C selects a new PGW-U and creates an Sx session.\n\n                                    [pic]\n\n Figure 6.3.3.2-1: Interaction between CP and UP function with GTP based S2a\n                                establishment\n\n  1-2. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  3. The PGW-C shall select new PGW-U as specified in clause\u00a05.12. If the\n    network is configured to perform F-TEIDu allocation in the CP function\n    then PGW-C allocates F-TEIDu for the default bearer. Then the PGW-C\n    sends an Sx Session Establishment Request to the selected PGW-U for\n    creating Sx session for the UE. The F-TEIDu for the default bearer\n    shall be included if the PGW-C has allocated the same.\n\n  4. If the network is configured to perform F-TEIDu allocation in the UP\n    function, the PGW-U allocates F-TEIDu for the bearer. The PGW-U sends\n    an Sx Session Establishment Response to the PGW-C confirming the\n    successful creation of the Sx session. It shall include the F-TEIDu for\n    the bearer if it has allocated the same.\n\n  5-7. The HSS/AAA is also made aware of the PGW-C identity at this time.\n    The relevant steps of the procedure as specified in the figure above\n    are then executed.\n\n     The following steps are relevant only for \"WLAN on GTP S2a for\n    roaming, LBO and non-roaming scenarios\" where TWAG using the layer 3\n    attach request (i.e. a DHCPv4 message) is sent by the UE as the attach\n    trigger. These steps are executed only if steps 3-7 shown in figure\n    16.2.1-1 are omitted where TWAP sends the layer 2 attach trigger to the\n    TWAG.\n\n  8. The PGW-C shall select new PGW-U as specified in clause\u00a05.12. If the\n    network is configured to perform F-TEIDu allocation in the CP function\n    then PGW-C allocates F-TEIDu for the default bearer. Then the PGW-C\n    sends an Sx Session Establishment Request to the selected PGW-U for\n    creating Sx session for the UE. The F-TEIDu for the default bearer\n    shall be included if the PGW-C has allocated the same.\n\n  9. If the network is configured to perform F-TEIDu allocation in the UP\n    function, the PGW-U allocates F-TEIDu for the bearer. The PGW-U sends\n    an Sx Session Establishment Response to the PGW-C confirming the\n    successful creation of the Sx session. It shall include the F-TEIDu for\n    the bearer if it has allocated the same.\n\n  10-11. The relevant steps of the procedure as specified in the figure\n    above are executed.\n\n\n6.3.3.3  Procedures with GTP based S2b release\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  UE/ePDG-initiated detach procedure with GTP on S2b (TS\u00a023.402\u00a0[4]\n    clause\u00a07.4.3.1)\n\n  -  HSS/AAA-initiated detach procedure with GTP on S2b (TS\u00a023.402\u00a0[4]\n    clause\u00a07.4.4.1)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The PGW-C releases the existing Sx session from the PGW-U.\n\n                                    [pic]\n\n  Figure 6.3.3.3-1: Interaction between CP and UP function with release of\n                                GTP based S2b\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. The PGW-C sends an Sx Session Termination Request to the PGW-U to\n    release the Sx session.\n\n  3. The PGW-U sends an Sx Session Termination Response to the PGW-C\n    confirming the release of the Sx session.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n6.3.3.4  Procedures with GTP based S2a release\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  UE/TWAN Initiated Detach and UE/TWAN requested PDN Disconnection on\n    GTP S2a (TS\u00a023.402\u00a0[4] clause\u00a016.3.1.1)\n\n  -  UE/TWAN-Initiated Detach in WLAN on GTP S2a (TS\u00a023.402\u00a0[4]\n    clause\u00a016.7.1.1)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The PGW-C releases the existing Sx session from the PGW-U.\n\n                                    [pic]\n\n  Figure 6.3.3.4-1: Interaction between CP and UP function with release of\n                                GTP based S2a\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. The PGW-C sends an Sx Session Termination Request to the PGW-U to\n    release the Sx session.\n\n  3. The PGW-U sends an Sx Session Termination Response to the PGW-C\n    confirming the release of the Sx session.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n"}, {"key": "Procedures with dedicated bearer activation by PGW", "numbering": "6.3.3.5", "title_level": 3, "desc": "6.3.3.5  Procedures with dedicated bearer activation by PGW\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  Dedicated S2b Bearer Activation Procedure with GTP on S2b\n    (TS\u00a023.402\u00a0[4] clause\u00a07.10)\n\n  -  Dedicated S2a Bearer Activation Procedure with GTP on S2a\n    (TS\u00a023.402\u00a0[4] clause\u00a016.5)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The PGW-C modifies the existing Sx session for activating new\n    dedicated bearer.\n\n                                    [pic]\n\n   Figure 6.3.3.5-1: Interaction between CP and UP function with dedicated\n                          bearer activation by PGW\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. The PGW-C initiates dedicated bearer activation procedure based on the\n    PCC decision provision (QoS policy) message received from the PCRF. It\n    uses received QoS policy to assign the EPS Bearer QoS, i.e., it assigns\n    the values to the bearer level QoS parameters QCI, ARP, GBR and MBR.\n    The PGW-C sends an Sx Session Modification Request to the existing PGW-\n    U for activating new dedicated bearer for the UE. If the TEIDs\n    allocation is done in the CP function then PGW-C shall allocate TEIDs\n    for the new bearer(s) and sends them to the PGW-U.\n\n  3. If the F-TEIDu allocation is done in the UP function, the PGW-U shall\n    allocate TEIDs for the new bearer(s). The PGW-U sends an Sx Session\n    Modification Response to the PGW-C confirming the successful\n    modification of the Sx session. It shall include the TEIDs for the new\n    bearer(s) if it has allocated the same.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n"}, {"key": "Procedures with bearer deactivation by PGW", "numbering": "6.3.3.6", "title_level": 3, "desc": "6.3.3.6  Procedures with bearer deactivation by PGW\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  PDN GW Initiated Bearer Deactivation with GTP on S2b (TS\u00a023.402\u00a0[4]\n    clause\u00a07.9.2)\n\n  -  PDN GW Initiated Bearer Deactivation with GTP on S2a (TS\u00a023.402\u00a0[4]\n    clause\u00a016.4.1)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The PGW-C modifies the existing Sx session for deactivating the\n    dedicated bearer.\n\n                                    [pic]\n\n    Figure 6.3.3.6-1: Interaction between CP and UP function with bearer\n                            deactivation by PGW-C\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. The PGW-C initiates bearer deactivation procedure based on IP-CAN\n    modifications encountered by the PCRF when the dynamic PCC is deployed.\n    The PGW-C sends an Sx Session Modification Request to the existing PGW-\n    U for deactivating the dedicated bearer for the UE. If the TEIDs\n    allocation was done in the CP function then PGW-C shall de-allocate\n    these TEIDs.\n\n  3. If the TEIDs allocation was done in the UP function then PGW-U shall\n    de-allocate these TEIDs once it receives Sx Session Modification\n    Request from the PGW-C. The PGW-U sends an Sx Session Modification\n    Response to the PGW-C confirming the successful modification of the Sx\n    session.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n"}, {"key": "Procedures with bearer modification", "numbering": "6.3.3.7", "title_level": 3, "desc": ""}, {"key": "Procedures with handover from non-GPP access", "numbering": "6.3.3.8", "title_level": 3, "desc": ""}, {"key": "Procedures with handover from GPP access", "numbering": "6.3.3.9", "title_level": 3, "desc": ""}, {"key": "Updates to procedures specified in TS\u00a0.", "numbering": "6.3.4", "title_level": 3, "desc": "6.3.3.7  Procedures with bearer modification\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  S2b Bearer Modification Procedure with GTP on S2b (TS\u00a023.402\u00a0[4]\n    clause\u00a07.11.1)\n\n  -  HSS Initiated Subscribed QoS Modification (TS\u00a023.402\u00a0[4]\n    clause\u00a07.11.2)\n\n  -  PDN GW-initiated S2a Bearer Modification Procedure with GTP on S2a\n    (TS\u00a023.402\u00a0[4] clause\u00a016.6.1)\n\n  -  HSS Initiated Subscribed QoS Modification (TS\u00a023.402\u00a0[4]\n    clause\u00a016.6.2)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The PGW-C modifies the existing Sx session for modification of the\n    existing bearer.\n\n                                    [pic]\n\n    Figure 6.3.3.7-1: Interaction between CP and UP function with bearer\n                                modification\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. The PGW-C initiates dedicated bearer modification procedure based on\n    the PCC decision provision (QoS policy) message received from the PCRF.\n    It uses this QoS policy to determine that a service data flow shall be\n    aggregated to or removed from an active bearer or that the authorized\n    QoS of a service data flow has changed. The PGW-C sends an Sx Session\n    Modification Request to the existing PGW-U for modification of the\n    existing bearer for the UE.\n\n  3. The PGW-U updates the Sx parameters and sends an Sx Session\n    Modification Response to the PGW-C confirming the successful\n    modification of the Sx session.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n6.3.3.8  Procedures with handover from non-3GPP access\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  Handover from Trusted Non-3GPP IP Access to E-UTRAN with GTP on S2a or\n    S2b and GTP on S5/S8 interfaces (TS\u00a023.402\u00a0[4] clause\u00a08.2.1.1 and\n    clause\u00a016.11).\n\n  -  Handover from Trusted Non-3GPP IP Access to UTRAN/GERAN with GTP on\n    S2a and GTP based S5/S8 (TS\u00a023.402\u00a0[4] clause\u00a08.2.1.3 and\n    clause\u00a016.11).\n\n  -  Handover from Untrusted Non-3GPP IP Access to E-UTRAN with GTP on S2b\n    and GTP on S5/S8 interfaces (TS\u00a023.402\u00a0[4] clause\u00a08.6.1.1).\n\n  -  Handover from Untrusted Non-3GPP IP Access to UTRAN/GERAN with GTP on\n    S2b and GTP on S5/S8 interfaces (TS\u00a023.402\u00a0[4] clause\u00a08.6.1.2).\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The SGW-C selects a SGW-U and creates an Sx session.\n\n  -  The SGW-C modifies the existing Sx session for modification of the\n    bearer.\n\n  -  The PGW-C selects a PGW-U and creates an Sx session.\n\n  -  The PGW-C modifies the existing Sx session for modification of the\n    bearer.\n\n                                    [pic]\n\n Figure 6.3.3.8-1: Interaction between CP and UP function with handover from\n                               non-3GPP access\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. The SGW-C shall select SGW-U as specified in clause\u00a05.12 when the\n    request with a Handover Indication information. If the network is\n    configured to perform F-TEIDu allocation in the CP function then SGW-C\n    allocates F-TEIDu for each and every bearer. Then the SGW-C sends Sx\n    Session Establishment Request to the selected SGW-U for creating Sx\n    session for the UE. The F-TEIDu for each and every bearer shall be\n    included if the SGW-C has allocated the same.\n\n  3. If the network is configured to perform F-TEIDu allocation in the UP\n    function, the SGW-U allocates F-TEIDu for all received bearers. The SGW-\n    U sends Sx Session Establishment Response to the SGW-C confirming the\n    successful creation of the Sx session. It shall include the F-TEIDu for\n    each and every bearer if it has allocated the same.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed. Since Handover Indication is included, the PGW-C may\n    execute a PCEF-Initiated IP-CAN Session Modification Procedure with the\n    PCRF.\n\n  5. If the network is configured to perform F-TEIDu allocation in the CP\n    function then PGW-C allocates F-TEIDu for each and every bearer. Then\n    the PGW-C sends an Sx Session Modification Request to the PGW-U for\n    modifying the Sx session for the UE. The F-TEIDu for each and every\n    bearer shall be included if the PGW-C has allocated the same.\n\n  6. If the network is configured to perform F-TEIDu allocation in the UP\n    function, the PGW-U allocates F-TEIDu for all received bearers. The PGW-\n    U sends an Sx Session Modification Response to the PGW-C confirming the\n    successful modification of the Sx session. It shall include the F-TEIDu\n    for each and every bearer if it has allocated the same.\n\n  7. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  8. The SGW-C sends an Sx Session Modification Request after Radio and\n    Access bearers are established at the SGW-C.\n\n  9. The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the successful modification of the Sx session.\n\n  10.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  11.  The PGW-C sends an Sx Session Modification Request to prompt the PGW-\n    U to tunnel packets from non 3GPP IP access to 3GPP access system and\n    immediately start routing packets to the SGW-U for the default and any\n    dedicated EPS bearers established.\n\n  12.  The PGW-U sends an Sx Session Modification Response to the PGW-C.\n\n  13.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n6.3.3.9  Procedures with handover from 3GPP access\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures:\n\n  -  Handover from 3GPP Access to Untrusted Non-3GPP IP Access with GTP on\n    S2b (TS\u00a023.402\u00a0[4] clause\u00a08.6.2.1)\n\n  -  Handover in single-connection mode from 3GPP access to Trusted WLAN on\n    GTP S2a for roaming and non-roaming scenarios (TS\u00a023.402\u00a0[4]\n    clause\u00a016.10.1.1)\n\nDuring the above procedures following is the nature of interactions between\nthe CP and UP function:\n\n  -  The new PGW-C selects a new PGW-U and creates an Sx session.\n\n                                    [pic]\n\n Figure 6.3.3.9-1: Interaction between CP and UP function with handover from\n                                 3GPP access\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2. If the network is configured to perform F-TEIDu allocation in the CP\n    function then PGW-C allocates F-TEIDu for each and every bearer. Then\n    the PGW-C sends an Sx Session Establishment Request to the selected PGW-\n    U for modifying the Sx session for the UE. The F-TEIDu for each and\n    every bearer shall be included if the PGW-C has allocated the same.\n\n  3. If the network is configured to perform F-TEIDu allocation in the UP\n    function, the PGW-U allocates F-TEIDu for all received bearers. The PGW-\n    U sends an Sx Session Establishment Response to the PGW-C confirming\n    the successful modification of the Sx session. It shall include the F-\n    TEIDu for each and every bearer if it has allocated the same.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n6.3.4  Updates to procedures specified in TS\u00a023.060\n\n\n"}, {"key": "Procedures with PDN connection deactivation", "numbering": "6.3.4.1", "title_level": 3, "desc": ""}, {"key": "Procedures with SGSN terminating S interface", "numbering": "6.3.4.1.1", "title_level": 4, "desc": "6.3.4.1  Procedures with PDN connection deactivation\n\n\n6.3.4.1.1   Procedures with SGSN terminating S4 interface\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures related to the deactivation of a PDN connection:\n\nGroup 1:\n\n  -  Combined GPRS / IMSI Attach procedure:\n\n    -  Including steps specific for S4 SGSN: Combined GPRS / IMSI Attach\n       procedure, Delete Bearer by the new SGSN, using S4, and Combined GPRS\n       / IMSI Attach procedure, Delete Bearer by the old SGSN, using S4.\n\n  -  MS-Initiated Combined GPRS / IMSI Detach Procedure.\n\n  -  SGSN-Initiated GPRS Detach Procedure.\n\n  -  HLR-Initiated GPRS Detach Procedure:\n\n    -  Including steps specific for S4 SGSN: SGSN interaction during Detach\n       Procedure when using S4.\n\n  -  MS Initiated Bearer Deactivation Procedure for A/Gb mode (with\n    Teardown Ind).\n\n  -  MS Initiated Bearer Deactivation Procedure for Iu mode (with Teardown\n    Ind).\n\n  -  SGSN-initiated Bearer Deactivation Procedure (with Teardown Ind):\n\n    -  Including steps specific for S4 SGSN: MS-and SGSN Initiated PDN\n       connection Deactivation Procedure using S4.\n\nGroup 2:\n\n  -  GGSN-initiated PDP Context Deactivation Procedure (with Teardown Ind):\n\n    -  Including steps specific for S4 SGSN: PDN GW-initiated Bearer\n       Deactivation Procedure using S4, part 1 and part 2.\n\nDuring the above procedures, following is the nature of interactions\nbetween the CP and UP function:\n\n  -  The SGW-C releases the existing Sx session from SGW-U.\n\n  -  The PGW-C releases the existing Sx session from PGW-U.\n\n  -  The SGW-C modifies the existing Sx session for SGW-U.\n\n  -  The PGW-C modifies the existing Sx session for PGW-U.\n\n                                    [pic]\n\n     Figure 6.3.4.1.1-1: Interaction between CP and UP function with PDN\n                       connection deactivation Group 1\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2a.  The SGW-C sends an Sx Session Modification Request to the SGW-U to\n    modify the Sx session. SGW-C shall request SGW-U to stop counting for\n    the affected bearers. SGW-C shall also request the SGW-U to discard\n    downlink packets received from PGW-U for the affected bearers, and\n    discard uplink packets received from eNodeB for the affected bearers.\n\n  2b.  The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the modification of the Sx session.\n\n  2c.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  3a.  The PGW-C may send an Sx Session Termination Request to the PGW-U to\n    release the Sx session.\n\n  3b.  The PGW-U sends an Sx Session Termination Response to the PGW-C\n    confirming the release of the Sx session.\n\n  3c.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  3d.  The SGW-C may send an Sx Session Termination Request to the SGW-U to\n    release the Sx session.\n\n  3e.  The SGW-U sends an Sx Session Termination Response to the SGW-C\n    confirming the release of the Sx session.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  5a.  The SGW-C may send an Sx Session Modification Request to the SGW-U\n    in detach and Bearer Deactivation procedures. SGW-C shall indicate SGW-\n    U to stop counting for the affected bearers. SGW-C shall also indicate\n    the SGW-U to discard downlink packets received from PGW-U for the\n    affected bearers, and discard uplink packets received from eNodeB for\n    the affected bearers..\n\n  5b.  The SGW-U sends an Sx Session Modification Response to the SGW-C.\n\n  6. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  7a.  The PGW-C may send an Sx Session Termination Request to the PGW-U to\n    release the Sx session.\n\n  7b.  The PGW-U sends an Sx Session Termination Response to the PGW-C\n    confirming the release of the Sx session.\n\n  8. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  9a.  The SGW-C may send an Sx Session Termination Request to the SGW-U to\n    release the Sx session.\n\n  9b.  The SGW-U sends an Sx Session Termination Response to the SGW-C\n    confirming the release of the Sx session.\n\n  10.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n                                    [pic]\n\n     Figure 6.3.4.1.1-2: Interaction between CP and UP function with PDN\n                       connection deactivation Group 2\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2a.  The PGW-C sends an Sx Session Modification Request to the PGW-U when\n    it initiates bearer deactivation procedure. PGW-C shall indicate PGW-U\n    to stop counting for the affected bearers. PGW-C shall also indicate\n    the PGW-U to discard packets received for the affected bearers.\n\n  2b.  The PGW-U sends an Sx Session Modification Response to the PGW-C.\n\n  3a.  The SGW-C sends an Sx Session Modification Request to the SGW-U. SGW-\n    C shall indicate SGW-U to stop counting for the affected bearers. SGW-C\n    shall also indicate the SGW-U to discard packets received for the\n    affected bearers.\n\n  3b.  The SGW-U sends an Sx Session Modification Response to the SGW-C.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  5a.  The SGW-C sends an Sx Session Termination Request to the SGW-U to\n    release the Sx session.\n\n  5b.  The SGW-U sends an Sx Session Termination Response to the SGW-C\n    confirming the release of the Sx session.\n\n  6. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  7a.  The PGW-C sends an Sx Session Termination Request to the PGW-U to\n    release the Sx session.\n\n  7b.  The PGW-U sends an Sx Session Termination Response to the PGW-C\n    confirming the release of the Sx session.\n\n  8. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n"}, {"key": "Procedures with SGSN terminating Gn/Gp interface", "numbering": "6.3.4.1.2", "title_level": 4, "desc": "6.3.4.1.2   Procedures with SGSN terminating Gn/Gp interface\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures related to the deactivation of a PDN connection:\n\nGroup 1:\n\n  -  Combined GPRS / IMSI Attach procedure.\n\n  -  MS-Initiated Combined GPRS / IMSI Detach Procedure.\n\n  -  SGSN-Initiated GPRS Detach Procedure.\n\n  -  HLR-Initiated GPRS Detach Procedure.\n\n   - MS Initiated PDP Context Deactivation Procedure for A/Gb mode (with\n    Teardown Ind).\n\n  -  MS Initiated PDP Context Deactivation Procedure for Iu mode (with\n    Teardown Ind).\n\n  -  SGSN-initiated PDP Context Deactivation Procedure (with Teardown Ind).\n\nGroup 2:\n\n  -  GGSN-initiated PDP Context Deactivation Procedure (with Teardown Ind).\n\nDuring the above procedures, following is the nature of interactions\nbetween the CP and UP function:\n\n  -  The PGW-C releases the existing Sx session from PGW-U.\n\n                                    [pic]\n\n     Figure 6.3.4.1.2-1: Interaction between CP and UP function with PDN\n                       connection deactivation Group 1\n\n  1. Procedure as listed in this step is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2a.  The PGW-C may send an Sx Session Termination Request to the PGW-U to\n    release the Sx session.\n\n  2b.  The PGW-U sends an Sx Session Termination Response to the PGW-C\n    confirming the release of the Sx session.\n\n  3. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  4a.  The PGW-C may send an Sx Session Termination Request to the PGW-U to\n    release the Sx session.\n\n  4b.  The PGW-U sends an Sx Session Termination Response to the PGW-C\n    confirming the release of the Sx session.\n\n  5. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n                                    [pic]\n\n     Figure 6.3.4.1.2-2: Interaction between CP and UP function with PDN\n                       connection deactivation Group 2\n\n  1. Procedure as listed in this step is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2a.  The PGW-C sends an Sx Session Modification Request to the PGW-U when\n    it initiates bearer deactivation procedure. PGW-C shall indicate PGW-U\n    to stop counting for the affected bearers. PGW-C shall also indicate\n    the PGW-U to discard packets received for the affected bearers.\n\n  2b.  The PGW-U sends an Sx Session Modification Response to the PGW-C.\n\n  3. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  4a.  The PGW-C sends an Sx Session Termination Request to the PGW-U to\n    release the Sx session.\n\n  4b.  The PGW-U sends an Sx Session Termination Response to the PGW-C\n    confirming the release of the Sx session.\n\n  5. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n\n"}, {"key": "Procedures with PDN connection modification", "numbering": "6.3.4.2", "title_level": 3, "desc": ""}, {"key": "Procedures with SGSN terminating S interface", "numbering": "6.3.4.2.1", "title_level": 4, "desc": "6.3.4.2  Procedures with PDN connection modification\n\n\n6.3.4.2.1   Procedures with SGSN terminating S4 interface\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures related to the modification of a PDN connection.\n\nGroup 1 Procedures for Location Management, Handover, Service Request and\nInter-System Change:\n\n  -  Inter SGSN Routeing Area Update Procedure:\n\n    -  Including steps specific for S4 SGSN: Inter SGSN Routeing Area\n       Update and Combined Inter SGSN RA / LA Update using S4.\n\n  -  Combined RA / LA Update in the Case of Inter SGSN RA Update Procedure:\n\n    -  Including steps specific for S4 SGSN: Inter SGSN Routeing Area\n       Update and Combined Inter SGSN RA / LA Update using S4.\n\n  -  Iu mode RA Update Procedure:\n\n    -  Including steps specific for S4 SGSN: Routeing Area Update Procedure\n       using S4.\n\n  -  SRNS Relocation Procedure.\n\n  -  Combined Hard Handover and SRNS Relocation Procedure.\n\n  -  Combined Cell / URA Update and SRNS Relocation Procedure:\n\n    -  Including steps specific for S4 SGSN: Serving RNS Relocation\n       Procedure, Combined Hard Handover and SRNS Relocation Procedure, and\n       Combined Cell / URA Update and SRNS Relocation Procedure Using S4.\n\n  -  Enhanced Serving RNS Relocation:\n\n    -  Including steps specific for S4 SGSN: Enhanced Serving RNS\n       Relocation Procedure using S4.\n\n  -  MS Initiated Service Request Procedure.\n\n  -  Network Initiated Service Request Procedure:\n\n    -  Including steps specific for S4 SGSN: UE Initiated Service Request\n       Procedure Using S4.\n\n  -  Iu mode to A/Gb mode Intra SGSN Change:\n\n    -  Including steps specific for S4 SGSN: Iu mode to A/Gb mode Intra\n       SGSN Change using S4.\n\n  -  A/Gb mode to Iu mode Intra SGSN Change:\n\n    -  Including steps specific for S4 SGSN: A/Gb mode to Iu mode Intra-\n       SGSN Change using S4.\n\n  -  Iu mode to A/Gb mode Inter-SGSN Change:\n\n    -  Including steps specific for S4 SGSN: Iu mode to A/Gb mode Inter-\n       SGSN Change using S4.\n\n  -  A/Gb mode to Iu mode Inter SGSN Change:\n\n    -  Including steps specific for S4 SGSN: A/Gb mode to Iu mode Inter-\n       SGSN Change using S4.\n\n  -  GPRS Paging Procedure (A/Gb mode):\n\n    -  S4 specific handling in Paging response for GPRS Downlink Transfer\n       with no established user plane on S4.\n\nGroup 2 UE/SGSN initiated PDN connection modification:\n\n  -  Secondary PDP Context Activation Procedure for A/Gb mode.\n\n  -  Secondary PDP Context Activation Procedure for Iu mode:\n\n    -  Including steps specific for S4 SGSN: Secondary PDP Context\n       Activation Procedure, PDP Creation part, using S4.\n\n  -  MS-Initiated PDP Context Modification Procedure, A/Gb mode.\n\n  -  MS-Initiated PDP Context Modification Procedure, Iu mode.\n\n  -  SGSN-Initiated PDP Context Modification Procedure, A/Gb mode.\n\n  -  SGSN-Initiated PDP Context Modification Procedure, Iu mode:\n\n    -  Including steps specific for S4 SGSN: Request part of SGSN-Initiated\n       EPS Bearer Modification Procedure using S4, and Update part of SGSN-\n       Initiated EPS Bearer Modification Procedure using S4.\n\n  -  MS Initiated PDP Context Deactivation Procedure for A/Gb mode (without\n    Teardown Ind).\n\n  -  MS Initiated PDP Context Deactivation Procedure for Iu mode (without\n    Teardown Ind).\n\n  -  SGSN-initiated PDP Context Deactivation Procedure (without Teardown\n    Ind):\n\n    -  Steps specific for S4 SGSN: MS-and SGSN Initiated Bearer\n       Deactivation Procedure.\n\nGroup 3 PGW initiated PDN connection modification:\n\n  -  Network Requested Secondary PDP Context Activation Procedure using S4.\n\n  -  GGSN-Initiated PDP Context Modification Procedure:\n\n    -  Including steps specific for S4 SGSN: PGW-Initiated Bearer\n       Modification Procedure, A/Gb mode.\n\n  -  GGSN-Initiated PDP Context Modification Procedure:\n\n    -  Including steps specific for S4 SGSN: PGW-Initiated Bearer\n       Modification Procedure, Iu mode.\n\n  -  GGSN-initiated PDP Context Deactivation Procedure (without Teardown\n    Ind):\n\n    -  Including steps specific for S4 SGSN: PGW-initiated Bearer\n       Deactivation Procedure\n\nDuring the above procedures, following is the nature of interactions\nbetween the CP and UP function:\n\n  -  The SGW-C informs the SGW-U to modify the Sx session.\n\n  -  The PGW-C informs the PGW-U to modify the Sx session.\n\n                                    [pic]\n\n     Figure 6.3.4.2.1-1: Interaction between CP and UP function with PDN\n                      connection modification, Group 1\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2a.  The SGW-C may send an Sx Session Modification Request to the SGW-U\n    to update the Sx session.\n\n  2b.  The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the update the Sx session.\n\n  2c.  The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  3a.  The PGW-C may send an Sx Session Modification Request to the PGW-U\n    to update the Sx session.\n\n  3b.  The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the update the Sx session.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  NOTE\u00a01:  Step 2a/2b happens when SGW-C receives request message from S4\n         SGSN, and step 3a/3b happens when PGW-C receives request message\n         from SGW-C.\n\n                                    [pic]\n\n     Figure 6.3.4.2.1-2: Interaction between CP and UP function with PDN\n                      connection modification, Group 2\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2a.  The PGW-C may send an Sx Session Modification Request to the PGW-U\n    to update the Sx session. For \"Secondary PDP Context Activation\n    Procedure\", PGW-C may request PGW-U to allocate F-TEID for the\n    dedicated bearer. For \"MS- or SGSN- Initiated PDP Context Deactivation\n    Procedure\", PGW-C shall request PGW-U to stop counting and stop\n    forwarding packets for the affected bearers.\n\n  2b.  The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the update the Sx session.\n\n  3. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  4a.  The SGW-C may send an Sx Session Modification Request to the SGW-U\n    to update the Sx session. For \"Secondary PDP Context Activation\n    Procedure\", SGW-C may request SGW-U to allocate F-TEID for the dedicate\n    bearer. For \"MS- or SGSN Initiated PDP Context Deactivation Procedure\",\n    SGW-C shall request SGW-U to stop counting and stop forwarding packets\n    for the affected bearers.\n\n  4b.  The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the update the Sx session.\n\n  5. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  6a.  The SGW-C may send an Sx Session Modification Request to the SGW-U\n    to update the Sx session. For \"Secondary PDP Context Activation\n    Procedure\", the SGW-C shall include the F-TEIDu of the activated bearer\n    received from the S4 SGSN or RNC. For \"MS- or SGSN- initiated PDP\n    Context Modification\" with bearer QoS update procedure, SGW-C provides\n    updated QoS parameters to SGW-U. For \"MS- or SGSN Initiated PDP Context\n    Deactivation Procedure\", SGW-C shall request SGW-U to remove the PDR\n    for the affected bearers.\n\n  6b.  The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the update the Sx session.\n\n  7. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  8a.  The PGW-C may send an Sx Session Modification Request to the PGW-U\n    to update the Sx session. For \"Secondary PDP Context Activation\n    Procedure\", the PGW-C shall include the F-TEIDu of the activated bearer\n    received from the SGW. For \"MS- or SGSN- Initiated PDP Context\n    Deactivation Procedure, the PGW-C shall request PGW-U to remove the PDR\n    for the affected bearers.\n\n  8b.  The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the update the Sx session.\n\n  NOTE\u00a02:  Step\u00a02a/2b happens before PGW-C sends request message to SGW-C,\n         and step\u00a08a/8b happens when PGW-C receives response message from\n         SGW-C.\n\n  NOTE\u00a03:  Step\u00a04a/4b happens when SGW-C receives request message from PGW-\n         C, and step\u00a06a/6b happens when SGW-C receives response message from\n         S4 SGSN.\n\n                                    [pic]\n\n     Figure 6.3.4.2.1-3: Interaction between CP and UP function with PDN\n                      connection modification, Group 3\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2a.  The PGW-C may send an Sx Session Modification Request to the PGW-U\n    to update the Sx session. For \"Network Requested Secondary PDP Context\n    Activation Procedure\", PGW-C may request PGW-U to allocate F-TEID for\n    the dedicated bearer. For \"GGSN Initiated PDP Context Deactivation\n    Procedure\", PGW-C shall request PGW-U to stop counting and stop\n    forwarding packets for the affected bearers.\n\n  2b.  The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the update the Sx session.\n\n  3a.  The SGW-C may send an Sx Session Modification Request to the SGW-U\n    to update the Sx session. For \"Network Requested Secondary PDP Context\n    Activation Procedure\", SGW-C may request SGW-U to allocate F-TEID for\n    the dedicate bearer. For \"GGSN Initiated PDP Context Deactivation\n    Procedure\", SGW-C shall request SGW-U to stop counting and stop\n    forwarding packets for the affected bearers.\n\n  3b.  The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the update the Sx session.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  5a.  The SGW-C may send an Sx Session Modification Request to the SGW-U\n    to update the Sx session. For \"Network Requested Secondary PDP Context\n    Activation Procedure\", the SGW-C shall include the F-TEIDu of the\n    activated bearer received from the S4 SGSN or RNC. For \"GGSN initiated\n    PDP Context Modification\" with bearer QoS update, SGW-C provides\n    updated QoS parameters to SGW-U. For \"GGSN Initiated PDP Context\n    Deactivation Procedure\", SGW-C shall request SGW-U to remove the PDR\n    for the affected bearers.\n\n  5b.  The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the update the Sx session.\n\n  6. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  7a.  The PGW-C may send an Sx Session Modification Request to the PGW-U\n    to update the Sx session. For \"Network Requested Secondary PDP Context\n    Activation Procedure\", the PGW-C shall include the F-TEIDu of the\n    activated bearer received from the SGW. For \"GGSN initiated PDP Context\n    Modification\" with bearer QoS update, PGW-C provides updated QoS\n    parameters to PGW-U. For \"GGSN Initiated PDP Context Deactivation\n    Procedure, the PGW-C shall request PGW-U to remove the PDR for the\n    affected bearers.\n\n  7b.  The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the update the Sx session.\n\n  NOTE\u00a04:  Step\u00a02a/2b happens before PGW-C sends request message to SGW-C,\n         and step\u00a07a/7b happens when PGW-C receives response message from\n         SGW-C.\n\n  NOTE\u00a05:  Step\u00a03a/3b happens when SGW-C receives request message from PGW-\n         C, and step\u00a05a/5b happens when SGW-C receives response message from\n         S4 SGSN.\n\n\n"}, {"key": "Procedures with SGSN terminating Gn/Gp interface", "numbering": "6.3.4.2.2", "title_level": 4, "desc": "6.3.4.2.2   Procedures with SGSN terminating Gn/Gp interface\n\nThis clause defines interactions between the CP and UP function during the\nfollowing procedures related to the modification of a PDN connection.\n\nGroup 1 Procedures for Location Management, Handover, Service Request and\nInter-System Change:\n\n  -  Inter SGSN Routeing Area Update Procedure.\n\n  -  Combined RA / LA Update in the Case of Inter SGSN RA Update Procedure.\n\n  -  Iu mode RA Update Procedure.\n\n  -  SRNS Relocation Procedure.\n\n  -  Combined Hard Handover and SRNS Relocation Procedure.\n\n  -  Combined Cell / URA Update and SRNS Relocation Procedure.\n\n  -  Enhanced Serving RNS Relocation.\n\n  -  MS Initiated Service Request Procedure.\n\n  -  Network Initiated Service Request Procedure.\n\n  -  Iu mode to A/Gb mode Intra SGSN Change.\n\n  -  A/Gb mode to Iu mode Intra SGSN Change.\n\n  -  Iu mode to A/Gb mode Inter-SGSN Change.\n\n  -  A/Gb mode to Iu mode Inter SGSN Change.\n\n  -  GPRS Paging Procedure (A/Gb mode).\n\nGroup 2 UE/SGSN initiated PDN connection modification:\n\n  -  Secondary PDP Context Activation Procedure for A/Gb mode.\n\n  -  Secondary PDP Context Activation Procedure for Iu mode.\n\n  -  SGSN-Initiated PDP Context Modification Procedure, A/Gb mode.\n\n  -  SGSN-Initiated PDP Context Modification Procedure, Iu mode.\n\n  -  MS-Initiated PDP Context Modification Procedure, A/Gb mode.\n\n  -  MS-Initiated PDP Context Modification Procedure, Iu mode.\n\n  -  MS Initiated PDP Context Deactivation Procedure for A/Gb mode (without\n    Teardown Ind).\n\n  -  MS Initiated PDP Context Deactivation Procedure for Iu mode (without\n    Teardown Ind).\n\n  -  SGSN-initiated PDP Context Deactivation Procedure (without Teardown\n    Ind).\n\nGroup 3 PGW initiated PDN connection modification:\n\n  -  Network Requested Secondary PDP Context Activation Procedure using Gn\n\n  -  GGSN-Initiated PDP Context Modification Procedure for A/Gb mode\n\n  -  GGSN-Initiated PDP Context Modification Procedure for Iu mode\n\n  -  GGSN-initiated PDP Context Deactivation Procedure\n\nDuring the above procedures, following is the nature of interactions\nbetween the CP and UP function:\n\n  -  The PGW-C informs the PGW-U to modify the Sx session.\n\n                                    [pic]\n\n     Figure 6.3.4.2.2-1: Interaction between CP and UP function with PDN\n                      connection modification, Group 1\n\n  1. Procedure as listed in this step is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2a.  The PGW-C may send an Sx Session Modification Request to the PGW-U\n    to update the Sx session.\n\n  2b.  The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the update the Sx session.\n\n  3. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  NOTE\u00a01:  Step\u00a02a/2b happens when PGW-C receives request message from\n         GnSGSN.\n\n                                    [pic]\n\n     Figure 6.3.4.2.2-2: Interaction between CP and UP function with PDN\n                      connection modification, Group 2\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2a.  The PGW-C may send an Sx Session Modification Request to the PGW-U\n    to update the Sx session. For \"Secondary PDP Context Activation\n    Procedure\", PGW-C may request PGW-U to allocate F-TEID for the\n    dedicated bearer. For \"MS- and SGSN- Initiated PDP Context Deactivation\n    Procedure\", the PGW-C shall request PGW-U to remove the PDR for the\n    affected bearers.\n\n  2b.  The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the update the Sx session.\n\n  3. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  4a.  The PGW-C may send an Sx Session Modification Request to the PGW-U\n    to update the Sx session.\n\n  4b.  The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the update the Sx session.\n\n  5. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  NOTE\u00a02:  Step\u00a02a/2b and step\u00a04a/4b happen when PGW-C receives request\n         message from GnSGSN.\n\n                                    [pic]\n\n     Figure 6.3.4.2.2-3: Interaction between CP and UP function with PDN\n                      connection modification, Group 3\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed.\n\n  2a.  The PGW-C may send an Sx Session Modification Request to the PGW-U\n    to update the Sx session. For \"GGSN Initiated PDP Context Deactivation\n    Procedure\", PGW-C shall request PGW-U to stop counting and stop\n    forwarding packets for the affected bearers.\n\n  2b.  The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the update the Sx session.\n\n  3. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  4a.  The PGW-C may send an Sx Session Modification Request to the PGW-U\n    to update the Sx session. For \"Network Requested Secondary PDP Context\n    Activation Procedure\", the PGW-C shall include the F-TEIDu of the\n    activated bearer received from the GnSGSN. For \"GGSN Initiated PDP\n    Context Deactivation Procedure, the PGW-C shall request PGW-U to remove\n    the PDR for the affected bearers.\n\n  4b.  The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the update the Sx session.\n\n  5. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  NOTE\u00a03:  Step\u00a02a/2b happens when PGW-C sends request message to GnSGSN,\n         and step\u00a04a/4b happens when PGW-C receives response message from\n         GnSGSN for GGSN initiated PDP Context Modification/Deactivation\n         Procedure, or request message for Network Requested Secondary PDP\n         Context Activation.\n\n\n"}, {"key": "Procedures with PDN connection establishment", "numbering": "6.3.4.3", "title_level": 3, "desc": "6.3.4.3  Procedures with PDN connection establishment\n\nThis clause\u00a0defines interactions between the CP and UP function during the\nfollowing procedures related to the establishment of a PDN connection:\n\n  -  IPv6 Stateless Address Autoconfiguration Procedure.\n\n  -  PDP Context Activation Procedure for A/Gb mode.\n\n  -  PDP Context Activation Procedure for Iu mode.\n\nDuring the procedures involving S4 listed above, following is the nature of\ninteractions between the CP and UP function:\n\n  -  The SGW-C informs the SGW-U to create the Sx session.\n\n  -  The PGW-C informs the PGW-U to create the Sx session.\n\n  -  The SGW-C informs the SGW-U to modify the Sx session.\n\n  -  The PGW-C informs the PGW-U to modify the Sx session.\n\n                                    [pic]\n\n      Figure 6.3.4.3-1: Interaction between CP and UP function with PDN\n                          connection establishment\n\n  1. Procedure as listed in this step\u00a0is initiated as specified in the\n    relevant clauses of this specification. The relevant steps of the\n    procedure as specified in the figure above are executed. Steps in\n    Figure 64a are specific for S4 SGSN.\n\n     For the case that Gn/Gp SGSN interconnects with PGW-C, steps 2a/2b or\n    5a/5b are skipped.\n\n  2a.  The SGW-C sends an Sx Session Establishment Request to the SGW-U to\n    create the Sx session.\n\n  2b.  The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the Sx session creation.\n\n  3a.  The PGW-C sends an Sx Session Establishment Request to the PGW-U to\n    create the Sx session.\n\n  3b.  The PGW-U sends an Sx Session Establishment Response to the PGW-C\n    confirming the Sx session creation.\n\n  4. The relevant steps of the procedure as specified in the figure above\n    are executed. Steps in Figure 64b are specific for S4 SGSN.\n\n  5a.  The SGW-C may send an Sx Session Modification Request to the SGW-U\n    to update the Sx session.\n\n  5b.  The SGW-U sends an Sx Session Modification Response to the SGW-C\n    confirming the Sx session update.\n\n  6a.  The PGW-C may send an Sx Session Modification Request to the PGW-U\n    to update the Sx session.\n\n  6b.  The PGW-U sends an Sx Session Modification Response to the PGW-C\n    confirming the Sx session update.\n\n  7. The relevant steps of the procedure as specified in the figure above\n    are executed.\n\n  NOTE\u00a01:  For the case that SGSN interconnects with SGW via S4 reference\n         point, steps 2a/2b or 5a/5b happens when SGW-C receives request\n         message from SGSN, and steps 3a/3b or 6a/6b happens when PGW-C\n         receives request message from SGW.\n\n  NOTE\u00a02:  For the case that Gn/Gp SGSN interconnects with PGW-C, steps\n         3a/3b or 6a/6b happens when PGW-C receives request message from\n         Gn/Gp SGSN.\n\n\n"}, {"key": "Sx Reporting Procedures", "numbering": "6.4", "title_level": 1, "desc": "6.4  Sx Reporting Procedures\n\n\n"}, {"key": "General", "numbering": "6.4.1", "title_level": 2, "desc": "6.4.1  General\n\nThe Sx reporting procedure is used by the UP function of SGW, PGW or TDF to\nreport events to the CP function.\n\nThe following Sx reporting procedures exist: Sx session level reporting and\nSx node level reporting. Both are initiated by the CP function.\n\n\n"}, {"key": "Sx Session Level Reporting Procedure", "numbering": "6.4.2", "title_level": 2, "desc": "6.4.2  Sx Session Level Reporting Procedure\n\nThis procedure is used by the UP function to report events related to an Sx\nsession for an individual PDN connection IP-CAN session, TDF session or TDF\nin unsolicited reporting mode. The triggers for event reporting were\nconfigured on the UP function during Sx session management procedures by\nthe CP function (excluding the Sx session termination procedure).\n\n                                    [pic]\n\n            Figure 6.4.2-1: Sx Session Level Reporting procedure\n\n  1. The UP function detects that an event has to be reported. The\n    reporting triggers involve the following cases:\n\n    (1)  Usage report (by SGW-U, PGW-U and TDF-U).\n\n     Usage information shall be collected in the UP function and reported\n       to the CP function as defined in clause\u00a05.3 and clause\u00a07.4.\n\n    (2)  Start of traffic detection (by PGW-U and TDF-U).\n\n     When traffic detection is requested by PGW-C/TDF-C, and the start of\n       traffic is detected for a PDR, the PGW-U/TDF-U shall report the start\n       of traffic detection to the PGW-C/TDF-C and indicate the PDR rule ID.\n\n    (3)  Stop of traffic detection (by PGW-U and TDF-U).\n\n     When traffic detection is requested by PGW-C/TDF-C, and the end of\n       traffic is detected for a PDR, the PGW-U/TDF-U shall report the stop\n       of traffic detection to the PGW-C/TDF-C and indicate the PDR rule ID.\n\n     (4) Detection of 1st Downlink Data for Idle-Mode UE (by SGW-U)\n\n     When SGW-U receives the downlink packet but no S1-bearer for\n       transmission and the buffering is performed by SGW-U, it shall report\n       the detection of 1st downlink data to SGW-C, for the purpose of\n       paging the UE. SGW-U shall also report the DSCP of the packet when\n       instructed by SGW-C (e.g. in case the Paging Policy Differentiation\n       function as described in TS\u00a023.401\u00a0[2] is enabled at the SGW-C).\n\n  2. The UP function sends an Sx report message (Session ID, list of\n    [Reporting trigger, Measurement information]) to the CP function.\n\n     The Reporting trigger parameter contains the name of the event which\n    triggered the report and the Measurement information parameter contains\n    the actual information the CP function requested to be informed about.\n\n  3. The CP function identifies the Sx session context based on the\n    received Session ID and applies the reported information for the\n    corresponding PDN connection IP-CAN session, TDF session or TDF in\n    unsolicited reporting mode. The CP function responds with an Sx report\n    ACK message.\n\n\n"}, {"key": "Sx Management Procedures", "numbering": "6.5", "title_level": 1, "desc": "6.5  Sx Management Procedures\n\n\n"}, {"key": "General", "numbering": "6.5.1", "title_level": 2, "desc": "6.5.1  General\n\nSx management procedures are used by the CP function to manage the UP\nfunction independent of any Sx session.\n\n  NOTE:  The terminology defined in TS\u00a029.244\u00a0[12] is used for the\n         procedures and messages related to the Sx management procedures.\n\n  Editor's note:  More procedures may be added after stage 3 finalize the\n         work on Sx management procedures.\n\n\n"}, {"key": "Sx PFD management Procedure", "numbering": "6.5.2", "title_level": 2, "desc": "6.5.2  Sx PFD management Procedure\n\nThe Sx PFD management procedure is used by the PGW-C or TDF-C to provision\nor remove all PFD(s) belonging to an Application ID in the UP function as\ndescribed in clause\u00a05.11.4. PFD sets belonging to different Application IDs\ncan be managed with the same PFD management request message.\n\nThe Sx PFD management procedure is a node level procedure, i.e. independent\nof any Sx session.\n\n                                    [pic]\n\n                 Figure 6.5.2-1: Sx PFD Management Procedure\n\n  1. The CP function is triggered to provision or remove the PFD set\n    belonging to an Application ID as described in clause\u00a05.11.4.\n\n  2. The CP function sends a PFD management request message to the UP\n    function (containing the parameters described in clause\u00a07.9.1) to\n    provision/remove the PFD set corresponding to the Application ID.\n\n  3. The UP function acknowledges by responding with a PFD management\n    response message.\n\n\n"}, {"key": "Sx Association Setup Procedure", "numbering": "6.5.3", "title_level": 2, "desc": "6.5.3  Sx Association Setup Procedure\n\nThe Sx Association Setup procedure is used to setup an association between\nthe CP function and the UP function which enables the CP function to\nsubsequently interact with the UP function, e.g. to establish Sx Sessions.\n\nThe setup of an Sx association may be initiated by the CP function or the\nUP function as described TS\u00a029.244\u00a0[12], clause\u00a06.2.6. The CP function and\nthe UP function shall support the Sx association setup initiated by the CP\nfunction. The CP function and the UP function may additionally support the\nSx association setup initiated by the UP function.\n\n\n"}, {"key": "Sx Association Update Procedure", "numbering": "6.5.4", "title_level": 2, "desc": "6.5.4  Sx Association Update Procedure\n\nThe Sx Association Update procedure is used to modify an existing Sx\nassociation between the CP function and the UP function. It may be\ninitiated by the UP function or by the CP function, as described\nTS\u00a029.244\u00a0[12], clause\u00a06.2.7.\n\n\n"}, {"key": "Sx Association Release Procedure", "numbering": "6.5.5", "title_level": 2, "desc": "6.5.5  Sx Association Release Procedure\n\nThe Sx Association Release procedure is used to terminate the Sx\nassociation between the CP function and the UP function due to e.g. OAM\nreasons. The Sx Association Release procedure can be only initiated by the\nCP function, as described TS\u00a029.244\u00a0[12], clause\u00a06.2.8.\n\n\n"}, {"key": "Parameters", "numbering": "7", "title_level": 0, "desc": "7  Parameters\n\n\n"}, {"key": "Parameters for Sx session management", "numbering": "7.1", "title_level": 1, "desc": "7.1  Parameters for Sx session management\n\nThese parameters are used to control the functionality of the UP function\nrelated to an individual PDN connection, IP-CAN session, TDF session or TDF\nin unsolicited reporting mode as well as to inform about events occurring\nat the UP function. As the functionality of the respective UP functions\ndiffers, most parameters are specific to one or two of the reference points\nSxa (between SGW-C and SGW-U), Sxb (PGW-C and PGW-U) and Sxc (TDF-C and TDF-\nU).\n\nThe Sx session management procedures however will use the relevant\nparameters in the same way for all Sx reference points: the Sx session\nestablishment procedure as well as the Sx session modification procedure\nprovide the control parameters to the UP function, the Sx session\ntermination procedure removes all control parameters related to an Sx\nsession and the Sx session level reporting procedure informs the CP\nfunction about events related to the Sx session that are detected by the UP\nfunction.\n\nThe parameters over Sx provided from CP function to UP function are grouped\ninto session related parameters and four different rules, one \"detection\"\nrule and three different \"enforcement\" rules:\n\n  -  Packet Detection Rule (PDR), with information describing what packets\n    should receive a certain treatment (e.g. forwarding and other types of\n    enforcement).\n\n  -  Forwarding Action Rule (FAR), contains information on whether\n    forwarding, dropping or buffering is to be applied to a packet.\n\n  -  Usage Reporting Rule (URR), contains information that defines a\n    certain measurement and how it shall be reported.\n\n  -  QoS Enforcement Rule (QER), contains information related to QoS\n    enforcement of traffic.\n\nThe UP function provides parameters over Sx to the CP function sending a\nUsage Report.\n\n\n"}, {"key": "Session context", "numbering": "7.2", "title_level": 1, "desc": "7.2  Session context\n\nThe session context comprises the session related parameters and all PDRs,\nURRs, QERs and FARs with the same Session ID.\n\nThe following table describes the session related parameters provided over\nSx.\n\n                   Table 7.2-1: Session related parameters\n\n|Attribute         |Description        |Comment               |Applicability |\n|                  |                   |                      |SGW |PDN |TDF |\n|                  |                   |                      |    |GW  |    |\n|Session ID        |Uniquely identifies|This session          |X   |X   |X   |\n|                  |a session.         |corresponds to a PDN  |    |    |    |\n|                  |                   |connection for SGW, a |    |    |    |\n|                  |                   |PDN connection and an |    |    |    |\n|                  |                   |IP-CAN session for    |    |    |    |\n|                  |                   |PGW, TDF session for  |    |    |    |\n|                  |                   |TDF or a TDF in       |    |    |    |\n|                  |                   |unsolicited reporting |    |    |    |\n|                  |                   |mode.                 |    |    |    |\n\n\n\n"}, {"key": "Packet Detection Rule", "numbering": "7.3", "title_level": 1, "desc": "7.3  Packet Detection Rule\n\nThe following table describes the Packet Detection Rule (PDR) containing\ninformation required to classify a packet arriving at the UP function.\nThere is at least one PDR per direction, e.g. UL direction or DL direction.\n\n            Table 7.3-1: Attributes within Packet Detection Rule\n\n|Attribute         |Description     |Comment                  |Applicability |\n|                  |                |                         |SGW |PDN |TDF |\n|                  |                |                         |    |GW  |    |\n|Session ID        |Identifies the  |                         |X   |X   |X   |\n|                  |session         |                         |    |    |    |\n|                  |associated to   |                         |    |    |    |\n|                  |this PDR        |                         |    |    |    |\n|Rule ID           |Unique          |                         |X   |X   |X   |\n|                  |identifier to   |                         |    |    |    |\n|                  |identify this   |                         |    |    |    |\n|                  |information.    |                         |    |    |    |\n|Precedence        |Determines the  |                         |    |X   |X   |\n|                  |order, in which |                         |    |    |    |\n|                  |the detection   |                         |    |    |    |\n|                  |information of  |                         |    |    |    |\n|                  |all rules is    |                         |    |    |    |\n|                  |applied         |                         |    |    |    |\n|Packet   |Source   |Contains the    |Identifies whether the   |X   |X   |X   |\n|detection|interface|values \"access  |rule applies to incoming |    |    |    |\n|informati|         |side\", \"core    |packets from the access  |    |    |    |\n|on       |         |side\", \"CP      |side (i.e. up-link), the |    |    |    |\n|         |         |function\" or    |core side (i.e.          |    |    |    |\n|         |         |\"SGi-LAN\".      |down-link), the CP       |    |    |    |\n|         |         |                |function (the packet from|    |    |    |\n|         |         |                |CP function) or the      |    |    |    |\n|         |         |                |SGi-LAN side (the packet |    |    |    |\n|         |         |                |has experienced SGi-LAN  |    |    |    |\n|         |         |                |Service Functions).      |    |    |    |\n|         |UE IP    |One IPv4 address|Combination of UE IP     |    |X   |X   |\n|         |address  |and/or one IPv6 |address (together with   |    |    |    |\n|         |         |prefix with     |Network instance, if     |    |    |    |\n|         |         |prefix length   |necessary), F-TEID, SDF  |    |    |    |\n|         |         |                |filters, application ID  |    |    |    |\n|         |         |                |for traffic detection:   |    |    |    |\n|         |         |                |SGW UL: Local F-TEID     |    |    |    |\n|         |         |                |SGW DL: Local F-TEID     |    |    |    |\n|         |         |                |                         |    |    |    |\n|         |         |                |PGW UL: Local F-TEID + UE|    |    |    |\n|         |         |                |IP address +             |    |    |    |\n|         |         |                |SDF/applicat.ID          |    |    |    |\n|         |         |                |PGW DL: UE IP address +  |    |    |    |\n|         |         |                |SDF/application ID       |    |    |    |\n|         |         |                |                         |    |    |    |\n|         |         |                |TDF UL (solicited mode): |    |    |    |\n|         |         |                |UE IP address +          |    |    |    |\n|         |         |                |SDF/application ID       |    |    |    |\n|         |         |                |TDF DL (solicited mode): |    |    |    |\n|         |         |                |UE IP address +          |    |    |    |\n|         |         |                |SDF/application ID       |    |    |    |\n|         |         |                |TDF UL/DL (unsolicited   |    |    |    |\n|         |         |                |mode): application ID    |    |    |    |\n|         |Network  |Identifies the  |                         |X   |X   |X   |\n|         |instance |Network instance|                         |    |    |    |\n|         |         |associated with |                         |    |    |    |\n|         |         |the incoming    |                         |    |    |    |\n|         |         |packet.         |                         |    |    |    |\n|         |         |(NOTE\u00a01).       |                         |    |    |    |\n|         |Local    |                |                         |X   |X   |    |\n|         |F-TEID   |                |                         |    |    |    |\n|         |List of  |                |                         |    |X   |X   |\n|         |SDF      |                |                         |    |    |    |\n|         |Filter(s)|                |                         |    |    |    |\n|         |Applicati|                |                         |    |X   |X   |\n|         |on ID    |                |                         |    |    |    |\n|Outer header      |Instructs the UP|Any extension header     |X   |X   |    |\n|removal           |function to     |shall be stored for this |    |    |    |\n|                  |remove one or   |packet.                  |    |    |    |\n|                  |more outer      |                         |    |    |    |\n|                  |header(s) (e.g. |                         |    |    |    |\n|                  |IP+UDP+GTP) from|                         |    |    |    |\n|                  |the incoming    |                         |    |    |    |\n|                  |packet.         |                         |    |    |    |\n|Forwarding Action |The Forwarding  |                         |X   |X   |X   |\n|Rule ID           |Action Rule ID  |                         |    |    |    |\n|                  |identifies a    |                         |    |    |    |\n|                  |forwarding      |                         |    |    |    |\n|                  |action that has |                         |    |    |    |\n|                  |to be applied.  |                         |    |    |    |\n|List of Usage     |Every Usage     |                         |X   |X   |X   |\n|Reporting Rule    |Reporting Rule  |                         |    |    |    |\n|ID(s)             |ID identifies a |                         |    |    |    |\n|                  |measurement     |                         |    |    |    |\n|                  |action that has |                         |    |    |    |\n|                  |to be applied.  |                         |    |    |    |\n|List of QoS       |Every QoS       |                         |X   |X   |X   |\n|Enforcement Rule  |Enforcement Rule|                         |    |    |    |\n|ID(s)             |ID identifies a |                         |    |    |    |\n|                  |QoS enforcement |                         |    |    |    |\n|                  |action that has |                         |    |    |    |\n|                  |to be applied.  |                         |    |    |    |\n|NOTE\u00a01: The Network instance is needed e.g. in the following cases:         |\n|- PGW/TDF-U supports multiple APN with overlapping IP addresses;            |\n|- PGW-U is connected to SGWs in different IP domains;                       |\n|- SGW-U is connected to PGWs in different IP domains;                       |\n|- SGW-U is connected to eNodeBs in different IP domains.                    |\n\n\n\n"}, {"key": "Usage Reporting Rule", "numbering": "7.4", "title_level": 1, "desc": "7.4  Usage Reporting Rule\n\nThe following table describes the Usage Reporting Rule (URR) that defines\nhow a packet shall be accounted as well as when and how to report the\nmeasurements.\n\n             Table 7.4-1: Attributes within Usage Reporting Rule\n\n|Attribute |Description         |Comment                     |Applicability |\n|          |                    |                            |SGW  |PDN|TDF |\n|          |                    |                            |     |GW |    |\n|Session ID|Identifies the      |                            |X    |X  |X   |\n|          |session associated  |                            |     |   |    |\n|          |to this URR         |                            |     |   |    |\n|Rule ID   |Unique identifier to|                            |X    |X  |X   |\n|          |identify this       |                            |     |   |    |\n|          |information.        |                            |     |   |    |\n|Reporting |One or multiple of  |Applicable events include:  |X    |X  |X   |\n|triggers  |the events can be   |Start/stop of traffic       |     |   |    |\n|          |activated for the   |detection with/without      |     |   |    |\n|          |generation and      |application instance        |     |   |    |\n|          |reporting of the    |identifier and deduced SDF  |     |   |    |\n|          |usage report.       |filter reporting; Deletion  |     |   |    |\n|          |                    |of last PDR for a URR;      |     |   |    |\n|          |                    |Periodic measurement        |     |   |    |\n|          |                    |threshold reached;          |     |   |    |\n|          |                    |Volume/Time/Event           |     |   |    |\n|          |                    |measurement threshold       |     |   |    |\n|          |                    |reached; Immediate report   |     |   |    |\n|          |                    |requested; Measurement of   |     |   |    |\n|          |                    |incoming UL traffic;        |     |   |    |\n|          |                    |Measurement of discarded DL |     |   |    |\n|          |                    |traffic.                    |     |   |    |\n|Periodic  |Defines the point in|This allows generation of   |X    |X  |X   |\n|measuremen|time for sending a  |periodic usage report for   |     |   |    |\n|t         |periodic report for |e.g. offline charging.      |     |   |    |\n|threshold |this URR key (e.g.  |It can also be used for     |     |   |    |\n|          |timeofday)          |realizing the Monitoring    |     |   |    |\n|          |                    |time of the usage monitoring|     |   |    |\n|          |                    |feature.                    |     |   |    |\n|          |                    |It can also be used for     |     |   |    |\n|          |                    |realizing the               |     |   |    |\n|          |                    |Quota-Idle-Timeout, i.e. to |     |   |    |\n|          |                    |enable the CP function to   |     |   |    |\n|          |                    |check whether any traffic   |     |   |    |\n|          |                    |has passed during this time.|     |   |    |\n|Volume    |Value in terms of   |                            |X    |X  |X   |\n|measuremen|uplink and/or       |                            |     |   |    |\n|t         |downlink and/or     |                            |     |   |    |\n|threshold |total byte-count    |                            |     |   |    |\n|          |when the measurement|                            |     |   |    |\n|          |report is to be     |                            |     |   |    |\n|          |generated.          |                            |     |   |    |\n|Time      |Value in terms of   |                            |X    |X  |X   |\n|measuremen|the time duration   |                            |     |   |    |\n|t         |(e.g. in seconds)   |                            |     |   |    |\n|threshold |when the measurement|                            |     |   |    |\n|          |report is to be     |                            |     |   |    |\n|          |generated.          |                            |     |   |    |\n|Event     |Number of events    |                            |     |X  |X   |\n|measuremen|(identified         |                            |     |   |    |\n|t         |according to a      |                            |     |   |    |\n|threshold |locally configured  |                            |     |   |    |\n|          |policy) after which |                            |     |   |    |\n|          |the measurement     |                            |     |   |    |\n|          |report is to be     |                            |     |   |    |\n|          |generated.          |                            |     |   |    |\n|Inactivity|Defines the period  |Timer corresponding to this |     |X  |X   |\n|detection |of time after which |duration is restarted at the|     |   |    |\n|time      |the time measurement|end of each transmitted     |     |   |    |\n|          |shall stop, if no   |packet.                     |     |   |    |\n|          |packets are         |                            |     |   |    |\n|          |received.           |                            |     |   |    |\n|Event     |Points to a locally |                            |     |X  |X   |\n|based     |configured policy   |                            |     |   |    |\n|reporting |which is identifies |                            |     |   |    |\n|          |event(s) trigger for|                            |     |   |    |\n|          |generating usage    |                            |     |   |    |\n|          |report.             |                            |     |   |    |\n|Linked URR|Points to one or    |This enables the generation |     |X  |X   |\n|ID        |more other URR ID.  |of a combined Usage Report  |     |   |    |\n|          |                    |for this and other URRs by  |     |   |    |\n|          |                    |triggering their reporting. |     |   |    |\n|          |                    |See clause\u00a05.2.2.4,         |     |   |    |\n|          |                    |TS\u00a029.244\u00a0[12].             |     |   |    |\n|Measuremen|Indicates the method|                            |X    |X  |X   |\n|t method  |for measuring the   |                            |     |   |    |\n|          |network resources   |                            |     |   |    |\n|          |usage, i.e. the data|                            |     |   |    |\n|          |volume, duration,   |                            |     |   |    |\n|          |combined            |                            |     |   |    |\n|          |volume/duration, or |                            |     |   |    |\n|          |event.              |                            |     |   |    |\n|Measuremen|Indicates specific  |It is used to request:      |X    |X  |X   |\n|t         |conditions to be    |- measurement before QoS    |     |   |    |\n|informatio|applied for         |enforcement, and/or         |     |   |    |\n|n         |measurements.       |- to pause or set to active |     |   |    |\n|          |                    |a measurement as for the    |     |   |    |\n|          |                    |Pause of charging, and/or   |     |   |    |\n|          |                    |- to request reduced        |     |   |    |\n|          |                    |reporting for application   |     |   |    |\n|          |                    |start/stop events.          |     |   |    |\n\n\n"}, {"key": "Forwarding Action Rule", "numbering": "7.5", "title_level": 1, "desc": "7.5  Forwarding Action Rule\n\nThe following table describes the Forwarding Action Rule (FAR) that defines\nhow a packet shall be forwarded, including packet\nencapsulation/decapsulation and forwarding destination.\n\n            Table 7.5-1: Attributes within Forwarding Action Rule\n\n|Attribute      |Description        |Comment          |Applicability  |\n|               |                   |                 |SGW  |PDN |TDF |\n|               |                   |                 |     |GW  |    |\n|Session ID     |Identifies the     |                 |X    |X   |X   |\n|               |session associated |                 |     |    |    |\n|               |to this FAR        |                 |     |    |    |\n|Rule ID        |Unique identifier  |                 |X    |X   |X   |\n|               |to identify this   |                 |     |    |    |\n|               |information.       |                 |     |    |    |\n|Network        |Identifies the     |                 |X    |X   |X   |\n|instance       |Network instance   |                 |     |    |    |\n|               |associated with the|                 |     |    |    |\n|               |outgoing packet.   |                 |     |    |    |\n|               |(NOTE\u00a01).          |                 |     |    |    |\n|Destination    |Contains the values|Identifies the   |X    |X   |X   |\n|interface      |\"access side\",     |interface for    |     |    |    |\n|               |\"core side\", \"CP   |outgoing packets |     |    |    |\n|               |function\", or      |towards the      |     |    |    |\n|               |\"SGi-LAN\".         |access side (i.e.|     |    |    |\n|               |                   |down-link), the  |     |    |    |\n|               |                   |core side (i.e.  |     |    |    |\n|               |                   |up-link), the CP |     |    |    |\n|               |                   |function side    |     |    |    |\n|               |                   |(i.e. towards CP |     |    |    |\n|               |                   |function) or the |     |    |    |\n|               |                   |SGi-LAN side     |     |    |    |\n|               |                   |(i.e. towards    |     |    |    |\n|               |                   |SGi-LAN).        |     |    |    |\n|Outer header   |Instructs the UP   |Contains the     |X    |X   |    |\n|creation       |function to add an |F-TEIDu of peer  |     |    |    |\n|               |outer header       |entity (e.g. eNB,|     |    |    |\n|               |(IP+UDP+GTP) to the|SGW, PGW, CP     |     |    |    |\n|               |outgoing packet    |function).       |     |    |    |\n|               |                   |Any extension    |     |    |    |\n|               |                   |header stored for|     |    |    |\n|               |                   |this packet shall|     |    |    |\n|               |                   |be added.        |     |    |    |\n|Send end marker|Instructs the UP   |This parameter   |X    |X   |    |\n|packet(s)      |function to        |should be sent   |     |    |    |\n|               |construct end      |together with the|     |    |    |\n|               |marker packet(s)   |\"out header      |     |    |    |\n|               |and send them out  |creation\"        |     |    |    |\n|               |as described in    |parameter of the |     |    |    |\n|               |clause\u00a05.8.1.      |new F-TEID-u.    |     |    |    |\n|Transport level|Transport level    |                 |X    |X   |    |\n|marking        |packet marking in  |                 |     |    |    |\n|               |the uplink and     |                 |     |    |    |\n|               |downlink, e.g.     |                 |     |    |    |\n|               |setting the        |                 |     |    |    |\n|               |DiffServ Code      |                 |     |    |    |\n|               |Point.             |                 |     |    |    |\n|Forwarding     |Reference to a     |Contains TSP ID  |     |X   |X   |\n|policy         |preconfigured      |or Redirect      |     |    |    |\n|               |traffic forwarding |Destination and  |     |    |    |\n|               |treatment for FMSS |values for the   |     |    |    |\n|               |or http redirection|forwarding       |     |    |    |\n|               |(NOTE\u00a02)           |behaviour        |     |    |    |\n|               |                   |(always, after   |     |    |    |\n|               |                   |measurement      |     |    |    |\n|               |                   |report (for      |     |    |    |\n|               |                   |termination      |     |    |    |\n|               |                   |action           |     |    |    |\n|               |                   |\"redirect\"))     |     |    |    |\n|Container for  |Contains           |Only relevant for|     |X   |X   |\n|header         |information to be  |the uplink       |     |    |    |\n|enrichment     |used by the UP     |direction        |     |    |    |\n|               |function for header|                 |     |    |    |\n|               |enrichment         |                 |     |    |    |\n|Buffer Control |Instructs the UP   |See clause\u00a05.2.4 |X    |    |    |\n|Information    |function on how to |in               |     |    |    |\n|               |perform buffering  |TS\u00a029.244\u00a0[12].  |     |    |    |\n|Delay Downlink |D parameter        |See clause\u00a05.9.3 |X    |    |    |\n|Packet         |                   |                 |     |    |    |\n|Notification   |                   |                 |     |    |    |\n|Information    |                   |                 |     |    |    |\n|Extended       |DL Data Buffer     |See clause\u00a05.9.3 |X    |    |    |\n|buffering      |Expiration Time    |                 |     |    |    |\n|Information    |                   |                 |     |    |    |\n|               |DL Suggested Packet|See clause\u00a05.9.3 |     |    |    |\n|               |Count              |                 |     |    |    |\n|NOTE 1: Needed e.g. in case:                                         |\n|- PGW/TDF-U supports multiple APN with overlapping IP addresses;     |\n|- PGW-U is connected to SGWs in different IP domains;                |\n|- SGW-U is connected to PGWs in different IP domains;                |\n|- SGW UP-U is connected to eNodeBs in different IP domains.          |\n|NOTE\u00a02: The TSP ID action is enforced before the Outer header        |\n|creation actions.                                                    |\n\n\n"}, {"key": "QoS Enforcement Rule", "numbering": "7.6", "title_level": 1, "desc": "7.6  QoS Enforcement Rule\n\nThe following table describes the QoS Enforcement Rule (QER) that defines\nhow a packet shall be treated in terms of bit rate limitation and packet\nmarking for QoS purposes. All Packet Detection Rules that refer to the same\nQER share the same QoS resources, e.g. MBR.\n\n             Table 7.6-1: Attributes within QoS Enforcement Rule\n\n|Attribute |Description   |Comment                    |Applicability |\n|          |              |                           |SGW  |PDN |TDF |\n|          |              |                           |     |GW  |    |\n|Session ID|Identifies the|                           |X    |X   |X   |\n|          |session       |                           |     |    |    |\n|          |associated to |                           |     |    |    |\n|          |this QER      |                           |     |    |    |\n|Rule ID   |Unique        |                           |X    |X   |X   |\n|          |identifier to |                           |     |    |    |\n|          |identify this |                           |     |    |    |\n|          |information.  |                           |     |    |    |\n|QoS       |An identity   |Is used to correlate QoS   |     |X   |    |\n|Enforcemen|allowing the  |Enforcement Rules for      |     |    |    |\n|t Rule    |UP function to|APN-AMBR enforcement       |     |    |    |\n|correlatio|correlate     |                           |     |    |    |\n|n ID      |multiple      |                           |     |    |    |\n|          |Sessions for  |                           |     |    |    |\n|          |the same UE   |                           |     |    |    |\n|          |and APN.      |                           |     |    |    |\n|Gate      |Instructs the |Values are: open, close,   |     |X   |X   |\n|status    |UP function to|close after measurement    |     |    |    |\n|UL/DL     |let the flow  |report (for termination    |     |    |    |\n|          |pass or to    |action \"discard\")          |     |    |    |\n|          |block the flow|                           |     |    |    |\n|Maximum   |The           |This field may e.g. contain|     |X   |X   |\n|bitrate   |uplink/downlin|any one of:                |     |    |    |\n|          |k maximum     |- APN-AMBR (for a QER that |     |    |    |\n|          |bitrate to be |is referenced by all       |     |    |    |\n|          |enforced for  |relevant Packet Detection  |     |    |    |\n|          |the packets.  |Rules of all PDN           |     |    |    |\n|          |              |Connections to an APN)     |     |    |    |\n|          |              |- TDF session MBR (for a   |     |    |    |\n|          |              |QER that is referenced by  |     |    |    |\n|          |              |all Packet Detection Rules |     |    |    |\n|          |              |of a TDF Session)          |     |    |    |\n|          |              |- bearer MBR (for a QER    |     |    |    |\n|          |              |that is referenced by all  |     |    |    |\n|          |              |Packet Detection Rules of a|     |    |    |\n|          |              |bearer)                    |     |    |    |\n|          |              |- SDF MBR (for a QER that  |     |    |    |\n|          |              |is referenced by the       |     |    |    |\n|          |              |uplink/downlink Packet     |     |    |    |\n|          |              |Detection Rule of a SDF)   |     |    |    |\n|Guaranteed|The           |This field contains:       |X    |X   |    |\n|bitrate   |uplink/downlin|- bearer GBR (for a QER    |     |    |    |\n|          |k guaranteed  |that is referenced by all  |     |    |    |\n|          |bitrate       |Packet Detection Rules of a|     |    |    |\n|          |authorized for|bearer)                    |     |    |    |\n|          |the packets.  |                           |     |    |    |\n|Down-link |Flow level    |For PGW, this is for       |     |X   |X   |\n|flow level|packet marking|controlling the SCI marking|     |    |    |\n|marking   |in the        |in the GTP extension header|     |    |    |\n|          |downlink.     |(for service indication    |     |    |    |\n|          |              |towards GERAN as described |     |    |    |\n|          |              |in TS\u00a023.060\u00a0[5]).         |     |    |    |\n|          |              |For TDF, this is for       |     |    |    |\n|          |              |controlling the DSCP       |     |    |    |\n|          |              |marking for application    |     |    |    |\n|          |              |indication.                |     |    |    |\n|Packet    |Number of     |This field contains any one|     |X   |    |\n|rate      |packets per   |of:                        |     |    |    |\n|          |time interval |- downlink packet rate for |     |    |    |\n|          |to be         |Serving PLMN Rate Control  |     |    |    |\n|          |enforced.     |(the QER is referenced by  |     |    |    |\n|          |              |all PDRs of the UE         |     |    |    |\n|          |              |belonging to PDN           |     |    |    |\n|          |              |connections using CIoT EPS |     |    |    |\n|          |              |Optimizations as described |     |    |    |\n|          |              |in TS\u00a023.401\u00a0[2])          |     |    |    |\n|          |              |- uplink/downlink packet   |     |    |    |\n|          |              |rate for APN Rate Control  |     |    |    |\n|          |              |(the QER is referenced by  |     |    |    |\n|          |              |all PDRs of the UE         |     |    |    |\n|          |              |belonging to PDN           |     |    |    |\n|          |              |connections to the same APN|     |    |    |\n|          |              |using CIoT EPS             |     |    |    |\n|          |              |Optimizations as described |     |    |    |\n|          |              |in TS\u00a023.401\u00a0[2]).         |     |    |    |\n\n\n"}, {"key": "Usage Report generated by UP function", "numbering": "7.7", "title_level": 1, "desc": "7.7  Usage Report generated by UP function\n\nThe UP function sends the usage report to inform the CP function about the\nmeasurement of an active URR or about the detection of application traffic\nof an active Packet Detection Rule. For each URR, the usage report may be\ngenerated repeatedly, i.e. as long as any one of the valid event triggers\napplies. A final usage report is sent for a URR when it is no longer\nactive, i.e. either the URR is removed or all the references to this URR in\nany of the Packet Detection Rules belonging to the Sx session.\n\nFollowing attributes can be included in the usage report:\n\n                 Table 7.7-1: Attributes within Usage Report\n\n|Attribut|Description     |Comment                     |Applicability |\n|e       |                |                            |              |\n|        |                |                            |SGW  |PDN |TDF |\n|        |                |                            |     |GW  |    |\n|Session |Uniquely        |This corresponds to a PDN   |X    |X   |X   |\n|ID      |identifies a    |connection for SGW and PGW  |     |    |    |\n|        |session.        |or a TDF session for TDF    |     |    |    |\n|Rule ID |Uniquely        |Packet Detection Rule is    |X    |X   |X   |\n|        |identifies the  |only indicated when         |     |    |    |\n|        |Packet Detection|Reporting trigger is        |     |    |    |\n|        |Rule or Usage   |Detection of 1st DL packet  |     |    |    |\n|        |Reporting Rule  |on bearer (SGW) or          |     |    |    |\n|        |within a session|Start/stop of traffic       |     |    |    |\n|        |which triggered |detection (PGW/TDF).        |     |    |    |\n|        |the report      |Usage Reporting Rule is     |     |    |    |\n|        |                |indicated for all other     |     |    |    |\n|        |                |Reporting triggers.         |     |    |    |\n|Reportin|Identifies the  |Applicable values are:      |X    |X   |X   |\n|g       |trigger for the |Detection of 1st DL packet  |     |    |    |\n|trigger |usage report.   |on bearer (only for SGW);   |     |    |    |\n|        |                |Start/stop of traffic       |     |    |    |\n|        |                |detection with/without      |     |    |    |\n|        |                |application instance        |     |    |    |\n|        |                |identifier and deduced SDF  |     |    |    |\n|        |                |filter reporting (only for  |     |    |    |\n|        |                |PGW and TDF); Deletion of   |     |    |    |\n|        |                |last PDR for a URR; Periodic|     |    |    |\n|        |                |measurement threshold       |     |    |    |\n|        |                |reached; Volume/Time/Event  |     |    |    |\n|        |                |measurement threshold       |     |    |    |\n|        |                |reached; Immediate report   |     |    |    |\n|        |                |requested; Measurement of   |     |    |    |\n|        |                |incoming UL traffic (only   |     |    |    |\n|        |                |for PGW); Measurement of    |     |    |    |\n|        |                |discarded DL traffic (only  |     |    |    |\n|        |                |for SGW).                   |     |    |    |\n|Start   |Provides the    |Not sent when Reporting     |X    |X   |X   |\n|time    |timestamp, in   |trigger is Start/stop of    |     |    |    |\n|        |terms of        |traffic detection           |     |    |    |\n|        |absolute time,  |                            |     |    |    |\n|        |when the        |                            |     |    |    |\n|        |collection of   |                            |     |    |    |\n|        |the information |                            |     |    |    |\n|        |provided within |                            |     |    |    |\n|        |Usage-Informatio|                            |     |    |    |\n|        |n is started.   |                            |     |    |    |\n|End time|Provides the    |Not sent when Reporting     |X    |X   |X   |\n|        |timestamp, in   |trigger is Start/stop of    |     |    |    |\n|        |terms of        |traffic detection           |     |    |    |\n|        |absolute time,  |                            |     |    |    |\n|        |when the        |                            |     |    |    |\n|        |information     |                            |     |    |    |\n|        |provided within |                            |     |    |    |\n|        |Usage-Informatio|                            |     |    |    |\n|        |n is generated. |                            |     |    |    |\n|Measurem|Defines the     |Contains DSCP of received   |X    |X   |X   |\n|ent     |measured        |packet when Reporting       |     |    |    |\n|informat|volume/time/even|trigger is Detection of 1st |     |    |    |\n|ion     |ts for this URR.|DL packet on bearer (as     |     |    |    |\n|        |                |described in TS\u00a023.401\u00a0[2]) |     |    |    |\n|        |                |Contains application        |     |    |    |\n|        |                |instance identifier and     |     |    |    |\n|        |                |deduced SDF filter when     |     |    |    |\n|        |                |Reporting trigger is        |     |    |    |\n|        |                |Start/stop of traffic       |     |    |    |\n|        |                |detection with application  |     |    |    |\n|        |                |instance identifier and     |     |    |    |\n|        |                |deduced SDF filter reporting|     |    |    |\n|        |                |(including deduced UE IP    |     |    |    |\n|        |                |address for TDF in          |     |    |    |\n|        |                |unsolicited mode)           |     |    |    |\n|        |                |Not sent when Reporting     |     |    |    |\n|        |                |trigger is Start/stop of    |     |    |    |\n|        |                |traffic detection without   |     |    |    |\n|        |                |application instance        |     |    |    |\n|        |                |identifier and deduced SDF  |     |    |    |\n|        |                |filter reporting            |     |    |    |\n\n\n"}, {"key": "Functional description", "numbering": "7.8", "title_level": 1, "desc": "7.8  Functional description\n\n\n"}, {"key": "General", "numbering": "7.8.1", "title_level": 2, "desc": "7.8.1  General\n\nThis clause describes how the CP function provides information over Sx to\nrealize forwarding, reporting etc on different aggregation levels.\n\n\n"}, {"key": "PDN connection and TDF session level context", "numbering": "7.8.2", "title_level": 2, "desc": "7.8.2  PDN connection and TDF session level context\n\nThe PDN connection or TDF session level context is realized over Sx by\ngenerating a Usage Reporting Rule and a QoS Enforcement Rule.\n\nTo apply PDN Connection or TDF session level reporting and MBR enforcement,\nthe CP function provides over Sx:\n\n  -  A URR that describes the reporting requirement for the PDN Connection\n    or TDF session.\n\n  -  A QER that describes the QoS enforcement actions that apply, i.e. a\n    QER with APN-AMBR value (in case of PGW) or a QER with TDF session MBR\n    (in case of TDF).\n\nFor session level reporting, the CP function includes references to the URR\n(i.e. URR Rule ID) in each Packet Detection Rule activated for the PDN\nConnection or TDF session. In case of PDN Connection or TDF session level\nusage monitoring where some SDF(s) are excluded, the CP function only\nincludes a reference to the URR in those Packet Detection Rules that shall\nbe included in the report.\n\nFor APN-AMBR policing, the CP function includes references (Rule ID) to the\nQER containing the APN-AMBR value in each Packet Detection Rule for non GBR\ntraffic activated for the PDN Connection. The CP function shall apply the\nsame QER for all Packet Detection Rules for non GBR traffic associated with\nany of the active PDN Connections of the same APN.\n\nFor TDF session MBR policing, the CP function includes references (Rule ID)\nto the QER containing the TDF session MBR value in each Packet Detection\nRule activated for the TDF session.\n\n\n"}, {"key": "Bearer related context", "numbering": "7.8.3", "title_level": 2, "desc": "7.8.3  Bearer related context\n\nThe bearer context is realized over Sx by generating one or two Forwarding\nAction Rules, a Usage Reporting Rule and a QoS Enforcement Rule that\ncorrespond to the bearer. In particular, the CP function may provide to the\nUP function for each active bearer:\n\n  -  A Usage Reporting Rule that describes the reporting requirement for\n    the bearer, including reporting events, measurement type etc for the\n    bearer reports\n\n  -  A QoS Enforcement Rule that describe the QoS enforcement actions that\n    apply to the bearer, including the bearer MBR.\n\n  -  Forwarding Action Rules describe the forwarding behaviour for the\n    bearer. One Forwarding Action Rule is required for the downlink\n    direction (in case of PGW or SGW) and one for the uplink direction (in\n    case of SGW).\n\n  NOTE:  The CP function maintains the association between the EPS Bearer\n         ID and the rules on Sx corresponding to bearer level enforcement\n         and reports. There is no need to provide a Bearer ID to the UP\n         function.\n\nThe CP function associates, based on the bearer binding decisions, every\nPacket Detection Rule that is activated for a bearer with the URR, QER and\nFARs applicable for the this bearer by including references (Rule IDs) in\nthe PDR:\n\n  -  For bearer level reporting, the CP function includes a reference (Rule\n    ID) to the URR for the bearer.\n\n  -  For bearer level policing, the CP function includes a reference (Rule\n    ID) to the QER for the bearer.\n\n  -  For forwarding of packets over a bearer (GTP-U encapsulation), the CP\n    function includes a reference (Rule ID) to the FAR the bearer. This is\n    done per direction (UL and DL).\n\n\n"}, {"key": "Measurement key related context", "numbering": "7.8.4", "title_level": 2, "desc": "7.8.4  Measurement key related context\n\nThe CP function provides a Usage Reporting Rule for each usage report that\nneeds to be provided by the UP function. The CP function maintains a\nmapping between the Charging Key and/or Monitoring Key applicable for a SDF\nand the Measurement Key of the URR provided over Sx. For example, the CP\nfunction may provide one URR for each Charging Key and one URR for each\nMonitoring Key or may decide to provide a single URR for a Charging Key and\na Monitoring Key in case there is complete overlap in the measurement\nrequirements. Other mappings are also possible as determined by the CP\nfunction and is not limited by the standard as long as the reporting\nrequirements from the CP function towards the OFCS/OCS and PCRF are\nfulfilled.\n\nTo associate traffic covered by a Packet Detection Rule with one or more\nmeasurement keys on Sx, the CP function includes in the Packet Detection\nRule a reference to each URR (Rule ID) that is applicable for the traffic\ncovered by the PDR.\n\n\n"}, {"key": "Parameters for Sx management", "numbering": "7.9", "title_level": 1, "desc": "7.9  Parameters for Sx management\n\n\n"}, {"key": "Parameters for PFD management", "numbering": "7.9.1", "title_level": 2, "desc": ""}, {"key": "F-TEID", "desc": "as defined in clause 8.22 of TS\u00a029.274\u00a0[7]."}, {"key": "F-TEIDu", "desc": "The F-TEID of a GTP-u tunnel."}, {"key": "CP", "desc": "function Control Plane function"}, {"key": "PGW", "desc": "PDN Gateway"}, {"key": "PGW-C", "desc": "PDN Gateway Control plane function"}, {"key": "PGW-U", "desc": "PDN Gateway User plane function"}, {"key": "SGW", "desc": "Serving Gateway"}, {"key": "SGW-C", "desc": "Serving Gateway Control plane function"}, {"key": "SGW-U", "desc": "Serving Gateway User plane function"}, {"key": "TDF", "desc": "Traffic Detection Function"}, {"key": "TDF-C", "desc": "Traffic Detection Function Control plane function"}, {"key": "TDF-U", "desc": "Traffic Detection Function User plane function"}, {"key": "UP", "desc": "function User Plane function"}, {"Keywords": "3GPP, Architecture, EPC, Control plane, User plane,Separation"}]